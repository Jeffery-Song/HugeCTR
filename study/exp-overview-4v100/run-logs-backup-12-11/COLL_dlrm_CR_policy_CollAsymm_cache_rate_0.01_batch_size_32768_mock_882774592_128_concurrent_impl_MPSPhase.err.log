2022-12-11 18:31:44.341691: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:31:44.429228: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:31:44.430597: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:31:44.430707: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:31:45.275810: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:31:45.275884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 18:31:45.288733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 18:31:45.319907: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:31:45.320062: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:31:45.321658: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 18:31:45.359624: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:31:45.359696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 18:31:45.359814: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:31:45.359867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 18:31:45.365914: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:31:45.365989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 18:31:45.373167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 18:31:45.373650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 18:31:45.379703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 18:31:45.403845: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:31:45.403999: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:31:45.404768: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:31:45.404947: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:31:45.405334: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 18:31:45.406758: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 18:31:45.411346: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:31:45.411477: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:31:45.412898: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][18:31:46.626][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:31:46.645][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:31:46.660][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:31:46.677][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:00,  3.58it/s]warmup run: 1it [00:00,  3.39it/s]warmup run: 1it [00:00,  3.43it/s]warmup run: 1it [00:00,  3.00it/s]warmup run: 81it [00:00, 272.34it/s]warmup run: 82it [00:00, 266.49it/s]warmup run: 87it [00:00, 284.90it/s]warmup run: 86it [00:00, 255.96it/s]warmup run: 154it [00:00, 419.67it/s]warmup run: 153it [00:00, 407.42it/s]warmup run: 161it [00:00, 430.07it/s]warmup run: 159it [00:00, 397.15it/s]warmup run: 225it [00:00, 511.05it/s]warmup run: 225it [00:00, 503.81it/s]warmup run: 229it [00:00, 507.95it/s]warmup run: 231it [00:00, 493.32it/s]warmup run: 296it [00:00, 571.32it/s]warmup run: 293it [00:00, 556.85it/s]warmup run: 300it [00:00, 568.44it/s]warmup run: 298it [00:00, 543.57it/s]warmup run: 368it [00:00, 616.70it/s]warmup run: 365it [00:00, 606.07it/s]warmup run: 371it [00:00, 611.14it/s]warmup run: 370it [00:00, 595.03it/s]warmup run: 440it [00:00, 645.83it/s]warmup run: 437it [00:00, 638.84it/s]warmup run: 444it [00:00, 645.70it/s]warmup run: 441it [00:00, 627.76it/s]warmup run: 509it [00:00, 657.78it/s]warmup run: 511it [00:00, 667.63it/s]warmup run: 517it [00:00, 669.16it/s]warmup run: 514it [00:01, 656.29it/s]warmup run: 579it [00:01, 668.67it/s]warmup run: 584it [00:01, 685.94it/s]warmup run: 590it [00:01, 685.07it/s]warmup run: 586it [00:01, 675.19it/s]warmup run: 652it [00:01, 685.86it/s]warmup run: 659it [00:01, 703.21it/s]warmup run: 661it [00:01, 681.63it/s]warmup run: 662it [00:01, 698.19it/s]warmup run: 726it [00:01, 701.07it/s]warmup run: 733it [00:01, 711.76it/s]warmup run: 731it [00:01, 685.42it/s]warmup run: 736it [00:01, 710.24it/s]warmup run: 800it [00:01, 711.84it/s]warmup run: 811it [00:01, 732.03it/s]warmup run: 802it [00:01, 690.04it/s]warmup run: 810it [00:01, 716.34it/s]warmup run: 874it [00:01, 719.37it/s]warmup run: 886it [00:01, 735.76it/s]warmup run: 874it [00:01, 696.18it/s]warmup run: 885it [00:01, 724.38it/s]warmup run: 947it [00:01, 720.73it/s]warmup run: 961it [00:01, 731.52it/s]warmup run: 946it [00:01, 701.49it/s]warmup run: 959it [00:01, 727.73it/s]warmup run: 1020it [00:01, 718.25it/s]warmup run: 1038it [00:01, 741.57it/s]warmup run: 1017it [00:01, 703.74it/s]warmup run: 1040it [00:01, 752.22it/s]warmup run: 1093it [00:01, 719.73it/s]warmup run: 1113it [00:01, 743.89it/s]warmup run: 1089it [00:01, 707.81it/s]warmup run: 1121it [00:01, 769.23it/s]warmup run: 1166it [00:01, 719.35it/s]warmup run: 1162it [00:01, 712.52it/s]warmup run: 1188it [00:01, 709.74it/s]warmup run: 1199it [00:01, 758.02it/s]warmup run: 1239it [00:01, 722.19it/s]warmup run: 1234it [00:02, 710.22it/s]warmup run: 1265it [00:02, 726.77it/s]warmup run: 1276it [00:02, 745.50it/s]warmup run: 1312it [00:02, 711.85it/s]warmup run: 1306it [00:02, 700.11it/s]warmup run: 1343it [00:02, 740.67it/s]warmup run: 1351it [00:02, 733.07it/s]warmup run: 1388it [00:02, 724.72it/s]warmup run: 1377it [00:02, 702.82it/s]warmup run: 1418it [00:02, 742.91it/s]warmup run: 1425it [00:02, 727.99it/s]warmup run: 1466it [00:02, 738.85it/s]warmup run: 1454it [00:02, 721.96it/s]warmup run: 1494it [00:02, 745.14it/s]warmup run: 1498it [00:02, 711.46it/s]warmup run: 1540it [00:02, 732.29it/s]warmup run: 1529it [00:02, 727.50it/s]warmup run: 1569it [00:02, 739.95it/s]warmup run: 1570it [00:02, 699.26it/s]warmup run: 1614it [00:02, 695.06it/s]warmup run: 1602it [00:02, 727.60it/s]warmup run: 1654it [00:02, 770.51it/s]warmup run: 1642it [00:02, 703.20it/s]warmup run: 1685it [00:02, 697.41it/s]warmup run: 1733it [00:02, 773.86it/s]warmup run: 1675it [00:02, 713.28it/s]warmup run: 1715it [00:02, 709.68it/s]warmup run: 1758it [00:02, 704.42it/s]warmup run: 1747it [00:02, 713.78it/s]warmup run: 1811it [00:02, 753.53it/s]warmup run: 1787it [00:02, 708.75it/s]warmup run: 1830it [00:02, 706.18it/s]warmup run: 1819it [00:02, 710.76it/s]warmup run: 1887it [00:02, 745.35it/s]warmup run: 1859it [00:02, 710.23it/s]warmup run: 1901it [00:02, 701.68it/s]warmup run: 1892it [00:02, 714.08it/s]warmup run: 1962it [00:02, 738.08it/s]warmup run: 1931it [00:02, 706.07it/s]warmup run: 1972it [00:03, 699.66it/s]warmup run: 1966it [00:03, 719.68it/s]warmup run: 2037it [00:03, 739.01it/s]warmup run: 2004it [00:03, 711.80it/s]warmup run: 2043it [00:03, 697.49it/s]warmup run: 2038it [00:03, 707.96it/s]warmup run: 2111it [00:03, 734.26it/s]warmup run: 2077it [00:03, 716.83it/s]warmup run: 2115it [00:03, 703.66it/s]warmup run: 2109it [00:03, 677.79it/s]warmup run: 2185it [00:03, 713.71it/s]warmup run: 2149it [00:03, 697.88it/s]warmup run: 2186it [00:03, 701.95it/s]warmup run: 2261it [00:03, 726.25it/s]warmup run: 2178it [00:03, 666.17it/s]warmup run: 2221it [00:03, 704.30it/s]warmup run: 2257it [00:03, 688.16it/s]warmup run: 2334it [00:03, 719.58it/s]warmup run: 2245it [00:03, 651.53it/s]warmup run: 2295it [00:03, 711.92it/s]warmup run: 2326it [00:03, 688.18it/s]warmup run: 2407it [00:03, 715.09it/s]warmup run: 2319it [00:03, 674.54it/s]warmup run: 2368it [00:03, 717.01it/s]warmup run: 2404it [00:03, 714.50it/s]warmup run: 2480it [00:03, 717.36it/s]warmup run: 2388it [00:03, 678.25it/s]warmup run: 2442it [00:03, 721.06it/s]warmup run: 2485it [00:03, 741.46it/s]warmup run: 2552it [00:03, 716.00it/s]warmup run: 2460it [00:03, 687.73it/s]warmup run: 2515it [00:03, 685.69it/s]warmup run: 2567it [00:03, 764.08it/s]warmup run: 2624it [00:03, 714.53it/s]warmup run: 2529it [00:03, 688.02it/s]warmup run: 2587it [00:03, 694.48it/s]warmup run: 2599it [00:03, 691.23it/s]warmup run: 2660it [00:04, 702.53it/s]warmup run: 2648it [00:04, 520.71it/s]warmup run: 2696it [00:04, 465.80it/s]warmup run: 2713it [00:04, 548.56it/s]warmup run: 2770it [00:04, 524.46it/s]warmup run: 2669it [00:04, 451.68it/s]warmup run: 2731it [00:04, 483.79it/s]warmup run: 2779it [00:04, 574.95it/s]warmup run: 2839it [00:04, 562.89it/s]warmup run: 2739it [00:04, 505.19it/s]warmup run: 2803it [00:04, 535.23it/s]warmup run: 2845it [00:04, 595.03it/s]warmup run: 2912it [00:04, 604.78it/s]warmup run: 2810it [00:04, 553.18it/s]warmup run: 2874it [00:04, 576.20it/s]warmup run: 2912it [00:04, 613.47it/s]warmup run: 2984it [00:04, 634.42it/s]warmup run: 2881it [00:04, 591.01it/s]warmup run: 2945it [00:04, 609.65it/s]warmup run: 3000it [00:04, 653.96it/s]warmup run: 2978it [00:04, 625.58it/s]warmup run: 3000it [00:04, 644.54it/s]warmup run: 2947it [00:04, 602.39it/s]warmup run: 3000it [00:04, 642.16it/s]warmup run: 3000it [00:04, 631.95it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1682.92it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1615.74it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1685.10it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1687.93it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1709.30it/s]warmup should be done:  11%|█         | 331/3000 [00:00<00:01, 1658.29it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1738.96it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1745.48it/s]warmup should be done:  17%|█▋        | 515/3000 [00:00<00:01, 1714.29it/s]warmup should be done:  17%|█▋        | 498/3000 [00:00<00:01, 1659.12it/s]warmup should be done:  17%|█▋        | 522/3000 [00:00<00:01, 1739.09it/s]warmup should be done:  18%|█▊        | 526/3000 [00:00<00:01, 1758.47it/s]warmup should be done:  23%|██▎       | 687/3000 [00:00<00:01, 1714.56it/s]warmup should be done:  22%|██▏       | 665/3000 [00:00<00:01, 1661.99it/s]warmup should be done:  23%|██▎       | 699/3000 [00:00<00:01, 1747.19it/s]warmup should be done:  24%|██▎       | 705/3000 [00:00<00:01, 1767.75it/s]warmup should be done:  29%|██▉       | 864/3000 [00:00<00:01, 1731.30it/s]warmup should be done:  28%|██▊       | 832/3000 [00:00<00:01, 1660.49it/s]warmup should be done:  29%|██▉       | 874/3000 [00:00<00:01, 1746.56it/s]warmup should be done:  29%|██▉       | 882/3000 [00:00<00:01, 1760.41it/s]warmup should be done:  35%|███▍      | 1041/3000 [00:00<00:01, 1743.20it/s]warmup should be done:  35%|███▍      | 1049/3000 [00:00<00:01, 1745.75it/s]warmup should be done:  33%|███▎      | 999/3000 [00:00<00:01, 1654.33it/s]warmup should be done:  35%|███▌      | 1059/3000 [00:00<00:01, 1754.17it/s]warmup should be done:  41%|████      | 1216/3000 [00:00<00:01, 1745.36it/s]warmup should be done:  41%|████      | 1225/3000 [00:00<00:01, 1747.16it/s]warmup should be done:  39%|███▉      | 1165/3000 [00:00<00:01, 1647.84it/s]warmup should be done:  41%|████      | 1235/3000 [00:00<00:01, 1748.31it/s]warmup should be done:  46%|████▋     | 1393/3000 [00:00<00:00, 1751.33it/s]warmup should be done:  47%|████▋     | 1400/3000 [00:00<00:00, 1742.06it/s]warmup should be done:  44%|████▍     | 1330/3000 [00:00<00:01, 1643.42it/s]warmup should be done:  47%|████▋     | 1410/3000 [00:00<00:00, 1747.73it/s]warmup should be done:  52%|█████▏    | 1570/3000 [00:00<00:00, 1756.07it/s]warmup should be done:  52%|█████▎    | 1575/3000 [00:00<00:00, 1738.77it/s]warmup should be done:  50%|█████     | 1509/3000 [00:00<00:00, 1686.87it/s]warmup should be done:  53%|█████▎    | 1585/3000 [00:00<00:00, 1744.51it/s]warmup should be done:  58%|█████▊    | 1746/3000 [00:01<00:00, 1756.61it/s]warmup should be done:  58%|█████▊    | 1750/3000 [00:01<00:00, 1741.00it/s]warmup should be done:  56%|█████▌    | 1684/3000 [00:01<00:00, 1706.12it/s]warmup should be done:  59%|█████▊    | 1760/3000 [00:01<00:00, 1741.78it/s]warmup should be done:  64%|██████▍   | 1922/3000 [00:01<00:00, 1756.05it/s]warmup should be done:  64%|██████▍   | 1925/3000 [00:01<00:00, 1737.06it/s]warmup should be done:  62%|██████▏   | 1863/3000 [00:01<00:00, 1728.77it/s]warmup should be done:  64%|██████▍   | 1935/3000 [00:01<00:00, 1740.09it/s]warmup should be done:  70%|██████▉   | 2099/3000 [00:01<00:00, 1759.45it/s]warmup should be done:  68%|██████▊   | 2038/3000 [00:01<00:00, 1732.74it/s]warmup should be done:  70%|███████   | 2110/3000 [00:01<00:00, 1739.80it/s]warmup should be done:  70%|██████▉   | 2099/3000 [00:01<00:00, 1720.92it/s]warmup should be done:  76%|███████▌  | 2276/3000 [00:01<00:00, 1761.18it/s]warmup should be done:  76%|███████▌  | 2284/3000 [00:01<00:00, 1736.68it/s]warmup should be done:  76%|███████▌  | 2275/3000 [00:01<00:00, 1732.40it/s]warmup should be done:  74%|███████▎  | 2212/3000 [00:01<00:00, 1688.78it/s]warmup should be done:  82%|████████▏ | 2453/3000 [00:01<00:00, 1760.92it/s]warmup should be done:  82%|████████▏ | 2459/3000 [00:01<00:00, 1739.62it/s]warmup should be done:  82%|████████▏ | 2453/3000 [00:01<00:00, 1744.89it/s]warmup should be done:  80%|███████▉  | 2389/3000 [00:01<00:00, 1710.27it/s]warmup should be done:  88%|████████▊ | 2631/3000 [00:01<00:00, 1765.09it/s]warmup should be done:  88%|████████▊ | 2633/3000 [00:01<00:00, 1738.13it/s]warmup should be done:  88%|████████▊ | 2628/3000 [00:01<00:00, 1741.64it/s]warmup should be done:  86%|████████▌ | 2566/3000 [00:01<00:00, 1726.19it/s]warmup should be done:  94%|█████████▎| 2809/3000 [00:01<00:00, 1767.01it/s]warmup should be done:  94%|█████████▎| 2807/3000 [00:01<00:00, 1736.06it/s]warmup should be done:  93%|█████████▎| 2804/3000 [00:01<00:00, 1745.32it/s]warmup should be done:  91%|█████████▏| 2739/3000 [00:01<00:00, 1712.79it/s]warmup should be done: 100%|█████████▉| 2986/3000 [00:01<00:00, 1753.77it/s]warmup should be done:  99%|█████████▉| 2982/3000 [00:01<00:00, 1739.92it/s]warmup should be done:  99%|█████████▉| 2979/3000 [00:01<00:00, 1745.40it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1748.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1743.27it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1740.18it/s]warmup should be done:  97%|█████████▋| 2911/3000 [00:01<00:00, 1670.19it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1685.29it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1699.48it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1801.39it/s]warmup should be done:   5%|▌         | 151/3000 [00:00<00:01, 1507.14it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1722.77it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1767.69it/s]warmup should be done:  11%|█         | 328/3000 [00:00<00:01, 1660.93it/s]warmup should be done:  12%|█▏        | 346/3000 [00:00<00:01, 1714.65it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1748.47it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1790.72it/s]warmup should be done:  17%|█▋        | 503/3000 [00:00<00:01, 1701.16it/s]warmup should be done:  17%|█▋        | 521/3000 [00:00<00:01, 1726.83it/s]warmup should be done:  18%|█▊        | 545/3000 [00:00<00:01, 1784.67it/s]warmup should be done:  24%|██▍       | 717/3000 [00:00<00:01, 1802.86it/s]warmup should be done:  23%|██▎       | 682/3000 [00:00<00:01, 1733.52it/s]warmup should be done:  23%|██▎       | 699/3000 [00:00<00:01, 1746.75it/s]warmup should be done:  24%|██▍       | 728/3000 [00:00<00:01, 1801.70it/s]warmup should be done:  30%|███       | 900/3000 [00:00<00:01, 1810.35it/s]warmup should be done:  29%|██▊       | 857/3000 [00:00<00:01, 1736.50it/s]warmup should be done:  29%|██▉       | 879/3000 [00:00<00:01, 1763.80it/s]warmup should be done:  30%|███       | 909/3000 [00:00<00:01, 1803.57it/s]warmup should be done:  36%|███▌      | 1083/3000 [00:00<00:01, 1816.16it/s]warmup should be done:  35%|███▍      | 1036/3000 [00:00<00:01, 1752.30it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1776.58it/s]warmup should be done:  36%|███▋      | 1094/3000 [00:00<00:01, 1818.36it/s]warmup should be done:  42%|████▏     | 1265/3000 [00:00<00:00, 1813.85it/s]warmup should be done:  40%|████      | 1212/3000 [00:00<00:01, 1752.05it/s]warmup should be done:  41%|████▏     | 1239/3000 [00:00<00:00, 1778.63it/s]warmup should be done:  43%|████▎     | 1277/3000 [00:00<00:00, 1821.51it/s]warmup should be done:  48%|████▊     | 1449/3000 [00:00<00:00, 1819.96it/s]warmup should be done:  47%|████▋     | 1418/3000 [00:00<00:00, 1780.08it/s]warmup should be done:  49%|████▉     | 1463/3000 [00:00<00:00, 1833.43it/s]warmup should be done:  46%|████▋     | 1388/3000 [00:00<00:00, 1723.03it/s]warmup should be done:  54%|█████▍    | 1633/3000 [00:00<00:00, 1823.41it/s]warmup should be done:  53%|█████▎    | 1599/3000 [00:00<00:00, 1787.47it/s]warmup should be done:  55%|█████▍    | 1647/3000 [00:00<00:00, 1829.58it/s]warmup should be done:  52%|█████▏    | 1564/3000 [00:00<00:00, 1731.86it/s]warmup should be done:  61%|██████    | 1816/3000 [00:01<00:00, 1825.01it/s]warmup should be done:  59%|█████▉    | 1778/3000 [00:01<00:00, 1787.55it/s]warmup should be done:  61%|██████    | 1833/3000 [00:01<00:00, 1838.60it/s]warmup should be done:  58%|█████▊    | 1742/3000 [00:01<00:00, 1745.68it/s]warmup should be done:  67%|██████▋   | 2000/3000 [00:01<00:00, 1827.43it/s]warmup should be done:  65%|██████▌   | 1959/3000 [00:01<00:00, 1792.77it/s]warmup should be done:  67%|██████▋   | 2020/3000 [00:01<00:00, 1846.02it/s]warmup should be done:  64%|██████▍   | 1919/3000 [00:01<00:00, 1750.81it/s]warmup should be done:  73%|███████▎  | 2183/3000 [00:01<00:00, 1827.56it/s]warmup should be done:  71%|███████▏  | 2139/3000 [00:01<00:00, 1792.11it/s]warmup should be done:  70%|██████▉   | 2098/3000 [00:01<00:00, 1760.75it/s]warmup should be done:  74%|███████▎  | 2205/3000 [00:01<00:00, 1831.10it/s]warmup should be done:  79%|███████▉  | 2367/3000 [00:01<00:00, 1829.48it/s]warmup should be done:  77%|███████▋  | 2319/3000 [00:01<00:00, 1780.64it/s]warmup should be done:  76%|███████▌  | 2275/3000 [00:01<00:00, 1760.34it/s]warmup should be done:  80%|███████▉  | 2391/3000 [00:01<00:00, 1837.03it/s]warmup should be done:  85%|████████▌ | 2551/3000 [00:01<00:00, 1830.92it/s]warmup should be done:  83%|████████▎ | 2502/3000 [00:01<00:00, 1793.04it/s]warmup should be done:  82%|████████▏ | 2455/3000 [00:01<00:00, 1769.65it/s]warmup should be done:  86%|████████▌ | 2577/3000 [00:01<00:00, 1841.82it/s]warmup should be done:  91%|█████████ | 2735/3000 [00:01<00:00, 1832.60it/s]warmup should be done:  90%|████████▉ | 2685/3000 [00:01<00:00, 1801.61it/s]warmup should be done:  88%|████████▊ | 2634/3000 [00:01<00:00, 1774.81it/s]warmup should be done:  92%|█████████▏| 2762/3000 [00:01<00:00, 1844.00it/s]warmup should be done:  97%|█████████▋| 2919/3000 [00:01<00:00, 1832.70it/s]warmup should be done:  96%|█████████▌| 2867/3000 [00:01<00:00, 1806.23it/s]warmup should be done:  94%|█████████▍| 2813/3000 [00:01<00:00, 1777.14it/s]warmup should be done:  98%|█████████▊| 2947/3000 [00:01<00:00, 1841.26it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1827.26it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1819.37it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1784.11it/s]warmup should be done: 100%|█████████▉| 2992/3000 [00:01<00:00, 1779.72it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1748.24it/s]2022-12-11 18:32:28.923989: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f6e699c2cb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:32:28.924080: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:32:28.997718: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f6e61663ef0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:32:28.997786: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:32:29.030260: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:32:29.066384: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f6e5d660c30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:32:29.066445: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:32:29.094295: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:32:29.113754: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f6e5d664b10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:32:29.113817: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:32:29.188953: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:32:29.234174: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:32:29.837008: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:32:29.923769: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:32:29.978934: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:32:30.010784: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:32:30.607428: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:32:30.767716: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:32:30.798983: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:32:30.838102: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][18:33:37.394][ERROR][RK0][tid #140112352499456]: replica 0 reaches 1000, calling init pre replica
[HCTR][18:33:37.394][ERROR][RK0][tid #140112352499456]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:33:37.398][ERROR][RK0][tid #140112352499456]: coll ps creation done
[HCTR][18:33:37.398][ERROR][RK0][tid #140112352499456]: replica 0 waits for coll ps creation barrier
[HCTR][18:33:38.470][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][18:33:38.470][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:33:38.473][ERROR][RK0][main]: coll ps creation done
[HCTR][18:33:38.473][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][18:33:38.698][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][18:33:38.698][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:33:38.714][ERROR][RK0][main]: coll ps creation done
[HCTR][18:33:38.714][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][18:33:38.768][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][18:33:38.768][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:33:38.772][ERROR][RK0][main]: coll ps creation done
[HCTR][18:33:38.772][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][18:33:38.772][ERROR][RK0][tid #140112352499456]: replica 0 preparing frequency
[HCTR][18:33:49.264][ERROR][RK0][tid #140112352499456]: replica 0 preparing frequency done
[HCTR][18:33:49.318][ERROR][RK0][tid #140112352499456]: replica 0 calling init per replica
[HCTR][18:33:49.318][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][18:33:49.318][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][18:33:49.318][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][18:33:49.318][ERROR][RK0][tid #140112352499456]: Calling build_v2
[HCTR][18:33:49.318][ERROR][RK0][main]: Calling build_v2
[HCTR][18:33:49.318][ERROR][RK0][tid #140112352499456]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:33:49.318][ERROR][RK0][main]: Calling build_v2
[HCTR][18:33:49.319][ERROR][RK0][main]: Calling build_v2
[HCTR][18:33:49.319][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:33:49.319][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:33:49.319][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-11 18:33:49[2022-12-11 18:33:49.2022-12-11 18:33:492022-12-11 18:33:49.319105..319105: 319117319117: E: : E EE /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136::136] 136136] using concurrent impl MPSPhase] ] using concurrent impl MPSPhase
using concurrent impl MPSPhaseusing concurrent impl MPSPhase


[2022-12-11 18:33:49.320694: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[1962022-12-11 18:33:49] .assigning 8 to cpu320722
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[[2022-12-11 18:33:492022-12-11 18:33:49[..2022-12-11 18:33:49320779320804.: : 320813EE:   E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc196196:[] ] 2122022-12-11 18:33:49assigning 8 to cpuassigning 8 to cpu
] .
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4320927
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[[2022-12-11 18:33:492022-12-11 18:33:49..321024321033: : EE [ /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 18:33:49/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:.:213321075213] : ] remote time is 8.68421Eremote time is 8.68421
 
[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[2022-12-11 18:33:49[:2022-12-11 18:33:49.2022-12-11 18:33:49212.321145.] 321168: 321172build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: E: 
E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 18:33:49:212:.214] 214321265] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4] : cpu time is 30
cpu time is 30E

 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213[] 2022-12-11 18:33:49remote time is 8.68421.
321372: E[ 2022-12-11 18:33:49/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:321419213: ] Eremote time is 8.68421 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 18:33:49.321512: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 18:34:23.327886: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 18:34:23.783468: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 3.29 GB
[2022-12-11 18:34:23.783577: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 3.29 GB
[2022-12-11 18:34:23.784784: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 18:34:24.475398: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 18:34:26.282022: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 2
[2022-12-11 18:34:26.282118: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 18:35:30.233537: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1001
[2022-12-11 18:35:30.233753: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 18:35:44.516820: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 18:35:44.516947: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1001
[2022-12-11 18:35:44.617568: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 18:35:44.617666: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1001 blocks, 4 devices
[2022-12-11 18:35:44.641892: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 18:35:44.654110: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 18:35:44.654947: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 18:35:44.665076: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 18:35:44.759779: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 18:35:44.761639: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 18:35:44.765016: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 18:35:44.767390: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 18:35:44.769738: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 18:35:46.805876: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 18:35:46.809561: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 18:35:46.810118: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 18:35:46.818816: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 18:35:46.818886: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 18:35:46.818919: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 18:35:46.818951: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 18:35:46.819884: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:35:46.819972: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:35:46.823839: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:35:46.828380: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:35:46.991150: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 18:35:46.991260: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 18:35:46[.9934362022-12-11 18:35:46: .E993453 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 202/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :2 solved202
] 3 solved
[2022-12-11 18:35:46.993552[: 2022-12-11 18:35:46E. 993558/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc: :E205 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccworker 0 thread 2 initing device 2:
205] worker 0 thread 3 initing device 3
[2022-12-11 18:35:46.994945: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:35:46.995009: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:35:46.998978: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:35:47.  2793: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:35:47. 22576[: 2022-12-11 18:35:47E.  22628/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1815 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuBuilding Coll Cache with ... num gpu device is 4:
1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:35:47.[ 228022022-12-11 18:35:47: .E 22817 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :1980eager alloc mem 3.29 GB] 
eager alloc mem 3.29 GB
[2022-12-11 18:35:47. 41384: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:35:47. 41457: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:35:47. 55032: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:35:47. 56772: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:35:47.249489: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 18:35:47.249848: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:35:47.263631: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1001
[2022-12-11 18:35:47.263687: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:35:47.267878: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:35:47.272950: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:47.279472: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:47.279670: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.50 MB
[2022-12-11 18:35:47.295937: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:35:47.301062: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:35:47.301109: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.23 GB
[2022-12-11 18:35:47.843623: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 18:35:47.843875: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:35:47.857715: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1001
[2022-12-11 18:35:47.857768: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:35:47.874555: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:35:47.875283: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:47.882405: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:47.882648: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.68 MB
[[2022-12-11 18:35:472022-12-11 18:35:47..911109911105: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1001.00 Byteseager alloc mem 1001.00 Bytes

[2022-12-11 18:35:47.911438: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:35:47.911470: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:35:47.922676: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:35:47.925286: [E2022-12-11 18:35:47 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc925298:: 638E]  eager release cuda mem 1001/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 1001
[2022-12-11 18:35:47.925355[: 2022-12-11 18:35:47E. 925362/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :E638 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 3531098340:
638] eager release cuda mem 3531098340
[2022-12-11 18:35:47.927645: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:35:47.927686: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.25 GB
[2022-12-11 18:35:47.929739: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:35:47.933669: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:35:47.999351: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:47.999851: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:48.  6762: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:48.  7222: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:48.  8860: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.68 MB
[2022-12-11 18:35:48.  8907: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.68 MB
[2022-12-11 18:35:48. 50082: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:35:48. 51193: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:35:48. 54199: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:35:48. 54245: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.25 GB
[2022-12-11 18:35:48. 55307: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:35:48. 55352: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.25 GB
[[[2022-12-11 18:35:482022-12-11 18:35:482022-12-11 18:35:48[.2022-12-11 18:35:48..443074.443075443078: 443089: : E: EE E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::1926:19261926] 1926] ] Device 1 init p2p of link 2] Device 2 init p2p of link 3Device 3 init p2p of link 0
Device 0 init p2p of link 1


[2022-12-11 18:35:48.443421[: 2022-12-11 18:35:48E. 443429/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1980 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 5.26 MB:
1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:48.443782: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 18:35:48eager alloc mem 5.26 MB.
443800: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:48.450528: [E2022-12-11 18:35:48 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc450566:: 638E]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 5518079:
638] eager release cuda mem 5518079
[2022-12-11 18:35:48.450599: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:48.451014: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:48.455323: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 18:35:48.455438: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:48.455553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 18:35:48.455695: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:48.456468: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 18:35:48.456568: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:48.456698: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 18:35:48.456816: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:48.461456: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:48.461793: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:48.462553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:48.462778: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:48.465114: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 18:35:48.465217: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:48.465344: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 18:35:48.465436: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:48.465961: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 18:35:48.466049: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:48.466236: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 18:35:48.466336: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:35:48.471246: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:48.471440: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:48.472029: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:48.472298: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:35:48.474362: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 18:35:48.474695: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8827740 / 882774585 nodes ( 1.00 %~1.00 %) | remote 6132638 / 882774585 nodes ( 0.69 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.25 GB | 1.47971 secs 
[2022-12-11 18:35:48.475653: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080[
2022-12-11 18:35:48.475681: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 18:35:48.475868: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 18:35:48.475992: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8827740 / 882774585 nodes ( 1.00 %~1.00 %) | remote 6132638 / 882774585 nodes ( 0.69 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.25 GB | 1.45321 secs 
[2022-12-11 18:35:48.476079: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8827740 / 882774585 nodes ( 1.00 %~1.00 %) | remote 6132638 / 882774585 nodes ( 0.69 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.25 GB | 1.45333 secs 
[2022-12-11 18:35:48.476288: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8780960 / 882774585 nodes ( 0.99 %~1.00 %) | remote 6179418 / 882774585 nodes ( 0.70 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.23 GB | 1.65636 secs 
[2022-12-11 18:35:48.476822: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 13.40 GB
[2022-12-11 18:35:49.425975: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 13.65 GB
[2022-12-11 18:35:49.426110: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 13.65 GB
[2022-12-11 18:35:49.426535: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 13.65 GB
[2022-12-11 18:35:50.410637: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 13.90 GB
[2022-12-11 18:35:50.410841: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 13.90 GB
[2022-12-11 18:35:50.411157: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 13.90 GB
[2022-12-11 18:35:51.165426: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.14 GB
[2022-12-11 18:35:51.165603: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.14 GB
[2022-12-11 18:35:51.165960: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 14.14 GB
[2022-12-11 18:35:51.166216: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 14.14 GB
[2022-12-11 18:35:51.166461: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 14.14 GB
[2022-12-11 18:35:52. 98695: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.33 GB
[2022-12-11 18:35:52. 98828: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.33 GB
[HCTR][18:35:52.323][ERROR][RK0][tid #140112352499456]: replica 0 calling init per replica done, doing barrier
[HCTR][18:35:52.323][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][18:35:52.323][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][18:35:52.323][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][18:35:52.323][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][18:35:52.323][ERROR][RK0][tid #140112352499456]: replica 0 calling init per replica done, doing barrier done
[HCTR][18:35:52.323][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][18:35:52.323][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][18:35:52.323][ERROR][RK0][main]: init per replica done
[HCTR][18:35:52.323][ERROR][RK0][main]: init per replica done
[HCTR][18:35:52.323][ERROR][RK0][main]: init per replica done
[HCTR][18:35:52.493][ERROR][RK0][tid #140112352499456]: init per replica done




