2022-12-11 22:40:52.829739: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:40:52.898839: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:40:52.898887: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:40:52.899417: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:40:53.656711: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:40:53.656787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:40:53.671583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:40:53.713889: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:40:53.714135: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:40:53.717440: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 22:40:53.789116: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:40:53.789192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:40:53.789254: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:40:53.789291: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:40:53.789310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:40:53.789339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:40:53.806816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:40:53.807528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:40:53.807566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:40:53.840093: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:40:53.840316: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:40:53.841562: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:40:53.841688: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:40:53.842175: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 22:40:53.843237: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 22:40:53.844269: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:40:53.844377: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:40:53.845871: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][22:40:55.105][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:40:55.107][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:40:55.117][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:40:55.139][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 1it [00:01,  1.44s/it]warmup run: 108it [00:01, 96.96it/s]warmup run: 106it [00:01, 95.48it/s]warmup run: 218it [00:01, 211.11it/s]warmup run: 216it [00:01, 210.17it/s]warmup run: 321it [00:01, 325.67it/s]warmup run: 326it [00:01, 334.59it/s]warmup run: 0it [00:00, ?it/s]warmup run: 423it [00:01, 441.31it/s]warmup run: 426it [00:01, 445.21it/s]warmup run: 528it [00:01, 558.05it/s]warmup run: 533it [00:01, 564.33it/s]warmup run: 633it [00:02, 663.53it/s]warmup run: 640it [00:02, 672.57it/s]warmup run: 744it [00:02, 767.42it/s]warmup run: 746it [00:02, 763.37it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 851it [00:02, 843.28it/s]warmup run: 857it [00:02, 849.50it/s]warmup run: 104it [00:01, 93.19it/s]warmup run: 961it [00:02, 909.05it/s]warmup run: 964it [00:02, 906.66it/s]warmup run: 210it [00:01, 203.08it/s]warmup run: 1068it [00:02, 950.43it/s]warmup run: 1074it [00:02, 958.88it/s]warmup run: 316it [00:01, 322.80it/s]warmup run: 1175it [00:02, 983.63it/s]warmup run: 1184it [00:02, 996.72it/s]warmup run: 423it [00:01, 446.69it/s]warmup run: 1287it [00:02, 1020.59it/s]warmup run: 1292it [00:02, 969.08it/s]warmup run: 529it [00:01, 563.45it/s]warmup run: 1397it [00:02, 1043.04it/s]warmup run: 1400it [00:02, 998.64it/s]warmup run: 636it [00:02, 671.86it/s]warmup run: 1506it [00:02, 1038.18it/s]warmup run: 1509it [00:02, 1023.34it/s]warmup run: 742it [00:02, 762.36it/s]warmup run: 1613it [00:02, 1046.37it/s]warmup run: 1618it [00:02, 1042.47it/s]warmup run: 849it [00:02, 838.02it/s]warmup run: 1722it [00:03, 1056.55it/s]warmup run: 1727it [00:03, 1055.27it/s]warmup run: 955it [00:02, 895.66it/s]warmup run: 1830it [00:03, 1042.74it/s]warmup run: 1835it [00:03, 1061.14it/s]warmup run: 1060it [00:02, 924.72it/s]warmup run: 1936it [00:03, 1039.17it/s]warmup run: 1943it [00:03, 1064.97it/s]warmup run: 1it [00:01,  1.49s/it]warmup run: 1167it [00:02, 964.62it/s]warmup run: 2049it [00:03, 1065.74it/s]warmup run: 2058it [00:03, 1089.53it/s]warmup run: 100it [00:01, 87.03it/s]warmup run: 1273it [00:02, 991.22it/s]warmup run: 2187it [00:03, 1157.11it/s]warmup run: 2191it [00:03, 1159.29it/s]warmup run: 213it [00:01, 202.62it/s]warmup run: 1381it [00:02, 1015.53it/s]warmup run: 2324it [00:03, 1218.84it/s]warmup run: 2323it [00:03, 1206.80it/s]warmup run: 325it [00:01, 327.69it/s]warmup run: 1488it [00:02, 1031.32it/s]warmup run: 2460it [00:03, 1260.45it/s]warmup run: 2456it [00:03, 1240.91it/s]warmup run: 432it [00:01, 448.49it/s]warmup run: 1596it [00:02, 1042.65it/s]warmup run: 2589it [00:03, 1266.33it/s]warmup run: 2588it [00:03, 1262.07it/s]warmup run: 540it [00:01, 567.01it/s]warmup run: 1705it [00:03, 1055.94it/s]warmup run: 2722it [00:03, 1282.49it/s]warmup run: 2719it [00:03, 1274.20it/s]warmup run: 647it [00:02, 673.31it/s]warmup run: 1814it [00:03, 1064.40it/s]warmup run: 2854it [00:03, 1291.34it/s]warmup run: 2851it [00:03, 1285.14it/s]warmup run: 755it [00:02, 766.70it/s]warmup run: 1923it [00:03, 1070.63it/s]warmup run: 2986it [00:04, 1299.57it/s]warmup run: 3000it [00:04, 734.03it/s] warmup run: 2981it [00:04, 1288.17it/s]warmup run: 860it [00:02, 831.74it/s]warmup run: 3000it [00:04, 733.32it/s] warmup run: 2038it [00:03, 1092.03it/s]warmup run: 964it [00:02, 882.14it/s]warmup run: 2171it [00:03, 1160.60it/s]warmup run: 1068it [00:02, 921.37it/s]warmup run: 2304it [00:03, 1210.06it/s]warmup run: 1175it [00:02, 961.00it/s]warmup run: 2437it [00:03, 1245.70it/s]warmup run: 1281it [00:02, 987.29it/s]warmup run: 2570it [00:03, 1269.60it/s]warmup run: 1388it [00:02, 1009.57it/s]warmup run: 2702it [00:03, 1282.85it/s]warmup run: 1495it [00:02, 1025.66it/s]warmup run: 2835it [00:03, 1296.01it/s]warmup run: 1603it [00:03, 1040.76it/s]warmup run: 2968it [00:04, 1304.93it/s]warmup run: 3000it [00:04, 732.64it/s] warmup run: 1710it [00:03, 1048.57it/s]warmup run: 1817it [00:03, 1052.89it/s]warmup run: 1925it [00:03, 1058.19it/s]warmup run: 2039it [00:03, 1081.26it/s]warmup run: 2175it [00:03, 1163.92it/s]warmup run: 2311it [00:03, 1221.40it/s]warmup run: 2447it [00:03, 1262.70it/s]warmup run: 2584it [00:03, 1292.12it/s]warmup run: 2720it [00:03, 1310.86it/s]warmup run: 2852it [00:04, 1304.45it/s]warmup run: 2984it [00:04, 1308.49it/s]warmup run: 3000it [00:04, 726.05it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1727.33it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1727.04it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1675.41it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1664.05it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1761.86it/s]warmup should be done:  11%|█▏        | 341/3000 [00:00<00:01, 1707.49it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1745.83it/s]warmup should be done:  12%|█▏        | 346/3000 [00:00<00:01, 1508.97it/s]warmup should be done:  17%|█▋        | 514/3000 [00:00<00:01, 1714.97it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1767.04it/s]warmup should be done:  18%|█▊        | 529/3000 [00:00<00:01, 1754.50it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1635.11it/s]warmup should be done:  23%|██▎       | 688/3000 [00:00<00:01, 1722.01it/s]warmup should be done:  24%|██▎       | 709/3000 [00:00<00:01, 1780.11it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1760.37it/s]warmup should be done:  24%|██▎       | 709/3000 [00:00<00:01, 1703.95it/s]warmup should be done:  29%|██▊       | 862/3000 [00:00<00:01, 1726.05it/s]warmup should be done:  30%|██▉       | 889/3000 [00:00<00:01, 1783.72it/s]warmup should be done:  29%|██▉       | 883/3000 [00:00<00:01, 1760.06it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1740.58it/s]warmup should be done:  35%|███▍      | 1036/3000 [00:00<00:01, 1729.89it/s]warmup should be done:  36%|███▌      | 1068/3000 [00:00<00:01, 1784.51it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1757.90it/s]warmup should be done:  36%|███▌      | 1071/3000 [00:00<00:01, 1761.47it/s]warmup should be done:  42%|████▏     | 1247/3000 [00:00<00:00, 1785.75it/s]warmup should be done:  41%|████▏     | 1238/3000 [00:00<00:00, 1762.51it/s]warmup should be done:  40%|████      | 1209/3000 [00:00<00:01, 1658.84it/s]warmup should be done:  42%|████▏     | 1252/3000 [00:00<00:00, 1775.00it/s]warmup should be done:  48%|████▊     | 1426/3000 [00:00<00:00, 1786.98it/s]warmup should be done:  47%|████▋     | 1415/3000 [00:00<00:00, 1750.55it/s]warmup should be done:  46%|████▌     | 1380/3000 [00:00<00:00, 1674.14it/s]warmup should be done:  48%|████▊     | 1431/3000 [00:00<00:00, 1775.37it/s]warmup should be done:  54%|█████▎    | 1605/3000 [00:00<00:00, 1785.89it/s]warmup should be done:  53%|█████▎    | 1592/3000 [00:00<00:00, 1755.23it/s]warmup should be done:  52%|█████▏    | 1552/3000 [00:00<00:00, 1687.34it/s]warmup should be done:  54%|█████▎    | 1609/3000 [00:00<00:00, 1756.06it/s]warmup should be done:  60%|█████▉    | 1785/3000 [00:01<00:00, 1788.29it/s]warmup should be done:  59%|█████▉    | 1769/3000 [00:01<00:00, 1757.29it/s]warmup should be done:  57%|█████▋    | 1724/3000 [00:01<00:00, 1696.04it/s]warmup should be done:  60%|█████▉    | 1788/3000 [00:01<00:00, 1765.12it/s]warmup should be done:  66%|██████▌   | 1965/3000 [00:01<00:00, 1790.53it/s]warmup should be done:  65%|██████▍   | 1945/3000 [00:01<00:00, 1757.95it/s]warmup should be done:  63%|██████▎   | 1896/3000 [00:01<00:00, 1701.09it/s]warmup should be done:  66%|██████▌   | 1969/3000 [00:01<00:00, 1777.17it/s]warmup should be done:  72%|███████▏  | 2146/3000 [00:01<00:00, 1794.33it/s]warmup should be done:  71%|███████   | 2123/3000 [00:01<00:00, 1761.93it/s]warmup should be done:  69%|██████▉   | 2069/3000 [00:01<00:00, 1708.96it/s]warmup should be done:  72%|███████▏  | 2151/3000 [00:01<00:00, 1787.25it/s]warmup should be done:  78%|███████▊  | 2327/3000 [00:01<00:00, 1797.81it/s]warmup should be done:  77%|███████▋  | 2300/3000 [00:01<00:00, 1752.19it/s]warmup should be done:  75%|███████▍  | 2241/3000 [00:01<00:00, 1710.14it/s]warmup should be done:  78%|███████▊  | 2330/3000 [00:01<00:00, 1775.60it/s]warmup should be done:  84%|████████▎ | 2509/3000 [00:01<00:00, 1803.62it/s]warmup should be done:  83%|████████▎ | 2479/3000 [00:01<00:00, 1762.38it/s]warmup should be done:  80%|████████  | 2415/3000 [00:01<00:00, 1717.59it/s]warmup should be done:  84%|████████▎ | 2508/3000 [00:01<00:00, 1722.98it/s]warmup should be done:  90%|████████▉ | 2690/3000 [00:01<00:00, 1804.99it/s]warmup should be done:  89%|████████▊ | 2658/3000 [00:01<00:00, 1769.55it/s]warmup should be done:  86%|████████▋ | 2589/3000 [00:01<00:00, 1722.84it/s]warmup should be done:  89%|████████▉ | 2684/3000 [00:01<00:00, 1730.95it/s]warmup should be done:  96%|█████████▌| 2871/3000 [00:01<00:00, 1783.59it/s]warmup should be done:  95%|█████████▍| 2837/3000 [00:01<00:00, 1773.95it/s]warmup should be done:  92%|█████████▏| 2762/3000 [00:01<00:00, 1723.99it/s]warmup should be done:  95%|█████████▌| 2858/3000 [00:01<00:00, 1716.63it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1786.09it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1762.17it/s]warmup should be done:  98%|█████████▊| 2935/3000 [00:01<00:00, 1723.61it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1729.11it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1709.42it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1778.38it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1616.57it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1716.11it/s]warmup should be done:   5%|▌         | 151/3000 [00:00<00:01, 1501.61it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1773.74it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1781.69it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1749.15it/s]warmup should be done:  11%|█         | 325/3000 [00:00<00:01, 1638.56it/s]warmup should be done:  18%|█▊        | 535/3000 [00:00<00:01, 1779.78it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1806.03it/s]warmup should be done:  17%|█▋        | 498/3000 [00:00<00:01, 1679.73it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1795.82it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1781.99it/s]warmup should be done:  24%|██▍       | 723/3000 [00:00<00:01, 1817.03it/s]warmup should be done:  22%|██▏       | 673/3000 [00:00<00:01, 1704.93it/s]warmup should be done:  24%|██▍       | 719/3000 [00:00<00:01, 1817.39it/s]warmup should be done:  30%|██▉       | 893/3000 [00:00<00:01, 1780.88it/s]warmup should be done:  30%|███       | 907/3000 [00:00<00:01, 1821.84it/s]warmup should be done:  30%|███       | 904/3000 [00:00<00:01, 1828.22it/s]warmup should be done:  28%|██▊       | 846/3000 [00:00<00:01, 1710.37it/s]warmup should be done:  36%|███▋      | 1090/3000 [00:00<00:01, 1824.29it/s]warmup should be done:  36%|███▋      | 1089/3000 [00:00<00:01, 1834.18it/s]warmup should be done:  36%|███▌      | 1072/3000 [00:00<00:01, 1779.75it/s]warmup should be done:  34%|███▍      | 1021/3000 [00:00<00:01, 1722.35it/s]warmup should be done:  42%|████▏     | 1250/3000 [00:00<00:00, 1778.46it/s]warmup should be done:  42%|████▏     | 1274/3000 [00:00<00:00, 1836.25it/s]warmup should be done:  40%|███▉      | 1194/3000 [00:00<00:01, 1718.36it/s]warmup should be done:  42%|████▏     | 1273/3000 [00:00<00:00, 1764.62it/s]warmup should be done:  48%|████▊     | 1429/3000 [00:00<00:00, 1781.24it/s]warmup should be done:  49%|████▊     | 1460/3000 [00:00<00:00, 1840.81it/s]warmup should be done:  46%|████▌     | 1366/3000 [00:00<00:00, 1715.75it/s]warmup should be done:  48%|████▊     | 1451/3000 [00:00<00:00, 1769.02it/s]warmup should be done:  54%|█████▎    | 1608/3000 [00:00<00:00, 1781.32it/s]warmup should be done:  55%|█████▍    | 1645/3000 [00:00<00:00, 1842.88it/s]warmup should be done:  51%|█████▏    | 1538/3000 [00:00<00:00, 1700.58it/s]warmup should be done:  54%|█████▍    | 1632/3000 [00:00<00:00, 1780.66it/s]warmup should be done:  61%|██████    | 1831/3000 [00:01<00:00, 1845.34it/s]warmup should be done:  60%|█████▉    | 1787/3000 [00:01<00:00, 1778.67it/s]warmup should be done:  57%|█████▋    | 1709/3000 [00:01<00:00, 1687.78it/s]warmup should be done:  61%|██████    | 1818/3000 [00:01<00:00, 1802.43it/s]warmup should be done:  67%|██████▋   | 2016/3000 [00:01<00:00, 1845.06it/s]warmup should be done:  66%|██████▌   | 1965/3000 [00:01<00:00, 1777.97it/s]warmup should be done:  63%|██████▎   | 1878/3000 [00:01<00:00, 1688.27it/s]warmup should be done:  67%|██████▋   | 2004/3000 [00:01<00:00, 1818.04it/s]warmup should be done:  71%|███████▏  | 2143/3000 [00:01<00:00, 1777.50it/s]warmup should be done:  73%|███████▎  | 2201/3000 [00:01<00:00, 1840.24it/s]warmup should be done:  69%|██████▊   | 2061/3000 [00:01<00:00, 1728.29it/s]warmup should be done:  73%|███████▎  | 2190/3000 [00:01<00:00, 1829.03it/s]warmup should be done:  77%|███████▋  | 2321/3000 [00:01<00:00, 1774.84it/s]warmup should be done:  80%|███████▉  | 2386/3000 [00:01<00:00, 1838.53it/s]warmup should be done:  75%|███████▍  | 2242/3000 [00:01<00:00, 1752.59it/s]warmup should be done:  79%|███████▉  | 2376/3000 [00:01<00:00, 1835.74it/s]warmup should be done:  83%|████████▎ | 2499/3000 [00:01<00:00, 1774.05it/s]warmup should be done:  81%|████████  | 2420/3000 [00:01<00:00, 1758.31it/s]warmup should be done:  85%|████████▌ | 2562/3000 [00:01<00:00, 1841.13it/s]warmup should be done:  86%|████████▌ | 2570/3000 [00:01<00:00, 1736.16it/s]warmup should be done:  89%|████████▉ | 2679/3000 [00:01<00:00, 1779.96it/s]warmup should be done:  87%|████████▋ | 2600/3000 [00:01<00:00, 1768.27it/s]warmup should be done:  92%|█████████▏| 2747/3000 [00:01<00:00, 1839.91it/s]warmup should be done:  92%|█████████▏| 2746/3000 [00:01<00:00, 1740.97it/s]warmup should be done:  95%|█████████▌| 2862/3000 [00:01<00:00, 1793.19it/s]warmup should be done:  93%|█████████▎| 2781/3000 [00:01<00:00, 1779.37it/s]warmup should be done:  98%|█████████▊| 2932/3000 [00:01<00:00, 1819.90it/s]warmup should be done:  98%|█████████▊| 2930/3000 [00:01<00:00, 1768.51it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1810.81it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1802.60it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1783.79it/s]warmup should be done:  99%|█████████▊| 2962/3000 [00:01<00:00, 1787.19it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1730.45it/s]2022-12-11 22:42:10.627454: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0a5a264330 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:42:10.627512: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:42:10.630913: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0a5a268a60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:42:10.630948: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:42:12.225267: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:42:12.237206: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:42:13.346256: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:42:13.354474: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:42:14.766939: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:42:14.777787: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:42:23.720178: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0a5aa68110 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:42:23.720239: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:42:24.025870: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0a62a6b120 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:42:24.025933: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:42:25.339704: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:42:26.434292: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:42:26.966469: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:42:27.878118: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:42:28.413814: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:42:30.131881: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][22:43:01.931][ERROR][RK0][tid #139682671228672]: replica 0 reaches 1000, calling init pre replica
[HCTR][22:43:01.932][ERROR][RK0][tid #139682671228672]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:43:01.936][ERROR][RK0][tid #139682671228672]: coll ps creation done
[HCTR][22:43:01.936][ERROR][RK0][tid #139682671228672]: replica 0 waits for coll ps creation barrier
[HCTR][22:43:02.012][ERROR][RK0][tid #139682671228672]: replica 3 reaches 1000, calling init pre replica
[HCTR][22:43:02.012][ERROR][RK0][tid #139682671228672]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:43:02.015][ERROR][RK0][tid #139682671228672]: coll ps creation done
[HCTR][22:43:02.015][ERROR][RK0][tid #139682671228672]: replica 3 waits for coll ps creation barrier
[HCTR][22:43:02.084][ERROR][RK0][tid #139682671228672]: replica 1 reaches 1000, calling init pre replica
[HCTR][22:43:02.084][ERROR][RK0][tid #139682671228672]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:43:02.088][ERROR][RK0][tid #139682671228672]: coll ps creation done
[HCTR][22:43:02.088][ERROR][RK0][tid #139682671228672]: replica 1 waits for coll ps creation barrier
[HCTR][22:43:02.115][ERROR][RK0][tid #139683157743360]: replica 2 reaches 1000, calling init pre replica
[HCTR][22:43:02.116][ERROR][RK0][tid #139683157743360]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:43:02.119][ERROR][RK0][tid #139683157743360]: coll ps creation done
[HCTR][22:43:02.119][ERROR][RK0][tid #139683157743360]: replica 2 waits for coll ps creation barrier
[HCTR][22:43:02.119][ERROR][RK0][tid #139682671228672]: replica 0 preparing frequency
[HCTR][22:43:03.375][ERROR][RK0][tid #139682671228672]: replica 0 preparing frequency done
[HCTR][22:43:03.405][ERROR][RK0][tid #139682671228672]: replica 0 calling init per replica
[HCTR][22:43:03.405][ERROR][RK0][tid #139683157743360]: replica 2 calling init per replica
[HCTR][22:43:03.405][ERROR][RK0][tid #139682671228672]: replica 3 calling init per replica
[HCTR][22:43:03.405][ERROR][RK0][tid #139682671228672]: Calling build_v2
[HCTR][22:43:03.405][ERROR][RK0][tid #139683157743360]: Calling build_v2
[HCTR][22:43:03.405][ERROR][RK0][tid #139682671228672]: replica 1 calling init per replica
[HCTR][22:43:03.405][ERROR][RK0][tid #139682671228672]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:43:03.405][ERROR][RK0][tid #139683157743360]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:43:03.405][ERROR][RK0][tid #139682671228672]: Calling build_v2
[HCTR][22:43:03.405][ERROR][RK0][tid #139682671228672]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:43:03.405][ERROR][RK0][tid #139682671228672]: Calling build_v2
[HCTR][22:43:03.405][ERROR][RK0][tid #139682671228672]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 22:43:03[.405433: E [2022-12-11 22:43:03/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc.:4054572022-12-11 22:43:03136: .] E405463using concurrent impl MPSPhase [: 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE2022-12-11 22:43:03: .136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc405510] :: using concurrent impl MPSPhase136E
]  using concurrent impl MPSPhase/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc
:136] using concurrent impl MPSPhase
[2022-12-11 22:43:03.406699: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 22:43:03.406745: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 22:43:03.406786: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 22:43:03.406815: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 22:43:03.406832: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 22:43:03.406883: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 22:43:03212.] 406896build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 22:43:03[196.2022-12-11 22:43:03] 406938.assigning 8 to cpu: 406951
E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc [:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 22:43:03196:.] 213407030assigning 8 to cpu] : 
remote time is 8.68421E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212[] 2022-12-11 22:43:03build symm link desc with 4X Tesla V100-SXM2-16GB out of 4.
407114: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214[[] 2022-12-11 22:43:032022-12-11 22:43:03cpu time is 30..
407126407154: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::212213] ] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4remote time is 8.68421

[2022-12-11 22:43:03.407253: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 22:43:03:.214407259] : cpu time is 30E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 22:43:03.407320: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 22:43:27.486016: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 22:43:27.549640: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 22:43:27.549746: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 22:43:27.550836: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 22:43:27.690355: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 22:43:28. 76732: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 22:43:28. 76911: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 22:43:35.599034: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 22:43:35.599239: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 22:43:37.370379: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 22:43:37.370494: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 22:43:37.405229: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 22:43:37.405315: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 22:43:37.432029: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 22:43:37.444741: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 22:43:37.445557: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 22:43:37.455511: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 22:43:37.550392: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 22:43:37.553588: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 22:43:37.556157: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 22:43:37.558646: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 22:43:37.561165: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 22:43:40.341500: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 22:43:40.346054: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 22:43:40.346213: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 22:43:40.355096: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 22:43:40.355155: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 22:43:40.355190: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 22:43:40.355220: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 22:43:40.356077: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:43:40.356120: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:43:40.356952: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:43:40.357491: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:43:40.376980: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 22:43:40.377084: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 22:43:40.377778: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:43:40.377830: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:43:40.378676: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:43:40.379236: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:43:40.385542: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 22:43:40.385638: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:[205] worker 0 thread 3 initing device 32022-12-11 22:43:40
.385606: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 22:43:40.385706: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 22:43:40.386358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:43:40.386414: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:43:40.386692: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:43:40.386753: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:43:40.387743: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:43:40.388444: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:43:40.388472: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:43:40.390223: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:43:40.431949: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 22:43:40.433771: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 22:43:40.433820: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:43:40.434640: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:43:40.435085: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:43:40.436017: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:43:40.436057: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.51 MB
[2022-12-11 22:43:40.446673: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 22:43:40.448502: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 22:43:40.448551: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:43:40.449314: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:43:40.449743: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:43:40.450662: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:43:40.450708: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.52 MB
[2022-12-11 22:43:40.462214: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:43:40.462805: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:43:40.462847: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[2022-12-11 22:43:40.476954: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:43:40.477527: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:43:40.477569: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[[2022-12-11 22:43:402022-12-11 22:43:40..484132484132: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-11 22:43:40.485951: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 22:43:40.485978: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 10212022-12-11 22:43:40
.486002: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000[
2022-12-11 22:43:40.486030: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:43:40.486836: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:43:40.487327: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:43:40.487733: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:43:40.487860: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:43:40.488660: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:43:40.488702: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.52 MB
[2022-12-11 22:43:40.488819: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:43:40.488862: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.52 MB
[2022-12-11 22:43:40.504689: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:43:40.504900: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:43:40.505280: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:43:40.505322: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[2022-12-11 22:43:40.505466: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:43:40.505507: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[[[[2022-12-11 22:43:402022-12-11 22:43:402022-12-11 22:43:40.2022-12-11 22:43:40..848379.848374848374: 848383: : E: EE E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::1926:19261926] 1926] ] Device 2 init p2p of link 3] Device 1 init p2p of link 2Device 3 init p2p of link 0
Device 0 init p2p of link 1


[2022-12-11 22:43:40.848708[: [2022-12-11 22:43:40E2022-12-11 22:43:40. .848713/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu848719: :: E1980E ]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:
:19801980] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[2022-12-11 22:43:40.848989: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:43:40.849580: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 22:43:40eager release cuda mem 625663.
849597: E[ 2022-12-11 22:43:40/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:849628638: ] Eeager release cuda mem 625663 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:43:40.849792: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:43:40.853665: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 22:43:40.853757: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:43:40.854311: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 22:43:40.854405: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:43:40.854492: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 22:43:40.854547: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-11 22:43:40
.[8545632022-12-11 22:43:40: .E854593 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1926/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :Device 1 init p2p of link 31980
] eager alloc mem 611.00 KB
[2022-12-11 22:43:40.854700: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:43:40.855190: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:43:40.855390: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:43:40.855512: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:43:40.858402: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-11 22:43:401926.] 858425Device 3 init p2p of link 2: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 22:43:40.858544: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB[
2022-12-11 22:43:40.858568: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:43:40.859294: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 22:43:40.859346: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:[6382022-12-11 22:43:40[] .2022-12-11 22:43:40eager release cuda mem 625663859364.
: 859374E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu638:] 1980eager release cuda mem 625663] 
eager alloc mem 611.00 KB
[2022-12-11 22:43:40.859965: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 22:43:40.860062: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:43:40.860190: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:43:40.860863: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:43:40.863155: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:43:40.863435: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-11 22:43:401955.] 863446: Asymm Coll cache (policy: coll_cache_asymm_link) | local 7999129 / 100000000 nodes ( 8.00 %~8.00 %) | remote 22125977 / 100000000 nodes ( 22.13 %) | cpu 69874894 / 100000000 nodes ( 69.87 %) | 3.82 GB | 0.485621 secs E[
 2022-12-11 22:43:40/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:863467638: ] Eeager release cuda mem 32399996 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:43:40.863856: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7999499 / 100000000 nodes ( 8.00 %~8.00 %) | remote 22125607 / 100000000 nodes ( 22.13 %) | cpu 69874894 / 100000000 nodes ( 69.87 %) | 3.82 GB | 0.507742 secs 
[2022-12-11 22:43:40.863944: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7999766 / 100000000 nodes ( 8.00 %~8.00 %) | remote 22125340 / 100000000 nodes ( 22.13 %) | cpu 69874894 / 100000000 nodes ( 69.87 %) | 3.82 GB | 0.477548 secs 
[2022-12-11 22:43:40.864225: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 8.85 GB
[2022-12-11 22:43:40.864575: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:43:40.864839: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7999835 / 100000000 nodes ( 8.00 %~8.00 %) | remote 22125271 / 100000000 nodes ( 22.13 %) | cpu 69874894 / 100000000 nodes ( 69.87 %) | 3.82 GB | 0.478107 secs 
[2022-12-11 22:43:41.687512: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 9.09 GB
[2022-12-11 22:43:41.687652: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 9.09 GB
[2022-12-11 22:43:41.687990: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 9.09 GB
[2022-12-11 22:43:42.672078: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 9.34 GB
[2022-12-11 22:43:42.672328: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 9.34 GB
[2022-12-11 22:43:42.672935: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 9.34 GB
[2022-12-11 22:43:43.384621: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 9.59 GB
[2022-12-11 22:43:43.384748: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 9.59 GB
[2022-12-11 22:43:43.385074: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 9.59 GB
[2022-12-11 22:43:43.385311: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 9.59 GB
[2022-12-11 22:43:43.385582: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 9.59 GB
[2022-12-11 22:43:44. 10561: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 9.78 GB
[2022-12-11 22:43:44. 10681: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 9.78 GB
[HCTR][22:43:44.036][ERROR][RK0][tid #139682671228672]: replica 0 calling init per replica done, doing barrier
[HCTR][22:43:44.036][ERROR][RK0][tid #139683157743360]: replica 2 calling init per replica done, doing barrier
[HCTR][22:43:44.036][ERROR][RK0][tid #139682671228672]: replica 3 calling init per replica done, doing barrier
[HCTR][22:43:44.036][ERROR][RK0][tid #139682671228672]: replica 1 calling init per replica done, doing barrier
[HCTR][22:43:44.036][ERROR][RK0][tid #139682671228672]: replica 0 calling init per replica done, doing barrier done
[HCTR][22:43:44.036][ERROR][RK0][tid #139682671228672]: replica 1 calling init per replica done, doing barrier done
[HCTR][22:43:44.036][ERROR][RK0][tid #139683157743360]: replica 2 calling init per replica done, doing barrier done
[HCTR][22:43:44.036][ERROR][RK0][tid #139682671228672]: replica 3 calling init per replica done, doing barrier done
[HCTR][22:43:44.036][ERROR][RK0][tid #139682671228672]: init per replica done
[HCTR][22:43:44.036][ERROR][RK0][tid #139683157743360]: init per replica done
[HCTR][22:43:44.036][ERROR][RK0][tid #139682671228672]: init per replica done
[HCTR][22:43:44.043][ERROR][RK0][tid #139683157743360]: 2 allocated 3276800 at 0x7ef857720000
[HCTR][22:43:44.043][ERROR][RK0][tid #139683157743360]: 2 allocated 6553600 at 0x7f0bea600000
[HCTR][22:43:44.043][ERROR][RK0][tid #139683157743360]: 2 allocated 3276800 at 0x7f0beac40000
[HCTR][22:43:44.043][ERROR][RK0][main]: 3 allocated 3276800 at 0x7ef85b720000
[HCTR][22:43:44.043][ERROR][RK0][tid #139683157743360]: 2 allocated 6553600 at 0x7f0beaf60000
[HCTR][22:43:44.043][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f0bea600000
[HCTR][22:43:44.043][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f0beac40000
[HCTR][22:43:44.043][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f0beaf60000
[HCTR][22:43:44.047][ERROR][RK0][tid #139682671228672]: 1 allocated 3276800 at 0x7ef85b720000
[HCTR][22:43:44.047][ERROR][RK0][tid #139682671228672]: 1 allocated 6553600 at 0x7f0bea600000
[HCTR][22:43:44.047][ERROR][RK0][tid #139682671228672]: 1 allocated 3276800 at 0x7f0beac40000
[HCTR][22:43:44.047][ERROR][RK0][tid #139682671228672]: 1 allocated 6553600 at 0x7f0beaf60000
[HCTR][22:43:44.079][ERROR][RK0][tid #139682671228672]: init per replica done
[HCTR][22:43:44.089][ERROR][RK0][main]: 0 allocated 3276800 at 0x7ef5ee920000
[HCTR][22:43:44.089][ERROR][RK0][main]: 0 allocated 6553600 at 0x7ef5eee00000
[HCTR][22:43:44.089][ERROR][RK0][main]: 0 allocated 3276800 at 0x7ef35e50e800
[HCTR][22:43:44.089][ERROR][RK0][main]: 0 allocated 6553600 at 0x7ef35e82e800




