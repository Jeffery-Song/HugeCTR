2022-12-11 23:56:30.201180: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:56:30.268733: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:56:30.268955: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:56:30.271994: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:56:31.131144: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:56:31.131224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:56:31.143926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:56:31.174328: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:56:31.174501: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:56:31.176106: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 23:56:31.195753: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:56:31.195828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:56:31.199701: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:56:31.199770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:56:31.208751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:56:31.209106: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:56:31.209202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:56:31.211669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:56:31.221561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:56:31.238839: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:56:31.239003: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:56:31.239827: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 23:56:31.240784: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:56:31.240937: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:56:31.241950: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 23:56:31.253183: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:56:31.253322: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:56:31.254040: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][23:56:32.492][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:56:32.492][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:56:32.531][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:56:32.537][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.56s/it]warmup run: 104it [00:01, 86.77it/s]warmup run: 190it [00:01, 169.15it/s]warmup run: 267it [00:01, 248.51it/s]warmup run: 376it [00:01, 381.78it/s]warmup run: 484it [00:02, 510.49it/s]warmup run: 1it [00:01,  1.47s/it]warmup run: 590it [00:02, 624.08it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 105it [00:01, 92.95it/s]warmup run: 100it [00:01, 91.99it/s]warmup run: 688it [00:02, 681.15it/s]warmup run: 209it [00:01, 199.46it/s]warmup run: 206it [00:01, 204.56it/s]warmup run: 794it [00:02, 770.67it/s]warmup run: 313it [00:01, 315.53it/s]warmup run: 311it [00:01, 325.02it/s]warmup run: 895it [00:02, 831.32it/s]warmup run: 403it [00:01, 411.91it/s]warmup run: 416it [00:01, 447.57it/s]warmup run: 996it [00:02, 877.24it/s]warmup run: 496it [00:01, 510.69it/s]warmup run: 0it [00:00, ?it/s]warmup run: 512it [00:01, 544.15it/s]warmup run: 1095it [00:02, 902.90it/s]warmup run: 592it [00:02, 606.42it/s]warmup run: 620it [00:02, 659.00it/s]warmup run: 1197it [00:02, 933.31it/s]warmup run: 704it [00:02, 725.45it/s]warmup run: 727it [00:02, 754.78it/s]warmup run: 1297it [00:02, 933.48it/s]warmup run: 816it [00:02, 822.32it/s]warmup run: 832it [00:02, 827.88it/s]warmup run: 1395it [00:02, 941.36it/s]warmup run: 926it [00:02, 894.34it/s]warmup run: 937it [00:02, 884.51it/s]warmup run: 1504it [00:03, 983.78it/s]warmup run: 1032it [00:02, 938.69it/s]warmup run: 1040it [00:02, 898.01it/s]warmup run: 1605it [00:03, 960.03it/s]warmup run: 1137it [00:02, 948.01it/s]warmup run: 1143it [00:02, 933.21it/s]warmup run: 1703it [00:03, 954.93it/s]warmup run: 1240it [00:02, 966.09it/s]warmup run: 1247it [00:02, 962.06it/s]warmup run: 1814it [00:03, 998.15it/s]warmup run: 1350it [00:02, 1004.22it/s]warmup run: 1353it [00:02, 987.56it/s]warmup run: 1919it [00:03, 1012.20it/s]warmup run: 1456it [00:02, 1019.65it/s]warmup run: 1456it [00:02, 993.04it/s]warmup run: 2029it [00:03, 1035.99it/s]warmup run: 1561it [00:02, 1014.86it/s]warmup run: 1558it [00:02, 986.69it/s]warmup run: 2161it [00:03, 1117.48it/s]warmup run: 1665it [00:03, 1000.12it/s]warmup run: 1659it [00:03, 991.82it/s]warmup run: 2294it [00:03, 1178.73it/s]warmup run: 1767it [00:03, 1004.81it/s]warmup run: 1760it [00:03, 988.11it/s]warmup run: 2427it [00:03, 1220.65it/s]warmup run: 1869it [00:03, 1005.98it/s]warmup run: 1862it [00:03, 995.68it/s]warmup run: 2559it [00:04, 1249.18it/s]warmup run: 1975it [00:03, 1020.18it/s]warmup run: 1963it [00:03, 985.00it/s]warmup run: 2691it [00:04, 1268.75it/s]warmup run: 1it [00:01,  1.47s/it]warmup run: 2100it [00:03, 1087.11it/s]warmup run: 2080it [00:03, 1038.95it/s]warmup run: 2825it [00:04, 1289.63it/s]warmup run: 107it [00:01, 94.23it/s]warmup run: 2230it [00:03, 1150.05it/s]warmup run: 2210it [00:03, 1114.36it/s]warmup run: 2960it [00:04, 1305.51it/s]warmup run: 215it [00:01, 204.53it/s]warmup run: 3000it [00:04, 689.07it/s] warmup run: 2362it [00:03, 1200.04it/s]warmup run: 2334it [00:03, 1151.08it/s]warmup run: 323it [00:01, 324.90it/s]warmup run: 2494it [00:03, 1234.44it/s]warmup run: 2463it [00:03, 1192.18it/s]warmup run: 431it [00:01, 448.89it/s]warmup run: 2624it [00:03, 1253.54it/s]warmup run: 2583it [00:03, 1176.39it/s]warmup run: 539it [00:01, 568.75it/s]warmup run: 2755it [00:03, 1267.03it/s]warmup run: 2712it [00:03, 1209.53it/s]warmup run: 649it [00:02, 680.98it/s]warmup run: 2886it [00:04, 1279.28it/s]warmup run: 2842it [00:04, 1234.37it/s]warmup run: 759it [00:02, 778.42it/s]warmup run: 3000it [00:04, 715.42it/s] warmup run: 2968it [00:04, 1239.38it/s]warmup run: 868it [00:02, 856.03it/s]warmup run: 3000it [00:04, 717.23it/s] warmup run: 977it [00:02, 915.88it/s]warmup run: 1085it [00:02, 954.45it/s]warmup run: 1194it [00:02, 990.69it/s]warmup run: 1302it [00:02, 1016.02it/s]warmup run: 1411it [00:02, 1036.16it/s]warmup run: 1519it [00:02, 1039.15it/s]warmup run: 1630it [00:02, 1058.78it/s]warmup run: 1741it [00:03, 1071.63it/s]warmup run: 1850it [00:03, 1072.82it/s]warmup run: 1961it [00:03, 1080.93it/s]warmup run: 2087it [00:03, 1131.84it/s]warmup run: 2222it [00:03, 1194.80it/s]warmup run: 2358it [00:03, 1241.23it/s]warmup run: 2493it [00:03, 1273.30it/s]warmup run: 2627it [00:03, 1290.61it/s]warmup run: 2764it [00:03, 1312.43it/s]warmup run: 2900it [00:03, 1325.73it/s]warmup run: 3000it [00:04, 736.69it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   5%|▌         | 163/3000 [00:00<00:01, 1625.35it/s]warmup should be done:   5%|▌         | 151/3000 [00:00<00:01, 1503.14it/s]warmup should be done:   4%|▍         | 120/3000 [00:00<00:02, 1193.43it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1666.90it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1719.08it/s]warmup should be done:  11%|█▏        | 343/3000 [00:00<00:01, 1720.94it/s]warmup should be done:  11%|█         | 330/3000 [00:00<00:01, 1668.56it/s]warmup should be done:  10%|▉         | 289/3000 [00:00<00:01, 1479.89it/s]warmup should be done:  17%|█▋        | 520/3000 [00:00<00:01, 1745.55it/s]warmup should be done:  17%|█▋        | 507/3000 [00:00<00:01, 1714.49it/s]warmup should be done:  17%|█▋        | 518/3000 [00:00<00:01, 1730.54it/s]warmup should be done:  15%|█▌        | 457/3000 [00:00<00:01, 1569.14it/s]warmup should be done:  23%|██▎       | 699/3000 [00:00<00:01, 1761.47it/s]warmup should be done:  23%|██▎       | 684/3000 [00:00<00:01, 1734.94it/s]warmup should be done:  20%|██        | 615/3000 [00:00<00:01, 1573.16it/s]warmup should be done:  23%|██▎       | 692/3000 [00:00<00:01, 1727.72it/s]warmup should be done:  29%|██▉       | 877/3000 [00:00<00:01, 1766.69it/s]warmup should be done:  29%|██▊       | 860/3000 [00:00<00:01, 1741.70it/s]warmup should be done:  26%|██▋       | 792/3000 [00:00<00:01, 1641.30it/s]warmup should be done:  29%|██▉       | 867/3000 [00:00<00:01, 1735.19it/s]warmup should be done:  35%|███▌      | 1055/3000 [00:00<00:01, 1770.13it/s]warmup should be done:  35%|███▍      | 1037/3000 [00:00<00:01, 1750.99it/s]warmup should be done:  32%|███▏      | 967/3000 [00:00<00:01, 1676.33it/s]warmup should be done:  35%|███▍      | 1043/3000 [00:00<00:01, 1740.27it/s]warmup should be done:  40%|████      | 1213/3000 [00:00<00:01, 1753.88it/s]warmup should be done:  41%|████      | 1233/3000 [00:00<00:00, 1769.56it/s]warmup should be done:  41%|████      | 1218/3000 [00:00<00:01, 1740.02it/s]warmup should be done:  38%|███▊      | 1135/3000 [00:00<00:01, 1657.46it/s]warmup should be done:  47%|████▋     | 1411/3000 [00:00<00:00, 1772.50it/s]warmup should be done:  46%|████▋     | 1391/3000 [00:00<00:00, 1759.13it/s]warmup should be done:  46%|████▋     | 1394/3000 [00:00<00:00, 1743.25it/s]warmup should be done:  44%|████▎     | 1306/3000 [00:00<00:01, 1669.74it/s]warmup should be done:  52%|█████▏    | 1569/3000 [00:00<00:00, 1764.21it/s]warmup should be done:  53%|█████▎    | 1589/3000 [00:00<00:00, 1764.56it/s]warmup should be done:  52%|█████▏    | 1569/3000 [00:00<00:00, 1740.28it/s]warmup should be done:  49%|████▉     | 1474/3000 [00:00<00:00, 1662.64it/s]warmup should be done:  58%|█████▊    | 1746/3000 [00:01<00:00, 1762.85it/s]warmup should be done:  58%|█████▊    | 1744/3000 [00:01<00:00, 1737.10it/s]warmup should be done:  55%|█████▌    | 1651/3000 [00:01<00:00, 1692.69it/s]warmup should be done:  59%|█████▉    | 1766/3000 [00:01<00:00, 1720.63it/s]warmup should be done:  64%|██████▍   | 1923/3000 [00:01<00:00, 1762.72it/s]warmup should be done:  64%|██████▍   | 1918/3000 [00:01<00:00, 1732.34it/s]warmup should be done:  61%|██████    | 1828/3000 [00:01<00:00, 1714.71it/s]warmup should be done:  65%|██████▍   | 1943/3000 [00:01<00:00, 1734.14it/s]warmup should be done:  70%|███████   | 2100/3000 [00:01<00:00, 1763.99it/s]warmup should be done:  70%|██████▉   | 2092/3000 [00:01<00:00, 1731.91it/s]warmup should be done:  67%|██████▋   | 2005/3000 [00:01<00:00, 1729.60it/s]warmup should be done:  71%|███████   | 2121/3000 [00:01<00:00, 1745.75it/s]warmup should be done:  76%|███████▌  | 2277/3000 [00:01<00:00, 1765.25it/s]warmup should be done:  76%|███████▌  | 2266/3000 [00:01<00:00, 1731.54it/s]warmup should be done:  73%|███████▎  | 2182/3000 [00:01<00:00, 1739.80it/s]warmup should be done:  77%|███████▋  | 2299/3000 [00:01<00:00, 1754.78it/s]warmup should be done:  82%|████████▏ | 2455/3000 [00:01<00:00, 1767.18it/s]warmup should be done:  81%|████████▏ | 2440/3000 [00:01<00:00, 1732.46it/s]warmup should be done:  79%|███████▊  | 2359/3000 [00:01<00:00, 1746.32it/s]warmup should be done:  83%|████████▎ | 2477/3000 [00:01<00:00, 1761.49it/s]warmup should be done:  88%|████████▊ | 2632/3000 [00:01<00:00, 1767.31it/s]warmup should be done:  87%|████████▋ | 2614/3000 [00:01<00:00, 1733.91it/s]warmup should be done:  85%|████████▍ | 2537/3000 [00:01<00:00, 1756.06it/s]warmup should be done:  88%|████████▊ | 2655/3000 [00:01<00:00, 1766.35it/s]warmup should be done:  94%|█████████▎| 2809/3000 [00:01<00:00, 1768.01it/s]warmup should be done:  93%|█████████▎| 2788/3000 [00:01<00:00, 1735.05it/s]warmup should be done:  90%|█████████ | 2714/3000 [00:01<00:00, 1757.95it/s]warmup should be done:  94%|█████████▍| 2832/3000 [00:01<00:00, 1747.81it/s]warmup should be done: 100%|█████████▉| 2987/3000 [00:01<00:00, 1770.63it/s]warmup should be done:  99%|█████████▊| 2962/3000 [00:01<00:00, 1735.28it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1752.52it/s]warmup should be done:  96%|█████████▋| 2892/3000 [00:01<00:00, 1761.86it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1752.05it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1733.65it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1692.69it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 182/3000 [00:00<00:01, 1814.74it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1746.15it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1705.10it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1651.67it/s]warmup should be done:  12%|█▏        | 364/3000 [00:00<00:01, 1816.89it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1793.80it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1767.71it/s]warmup should be done:  11%|█         | 332/3000 [00:00<00:01, 1574.43it/s]warmup should be done:  18%|█▊        | 546/3000 [00:00<00:01, 1817.68it/s]warmup should be done:  18%|█▊        | 541/3000 [00:00<00:01, 1809.51it/s]warmup should be done:  18%|█▊        | 532/3000 [00:00<00:01, 1776.32it/s]warmup should be done:  17%|█▋        | 504/3000 [00:00<00:01, 1635.33it/s]warmup should be done:  24%|██▍       | 729/3000 [00:00<00:01, 1820.80it/s]warmup should be done:  24%|██▍       | 725/3000 [00:00<00:01, 1818.01it/s]warmup should be done:  24%|██▎       | 710/3000 [00:00<00:01, 1761.61it/s]warmup should be done:  23%|██▎       | 687/3000 [00:00<00:01, 1707.26it/s]warmup should be done:  30%|███       | 912/3000 [00:00<00:01, 1821.64it/s]warmup should be done:  30%|███       | 909/3000 [00:00<00:01, 1823.56it/s]warmup should be done:  30%|██▉       | 892/3000 [00:00<00:01, 1781.18it/s]warmup should be done:  29%|██▉       | 871/3000 [00:00<00:01, 1753.29it/s]warmup should be done:  36%|███▋      | 1095/3000 [00:00<00:01, 1822.03it/s]warmup should be done:  36%|███▋      | 1093/3000 [00:00<00:01, 1827.54it/s]warmup should be done:  36%|███▌      | 1071/3000 [00:00<00:01, 1782.86it/s]warmup should be done:  35%|███▌      | 1055/3000 [00:00<00:01, 1781.13it/s]warmup should be done:  43%|████▎     | 1276/3000 [00:00<00:00, 1824.11it/s]warmup should be done:  43%|████▎     | 1278/3000 [00:00<00:00, 1817.50it/s]warmup should be done:  42%|████▏     | 1252/3000 [00:00<00:00, 1789.23it/s]warmup should be done:  41%|████▏     | 1238/3000 [00:00<00:00, 1795.48it/s]warmup should be done:  49%|████▊     | 1461/3000 [00:00<00:00, 1819.90it/s]warmup should be done:  49%|████▊     | 1459/3000 [00:00<00:00, 1822.62it/s]warmup should be done:  48%|████▊     | 1431/3000 [00:00<00:00, 1760.27it/s]warmup should be done:  47%|████▋     | 1418/3000 [00:00<00:00, 1791.38it/s]warmup should be done:  55%|█████▍    | 1644/3000 [00:00<00:00, 1822.09it/s]warmup should be done:  55%|█████▍    | 1642/3000 [00:00<00:00, 1823.21it/s]warmup should be done:  54%|█████▎    | 1609/3000 [00:00<00:00, 1764.28it/s]warmup should be done:  53%|█████▎    | 1601/3000 [00:00<00:00, 1801.95it/s]warmup should be done:  61%|██████    | 1828/3000 [00:01<00:00, 1824.80it/s]warmup should be done:  61%|██████    | 1825/3000 [00:01<00:00, 1824.01it/s]warmup should be done:  60%|█████▉    | 1786/3000 [00:01<00:00, 1749.88it/s]warmup should be done:  60%|█████▉    | 1785/3000 [00:01<00:00, 1810.69it/s]warmup should be done:  67%|██████▋   | 2011/3000 [00:01<00:00, 1823.35it/s]warmup should be done:  65%|██████▌   | 1962/3000 [00:01<00:00, 1751.88it/s]warmup should be done:  66%|██████▌   | 1969/3000 [00:01<00:00, 1816.63it/s]warmup should be done:  67%|██████▋   | 2008/3000 [00:01<00:00, 1765.85it/s]warmup should be done:  73%|███████▎  | 2194/3000 [00:01<00:00, 1822.46it/s]warmup should be done:  73%|███████▎  | 2193/3000 [00:01<00:00, 1790.13it/s]warmup should be done:  72%|███████▏  | 2151/3000 [00:01<00:00, 1800.53it/s]warmup should be done:  71%|███████▏  | 2138/3000 [00:01<00:00, 1724.95it/s]warmup should be done:  79%|███████▉  | 2377/3000 [00:01<00:00, 1820.18it/s]warmup should be done:  79%|███████▉  | 2379/3000 [00:01<00:00, 1808.05it/s]warmup should be done:  78%|███████▊  | 2333/3000 [00:01<00:00, 1804.42it/s]warmup should be done:  77%|███████▋  | 2319/3000 [00:01<00:00, 1749.17it/s]warmup should be done:  85%|████████▌ | 2560/3000 [00:01<00:00, 1818.48it/s]warmup should be done:  86%|████████▌ | 2565/3000 [00:01<00:00, 1822.07it/s]warmup should be done:  84%|████████▍ | 2514/3000 [00:01<00:00, 1804.86it/s]warmup should be done:  83%|████████▎ | 2495/3000 [00:01<00:00, 1746.33it/s]warmup should be done:  91%|█████████▏| 2742/3000 [00:01<00:00, 1817.26it/s]warmup should be done:  92%|█████████▏| 2751/3000 [00:01<00:00, 1830.92it/s]warmup should be done:  90%|████████▉ | 2695/3000 [00:01<00:00, 1806.29it/s]warmup should be done:  89%|████████▉ | 2675/3000 [00:01<00:00, 1762.04it/s]warmup should be done:  98%|█████████▊| 2925/3000 [00:01<00:00, 1819.51it/s]warmup should be done:  98%|█████████▊| 2937/3000 [00:01<00:00, 1838.78it/s]warmup should be done:  96%|█████████▌| 2877/3000 [00:01<00:00, 1808.31it/s]warmup should be done:  95%|█████████▌| 2857/3000 [00:01<00:00, 1776.96it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1820.12it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1817.83it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1780.17it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1762.50it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f64cf144040>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f64cf144130>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f64cf143280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f64cf406e80>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 23:57:43.973674: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f60a5a681e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:57:43.973735: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:57:43.980835: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:57:45.051766: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:57:45.920991: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f60a5268160 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:57:45.921065: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:57:45.928801: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f609d26ea70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:57:45.928847: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:57:45.929202: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:57:45.930158: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f60a5a67650 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:57:45.930192: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:57:45.936081: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:57:45.938249: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:57:46.781289: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:57:46.796116: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:57:46.808111: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:57:51.115168: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:57:52.139644: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:57:52.150718: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:57:53.189814: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][23:58:47.364][ERROR][RK0][tid #140053246375680]: replica 3 reaches 1000, calling init pre replica
[HCTR][23:58:47.364][ERROR][RK0][tid #140053246375680]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:58:47.368][ERROR][RK0][tid #140053246375680]: coll ps creation done
[HCTR][23:58:47.368][ERROR][RK0][tid #140053246375680]: replica 3 waits for coll ps creation barrier
[HCTR][23:58:47.472][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][23:58:47.472][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:58:47.477][ERROR][RK0][main]: coll ps creation done
[HCTR][23:58:47.477][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][23:58:47.493][ERROR][RK0][tid #140053237982976]: replica 1 reaches 1000, calling init pre replica
[HCTR][23:58:47.493][ERROR][RK0][tid #140053237982976]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:58:47.497][ERROR][RK0][tid #140053237982976]: coll ps creation done
[HCTR][23:58:47.497][ERROR][RK0][tid #140053237982976]: replica 1 waits for coll ps creation barrier
[HCTR][23:58:47.591][ERROR][RK0][tid #140053237982976]: replica 2 reaches 1000, calling init pre replica
[HCTR][23:58:47.591][ERROR][RK0][tid #140053237982976]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:58:47.596][ERROR][RK0][tid #140053237982976]: coll ps creation done
[HCTR][23:58:47.596][ERROR][RK0][tid #140053237982976]: replica 2 waits for coll ps creation barrier
[HCTR][23:58:47.596][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][23:58:48.542][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][23:58:48.571][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][23:58:48.571][ERROR][RK0][tid #140053237982976]: replica 1 calling init per replica
[HCTR][23:58:48.571][ERROR][RK0][tid #140053246375680]: replica 3 calling init per replica
[HCTR][23:58:48.571][ERROR][RK0][tid #140053237982976]: replica 2 calling init per replica
[HCTR][23:58:48.571][ERROR][RK0][main]: Calling build_v2
[HCTR][23:58:48.571][ERROR][RK0][tid #140053237982976]: Calling build_v2
[HCTR][23:58:48.571][ERROR][RK0][tid #140053246375680]: Calling build_v2
[HCTR][23:58:48.571][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:58:48.571][ERROR][RK0][tid #140053237982976]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:58:48.571][ERROR][RK0][tid #140053237982976]: Calling build_v2
[HCTR][23:58:48.571][ERROR][RK0][tid #140053246375680]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:58:48.571][ERROR][RK0][tid #140053237982976]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-11 23:58:482022-12-11 23:58:482022-12-11 23:58:48...571809571809571820: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:::136136136] ] ] using concurrent impl MPSPhaseusing concurrent impl MPSPhaseusing concurrent impl MPSPhase


[2022-12-11 23:58:48.571812: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[2022-12-11 23:58:48.572724: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-11 23:58:48.572748: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196[] 2022-12-11 23:58:48assigning 8 to cpu.
[5727712022-12-11 23:58:48: .E572780 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE[: 2022-12-11 23:58:48196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.] :572807assigning 8 to cpu212: 
] Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 23:58:48.572868[: 2022-12-11 23:58:48E. 572877/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :[E2132022-12-11 23:58:48 ] ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421572891:
: 213E]  [remote time is 8.68421/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 23:58:48
:.212572926] [: build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 23:58:48E
. 572945/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E[214[ 2022-12-11 23:58:48] 2022-12-11 23:58:48/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.cpu time is 30.:572969
572969214: : ] EEcpu time is 30  
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::213196] ] remote time is 8.68421assigning 8 to cpu

[2022-12-11 23:58:48.573048: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 23:58:48.573064: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 23:58:48.573111: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 23:58:48.573141: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 23:59:14.638451: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 23:59:14.706867: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 23:59:14.706969: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 23:59:14.708015: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 23:59:14.795368: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 23:59:15.172549: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 23:59:15.172675: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 23:59:22.564750: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 23:59:22.564942: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 23:59:24.369216: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 23:59:24.369350: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 23:59:24.374557: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 23:59:24.374636: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 23:59:26.457370: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 23:59:26.470443: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 23:59:26.472151: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 23:59:26.482042: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 23:59:26.592781: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 23:59:26.596702: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 23:59:26.600555: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 23:59:26.604120: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 23:59:26.606804: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 23:59:28.283993: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 23:59:28.288632: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 23:59:28.288932: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 23:59:28.300273: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 23:59:28.300388: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 23:59:28.300451: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 23:59:28.300507: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 23:59:28.302828: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:59:28.302914: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:59:28.304604: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:59:28.305624: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:59:28.325452: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 23:59:28.325561: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 23:59:28.326387: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:59:28.326439: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:59:28.327279: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:59:28.327844: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:59:28.328082: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 23:59:28.328178: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 23:59:28.329220: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:59:28.329277: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:59:28.330115: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:59:28.330688: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:59:28.334650: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 23:59:28.334765: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 23:59:28.335761: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:59:28.335817: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:59:28.336720: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:59:28.337287: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:59:28.414258: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:59:28.416844: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:59:28.416905: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:59:28.417746: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:59:28.417970: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:59:28.418228: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:59:28.419204: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:59:28.419261: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.13 MB
[2022-12-11 23:59:28.419882: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:59:28.419937: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:59:28.420754: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:59:28.421221: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:59:28.422189: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:59:28.422233: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.14 MB
[2022-12-11 23:59:28.427481: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:59:28.429345: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:59:28.429391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:59:28.430139: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:59:28.430565: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:59:28.431518: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:59:28.431561: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.14 MB
[2022-12-11 23:59:28.437337: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:59:28.438104: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:59:28.438706: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:59:28.438757: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[2022-12-11 23:59:28.439233: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:59:28.439290: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:59:28.441946: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:59:28.442535: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:59:28.442579: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[2022-12-11 23:59:28.451510: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:59:28.452083: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:59:28.452124: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[2022-12-11 23:59:28.472124: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:59:28.473508: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:59:28.474607: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:59:28.474713: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.14 MB
[2022-12-11 23:59:28.496957: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:59:28.497551: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:59:28.497592: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[[[[2022-12-11 23:59:282022-12-11 23:59:282022-12-11 23:59:282022-12-11 23:59:28....925950925951925960925962: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 0 init p2p of link 1Device 1 init p2p of link 2Device 2 init p2p of link 3



[[2022-12-11 23:59:28[[2022-12-11 23:59:28.2022-12-11 23:59:282022-12-11 23:59:28.926298..926299: 926300926301: E: : E EE /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980::1980] 19801980] eager alloc mem 611.00 KB] ] eager alloc mem 611.00 KB
eager alloc mem 611.00 KBeager alloc mem 611.00 KB


[[2022-12-11 23:59:282022-12-11 23:59:28..927256927257: : E[[E 2022-12-11 23:59:282022-12-11 23:59:28 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc../hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:927278927278:638: : 638] EE] eager release cuda mem 625663  eager release cuda mem 625663
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
::638638] ] eager release cuda mem 625663eager release cuda mem 625663

[2022-12-11 23:59:28.933083: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[[2022-12-11 23:59:282022-12-11 23:59:28..933187933195: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261980] ] Device 3 init p2p of link 1eager alloc mem 611.00 KB

[2022-12-11 23:59:28.933313: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[[:2022-12-11 23:59:282022-12-11 23:59:281926..] 933342933338Device 2 init p2p of link 0: : 
EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801926] ] eager alloc mem 611.00 KBDevice 0 init p2p of link 2

[2022-12-11 23:59:28.933475: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:59:28.933500: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:59:28.934060: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:59:28.934210: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:59:28.934282: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-11 23:59:28
.934302: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:59:28.940215: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 23:59:28.940307: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:59:28.940460: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 23:59:28.940550: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:59:28.940579: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 23:59:28.940664: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:59:28.940679: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 23:59:28.940772: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:59:28.941103: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:59:28.941341: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:59:28.941454: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:59:28.941568: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:59:28.946579: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:59:28.946802: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:59:28.946871: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9998844 / 100000000 nodes ( 10.00 %~10.00 %) | remote 27531361 / 100000000 nodes ( 27.53 %) | cpu 62469795 / 100000000 nodes ( 62.47 %) | 4.77 GB | 0.620447 secs 
[2022-12-11 23:59:28.947015: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:59:28.947090: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9996901 / 100000000 nodes ( 10.00 %~10.00 %) | remote 27533304 / 100000000 nodes ( 27.53 %) | cpu 62469795 / 100000000 nodes ( 62.47 %) | 4.77 GB | 0.617831 secs 
[2022-12-11 23:59:28.947225: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:59:28.947307: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9995523 / 100000000 nodes ( 10.00 %~10.00 %) | remote 27534682 / 100000000 nodes ( 27.53 %) | cpu 62469795 / 100000000 nodes ( 62.47 %) | 4.77 GB | 0.644407 secs 
[2022-12-11 23:59:28.947521: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9998461 / 100000000 nodes ( 10.00 %~10.00 %) | remote 27531744 / 100000000 nodes ( 27.53 %) | cpu 62469795 / 100000000 nodes ( 62.47 %) | 4.77 GB | 0.611723 secs 
[2022-12-11 23:59:28.947720: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 11.47 GB
[2022-12-11 23:59:29.919169: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 11.71 GB
[2022-12-11 23:59:29.919296: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 11.71 GB
[2022-12-11 23:59:29.919800: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 11.71 GB
[2022-12-11 23:59:30.746589: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 11.96 GB
[2022-12-11 23:59:30.746718: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 11.96 GB
[2022-12-11 23:59:30.747053: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 11.96 GB
[2022-12-11 23:59:31.593461: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 12.21 GB
[2022-12-11 23:59:31.593604: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 12.21 GB
[2022-12-11 23:59:31.593949: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 12.21 GB
[2022-12-11 23:59:31.594195: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 12.21 GB
[2022-12-11 23:59:31.594462: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 12.21 GB
[2022-12-11 23:59:32.433997: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 12.40 GB
[2022-12-11 23:59:32.434136: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 12.40 GB
[HCTR][23:59:32.710][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][23:59:32.710][ERROR][RK0][tid #140053237982976]: replica 2 calling init per replica done, doing barrier
[HCTR][23:59:32.710][ERROR][RK0][tid #140053246375680]: replica 3 calling init per replica done, doing barrier
[HCTR][23:59:32.710][ERROR][RK0][tid #140053237982976]: replica 1 calling init per replica done, doing barrier
[HCTR][23:59:32.710][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][23:59:32.710][ERROR][RK0][tid #140053237982976]: replica 1 calling init per replica done, doing barrier done
[HCTR][23:59:32.710][ERROR][RK0][tid #140053246375680]: replica 3 calling init per replica done, doing barrier done
[HCTR][23:59:32.710][ERROR][RK0][tid #140053237982976]: replica 2 calling init per replica done, doing barrier done
[HCTR][23:59:32.710][ERROR][RK0][tid #140053246375680]: init per replica done
[HCTR][23:59:32.710][ERROR][RK0][tid #140053237982976]: init per replica done
[HCTR][23:59:32.710][ERROR][RK0][tid #140053237982976]: init per replica done
[HCTR][23:59:32.713][ERROR][RK0][main]: init per replica done
[HCTR][23:59:32.746][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f460c238400
[HCTR][23:59:32.746][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f460c558400
[HCTR][23:59:32.746][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f460cb98400
[HCTR][23:59:32.746][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f460ceb8400
[HCTR][23:59:32.747][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f4640238400
[HCTR][23:59:32.747][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f4640558400
[HCTR][23:59:32.747][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f4640b98400
[HCTR][23:59:32.747][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f4640eb8400
[HCTR][23:59:32.748][ERROR][RK0][tid #140053237982976]: 1 allocated 3276800 at 0x7f45ac238400
[HCTR][23:59:32.748][ERROR][RK0][tid #140053237982976]: 1 allocated 6553600 at 0x7f45ac558400
[HCTR][23:59:32.748][ERROR][RK0][tid #140053237982976]: 1 allocated 3276800 at 0x7f45acb98400
[HCTR][23:59:32.748][ERROR][RK0][tid #140053237982976]: 1 allocated 6553600 at 0x7f45aceb8400
[HCTR][23:59:32.748][ERROR][RK0][tid #140053237982976]: 0 allocated 3276800 at 0x7f45a4320000
[HCTR][23:59:32.749][ERROR][RK0][tid #140053237982976]: 0 allocated 6553600 at 0x7f45a4640000
[HCTR][23:59:32.749][ERROR][RK0][tid #140053237982976]: 0 allocated 3276800 at 0x7f45a4c80000
[HCTR][23:59:32.749][ERROR][RK0][tid #140053237982976]: 0 allocated 6553600 at 0x7f45a4fa0000
