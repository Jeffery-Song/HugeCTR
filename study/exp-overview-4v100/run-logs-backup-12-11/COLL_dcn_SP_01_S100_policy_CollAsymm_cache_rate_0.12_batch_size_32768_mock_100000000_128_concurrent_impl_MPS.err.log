2022-12-12 00:39:01.740196: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:39:01.750327: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:39:01.832678: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:39:01.862699: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:39:02.664683: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:39:02.664770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 00:39:02.677716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 00:39:02.678964: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:39:02.679023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 00:39:02.692086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 00:39:02.707323: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:39:02.707499: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:39:02.708941: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 00:39:02.718684: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:39:02.718760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 00:39:02.724307: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:39:02.724578: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:39:02.726546: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 00:39:02.731737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 00:39:02.732640: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:39:02.732695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 00:39:02.746729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 00:39:02.762703: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:39:02.762885: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:39:02.764228: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 00:39:02.775867: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:39:02.776026: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:39:02.777361: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][00:39:03.990][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:39:04.000][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:39:04.054][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:39:04.058][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.63s/it]warmup run: 107it [00:01, 85.79it/s]warmup run: 207it [00:01, 179.96it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 287it [00:01, 240.24it/s]warmup run: 399it [00:02, 367.60it/s]warmup run: 497it [00:02, 472.57it/s]warmup run: 604it [00:02, 589.49it/s]warmup run: 711it [00:02, 694.39it/s]warmup run: 818it [00:02, 782.91it/s]warmup run: 923it [00:02, 850.26it/s]warmup run: 1032it [00:02, 912.27it/s]warmup run: 1143it [00:02, 965.96it/s]warmup run: 1249it [00:02, 992.07it/s]warmup run: 1357it [00:02, 1017.18it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1464it [00:03, 1008.11it/s]warmup run: 1569it [00:03, 1013.01it/s]warmup run: 1679it [00:03, 1036.90it/s]warmup run: 1it [00:01,  1.53s/it]warmup run: 1790it [00:03, 1056.67it/s]warmup run: 104it [00:01, 88.48it/s]warmup run: 1it [00:01,  1.50s/it]warmup run: 1900it [00:03, 1068.94it/s]warmup run: 210it [00:01, 194.02it/s]warmup run: 92it [00:01, 79.92it/s]warmup run: 2008it [00:03, 1070.89it/s]warmup run: 318it [00:01, 312.66it/s]warmup run: 196it [00:01, 186.20it/s]warmup run: 2135it [00:03, 1128.84it/s]warmup run: 424it [00:01, 432.76it/s]warmup run: 299it [00:01, 301.42it/s]warmup run: 2267it [00:03, 1183.72it/s]warmup run: 531it [00:02, 551.07it/s]warmup run: 397it [00:01, 412.02it/s]warmup run: 2395it [00:03, 1212.06it/s]warmup run: 633it [00:02, 649.19it/s]warmup run: 503it [00:01, 534.42it/s]warmup run: 2524it [00:04, 1233.94it/s]warmup run: 735it [00:02, 733.59it/s]warmup run: 608it [00:02, 642.79it/s]warmup run: 2651it [00:04, 1242.25it/s]warmup run: 836it [00:02, 795.19it/s]warmup run: 713it [00:02, 737.45it/s]warmup run: 2783it [00:04, 1265.03it/s]warmup run: 819it [00:02, 817.14it/s]warmup run: 936it [00:02, 839.55it/s]warmup run: 2916it [00:04, 1283.07it/s]warmup run: 3000it [00:04, 684.04it/s] warmup run: 925it [00:02, 879.19it/s]warmup run: 1042it [00:02, 896.82it/s]warmup run: 1148it [00:02, 940.30it/s]warmup run: 1029it [00:02, 903.10it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 1254it [00:02, 973.57it/s]warmup run: 1135it [00:02, 944.78it/s]warmup run: 102it [00:01, 89.26it/s]warmup run: 1361it [00:02, 999.38it/s]warmup run: 1238it [00:02, 954.04it/s]warmup run: 208it [00:01, 197.39it/s]warmup run: 1468it [00:02, 1018.49it/s]warmup run: 1339it [00:02, 959.85it/s]warmup run: 305it [00:01, 303.34it/s]warmup run: 1575it [00:03, 1032.56it/s]warmup run: 1439it [00:02, 960.40it/s]warmup run: 403it [00:01, 413.67it/s]warmup run: 1681it [00:03, 1025.97it/s]warmup run: 1538it [00:03, 964.55it/s]warmup run: 500it [00:01, 518.89it/s]warmup run: 1787it [00:03, 1033.61it/s]warmup run: 1638it [00:03, 972.70it/s]warmup run: 599it [00:02, 618.55it/s]warmup run: 1893it [00:03, 1041.34it/s]warmup run: 1738it [00:03, 978.57it/s]warmup run: 698it [00:02, 704.69it/s]warmup run: 1999it [00:03, 1044.43it/s]warmup run: 1837it [00:03, 975.49it/s]warmup run: 797it [00:02, 774.86it/s]warmup run: 2129it [00:03, 1119.98it/s]warmup run: 1936it [00:03, 975.28it/s]warmup run: 896it [00:02, 829.09it/s]warmup run: 2261it [00:03, 1177.56it/s]warmup run: 2043it [00:03, 1001.94it/s]warmup run: 994it [00:02, 863.86it/s]warmup run: 2393it [00:03, 1218.27it/s]warmup run: 2175it [00:03, 1093.91it/s]warmup run: 1091it [00:02, 869.33it/s]warmup run: 2524it [00:03, 1245.01it/s]warmup run: 2307it [00:03, 1158.82it/s]warmup run: 1187it [00:02, 892.96it/s]warmup run: 2656it [00:03, 1266.15it/s]warmup run: 2439it [00:03, 1204.30it/s]warmup run: 1285it [00:02, 915.76it/s]warmup run: 2787it [00:04, 1277.98it/s]warmup run: 2570it [00:03, 1235.48it/s]warmup run: 1381it [00:02, 927.66it/s]warmup run: 2919it [00:04, 1287.86it/s]warmup run: 2702it [00:04, 1258.50it/s]warmup run: 3000it [00:04, 710.36it/s] warmup run: 1477it [00:03, 906.40it/s]warmup run: 2832it [00:04, 1270.61it/s]warmup run: 1575it [00:03, 925.83it/s]warmup run: 2964it [00:04, 1283.58it/s]warmup run: 3000it [00:04, 703.08it/s] warmup run: 1672it [00:03, 936.86it/s]warmup run: 1768it [00:03, 941.50it/s]warmup run: 1865it [00:03, 949.24it/s]warmup run: 1962it [00:03, 955.25it/s]warmup run: 2075it [00:03, 1006.66it/s]warmup run: 2203it [00:03, 1086.09it/s]warmup run: 2331it [00:03, 1142.53it/s]warmup run: 2459it [00:03, 1182.10it/s]warmup run: 2587it [00:04, 1209.02it/s]warmup run: 2715it [00:04, 1227.80it/s]warmup run: 2843it [00:04, 1242.42it/s]warmup run: 2973it [00:04, 1257.09it/s]warmup run: 3000it [00:04, 689.68it/s] 


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1688.75it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1722.24it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1683.89it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1683.34it/s]warmup should be done:  12%|█▏        | 346/3000 [00:00<00:01, 1734.26it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1720.38it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1747.16it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1720.11it/s]warmup should be done:  18%|█▊        | 526/3000 [00:00<00:01, 1751.28it/s]warmup should be done:  17%|█▋        | 517/3000 [00:00<00:01, 1720.05it/s]warmup should be done:  17%|█▋        | 520/3000 [00:00<00:01, 1723.25it/s]warmup should be done:  17%|█▋        | 517/3000 [00:00<00:01, 1714.93it/s]warmup should be done:  23%|██▎       | 692/3000 [00:00<00:01, 1731.45it/s]warmup should be done:  23%|██▎       | 703/3000 [00:00<00:01, 1754.87it/s]warmup should be done:  23%|██▎       | 696/3000 [00:00<00:01, 1737.60it/s]warmup should be done:  23%|██▎       | 689/3000 [00:00<00:01, 1715.79it/s]warmup should be done:  29%|██▉       | 867/3000 [00:00<00:01, 1737.06it/s]warmup should be done:  29%|██▉       | 880/3000 [00:00<00:01, 1756.90it/s]warmup should be done:  29%|██▉       | 871/3000 [00:00<00:01, 1741.58it/s]warmup should be done:  29%|██▊       | 861/3000 [00:00<00:01, 1713.42it/s]warmup should be done:  35%|███▍      | 1042/3000 [00:00<00:01, 1740.82it/s]warmup should be done:  35%|███▌      | 1057/3000 [00:00<00:01, 1758.91it/s]warmup should be done:  35%|███▍      | 1047/3000 [00:00<00:01, 1744.76it/s]warmup should be done:  34%|███▍      | 1033/3000 [00:00<00:01, 1711.23it/s]warmup should be done:  41%|████      | 1217/3000 [00:00<00:01, 1739.11it/s]warmup should be done:  41%|████      | 1222/3000 [00:00<00:01, 1743.04it/s]warmup should be done:  41%|████      | 1233/3000 [00:00<00:01, 1752.27it/s]warmup should be done:  40%|████      | 1205/3000 [00:00<00:01, 1711.62it/s]warmup should be done:  46%|████▋     | 1391/3000 [00:00<00:00, 1738.71it/s]warmup should be done:  47%|████▋     | 1398/3000 [00:00<00:00, 1745.29it/s]warmup should be done:  46%|████▌     | 1379/3000 [00:00<00:00, 1720.10it/s]warmup should be done:  47%|████▋     | 1409/3000 [00:00<00:00, 1739.59it/s]warmup should be done:  52%|█████▏    | 1565/3000 [00:00<00:00, 1738.65it/s]warmup should be done:  52%|█████▏    | 1574/3000 [00:00<00:00, 1747.77it/s]warmup should be done:  53%|█████▎    | 1583/3000 [00:00<00:00, 1731.79it/s]warmup should be done:  52%|█████▏    | 1552/3000 [00:00<00:00, 1630.93it/s]warmup should be done:  58%|█████▊    | 1739/3000 [00:01<00:00, 1737.73it/s]warmup should be done:  59%|█████▊    | 1757/3000 [00:01<00:00, 1728.70it/s]warmup should be done:  58%|█████▊    | 1749/3000 [00:01<00:00, 1674.26it/s]warmup should be done:  57%|█████▊    | 1725/3000 [00:01<00:00, 1657.76it/s]warmup should be done:  64%|██████▍   | 1913/3000 [00:01<00:00, 1736.17it/s]warmup should be done:  64%|██████▍   | 1934/3000 [00:01<00:00, 1739.88it/s]warmup should be done:  64%|██████▍   | 1925/3000 [00:01<00:00, 1698.04it/s]warmup should be done:  63%|██████▎   | 1895/3000 [00:01<00:00, 1667.60it/s]warmup should be done:  70%|██████▉   | 2087/3000 [00:01<00:00, 1735.52it/s]warmup should be done:  70%|███████   | 2111/3000 [00:01<00:00, 1747.96it/s]warmup should be done:  70%|██████▉   | 2096/3000 [00:01<00:00, 1693.46it/s]warmup should be done:  69%|██████▉   | 2064/3000 [00:01<00:00, 1671.31it/s]warmup should be done:  75%|███████▌  | 2261/3000 [00:01<00:00, 1735.79it/s]warmup should be done:  76%|███████▋  | 2288/3000 [00:01<00:00, 1754.06it/s]warmup should be done:  76%|███████▌  | 2273/3000 [00:01<00:00, 1715.13it/s]warmup should be done:  74%|███████▍  | 2233/3000 [00:01<00:00, 1674.55it/s]warmup should be done:  81%|████████  | 2435/3000 [00:01<00:00, 1736.78it/s]warmup should be done:  82%|████████▏ | 2465/3000 [00:01<00:00, 1757.31it/s]warmup should be done:  82%|████████▏ | 2450/3000 [00:01<00:00, 1730.22it/s]warmup should be done:  80%|████████  | 2402/3000 [00:01<00:00, 1677.82it/s]warmup should be done:  87%|████████▋ | 2609/3000 [00:01<00:00, 1734.90it/s]warmup should be done:  88%|████████▊ | 2642/3000 [00:01<00:00, 1759.81it/s]warmup should be done:  88%|████████▊ | 2626/3000 [00:01<00:00, 1737.23it/s]warmup should be done:  86%|████████▌ | 2572/3000 [00:01<00:00, 1682.59it/s]warmup should be done:  93%|█████████▎| 2783/3000 [00:01<00:00, 1732.92it/s]warmup should be done:  94%|█████████▍| 2820/3000 [00:01<00:00, 1763.62it/s]warmup should be done:  93%|█████████▎| 2803/3000 [00:01<00:00, 1745.74it/s]warmup should be done:  92%|█████████▏| 2745/3000 [00:01<00:00, 1695.10it/s]warmup should be done:  99%|█████████▊| 2957/3000 [00:01<00:00, 1730.44it/s]warmup should be done:  99%|█████████▉| 2980/3000 [00:01<00:00, 1752.44it/s]warmup should be done:  97%|█████████▋| 2918/3000 [00:01<00:00, 1703.92it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1733.66it/s]warmup should be done: 100%|█████████▉| 2997/3000 [00:01<00:00, 1655.01it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1730.89it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1729.42it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1691.40it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   5%|▌         | 161/3000 [00:00<00:01, 1606.62it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1761.44it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1703.86it/s]warmup should be done:   5%|▌         | 157/3000 [00:00<00:01, 1561.51it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1737.54it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1765.51it/s]warmup should be done:  11%|█▏        | 339/3000 [00:00<00:01, 1709.91it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1757.07it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1781.19it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1782.69it/s]warmup should be done:  17%|█▋        | 518/3000 [00:00<00:01, 1744.48it/s]warmup should be done:  18%|█▊        | 530/3000 [00:00<00:01, 1757.36it/s]warmup should be done:  24%|██▍       | 715/3000 [00:00<00:01, 1796.98it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1805.81it/s]warmup should be done:  23%|██▎       | 700/3000 [00:00<00:01, 1772.84it/s]warmup should be done:  24%|██▎       | 707/3000 [00:00<00:01, 1760.40it/s]warmup should be done:  30%|██▉       | 897/3000 [00:00<00:01, 1817.64it/s]warmup should be done:  29%|██▉       | 878/3000 [00:00<00:01, 1772.54it/s]warmup should be done:  30%|██▉       | 895/3000 [00:00<00:01, 1792.68it/s]warmup should be done:  29%|██▉       | 884/3000 [00:00<00:01, 1761.42it/s]warmup should be done:  36%|███▌      | 1081/3000 [00:00<00:01, 1824.83it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1785.32it/s]warmup should be done:  35%|███▌      | 1061/3000 [00:00<00:01, 1755.87it/s]warmup should be done:  36%|███▌      | 1075/3000 [00:00<00:01, 1776.86it/s]warmup should be done:  42%|████▏     | 1264/3000 [00:00<00:00, 1824.77it/s]warmup should be done:  41%|████      | 1237/3000 [00:00<00:01, 1756.53it/s]warmup should be done:  41%|████▏     | 1239/3000 [00:00<00:00, 1770.73it/s]warmup should be done:  42%|████▏     | 1253/3000 [00:00<00:00, 1776.07it/s]warmup should be done:  48%|████▊     | 1449/3000 [00:00<00:00, 1829.83it/s]warmup should be done:  47%|████▋     | 1413/3000 [00:00<00:00, 1756.85it/s]warmup should be done:  48%|████▊     | 1435/3000 [00:00<00:00, 1788.19it/s]warmup should be done:  47%|████▋     | 1418/3000 [00:00<00:00, 1773.74it/s]warmup should be done:  54%|█████▍    | 1634/3000 [00:00<00:00, 1833.98it/s]warmup should be done:  53%|█████▎    | 1589/3000 [00:00<00:00, 1752.98it/s]warmup should be done:  54%|█████▍    | 1615/3000 [00:00<00:00, 1789.89it/s]warmup should be done:  53%|█████▎    | 1596/3000 [00:00<00:00, 1772.59it/s]warmup should be done:  61%|██████    | 1819/3000 [00:01<00:00, 1836.60it/s]warmup should be done:  59%|█████▉    | 1767/3000 [00:01<00:00, 1760.85it/s]warmup should be done:  60%|█████▉    | 1795/3000 [00:01<00:00, 1792.90it/s]warmup should be done:  59%|█████▉    | 1777/3000 [00:01<00:00, 1781.52it/s]warmup should be done:  66%|██████▌   | 1975/3000 [00:01<00:00, 1785.62it/s]warmup should be done:  67%|██████▋   | 2003/3000 [00:01<00:00, 1809.59it/s]warmup should be done:  65%|██████▌   | 1956/3000 [00:01<00:00, 1769.19it/s]warmup should be done:  65%|██████▍   | 1944/3000 [00:01<00:00, 1732.27it/s]warmup should be done:  73%|███████▎  | 2187/3000 [00:01<00:00, 1818.17it/s]warmup should be done:  72%|███████▏  | 2155/3000 [00:01<00:00, 1786.96it/s]warmup should be done:  71%|███████   | 2135/3000 [00:01<00:00, 1773.39it/s]warmup should be done:  71%|███████   | 2121/3000 [00:01<00:00, 1742.55it/s]warmup should be done:  79%|███████▉  | 2371/3000 [00:01<00:00, 1824.03it/s]warmup should be done:  78%|███████▊  | 2336/3000 [00:01<00:00, 1791.89it/s]warmup should be done:  77%|███████▋  | 2314/3000 [00:01<00:00, 1775.88it/s]warmup should be done:  77%|███████▋  | 2299/3000 [00:01<00:00, 1751.26it/s]warmup should be done:  85%|████████▌ | 2554/3000 [00:01<00:00, 1820.81it/s]warmup should be done:  84%|████████▍ | 2517/3000 [00:01<00:00, 1794.63it/s]warmup should be done:  83%|████████▎ | 2492/3000 [00:01<00:00, 1771.44it/s]warmup should be done:  83%|████████▎ | 2476/3000 [00:01<00:00, 1754.59it/s]warmup should be done:  90%|████████▉ | 2697/3000 [00:01<00:00, 1790.90it/s]warmup should be done:  91%|█████████ | 2737/3000 [00:01<00:00, 1813.87it/s]warmup should be done:  89%|████████▉ | 2671/3000 [00:01<00:00, 1775.70it/s]warmup should be done:  88%|████████▊ | 2653/3000 [00:01<00:00, 1756.60it/s]warmup should be done:  96%|█████████▌| 2878/3000 [00:01<00:00, 1793.68it/s]warmup should be done:  94%|█████████▍| 2829/3000 [00:01<00:00, 1747.84it/s]warmup should be done:  97%|█████████▋| 2919/3000 [00:01<00:00, 1798.37it/s]warmup should be done:  95%|█████████▍| 2849/3000 [00:01<00:00, 1762.64it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1807.62it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1787.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1766.07it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1753.58it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f4062d7f280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f4062d7f070>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f4062d7f100>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f4062d7e190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-12 00:40:12.943468: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f3c3526b000 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:40:12.943531: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:40:12.951403: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:40:13.729305: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:40:14.840705: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f3c39267e60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:40:14.840794: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:40:14.851631: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:40:14.936953: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f3c35a674d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:40:14.937042: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:40:14.943305: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f3c3926e500 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:40:14.943344: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:40:14.948153: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:40:14.951528: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:40:15.608529: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:40:15.635645: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:40:15.641515: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:40:18.849511: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:40:21.743188: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:40:21.764426: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:40:21.815909: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][00:41:16.834][ERROR][RK0][tid #139896991762176]: replica 3 reaches 1000, calling init pre replica
[HCTR][00:41:16.835][ERROR][RK0][tid #139896991762176]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:41:16.842][ERROR][RK0][tid #139896991762176]: coll ps creation done
[HCTR][00:41:16.842][ERROR][RK0][tid #139896991762176]: replica 3 waits for coll ps creation barrier
[HCTR][00:41:16.911][ERROR][RK0][tid #139896924653312]: replica 0 reaches 1000, calling init pre replica
[HCTR][00:41:16.911][ERROR][RK0][tid #139896924653312]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:41:16.916][ERROR][RK0][tid #139896924653312]: coll ps creation done
[HCTR][00:41:16.916][ERROR][RK0][tid #139896924653312]: replica 0 waits for coll ps creation barrier
[HCTR][00:41:17.019][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][00:41:17.019][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:41:17.023][ERROR][RK0][main]: coll ps creation done
[HCTR][00:41:17.023][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][00:41:17.071][ERROR][RK0][tid #139896933046016]: replica 2 reaches 1000, calling init pre replica
[HCTR][00:41:17.071][ERROR][RK0][tid #139896933046016]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:41:17.074][ERROR][RK0][tid #139896933046016]: coll ps creation done
[HCTR][00:41:17.074][ERROR][RK0][tid #139896933046016]: replica 2 waits for coll ps creation barrier
[HCTR][00:41:17.074][ERROR][RK0][tid #139896924653312]: replica 0 preparing frequency
[HCTR][00:41:18.515][ERROR][RK0][tid #139896924653312]: replica 0 preparing frequency done
[HCTR][00:41:18.553][ERROR][RK0][tid #139896924653312]: replica 0 calling init per replica
[HCTR][00:41:18.553][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][00:41:18.553][ERROR][RK0][tid #139896933046016]: replica 2 calling init per replica
[HCTR][00:41:18.553][ERROR][RK0][tid #139896991762176]: replica 3 calling init per replica
[HCTR][00:41:18.553][ERROR][RK0][tid #139896924653312]: Calling build_v2
[HCTR][00:41:18.553][ERROR][RK0][main]: Calling build_v2
[HCTR][00:41:18.553][ERROR][RK0][tid #139896933046016]: Calling build_v2
[HCTR][00:41:18.553][ERROR][RK0][tid #139896924653312]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:41:18.553][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:41:18.553][ERROR][RK0][tid #139896933046016]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:41:18.553][ERROR][RK0][tid #139896991762176]: Calling build_v2
[HCTR][00:41:18.553][ERROR][RK0][tid #139896991762176]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[[2022-12-12 00:41:18.2022-12-12 00:41:185531792022-12-12 00:41:18.: .5531872022-12-12 00:41:18E553179: . : E553183/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE : : /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: ] :136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccusing concurrent impl MPS136] :
] using concurrent impl MPS136using concurrent impl MPS
] 
using concurrent impl MPS
[2022-12-12 00:41:18.554505: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[1962022-12-12 00:41:18] .assigning 8 to cpu554525
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-12 00:41:18196.] 554551assigning 8 to cpu: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-12 00:41:18.[5545952022-12-12 00:41:18: .[E5546052022-12-12 00:41:18 : .[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE5546072022-12-12 00:41:18: : .212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE554634] : : build symm link desc with 4X Tesla V100-SXM2-16GB out of 4212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE
] : build symm link desc with 4X Tesla V100-SXM2-16GB out of 4196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
] :[assigning 8 to cpu2122022-12-12 00:41:18
] [.build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-12 00:41:18554700
.: 554711E:  E[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 2022-12-12 00:41:18:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.213:554739[] 213: 2022-12-12 00:41:18remote time is 8.68421] E.
remote time is 8.68421 554739
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: [:E[2022-12-12 00:41:18213 2022-12-12 00:41:18.] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.554788remote time is 8.68421:554796: 
212: E] E[ build symm link desc with 4X Tesla V100-SXM2-16GB out of 4 2022-12-12 00:41:18/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.::554836214214: [] ] E2022-12-12 00:41:18cpu time is 30cpu time is 30 .

/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc554865:: 214E]  cpu time is 30/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
:213] remote time is 8.68421
[2022-12-12 00:41:18.554952: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 00:41:44.792030: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 00:41:44.861559: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 00:41:44.861674: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 00:41:44.862757: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 00:41:44.996251: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 00:41:45.387324: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 00:41:45.387412: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 00:41:53.502302: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 00:41:53.502474: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 00:41:55.313178: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 00:41:55.313322: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 00:41:55.353809: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 00:41:55.353916: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 00:41:56.417874: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 00:41:56.435152: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 00:41:56.436439: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 00:41:56.447379: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 00:41:56.541995: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 00:41:59.313428: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 00:41:59.317684: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 00:41:59.318229: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 00:41:59.327937: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 00:41:59.328011: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 00:41:59.328061: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 00:41:59.328096: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 00:41:59.329045: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:41:59.329098: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:41:59.329964: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:41:59.330529: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:41:59.349875: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-12 00:41:59.349973: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-12 00:41:59.350285: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-12 00:41:59.350362: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-12 00:41:59.350574: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 00:41:59.350641: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 00:41:59.350742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:41:59.350801: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:41:59.351120: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:41:59.351178: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:41:59.351367: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:41:59.351422: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:41:59.352581: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:41:59.352612: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:41:59.352711: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:41:59.354071: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:41:59.354098: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:41:59.354129: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:41:59.430506: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 00:41:59.432733: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 00:41:59.432796: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:41:59.433939: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:41:59.434798: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:41:59.435845: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:41:59.435893: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.46 MB
[[[2022-12-12 00:41:592022-12-12 00:41:592022-12-12 00:41:59...446018446020446018: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes


[[2022-12-12 00:41:592022-12-12 00:41:59..447914447915: : EE [ /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-12 00:41:59/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:.:638447940638] : ] eager release cuda mem 1021Eeager release cuda mem 1021
 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 00:41:59[.2022-12-12 00:41:59448003.[: 4480072022-12-12 00:41:59E: . E448016/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc : :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE638: ] 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 400000000] :
eager release cuda mem 400000000638
] eager release cuda mem 400000000
[2022-12-12 00:41:59.448950: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:41:59.449444: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:41:59.449928: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:41:59.450539: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:41:59.450591: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:41:59.450624: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:41:59.451497: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:41:59.451540: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:[432022-12-12 00:41:59] .451554WORKER[0] alloc host memory 45.47 MB: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:2022-12-12 00:41:59638.] 451579eager release cuda mem 625663: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:41:59.451618: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc[:2022-12-12 00:41:5943.] 451632WORKER[0] alloc host memory 45.76 MB: 
W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.76 MB
[2022-12-12 00:41:59.462005: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:41:59.462599: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:41:59.462645: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.69 GB
[2022-12-12 00:41:59.508594: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:41:59.508919: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:41:59.509204: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:41:59.509246: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.69 GB
[2022-12-12 00:41:59.509493: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:41:59.509534: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[2022-12-12 00:41:59.509917: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:41:59.510505: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:41:59.510549: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.72 GB
[[[[2022-12-12 00:42:002022-12-12 00:42:002022-12-12 00:42:002022-12-12 00:42:00.... 53310 53303 53308 53307: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 1 init p2p of link 2Device 3 init p2p of link 0Device 2 init p2p of link 3Device 0 init p2p of link 1



[[[[2022-12-12 00:42:002022-12-12 00:42:002022-12-12 00:42:002022-12-12 00:42:00.... 53660 53660 53660 53661: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1980198019801980] ] ] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KBeager alloc mem 611.00 KBeager alloc mem 611.00 KB



[[[[2022-12-12 00:42:002022-12-12 00:42:002022-12-12 00:42:002022-12-12 00:42:00.... 54630 54631 54632 54634: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::::638638638638] ] ] ] eager release cuda mem 625663eager release cuda mem 625663eager release cuda mem 625663eager release cuda mem 625663



[[2022-12-12 00:42:002022-12-12 00:42:00.. 61673 61677: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261926] ] Device 2 init p2p of link 0[Device 0 init p2p of link 2
2022-12-12 00:42:00
. 61760: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-12 00:42:00. 61853[: 2022-12-12 00:42:00E.  61863/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[: :2022-12-12 00:42:00E1980. ]  61888/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB: :
E1980 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB:
1980] eager alloc mem 611.00 KB
[2022-12-12 00:42:00. 61973: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 00:42:00. 62086: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:42:00. 62718: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[[2022-12-12 00:42:002022-12-12 00:42:00.. 62755 62755: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 625663eager release cuda mem 625663

[2022-12-12 00:42:00. 62902: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:42:00. 70034: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 00:42:00. 70123: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:42:00. 70241: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 00:42:00. 70334: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:42:00. 70396: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 00:42:00. 70502: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:42:00. 70553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 00:42:00. 70636: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:42:00. 70928: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:42:00. 71144: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:42:00. 71308: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:42:00. 71441: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:42:00. 77535: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:42:00. 77850: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11916675 / 100000000 nodes ( 11.92 %~12.00 %) | remote 32910600 / 100000000 nodes ( 32.91 %) | cpu 55172725 / 100000000 nodes ( 55.17 %) | 5.69 GB | 0.748757 secs 
[[2022-12-12 00:42:002022-12-12 00:42:00.. 78010 78016: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 48399996eager release cuda mem 48399996

[2022-12-12 00:42:00. 78339: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:42:00. 78404: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11996295 / 100000000 nodes ( 12.00 %~12.00 %) | remote 32830980 / 100000000 nodes ( 32.83 %) | cpu 55172725 / 100000000 nodes ( 55.17 %) | 5.73 GB | 0.727624 secs 
[2022-12-12 00:42:00. 78521: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11919405 / 100000000 nodes ( 11.92 %~12.00 %) | remote 32907870 / 100000000 nodes ( 32.91 %) | cpu 55172725 / 100000000 nodes ( 55.17 %) | 5.69 GB | 0.727117 secs 
[2022-12-12 00:42:00. 78729: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11994900 / 100000000 nodes ( 11.99 %~12.00 %) | remote 32832375 / 100000000 nodes ( 32.83 %) | cpu 55172725 / 100000000 nodes ( 55.17 %) | 5.72 GB | 0.727568 secs 
[2022-12-12 00:42:00. 78878: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.39 GB
[2022-12-12 00:42:00.946424: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.63 GB
[2022-12-12 00:42:00.946847: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.63 GB
[2022-12-12 00:42:00.947144: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.63 GB
[2022-12-12 00:42:01.647268: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.88 GB
[2022-12-12 00:42:01.647385: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.88 GB
[2022-12-12 00:42:01.647913: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.88 GB
[2022-12-12 00:42:02.357984: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.12 GB
[2022-12-12 00:42:02.358114: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.12 GB
[2022-12-12 00:42:02.358408: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.12 GB
[2022-12-12 00:42:03.106808: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.53 GB
[2022-12-12 00:42:03.107072: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.53 GB
[2022-12-12 00:42:03.107560: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.53 GB
[2022-12-12 00:42:03.857211: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.72 GB
[2022-12-12 00:42:03.857801: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.72 GB
[HCTR][00:42:04.508][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][00:42:04.508][ERROR][RK0][tid #139896933046016]: replica 2 calling init per replica done, doing barrier
[HCTR][00:42:04.508][ERROR][RK0][tid #139896924653312]: replica 0 calling init per replica done, doing barrier
[HCTR][00:42:04.508][ERROR][RK0][tid #139896991762176]: replica 3 calling init per replica done, doing barrier
[HCTR][00:42:04.509][ERROR][RK0][tid #139896991762176]: replica 3 calling init per replica done, doing barrier done
[HCTR][00:42:04.509][ERROR][RK0][tid #139896933046016]: replica 2 calling init per replica done, doing barrier done
[HCTR][00:42:04.509][ERROR][RK0][tid #139896924653312]: replica 0 calling init per replica done, doing barrier done
[HCTR][00:42:04.509][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][00:42:04.509][ERROR][RK0][tid #139896991762176]: init per replica done
[HCTR][00:42:04.509][ERROR][RK0][tid #139896933046016]: init per replica done
[HCTR][00:42:04.509][ERROR][RK0][main]: init per replica done
[HCTR][00:42:04.543][ERROR][RK0][tid #139896933046016]: 2 allocated 3276800 at 0x7f21fe238400
[HCTR][00:42:04.543][ERROR][RK0][tid #139896933046016]: 2 allocated 6553600 at 0x7f21fe558400
[HCTR][00:42:04.543][ERROR][RK0][tid #139896933046016]: 2 allocated 3276800 at 0x7f21feb98400
[HCTR][00:42:04.543][ERROR][RK0][tid #139896933046016]: 2 allocated 6553600 at 0x7f21feeb8400
[HCTR][00:42:04.544][ERROR][RK0][tid #139896991762176]: 3 allocated 3276800 at 0x7f20f4238400
[HCTR][00:42:04.544][ERROR][RK0][tid #139896991762176]: 3 allocated 6553600 at 0x7f20f4558400
[HCTR][00:42:04.544][ERROR][RK0][tid #139896991762176]: 3 allocated 3276800 at 0x7f20f4b98400
[HCTR][00:42:04.544][ERROR][RK0][tid #139896991762176]: 3 allocated 6553600 at 0x7f20f4eb8400
[HCTR][00:42:04.544][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f218c238400
[HCTR][00:42:04.544][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f218c558400
[HCTR][00:42:04.544][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f218cb98400
[HCTR][00:42:04.544][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f218ceb8400
[HCTR][00:42:04.546][ERROR][RK0][tid #139896924653312]: init per replica done
[HCTR][00:42:04.581][ERROR][RK0][tid #139896924653312]: 0 allocated 3276800 at 0x7f2130320000
[HCTR][00:42:04.581][ERROR][RK0][tid #139896924653312]: 0 allocated 6553600 at 0x7f2130640000
[HCTR][00:42:04.581][ERROR][RK0][tid #139896924653312]: 0 allocated 3276800 at 0x7f2130c80000
[HCTR][00:42:04.581][ERROR][RK0][tid #139896924653312]: 0 allocated 6553600 at 0x7f2130fa0000
