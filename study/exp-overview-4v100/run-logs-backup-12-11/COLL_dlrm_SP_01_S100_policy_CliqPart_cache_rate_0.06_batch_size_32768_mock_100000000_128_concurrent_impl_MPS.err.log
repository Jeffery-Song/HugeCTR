2022-12-11 21:38:21.702064: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:38:21.762368: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:38:21.778864: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:38:21.780591: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:38:22.593764: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:38:22.593839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:38:22.606732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:38:22.636440: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:38:22.636520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:38:22.641254: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:38:22.641423: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:38:22.643504: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 21:38:22.649053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:38:22.656858: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:38:22.656923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:38:22.663523: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:38:22.663603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:38:22.669296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:38:22.675805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:38:22.679783: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:38:22.679933: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:38:22.681363: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 21:38:22.699657: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:38:22.699831: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:38:22.701165: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 21:38:22.706871: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:38:22.707010: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:38:22.708383: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][21:38:23.910][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:38:23.923][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:38:23.961][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:38:23.974][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.62s/it]warmup run: 112it [00:01, 90.24it/s]warmup run: 225it [00:01, 197.77it/s]warmup run: 338it [00:01, 317.56it/s]warmup run: 451it [00:02, 443.28it/s]warmup run: 567it [00:02, 572.53it/s]warmup run: 674it [00:02, 581.68it/s]warmup run: 772it [00:02, 661.10it/s]warmup run: 881it [00:02, 756.74it/s]warmup run: 983it [00:02, 819.20it/s]warmup run: 1083it [00:02, 859.72it/s]warmup run: 1it [00:01,  1.46s/it]warmup run: 1182it [00:02, 891.76it/s]warmup run: 70it [00:01, 62.16it/s]warmup run: 1281it [00:02, 915.01it/s]warmup run: 0it [00:00, ?it/s]warmup run: 155it [00:01, 151.06it/s]warmup run: 1395it [00:03, 977.26it/s]warmup run: 263it [00:01, 279.86it/s]warmup run: 1509it [00:03, 1021.51it/s]warmup run: 377it [00:01, 421.75it/s]warmup run: 1624it [00:03, 1057.88it/s]warmup run: 492it [00:01, 560.50it/s]warmup run: 1740it [00:03, 1086.19it/s]warmup run: 608it [00:02, 688.37it/s]warmup run: 1856it [00:03, 1106.34it/s]warmup run: 723it [00:02, 796.35it/s]warmup run: 1971it [00:03, 1117.37it/s]warmup run: 839it [00:02, 886.56it/s]warmup run: 2103it [00:03, 1175.13it/s]warmup run: 952it [00:02, 948.76it/s]warmup run: 0it [00:00, ?it/s]warmup run: 2228it [00:03, 1195.24it/s]warmup run: 1063it [00:02, 979.82it/s]warmup run: 2366it [00:03, 1247.93it/s]warmup run: 1173it [00:02, 998.80it/s]warmup run: 2505it [00:03, 1290.00it/s]warmup run: 1281it [00:02, 1001.14it/s]warmup run: 2641it [00:04, 1310.30it/s]warmup run: 1391it [00:02, 1028.75it/s]warmup run: 2780it [00:04, 1332.70it/s]warmup run: 1501it [00:02, 1046.90it/s]warmup run: 2918it [00:04, 1346.81it/s]warmup run: 1611it [00:02, 1059.66it/s]warmup run: 3000it [00:04, 700.56it/s] warmup run: 1it [00:01,  1.41s/it]warmup run: 1720it [00:03, 1056.77it/s]warmup run: 103it [00:01, 94.60it/s]warmup run: 1828it [00:03, 1039.13it/s]warmup run: 204it [00:01, 200.86it/s]warmup run: 1935it [00:03, 1045.48it/s]warmup run: 307it [00:01, 318.58it/s]warmup run: 2054it [00:03, 1086.76it/s]warmup run: 409it [00:01, 436.52it/s]warmup run: 2189it [00:03, 1162.96it/s]warmup run: 511it [00:01, 548.77it/s]warmup run: 2324it [00:03, 1217.38it/s]warmup run: 614it [00:02, 652.47it/s]warmup run: 2459it [00:03, 1256.33it/s]warmup run: 717it [00:02, 740.75it/s]warmup run: 2594it [00:03, 1283.65it/s]warmup run: 819it [00:02, 810.30it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 2723it [00:03, 1283.63it/s]warmup run: 921it [00:02, 865.65it/s]warmup run: 106it [00:01, 96.24it/s]warmup run: 2858it [00:03, 1301.80it/s]warmup run: 1022it [00:02, 904.83it/s]warmup run: 209it [00:01, 203.63it/s]warmup run: 2993it [00:04, 1313.94it/s]warmup run: 3000it [00:04, 730.09it/s] warmup run: 1123it [00:02, 924.41it/s]warmup run: 316it [00:01, 325.59it/s]warmup run: 1224it [00:02, 948.15it/s]warmup run: 424it [00:01, 451.93it/s]warmup run: 1325it [00:02, 964.12it/s]warmup run: 532it [00:01, 573.12it/s]warmup run: 1427it [00:02, 978.74it/s]warmup run: 642it [00:02, 685.76it/s]warmup run: 1528it [00:02, 987.43it/s]warmup run: 751it [00:02, 779.90it/s]warmup run: 1630it [00:03, 995.70it/s]warmup run: 860it [00:02, 856.67it/s]warmup run: 1732it [00:03, 1001.80it/s]warmup run: 966it [00:02, 840.19it/s]warmup run: 1835it [00:03, 1008.08it/s]warmup run: 1072it [00:02, 895.06it/s]warmup run: 1937it [00:03, 1010.18it/s]warmup run: 1183it [00:02, 950.66it/s]warmup run: 2050it [00:03, 1044.11it/s]warmup run: 1292it [00:02, 988.94it/s]warmup run: 2186it [00:03, 1137.86it/s]warmup run: 1402it [00:02, 1018.39it/s]warmup run: 2320it [00:03, 1196.83it/s]warmup run: 1512it [00:02, 1041.01it/s]warmup run: 2456it [00:03, 1245.22it/s]warmup run: 1622it [00:02, 1056.89it/s]warmup run: 2592it [00:03, 1278.16it/s]warmup run: 1732it [00:03, 1069.23it/s]warmup run: 2727it [00:03, 1299.17it/s]warmup run: 1841it [00:03, 1072.74it/s]warmup run: 2863it [00:04, 1317.14it/s]warmup run: 1952it [00:03, 1081.31it/s]warmup run: 2999it [00:04, 1327.40it/s]warmup run: 3000it [00:04, 726.41it/s] warmup run: 2068it [00:03, 1102.40it/s]warmup run: 2205it [00:03, 1179.86it/s]warmup run: 2342it [00:03, 1234.26it/s]warmup run: 2479it [00:03, 1273.44it/s]warmup run: 2617it [00:03, 1303.30it/s]warmup run: 2753it [00:03, 1318.98it/s]warmup run: 2890it [00:03, 1333.81it/s]warmup run: 3000it [00:04, 739.62it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1806.34it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1709.91it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1745.70it/s]warmup should be done:   5%|▌         | 163/3000 [00:00<00:01, 1625.83it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1829.43it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1788.46it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1746.82it/s]warmup should be done:  12%|█▏        | 346/3000 [00:00<00:01, 1741.85it/s]warmup should be done:  18%|█▊        | 549/3000 [00:00<00:01, 1825.82it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1793.82it/s]warmup should be done:  18%|█▊        | 526/3000 [00:00<00:01, 1765.36it/s]warmup should be done:  17%|█▋        | 524/3000 [00:00<00:01, 1741.73it/s]warmup should be done:  24%|██▍       | 733/3000 [00:00<00:01, 1827.67it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1800.68it/s]warmup should be done:  23%|██▎       | 700/3000 [00:00<00:01, 1746.76it/s]warmup should be done:  23%|██▎       | 703/3000 [00:00<00:01, 1751.86it/s]warmup should be done:  30%|███       | 901/3000 [00:00<00:01, 1801.73it/s]warmup should be done:  31%|███       | 916/3000 [00:00<00:01, 1824.45it/s]warmup should be done:  29%|██▉       | 875/3000 [00:00<00:01, 1744.58it/s]warmup should be done:  29%|██▉       | 883/3000 [00:00<00:01, 1768.39it/s]warmup should be done:  37%|███▋      | 1099/3000 [00:00<00:01, 1820.95it/s]warmup should be done:  36%|███▌      | 1082/3000 [00:00<00:01, 1797.13it/s]warmup should be done:  35%|███▌      | 1050/3000 [00:00<00:01, 1740.24it/s]warmup should be done:  35%|███▌      | 1063/3000 [00:00<00:01, 1778.70it/s]warmup should be done:  43%|████▎     | 1282/3000 [00:00<00:00, 1822.13it/s]warmup should be done:  42%|████▏     | 1264/3000 [00:00<00:00, 1802.57it/s]warmup should be done:  41%|████      | 1225/3000 [00:00<00:01, 1741.20it/s]warmup should be done:  41%|████▏     | 1241/3000 [00:00<00:01, 1756.82it/s]warmup should be done:  49%|████▉     | 1465/3000 [00:00<00:00, 1819.37it/s]warmup should be done:  47%|████▋     | 1423/3000 [00:00<00:00, 1773.83it/s]warmup should be done:  47%|████▋     | 1400/3000 [00:00<00:00, 1706.50it/s]warmup should be done:  48%|████▊     | 1445/3000 [00:00<00:00, 1735.22it/s]warmup should be done:  55%|█████▍    | 1647/3000 [00:00<00:00, 1813.33it/s]warmup should be done:  53%|█████▎    | 1604/3000 [00:00<00:00, 1784.86it/s]warmup should be done:  53%|█████▎    | 1581/3000 [00:00<00:00, 1737.04it/s]warmup should be done:  54%|█████▍    | 1627/3000 [00:00<00:00, 1760.24it/s]warmup should be done:  61%|██████    | 1829/3000 [00:01<00:00, 1808.07it/s]warmup should be done:  60%|█████▉    | 1787/3000 [00:01<00:00, 1796.45it/s]warmup should be done:  59%|█████▊    | 1762/3000 [00:01<00:00, 1758.05it/s]warmup should be done:  60%|██████    | 1808/3000 [00:01<00:00, 1774.49it/s]warmup should be done:  67%|██████▋   | 2010/3000 [00:01<00:00, 1802.61it/s]warmup should be done:  66%|██████▌   | 1970/3000 [00:01<00:00, 1804.44it/s]warmup should be done:  65%|██████▍   | 1943/3000 [00:01<00:00, 1772.07it/s]warmup should be done:  66%|██████▋   | 1989/3000 [00:01<00:00, 1783.65it/s]warmup should be done:  73%|███████▎  | 2191/3000 [00:01<00:00, 1801.76it/s]warmup should be done:  72%|███████▏  | 2152/3000 [00:01<00:00, 1808.97it/s]warmup should be done:  72%|███████▏  | 2169/3000 [00:01<00:00, 1786.80it/s]warmup should be done:  71%|███████   | 2121/3000 [00:01<00:00, 1741.60it/s]warmup should be done:  79%|███████▉  | 2372/3000 [00:01<00:00, 1801.60it/s]warmup should be done:  78%|███████▊  | 2333/3000 [00:01<00:00, 1806.51it/s]warmup should be done:  78%|███████▊  | 2348/3000 [00:01<00:00, 1755.06it/s]warmup should be done:  77%|███████▋  | 2296/3000 [00:01<00:00, 1681.70it/s]warmup should be done:  85%|████████▌ | 2554/3000 [00:01<00:00, 1804.66it/s]warmup should be done:  84%|████████▍ | 2516/3000 [00:01<00:00, 1812.26it/s]warmup should be done:  84%|████████▍ | 2529/3000 [00:01<00:00, 1769.36it/s]warmup should be done:  82%|████████▏ | 2465/3000 [00:01<00:00, 1679.98it/s]warmup should be done:  91%|█████████ | 2735/3000 [00:01<00:00, 1805.94it/s]warmup should be done:  90%|████████▉ | 2698/3000 [00:01<00:00, 1812.10it/s]warmup should be done:  90%|█████████ | 2711/3000 [00:01<00:00, 1781.82it/s]warmup should be done:  88%|████████▊ | 2641/3000 [00:01<00:00, 1701.56it/s]warmup should be done:  97%|█████████▋| 2916/3000 [00:01<00:00, 1803.57it/s]warmup should be done:  96%|█████████▌| 2880/3000 [00:01<00:00, 1779.37it/s]warmup should be done:  96%|█████████▋| 2892/3000 [00:01<00:00, 1788.45it/s]warmup should be done:  94%|█████████▍| 2815/3000 [00:01<00:00, 1712.11it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1809.56it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1781.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1778.80it/s]warmup should be done: 100%|█████████▉| 2994/3000 [00:01<00:00, 1733.45it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1728.79it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 183/3000 [00:00<00:01, 1827.91it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1745.56it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1722.18it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1703.97it/s]warmup should be done:  12%|█▏        | 367/3000 [00:00<00:01, 1829.38it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1803.95it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1781.64it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1778.66it/s]warmup should be done:  18%|█▊        | 546/3000 [00:00<00:01, 1828.72it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1800.86it/s]warmup should be done:  18%|█▊        | 550/3000 [00:00<00:01, 1821.65it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1802.48it/s]warmup should be done:  24%|██▍       | 730/3000 [00:00<00:01, 1831.72it/s]warmup should be done:  24%|██▍       | 723/3000 [00:00<00:01, 1814.55it/s]warmup should be done:  24%|██▍       | 733/3000 [00:00<00:01, 1821.56it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1786.37it/s]warmup should be done:  31%|███       | 916/3000 [00:00<00:01, 1840.40it/s]warmup should be done:  31%|███       | 916/3000 [00:00<00:01, 1818.92it/s]warmup should be done:  30%|███       | 900/3000 [00:00<00:01, 1790.17it/s]warmup should be done:  30%|███       | 905/3000 [00:00<00:01, 1775.60it/s]warmup should be done:  37%|███▋      | 1101/3000 [00:00<00:01, 1839.86it/s]warmup should be done:  37%|███▋      | 1099/3000 [00:00<00:01, 1821.47it/s]warmup should be done:  36%|███▌      | 1082/3000 [00:00<00:01, 1798.93it/s]warmup should be done:  36%|███▋      | 1090/3000 [00:00<00:01, 1800.03it/s]warmup should be done:  43%|████▎     | 1286/3000 [00:00<00:00, 1841.45it/s]warmup should be done:  43%|████▎     | 1282/3000 [00:00<00:00, 1817.67it/s]warmup should be done:  42%|████▏     | 1262/3000 [00:00<00:00, 1798.00it/s]warmup should be done:  42%|████▏     | 1273/3000 [00:00<00:00, 1808.53it/s]warmup should be done:  49%|████▉     | 1473/3000 [00:00<00:00, 1847.87it/s]warmup should be done:  49%|████▉     | 1466/3000 [00:00<00:00, 1823.28it/s]warmup should be done:  48%|████▊     | 1445/3000 [00:00<00:00, 1807.60it/s]warmup should be done:  49%|████▊     | 1459/3000 [00:00<00:00, 1822.48it/s]warmup should be done:  55%|█████▌    | 1658/3000 [00:00<00:00, 1837.48it/s]warmup should be done:  55%|█████▍    | 1649/3000 [00:00<00:00, 1824.76it/s]warmup should be done:  54%|█████▍    | 1628/3000 [00:00<00:00, 1813.27it/s]warmup should be done:  55%|█████▍    | 1642/3000 [00:00<00:00, 1731.20it/s]warmup should be done:  61%|██████    | 1833/3000 [00:01<00:00, 1827.17it/s]warmup should be done:  60%|██████    | 1811/3000 [00:01<00:00, 1816.86it/s]warmup should be done:  61%|██████▏   | 1842/3000 [00:01<00:00, 1787.08it/s]warmup should be done:  61%|██████    | 1828/3000 [00:01<00:00, 1766.57it/s]warmup should be done:  67%|██████▋   | 2017/3000 [00:01<00:00, 1828.53it/s]warmup should be done:  66%|██████▋   | 1993/3000 [00:01<00:00, 1816.57it/s]warmup should be done:  68%|██████▊   | 2029/3000 [00:01<00:00, 1809.09it/s]warmup should be done:  67%|██████▋   | 2015/3000 [00:01<00:00, 1796.48it/s]warmup should be done:  73%|███████▎  | 2201/3000 [00:01<00:00, 1831.04it/s]warmup should be done:  73%|███████▎  | 2177/3000 [00:01<00:00, 1821.30it/s]warmup should be done:  74%|███████▍  | 2216/3000 [00:01<00:00, 1827.08it/s]warmup should be done:  73%|███████▎  | 2202/3000 [00:01<00:00, 1818.07it/s]warmup should be done:  80%|███████▉  | 2385/3000 [00:01<00:00, 1832.58it/s]warmup should be done:  79%|███████▊  | 2362/3000 [00:01<00:00, 1827.09it/s]warmup should be done:  80%|████████  | 2404/3000 [00:01<00:00, 1840.41it/s]warmup should be done:  80%|███████▉  | 2390/3000 [00:01<00:00, 1833.95it/s]warmup should be done:  85%|████████▌ | 2551/3000 [00:01<00:00, 1844.40it/s]warmup should be done:  86%|████████▌ | 2569/3000 [00:01<00:00, 1814.49it/s]warmup should be done:  86%|████████▋ | 2592/3000 [00:01<00:00, 1849.56it/s]warmup should be done:  86%|████████▌ | 2578/3000 [00:01<00:00, 1845.45it/s]warmup should be done:  91%|█████████▏| 2741/3000 [00:01<00:00, 1860.98it/s]warmup should be done:  92%|█████████▏| 2754/3000 [00:01<00:00, 1823.92it/s]warmup should be done:  93%|█████████▎| 2779/3000 [00:01<00:00, 1853.43it/s]warmup should be done:  92%|█████████▏| 2766/3000 [00:01<00:00, 1854.27it/s]warmup should be done:  98%|█████████▊| 2931/3000 [00:01<00:00, 1870.15it/s]warmup should be done:  99%|█████████▉| 2967/3000 [00:01<00:00, 1860.95it/s]warmup should be done:  98%|█████████▊| 2937/3000 [00:01<00:00, 1774.55it/s]warmup should be done:  98%|█████████▊| 2954/3000 [00:01<00:00, 1859.76it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1836.65it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1824.81it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1814.70it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1808.15it/s]2022-12-11 21:39:41.656679: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1682a65140 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:39:41.656741: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:39:45.850639: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1682a6b180 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:39:45.850713: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:39:46.075455: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:39:47.199770: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f167a268c60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:39:47.199832: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:39:47.377280: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1682a683f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:39:47.377347: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:39:48.076095: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:39:49.982144: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:39:50.453663: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:39:51.688139: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:39:51.809172: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:39:52.431277: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:39:53.043463: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:39:53.775251: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:39:54.351540: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:39:54.424563: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:39:55.678022: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][21:40:26.392][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][21:40:26.392][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][21:40:26.397][ERROR][RK0][main]: coll ps creation done
[HCTR][21:40:26.397][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][21:40:26.661][ERROR][RK0][tid #139734747707136]: replica 2 reaches 1000, calling init pre replica
[HCTR][21:40:26.661][ERROR][RK0][tid #139734747707136]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][21:40:26.665][ERROR][RK0][tid #139734747707136]: coll ps creation done
[HCTR][21:40:26.665][ERROR][RK0][tid #139734747707136]: replica 2 waits for coll ps creation barrier
[HCTR][21:40:26.723][ERROR][RK0][tid #139734747707136]: replica 1 reaches 1000, calling init pre replica
[HCTR][21:40:26.723][ERROR][RK0][tid #139734747707136]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][21:40:26.726][ERROR][RK0][tid #139734747707136]: coll ps creation done
[HCTR][21:40:26.726][ERROR][RK0][tid #139734747707136]: replica 1 waits for coll ps creation barrier
[HCTR][21:40:26.797][ERROR][RK0][tid #139734814816000]: replica 0 reaches 1000, calling init pre replica
[HCTR][21:40:26.797][ERROR][RK0][tid #139734814816000]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][21:40:26.801][ERROR][RK0][tid #139734814816000]: coll ps creation done
[HCTR][21:40:26.801][ERROR][RK0][tid #139734814816000]: replica 0 waits for coll ps creation barrier
[HCTR][21:40:26.801][ERROR][RK0][tid #139734814816000]: replica 0 preparing frequency
[HCTR][21:40:27.754][ERROR][RK0][tid #139734814816000]: replica 0 preparing frequency done
[HCTR][21:40:27.783][ERROR][RK0][tid #139734814816000]: replica 0 calling init per replica
[HCTR][21:40:27.783][ERROR][RK0][tid #139734747707136]: replica 2 calling init per replica
[HCTR][21:40:27.783][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][21:40:27.783][ERROR][RK0][tid #139734747707136]: replica 1 calling init per replica
[HCTR][21:40:27.783][ERROR][RK0][tid #139734747707136]: Calling build_v2
[HCTR][21:40:27.783][ERROR][RK0][tid #139734814816000]: Calling build_v2
[HCTR][21:40:27.783][ERROR][RK0][main]: Calling build_v2
[HCTR][21:40:27.783][ERROR][RK0][tid #139734747707136]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:40:27.783][ERROR][RK0][tid #139734747707136]: Calling build_v2
[HCTR][21:40:27.783][ERROR][RK0][tid #139734814816000]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:40:27.783][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:40:27.783][ERROR][RK0][tid #139734747707136]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-11 21:40:272022-12-11 21:40:272022-12-11 21:40:27...[784040784054784040: 2022-12-11 21:40:27: : E.EE 784066  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:E::136 136136] /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] ] using concurrent impl MPS:using concurrent impl MPSusing concurrent impl MPS
136

] using concurrent impl MPS
[2022-12-11 21:40:27.785347: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 21:40:27.785374: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 21:40:27[196.2022-12-11 21:40:27] 785390.assigning 8 to cpu: 785393
E[:  2022-12-11 21:40:27E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc. :785417/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc196[: :] 2022-12-11 21:40:27E212assigning 8 to cpu. ] 
785450/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4: :
E196 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[assigning 8 to cpu:2022-12-11 21:40:27
212.] 785536build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[213[2022-12-11 21:40:27] 2022-12-11 21:40:27.remote time is 8.68421[.785571
2022-12-11 21:40:27785582: .[: E7855712022-12-11 21:40:27E : . /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE785616/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: : :212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE213] : ] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421
] :
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4214[
] [2022-12-11 21:40:27cpu time is 302022-12-11 21:40:27.
.785727[785733: 2022-12-11 21:40:27: E.E 785755 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:E:213 214] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] remote time is 8.68421:cpu time is 30
213
] [remote time is 8.684212022-12-11 21:40:27
.785871: E[ 2022-12-11 21:40:27/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:785898214: ] Ecpu time is 30 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 21:40:52.759633: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 21:40:52.824901: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 21:40:52.967417: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 21:40:52.967536: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 21:40:52.967637: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 21:40:52.967713: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 21:40:52.971022: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:40:52.971087: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:40:52.972343: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:40:52.972988: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:40:52.992645: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 21:40:52.992698: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 21:40:52.992929: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:40:52.992970: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:40:52.993675: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:40:52.994233: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-11 21:40:52.2022-12-11 21:40:52998843.: 998843E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc202:] 2023 solved] 
2 solved
[2022-12-11 21:40:52[.2022-12-11 21:40:52998957.: 998961E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc205:] 205] worker 0 thread 3 initing device 3worker 0 thread 2 initing device 2

[[2022-12-11 21:40:522022-12-11 21:40:52..999302999303: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::18151815] ] Building Coll Cache with ... num gpu device is 4Building Coll Cache with ... num gpu device is 4

[[2022-12-11 21:40:522022-12-11 21:40:52..999379999380: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 381.47 MBeager alloc mem 381.47 MB

[2022-12-11 21:40:53.   702: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:40:53.   735: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:40:53.  1733: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-11 21:40:531980.]   1763eager alloc mem 381.47 MB: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:40:53. 55089: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 21:40:53. 56982: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 21:40:53. 57040: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:40:53. 57892: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 21:40:53. 59329: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:40:53. 60270: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:40:53. 60315: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.89 MB
[2022-12-11 21:40:53. 73144: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:40:53. 73735: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:40:53. 73779: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.87 GB
[2022-12-11 21:40:53. 79522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 21:40:53. 81262: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 21:40:53. 81306: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:40:53. 82024: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 21:40:53. 82358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:40:53. 83275: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:40:53. 83319: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.89 MB
[2022-12-11 21:40:53. 97151: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:40:53. 97734: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:40:53. 97775: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.87 GB
[[2022-12-11 21:40:532022-12-11 21:40:53..110147110147: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes

[2022-12-11 21:40:53.111943: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:[6382022-12-11 21:40:53] .eager release cuda mem 5111959
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 21:40:53.111999: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 21:40:53eager release cuda mem 400000000.
112018: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:40:53.112827: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 21:40:53.113313: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 21:40:53.113724: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:40:53.113752: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:40:53.114642: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:40:53.114686: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc[:2022-12-11 21:40:5343.] 114698WORKER[0] alloc host memory 22.89 MB: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:40:53.114753: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.89 MB
[2022-12-11 21:40:53.127628: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:40:53.128225: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:40:53.128268: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.87 GB
[2022-12-11 21:40:53.132110: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:40:53.132694: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:40:53.132736: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.87 GB
[[[[2022-12-11 21:40:532022-12-11 21:40:532022-12-11 21:40:532022-12-11 21:40:53....386949386949386954386954: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 2 init p2p of link 3Device 0 init p2p of link 1Device 1 init p2p of link 2



[[2022-12-11 21:40:53[2022-12-11 21:40:53.2022-12-11 21:40:53.387273.387273: 387281: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 21:40:53:1980:.1980] 1980387339] eager alloc mem 611.00 KB] : eager alloc mem 611.00 KB
eager alloc mem 611.00 KBE

 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:40:53.388171: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:40:53.388203: E[[ 2022-12-11 21:40:532022-12-11 21:40:53/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc..:388216388213638: : ] EEeager release cuda mem 625663  
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 625663eager release cuda mem 625663

[2022-12-11 21:40:53.392854: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 21:40:53.393000: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 21:40:53.393054: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3[
2022-12-11 21:40:53.393090: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:40:53.393130: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] [Device 0 init p2p of link 22022-12-11 21:40:53
.393167: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-11 21:40:532022-12-11 21:40:53..393238393237: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[2022-12-11 21:40:53.393893: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:40:53.393968: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[[2022-12-11 21:40:532022-12-11 21:40:53..394095394095: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 625663eager release cuda mem 625663

[2022-12-11 21:40:53.403693: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 21:40:53.403804: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:40:53.404084: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-11 21:40:531926.] 404111Device 1 init p2p of link 0: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 21:40:53.404230: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:40:53.404286: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:40:53.404310: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 21:40:53.404523: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:40:53.404632: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:40:53.405031: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:40:53.405092: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:40:53.405405: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:40:53.409032: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 21:40:53.409356: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 5999999 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17999997 / 100000000 nodes ( 18.00 %) | cpu 76000004 / 100000000 nodes ( 76.00 %) | 2.87 GB | 0.409993 secs 
[2022-12-11 21:40:53.409884: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 21:40:53.410060: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 21:40:53.410220: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 5999999 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17999997 / 100000000 nodes ( 18.00 %) | cpu 76000004 / 100000000 nodes ( 76.00 %) | 2.87 GB | 0.417254 secs 
[2022-12-11 21:40:53.410347: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:2022-12-11 21:40:53638.] 410405eager release cuda mem 24399996: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 5999999 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17999997 / 100000000 nodes ( 18.00 %) | cpu 76000004 / 100000000 nodes ( 76.00 %) | 2.87 GB | 0.43933 secs 
[2022-12-11 21:40:53.410874: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 5999999 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17999997 / 100000000 nodes ( 18.00 %) | cpu 76000004 / 100000000 nodes ( 76.00 %) | 2.87 GB | 0.411512 secs 
[2022-12-11 21:40:53.411591: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.90 GB
[2022-12-11 21:40:54.415243: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.14 GB
[2022-12-11 21:40:54.415421: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.14 GB
[2022-12-11 21:40:54.415837: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.14 GB
[2022-12-11 21:40:55.345764: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.39 GB
[2022-12-11 21:40:55.346105: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.39 GB
[2022-12-11 21:40:55.346646: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.39 GB
[2022-12-11 21:40:56.127830: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.63 GB
[2022-12-11 21:40:56.127951: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.63 GB
[2022-12-11 21:40:56.128313: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.63 GB
[2022-12-11 21:40:56.901206: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.04 GB
[2022-12-11 21:40:56.901325: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.04 GB
[2022-12-11 21:40:56.902189: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.04 GB
[2022-12-11 21:40:57.692373: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.23 GB
[2022-12-11 21:40:57.692524: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.23 GB
[HCTR][21:40:57.825][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][21:40:57.825][ERROR][RK0][tid #139734747707136]: replica 2 calling init per replica done, doing barrier
[HCTR][21:40:57.825][ERROR][RK0][tid #139734814816000]: replica 0 calling init per replica done, doing barrier
[HCTR][21:40:57.825][ERROR][RK0][tid #139734747707136]: replica 1 calling init per replica done, doing barrier
[HCTR][21:40:57.825][ERROR][RK0][tid #139734747707136]: replica 1 calling init per replica done, doing barrier done
[HCTR][21:40:57.825][ERROR][RK0][tid #139734814816000]: replica 0 calling init per replica done, doing barrier done
[HCTR][21:40:57.825][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][21:40:57.825][ERROR][RK0][tid #139734747707136]: replica 2 calling init per replica done, doing barrier done
[HCTR][21:40:57.825][ERROR][RK0][tid #139734747707136]: init per replica done
[HCTR][21:40:57.825][ERROR][RK0][tid #139734747707136]: init per replica done
[HCTR][21:40:57.825][ERROR][RK0][main]: init per replica done
[HCTR][21:40:57.827][ERROR][RK0][tid #139734814816000]: init per replica done
[HCTR][21:40:57.832][ERROR][RK0][tid #139734747707136]: 2 allocated 3276800 at 0x7f047b520000
[HCTR][21:40:57.832][ERROR][RK0][tid #139734747707136]: 2 allocated 6553600 at 0x7effde000000
[HCTR][21:40:57.832][ERROR][RK0][tid #139734747707136]: 2 allocated 3276800 at 0x7effde640000
[HCTR][21:40:57.832][ERROR][RK0][tid #139734747707136]: 2 allocated 6553600 at 0x7effde960000
[HCTR][21:40:57.832][ERROR][RK0][tid #139734747707136]: 1 allocated 3276800 at 0x7f047b520000
[HCTR][21:40:57.832][ERROR][RK0][tid #139734747707136]: 1 allocated 6553600 at 0x7effd2000000
[HCTR][21:40:57.832][ERROR][RK0][tid #139734747707136]: 1 allocated 3276800 at 0x7effd2640000
[HCTR][21:40:57.832][ERROR][RK0][tid #139734747707136]: 1 allocated 6553600 at 0x7effd2960000
[HCTR][21:40:57.835][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f047b520000
[HCTR][21:40:57.835][ERROR][RK0][main]: 3 allocated 6553600 at 0x7effd2000000
[HCTR][21:40:57.835][ERROR][RK0][main]: 3 allocated 3276800 at 0x7effd2640000
[HCTR][21:40:57.835][ERROR][RK0][main]: 3 allocated 6553600 at 0x7effd2960000
[HCTR][21:40:57.836][ERROR][RK0][tid #139734814816000]: 0 allocated 3276800 at 0x7effa6320000
[HCTR][21:40:57.836][ERROR][RK0][tid #139734814816000]: 0 allocated 6553600 at 0x7effa6800000
[HCTR][21:40:57.836][ERROR][RK0][tid #139734814816000]: 0 allocated 3276800 at 0x7effa750e800
[HCTR][21:40:57.836][ERROR][RK0][tid #139734814816000]: 0 allocated 6553600 at 0x7effa782e800




