2022-12-12 00:04:26.174850: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:04:26.188407: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:04:26.300502: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:04:26.300706: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:04:27.076046: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:04:27.076196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 00:04:27.078939: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:04:27.078998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 00:04:27.092126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 00:04:27.097456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 00:04:27.128674: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:04:27.128837: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:04:27.129843: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 00:04:27.131119: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:04:27.131242: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:04:27.132825: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 00:04:27.161814: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:04:27.161901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 00:04:27.167735: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:04:27.167808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 00:04:27.174469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 00:04:27.179942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 00:04:27.205538: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:04:27.205689: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:04:27.206590: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 00:04:27.212137: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:04:27.212270: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:04:27.212993: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][00:04:28.438][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:04:28.451][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:04:28.495][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:04:28.495][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.50s/it]warmup run: 103it [00:01, 89.40it/s]warmup run: 210it [00:01, 197.79it/s]warmup run: 317it [00:01, 316.72it/s]warmup run: 411it [00:01, 417.91it/s]warmup run: 517it [00:01, 538.63it/s]warmup run: 621it [00:02, 644.37it/s]warmup run: 0it [00:00, ?it/s]warmup run: 720it [00:02, 724.07it/s]warmup run: 831it [00:02, 818.63it/s]warmup run: 943it [00:02, 896.84it/s]warmup run: 1it [00:01,  1.53s/it]warmup run: 1054it [00:02, 952.58it/s]warmup run: 110it [00:01, 93.58it/s]warmup run: 1168it [00:02, 1003.70it/s]warmup run: 0it [00:00, ?it/s]warmup run: 216it [00:01, 198.39it/s]warmup run: 1277it [00:02, 1001.41it/s]warmup run: 322it [00:01, 313.96it/s]warmup run: 1385it [00:02, 1022.83it/s]warmup run: 432it [00:01, 439.78it/s]warmup run: 1493it [00:02, 1038.26it/s]warmup run: 538it [00:02, 554.61it/s]warmup run: 1600it [00:03, 1045.38it/s]warmup run: 647it [00:02, 666.63it/s]warmup run: 1709it [00:03, 1055.81it/s]warmup run: 758it [00:02, 768.28it/s]warmup run: 1817it [00:03, 1061.72it/s]warmup run: 864it [00:02, 839.94it/s]warmup run: 1925it [00:03, 1046.99it/s]warmup run: 970it [00:02, 896.99it/s]warmup run: 2031it [00:03, 1029.58it/s]warmup run: 1076it [00:02, 937.54it/s]warmup run: 2162it [00:03, 1110.00it/s]warmup run: 1182it [00:02, 969.86it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 2296it [00:03, 1175.43it/s]warmup run: 1289it [00:02, 998.14it/s]warmup run: 110it [00:01, 100.55it/s]warmup run: 2431it [00:03, 1226.58it/s]warmup run: 1395it [00:02, 1015.58it/s]warmup run: 221it [00:01, 217.35it/s]warmup run: 2566it [00:03, 1262.40it/s]warmup run: 1502it [00:02, 1029.91it/s]warmup run: 333it [00:01, 345.09it/s]warmup run: 2697it [00:03, 1274.07it/s]warmup run: 1609it [00:03, 1041.56it/s]warmup run: 446it [00:01, 476.66it/s]warmup run: 2831it [00:04, 1292.86it/s]warmup run: 1716it [00:03, 1049.36it/s]warmup run: 559it [00:01, 602.56it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 2965it [00:04, 1305.12it/s]warmup run: 3000it [00:04, 720.47it/s] warmup run: 1824it [00:03, 1056.26it/s]warmup run: 672it [00:02, 716.70it/s]warmup run: 105it [00:01, 95.89it/s]warmup run: 1931it [00:03, 1056.72it/s]warmup run: 783it [00:02, 808.55it/s]warmup run: 203it [00:01, 198.18it/s]warmup run: 2045it [00:03, 1081.26it/s]warmup run: 892it [00:02, 878.83it/s]warmup run: 310it [00:01, 321.58it/s]warmup run: 2172it [00:03, 1136.89it/s]warmup run: 1001it [00:02, 920.98it/s]warmup run: 410it [00:01, 435.18it/s]warmup run: 2306it [00:03, 1196.56it/s]warmup run: 516it [00:01, 555.73it/s]warmup run: 1108it [00:02, 959.66it/s]warmup run: 2439it [00:03, 1234.71it/s]warmup run: 623it [00:02, 666.90it/s]warmup run: 1215it [00:02, 989.47it/s]warmup run: 2574it [00:03, 1267.91it/s]warmup run: 730it [00:02, 761.36it/s]warmup run: 1322it [00:02, 1004.12it/s]warmup run: 2707it [00:03, 1285.37it/s]warmup run: 837it [00:02, 837.31it/s]warmup run: 1431it [00:02, 1026.52it/s]warmup run: 2841it [00:04, 1299.46it/s]warmup run: 944it [00:02, 898.16it/s]warmup run: 1538it [00:02, 1038.27it/s]warmup run: 2974it [00:04, 1308.13it/s]warmup run: 1051it [00:02, 944.00it/s]warmup run: 1645it [00:02, 1046.88it/s]warmup run: 3000it [00:04, 719.59it/s] warmup run: 1754it [00:03, 1054.39it/s]warmup run: 1157it [00:02, 961.08it/s]warmup run: 1862it [00:03, 1061.68it/s]warmup run: 1262it [00:02, 985.32it/s]warmup run: 1970it [00:03, 1063.99it/s]warmup run: 1366it [00:02, 995.37it/s]warmup run: 2097it [00:03, 1124.55it/s]warmup run: 1475it [00:02, 1022.60it/s]warmup run: 2233it [00:03, 1193.79it/s]warmup run: 1582it [00:02, 1035.08it/s]warmup run: 2369it [00:03, 1242.36it/s]warmup run: 1689it [00:03, 1044.08it/s]warmup run: 2505it [00:03, 1275.65it/s]warmup run: 1797it [00:03, 1051.85it/s]warmup run: 2641it [00:03, 1300.80it/s]warmup run: 1904it [00:03, 1055.02it/s]warmup run: 2777it [00:03, 1316.60it/s]warmup run: 2013it [00:03, 1063.47it/s]warmup run: 2913it [00:03, 1328.14it/s]warmup run: 2145it [00:03, 1137.89it/s]warmup run: 3000it [00:04, 748.61it/s] warmup run: 2277it [00:03, 1191.60it/s]warmup run: 2409it [00:03, 1229.16it/s]warmup run: 2542it [00:03, 1256.83it/s]warmup run: 2673it [00:03, 1270.72it/s]warmup run: 2805it [00:03, 1285.05it/s]warmup run: 2937it [00:04, 1294.58it/s]warmup run: 3000it [00:04, 733.52it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1753.86it/s]warmup should be done:   5%|▌         | 163/3000 [00:00<00:01, 1625.34it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1670.85it/s]warmup should be done:   5%|▌         | 164/3000 [00:00<00:01, 1633.79it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1733.58it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1759.24it/s]warmup should be done:  11%|█▏        | 341/3000 [00:00<00:01, 1701.88it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1725.96it/s]warmup should be done:  17%|█▋        | 524/3000 [00:00<00:01, 1762.92it/s]warmup should be done:  18%|█▊        | 529/3000 [00:00<00:01, 1710.88it/s]warmup should be done:  17%|█▋        | 517/3000 [00:00<00:01, 1694.04it/s]warmup should be done:  17%|█▋        | 512/3000 [00:00<00:01, 1591.59it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1782.16it/s]warmup should be done:  24%|██▎       | 710/3000 [00:00<00:01, 1747.43it/s]warmup should be done:  23%|██▎       | 690/3000 [00:00<00:01, 1705.52it/s]warmup should be done:  23%|██▎       | 685/3000 [00:00<00:01, 1641.07it/s]warmup should be done:  30%|██▉       | 886/3000 [00:00<00:01, 1786.59it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1763.23it/s]warmup should be done:  29%|██▊       | 861/3000 [00:00<00:01, 1703.98it/s]warmup should be done:  29%|██▊       | 856/3000 [00:00<00:01, 1664.53it/s]warmup should be done:  36%|███▌      | 1065/3000 [00:00<00:01, 1786.98it/s]warmup should be done:  34%|███▍      | 1032/3000 [00:00<00:01, 1704.41it/s]warmup should be done:  36%|███▌      | 1067/3000 [00:00<00:01, 1759.36it/s]warmup should be done:  34%|███▍      | 1027/3000 [00:00<00:01, 1677.84it/s]warmup should be done:  42%|████▏     | 1245/3000 [00:00<00:00, 1789.85it/s]warmup should be done:  42%|████▏     | 1245/3000 [00:00<00:00, 1765.41it/s]warmup should be done:  40%|████      | 1203/3000 [00:00<00:01, 1703.13it/s]warmup should be done:  40%|████      | 1203/3000 [00:00<00:01, 1701.77it/s]warmup should be done:  48%|████▊     | 1426/3000 [00:00<00:00, 1796.01it/s]warmup should be done:  46%|████▌     | 1375/3000 [00:00<00:00, 1707.11it/s]warmup should be done:  47%|████▋     | 1422/3000 [00:00<00:00, 1732.57it/s]warmup should be done:  46%|████▌     | 1382/3000 [00:00<00:00, 1727.19it/s]warmup should be done:  54%|█████▎    | 1608/3000 [00:00<00:00, 1801.12it/s]warmup should be done:  52%|█████▏    | 1547/3000 [00:00<00:00, 1709.81it/s]warmup should be done:  53%|█████▎    | 1603/3000 [00:00<00:00, 1754.02it/s]warmup should be done:  52%|█████▏    | 1561/3000 [00:00<00:00, 1745.36it/s]warmup should be done:  60%|█████▉    | 1790/3000 [00:01<00:00, 1806.02it/s]warmup should be done:  57%|█████▋    | 1719/3000 [00:01<00:00, 1709.92it/s]warmup should be done:  58%|█████▊    | 1740/3000 [00:01<00:00, 1757.79it/s]warmup should be done:  59%|█████▉    | 1779/3000 [00:01<00:00, 1718.33it/s]warmup should be done:  66%|██████▌   | 1972/3000 [00:01<00:00, 1808.27it/s]warmup should be done:  63%|██████▎   | 1892/3000 [00:01<00:00, 1713.18it/s]warmup should be done:  64%|██████▍   | 1917/3000 [00:01<00:00, 1759.99it/s]warmup should be done:  65%|██████▌   | 1957/3000 [00:01<00:00, 1734.61it/s]warmup should be done:  72%|███████▏  | 2154/3000 [00:01<00:00, 1808.88it/s]warmup should be done:  69%|██████▉   | 2065/3000 [00:01<00:00, 1716.94it/s]warmup should be done:  70%|██████▉   | 2094/3000 [00:01<00:00, 1759.45it/s]warmup should be done:  71%|███████   | 2135/3000 [00:01<00:00, 1745.78it/s]warmup should be done:  78%|███████▊  | 2335/3000 [00:01<00:00, 1804.87it/s]warmup should be done:  75%|███████▍  | 2242/3000 [00:01<00:00, 1731.30it/s]warmup should be done:  76%|███████▌  | 2270/3000 [00:01<00:00, 1757.35it/s]warmup should be done:  77%|███████▋  | 2313/3000 [00:01<00:00, 1755.53it/s]warmup should be done:  84%|████████▍ | 2516/3000 [00:01<00:00, 1805.23it/s]warmup should be done:  81%|████████  | 2421/3000 [00:01<00:00, 1746.51it/s]warmup should be done:  82%|████████▏ | 2449/3000 [00:01<00:00, 1765.64it/s]warmup should be done:  83%|████████▎ | 2489/3000 [00:01<00:00, 1727.49it/s]warmup should be done:  90%|████████▉ | 2697/3000 [00:01<00:00, 1769.44it/s]warmup should be done:  87%|████████▋ | 2599/3000 [00:01<00:00, 1755.79it/s]warmup should be done:  88%|████████▊ | 2626/3000 [00:01<00:00, 1763.80it/s]warmup should be done:  89%|████████▊ | 2662/3000 [00:01<00:00, 1700.78it/s]warmup should be done:  93%|█████████▎| 2778/3000 [00:01<00:00, 1764.00it/s]warmup should be done:  96%|█████████▌| 2875/3000 [00:01<00:00, 1767.42it/s]warmup should be done:  93%|█████████▎| 2803/3000 [00:01<00:00, 1764.19it/s]warmup should be done:  94%|█████████▍| 2833/3000 [00:01<00:00, 1662.84it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1782.58it/s]warmup should be done:  99%|█████████▊| 2957/3000 [00:01<00:00, 1771.38it/s]warmup should be done:  99%|█████████▉| 2981/3000 [00:01<00:00, 1766.75it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1731.18it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1729.37it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1659.90it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1719.70it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1688.24it/s]warmup should be done:   6%|▌         | 183/3000 [00:00<00:01, 1820.78it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1734.06it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1711.50it/s]warmup should be done:  12%|█▏        | 367/3000 [00:00<00:01, 1829.89it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1781.79it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1748.81it/s]warmup should be done:  11%|█▏        | 338/3000 [00:00<00:01, 1670.38it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1797.42it/s]warmup should be done:  18%|█▊        | 551/3000 [00:00<00:01, 1830.76it/s]warmup should be done:  18%|█▊        | 532/3000 [00:00<00:01, 1779.14it/s]warmup should be done:  17%|█▋        | 509/3000 [00:00<00:01, 1683.87it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1804.13it/s]warmup should be done:  24%|██▍       | 735/3000 [00:00<00:01, 1830.89it/s]warmup should be done:  24%|██▎       | 710/3000 [00:00<00:01, 1778.07it/s]warmup should be done:  23%|██▎       | 678/3000 [00:00<00:01, 1631.76it/s]warmup should be done:  30%|███       | 903/3000 [00:00<00:01, 1811.15it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1784.73it/s]warmup should be done:  31%|███       | 919/3000 [00:00<00:01, 1831.60it/s]warmup should be done:  28%|██▊       | 855/3000 [00:00<00:01, 1679.11it/s]warmup should be done:  36%|███▌      | 1086/3000 [00:00<00:01, 1816.97it/s]warmup should be done:  37%|███▋      | 1103/3000 [00:00<00:01, 1830.31it/s]warmup should be done:  36%|███▌      | 1069/3000 [00:00<00:01, 1774.83it/s]warmup should be done:  34%|███▍      | 1029/3000 [00:00<00:01, 1699.25it/s]warmup should be done:  42%|████▏     | 1268/3000 [00:00<00:00, 1813.84it/s]warmup should be done:  42%|████▏     | 1247/3000 [00:00<00:00, 1774.36it/s]warmup should be done:  43%|████▎     | 1287/3000 [00:00<00:00, 1822.27it/s]warmup should be done:  40%|████      | 1208/3000 [00:00<00:01, 1725.61it/s]warmup should be done:  48%|████▊     | 1452/3000 [00:00<00:00, 1819.41it/s]warmup should be done:  48%|████▊     | 1427/3000 [00:00<00:00, 1780.38it/s]warmup should be done:  49%|████▉     | 1470/3000 [00:00<00:00, 1822.02it/s]warmup should be done:  46%|████▌     | 1385/3000 [00:00<00:00, 1736.87it/s]warmup should be done:  55%|█████▍    | 1635/3000 [00:00<00:00, 1821.95it/s]warmup should be done:  54%|█████▎    | 1607/3000 [00:00<00:00, 1783.50it/s]warmup should be done:  55%|█████▌    | 1653/3000 [00:00<00:00, 1822.21it/s]warmup should be done:  52%|█████▏    | 1565/3000 [00:00<00:00, 1754.78it/s]warmup should be done:  61%|██████    | 1818/3000 [00:01<00:00, 1819.78it/s]warmup should be done:  61%|██████    | 1837/3000 [00:01<00:00, 1824.64it/s]warmup should be done:  60%|█████▉    | 1786/3000 [00:01<00:00, 1779.16it/s]warmup should be done:  58%|█████▊    | 1742/3000 [00:01<00:00, 1757.95it/s]warmup should be done:  67%|██████▋   | 2000/3000 [00:01<00:00, 1816.84it/s]warmup should be done:  67%|██████▋   | 2020/3000 [00:01<00:00, 1824.85it/s]warmup should be done:  66%|██████▌   | 1965/3000 [00:01<00:00, 1781.62it/s]warmup should be done:  64%|██████▍   | 1924/3000 [00:01<00:00, 1774.25it/s]warmup should be done:  73%|███████▎  | 2182/3000 [00:01<00:00, 1812.19it/s]warmup should be done:  72%|███████▏  | 2149/3000 [00:01<00:00, 1798.20it/s]warmup should be done:  73%|███████▎  | 2203/3000 [00:01<00:00, 1824.45it/s]warmup should be done:  70%|███████   | 2102/3000 [00:01<00:00, 1764.53it/s]warmup should be done:  78%|███████▊  | 2334/3000 [00:01<00:00, 1811.30it/s]warmup should be done:  79%|███████▉  | 2364/3000 [00:01<00:00, 1798.85it/s]warmup should be done:  80%|███████▉  | 2386/3000 [00:01<00:00, 1785.80it/s]warmup should be done:  76%|███████▌  | 2283/3000 [00:01<00:00, 1776.16it/s]warmup should be done:  84%|████████▍ | 2518/3000 [00:01<00:00, 1816.97it/s]warmup should be done:  85%|████████▍ | 2544/3000 [00:01<00:00, 1767.60it/s]warmup should be done:  86%|████████▌ | 2571/3000 [00:01<00:00, 1802.15it/s]warmup should be done:  82%|████████▏ | 2461/3000 [00:01<00:00, 1766.61it/s]warmup should be done:  90%|█████████ | 2702/3000 [00:01<00:00, 1821.82it/s]warmup should be done:  92%|█████████▏| 2755/3000 [00:01<00:00, 1812.42it/s]warmup should be done:  88%|████████▊ | 2641/3000 [00:01<00:00, 1775.39it/s]warmup should be done:  91%|█████████ | 2726/3000 [00:01<00:00, 1741.08it/s]warmup should be done:  96%|█████████▌| 2886/3000 [00:01<00:00, 1824.67it/s]warmup should be done:  98%|█████████▊| 2939/3000 [00:01<00:00, 1819.11it/s]warmup should be done:  94%|█████████▍| 2821/3000 [00:01<00:00, 1781.67it/s]warmup should be done:  97%|█████████▋| 2901/3000 [00:01<00:00, 1672.94it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1819.44it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1795.69it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1771.09it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1746.64it/s]2022-12-12 00:05:46.611918: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f528ea68be0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:05:46.611988: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:05:46.618388: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f5296a6aff0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:05:46.618448: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:05:48.249633: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:05:48.607321: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f5296a67b10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:05:48.607380: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:05:49.373460: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:05:50.658443: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:05:50.819816: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:05:52.714983: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:05:52.952768: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:05:54.596014: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:05:54.753875: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:05:55.398402: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f528e265150 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:05:55.398461: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:05:56.115430: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:05:57.527342: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:05:58.606972: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:05:59.883201: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][00:06:26.559][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][00:06:26.559][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][00:06:26.566][ERROR][RK0][main]: coll ps creation done
[HCTR][00:06:26.566][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][00:06:26.663][ERROR][RK0][tid #139992848398080]: replica 2 reaches 1000, calling init pre replica
[HCTR][00:06:26.663][ERROR][RK0][tid #139992848398080]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][00:06:26.668][ERROR][RK0][tid #139992848398080]: coll ps creation done
[HCTR][00:06:26.668][ERROR][RK0][tid #139992848398080]: replica 2 waits for coll ps creation barrier
[HCTR][00:06:26.777][ERROR][RK0][tid #139992772896512]: replica 1 reaches 1000, calling init pre replica
[HCTR][00:06:26.777][ERROR][RK0][tid #139992772896512]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][00:06:26.781][ERROR][RK0][tid #139992772896512]: coll ps creation done
[HCTR][00:06:26.781][ERROR][RK0][tid #139992772896512]: replica 1 waits for coll ps creation barrier
[HCTR][00:06:26.893][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][00:06:26.893][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][00:06:26.897][ERROR][RK0][main]: coll ps creation done
[HCTR][00:06:26.897][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][00:06:26.897][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][00:06:27.811][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][00:06:27.845][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][00:06:27.845][ERROR][RK0][tid #139992772896512]: replica 1 calling init per replica
[HCTR][00:06:27.845][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][00:06:27.845][ERROR][RK0][main]: Calling build_v2
[HCTR][00:06:27.845][ERROR][RK0][tid #139992772896512]: Calling build_v2
[HCTR][00:06:27.845][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:06:27.845][ERROR][RK0][main]: Calling build_v2
[HCTR][00:06:27.845][ERROR][RK0][tid #139992772896512]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:06:27.845][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:06:27.845][ERROR][RK0][tid #139992848398080]: replica 2 calling init per replica
[[2022-12-12 00:06:27.2022-12-12 00:06:27[845350.: 845351E[HCTR][00:06:27.845][ERROR][RK0][tid #139992848398080]: Calling build_v2
: 2022-12-12 00:06:27 E./hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc 845364:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: 136:E] 136 using concurrent impl MPS[HCTR][00:06:27.845][ERROR][RK0][tid #139992848398080]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
] /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc
using concurrent impl MPS:
136] using concurrent impl MPS
[2022-12-12 00:06:27.845601: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-12 00:06:27.846642: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-12 00:06:27.846665: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-12 00:06:27.846689: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 00:06:27.846720: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-12 00:06:27196[.] 2022-12-12 00:06:27846740assigning 8 to cpu.: 
846749E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[213:2022-12-12 00:06:27] 212.remote time is 8.68421[] 846799
2022-12-12 00:06:27build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[: .
2022-12-12 00:06:27E846814.[ : 8468492022-12-12 00:06:27/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: .: E846876196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc : ] :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccEassigning 8 to cpu212: 
] 214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4] :
cpu time is 30213
] remote time is 8.68421
[2022-12-12 00:06:27.847006: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2132022-12-12 00:06:27] .remote time is 8.68421[847012
2022-12-12 00:06:27: .E[847011 2022-12-12 00:06:27: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.E:847065 214: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] E:cpu time is 30 212
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :build symm link desc with 4X Tesla V100-SXM2-16GB out of 4214
] cpu time is 30
[2022-12-12 00:06:27.847198: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 00:06:27.847245: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 00:06:51. 92490: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 00:06:51.163841: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-12 00:06:51.315327: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 00:06:51.315391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 00:06:51.315425: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 00:06:51.315456: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 00:06:51.316120: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:06:51.316172: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:06:51.317007: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:06:51.317572: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:06:51.340447: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 00:06:51.340522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 00:06:51.340834: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:06:51.340888: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:06:51.341645: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:06:51.342201: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:06:51.[345535: E2022-12-12 00:06:51 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc345560:: 202E]  2 solved/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc
:202] 1 solved
[2022-12-12 00:06:51.345655: [E2022-12-12 00:06:51 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc345664:: 205E]  worker 0 thread 2 initing device 2/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc
:205] worker 0 thread 1 initing device 1
[2022-12-12 00:06:51.346373: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:06:51.346434: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:06:51.346512: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:06:51.346576: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:06:51.[3479112022-12-12 00:06:51: .E347918 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 381.47 MB1980
] eager alloc mem 381.47 MB
[2022-12-12 00:06:51.349004: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB[
2022-12-12 00:06:51.349028: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:06:51.395596: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 00:06:51.399178: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 00:06:51.399270: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:06:51.400075: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:06:51.400568: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:06:51.401569: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:06:51.401617: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.78 MB
[2022-12-12 00:06:51.424132: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 00:06:51.424604: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:06:51.425189: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:06:51.425231: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[2022-12-12 00:06:51.425886: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 00:06:51.425932: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:06:51.437169: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:06:51.437649: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:06:51.438603: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:06:51.438648: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.78 MB
[[2022-12-12 00:06:512022-12-12 00:06:51..456007456008: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes

[[2022-12-12 00:06:512022-12-12 00:06:51..457892457899: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 5eager release cuda mem 5

[[2022-12-12 00:06:512022-12-12 00:06:51..457979457979: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 400000000eager release cuda mem 400000000

[2022-12-12 00:06:51.458845: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:06:51.459338: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[[2022-12-12 00:06:512022-12-12 00:06:51..459940459940: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[2022-12-12 00:06:51.[4609192022-12-12 00:06:51: .E460928 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 625663638
] eager release cuda mem 625663
[2022-12-12 00:06:51.460987: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:[432022-12-12 00:06:51] .WORKER[0] alloc host memory 45.78 MB461005
: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.78 MB
[2022-12-12 00:06:51.462383: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:06:51.462961: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:06:51.463003: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[2022-12-12 00:06:51.482565: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:06:51.483154: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:06:51.483193: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[2022-12-12 00:06:51.483446: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:06:51.484018: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:06:51.484057: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[[[[2022-12-12 00:06:522022-12-12 00:06:522022-12-12 00:06:522022-12-12 00:06:52.... 18806 18794 18795 18794: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 1 init p2p of link 2Device 2 init p2p of link 3Device 0 init p2p of link 1Device 3 init p2p of link 0



[2022-12-12 00:06:52.[ 191382022-12-12 00:06:52[: .2022-12-12 00:06:52E 19144. :  19148/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: : [E1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-12 00:06:52 ] :./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB1980 19200:
] : 1980eager alloc mem 611.00 KBE] 
 eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-12 00:06:52. 20061[: 2022-12-12 00:06:52E.  20071/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :[E638[2022-12-12 00:06:52 ] 2022-12-12 00:06:52./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 625663. 20090:
 20099: 638: E] E eager release cuda mem 625663 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 625663eager release cuda mem 625663

[2022-12-12 00:06:52. 28787: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 00:06:52. 28833: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-12 00:06:52. 28892: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:06:52. 28910: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926[] 2022-12-12 00:06:52Device 2 init p2p of link 0.
[ 289472022-12-12 00:06:52: .E 28956 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 611.00 KB1926
[] 2022-12-12 00:06:52Device 1 init p2p of link 3.
 29044: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:06:52. 29157: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:06:52. 29700: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:06:52. 29830: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:06:52. 29873: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:06:52. 29985: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:06:52. 38987: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 00:06:52. 39069: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:06:52. 39351: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 00:06:52.[ 394472022-12-12 00:06:52: .E 39446 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE:[ 19802022-12-12 00:06:52/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] .:eager alloc mem 611.00 KB 394881926
: ] EDevice 2 init p2p of link 1 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 00:06:52. 39614: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-12 00:06:52eager alloc mem 611.00 KB.
 39631: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:06:52. 39878: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:06:52. 40324: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:06:52. 40426: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663[
2022-12-12 00:06:52. 40450: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:06:52. 47227: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:06:52. 47527: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 11999999 / 100000000 nodes ( 12.00 %~12.00 %) | remote 35999997 / 100000000 nodes ( 36.00 %) | cpu 52000004 / 100000000 nodes ( 52.00 %) | 5.73 GB | 0.706658 secs 
[2022-12-12 00:06:52. 48648: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:06:52. 48810: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:06:52. 48868: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:06:52. 48941: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 11999999 / 100000000 nodes ( 12.00 %~12.00 %) | remote 35999997 / 100000000 nodes ( 36.00 %) | cpu 52000004 / 100000000 nodes ( 52.00 %) | 5.73 GB | 0.732785 secs 
[2022-12-12 00:06:52. 49212: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 11999999 / 100000000 nodes ( 12.00 %~12.00 %) | remote 35999997 / 100000000 nodes ( 36.00 %) | cpu 52000004 / 100000000 nodes ( 52.00 %) | 5.73 GB | 0.702801 secs 
[2022-12-12 00:06:52. 49313: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 11999999 / 100000000 nodes ( 12.00 %~12.00 %) | remote 35999997 / 100000000 nodes ( 36.00 %) | cpu 52000004 / 100000000 nodes ( 52.00 %) | 5.73 GB | 0.70276 secs 
[2022-12-12 00:06:52. 49601: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.76 GB
[2022-12-12 00:06:53.294147: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.00 GB
[2022-12-12 00:06:53.294290: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.00 GB
[2022-12-12 00:06:53.294553: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.00 GB
[2022-12-12 00:06:53.985363: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.25 GB
[2022-12-12 00:06:53.985483: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.25 GB
[2022-12-12 00:06:53.985825: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.25 GB
[2022-12-12 00:06:54.662364: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.49 GB
[2022-12-12 00:06:54.662575: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.49 GB
[2022-12-12 00:06:54.662951: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.49 GB
[2022-12-12 00:06:55.470418: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.90 GB
[2022-12-12 00:06:55.470962: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.90 GB
[2022-12-12 00:06:55.472056: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.90 GB
[2022-12-12 00:06:56.273140: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.09 GB
[2022-12-12 00:06:56.273265: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.09 GB
[HCTR][00:06:56.332][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][00:06:56.332][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][00:06:56.332][ERROR][RK0][tid #139992772896512]: replica 1 calling init per replica done, doing barrier
[HCTR][00:06:56.332][ERROR][RK0][tid #139992848398080]: replica 2 calling init per replica done, doing barrier
[HCTR][00:06:56.332][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][00:06:56.332][ERROR][RK0][tid #139992848398080]: replica 2 calling init per replica done, doing barrier done
[HCTR][00:06:56.332][ERROR][RK0][tid #139992772896512]: replica 1 calling init per replica done, doing barrier done
[HCTR][00:06:56.332][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][00:06:56.332][ERROR][RK0][main]: init per replica done
[HCTR][00:06:56.332][ERROR][RK0][tid #139992772896512]: init per replica done
[HCTR][00:06:56.332][ERROR][RK0][tid #139992848398080]: init per replica done
[HCTR][00:06:56.335][ERROR][RK0][main]: init per replica done
[HCTR][00:06:56.340][ERROR][RK0][tid #139992772896512]: 1 allocated 3276800 at 0x7f4087520000
[HCTR][00:06:56.340][ERROR][RK0][tid #139992772896512]: 1 allocated 6553600 at 0x7f408ae00000
[HCTR][00:06:56.340][ERROR][RK0][tid #139992772896512]: 1 allocated 3276800 at 0x7f408b440000
[HCTR][00:06:56.340][ERROR][RK0][tid #139992772896512]: 1 allocated 6553600 at 0x7f408b760000
[HCTR][00:06:56.340][ERROR][RK0][tid #139992848398080]: 2 allocated 3276800 at 0x7f408b520000
[HCTR][00:06:56.340][ERROR][RK0][tid #139992848398080]: 2 allocated 6553600 at 0x7f408ee00000
[HCTR][00:06:56.340][ERROR][RK0][tid #139992848398080]: 2 allocated 3276800 at 0x7f408f440000
[HCTR][00:06:56.340][ERROR][RK0][tid #139992848398080]: 2 allocated 6553600 at 0x7f408f760000
[HCTR][00:06:56.341][ERROR][RK0][tid #139992840005376]: 3 allocated 3276800 at 0x7f4087520000
[HCTR][00:06:56.341][ERROR][RK0][tid #139992840005376]: 3 allocated 6553600 at 0x7f408ae00000
[HCTR][00:06:56.341][ERROR][RK0][tid #139992840005376]: 3 allocated 3276800 at 0x7f408b440000
[HCTR][00:06:56.341][ERROR][RK0][tid #139992840005376]: 3 allocated 6553600 at 0x7f408b760000
[HCTR][00:06:56.343][ERROR][RK0][tid #139992840005376]: 0 allocated 3276800 at 0x7f3aae320000
[HCTR][00:06:56.343][ERROR][RK0][tid #139992840005376]: 0 allocated 6553600 at 0x7f541f200000
[HCTR][00:06:56.343][ERROR][RK0][tid #139992840005376]: 0 allocated 3276800 at 0x7f3aaed0e800
[HCTR][00:06:56.343][ERROR][RK0][tid #139992840005376]: 0 allocated 6553600 at 0x7f3aaf02e800




