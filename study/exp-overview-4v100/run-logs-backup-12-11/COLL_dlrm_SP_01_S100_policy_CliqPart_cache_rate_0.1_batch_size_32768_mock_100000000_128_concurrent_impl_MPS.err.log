2022-12-11 23:15:36.845412: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:15:36.883104: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:15:36.926644: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:15:36.934536: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:15:37.756618: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:15:37.756704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:15:37.769545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:15:37.776543: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:15:37.776704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:15:37.793126: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:15:37.793203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:15:37.793562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:15:37.797488: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:15:37.797561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:15:37.798529: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:15:37.798658: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:15:37.800617: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 23:15:37.808362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:15:37.812320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:15:37.824376: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:15:37.824536: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:15:37.825988: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 23:15:37.838442: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:15:37.838607: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:15:37.840068: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 23:15:37.845164: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:15:37.845322: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:15:37.846911: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][23:15:39.061][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:15:39.075][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:15:39.113][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:15:39.118][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 95it [00:01, 83.27it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 208it [00:01, 199.99it/s]warmup run: 112it [00:01, 102.19it/s]warmup run: 321it [00:01, 327.45it/s]warmup run: 225it [00:01, 220.92it/s]warmup run: 428it [00:01, 449.00it/s]warmup run: 341it [00:01, 353.81it/s]warmup run: 536it [00:01, 568.02it/s]warmup run: 1it [00:01,  1.51s/it]warmup run: 455it [00:01, 485.67it/s]warmup run: 642it [00:02, 672.28it/s]warmup run: 105it [00:01, 90.34it/s]warmup run: 564it [00:01, 602.53it/s]warmup run: 749it [00:02, 764.77it/s]warmup run: 204it [00:01, 189.04it/s]warmup run: 671it [00:02, 702.94it/s]warmup run: 854it [00:02, 832.67it/s]warmup run: 310it [00:01, 306.92it/s]warmup run: 777it [00:02, 779.20it/s]warmup run: 962it [00:02, 896.13it/s]warmup run: 416it [00:01, 428.76it/s]warmup run: 883it [00:02, 848.37it/s]warmup run: 1070it [00:02, 945.99it/s]warmup run: 523it [00:02, 548.94it/s]warmup run: 989it [00:02, 901.83it/s]warmup run: 1176it [00:02, 975.03it/s]warmup run: 631it [00:02, 661.04it/s]warmup run: 1094it [00:02, 937.97it/s]warmup run: 1285it [00:02, 1007.26it/s]warmup run: 739it [00:02, 757.59it/s]warmup run: 1199it [00:02, 958.06it/s]warmup run: 1392it [00:02, 1017.39it/s]warmup run: 847it [00:02, 836.95it/s]warmup run: 1308it [00:02, 993.27it/s]warmup run: 1498it [00:02, 1029.51it/s]warmup run: 955it [00:02, 899.19it/s]warmup run: 1415it [00:02, 1013.49it/s]warmup run: 1607it [00:02, 1046.63it/s]warmup run: 1064it [00:02, 948.88it/s]warmup run: 1it [00:01,  1.47s/it]warmup run: 1524it [00:02, 1034.84it/s]warmup run: 1716it [00:03, 1058.51it/s]warmup run: 1173it [00:02, 988.28it/s]warmup run: 105it [00:01, 92.64it/s]warmup run: 1631it [00:02, 1039.61it/s]warmup run: 1824it [00:03, 1063.25it/s]warmup run: 1283it [00:02, 1019.99it/s]warmup run: 209it [00:01, 198.75it/s]warmup run: 1739it [00:03, 1049.98it/s]warmup run: 1932it [00:03, 1068.01it/s]warmup run: 1392it [00:02, 1019.19it/s]warmup run: 313it [00:01, 314.48it/s]warmup run: 1846it [00:03, 1054.09it/s]warmup run: 2050it [00:03, 1100.38it/s]warmup run: 1501it [00:02, 1038.00it/s]warmup run: 419it [00:01, 436.81it/s]warmup run: 1953it [00:03, 1057.62it/s]warmup run: 2186it [00:03, 1176.21it/s]warmup run: 1609it [00:03, 1050.04it/s]warmup run: 526it [00:01, 556.93it/s]warmup run: 2075it [00:03, 1104.33it/s]warmup run: 2322it [00:03, 1229.35it/s]warmup run: 1717it [00:03, 1055.89it/s]warmup run: 635it [00:02, 669.62it/s]warmup run: 2209it [00:03, 1173.36it/s]warmup run: 2458it [00:03, 1268.25it/s]warmup run: 1825it [00:03, 1062.58it/s]warmup run: 743it [00:02, 764.77it/s]warmup run: 2343it [00:03, 1222.83it/s]warmup run: 2595it [00:03, 1296.58it/s]warmup run: 1933it [00:03, 1042.57it/s]warmup run: 850it [00:02, 841.03it/s]warmup run: 2477it [00:03, 1256.93it/s]warmup run: 2725it [00:03, 1263.60it/s]warmup run: 2050it [00:03, 1078.82it/s]warmup run: 958it [00:02, 903.81it/s]warmup run: 2611it [00:03, 1280.91it/s]warmup run: 2852it [00:04, 1245.14it/s]warmup run: 2183it [00:03, 1152.63it/s]warmup run: 1064it [00:02, 928.67it/s]warmup run: 2745it [00:03, 1296.60it/s]warmup run: 2989it [00:04, 1279.67it/s]warmup run: 3000it [00:04, 727.70it/s] warmup run: 2316it [00:03, 1203.68it/s]warmup run: 1171it [00:02, 967.48it/s]warmup run: 2875it [00:03, 1288.91it/s]warmup run: 2449it [00:03, 1240.95it/s]warmup run: 1277it [00:02, 991.81it/s]warmup run: 3000it [00:04, 741.95it/s] warmup run: 2583it [00:03, 1268.04it/s]warmup run: 1385it [00:02, 1015.29it/s]warmup run: 2716it [00:03, 1284.82it/s]warmup run: 1491it [00:02, 1028.04it/s]warmup run: 2850it [00:04, 1299.57it/s]warmup run: 1598it [00:02, 1039.22it/s]warmup run: 2984it [00:04, 1310.24it/s]warmup run: 3000it [00:04, 721.88it/s] warmup run: 1705it [00:03, 1047.34it/s]warmup run: 1812it [00:03, 1052.43it/s]warmup run: 1920it [00:03, 1057.58it/s]warmup run: 2033it [00:03, 1078.43it/s]warmup run: 2166it [00:03, 1151.51it/s]warmup run: 2296it [00:03, 1194.17it/s]warmup run: 2426it [00:03, 1225.57it/s]warmup run: 2557it [00:03, 1249.04it/s]warmup run: 2688it [00:03, 1267.09it/s]warmup run: 2819it [00:03, 1278.77it/s]warmup run: 2951it [00:04, 1290.64it/s]warmup run: 3000it [00:04, 725.62it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   5%|▌         | 163/3000 [00:00<00:01, 1629.51it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1669.75it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1752.98it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1729.52it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1759.33it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1738.04it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1742.07it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1718.77it/s]warmup should be done:  17%|█▋        | 524/3000 [00:00<00:01, 1754.73it/s]warmup should be done:  17%|█▋        | 523/3000 [00:00<00:01, 1741.47it/s]warmup should be done:  17%|█▋        | 520/3000 [00:00<00:01, 1743.71it/s]warmup should be done:  18%|█▊        | 529/3000 [00:00<00:01, 1748.02it/s]warmup should be done:  23%|██▎       | 702/3000 [00:00<00:01, 1764.12it/s]warmup should be done:  23%|██▎       | 698/3000 [00:00<00:01, 1741.65it/s]warmup should be done:  23%|██▎       | 699/3000 [00:00<00:01, 1758.40it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1752.61it/s]warmup should be done:  29%|██▉       | 879/3000 [00:00<00:01, 1762.89it/s]warmup should be done:  29%|██▉       | 876/3000 [00:00<00:01, 1759.88it/s]warmup should be done:  29%|██▉       | 882/3000 [00:00<00:01, 1746.19it/s]warmup should be done:  29%|██▉       | 873/3000 [00:00<00:01, 1723.56it/s]warmup should be done:  35%|███▌      | 1056/3000 [00:00<00:01, 1760.19it/s]warmup should be done:  35%|███▌      | 1053/3000 [00:00<00:01, 1760.59it/s]warmup should be done:  35%|███▍      | 1046/3000 [00:00<00:01, 1721.59it/s]warmup should be done:  35%|███▌      | 1057/3000 [00:00<00:01, 1735.04it/s]warmup should be done:  41%|████      | 1234/3000 [00:00<00:01, 1763.94it/s]warmup should be done:  41%|████      | 1231/3000 [00:00<00:01, 1764.58it/s]warmup should be done:  41%|████      | 1220/3000 [00:00<00:01, 1727.29it/s]warmup should be done:  41%|████      | 1231/3000 [00:00<00:01, 1683.16it/s]warmup should be done:  47%|████▋     | 1408/3000 [00:00<00:00, 1766.15it/s]warmup should be done:  47%|████▋     | 1412/3000 [00:00<00:00, 1766.64it/s]warmup should be done:  46%|████▋     | 1395/3000 [00:00<00:00, 1734.00it/s]warmup should be done:  47%|████▋     | 1403/3000 [00:00<00:00, 1692.19it/s]warmup should be done:  53%|█████▎    | 1586/3000 [00:00<00:00, 1769.53it/s]warmup should be done:  53%|█████▎    | 1592/3000 [00:00<00:00, 1774.30it/s]warmup should be done:  52%|█████▏    | 1571/3000 [00:00<00:00, 1740.02it/s]warmup should be done:  53%|█████▎    | 1576/3000 [00:00<00:00, 1703.32it/s]warmup should be done:  59%|█████▉    | 1766/3000 [00:01<00:00, 1775.95it/s]warmup should be done:  59%|█████▉    | 1772/3000 [00:01<00:00, 1779.80it/s]warmup should be done:  58%|█████▊    | 1748/3000 [00:01<00:00, 1746.77it/s]warmup should be done:  58%|█████▊    | 1750/3000 [00:01<00:00, 1711.96it/s]warmup should be done:  65%|██████▍   | 1946/3000 [00:01<00:00, 1780.98it/s]warmup should be done:  65%|██████▌   | 1952/3000 [00:01<00:00, 1784.39it/s]warmup should be done:  64%|██████▍   | 1924/3000 [00:01<00:00, 1750.66it/s]warmup should be done:  64%|██████▍   | 1924/3000 [00:01<00:00, 1717.51it/s]warmup should be done:  70%|███████   | 2101/3000 [00:01<00:00, 1754.14it/s]warmup should be done:  71%|███████   | 2125/3000 [00:01<00:00, 1744.12it/s]warmup should be done:  71%|███████   | 2131/3000 [00:01<00:00, 1731.47it/s]warmup should be done:  70%|██████▉   | 2097/3000 [00:01<00:00, 1719.34it/s]warmup should be done:  76%|███████▌  | 2277/3000 [00:01<00:00, 1755.02it/s]warmup should be done:  77%|███████▋  | 2303/3000 [00:01<00:00, 1753.43it/s]warmup should be done:  77%|███████▋  | 2310/3000 [00:01<00:00, 1748.11it/s]warmup should be done:  76%|███████▌  | 2269/3000 [00:01<00:00, 1719.17it/s]warmup should be done:  82%|████████▏ | 2456/3000 [00:01<00:00, 1764.89it/s]warmup should be done:  83%|████████▎ | 2483/3000 [00:01<00:00, 1766.01it/s]warmup should be done:  83%|████████▎ | 2486/3000 [00:01<00:00, 1745.54it/s]warmup should be done:  81%|████████▏ | 2444/3000 [00:01<00:00, 1726.94it/s]warmup should be done:  88%|████████▊ | 2633/3000 [00:01<00:00, 1751.72it/s]warmup should be done:  89%|████████▊ | 2662/3000 [00:01<00:00, 1772.36it/s]warmup should be done:  89%|████████▊ | 2661/3000 [00:01<00:00, 1740.75it/s]warmup should be done:  87%|████████▋ | 2619/3000 [00:01<00:00, 1733.43it/s]warmup should be done:  94%|█████████▎| 2809/3000 [00:01<00:00, 1752.00it/s]warmup should be done:  95%|█████████▍| 2841/3000 [00:01<00:00, 1776.76it/s]warmup should be done:  95%|█████████▍| 2842/3000 [00:01<00:00, 1760.60it/s]warmup should be done:  93%|█████████▎| 2793/3000 [00:01<00:00, 1721.80it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1763.33it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1760.08it/s]warmup should be done: 100%|█████████▉| 2986/3000 [00:01<00:00, 1755.40it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1745.40it/s]warmup should be done:  99%|█████████▉| 2970/3000 [00:01<00:00, 1735.02it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1725.15it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1744.05it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1791.98it/s]warmup should be done:   5%|▌         | 158/3000 [00:00<00:01, 1575.91it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1751.91it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1799.84it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1785.39it/s]warmup should be done:  11%|█         | 337/3000 [00:00<00:01, 1696.83it/s]warmup should be done:  12%|█▏        | 367/3000 [00:00<00:01, 1832.44it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1816.03it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1793.69it/s]warmup should be done:  18%|█▊        | 553/3000 [00:00<00:01, 1843.85it/s]warmup should be done:  17%|█▋        | 516/3000 [00:00<00:01, 1735.99it/s]warmup should be done:  24%|██▍       | 727/3000 [00:00<00:01, 1824.07it/s]warmup should be done:  25%|██▍       | 740/3000 [00:00<00:01, 1850.42it/s]warmup should be done:  23%|██▎       | 695/3000 [00:00<00:01, 1753.58it/s]warmup should be done:  24%|██▍       | 718/3000 [00:00<00:01, 1782.40it/s]warmup should be done:  30%|███       | 911/3000 [00:00<00:01, 1829.41it/s]warmup should be done:  31%|███       | 926/3000 [00:00<00:01, 1853.19it/s]warmup should be done:  29%|██▉       | 874/3000 [00:00<00:01, 1766.55it/s]warmup should be done:  30%|███       | 900/3000 [00:00<00:01, 1792.96it/s]warmup should be done:  37%|███▋      | 1096/3000 [00:00<00:01, 1833.39it/s]warmup should be done:  37%|███▋      | 1112/3000 [00:00<00:01, 1854.60it/s]warmup should be done:  35%|███▌      | 1055/3000 [00:00<00:01, 1780.41it/s]warmup should be done:  36%|███▌      | 1082/3000 [00:00<00:01, 1800.37it/s]warmup should be done:  43%|████▎     | 1298/3000 [00:00<00:00, 1855.13it/s]warmup should be done:  43%|████▎     | 1280/3000 [00:00<00:00, 1831.79it/s]warmup should be done:  41%|████      | 1234/3000 [00:00<00:00, 1783.24it/s]warmup should be done:  42%|████▏     | 1263/3000 [00:00<00:00, 1793.10it/s]warmup should be done:  49%|████▉     | 1484/3000 [00:00<00:00, 1856.56it/s]warmup should be done:  47%|████▋     | 1416/3000 [00:00<00:00, 1794.11it/s]warmup should be done:  49%|████▉     | 1465/3000 [00:00<00:00, 1834.85it/s]warmup should be done:  48%|████▊     | 1445/3000 [00:00<00:00, 1799.36it/s]warmup should be done:  56%|█████▌    | 1671/3000 [00:00<00:00, 1859.10it/s]warmup should be done:  53%|█████▎    | 1599/3000 [00:00<00:00, 1803.64it/s]warmup should be done:  55%|█████▌    | 1650/3000 [00:00<00:00, 1836.45it/s]warmup should be done:  54%|█████▍    | 1627/3000 [00:00<00:00, 1804.80it/s]warmup should be done:  59%|█████▉    | 1780/3000 [00:01<00:00, 1805.17it/s]warmup should be done:  60%|██████    | 1808/3000 [00:01<00:00, 1805.87it/s]warmup should be done:  62%|██████▏   | 1857/3000 [00:01<00:00, 1831.66it/s]warmup should be done:  61%|██████    | 1834/3000 [00:01<00:00, 1807.08it/s]warmup should be done:  65%|██████▌   | 1962/3000 [00:01<00:00, 1809.62it/s]warmup should be done:  66%|██████▋   | 1989/3000 [00:01<00:00, 1805.44it/s]warmup should be done:  68%|██████▊   | 2041/3000 [00:01<00:00, 1831.65it/s]warmup should be done:  67%|██████▋   | 2017/3000 [00:01<00:00, 1813.55it/s]warmup should be done:  72%|███████▏  | 2145/3000 [00:01<00:00, 1814.20it/s]warmup should be done:  72%|███████▏  | 2171/3000 [00:01<00:00, 1808.10it/s]warmup should be done:  74%|███████▍  | 2225/3000 [00:01<00:00, 1831.74it/s]warmup should be done:  73%|███████▎  | 2202/3000 [00:01<00:00, 1821.78it/s]warmup should be done:  78%|███████▊  | 2328/3000 [00:01<00:00, 1818.29it/s]warmup should be done:  78%|███████▊  | 2352/3000 [00:01<00:00, 1806.00it/s]warmup should be done:  80%|████████  | 2409/3000 [00:01<00:00, 1831.69it/s]warmup should be done:  80%|███████▉  | 2387/3000 [00:01<00:00, 1828.06it/s]warmup should be done:  84%|████████▎ | 2511/3000 [00:01<00:00, 1821.16it/s]warmup should be done:  84%|████████▍ | 2535/3000 [00:01<00:00, 1810.57it/s]warmup should be done:  86%|████████▋ | 2593/3000 [00:01<00:00, 1832.67it/s]warmup should be done:  86%|████████▌ | 2573/3000 [00:01<00:00, 1834.89it/s]warmup should be done:  90%|████████▉ | 2694/3000 [00:01<00:00, 1820.77it/s]warmup should be done:  91%|█████████ | 2717/3000 [00:01<00:00, 1808.83it/s]warmup should be done:  93%|█████████▎| 2777/3000 [00:01<00:00, 1834.31it/s]warmup should be done:  92%|█████████▏| 2758/3000 [00:01<00:00, 1839.01it/s]warmup should be done:  96%|█████████▌| 2877/3000 [00:01<00:00, 1819.66it/s]warmup should be done:  97%|█████████▋| 2899/3000 [00:01<00:00, 1809.76it/s]warmup should be done:  99%|█████████▊| 2961/3000 [00:01<00:00, 1834.80it/s]warmup should be done:  98%|█████████▊| 2943/3000 [00:01<00:00, 1841.20it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1839.60it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1827.65it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1802.02it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1794.86it/s]2022-12-11 23:16:53.214305: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f39daa65820 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:16:53.214372: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:16:54.539843: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f39ce26b2b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:16:54.539934: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:16:55.572852: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:16:56.184697: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:16:56.686833: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:16:57.301940: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:16:57.948393: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:16:58.562244: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:16:58.662061: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f39ce267c10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:16:58.662131: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:16:59.155709: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f39daa67c70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:16:59.155769: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:17:02.703400: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:17:03.219853: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:17:04.640655: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:17:05.131448: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:17:06.612383: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:17:07.026937: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][23:17:33.191][ERROR][RK0][tid #139886715713280]: replica 3 reaches 1000, calling init pre replica
[HCTR][23:17:33.192][ERROR][RK0][tid #139886715713280]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][23:17:33.196][ERROR][RK0][tid #139886715713280]: coll ps creation done
[HCTR][23:17:33.196][ERROR][RK0][tid #139886715713280]: replica 3 waits for coll ps creation barrier
[HCTR][23:17:33.717][ERROR][RK0][tid #139886715713280]: replica 0 reaches 1000, calling init pre replica
[HCTR][23:17:33.717][ERROR][RK0][tid #139886715713280]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][23:17:33.721][ERROR][RK0][tid #139886715713280]: coll ps creation done
[HCTR][23:17:33.721][ERROR][RK0][tid #139886715713280]: replica 0 waits for coll ps creation barrier
[HCTR][23:17:33.893][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][23:17:33.893][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][23:17:33.897][ERROR][RK0][main]: coll ps creation done
[HCTR][23:17:33.897][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][23:17:33.974][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][23:17:33.974][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][23:17:33.978][ERROR][RK0][main]: coll ps creation done
[HCTR][23:17:33.978][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][23:17:33.978][ERROR][RK0][tid #139886715713280]: replica 0 preparing frequency
[HCTR][23:17:34.918][ERROR][RK0][tid #139886715713280]: replica 0 preparing frequency done
[HCTR][23:17:34.966][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][23:17:34.966][ERROR][RK0][tid #139886715713280]: replica 0 calling init per replica
[HCTR][23:17:34.966][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][23:17:34.966][ERROR][RK0][tid #139886715713280]: replica 3 calling init per replica
[HCTR][23:17:34.966][ERROR][RK0][main]: Calling build_v2
[HCTR][23:17:34.966][ERROR][RK0][main]: Calling build_v2
[HCTR][23:17:34.966][ERROR][RK0][tid #139886715713280]: Calling build_v2
[HCTR][23:17:34.966][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:17:34.966][ERROR][RK0][tid #139886715713280]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:17:34.966][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:17:34.966][ERROR][RK0][tid #139886715713280]: Calling build_v2
[HCTR][23:17:34.966][ERROR][RK0][tid #139886715713280]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 23:17:34.966936: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:[136[[] 2022-12-11 23:17:34using concurrent impl MPS.2022-12-11 23:17:34
9669732022-12-11 23:17:34.: .966959E966985:  : E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE : /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:] :136using concurrent impl MPS136] 
] using concurrent impl MPSusing concurrent impl MPS

[2022-12-11 23:17:34[.2022-12-11 23:17:34968396.: 968445[E: 2022-12-11 23:17:34 [E./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 23:17:34 968473:./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 196968493:E] : 196 assigning 8 to cpuE] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
 assigning 8 to cpu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
196:] 196assigning 8 to cpu] 
assigning 8 to cpu
[2022-12-11 23:17:34.968647: [E2022-12-11 23:17:34[ .2022-12-11 23:17:34/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc968648.:: 968665212[E: ] 2022-12-11 23:17:34 Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 
968699:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 212:E[] 212 2022-12-11 23:17:34build symm link desc with 4X Tesla V100-SXM2-16GB out of 4] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4:968795
212: ] Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4[ [
2022-12-11 23:17:34/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 23:17:34.:[.9688672132022-12-11 23:17:34968875: ] .: Eremote time is 8.68421968903E 
:  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[: :2022-12-11 23:17:34213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc213.] :] 968989remote time is 8.68421213remote time is 8.68421: 
] 
Eremote time is 8.68421 [
[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 23:17:342022-12-11 23:17:34[:..2022-12-11 23:17:34214969084969081.] : : 969102cpu time is 30EE: 
  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214214:] ] 214cpu time is 30cpu time is 30] 

cpu time is 30
[2022-12-11 23:17:58.590318: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 23:17:58.664156: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 23:17:58.814966: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 23:17:58.815032: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 23:17:58.815068: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 23:17:58.815100: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 23:17:58.815954: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:17:58.816003: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:17:58.817059: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:17:58.817630: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:17:58.839733[: 2022-12-11 23:17:58E. 839761/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc: :E202 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc2 solved:
202] 1 solved[
2022-12-11 23:17:58.839833: [E2022-12-11 23:17:58 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc839844:: 205E]  worker 0 thread 2 initing device 2/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc
:205] worker 0 thread 1 initing device 1
[[2022-12-11 23:17:582022-12-11 23:17:58..840125840128: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::18151815] ] Building Coll Cache with ... num gpu device is 4Building Coll Cache with ... num gpu device is 4

[[2022-12-11 23:17:582022-12-11 23:17:58..840198840198: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 381.47 MBeager alloc mem 381.47 MB

[2022-12-11 23:17:58.840738: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 23:17:58.840800: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 23:17:58.841168: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:17:58.841214: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:17:58.841877: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:17:58.841936: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:17:58.842413: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:17:58.843391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:17:58.843446: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-11 23:17:58] .eager alloc mem 381.47 MB843475
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:17:58.911026: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 23:17:58.912933: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 23:17:58.912992: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:17:58.913855: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:17:58.914383: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:17:58.915414: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:58.915464: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.15 MB
[2022-12-11 23:17:58.935553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:17:58.936222: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:17:58.936267: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[[[2022-12-11 23:17:582022-12-11 23:17:582022-12-11 23:17:58...945139945139945141: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes


[[2022-12-11 23:17:582022-12-11 23:17:58..946943946943: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 5eager release cuda mem 5

[[[2022-12-11 23:17:582022-12-11 23:17:582022-12-11 23:17:58...947012947015947015: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:::638638638] ] ] eager release cuda mem 5eager release cuda mem 400000000eager release cuda mem 400000000


[2022-12-11 23:17:58.947103: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:17:58.947952: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:17:58.948436: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:17:58.948929: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:17:58.949520: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 23:17:58eager alloc mem 611.00 KB.
949542: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 23:17:58:.1980949563] : eager alloc mem 611.00 KBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:17:58.950464: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:58.950517[: 2022-12-11 23:17:58W. 950523/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc: :E43 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccWORKER[0] alloc host memory 38.15 MB[:
2022-12-11 23:17:58638.] 950552eager release cuda mem 625663: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:58.950597: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc[:2022-12-11 23:17:5843.] 950611WORKER[0] alloc host memory 38.15 MB: 
W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.15 MB
[2022-12-11 23:17:58.968903: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:17:58.969484: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:17:58.969527: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[[2022-12-11 23:17:582022-12-11 23:17:58..970075970076: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 25.25 KBeager alloc mem 25.25 KB

[[2022-12-11 23:17:582022-12-11 23:17:58..970670970671: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 25855eager release cuda mem 25855

[[2022-12-11 23:17:582022-12-11 23:17:58..970737970738: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 4.77 GBeager alloc mem 4.77 GB

[[[[2022-12-11 23:17:592022-12-11 23:17:592022-12-11 23:17:592022-12-11 23:17:59....408316408320408320408337: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] Device 2 init p2p of link 3] ] Device 3 init p2p of link 0
Device 1 init p2p of link 2Device 0 init p2p of link 1


[[2022-12-11 23:17:592022-12-11 23:17:59..408638408638: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[2022-12-11 23:17:59.408742: [E2022-12-11 23:17:59 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu408769:: 1980E]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:eager alloc mem 611.00 KB1980
] eager alloc mem 611.00 KB
[2022-12-11 23:17:59.409489: E[ 2022-12-11 23:17:59/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:409500638: ] Eeager release cuda mem 625663 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:59.409657: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:59.409680: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:59.416467: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 23:17:59.416575: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:17:59.416606: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 23:17:59.416715: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:17:59.416769: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 23:17:59.416863: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:17:59.417019: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 23:17:59.417243: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:17:59.417377: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:59.417522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:59.417659: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:59.418139: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:59.425638: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 23:17:59.425722: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:17:59.426125: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 23:17:59.426221: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:17:59.426245: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 23:17:59.426325: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:17:59.426403: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 23:17:59.426509: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 611.00 KB2022-12-11 23:17:59
.426531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:59.427023: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:59.427116: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:59.427314: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:17:59.432321: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:17:59.432608: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 10000000 / 100000000 nodes ( 10.00 %~10.00 %) | remote 30000000 / 100000000 nodes ( 30.00 %) | cpu 60000000 / 100000000 nodes ( 60.00 %) | 4.77 GB | 0.592419 secs 
[2022-12-11 23:17:59.433466: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:17:59.433530: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:17:59.433644: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:17:59.433764: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 10000000 / 100000000 nodes ( 10.00 %~10.00 %) | remote 30000000 / 100000000 nodes ( 30.00 %) | cpu 60000000 / 100000000 nodes ( 60.00 %) | 4.77 GB | 0.593575 secs 
[2022-12-11 23:17:59.433940: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 10000000 / 100000000 nodes ( 10.00 %~10.00 %) | remote 30000000 / 100000000 nodes ( 30.00 %) | cpu 60000000 / 100000000 nodes ( 60.00 %) | 4.77 GB | 0.592738 secs 
[2022-12-11 23:17:59.434094: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 10000000 / 100000000 nodes ( 10.00 %~10.00 %) | remote 30000000 / 100000000 nodes ( 30.00 %) | cpu 60000000 / 100000000 nodes ( 60.00 %) | 4.77 GB | 0.618101 secs 
[2022-12-11 23:17:59.434916: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.80 GB
[2022-12-11 23:18:00.765809: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.05 GB
[2022-12-11 23:18:00.765954: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.05 GB
[2022-12-11 23:18:00.766308: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.05 GB
[2022-12-11 23:18:01.471398: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.29 GB
[2022-12-11 23:18:01.471536: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.29 GB
[2022-12-11 23:18:01.471956: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.29 GB
[2022-12-11 23:18:02.192907: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.54 GB
[2022-12-11 23:18:02.193138: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.54 GB
[2022-12-11 23:18:02.194855: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.54 GB
[2022-12-11 23:18:02.928450: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.95 GB
[2022-12-11 23:18:02.928854: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.95 GB
[2022-12-11 23:18:02.929155: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.95 GB
[2022-12-11 23:18:03.768776: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.14 GB
[2022-12-11 23:18:03.768918: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.14 GB
[HCTR][23:18:03.769][ERROR][RK0][tid #139886715713280]: replica 0 calling init per replica done, doing barrier
[HCTR][23:18:03.769][ERROR][RK0][tid #139886715713280]: replica 3 calling init per replica done, doing barrier
[HCTR][23:18:03.769][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][23:18:03.769][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][23:18:03.769][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][23:18:03.769][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][23:18:03.769][ERROR][RK0][tid #139886715713280]: replica 3 calling init per replica done, doing barrier done
[HCTR][23:18:03.769][ERROR][RK0][tid #139886715713280]: replica 0 calling init per replica done, doing barrier done
[HCTR][23:18:03.769][ERROR][RK0][tid #139886715713280]: init per replica done
[HCTR][23:18:03.769][ERROR][RK0][main]: init per replica done
[HCTR][23:18:03.769][ERROR][RK0][main]: init per replica done
[HCTR][23:18:03.772][ERROR][RK0][tid #139886715713280]: init per replica done
[HCTR][23:18:03.776][ERROR][RK0][tid #139886715713280]: 3 allocated 3276800 at 0x7f27c7720000
[HCTR][23:18:03.776][ERROR][RK0][tid #139886715713280]: 3 allocated 6553600 at 0x7f27ca800000
[HCTR][23:18:03.776][ERROR][RK0][tid #139886715713280]: 3 allocated 3276800 at 0x7f27cae40000
[HCTR][23:18:03.776][ERROR][RK0][tid #139886715713280]: 3 allocated 6553600 at 0x7f27cb160000
[HCTR][23:18:03.777][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f27c7720000
[HCTR][23:18:03.777][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f27ca800000
[HCTR][23:18:03.777][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f27cae40000
[HCTR][23:18:03.777][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f27cb160000
[HCTR][23:18:03.779][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f3b5d120000
[HCTR][23:18:03.779][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f3b5d600000
[HCTR][23:18:03.779][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f229250e800
[HCTR][23:18:03.779][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f229282e800
[HCTR][23:18:03.780][ERROR][RK0][tid #139886715713280]: 2 allocated 3276800 at 0x7f27c7720000
[HCTR][23:18:03.781][ERROR][RK0][tid #139886715713280]: 2 allocated 6553600 at 0x7f27ca800000
[HCTR][23:18:03.781][ERROR][RK0][tid #139886715713280]: 2 allocated 3276800 at 0x7f27cae40000
[HCTR][23:18:03.781][ERROR][RK0][tid #139886715713280]: 2 allocated 6553600 at 0x7f27cb160000




