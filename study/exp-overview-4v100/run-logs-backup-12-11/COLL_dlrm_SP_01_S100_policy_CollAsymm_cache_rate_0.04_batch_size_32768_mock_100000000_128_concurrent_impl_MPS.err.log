2022-12-11 20:59:11.186405: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:59:11.193817: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:59:11.263438: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:59:11.264371: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:59:12.066708: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:59:12.066797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 20:59:12.082990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 20:59:12.084007: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:59:12.084069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 20:59:12.099559: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:59:12.099636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 20:59:12.100184: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:59:12.100304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 20:59:12.100719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 20:59:12.113389: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:59:12.113523: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:59:12.113933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 20:59:12.115020: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 20:59:12.115058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 20:59:12.131025: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:59:12.131173: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:59:12.133293: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 20:59:12.147530: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:59:12.147716: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:59:12.149304: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 20:59:12.149525: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:59:12.149632: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:59:12.151328: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][20:59:13.378][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:59:13.387][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:59:13.420][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:59:13.434][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:00,  1.60it/s]warmup run: 0it [00:00, ?it/s]warmup run: 70it [00:00, 129.37it/s]warmup run: 126it [00:00, 219.24it/s]warmup run: 214it [00:00, 368.73it/s]warmup run: 291it [00:01, 466.81it/s]warmup run: 360it [00:01, 524.71it/s]warmup run: 453it [00:01, 632.76it/s]warmup run: 550it [00:01, 726.13it/s]warmup run: 650it [00:01, 803.80it/s]warmup run: 751it [00:01, 861.07it/s]warmup run: 852it [00:01, 902.04it/s]warmup run: 1it [00:01,  1.57s/it]warmup run: 947it [00:01, 905.24it/s]warmup run: 107it [00:01, 89.10it/s]warmup run: 1046it [00:01, 928.35it/s]warmup run: 216it [00:01, 195.70it/s]warmup run: 1141it [00:01, 933.23it/s]warmup run: 317it [00:01, 303.02it/s]warmup run: 1242it [00:02, 953.61it/s]warmup run: 416it [00:01, 411.96it/s]warmup run: 1341it [00:02, 961.74it/s]warmup run: 513it [00:02, 514.58it/s]warmup run: 1it [00:01,  1.54s/it]warmup run: 1443it [00:02, 978.19it/s]warmup run: 612it [00:02, 612.90it/s]warmup run: 102it [00:01, 86.15it/s]warmup run: 1546it [00:02, 993.13it/s]warmup run: 172it [00:01, 152.33it/s]warmup run: 708it [00:02, 581.01it/s]warmup run: 250it [00:01, 235.88it/s]warmup run: 1646it [00:02, 757.24it/s]warmup run: 792it [00:02, 636.48it/s]warmup run: 349it [00:01, 356.34it/s]warmup run: 1756it [00:02, 840.56it/s]warmup run: 893it [00:02, 722.74it/s]warmup run: 458it [00:02, 492.30it/s]warmup run: 1869it [00:02, 914.88it/s]warmup run: 994it [00:02, 793.20it/s]warmup run: 571it [00:02, 625.16it/s]warmup run: 1982it [00:02, 970.64it/s]warmup run: 1090it [00:02, 836.27it/s]warmup run: 679it [00:02, 729.77it/s]warmup run: 2112it [00:02, 1061.19it/s]warmup run: 1185it [00:02, 866.75it/s]warmup run: 785it [00:02, 811.44it/s]warmup run: 2246it [00:03, 1139.67it/s]warmup run: 1283it [00:02, 896.86it/s]warmup run: 900it [00:02, 898.02it/s]warmup run: 2382it [00:03, 1202.11it/s]warmup run: 1378it [00:03, 905.60it/s]warmup run: 1006it [00:02, 926.95it/s]warmup run: 2520it [00:03, 1253.60it/s]warmup run: 1478it [00:03, 930.12it/s]warmup run: 2657it [00:03, 1287.18it/s]warmup run: 1111it [00:02, 924.85it/s]warmup run: 1578it [00:03, 948.37it/s]warmup run: 2795it [00:03, 1314.58it/s]warmup run: 1218it [00:02, 964.53it/s]warmup run: 1677it [00:03, 959.67it/s]warmup run: 2934it [00:03, 1334.06it/s]warmup run: 1322it [00:02, 985.00it/s]warmup run: 1775it [00:03, 964.79it/s]warmup run: 3000it [00:03, 831.57it/s] warmup run: 1426it [00:02, 1000.60it/s]warmup run: 1876it [00:03, 975.78it/s]warmup run: 1534it [00:03, 1023.63it/s]warmup run: 1979it [00:03, 990.27it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1639it [00:03, 1024.84it/s]warmup run: 2101it [00:03, 1057.62it/s]warmup run: 1744it [00:03, 1031.87it/s]warmup run: 2240it [00:03, 1154.96it/s]warmup run: 1852it [00:03, 1043.65it/s]warmup run: 2379it [00:03, 1224.35it/s]warmup run: 1958it [00:03, 1040.01it/s]warmup run: 2518it [00:04, 1273.49it/s]warmup run: 2071it [00:03, 1066.61it/s]warmup run: 2658it [00:04, 1308.67it/s]warmup run: 2200it [00:03, 1132.71it/s]warmup run: 2796it [00:04, 1329.48it/s]warmup run: 2330it [00:03, 1181.72it/s]warmup run: 2936it [00:04, 1349.05it/s]warmup run: 3000it [00:04, 679.10it/s] warmup run: 2460it [00:03, 1215.90it/s]warmup run: 2590it [00:03, 1240.58it/s]warmup run: 2719it [00:04, 1254.38it/s]warmup run: 2851it [00:04, 1271.52it/s]warmup run: 2981it [00:04, 1278.61it/s]warmup run: 3000it [00:04, 698.20it/s] warmup run: 1it [00:01,  1.44s/it]warmup run: 106it [00:01, 95.41it/s]warmup run: 212it [00:01, 205.44it/s]warmup run: 311it [00:01, 315.31it/s]warmup run: 417it [00:01, 439.24it/s]warmup run: 524it [00:01, 559.70it/s]warmup run: 632it [00:02, 670.68it/s]warmup run: 739it [00:02, 764.30it/s]warmup run: 847it [00:02, 841.69it/s]warmup run: 953it [00:02, 898.22it/s]warmup run: 1060it [00:02, 943.30it/s]warmup run: 1166it [00:02, 973.30it/s]warmup run: 1273it [00:02, 999.50it/s]warmup run: 1379it [00:02, 1000.46it/s]warmup run: 1487it [00:02, 1023.17it/s]warmup run: 1594it [00:02, 1035.63it/s]warmup run: 1702it [00:03, 1047.95it/s]warmup run: 1811it [00:03, 1058.90it/s]warmup run: 1919it [00:03, 1064.48it/s]warmup run: 2034it [00:03, 1088.04it/s]warmup run: 2170it [00:03, 1168.22it/s]warmup run: 2306it [00:03, 1225.09it/s]warmup run: 2442it [00:03, 1264.87it/s]warmup run: 2578it [00:03, 1292.17it/s]warmup run: 2713it [00:03, 1307.30it/s]warmup run: 2849it [00:03, 1321.74it/s]warmup run: 2984it [00:04, 1328.41it/s]warmup run: 3000it [00:04, 736.24it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1658.92it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1617.93it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1754.71it/s]warmup should be done:   5%|▌         | 154/3000 [00:00<00:01, 1538.47it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1717.76it/s]warmup should be done:  11%|█         | 330/3000 [00:00<00:01, 1653.01it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1760.35it/s]warmup should be done:  11%|█         | 325/3000 [00:00<00:01, 1638.94it/s]warmup should be done:  17%|█▋        | 521/3000 [00:00<00:01, 1746.51it/s]warmup should be done:  17%|█▋        | 496/3000 [00:00<00:01, 1652.08it/s]warmup should be done:  18%|█▊        | 530/3000 [00:00<00:01, 1739.19it/s]warmup should be done:  16%|█▋        | 494/3000 [00:00<00:01, 1660.57it/s]warmup should be done:  23%|██▎       | 700/3000 [00:00<00:01, 1761.84it/s]warmup should be done:  22%|██▏       | 663/3000 [00:00<00:01, 1655.99it/s]warmup should be done:  22%|██▏       | 665/3000 [00:00<00:01, 1678.36it/s]warmup should be done:  23%|██▎       | 704/3000 [00:00<00:01, 1732.50it/s]warmup should be done:  29%|██▉       | 880/3000 [00:00<00:01, 1772.38it/s]warmup should be done:  28%|██▊       | 835/3000 [00:00<00:01, 1675.55it/s]warmup should be done:  29%|██▉       | 880/3000 [00:00<00:01, 1741.87it/s]warmup should be done:  28%|██▊       | 837/3000 [00:00<00:01, 1690.39it/s]warmup should be done:  35%|███▌      | 1059/3000 [00:00<00:01, 1775.18it/s]warmup should be done:  34%|███▎      | 1007/3000 [00:00<00:01, 1689.01it/s]warmup should be done:  34%|███▎      | 1009/3000 [00:00<00:01, 1699.83it/s]warmup should be done:  35%|███▌      | 1055/3000 [00:00<00:01, 1716.64it/s]warmup should be done:  39%|███▉      | 1180/3000 [00:00<00:01, 1699.29it/s]warmup should be done:  41%|████      | 1237/3000 [00:00<00:00, 1767.39it/s]warmup should be done:  39%|███▉      | 1179/3000 [00:00<00:01, 1685.83it/s]warmup should be done:  41%|████      | 1230/3000 [00:00<00:01, 1725.89it/s]warmup should be done:  45%|████▌     | 1352/3000 [00:00<00:00, 1705.25it/s]warmup should be done:  47%|████▋     | 1416/3000 [00:00<00:00, 1774.10it/s]warmup should be done:  45%|████▌     | 1355/3000 [00:00<00:00, 1708.98it/s]warmup should be done:  47%|████▋     | 1404/3000 [00:00<00:00, 1728.69it/s]warmup should be done:  51%|█████     | 1525/3000 [00:00<00:00, 1710.06it/s]warmup should be done:  53%|█████▎    | 1597/3000 [00:00<00:00, 1782.90it/s]warmup should be done:  51%|█████     | 1534/3000 [00:00<00:00, 1732.83it/s]warmup should be done:  53%|█████▎    | 1579/3000 [00:00<00:00, 1734.77it/s]warmup should be done:  59%|█████▉    | 1776/3000 [00:01<00:00, 1784.66it/s]warmup should be done:  57%|█████▋    | 1697/3000 [00:01<00:00, 1687.13it/s]warmup should be done:  57%|█████▋    | 1714/3000 [00:01<00:00, 1750.63it/s]warmup should be done:  58%|█████▊    | 1753/3000 [00:01<00:00, 1728.10it/s]warmup should be done:  65%|██████▌   | 1955/3000 [00:01<00:00, 1780.64it/s]warmup should be done:  62%|██████▏   | 1871/3000 [00:01<00:00, 1701.36it/s]warmup should be done:  63%|██████▎   | 1893/3000 [00:01<00:00, 1762.41it/s]warmup should be done:  64%|██████▍   | 1929/3000 [00:01<00:00, 1736.71it/s]warmup should be done:  71%|███████   | 2136/3000 [00:01<00:00, 1788.69it/s]warmup should be done:  69%|██████▉   | 2072/3000 [00:01<00:00, 1770.39it/s]warmup should be done:  68%|██████▊   | 2047/3000 [00:01<00:00, 1716.66it/s]warmup should be done:  70%|███████   | 2106/3000 [00:01<00:00, 1744.12it/s]warmup should be done:  77%|███████▋  | 2315/3000 [00:01<00:00, 1784.82it/s]warmup should be done:  75%|███████▌  | 2251/3000 [00:01<00:00, 1773.84it/s]warmup should be done:  74%|███████▍  | 2222/3000 [00:01<00:00, 1725.90it/s]warmup should be done:  76%|███████▌  | 2282/3000 [00:01<00:00, 1747.28it/s]warmup should be done:  83%|████████▎ | 2497/3000 [00:01<00:00, 1793.48it/s]warmup should be done:  81%|████████  | 2431/3000 [00:01<00:00, 1780.08it/s]warmup should be done:  80%|███████▉  | 2399/3000 [00:01<00:00, 1736.53it/s]warmup should be done:  82%|████████▏ | 2460/3000 [00:01<00:00, 1756.45it/s]warmup should be done:  89%|████████▉ | 2677/3000 [00:01<00:00, 1789.75it/s]warmup should be done:  87%|████████▋ | 2611/3000 [00:01<00:00, 1785.15it/s]warmup should be done:  86%|████████▌ | 2575/3000 [00:01<00:00, 1742.55it/s]warmup should be done:  88%|████████▊ | 2638/3000 [00:01<00:00, 1763.11it/s]warmup should be done:  95%|█████████▌| 2857/3000 [00:01<00:00, 1791.51it/s]warmup should be done:  92%|█████████▏| 2752/3000 [00:01<00:00, 1750.29it/s]warmup should be done:  93%|█████████▎| 2792/3000 [00:01<00:00, 1790.25it/s]warmup should be done:  94%|█████████▍| 2815/3000 [00:01<00:00, 1759.49it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1775.98it/s]warmup should be done:  99%|█████████▉| 2973/3000 [00:01<00:00, 1795.05it/s]warmup should be done:  98%|█████████▊| 2929/3000 [00:01<00:00, 1754.04it/s]warmup should be done: 100%|█████████▉| 2991/3000 [00:01<00:00, 1755.60it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1743.73it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1742.41it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1712.97it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1808.12it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1794.49it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1794.33it/s]warmup should be done:   5%|▌         | 154/3000 [00:00<00:01, 1531.23it/s]warmup should be done:  12%|█▏        | 363/3000 [00:00<00:01, 1810.02it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1831.26it/s]warmup should be done:  12%|█▏        | 361/3000 [00:00<00:01, 1797.86it/s]warmup should be done:  11%|█         | 321/3000 [00:00<00:01, 1607.88it/s]warmup should be done:  18%|█▊        | 548/3000 [00:00<00:01, 1828.18it/s]warmup should be done:  18%|█▊        | 553/3000 [00:00<00:01, 1848.68it/s]warmup should be done:  18%|█▊        | 542/3000 [00:00<00:01, 1802.09it/s]warmup should be done:  16%|█▌        | 486/3000 [00:00<00:01, 1626.36it/s]warmup should be done:  25%|██▍       | 740/3000 [00:00<00:01, 1856.49it/s]warmup should be done:  24%|██▍       | 734/3000 [00:00<00:01, 1836.99it/s]warmup should be done:  22%|██▏       | 656/3000 [00:00<00:01, 1653.88it/s]warmup should be done:  24%|██▍       | 723/3000 [00:00<00:01, 1796.03it/s]warmup should be done:  31%|███       | 920/3000 [00:00<00:01, 1843.44it/s]warmup should be done:  28%|██▊       | 829/3000 [00:00<00:01, 1678.11it/s]warmup should be done:  31%|███       | 926/3000 [00:00<00:01, 1833.61it/s]warmup should be done:  30%|███       | 903/3000 [00:00<00:01, 1782.33it/s]warmup should be done:  37%|███▋      | 1106/3000 [00:00<00:01, 1847.89it/s]warmup should be done:  34%|███▍      | 1014/3000 [00:00<00:01, 1735.62it/s]warmup should be done:  36%|███▌      | 1085/3000 [00:00<00:01, 1793.87it/s]warmup should be done:  37%|███▋      | 1110/3000 [00:00<00:01, 1832.95it/s]warmup should be done:  43%|████▎     | 1291/3000 [00:00<00:00, 1847.00it/s]warmup should be done:  40%|███▉      | 1192/3000 [00:00<00:01, 1749.27it/s]warmup should be done:  42%|████▏     | 1267/3000 [00:00<00:00, 1801.05it/s]warmup should be done:  43%|████▎     | 1294/3000 [00:00<00:00, 1750.74it/s]warmup should be done:  49%|████▉     | 1477/3000 [00:00<00:00, 1849.90it/s]warmup should be done:  46%|████▌     | 1367/3000 [00:00<00:00, 1747.55it/s]warmup should be done:  48%|████▊     | 1451/3000 [00:00<00:00, 1810.25it/s]warmup should be done:  49%|████▉     | 1476/3000 [00:00<00:00, 1770.57it/s]warmup should be done:  55%|█████▌    | 1663/3000 [00:00<00:00, 1851.88it/s]warmup should be done:  52%|█████▏    | 1551/3000 [00:00<00:00, 1774.37it/s]warmup should be done:  54%|█████▍    | 1634/3000 [00:00<00:00, 1815.99it/s]warmup should be done:  55%|█████▌    | 1657/3000 [00:00<00:00, 1779.86it/s]warmup should be done:  61%|██████    | 1816/3000 [00:01<00:00, 1815.59it/s]warmup should be done:  58%|█████▊    | 1729/3000 [00:01<00:00, 1754.60it/s]warmup should be done:  62%|██████▏   | 1849/3000 [00:01<00:00, 1819.44it/s]warmup should be done:  61%|██████▏   | 1840/3000 [00:01<00:00, 1794.19it/s]warmup should be done:  67%|██████▋   | 1998/3000 [00:01<00:00, 1816.46it/s]warmup should be done:  68%|██████▊   | 2032/3000 [00:01<00:00, 1820.34it/s]warmup should be done:  64%|██████▎   | 1905/3000 [00:01<00:00, 1717.26it/s]warmup should be done:  67%|██████▋   | 2022/3000 [00:01<00:00, 1801.39it/s]warmup should be done:  73%|███████▎  | 2180/3000 [00:01<00:00, 1816.72it/s]warmup should be done:  69%|██████▉   | 2084/3000 [00:01<00:00, 1736.63it/s]warmup should be done:  74%|███████▎  | 2205/3000 [00:01<00:00, 1808.62it/s]warmup should be done:  74%|███████▍  | 2215/3000 [00:01<00:00, 1744.47it/s]warmup should be done:  79%|███████▉  | 2363/3000 [00:01<00:00, 1818.54it/s]warmup should be done:  75%|███████▌  | 2258/3000 [00:01<00:00, 1730.21it/s]warmup should be done:  80%|███████▉  | 2387/3000 [00:01<00:00, 1800.03it/s]warmup should be done:  80%|███████▉  | 2397/3000 [00:01<00:00, 1764.84it/s]warmup should be done:  85%|████████▍ | 2546/3000 [00:01<00:00, 1820.02it/s]warmup should be done:  81%|████████  | 2436/3000 [00:01<00:00, 1744.87it/s]warmup should be done:  86%|████████▌ | 2579/3000 [00:01<00:00, 1780.50it/s]warmup should be done:  86%|████████▌ | 2568/3000 [00:01<00:00, 1777.53it/s]warmup should be done:  91%|█████████ | 2729/3000 [00:01<00:00, 1821.18it/s]warmup should be done:  87%|████████▋ | 2615/3000 [00:01<00:00, 1756.12it/s]warmup should be done:  92%|█████████▏| 2761/3000 [00:01<00:00, 1789.48it/s]warmup should be done:  92%|█████████▏| 2750/3000 [00:01<00:00, 1788.69it/s]warmup should be done:  97%|█████████▋| 2912/3000 [00:01<00:00, 1819.95it/s]warmup should be done:  93%|█████████▎| 2792/3000 [00:01<00:00, 1759.49it/s]warmup should be done:  98%|█████████▊| 2944/3000 [00:01<00:00, 1799.70it/s]warmup should be done:  98%|█████████▊| 2931/3000 [00:01<00:00, 1792.55it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1811.24it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1810.95it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1798.62it/s]warmup should be done:  99%|█████████▉| 2972/3000 [00:01<00:00, 1769.30it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1730.78it/s]2022-12-11 21:00:29.966832: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0f1a26b620 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:00:29.966896: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:00:30.903671: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0f22a65f60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:00:30.903733: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:00:31.573871: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:00:32.759464: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:00:33.056800: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0f22a69390 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:00:33.056861: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:00:34.291953: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:00:35.224075: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0f1a268280 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:00:35.224139: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:00:35.239765: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:00:36.272521: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:00:37.179044: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:00:37.229888: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:00:37.842343: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:00:39.068443: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:00:39.114578: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:00:39.156446: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:00:41.148537: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][21:01:14.028][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][21:01:14.028][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:01:14.033][ERROR][RK0][main]: coll ps creation done
[HCTR][21:01:14.033][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][21:01:14.236][ERROR][RK0][tid #139703072323328]: replica 2 reaches 1000, calling init pre replica
[HCTR][21:01:14.237][ERROR][RK0][tid #139703072323328]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:01:14.240][ERROR][RK0][tid #139703072323328]: coll ps creation done
[HCTR][21:01:14.240][ERROR][RK0][tid #139703072323328]: replica 2 waits for coll ps creation barrier
[HCTR][21:01:14.300][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][21:01:14.300][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:01:14.304][ERROR][RK0][main]: coll ps creation done
[HCTR][21:01:14.304][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][21:01:14.677][ERROR][RK0][tid #139703072323328]: replica 1 reaches 1000, calling init pre replica
[HCTR][21:01:14.677][ERROR][RK0][tid #139703072323328]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:01:14.680][ERROR][RK0][tid #139703072323328]: coll ps creation done
[HCTR][21:01:14.680][ERROR][RK0][tid #139703072323328]: replica 1 waits for coll ps creation barrier
[HCTR][21:01:14.681][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][21:01:15.598][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][21:01:15.627][ERROR][RK0][tid #139703072323328]: replica 1 calling init per replica
[HCTR][21:01:15.627][ERROR][RK0][tid #139703072323328]: replica 2 calling init per replica
[HCTR][21:01:15.627][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][21:01:15.627][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][21:01:15.627][ERROR][RK0][tid #139703072323328]: Calling build_v2
[HCTR][21:01:15.627][ERROR][RK0][tid #139703072323328]: Calling build_v2
[HCTR][21:01:15.627][ERROR][RK0][main]: Calling build_v2
[HCTR][21:01:15.627][ERROR][RK0][main]: Calling build_v2
[HCTR][21:01:15.627][ERROR][RK0][tid #139703072323328]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:01:15.627][ERROR][RK0][tid #139703072323328]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:01:15.627][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:01:15.627][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[2022-12-11 21:01:15[2022-12-11 21:01:15.[.6277472022-12-11 21:01:156277522022-12-11 21:01:15: .: .E627748E627761 :  : /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE: : 136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] :] :using concurrent impl MPS136using concurrent impl MPS136
] 
] using concurrent impl MPSusing concurrent impl MPS

[2022-12-11 21:01:15.629152: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196[] 2022-12-11 21:01:15assigning 8 to cpu.
629176: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 21:01:15[.2022-12-11 21:01:15629206[.: 2022-12-11 21:01:15629209[E.: 2022-12-11 21:01:15 629226E./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:  629240:E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 196 :E] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc212 assigning 8 to cpu:] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
212build symm link desc with 4X Tesla V100-SXM2-16GB out of 4:] 
196build symm link desc with 4X Tesla V100-SXM2-16GB out of 4] 
assigning 8 to cpu[
2022-12-11 21:01:15[.2022-12-11 21:01:15629392.: [629405E2022-12-11 21:01:15:  .E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc629413 [:: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 21:01:15213E:.]  213629438remote time is 8.68421/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] : 
:remote time is 8.68421E212[
 ] 2022-12-11 21:01:15/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[build symm link desc with 4X Tesla V100-SXM2-16GB out of 4.:2022-12-11 21:01:15
629551212.: ] 629574[Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 2022-12-11 21:01:15 
E./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 629620:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[: 214:2022-12-11 21:01:15E] 214. cpu time is 30] 629685/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
cpu time is 30: :
E213 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421:
213] remote time is 8.68421[
2022-12-11 21:01:15.629788: E[ 2022-12-11 21:01:15/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:629802214: ] Ecpu time is 30 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 21:01:41. 25241: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 21:01:41. 80621: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 21:01:41. 80728: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 21:01:41. 81816: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 21:01:41.176893: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 21:01:41.538620: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 21:01:41.538716: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 21:01:48.350391: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 21:01:48.350604: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 21:01:50.115961: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 21:01:50.116172: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 21:01:50.120362: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 21:01:50.120443: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 21:01:51.223938: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 21:01:51.241581: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 21:01:51.243325: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 21:01:51.253953: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 21:01:51.347630: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 21:01:53.469872: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 21:01:53.473721: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 21:01:53.473849: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 21:01:53.483912: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 21:01:53.483990: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 21:01:53.484025: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 21:01:53.484067: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 21:01:53.485070: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:01:53.485117: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:01:53.486046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:01:53.486626: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:01:53.507722: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 21:01:53.507813: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[[2022-12-11 21:01:53.509322: 2022-12-11 21:01:53E. 509320/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc: :E202 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:2 solved202
] 1 solved
[2022-12-11 21:01:53.509419[: 2022-12-11 21:01:53E. 509427/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc: :E205 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccworker 0 thread 2 initing device 2:
205] worker 0 thread 1 initing device 1
[2022-12-11 21:01:53.510100: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:01:53.510155: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:01:53.510355: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:01:53.510406: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:01:53.511563: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:01:53.511625: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:01:53.511647: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:01:53.511742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:01:53.514348: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:01:53.514417: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:01:53.514470: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:01:53.516946: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:01:53.580603: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 21:01:53.582519: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:01:53.582575: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:01:53.583475: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:01:53.584098: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:01:53.585020: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:01:53.585065: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.25 MB
[2022-12-11 21:01:53.589399: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:01:53.590147: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:01:53.590192: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[[2022-12-11 21:01:532022-12-11 21:01:532022-12-11 21:01:53...617300617297617297: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes


[2022-12-11 21:01:53.619168: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 21:01:53:.638619182] : eager release cuda mem 1021E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:01:53.619234: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 21:01:53:.638619246] : eager release cuda mem 400000000E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 21:01:53eager release cuda mem 400000000.
619275: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:01:53.619331: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:01:53.620134: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:01:53.620620: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:01:53.621115: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:01:53.621653: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:01:53.621753: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:01:53.621785: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:01:53.622572: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:01:53.622617: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.23 MB
[2022-12-11 21:01:53.622671: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:01:53.[6227042022-12-11 21:01:53: .E622713 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccW: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc] :eager release cuda mem 62566343
] WORKER[0] alloc host memory 15.23 MB
[2022-12-11 21:01:53.622768: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.20 MB
[2022-12-11 21:01:53.630415: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:01:53.631102: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:01:53.631146: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[2022-12-11 21:01:53.632834: E[ 2022-12-11 21:01:53/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:6328531980: ] Eeager alloc mem 25.25 KB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:01:53.633433: [E2022-12-11 21:01:53 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc633444:: 638E]  eager release cuda mem 25855/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 25855[
2022-12-11 21:01:53.633493: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 21:01:53eager alloc mem 1.91 GB.
633515: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[[[2022-12-11 21:01:532022-12-11 21:01:532022-12-11 21:01:532022-12-11 21:01:53....804798804797804793804793: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 1 init p2p of link 2Device 2 init p2p of link 3Device 3 init p2p of link 0Device 0 init p2p of link 1



[2022-12-11 21:01:53.805031[: 2022-12-11 21:01:53E[. [2022-12-11 21:01:53805037/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 21:01:53.: :.805045E1980805049:  ] : E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KBE :
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:] :1980eager alloc mem 611.00 KB1980] 
] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[[2022-12-11 21:01:532022-12-11 21:01:53..805866805868: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::[638638[2022-12-11 21:01:53] ] 2022-12-11 21:01:53.eager release cuda mem 625663eager release cuda mem 625663.805900

805906: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 625663
eager release cuda mem 625663
[2022-12-11 21:01:53.808918: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 21:01:53[.2022-12-11 21:01:53808998.: 809010E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1926:] 1980Device 2 init p2p of link 0] 
eager alloc mem 611.00 KB
[2022-12-11 21:01:53.809106: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:01:53.809161: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 21:01:53.809240[: 2022-12-11 21:01:53E. 809256/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1926 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuDevice 0 init p2p of link 2:
1980] eager alloc mem 611.00 KB
[2022-12-11 21:01:53.809350: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:01:53.809813: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:01:53.809890: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:01:53.810069: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:01:53.810104: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:01:53.812601: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 21:01:53.812681: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:01:53.813078: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 21:01:53.813137: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] [Device 0 init p2p of link 32022-12-11 21:01:53
.813167: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:01:53.813223: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:01:53.813319: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 21:01:53.813405: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:01:53.813470: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:01:53.813966: [E2022-12-11 21:01:53 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc813976:: 638E]  eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-11 21:01:53.814188: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:01:53.815569: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:01:53.816167: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3993255 / 100000000 nodes ( 3.99 %~4.00 %) | remote 11976616 / 100000000 nodes ( 11.98 %) | cpu 84030129 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.306032 secs 
[2022-12-11 21:01:53.816686: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:01:53.816899: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:01:53.816958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:01:53.817291: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3998699 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11971172 / 100000000 nodes ( 11.97 %) | cpu 84030129 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.332181 secs 
[2022-12-11 21:01:53.817555: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3985161 / 100000000 nodes ( 3.99 %~4.00 %) | remote 11984710 / 100000000 nodes ( 11.98 %) | cpu 84030129 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.305944 secs 
[2022-12-11 21:01:53.817621: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3993321 / 100000000 nodes ( 3.99 %~4.00 %) | remote 11976550 / 100000000 nodes ( 11.98 %) | cpu 84030129 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.30723 secs 
[2022-12-11 21:01:53.818171: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 6.94 GB
[2022-12-11 21:01:54.783136: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.19 GB
[2022-12-11 21:01:54.783309: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.19 GB
[2022-12-11 21:01:54.783650: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.19 GB
[2022-12-11 21:01:55.763826: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.43 GB
[2022-12-11 21:01:55.764033: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.43 GB
[2022-12-11 21:01:55.764814: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.43 GB
[2022-12-11 21:01:56.357544: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.68 GB
[2022-12-11 21:01:56.357659: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.68 GB
[2022-12-11 21:01:56.357958: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.68 GB
[2022-12-11 21:01:57.136431: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.09 GB
[2022-12-11 21:01:57.136571: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.09 GB
[2022-12-11 21:01:57.137505: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.09 GB
[2022-12-11 21:01:57.904907: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.28 GB
[2022-12-11 21:01:57.905026: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.28 GB
[HCTR][21:01:58.060][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][21:01:58.060][ERROR][RK0][tid #139703072323328]: replica 2 calling init per replica done, doing barrier
[HCTR][21:01:58.060][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][21:01:58.060][ERROR][RK0][tid #139703072323328]: replica 1 calling init per replica done, doing barrier
[HCTR][21:01:58.060][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][21:01:58.060][ERROR][RK0][tid #139703072323328]: replica 2 calling init per replica done, doing barrier done
[HCTR][21:01:58.060][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][21:01:58.060][ERROR][RK0][tid #139703072323328]: replica 1 calling init per replica done, doing barrier done
[HCTR][21:01:58.060][ERROR][RK0][tid #139703072323328]: init per replica done
[HCTR][21:01:58.060][ERROR][RK0][main]: init per replica done
[HCTR][21:01:58.060][ERROR][RK0][tid #139703072323328]: init per replica done
[HCTR][21:01:58.063][ERROR][RK0][main]: init per replica done
[HCTR][21:01:58.068][ERROR][RK0][main]: 3 allocated 3276800 at 0x7efd1b720000
[HCTR][21:01:58.068][ERROR][RK0][main]: 3 allocated 6553600 at 0x7ef8c2000000
[HCTR][21:01:58.068][ERROR][RK0][main]: 3 allocated 3276800 at 0x7ef8c2640000
[HCTR][21:01:58.068][ERROR][RK0][main]: 3 allocated 6553600 at 0x7ef8c2960000
[HCTR][21:01:58.068][ERROR][RK0][main]: 2 allocated 3276800 at 0x7efd17720000
[HCTR][21:01:58.068][ERROR][RK0][main]: 2 allocated 6553600 at 0x7ef79e000000
[HCTR][21:01:58.068][ERROR][RK0][main]: 2 allocated 3276800 at 0x7ef79e640000
[HCTR][21:01:58.068][ERROR][RK0][main]: 2 allocated 6553600 at 0x7ef79e960000
[HCTR][21:01:58.070][ERROR][RK0][tid #139703072323328]: 1 allocated 3276800 at 0x7efd17720000
[HCTR][21:01:58.070][ERROR][RK0][tid #139703072323328]: 1 allocated 6553600 at 0x7ef8c2000000
[HCTR][21:01:58.070][ERROR][RK0][tid #139703072323328]: 1 allocated 3276800 at 0x7ef8c2640000
[HCTR][21:01:58.070][ERROR][RK0][tid #139703072323328]: 1 allocated 6553600 at 0x7ef8c2960000
[HCTR][21:01:58.073][ERROR][RK0][tid #139703072323328]: 0 allocated 3276800 at 0x7ef89e320000
[HCTR][21:01:58.074][ERROR][RK0][tid #139703072323328]: 0 allocated 6553600 at 0x7efb2d600000
[HCTR][21:01:58.074][ERROR][RK0][tid #139703072323328]: 0 allocated 3276800 at 0x7ef89ed0e800
[HCTR][21:01:58.074][ERROR][RK0][tid #139703072323328]: 0 allocated 6553600 at 0x7ef89f02e800




