2022-12-12 02:44:25.001245: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:44:25.089635: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:44:25.090813: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:44:25.093140: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:44:25.920278: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:44:25.920354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:44:25.933474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:44:25.967064: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:44:25.967235: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:44:25.969183: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 02:44:25.987772: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:44:25.987849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:44:25.999872: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:44:25.999949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:44:26.004796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:44:26.015305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:44:26.035967: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:44:26.036139: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:44:26.038030: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 02:44:26.047177: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:44:26.047339: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:44:26.048829: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 02:44:26.050951: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:44:26.051014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:44:26.063536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:44:26.093032: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:44:26.093204: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:44:26.094557: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][02:44:27.304][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:44:27.311][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:44:27.351][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:44:27.367][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 104it [00:01, 93.23it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 203it [00:01, 195.28it/s]warmup run: 104it [00:01, 93.88it/s]warmup run: 309it [00:01, 316.11it/s]warmup run: 202it [00:01, 195.14it/s]warmup run: 416it [00:01, 441.10it/s]warmup run: 302it [00:01, 307.82it/s]warmup run: 512it [00:01, 533.97it/s]warmup run: 394it [00:01, 409.54it/s]warmup run: 0it [00:00, ?it/s]warmup run: 622it [00:02, 653.93it/s]warmup run: 490it [00:01, 515.30it/s]warmup run: 724it [00:02, 738.86it/s]warmup run: 598it [00:02, 636.81it/s]warmup run: 1it [00:01,  1.46s/it]warmup run: 836it [00:02, 833.62it/s]warmup run: 698it [00:02, 719.22it/s]warmup run: 117it [00:01, 104.24it/s]warmup run: 947it [00:02, 905.93it/s]warmup run: 803it [00:02, 801.81it/s]warmup run: 229it [00:01, 219.08it/s]warmup run: 1055it [00:02, 953.27it/s]warmup run: 910it [00:02, 870.67it/s]warmup run: 337it [00:01, 338.56it/s]warmup run: 1164it [00:02, 990.41it/s]warmup run: 1013it [00:02, 910.74it/s]warmup run: 447it [00:01, 464.23it/s]warmup run: 1274it [00:02, 1020.76it/s]warmup run: 548it [00:01, 563.08it/s]warmup run: 1115it [00:02, 917.42it/s]warmup run: 1391it [00:02, 1062.53it/s]warmup run: 1220it [00:02, 954.08it/s]warmup run: 648it [00:02, 633.97it/s]warmup run: 1505it [00:02, 1083.27it/s]warmup run: 1325it [00:02, 980.19it/s]warmup run: 757it [00:02, 736.32it/s]warmup run: 1617it [00:02, 1081.58it/s]warmup run: 1430it [00:02, 998.07it/s]warmup run: 862it [00:02, 812.73it/s]warmup run: 1728it [00:03, 1082.74it/s]warmup run: 1534it [00:02, 1010.04it/s]warmup run: 967it [00:02, 873.30it/s]warmup run: 1841it [00:03, 1094.12it/s]warmup run: 1638it [00:03, 1017.39it/s]warmup run: 1072it [00:02, 918.57it/s]warmup run: 1952it [00:03, 1072.16it/s]warmup run: 1742it [00:03, 1020.48it/s]warmup run: 1183it [00:02, 970.26it/s]warmup run: 2072it [00:03, 1109.04it/s]warmup run: 1853it [00:03, 1043.99it/s]warmup run: 1289it [00:02, 993.48it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 2203it [00:03, 1167.23it/s]warmup run: 1967it [00:03, 1070.83it/s]warmup run: 1400it [00:02, 1025.43it/s]warmup run: 100it [00:01, 87.87it/s]warmup run: 2337it [00:03, 1216.22it/s]warmup run: 2093it [00:03, 1126.43it/s]warmup run: 1512it [00:02, 1050.94it/s]warmup run: 195it [00:01, 184.11it/s]warmup run: 2471it [00:03, 1251.48it/s]warmup run: 2221it [00:03, 1170.91it/s]warmup run: 1621it [00:02, 1057.82it/s]warmup run: 300it [00:01, 303.11it/s]warmup run: 2605it [00:03, 1276.79it/s]warmup run: 2355it [00:03, 1219.30it/s]warmup run: 1729it [00:03, 1060.00it/s]warmup run: 405it [00:01, 425.29it/s]warmup run: 2738it [00:03, 1291.57it/s]warmup run: 2478it [00:03, 1219.60it/s]warmup run: 1837it [00:03, 1063.04it/s]warmup run: 511it [00:01, 545.06it/s]warmup run: 2871it [00:03, 1301.88it/s]warmup run: 2615it [00:03, 1262.56it/s]warmup run: 1945it [00:03, 1044.76it/s]warmup run: 619it [00:02, 658.96it/s]warmup run: 3000it [00:04, 735.67it/s] warmup run: 2751it [00:03, 1286.66it/s]warmup run: 2053it [00:03, 1052.07it/s]warmup run: 727it [00:02, 755.90it/s]warmup run: 2888it [00:04, 1309.43it/s]warmup run: 2183it [00:03, 1122.97it/s]warmup run: 832it [00:02, 826.97it/s]warmup run: 3000it [00:04, 722.78it/s] warmup run: 2316it [00:03, 1182.16it/s]warmup run: 936it [00:02, 860.26it/s]warmup run: 2449it [00:03, 1225.00it/s]warmup run: 1037it [00:02, 890.40it/s]warmup run: 2582it [00:03, 1255.95it/s]warmup run: 1146it [00:02, 944.81it/s]warmup run: 2716it [00:03, 1278.48it/s]warmup run: 1253it [00:02, 978.28it/s]warmup run: 2848it [00:03, 1290.65it/s]warmup run: 1363it [00:02, 1010.50it/s]warmup run: 2982it [00:04, 1303.69it/s]warmup run: 3000it [00:04, 728.09it/s] warmup run: 1470it [00:02, 1027.71it/s]warmup run: 1578it [00:02, 1040.37it/s]warmup run: 1685it [00:03, 1047.49it/s]warmup run: 1792it [00:03, 1052.24it/s]warmup run: 1899it [00:03, 1036.07it/s]warmup run: 2007it [00:03, 1047.06it/s]warmup run: 2139it [00:03, 1126.98it/s]warmup run: 2272it [00:03, 1185.58it/s]warmup run: 2406it [00:03, 1229.14it/s]warmup run: 2538it [00:03, 1254.06it/s]warmup run: 2670it [00:03, 1273.01it/s]warmup run: 2800it [00:04, 1280.85it/s]warmup run: 2932it [00:04, 1291.14it/s]warmup run: 3000it [00:04, 719.79it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1715.67it/s]warmup should be done:   5%|▌         | 159/3000 [00:00<00:01, 1586.42it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1733.69it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1681.20it/s]warmup should be done:  11%|█         | 329/3000 [00:00<00:01, 1648.23it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1780.34it/s]warmup should be done:  12%|█▏        | 345/3000 [00:00<00:01, 1721.94it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1666.35it/s]warmup should be done:  17%|█▋        | 508/3000 [00:00<00:01, 1711.70it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1790.04it/s]warmup should be done:  17%|█▋        | 518/3000 [00:00<00:01, 1719.87it/s]warmup should be done:  17%|█▋        | 518/3000 [00:00<00:01, 1696.21it/s]warmup should be done:  23%|██▎       | 688/3000 [00:00<00:01, 1744.63it/s]warmup should be done:  24%|██▍       | 719/3000 [00:00<00:01, 1800.98it/s]warmup should be done:  23%|██▎       | 690/3000 [00:00<00:01, 1719.84it/s]warmup should be done:  23%|██▎       | 693/3000 [00:00<00:01, 1713.43it/s]warmup should be done:  29%|██▉       | 867/3000 [00:00<00:01, 1759.53it/s]warmup should be done:  30%|███       | 901/3000 [00:00<00:01, 1804.58it/s]warmup should be done:  29%|██▊       | 862/3000 [00:00<00:01, 1719.16it/s]warmup should be done:  29%|██▉       | 865/3000 [00:00<00:01, 1699.97it/s]warmup should be done:  35%|███▍      | 1047/3000 [00:00<00:01, 1770.47it/s]warmup should be done:  36%|███▌      | 1082/3000 [00:00<00:01, 1797.37it/s]warmup should be done:  34%|███▍      | 1034/3000 [00:00<00:01, 1696.61it/s]warmup should be done:  35%|███▍      | 1043/3000 [00:00<00:01, 1726.43it/s]warmup should be done:  41%|████      | 1226/3000 [00:00<00:00, 1774.07it/s]warmup should be done:  42%|████▏     | 1263/3000 [00:00<00:00, 1795.60it/s]warmup should be done:  40%|████      | 1208/3000 [00:00<00:01, 1708.65it/s]warmup should be done:  41%|████      | 1222/3000 [00:00<00:01, 1746.68it/s]warmup should be done:  47%|████▋     | 1405/3000 [00:00<00:00, 1778.48it/s]warmup should be done:  46%|████▌     | 1382/3000 [00:00<00:00, 1718.28it/s]warmup should be done:  47%|████▋     | 1399/3000 [00:00<00:00, 1753.64it/s]warmup should be done:  48%|████▊     | 1443/3000 [00:00<00:00, 1749.18it/s]warmup should be done:  53%|█████▎    | 1584/3000 [00:00<00:00, 1781.10it/s]warmup should be done:  52%|█████▏    | 1554/3000 [00:00<00:00, 1718.55it/s]warmup should be done:  53%|█████▎    | 1579/3000 [00:00<00:00, 1766.71it/s]warmup should be done:  54%|█████▍    | 1623/3000 [00:00<00:00, 1761.91it/s]warmup should be done:  59%|█████▉    | 1764/3000 [00:01<00:00, 1784.17it/s]warmup should be done:  58%|█████▊    | 1726/3000 [00:01<00:00, 1703.51it/s]warmup should be done:  59%|█████▊    | 1759/3000 [00:01<00:00, 1774.84it/s]warmup should be done:  60%|██████    | 1802/3000 [00:01<00:00, 1769.26it/s]warmup should be done:  65%|██████▍   | 1937/3000 [00:01<00:00, 1774.02it/s]warmup should be done:  65%|██████▍   | 1943/3000 [00:01<00:00, 1739.66it/s]warmup should be done:  66%|██████▌   | 1981/3000 [00:01<00:00, 1773.67it/s]warmup should be done:  63%|██████▎   | 1897/3000 [00:01<00:00, 1666.01it/s]warmup should be done:  71%|███████   | 2116/3000 [00:01<00:00, 1777.78it/s]warmup should be done:  71%|███████   | 2124/3000 [00:01<00:00, 1759.24it/s]warmup should be done:  72%|███████▏  | 2161/3000 [00:01<00:00, 1778.78it/s]warmup should be done:  69%|██████▉   | 2064/3000 [00:01<00:00, 1641.89it/s]warmup should be done:  77%|███████▋  | 2305/3000 [00:01<00:00, 1772.54it/s]warmup should be done:  78%|███████▊  | 2340/3000 [00:01<00:00, 1780.95it/s]warmup should be done:  76%|███████▋  | 2294/3000 [00:01<00:00, 1718.60it/s]warmup should be done:  75%|███████▍  | 2240/3000 [00:01<00:00, 1674.62it/s]warmup should be done:  83%|████████▎ | 2487/3000 [00:01<00:00, 1784.10it/s]warmup should be done:  84%|████████▍ | 2521/3000 [00:01<00:00, 1787.43it/s]warmup should be done:  82%|████████▏ | 2471/3000 [00:01<00:00, 1733.61it/s]warmup should be done:  81%|████████  | 2417/3000 [00:01<00:00, 1702.77it/s]warmup should be done:  89%|████████▉ | 2666/3000 [00:01<00:00, 1781.86it/s]warmup should be done:  90%|█████████ | 2701/3000 [00:01<00:00, 1789.22it/s]warmup should be done:  88%|████████▊ | 2651/3000 [00:01<00:00, 1753.09it/s]warmup should be done:  86%|████████▋ | 2595/3000 [00:01<00:00, 1723.15it/s]warmup should be done:  95%|█████████▍| 2845/3000 [00:01<00:00, 1781.24it/s]warmup should be done:  96%|█████████▌| 2881/3000 [00:01<00:00, 1791.00it/s]warmup should be done:  94%|█████████▍| 2832/3000 [00:01<00:00, 1767.15it/s]warmup should be done:  92%|█████████▏| 2773/3000 [00:01<00:00, 1738.96it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1783.37it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1763.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1746.19it/s]warmup should be done:  98%|█████████▊| 2952/3000 [00:01<00:00, 1752.00it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1712.98it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 183/3000 [00:00<00:01, 1824.59it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1727.57it/s]warmup should be done:   5%|▌         | 152/3000 [00:00<00:01, 1516.53it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1721.61it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1781.66it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1824.48it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1807.65it/s]warmup should be done:  11%|█         | 334/3000 [00:00<00:01, 1691.60it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1805.21it/s]warmup should be done:  18%|█▊        | 544/3000 [00:00<00:01, 1821.79it/s]warmup should be done:  18%|█▊        | 549/3000 [00:00<00:01, 1824.89it/s]warmup should be done:  17%|█▋        | 517/3000 [00:00<00:01, 1753.33it/s]warmup should be done:  24%|██▍       | 732/3000 [00:00<00:01, 1824.63it/s]warmup should be done:  24%|██▍       | 723/3000 [00:00<00:01, 1814.98it/s]warmup should be done:  24%|██▍       | 730/3000 [00:00<00:01, 1833.04it/s]warmup should be done:  23%|██▎       | 699/3000 [00:00<00:01, 1776.17it/s]warmup should be done:  30%|███       | 915/3000 [00:00<00:01, 1839.10it/s]warmup should be done:  30%|███       | 907/3000 [00:00<00:01, 1822.97it/s]warmup should be done:  31%|███       | 916/3000 [00:00<00:01, 1827.43it/s]warmup should be done:  29%|██▉       | 882/3000 [00:00<00:01, 1793.38it/s]warmup should be done:  37%|███▋      | 1101/3000 [00:00<00:01, 1843.62it/s]warmup should be done:  35%|███▌      | 1064/3000 [00:00<00:01, 1802.01it/s]warmup should be done:  37%|███▋      | 1100/3000 [00:00<00:01, 1829.90it/s]warmup should be done:  36%|███▋      | 1090/3000 [00:00<00:01, 1822.25it/s]warmup should be done:  42%|████▏     | 1245/3000 [00:00<00:00, 1802.35it/s]warmup should be done:  43%|████▎     | 1283/3000 [00:00<00:00, 1827.08it/s]warmup should be done:  43%|████▎     | 1286/3000 [00:00<00:00, 1840.36it/s]warmup should be done:  42%|████▏     | 1273/3000 [00:00<00:00, 1810.06it/s]warmup should be done:  49%|████▉     | 1467/3000 [00:00<00:00, 1830.58it/s]warmup should be done:  49%|████▉     | 1471/3000 [00:00<00:00, 1836.49it/s]warmup should be done:  48%|████▊     | 1426/3000 [00:00<00:00, 1787.08it/s]warmup should be done:  48%|████▊     | 1455/3000 [00:00<00:00, 1795.38it/s]warmup should be done:  55%|█████▌    | 1651/3000 [00:00<00:00, 1830.40it/s]warmup should be done:  54%|█████▎    | 1609/3000 [00:00<00:00, 1798.08it/s]warmup should be done:  55%|█████▍    | 1638/3000 [00:00<00:00, 1804.67it/s]warmup should be done:  55%|█████▌    | 1655/3000 [00:00<00:00, 1811.80it/s]warmup should be done:  61%|██████    | 1835/3000 [00:01<00:00, 1832.12it/s]warmup should be done:  60%|█████▉    | 1789/3000 [00:01<00:00, 1796.89it/s]warmup should be done:  61%|██████▏   | 1839/3000 [00:01<00:00, 1819.54it/s]warmup should be done:  61%|██████    | 1819/3000 [00:01<00:00, 1802.24it/s]warmup should be done:  67%|██████▋   | 2019/3000 [00:01<00:00, 1832.70it/s]warmup should be done:  66%|██████▌   | 1972/3000 [00:01<00:00, 1804.41it/s]warmup should be done:  67%|██████▋   | 2022/3000 [00:01<00:00, 1818.41it/s]warmup should be done:  67%|██████▋   | 2000/3000 [00:01<00:00, 1799.41it/s]warmup should be done:  73%|███████▎  | 2204/3000 [00:01<00:00, 1836.65it/s]warmup should be done:  72%|███████▏  | 2153/3000 [00:01<00:00, 1801.81it/s]warmup should be done:  73%|███████▎  | 2182/3000 [00:01<00:00, 1804.38it/s]warmup should be done:  74%|███████▎  | 2207/3000 [00:01<00:00, 1820.16it/s]warmup should be done:  78%|███████▊  | 2335/3000 [00:01<00:00, 1805.44it/s]warmup should be done:  79%|███████▉  | 2366/3000 [00:01<00:00, 1814.34it/s]warmup should be done:  80%|███████▉  | 2390/3000 [00:01<00:00, 1818.16it/s]warmup should be done:  80%|███████▉  | 2388/3000 [00:01<00:00, 1758.99it/s]warmup should be done:  84%|████████▍ | 2517/3000 [00:01<00:00, 1809.79it/s]warmup should be done:  85%|████████▌ | 2551/3000 [00:01<00:00, 1822.13it/s]warmup should be done:  86%|████████▌ | 2574/3000 [00:01<00:00, 1823.01it/s]warmup should be done:  86%|████████▌ | 2575/3000 [00:01<00:00, 1789.92it/s]warmup should be done:  90%|████████▉ | 2698/3000 [00:01<00:00, 1793.14it/s]warmup should be done:  91%|█████████ | 2735/3000 [00:01<00:00, 1825.34it/s]warmup should be done:  92%|█████████▏| 2758/3000 [00:01<00:00, 1825.07it/s]warmup should be done:  92%|█████████▏| 2762/3000 [00:01<00:00, 1812.21it/s]warmup should be done:  97%|█████████▋| 2919/3000 [00:01<00:00, 1827.50it/s]warmup should be done:  96%|█████████▌| 2878/3000 [00:01<00:00, 1759.27it/s]warmup should be done:  98%|█████████▊| 2941/3000 [00:01<00:00, 1763.75it/s]warmup should be done:  98%|█████████▊| 2944/3000 [00:01<00:00, 1785.03it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1812.26it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1811.84it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1808.84it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1779.60it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f33bd854280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f33bd854160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f33bd8540a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f33bd853190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-12 02:45:35.585086: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f2f8d26b250 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:45:35.585145: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:45:35.594465: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:45:36.378413: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:45:37.424766: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f2f91a6bb70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:45:37.424856: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:45:37.435270: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:45:37.436937: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f2f91a643b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:45:37.436972: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:45:37.445399: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:45:37.531456: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f2f91a6a1f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:45:37.531528: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:45:37.540204: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:45:38.180291: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:45:38.193657: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:45:38.294440: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:45:42.493902: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:45:43.404860: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:45:44.384836: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:45:44.438437: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][02:46:35.413][ERROR][RK0][tid #139842751014656]: replica 3 reaches 1000, calling init pre replica
[HCTR][02:46:35.413][ERROR][RK0][tid #139842751014656]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][02:46:35.418][ERROR][RK0][tid #139842751014656]: coll ps creation done
[HCTR][02:46:35.418][ERROR][RK0][tid #139842751014656]: replica 3 waits for coll ps creation barrier
[HCTR][02:46:35.628][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][02:46:35.628][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][02:46:35.632][ERROR][RK0][main]: coll ps creation done
[HCTR][02:46:35.632][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][02:46:35.866][ERROR][RK0][tid #139842751014656]: replica 0 reaches 1000, calling init pre replica
[HCTR][02:46:35.866][ERROR][RK0][tid #139842751014656]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][02:46:35.870][ERROR][RK0][tid #139842751014656]: coll ps creation done
[HCTR][02:46:35.870][ERROR][RK0][tid #139842751014656]: replica 0 waits for coll ps creation barrier
[HCTR][02:46:36.055][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][02:46:36.055][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][02:46:36.059][ERROR][RK0][main]: coll ps creation done
[HCTR][02:46:36.059][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][02:46:36.059][ERROR][RK0][tid #139842751014656]: replica 0 preparing frequency
[HCTR][02:46:37.036][ERROR][RK0][tid #139842751014656]: replica 0 preparing frequency done
[HCTR][02:46:37.083][ERROR][RK0][tid #139842751014656]: replica 0 calling init per replica
[HCTR][02:46:37.083][ERROR][RK0][tid #139842751014656]: replica 3 calling init per replica
[HCTR][02:46:37.083][ERROR][RK0][tid #139842751014656]: Calling build_v2
[HCTR][02:46:37.083][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][02:46:37.083][ERROR][RK0][tid #139842751014656]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:46:37.083][ERROR][RK0][tid #139842751014656]: Calling build_v2
[HCTR][02:46:37.083][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][02:46:37.083][ERROR][RK0][main]: Calling build_v2
[HCTR][02:46:37.083][ERROR][RK0][tid #139842751014656]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:46:37.083][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:46:37.083][ERROR][RK0][main]: Calling build_v2
[HCTR][02:46:37.083][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-12 02:46:37. 84891: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 0 to cpu
[2022-12-12 02:46:37. 84971: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 02:46:37. 85019: E[ /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:2132022-12-12 02:46:37] .remote time is 8.68421 85017[
: E 2022-12-12 02:46:37/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[.:2022-12-12 02:46:37 85039196.: ]  85064Eassigning 0 to cpu:  
E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc196:] 214assigning 0 to cpu] [
cpu time is 302022-12-12 02:46:37
.[ 85113: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-12 02:46:37[:.2022-12-12 02:46:37212 85108.] :  85144build symm link desc with 4X Tesla V100-SXM2-16GB out of 4E: 
 E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[196:2022-12-12 02:46:37] 212.assigning 0 to cpu]  85194
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] [remote time is 8.684212022-12-12 02:46:37
. 85254: E[ 2022-12-12 02:46:37/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.: 85268213: ] Eremote time is 8.68421 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] [cpu time is 302022-12-12 02:46:37
. 85301: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 02:46:37. 85406: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 02:46:37. 85476: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 02:46:37. 85529: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 02:47:00.477742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 02:47:00.533956: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-12 02:47:00.680521: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 02:47:00.680581: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 02:47:00.680613: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 02:47:00.680643: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 02:47:00.681692: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:47:00.681757: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:47:00.682865: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:47:00.683440: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[[2022-12-12 02:47:002022-12-12 02:47:002022-12-12 02:47:00...705257705279705284: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:::202202202] ] ] 3 solved1 solved2 solved


[[[2022-12-12 02:47:002022-12-12 02:47:002022-12-12 02:47:00...705401705402705403: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:::205205205] ] ] worker 0 thread 3 initing device 3worker 0 thread 1 initing device 1

worker 0 thread 2 initing device 2
[2022-12-12 02:47:00.705665: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:47:00.705715: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:47:00.705748: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:47:00.705797: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-12 02:47:00
.705815: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:47:00.705873: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:47:00.707445: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:47:00.707491: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-12 02:47:00
.707514: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:47:00.708936: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:47:00.708965: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-12 02:47:00
.708988: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:47:00.744008: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 02:47:00.745832: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 02:47:00.745884: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:47:00.746699: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:47:00.748222: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:47:00.749291: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:47:00.749338: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 68.66 MB
[2022-12-12 02:47:00.783773: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:47:00.784415: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:47:00.784460: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.59 GB
[[[2022-12-12 02:47:002022-12-12 02:47:002022-12-12 02:47:00...804713804714804713: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes


[2022-12-12 02:47:00.806531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-12 02:47:00eager release cuda mem 5.
806551: E[ 2022-12-12 02:47:00/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:806568638: [] E2022-12-12 02:47:00eager release cuda mem 5 .
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc806586:: 638E]  eager release cuda mem 5/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[
:2022-12-12 02:47:00638.] 806623eager release cuda mem 400000000: 
[E2022-12-12 02:47:00 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc806643:: 638E]  eager release cuda mem 400000000/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 400000000
[2022-12-12 02:47:00.807494: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:47:00.807988: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:47:00.808473: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[[2022-12-12 02:47:00[2022-12-12 02:47:00.2022-12-12 02:47:00.809206.809208: 809215: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980:1980] 1980] eager alloc mem 611.00 KB] eager alloc mem 611.00 KB
eager alloc mem 611.00 KB

[[[2022-12-12 02:47:002022-12-12 02:47:002022-12-12 02:47:00...810233810236810236: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:::638638638] ] ] eager release cuda mem 625663eager release cuda mem 625663eager release cuda mem 625663


[[2022-12-12 02:47:00[2022-12-12 02:47:00.2022-12-12 02:47:00.810324.810325: 810327: W: W W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43:43] 43] WORKER[0] alloc host memory 68.66 MB] WORKER[0] alloc host memory 68.66 MB
WORKER[0] alloc host memory 68.66 MB

[2022-12-12 02:47:00.843285: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:47:00.843867: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:47:00.843907: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.59 GB
[2022-12-12 02:47:00.844725: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:47:00.845286: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:47:00.845325: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.59 GB
[2022-12-12 02:47:00.845434: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:47:00.845995: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:47:00.846035: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.59 GB
[[[2022-12-12 02:47:012022-12-12 02:47:01[2022-12-12 02:47:01..2022-12-12 02:47:01.664290664295.664291: : 664307: EE: E  E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:19261926:1926] ] 1926] Device 3 init p2p of link 0Device 2 init p2p of link 3] Device 0 init p2p of link 1

Device 1 init p2p of link 2

[2022-12-12 02:47:01.664622: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:47:01.664659: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-12 02:47:01:.1980664674] : eager alloc mem 611.00 KBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:47:01.664884: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:47:01.665474: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:47:01.665509: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:2022-12-12 02:47:01638.] 665525eager release cuda mem 625663: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:47:01.665786: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:47:01.676236: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 02:47:01.676344: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:47:01.676368: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[[2022-12-12 02:47:012022-12-12 02:47:01..676469676480: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261980] ] Device 3 init p2p of link 1eager alloc mem 611.00 KB

[2022-12-12 02:47:01[.2022-12-12 02:47:01676597.: 676590E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1926eager alloc mem 611.00 KB] 
Device 1 init p2p of link 3
[2022-12-12 02:47:01.676796: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:47:01.677183: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:47:01.677340: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:47:01.677494: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:47:01.677641: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:47:01.689042: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 02:47:01.689142: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:47:01.689313: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 02:47:01.689405: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:47:01.689522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[[2022-12-12 02:47:012022-12-12 02:47:01..689596689605: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261980] ] Device 1 init p2p of link 0eager alloc mem 611.00 KB

[2022-12-12 02:47:01.689773: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:47:01.689972: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:47:01.690224: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:47:01.690519: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:47:01.690613: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:47:01.700564: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:47:01.700903: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 18000000 / 100000000 nodes ( 18.00 %~18.00 %) | remote 54000000 / 100000000 nodes ( 54.00 %) | cpu 28000000 / 100000000 nodes ( 28.00 %) | 8.59 GB | 0.995118 secs 
[2022-12-12 02:47:01.701116: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:47:01.701363: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:47:01.701487[: 2022-12-12 02:47:01E. 701492/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1955 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:Asymm Coll cache (policy: clique_part) | local 18000000 / 100000000 nodes ( 18.00 %~18.00 %) | remote 54000000 / 100000000 nodes ( 54.00 %) | cpu 28000000 / 100000000 nodes ( 28.00 %) | 8.59 GB | 1.01975 secs 638
] eager release cuda mem 72400000
[2022-12-12 02:47:01.701722: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 18000000 / 100000000 nodes ( 18.00 %~18.00 %) | remote 54000000 / 100000000 nodes ( 54.00 %) | cpu 28000000 / 100000000 nodes ( 28.00 %) | 8.59 GB | 0.995869 secs 
[2022-12-12 02:47:01.702017: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 18000000 / 100000000 nodes ( 18.00 %~18.00 %) | remote 54000000 / 100000000 nodes ( 54.00 %) | cpu 28000000 / 100000000 nodes ( 28.00 %) | 8.59 GB | 0.996316 secs 
[HCTR][02:47:01.702][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][02:47:01.702][ERROR][RK0][tid #139842751014656]: replica 3 calling init per replica done, doing barrier
[HCTR][02:47:01.702][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][02:47:01.702][ERROR][RK0][tid #139842751014656]: replica 0 calling init per replica done, doing barrier
[HCTR][02:47:01.702][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][02:47:01.702][ERROR][RK0][tid #139842751014656]: replica 0 calling init per replica done, doing barrier done
[HCTR][02:47:01.702][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][02:47:01.702][ERROR][RK0][tid #139842751014656]: replica 3 calling init per replica done, doing barrier done
[HCTR][02:47:01.702][ERROR][RK0][main]: init per replica done
[HCTR][02:47:01.702][ERROR][RK0][tid #139842751014656]: init per replica done
[HCTR][02:47:01.702][ERROR][RK0][main]: init per replica done
[HCTR][02:47:01.706][ERROR][RK0][tid #139842751014656]: init per replica done
