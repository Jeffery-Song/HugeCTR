2022-12-11 21:02:44.189694: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:02:44.259681: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:02:44.259684: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:02:44.259748: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:02:45.029913: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:02:45.029989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:02:45.045977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:02:45.077455: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:02:45.077608: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:02:45.079200: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 21:02:45.118118: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:02:45.118192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:02:45.130552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:02:45.132093: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:02:45.132149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:02:45.132809: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:02:45.132866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:02:45.145970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:02:45.146277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:02:45.163783: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:02:45.163940: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:02:45.165208: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 21:02:45.176444: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:02:45.176592: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:02:45.177552: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:02:45.177659: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:02:45.177995: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 21:02:45.179108: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][21:02:46.420][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:02:46.429][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:02:46.430][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:02:46.445][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.55s/it]warmup run: 112it [00:01, 94.50it/s]warmup run: 225it [00:01, 206.06it/s]warmup run: 338it [00:01, 329.11it/s]warmup run: 450it [00:01, 455.12it/s]warmup run: 1it [00:01,  1.63s/it]warmup run: 561it [00:02, 576.76it/s]warmup run: 107it [00:01, 85.83it/s]warmup run: 672it [00:02, 687.48it/s]warmup run: 211it [00:01, 184.03it/s]warmup run: 781it [00:02, 778.93it/s]warmup run: 1it [00:01,  1.56s/it]warmup run: 317it [00:01, 296.31it/s]warmup run: 54it [00:01, 44.75it/s]warmup run: 889it [00:02, 676.35it/s]warmup run: 408it [00:02, 351.53it/s]warmup run: 133it [00:01, 124.02it/s]warmup run: 990it [00:02, 748.63it/s]warmup run: 514it [00:02, 468.50it/s]warmup run: 237it [00:01, 244.58it/s]warmup run: 1096it [00:02, 822.42it/s]warmup run: 616it [00:02, 573.64it/s]warmup run: 338it [00:01, 365.64it/s]warmup run: 1202it [00:02, 881.95it/s]warmup run: 716it [00:02, 664.64it/s]warmup run: 443it [00:02, 491.37it/s]warmup run: 1312it [00:02, 937.66it/s]warmup run: 815it [00:02, 740.45it/s]warmup run: 548it [00:02, 607.27it/s]warmup run: 1423it [00:02, 983.74it/s]warmup run: 915it [00:02, 803.95it/s]warmup run: 654it [00:02, 710.54it/s]warmup run: 1535it [00:03, 1020.01it/s]warmup run: 1017it [00:02, 859.00it/s]warmup run: 760it [00:02, 795.23it/s]warmup run: 1647it [00:03, 1046.30it/s]warmup run: 1125it [00:02, 917.93it/s]warmup run: 866it [00:02, 862.71it/s]warmup run: 1756it [00:03, 1056.49it/s]warmup run: 1233it [00:02, 962.93it/s]warmup run: 969it [00:02, 907.29it/s]warmup run: 1865it [00:03, 1056.47it/s]warmup run: 1337it [00:03, 975.00it/s]warmup run: 1075it [00:02, 948.85it/s]warmup run: 1973it [00:03, 1051.64it/s]warmup run: 1440it [00:03, 978.91it/s]warmup run: 1179it [00:02, 972.81it/s]warmup run: 2094it [00:03, 1097.03it/s]warmup run: 1547it [00:03, 1003.41it/s]warmup run: 1286it [00:02, 998.44it/s]warmup run: 2230it [00:03, 1172.09it/s]warmup run: 1661it [00:03, 1042.12it/s]warmup run: 1393it [00:02, 1017.52it/s]warmup run: 2360it [00:03, 1202.24it/s]warmup run: 1769it [00:03, 1048.01it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1498it [00:03, 986.11it/s] warmup run: 2492it [00:03, 1236.91it/s]warmup run: 1876it [00:03, 1046.02it/s]warmup run: 1611it [00:03, 1025.16it/s]warmup run: 2625it [00:03, 1263.84it/s]warmup run: 1987it [00:03, 1062.62it/s]warmup run: 1718it [00:03, 1037.43it/s]warmup run: 2760it [00:04, 1288.31it/s]warmup run: 2105it [00:03, 1097.06it/s]warmup run: 1824it [00:03, 1040.80it/s]warmup run: 2892it [00:04, 1297.11it/s]warmup run: 2227it [00:03, 1131.84it/s]warmup run: 1930it [00:03, 1043.72it/s]warmup run: 3000it [00:04, 704.84it/s] warmup run: 2361it [00:03, 1191.66it/s]warmup run: 2044it [00:03, 1071.09it/s]warmup run: 2495it [00:04, 1233.93it/s]warmup run: 2176it [00:03, 1144.47it/s]warmup run: 2629it [00:04, 1264.42it/s]warmup run: 2309it [00:03, 1198.03it/s]warmup run: 2761it [00:04, 1280.68it/s]warmup run: 2442it [00:03, 1236.82it/s]warmup run: 2893it [00:04, 1290.12it/s]warmup run: 2575it [00:03, 1263.33it/s]warmup run: 3000it [00:04, 679.14it/s] warmup run: 2708it [00:04, 1280.87it/s]warmup run: 2841it [00:04, 1294.42it/s]warmup run: 2971it [00:04, 1295.80it/s]warmup run: 3000it [00:04, 693.88it/s] warmup run: 1it [00:01,  1.41s/it]warmup run: 99it [00:01, 90.95it/s]warmup run: 199it [00:01, 196.58it/s]warmup run: 290it [00:01, 298.03it/s]warmup run: 396it [00:01, 426.38it/s]warmup run: 502it [00:01, 549.01it/s]warmup run: 610it [00:02, 663.18it/s]warmup run: 718it [00:02, 760.55it/s]warmup run: 825it [00:02, 838.06it/s]warmup run: 933it [00:02, 900.58it/s]warmup run: 1040it [00:02, 946.39it/s]warmup run: 1149it [00:02, 984.69it/s]warmup run: 1256it [00:02, 1000.36it/s]warmup run: 1365it [00:02, 1023.78it/s]warmup run: 1474it [00:02, 1041.75it/s]warmup run: 1581it [00:02, 1042.82it/s]warmup run: 1690it [00:03, 1054.19it/s]warmup run: 1799it [00:03, 1062.59it/s]warmup run: 1907it [00:03, 1059.32it/s]warmup run: 2014it [00:03, 1054.30it/s]warmup run: 2147it [00:03, 1134.33it/s]warmup run: 2281it [00:03, 1194.49it/s]warmup run: 2404it [00:03, 1202.96it/s]warmup run: 2539it [00:03, 1245.12it/s]warmup run: 2675it [00:03, 1277.62it/s]warmup run: 2803it [00:03, 1222.14it/s]warmup run: 2939it [00:04, 1259.48it/s]warmup run: 3000it [00:04, 732.58it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 179/3000 [00:00<00:01, 1788.66it/s]warmup should be done:   5%|▌         | 157/3000 [00:00<00:01, 1566.69it/s]warmup should be done:   5%|▌         | 158/3000 [00:00<00:01, 1572.59it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1651.17it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1799.77it/s]warmup should be done:  11%|█         | 326/3000 [00:00<00:01, 1635.98it/s]warmup should be done:  11%|█▏        | 338/3000 [00:00<00:01, 1705.83it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1709.43it/s]warmup should be done:  18%|█▊        | 540/3000 [00:00<00:01, 1794.05it/s]warmup should be done:  17%|█▋        | 516/3000 [00:00<00:01, 1739.30it/s]warmup should be done:  17%|█▋        | 513/3000 [00:00<00:01, 1705.21it/s]warmup should be done:  16%|█▋        | 490/3000 [00:00<00:01, 1627.11it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1795.74it/s]warmup should be done:  23%|██▎       | 696/3000 [00:00<00:01, 1760.45it/s]warmup should be done:  23%|██▎       | 688/3000 [00:00<00:01, 1722.59it/s]warmup should be done:  22%|██▏       | 666/3000 [00:00<00:01, 1678.28it/s]warmup should be done:  30%|███       | 900/3000 [00:00<00:01, 1793.94it/s]warmup should be done:  29%|██▉       | 873/3000 [00:00<00:01, 1763.00it/s]warmup should be done:  29%|██▊       | 862/3000 [00:00<00:01, 1726.47it/s]warmup should be done:  28%|██▊       | 842/3000 [00:00<00:01, 1703.88it/s]warmup should be done:  35%|███▌      | 1051/3000 [00:00<00:01, 1766.62it/s]warmup should be done:  36%|███▌      | 1080/3000 [00:00<00:01, 1787.20it/s]warmup should be done:  34%|███▍      | 1035/3000 [00:00<00:01, 1722.87it/s]warmup should be done:  34%|███▍      | 1013/3000 [00:00<00:01, 1672.63it/s]warmup should be done:  41%|████      | 1230/3000 [00:00<00:00, 1770.95it/s]warmup should be done:  42%|████▏     | 1260/3000 [00:00<00:00, 1788.62it/s]warmup should be done:  40%|████      | 1209/3000 [00:00<00:01, 1726.52it/s]warmup should be done:  40%|███▉      | 1189/3000 [00:00<00:01, 1699.22it/s]warmup should be done:  47%|████▋     | 1408/3000 [00:00<00:00, 1773.79it/s]warmup should be done:  46%|████▌     | 1386/3000 [00:00<00:00, 1738.12it/s]warmup should be done:  48%|████▊     | 1439/3000 [00:00<00:00, 1732.15it/s]warmup should be done:  45%|████▌     | 1360/3000 [00:00<00:01, 1628.63it/s]warmup should be done:  53%|█████▎    | 1587/3000 [00:00<00:00, 1776.89it/s]warmup should be done:  52%|█████▏    | 1563/3000 [00:00<00:00, 1747.13it/s]warmup should be done:  54%|█████▍    | 1614/3000 [00:00<00:00, 1736.76it/s]warmup should be done:  51%|█████     | 1524/3000 [00:00<00:00, 1594.64it/s]warmup should be done:  59%|█████▉    | 1766/3000 [00:01<00:00, 1778.53it/s]warmup should be done:  58%|█████▊    | 1740/3000 [00:01<00:00, 1753.93it/s]warmup should be done:  60%|█████▉    | 1788/3000 [00:01<00:00, 1732.22it/s]warmup should be done:  56%|█████▌    | 1684/3000 [00:01<00:00, 1577.06it/s]warmup should be done:  65%|██████▍   | 1945/3000 [00:01<00:00, 1779.43it/s]warmup should be done:  64%|██████▍   | 1917/3000 [00:01<00:00, 1758.79it/s]warmup should be done:  65%|██████▌   | 1962/3000 [00:01<00:00, 1727.53it/s]warmup should be done:  62%|██████▏   | 1861/3000 [00:01<00:00, 1632.11it/s]warmup should be done:  71%|███████   | 2125/3000 [00:01<00:00, 1782.42it/s]warmup should be done:  70%|██████▉   | 2094/3000 [00:01<00:00, 1761.40it/s]warmup should be done:  71%|███████   | 2135/3000 [00:01<00:00, 1727.27it/s]warmup should be done:  68%|██████▊   | 2037/3000 [00:01<00:00, 1669.72it/s]warmup should be done:  76%|███████▌  | 2272/3000 [00:01<00:00, 1765.16it/s]warmup should be done:  77%|███████▋  | 2305/3000 [00:01<00:00, 1785.08it/s]warmup should be done:  77%|███████▋  | 2310/3000 [00:01<00:00, 1734.03it/s]warmup should be done:  74%|███████▎  | 2205/3000 [00:01<00:00, 1651.77it/s]warmup should be done:  83%|████████▎ | 2486/3000 [00:01<00:00, 1792.01it/s]warmup should be done:  82%|████████▏ | 2452/3000 [00:01<00:00, 1773.71it/s]warmup should be done:  83%|████████▎ | 2484/3000 [00:01<00:00, 1715.57it/s]warmup should be done:  79%|███████▉  | 2381/3000 [00:01<00:00, 1681.42it/s]warmup should be done:  89%|████████▉ | 2666/3000 [00:01<00:00, 1793.64it/s]warmup should be done:  88%|████████▊ | 2631/3000 [00:01<00:00, 1778.04it/s]warmup should be done:  89%|████████▊ | 2661/3000 [00:01<00:00, 1730.99it/s]warmup should be done:  85%|████████▌ | 2550/3000 [00:01<00:00, 1596.01it/s]warmup should be done:  94%|█████████▎| 2810/3000 [00:01<00:00, 1779.40it/s]warmup should be done:  95%|█████████▍| 2846/3000 [00:01<00:00, 1762.71it/s]warmup should be done:  94%|█████████▍| 2835/3000 [00:01<00:00, 1710.39it/s]warmup should be done:  91%|█████████ | 2729/3000 [00:01<00:00, 1651.51it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1767.17it/s]warmup should be done: 100%|█████████▉| 2989/3000 [00:01<00:00, 1781.04it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1752.39it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1746.80it/s]warmup should be done:  97%|█████████▋| 2908/3000 [00:01<00:00, 1690.87it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1656.35it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1838.19it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1835.01it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1724.40it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1700.66it/s]warmup should be done:  12%|█▏        | 368/3000 [00:00<00:01, 1837.48it/s]warmup should be done:  12%|█▏        | 369/3000 [00:00<00:01, 1839.67it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1792.70it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1747.83it/s]warmup should be done:  18%|█▊        | 552/3000 [00:00<00:01, 1837.48it/s]warmup should be done:  18%|█▊        | 553/3000 [00:00<00:01, 1838.93it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1760.49it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1814.39it/s]warmup should be done:  25%|██▍       | 736/3000 [00:00<00:01, 1836.91it/s]warmup should be done:  25%|██▍       | 737/3000 [00:00<00:01, 1836.34it/s]warmup should be done:  24%|██▎       | 707/3000 [00:00<00:01, 1771.37it/s]warmup should be done:  24%|██▍       | 727/3000 [00:00<00:01, 1822.51it/s]warmup should be done:  31%|███       | 920/3000 [00:00<00:01, 1836.44it/s]warmup should be done:  31%|███       | 921/3000 [00:00<00:01, 1835.64it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1790.60it/s]warmup should be done:  30%|███       | 911/3000 [00:00<00:01, 1828.60it/s]warmup should be done:  37%|███▋      | 1104/3000 [00:00<00:01, 1836.68it/s]warmup should be done:  37%|███▋      | 1105/3000 [00:00<00:01, 1837.06it/s]warmup should be done:  36%|███▋      | 1095/3000 [00:00<00:01, 1832.37it/s]warmup should be done:  36%|███▌      | 1072/3000 [00:00<00:01, 1798.75it/s]warmup should be done:  42%|████▏     | 1254/3000 [00:00<00:00, 1805.60it/s]warmup should be done:  43%|████▎     | 1279/3000 [00:00<00:00, 1833.10it/s]warmup should be done:  43%|████▎     | 1288/3000 [00:00<00:00, 1829.45it/s]warmup should be done:  43%|████▎     | 1289/3000 [00:00<00:00, 1753.39it/s]warmup should be done:  48%|████▊     | 1438/3000 [00:00<00:00, 1813.66it/s]warmup should be done:  49%|████▉     | 1465/3000 [00:00<00:00, 1838.44it/s]warmup should be done:  49%|████▉     | 1473/3000 [00:00<00:00, 1833.27it/s]warmup should be done:  49%|████▉     | 1469/3000 [00:00<00:00, 1766.51it/s]warmup should be done:  55%|█████▌    | 1650/3000 [00:00<00:00, 1840.58it/s]warmup should be done:  55%|█████▌    | 1657/3000 [00:00<00:00, 1821.18it/s]warmup should be done:  54%|█████▍    | 1620/3000 [00:00<00:00, 1755.73it/s]warmup should be done:  55%|█████▍    | 1647/3000 [00:00<00:00, 1649.51it/s]warmup should be done:  61%|██████    | 1835/3000 [00:01<00:00, 1842.25it/s]warmup should be done:  61%|██████▏   | 1840/3000 [00:01<00:00, 1788.95it/s]warmup should be done:  60%|██████    | 1804/3000 [00:01<00:00, 1779.72it/s]warmup should be done:  61%|██████    | 1829/3000 [00:01<00:00, 1697.82it/s]warmup should be done:  67%|██████▋   | 2020/3000 [00:01<00:00, 1840.96it/s]warmup should be done:  67%|██████▋   | 2023/3000 [00:01<00:00, 1798.46it/s]warmup should be done:  66%|██████▋   | 1988/3000 [00:01<00:00, 1797.31it/s]warmup should be done:  67%|██████▋   | 2011/3000 [00:01<00:00, 1732.50it/s]warmup should be done:  74%|███████▎  | 2205/3000 [00:01<00:00, 1841.62it/s]warmup should be done:  73%|███████▎  | 2203/3000 [00:01<00:00, 1792.65it/s]warmup should be done:  72%|███████▏  | 2172/3000 [00:01<00:00, 1809.58it/s]warmup should be done:  73%|███████▎  | 2191/3000 [00:01<00:00, 1751.05it/s]warmup should be done:  80%|███████▉  | 2390/3000 [00:01<00:00, 1838.51it/s]warmup should be done:  79%|███████▉  | 2384/3000 [00:01<00:00, 1795.65it/s]warmup should be done:  79%|███████▊  | 2357/3000 [00:01<00:00, 1820.10it/s]warmup should be done:  79%|███████▉  | 2371/3000 [00:01<00:00, 1763.55it/s]warmup should be done:  86%|████████▌ | 2575/3000 [00:01<00:00, 1840.10it/s]warmup should be done:  85%|████████▍ | 2541/3000 [00:01<00:00, 1824.90it/s]warmup should be done:  85%|████████▌ | 2564/3000 [00:01<00:00, 1783.50it/s]warmup should be done:  85%|████████▌ | 2552/3000 [00:01<00:00, 1775.95it/s]warmup should be done:  92%|█████████▏| 2760/3000 [00:01<00:00, 1841.96it/s]warmup should be done:  91%|█████████ | 2726/3000 [00:01<00:00, 1831.16it/s]warmup should be done:  92%|█████████▏| 2745/3000 [00:01<00:00, 1788.62it/s]warmup should be done:  91%|█████████ | 2733/3000 [00:01<00:00, 1784.13it/s]warmup should be done:  98%|█████████▊| 2945/3000 [00:01<00:00, 1842.39it/s]warmup should be done:  97%|█████████▋| 2911/3000 [00:01<00:00, 1834.21it/s]warmup should be done:  97%|█████████▋| 2924/3000 [00:01<00:00, 1786.45it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1833.53it/s]warmup should be done:  97%|█████████▋| 2913/3000 [00:01<00:00, 1786.84it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1806.61it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1803.11it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1773.13it/s]2022-12-11 21:04:01.983786: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f32eea68c50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:04:01.983862: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:04:03.609823: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:04:04.221503: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f32f2264730 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:04:04.221567: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:04:04.782720: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:04:06.075731: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:04:08.634648: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:04:10.269171: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f32eea6bed0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:04:10.269230: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:04:10.707184: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:04:12.593236: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:04:14.568387: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:04:16.517643: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:04:18.510584: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:04:21.453887: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f32ee267af0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:04:21.453947: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:04:25.771863: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:04:27.675735: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:04:29.546698: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][21:05:02.346][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][21:05:02.347][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:05:02.351][ERROR][RK0][main]: coll ps creation done
[HCTR][21:05:02.352][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][21:05:02.512][ERROR][RK0][tid #139857078773504]: replica 3 reaches 1000, calling init pre replica
[HCTR][21:05:02.513][ERROR][RK0][tid #139857078773504]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:05:02.516][ERROR][RK0][tid #139857078773504]: coll ps creation done
[HCTR][21:05:02.516][ERROR][RK0][tid #139857078773504]: replica 3 waits for coll ps creation barrier
[HCTR][21:05:02.730][ERROR][RK0][tid #139857070380800]: replica 1 reaches 1000, calling init pre replica
[HCTR][21:05:02.731][ERROR][RK0][tid #139857070380800]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:05:02.735][ERROR][RK0][tid #139857070380800]: coll ps creation done
[HCTR][21:05:02.735][ERROR][RK0][tid #139857070380800]: replica 1 waits for coll ps creation barrier
[HCTR][21:05:02.760][ERROR][RK0][tid #139857078773504]: replica 0 reaches 1000, calling init pre replica
[HCTR][21:05:02.760][ERROR][RK0][tid #139857078773504]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:05:02.764][ERROR][RK0][tid #139857078773504]: coll ps creation done
[HCTR][21:05:02.764][ERROR][RK0][tid #139857078773504]: replica 0 waits for coll ps creation barrier
[HCTR][21:05:02.764][ERROR][RK0][tid #139857078773504]: replica 0 preparing frequency
[HCTR][21:05:03.657][ERROR][RK0][tid #139857078773504]: replica 0 preparing frequency done
[HCTR][21:05:03.684][ERROR][RK0][tid #139857078773504]: replica 0 calling init per replica
[HCTR][21:05:03.684][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][21:05:03.684][ERROR][RK0][tid #139857070380800]: replica 1 calling init per replica
[HCTR][21:05:03.684][ERROR][RK0][tid #139857078773504]: replica 3 calling init per replica
[HCTR][21:05:03.684][ERROR][RK0][tid #139857078773504]: Calling build_v2
[HCTR][21:05:03.684][ERROR][RK0][tid #139857070380800]: Calling build_v2
[HCTR][21:05:03.684][ERROR][RK0][tid #139857078773504]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:05:03.684][ERROR][RK0][tid #139857070380800]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:05:03.684][ERROR][RK0][main]: Calling build_v2
[HCTR][21:05:03.684][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:05:03.684][ERROR][RK0][tid #139857078773504]: Calling build_v2
[HCTR][21:05:03.684][ERROR][RK0][tid #139857078773504]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-11 21:05:032022-12-11 21:05:03..6850112022-12-11 21:05:03685004: .: E685018E :  [/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: 2022-12-11 21:05:03:136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc.136] :685048] using concurrent impl MPSPhase136: using concurrent impl MPSPhase
] E
using concurrent impl MPSPhase 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[2022-12-11 21:05:03.686125: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 21:05:03.686150: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] [[assigning 8 to cpu2022-12-11 21:05:032022-12-11 21:05:03
..686173686170: : [EE2022-12-11 21:05:03  [./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 21:05:03686196::.: 196212686206E] ] :  assigning 8 to cpubuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc

 :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc196:] 212assigning 8 to cpu] [
build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 21:05:03
.686273: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2132022-12-11 21:05:03] .remote time is 8.68421686299
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[[:2022-12-11 21:05:032022-12-11 21:05:03213..] 686323686322remote time is 8.68421: : 
EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:2022-12-11 21:05:03:214.212] 686360] cpu time is 30: build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30[
2022-12-11 21:05:03.686407: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 21:05:03.686449: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2142022-12-11 21:05:03] .cpu time is 30686448
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 21:05:03.686527: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 21:05:03.686557: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 21:05:29.553732: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 21:05:29.610432: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 21:05:29.610545: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 21:05:29.611607: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 21:05:29.712147: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 21:05:30. 87359: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 21:05:30. 87472: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 21:05:37.443428: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 21:05:37.443588: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 21:05:39.229128: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 21:05:39.229221: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 21:05:39.232729: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 21:05:39.232786: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 21:05:39.262354: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 21:05:39.282563: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 21:05:39.283647: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 21:05:39.294454: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 21:05:39.392071: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 21:05:39.395124: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 21:05:39.397585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 21:05:39.399992: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 21:05:39.402381: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 21:05:41.176241: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 21:05:41.180235: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 21:05:41.180385: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 21:05:41.188903: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 21:05:41.188984: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 21:05:41.189017: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 21:05:41.189047: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 21:05:41.189970: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:05:41.190014: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:05:41.190997: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:05:41.191562: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:05:41.212065: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 21:05:41.212163: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 21:05:41.212848: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:05:41.212907: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:05:41.213741: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:05:41.214299: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:05:41.214494: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 21:05:41.214619: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 21:05:41.215805: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 21:05:41.215931: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 21:05:41.217860: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:05:41.217952: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:05:41.219264: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:05:41.219920: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:05:41.219960: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:05:41.220046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:05:41.221745: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:05:41.222732: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:05:41.289193: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 21:05:41.290053: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 21:05:41.291038: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:05:41.291099: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:05:41.291905: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-11 21:05:41] .eager alloc mem 15.64 MB291923
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:05:41.292007: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:05:41.292566: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:05:41.292821: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:05:41.293399: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:05:41.293484: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:05:41.293530: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.23 MB
[2022-12-11 21:05:41.294305: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:05:41.294351: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.26 MB
[2022-12-11 21:05:41.298170: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:05:41.298826: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:05:41.298869: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[2022-12-11 21:05:41.303014: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:05:41.303710: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:05:41.303755: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[2022-12-11 21:05:412022-12-11 21:05:41..318200318212: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-11 21:05:41.320098: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:05:41.320131: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:05:41.320159: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:05:41.320188: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:05:41.321031: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:05:41.322269: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:05:41.323168: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:05:41.324021: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-11 21:05:41] .eager alloc mem 611.00 KB324092
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:05:41.324155: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.25 MB
[2022-12-11 21:05:41.325133: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:05:41.325245: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.21 MB
[2022-12-11 21:05:41.332950: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:05:41.333558: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:05:41.333600: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[2022-12-11 21:05:41.335748: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:05:41.336351: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:05:41.336400: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[[[2022-12-11 21:05:412022-12-11 21:05:412022-12-11 21:05:412022-12-11 21:05:41....505954505958505975505973: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 0 init p2p of link 1Device 2 init p2p of link 3Device 1 init p2p of link 2Device 3 init p2p of link 0



[2022-12-11 21:05:41.506250: [E2022-12-11 21:05:41 .[/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu5062612022-12-11 21:05:41:: [.1980E2022-12-11 21:05:41506277]  .: eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu506294E
::  1980E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu]  :eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980
:] 1980eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KB
[2022-12-11 21:05:41.507132: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:[2022-12-11 21:05:416382022-12-11 21:05:41.] .507150eager release cuda mem 625663507153: 
: E[E 2022-12-11 21:05:41 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:507204:638: 638] E] eager release cuda mem 625663 eager release cuda mem 625663
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-11 21:05:41.[5104322022-12-11 21:05:41: .E510441 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1926/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :Device 1 init p2p of link 31926
] Device 0 init p2p of link 2
[2022-12-11 21:05:41.510533: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-11 21:05:411926.] [510560Device 2 init p2p of link 02022-12-11 21:05:41[: 
.2022-12-11 21:05:41E510579. : 510595/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: : E1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu ] :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1926:eager alloc mem 611.00 KB] 1980
Device 3 init p2p of link 1] 
eager alloc mem 611.00 KB
[2022-12-11 21:05:41.510673: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:05:41.510764: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:05:41.511411: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:05:41.511443: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:[6382022-12-11 21:05:41] .eager release cuda mem 625663511459
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:05:41.511592: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:05:41.514381: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 21:05:41.514461: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:05:41.515265: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:05:41.521981: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 21:05:41.522029: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 21:05:41.522109: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:05:41.522188: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:05:41.522913: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:05:41.523022: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:05:41.523390: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:05:41.522454: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 21:05:41.524358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:05:41.525453: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955[] 2022-12-11 21:05:41Asymm Coll cache (policy: coll_cache_asymm_link) | local 3999308 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11972203 / 100000000 nodes ( 11.97 %) | cpu 84028489 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.335441 secs .
525514: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:05:41.526208: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 6.94 GB
[2022-12-11 21:05:41.527942: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:05:41.528325: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:05:41.528974: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:05:41.529709: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3993425 / 100000000 nodes ( 3.99 %~4.00 %) | remote 11978086 / 100000000 nodes ( 11.98 %) | cpu 84028489 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.31682 secs 
[2022-12-11 21:05:41.530259: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3986628 / 100000000 nodes ( 3.99 %~4.00 %) | remote 11984883 / 100000000 nodes ( 11.98 %) | cpu 84028489 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.312349 secs 
[2022-12-11 21:05:41.530463: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3997953 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11973558 / 100000000 nodes ( 11.97 %) | cpu 84028489 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.310454 secs 
[2022-12-11 21:05:42.312648: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 7.19 GB
[2022-12-11 21:05:42.312775: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 7.19 GB
[2022-12-11 21:05:42.313001: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 7.19 GB
[2022-12-11 21:05:43. 53574: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 7.43 GB
[2022-12-11 21:05:43. 53700: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 7.43 GB
[2022-12-11 21:05:43. 54649: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 7.43 GB
[2022-12-11 21:05:43.816540: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 7.68 GB
[2022-12-11 21:05:43.816664: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 7.68 GB
[2022-12-11 21:05:43.816972: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 7.68 GB
[2022-12-11 21:05:43.817207: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 7.68 GB
[2022-12-11 21:05:43.817472: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 7.68 GB
[2022-12-11 21:05:44.600665: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 7.87 GB
[2022-12-11 21:05:44.600788: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 7.87 GB
[HCTR][21:05:44.965][ERROR][RK0][tid #139857078773504]: replica 0 calling init per replica done, doing barrier
[HCTR][21:05:44.965][ERROR][RK0][tid #139857070380800]: replica 1 calling init per replica done, doing barrier
[HCTR][21:05:44.965][ERROR][RK0][tid #139857078773504]: replica 3 calling init per replica done, doing barrier
[HCTR][21:05:44.965][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][21:05:44.965][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][21:05:44.965][ERROR][RK0][tid #139857078773504]: replica 0 calling init per replica done, doing barrier done
[HCTR][21:05:44.965][ERROR][RK0][tid #139857078773504]: replica 3 calling init per replica done, doing barrier done
[HCTR][21:05:44.965][ERROR][RK0][tid #139857070380800]: replica 1 calling init per replica done, doing barrier done
[HCTR][21:05:44.965][ERROR][RK0][main]: init per replica done
[HCTR][21:05:44.965][ERROR][RK0][tid #139857078773504]: init per replica done
[HCTR][21:05:44.965][ERROR][RK0][tid #139857070380800]: init per replica done
[HCTR][21:05:44.968][ERROR][RK0][tid #139857078773504]: init per replica done
[HCTR][21:05:44.973][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f20ef720000
[HCTR][21:05:44.973][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f1bd2000000
[HCTR][21:05:44.973][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f1bd2640000
[HCTR][21:05:44.973][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f1bd2960000
[HCTR][21:05:44.973][ERROR][RK0][tid #139857070380800]: 1 allocated 3276800 at 0x7f20eb720000
[HCTR][21:05:44.973][ERROR][RK0][tid #139857070380800]: 1 allocated 6553600 at 0x7f1c32000000
[HCTR][21:05:44.973][ERROR][RK0][tid #139857070380800]: 1 allocated 3276800 at 0x7f1c32640000
[HCTR][21:05:44.973][ERROR][RK0][tid #139857070380800]: 1 allocated 6553600 at 0x7f1c32960000
[HCTR][21:05:44.976][ERROR][RK0][tid #139857078773504]: 3 allocated 3276800 at 0x7f20ef720000
[HCTR][21:05:44.976][ERROR][RK0][tid #139857078773504]: 3 allocated 6553600 at 0x7f1c96000000
[HCTR][21:05:44.976][ERROR][RK0][tid #139857078773504]: 3 allocated 3276800 at 0x7f1c96640000
[HCTR][21:05:44.976][ERROR][RK0][tid #139857078773504]: 3 allocated 6553600 at 0x7f1c96960000
[HCTR][21:05:44.977][ERROR][RK0][tid #139857078773504]: 0 allocated 3276800 at 0x7f1bfe320000
[HCTR][21:05:44.977][ERROR][RK0][tid #139857078773504]: 0 allocated 6553600 at 0x7f1f01600000
[HCTR][21:05:44.977][ERROR][RK0][tid #139857078773504]: 0 allocated 3276800 at 0x7f1bfed0e800
[HCTR][21:05:44.977][ERROR][RK0][tid #139857078773504]: 0 allocated 6553600 at 0x7f1bff02e800




