2022-12-12 02:14:33.266116: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:14:33.284132: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:14:33.369120: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:14:33.369380: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:14:34.150771: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:14:34.150855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:14:34.163106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:14:34.186087: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:14:34.186168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:14:34.196072: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:14:34.196331: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:14:34.198521: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 02:14:34.200032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:14:34.234756: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:14:34.235010: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:14:34.236266: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 02:14:34.240890: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:14:34.240901: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:14:34.240984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:14:34.240984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:14:34.253621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:14:34.255846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:14:34.283603: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:14:34.283779: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:14:34.284651: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 02:14:34.285340: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:14:34.285463: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:14:34.286332: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][02:14:34.562][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:14:35.512][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:14:35.512][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:14:35.562][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 101it [00:01, 90.04it/s]warmup run: 204it [00:01, 196.42it/s]warmup run: 308it [00:01, 313.50it/s]warmup run: 403it [00:01, 418.97it/s]warmup run: 0it [00:00, ?it/s]warmup run: 494it [00:01, 511.64it/s]warmup run: 0it [00:00, ?it/s]warmup run: 603it [00:02, 634.84it/s]warmup run: 1it [00:01,  1.58s/it]warmup run: 710it [00:02, 736.63it/s]warmup run: 104it [00:01, 86.06it/s]warmup run: 817it [00:02, 818.67it/s]warmup run: 208it [00:01, 187.15it/s]warmup run: 919it [00:02, 824.31it/s]warmup run: 310it [00:01, 296.28it/s]warmup run: 1016it [00:02, 851.00it/s]warmup run: 417it [00:01, 418.24it/s]warmup run: 1121it [00:02, 904.67it/s]warmup run: 526it [00:02, 541.70it/s]warmup run: 1227it [00:02, 946.65it/s]warmup run: 636it [00:02, 657.46it/s]warmup run: 1332it [00:02, 975.00it/s]warmup run: 747it [00:02, 760.19it/s]warmup run: 1439it [00:02, 999.96it/s]warmup run: 858it [00:02, 845.17it/s]warmup run: 1546it [00:02, 1020.22it/s]warmup run: 969it [00:02, 912.53it/s]warmup run: 1653it [00:03, 1033.01it/s]warmup run: 1077it [00:02, 951.30it/s]warmup run: 1762it [00:03, 1048.98it/s]warmup run: 1190it [00:02, 999.64it/s]warmup run: 1871it [00:03, 1058.63it/s]warmup run: 1302it [00:02, 1031.90it/s]warmup run: 1978it [00:03, 1050.88it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1it [00:01,  1.50s/it]warmup run: 1415it [00:02, 1058.95it/s]warmup run: 2102it [00:03, 1104.71it/s]warmup run: 108it [00:01, 98.50it/s]warmup run: 102it [00:01, 88.17it/s]warmup run: 1526it [00:02, 1070.27it/s]warmup run: 2237it [00:03, 1175.95it/s]warmup run: 212it [00:01, 207.09it/s]warmup run: 206it [00:01, 193.05it/s]warmup run: 1637it [00:03, 1063.52it/s]warmup run: 2372it [00:03, 1225.80it/s]warmup run: 315it [00:01, 323.39it/s]warmup run: 311it [00:01, 309.36it/s]warmup run: 1746it [00:03, 1058.34it/s]warmup run: 2507it [00:03, 1260.61it/s]warmup run: 413it [00:01, 433.51it/s]warmup run: 406it [00:01, 413.03it/s]warmup run: 1854it [00:03, 1056.35it/s]warmup run: 2641it [00:03, 1282.13it/s]warmup run: 506it [00:01, 527.80it/s]warmup run: 498it [00:02, 507.68it/s]warmup run: 1961it [00:03, 1052.84it/s]warmup run: 2774it [00:03, 1294.56it/s]warmup run: 600it [00:02, 616.28it/s]warmup run: 597it [00:02, 609.11it/s]warmup run: 2080it [00:03, 1092.81it/s]warmup run: 2904it [00:04, 1277.71it/s]warmup run: 694it [00:02, 691.77it/s]warmup run: 692it [00:02, 686.97it/s]warmup run: 2211it [00:03, 1154.79it/s]warmup run: 3000it [00:04, 716.93it/s] warmup run: 791it [00:02, 761.32it/s]warmup run: 786it [00:02, 742.58it/s]warmup run: 2344it [00:03, 1204.95it/s]warmup run: 890it [00:02, 821.10it/s]warmup run: 882it [00:02, 797.74it/s]warmup run: 2478it [00:03, 1242.95it/s]warmup run: 998it [00:02, 890.02it/s]warmup run: 981it [00:02, 848.10it/s]warmup run: 2611it [00:03, 1267.81it/s]warmup run: 1107it [00:02, 944.54it/s]warmup run: 1084it [00:02, 898.23it/s]warmup run: 2748it [00:04, 1296.98it/s]warmup run: 1214it [00:02, 979.64it/s]warmup run: 1191it [00:02, 945.14it/s]warmup run: 2884it [00:04, 1314.48it/s]warmup run: 1321it [00:02, 1004.29it/s]warmup run: 1295it [00:02, 970.77it/s]warmup run: 3000it [00:04, 714.49it/s] warmup run: 1430it [00:02, 1028.44it/s]warmup run: 1397it [00:02, 982.72it/s]warmup run: 1540it [00:02, 1047.36it/s]warmup run: 1503it [00:03, 1004.98it/s]warmup run: 1648it [00:03, 1056.66it/s]warmup run: 1610it [00:03, 1023.92it/s]warmup run: 1756it [00:03, 1063.02it/s]warmup run: 1714it [00:03, 1026.32it/s]warmup run: 1864it [00:03, 1063.69it/s]warmup run: 1820it [00:03, 1036.01it/s]warmup run: 1972it [00:03, 1065.34it/s]warmup run: 1925it [00:03, 1032.66it/s]warmup run: 2097it [00:03, 1118.90it/s]warmup run: 2037it [00:03, 1058.31it/s]warmup run: 2229it [00:03, 1177.78it/s]warmup run: 2170it [00:03, 1137.07it/s]warmup run: 2361it [00:03, 1219.72it/s]warmup run: 2303it [00:03, 1193.17it/s]warmup run: 2492it [00:03, 1245.66it/s]warmup run: 2437it [00:03, 1235.20it/s]warmup run: 2621it [00:03, 1257.37it/s]warmup run: 2570it [00:03, 1263.08it/s]warmup run: 2751it [00:03, 1264.42it/s]warmup run: 2703it [00:04, 1280.27it/s]warmup run: 2880it [00:04, 1269.33it/s]warmup run: 2836it [00:04, 1292.67it/s]warmup run: 3000it [00:04, 726.00it/s] warmup run: 2972it [00:04, 1310.74it/s]warmup run: 3000it [00:04, 705.53it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   4%|▍         | 130/3000 [00:00<00:02, 1298.65it/s]warmup should be done:   5%|▍         | 139/3000 [00:00<00:02, 1382.63it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1691.38it/s]warmup should be done:   5%|▍         | 146/3000 [00:00<00:01, 1452.79it/s]warmup should be done:  10%|█         | 310/3000 [00:00<00:01, 1592.81it/s]warmup should be done:  11%|█         | 322/3000 [00:00<00:01, 1643.28it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1736.97it/s]warmup should be done:  10%|█         | 314/3000 [00:00<00:01, 1583.30it/s]warmup should be done:  16%|█▋        | 489/3000 [00:00<00:01, 1679.67it/s]warmup should be done:  17%|█▋        | 504/3000 [00:00<00:01, 1719.77it/s]warmup should be done:  17%|█▋        | 521/3000 [00:00<00:01, 1732.66it/s]warmup should be done:  16%|█▌        | 480/3000 [00:00<00:01, 1614.14it/s]warmup should be done:  22%|██▏       | 668/3000 [00:00<00:01, 1721.81it/s]warmup should be done:  23%|██▎       | 678/3000 [00:00<00:01, 1726.12it/s]warmup should be done:  23%|██▎       | 696/3000 [00:00<00:01, 1738.96it/s]warmup should be done:  22%|██▏       | 646/3000 [00:00<00:01, 1631.03it/s]warmup should be done:  28%|██▊       | 847/3000 [00:00<00:01, 1743.20it/s]warmup should be done:  29%|██▊       | 859/3000 [00:00<00:01, 1753.63it/s]warmup should be done:  27%|██▋       | 814/3000 [00:00<00:01, 1647.82it/s]warmup should be done:  29%|██▉       | 870/3000 [00:00<00:01, 1703.78it/s]warmup should be done:  35%|███▍      | 1039/3000 [00:00<00:01, 1766.20it/s]warmup should be done:  33%|███▎      | 982/3000 [00:00<00:01, 1656.44it/s]warmup should be done:  34%|███▍      | 1022/3000 [00:00<00:01, 1712.11it/s]warmup should be done:  35%|███▍      | 1041/3000 [00:00<00:01, 1700.45it/s]warmup should be done:  41%|████      | 1217/3000 [00:00<00:01, 1769.54it/s]warmup should be done:  38%|███▊      | 1150/3000 [00:00<00:01, 1661.87it/s]warmup should be done:  40%|████      | 1201/3000 [00:00<00:01, 1735.05it/s]warmup should be done:  40%|████      | 1213/3000 [00:00<00:01, 1706.64it/s]warmup should be done:  46%|████▋     | 1394/3000 [00:00<00:00, 1765.79it/s]warmup should be done:  44%|████▍     | 1317/3000 [00:00<00:01, 1661.65it/s]warmup should be done:  46%|████▌     | 1381/3000 [00:00<00:00, 1753.14it/s]warmup should be done:  46%|████▌     | 1385/3000 [00:00<00:00, 1709.78it/s]warmup should be done:  52%|█████▏    | 1572/3000 [00:00<00:00, 1768.74it/s]warmup should be done:  49%|████▉     | 1484/3000 [00:00<00:00, 1659.28it/s]warmup should be done:  52%|█████▏    | 1561/3000 [00:00<00:00, 1767.41it/s]warmup should be done:  52%|█████▏    | 1560/3000 [00:00<00:00, 1721.21it/s]warmup should be done:  55%|█████▌    | 1650/3000 [00:01<00:00, 1642.44it/s]warmup should be done:  58%|█████▊    | 1741/3000 [00:01<00:00, 1776.67it/s]warmup should be done:  58%|█████▊    | 1749/3000 [00:01<00:00, 1741.86it/s]warmup should be done:  58%|█████▊    | 1735/3000 [00:01<00:00, 1729.62it/s]warmup should be done:  64%|██████▍   | 1921/3000 [00:01<00:00, 1781.56it/s]warmup should be done:  64%|██████▍   | 1927/3000 [00:01<00:00, 1752.25it/s]warmup should be done:  64%|██████▎   | 1910/3000 [00:01<00:00, 1734.98it/s]warmup should be done:  60%|██████    | 1815/3000 [00:01<00:00, 1630.44it/s]warmup should be done:  70%|███████   | 2105/3000 [00:01<00:00, 1759.79it/s]warmup should be done:  70%|███████   | 2101/3000 [00:01<00:00, 1784.29it/s]warmup should be done:  69%|██████▉   | 2084/3000 [00:01<00:00, 1735.56it/s]warmup should be done:  66%|██████▌   | 1979/3000 [00:01<00:00, 1613.98it/s]warmup should be done:  76%|███████▌  | 2283/3000 [00:01<00:00, 1764.44it/s]warmup should be done:  76%|███████▌  | 2280/3000 [00:01<00:00, 1782.33it/s]warmup should be done:  75%|███████▌  | 2258/3000 [00:01<00:00, 1704.09it/s]warmup should be done:  71%|███████▏  | 2141/3000 [00:01<00:00, 1599.41it/s]warmup should be done:  82%|████████▏ | 2462/3000 [00:01<00:00, 1771.51it/s]warmup should be done:  82%|████████▏ | 2461/3000 [00:01<00:00, 1788.03it/s]warmup should be done:  81%|████████  | 2435/3000 [00:01<00:00, 1722.73it/s]warmup should be done:  77%|███████▋  | 2306/3000 [00:01<00:00, 1612.25it/s]warmup should be done:  88%|████████▊ | 2640/3000 [00:01<00:00, 1773.75it/s]warmup should be done:  87%|████████▋ | 2613/3000 [00:01<00:00, 1739.73it/s]warmup should be done:  82%|████████▏ | 2472/3000 [00:01<00:00, 1624.27it/s]warmup should be done:  88%|████████▊ | 2640/3000 [00:01<00:00, 1708.77it/s]warmup should be done:  94%|█████████▍| 2818/3000 [00:01<00:00, 1738.34it/s]warmup should be done:  93%|█████████▎| 2788/3000 [00:01<00:00, 1738.92it/s]warmup should be done:  88%|████████▊ | 2635/3000 [00:01<00:00, 1613.63it/s]warmup should be done:  94%|█████████▍| 2814/3000 [00:01<00:00, 1716.21it/s]warmup should be done: 100%|█████████▉| 2994/3000 [00:01<00:00, 1744.24it/s]warmup should be done:  99%|█████████▉| 2966/3000 [00:01<00:00, 1749.91it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1743.72it/s]warmup should be done:  93%|█████████▎| 2797/3000 [00:01<00:00, 1592.18it/s]warmup should be done: 100%|█████████▉| 2987/3000 [00:01<00:00, 1713.65it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1728.81it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1728.16it/s]warmup should be done:  99%|█████████▊| 2962/3000 [00:01<00:00, 1608.61it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1622.18it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1679.91it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1729.30it/s]warmup should be done:   5%|▌         | 159/3000 [00:00<00:01, 1587.56it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1724.22it/s]warmup should be done:  11%|█         | 335/3000 [00:00<00:01, 1687.01it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1778.32it/s]warmup should be done:  11%|█         | 336/3000 [00:00<00:01, 1666.71it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1787.10it/s]warmup should be done:  17%|█▋        | 514/3000 [00:00<00:01, 1732.70it/s]warmup should be done:  18%|█▊        | 535/3000 [00:00<00:01, 1785.82it/s]warmup should be done:  17%|█▋        | 504/3000 [00:00<00:01, 1668.49it/s]warmup should be done:  18%|█▊        | 540/3000 [00:00<00:01, 1802.93it/s]warmup should be done:  24%|██▍       | 718/3000 [00:00<00:01, 1802.60it/s]warmup should be done:  22%|██▏       | 673/3000 [00:00<00:01, 1675.75it/s]warmup should be done:  24%|██▍       | 723/3000 [00:00<00:01, 1813.17it/s]warmup should be done:  23%|██▎       | 688/3000 [00:00<00:01, 1697.65it/s]warmup should be done:  30%|███       | 902/3000 [00:00<00:01, 1813.22it/s]warmup should be done:  28%|██▊       | 841/3000 [00:00<00:01, 1675.64it/s]warmup should be done:  30%|███       | 905/3000 [00:00<00:01, 1803.99it/s]warmup should be done:  29%|██▉       | 868/3000 [00:00<00:01, 1731.02it/s]warmup should be done:  36%|███▌      | 1086/3000 [00:00<00:01, 1821.49it/s]warmup should be done:  34%|███▍      | 1020/3000 [00:00<00:01, 1712.76it/s]warmup should be done:  36%|███▋      | 1088/3000 [00:00<00:01, 1811.86it/s]warmup should be done:  35%|███▍      | 1046/3000 [00:00<00:01, 1744.69it/s]warmup should be done:  42%|████▏     | 1269/3000 [00:00<00:00, 1820.36it/s]warmup should be done:  40%|███▉      | 1196/3000 [00:00<00:01, 1725.50it/s]warmup should be done:  41%|████      | 1223/3000 [00:00<00:01, 1751.42it/s]warmup should be done:  42%|████▏     | 1270/3000 [00:00<00:00, 1789.10it/s]warmup should be done:  46%|████▌     | 1372/3000 [00:00<00:00, 1733.52it/s]warmup should be done:  48%|████▊     | 1452/3000 [00:00<00:00, 1786.21it/s]warmup should be done:  47%|████▋     | 1399/3000 [00:00<00:00, 1714.94it/s]warmup should be done:  48%|████▊     | 1449/3000 [00:00<00:00, 1572.07it/s]warmup should be done:  52%|█████▏    | 1557/3000 [00:00<00:00, 1768.70it/s]warmup should be done:  54%|█████▍    | 1634/3000 [00:00<00:00, 1796.03it/s]warmup should be done:  52%|█████▏    | 1571/3000 [00:00<00:00, 1700.19it/s]warmup should be done:  54%|█████▍    | 1631/3000 [00:00<00:00, 1640.01it/s]warmup should be done:  58%|█████▊    | 1742/3000 [00:01<00:00, 1791.32it/s]warmup should be done:  61%|██████    | 1816/3000 [00:01<00:00, 1802.96it/s]warmup should be done:  58%|█████▊    | 1747/3000 [00:01<00:00, 1716.84it/s]warmup should be done:  61%|██████    | 1817/3000 [00:01<00:00, 1702.65it/s]warmup should be done:  64%|██████▍   | 1927/3000 [00:01<00:00, 1809.21it/s]warmup should be done:  67%|██████▋   | 1997/3000 [00:01<00:00, 1804.75it/s]warmup should be done:  64%|██████▍   | 1924/3000 [00:01<00:00, 1729.95it/s]warmup should be done:  67%|██████▋   | 1999/3000 [00:01<00:00, 1736.08it/s]warmup should be done:  70%|███████   | 2109/3000 [00:01<00:00, 1811.89it/s]warmup should be done:  73%|███████▎  | 2179/3000 [00:01<00:00, 1807.07it/s]warmup should be done:  70%|██████▉   | 2098/3000 [00:01<00:00, 1693.03it/s]warmup should be done:  73%|███████▎  | 2183/3000 [00:01<00:00, 1766.19it/s]warmup should be done:  76%|███████▋  | 2295/3000 [00:01<00:00, 1824.93it/s]warmup should be done:  79%|███████▊  | 2360/3000 [00:01<00:00, 1804.51it/s]warmup should be done:  76%|███████▌  | 2268/3000 [00:01<00:00, 1614.48it/s]warmup should be done:  79%|███████▉  | 2369/3000 [00:01<00:00, 1791.91it/s]warmup should be done:  83%|████████▎ | 2478/3000 [00:01<00:00, 1822.78it/s]warmup should be done:  85%|████████▍ | 2541/3000 [00:01<00:00, 1798.53it/s]warmup should be done:  81%|████████▏ | 2441/3000 [00:01<00:00, 1645.57it/s]warmup should be done:  85%|████████▌ | 2551/3000 [00:01<00:00, 1798.51it/s]warmup should be done:  89%|████████▊ | 2662/3000 [00:01<00:00, 1827.32it/s]warmup should be done:  91%|█████████ | 2721/3000 [00:01<00:00, 1790.70it/s]warmup should be done:  87%|████████▋ | 2607/3000 [00:01<00:00, 1631.89it/s]warmup should be done:  91%|█████████ | 2732/3000 [00:01<00:00, 1762.28it/s]warmup should be done:  95%|█████████▌| 2850/3000 [00:01<00:00, 1840.37it/s]warmup should be done:  97%|█████████▋| 2901/3000 [00:01<00:00, 1775.35it/s]warmup should be done:  93%|█████████▎| 2780/3000 [00:01<00:00, 1658.15it/s]warmup should be done:  97%|█████████▋| 2909/3000 [00:01<00:00, 1754.56it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1794.24it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1777.72it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1749.32it/s]warmup should be done:  98%|█████████▊| 2954/3000 [00:01<00:00, 1680.26it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1689.85it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fb733f2e1f0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fb733f2e100>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fb733f2e0a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fb733f2d190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-12 02:15:46.128951: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fb309a654b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:15:46.129026: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:15:46.135213: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fb309a68600 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:15:46.135330: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:15:46.139936: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:15:46.142528: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:15:46.224521: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fb309a6efe0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:15:46.224588: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:15:46.234965: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:15:46.585258: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fb309a6be80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:15:46.585324: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:15:46.594076: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:15:46.989626: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:15:47.050731: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:15:47.094667: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:15:47.235963: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:15:52.205015: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:15:53.303872: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:15:53.357880: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:15:53.543776: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][02:16:45.257][ERROR][RK0][tid #140407103022848]: replica 3 reaches 1000, calling init pre replica
[HCTR][02:16:45.257][ERROR][RK0][tid #140407103022848]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:16:45.262][ERROR][RK0][tid #140407103022848]: coll ps creation done
[HCTR][02:16:45.262][ERROR][RK0][tid #140407103022848]: replica 3 waits for coll ps creation barrier
[HCTR][02:16:45.717][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][02:16:45.717][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:16:45.721][ERROR][RK0][main]: coll ps creation done
[HCTR][02:16:45.721][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][02:16:45.801][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][02:16:45.801][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:16:45.804][ERROR][RK0][main]: coll ps creation done
[HCTR][02:16:45.804][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][02:16:45.894][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][02:16:45.894][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:16:45.897][ERROR][RK0][main]: coll ps creation done
[HCTR][02:16:45.897][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][02:16:45.897][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][02:16:46.882][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][02:16:46.922][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][02:16:46.922][ERROR][RK0][tid #140407103022848]: replica 3 calling init per replica
[HCTR][02:16:46.922][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][02:16:46.922][ERROR][RK0][tid #140407103022848]: Calling build_v2
[HCTR][02:16:46.922][ERROR][RK0][main]: Calling build_v2
[HCTR][02:16:46.922][ERROR][RK0][main]: Calling build_v2
[HCTR][02:16:46.922][ERROR][RK0][tid #140407103022848]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:16:46.922][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:16:46.922][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-12 02:16:46.[922697: E 2022-12-12 02:16:46/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc.:922729136: ] Eusing concurrent impl MPS 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136[] using concurrent impl MPS
2022-12-12 02:16:46.922755: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[HCTR][02:16:46.923][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][02:16:46.923][ERROR][RK0][main]: Calling build_v2
[HCTR][02:16:46.923][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-12 02:16:46.923488: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-12 02:16:46.923886: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-12 02:16:46.924010: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196[] 2022-12-12 02:16:46assigning 8 to cpu.
924027: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 02:16:46.924096[: 2022-12-12 02:16:46E. 924107/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E212 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4:
213] remote time is 8.68421
[2022-12-12 02:16:46[.2022-12-12 02:16:46924161.[: 924166E2022-12-12 02:16:46:  .E924146/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc : :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE213: ] 214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421] :
cpu time is 30196
[] 2022-12-12 02:16:46assigning 8 to cpu.
924279: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[[2022-12-12 02:16:462022-12-12 02:16:46..924332924342: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::212196] ] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4assigning 8 to cpu

[2022-12-12 02:16:46.924492: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 02:16:46.924574: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30[
2022-12-12 02:16:46.924608: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 02:16:46.924705: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 02:16:46.924757: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 02:17:11.180927: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 02:17:11.238897: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 02:17:11.238998: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 02:17:11.240483: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 02:17:11.331882: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 02:17:11.707876: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 02:17:11.707972: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 02:17:19. 90799: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 02:17:19. 90922: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 02:17:20.820972: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 02:17:20.821092: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 02:17:20.835787: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 02:17:20.835861: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 02:17:21.892656: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 02:17:21.911435: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 02:17:21.912334: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 02:17:21.922714: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 02:17:22. 17101: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 02:17:28.508742: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 02:17:28.514360: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 02:17:28.514729: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 02:17:28.525533: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 02:17:28.525613: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 02:17:28.525647: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 02:17:28.525677: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 02:17:28.529060: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:17:28.529115: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:17:28.530848: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:17:28.531429: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-12 02:17:28.5521442022-12-12 02:17:28: .E552168 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 202/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :2 solved202
] 1 solved
[2022-12-12 02:17:28.[5522752022-12-12 02:17:28: .E552281 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 205/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :worker 0 thread 2 initing device 2205
] worker 0 thread 1 initing device 1
[2022-12-12 02:17:28.552375: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 02:17:28.552489: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 02:17:28.552985: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:17:28.553044: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:17:28.553206: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:17:28.553257: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:17:28.553347: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:17:28.553403: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:17:28.555101: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:17:28.555212: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:17:28.555261: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:17:28.557311: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:17:28.557423: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:17:28.557916: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:17:28.607993: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 02:17:28.609857: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 02:17:28.609909: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:17:28.610729: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 02:17:28.611308: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:17:28.612296: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:28.612341: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.02 MB
[2022-12-12 02:17:28.618675: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 02:17:28.620495: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 02:17:28.620543: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:17:28.621341: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 02:17:28.621836: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:17:28.622805: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:28.622848: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 60.99 MB
[2022-12-12 02:17:28.635354: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 02:17:28.637188: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 02:17:28.637237: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:17:28.638009: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 02:17:28.638468: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:17:28.639475: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:28.639520: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.00 MB
[2022-12-12 02:17:28.643913: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:17:28.644511: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:17:28.644554: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 02:17:28.651185: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:17:28.651759: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:17:28.651799: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 02:17:28.665153: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 02:17:28.666940: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 02:17:28.667001: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:17:28.668471: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:17:28.669061: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:17:28.669101: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 02:17:28.709541: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 02:17:28.711155: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:17:28.712260: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:28.712359: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.01 MB
[2022-12-12 02:17:28.744466: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:17:28.745058: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:17:28.745099: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[[[2022-12-12 02:17:292022-12-12 02:17:292022-12-12 02:17:29...[425693425695425696: 2022-12-12 02:17:29: : E.E425745E  :  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:: :19261926/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1926] ] :] Device 0 init p2p of link 1Device 3 init p2p of link 01926Device 2 init p2p of link 3

] 
Device 1 init p2p of link 2
[2022-12-12 02:17:29.426004: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-12 02:17:292022-12-12 02:17:29..426102426114: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[2022-12-12 02:17:29.426821: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:29.426984: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:29.427066: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:29.427459: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:17:29.428441: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:29.432678: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 02:17:29.432793: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:17:29.433448: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 02:17:29.433554: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:17:29.433616: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:29.434153: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-12 02:17:29.434356: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:29.434392: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB[
2022-12-12 02:17:29.434478: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-12 02:17:29.434586: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:17:29.435360: E[ 2022-12-12 02:17:29/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:435399638: ] Eeager release cuda mem 625663 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:29.439367: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 02:17:29.439463: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:17:29.440279[: 2022-12-12 02:17:29E. 440281/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :E638 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager release cuda mem 625663:
1926] Device 3 init p2p of link 2
[2022-12-12 02:17:29.440379: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:17:29.441191: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:29.441458: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 02:17:29.441542: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:17:29.441576: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 02:17:29.441669: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:17:29.442342: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:29.442492: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:17:29.445715: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 02:17:29.446018: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15992722 / 100000000 nodes ( 15.99 %~16.00 %) | remote 34434651 / 100000000 nodes ( 34.43 %) | cpu 49572627 / 100000000 nodes ( 49.57 %) | 7.63 GB | 0.892993 secs 
[2022-12-12 02:17:29.446442: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 02:17:29.446775: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15988449 / 100000000 nodes ( 15.99 %~16.00 %) | remote 34438924 / 100000000 nodes ( 34.44 %) | cpu 49572627 / 100000000 nodes ( 49.57 %) | 7.63 GB | 0.893531 secs 
[2022-12-12 02:17:29.447800: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 02:17:29.448172: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 02:17:29.448295: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15994775 / 100000000 nodes ( 15.99 %~16.00 %) | remote 34432598 / 100000000 nodes ( 34.43 %) | cpu 49572627 / 100000000 nodes ( 49.57 %) | 7.63 GB | 0.919188 secs 
[2022-12-12 02:17:29.448517: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15990352 / 100000000 nodes ( 15.99 %~16.00 %) | remote 34437021 / 100000000 nodes ( 34.44 %) | cpu 49572627 / 100000000 nodes ( 49.57 %) | 7.63 GB | 0.89513 secs 
[2022-12-12 02:17:29.450018: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.33 GB
[2022-12-12 02:17:30.451632: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.58 GB
[2022-12-12 02:17:30.452123: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.58 GB
[2022-12-12 02:17:30.452512: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.58 GB
[2022-12-12 02:17:31.241981: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.82 GB
[2022-12-12 02:17:31.242287: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.82 GB
[2022-12-12 02:17:31.243134: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.82 GB
[2022-12-12 02:17:32. 67641: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 15.07 GB
[2022-12-12 02:17:32. 68027: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 15.07 GB
[2022-12-12 02:17:32. 68417: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 15.07 GB
[2022-12-12 02:17:32.890106: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 15.48 GB
[2022-12-12 02:17:32.890338: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 15.48 GB
[2022-12-12 02:17:32.890770: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 15.48 GB
[2022-12-12 02:17:33.624607: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 15.67 GB
[2022-12-12 02:17:33.624742: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 15.67 GB
[HCTR][02:17:33.651][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][02:17:33.651][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][02:17:33.651][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][02:17:33.651][ERROR][RK0][tid #140407103022848]: replica 3 calling init per replica done, doing barrier
[HCTR][02:17:33.651][ERROR][RK0][tid #140407103022848]: replica 3 calling init per replica done, doing barrier done
[HCTR][02:17:33.651][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][02:17:33.651][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][02:17:33.651][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][02:17:33.651][ERROR][RK0][tid #140407103022848]: init per replica done
[HCTR][02:17:33.651][ERROR][RK0][main]: init per replica done
[HCTR][02:17:33.651][ERROR][RK0][main]: init per replica done
[HCTR][02:17:33.654][ERROR][RK0][main]: init per replica done
[HCTR][02:17:33.686][ERROR][RK0][tid #140407103022848]: 2 allocated 3276800 at 0x7f9768238400
[HCTR][02:17:33.686][ERROR][RK0][tid #140407103022848]: 2 allocated 6553600 at 0x7f9768558400
[HCTR][02:17:33.686][ERROR][RK0][tid #140407103022848]: 2 allocated 3276800 at 0x7f9768b98400
[HCTR][02:17:33.686][ERROR][RK0][tid #140407103022848]: 2 allocated 6553600 at 0x7f9768eb8400
[HCTR][02:17:33.687][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f97f4238400
[HCTR][02:17:33.687][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f97f4558400
[HCTR][02:17:33.687][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f97f4b98400
[HCTR][02:17:33.687][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f97f4eb8400
[HCTR][02:17:33.688][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f97e0238400
[HCTR][02:17:33.688][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f97e0558400
[HCTR][02:17:33.688][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f97e0b98400
[HCTR][02:17:33.688][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f97e0eb8400
[HCTR][02:17:33.690][ERROR][RK0][tid #140407103022848]: 0 allocated 3276800 at 0x7f9822320000
[HCTR][02:17:33.691][ERROR][RK0][tid #140407103022848]: 0 allocated 6553600 at 0x7f9822640000
[HCTR][02:17:33.691][ERROR][RK0][tid #140407103022848]: 0 allocated 3276800 at 0x7f9822c80000
[HCTR][02:17:33.691][ERROR][RK0][tid #140407103022848]: 0 allocated 6553600 at 0x7f9822fa0000
