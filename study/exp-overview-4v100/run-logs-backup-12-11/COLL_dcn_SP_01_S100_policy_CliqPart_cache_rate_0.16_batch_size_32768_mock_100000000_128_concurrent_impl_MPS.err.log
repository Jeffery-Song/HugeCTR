2022-12-12 02:00:58.652234: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:00:58.661316: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:00:58.750777: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:00:58.781470: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:00:59.581214: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:00:59.581293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:00:59.593731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:00:59.594094: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:00:59.594172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:00:59.606195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:00:59.622830: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:00:59.622908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:00:59.624669: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:00:59.624822: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:00:59.625693: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 02:00:59.630183: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:00:59.630255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:00:59.634836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:00:59.637306: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:00:59.637440: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:00:59.639063: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 02:00:59.642132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:00:59.666869: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:00:59.667046: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:00:59.667932: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 02:00:59.672521: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:00:59.672669: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:00:59.673480: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][02:01:00.910][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:01:00.923][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:01:00.950][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:01:00.957][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.47s/it]warmup run: 111it [00:01, 98.11it/s]warmup run: 222it [00:01, 211.69it/s]warmup run: 333it [00:01, 335.88it/s]warmup run: 440it [00:01, 456.49it/s]warmup run: 1it [00:01,  1.46s/it]warmup run: 548it [00:01, 574.70it/s]warmup run: 107it [00:01, 94.84it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 663it [00:02, 696.90it/s]warmup run: 215it [00:01, 205.69it/s]warmup run: 109it [00:01, 100.20it/s]warmup run: 776it [00:02, 798.11it/s]warmup run: 323it [00:01, 326.71it/s]warmup run: 219it [00:01, 216.42it/s]warmup run: 887it [00:02, 875.89it/s]warmup run: 431it [00:01, 450.88it/s]warmup run: 331it [00:01, 344.71it/s]warmup run: 1001it [00:02, 943.41it/s]warmup run: 540it [00:01, 572.23it/s]warmup run: 438it [00:01, 466.87it/s]warmup run: 1112it [00:02, 973.92it/s]warmup run: 649it [00:02, 682.04it/s]warmup run: 545it [00:01, 583.95it/s]warmup run: 1221it [00:02, 1003.72it/s]warmup run: 759it [00:02, 778.90it/s]warmup run: 648it [00:02, 680.69it/s]warmup run: 1330it [00:02, 1025.39it/s]warmup run: 868it [00:02, 855.13it/s]warmup run: 756it [00:02, 773.79it/s]warmup run: 1439it [00:02, 1028.74it/s]warmup run: 975it [00:02, 910.35it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 860it [00:02, 839.31it/s]warmup run: 1546it [00:02, 1035.54it/s]warmup run: 1082it [00:02, 945.43it/s]warmup run: 105it [00:01, 95.63it/s]warmup run: 964it [00:02, 882.50it/s]warmup run: 1654it [00:02, 1046.40it/s]warmup run: 1191it [00:02, 985.02it/s]warmup run: 207it [00:01, 202.24it/s]warmup run: 1074it [00:02, 941.14it/s]warmup run: 1761it [00:03, 1033.91it/s]warmup run: 1298it [00:02, 1002.11it/s]warmup run: 314it [00:01, 324.94it/s]warmup run: 1184it [00:02, 984.44it/s]warmup run: 1868it [00:03, 1041.32it/s]warmup run: 1404it [00:02, 1009.67it/s]warmup run: 421it [00:01, 450.18it/s]warmup run: 1294it [00:02, 1015.99it/s]warmup run: 1975it [00:03, 1046.70it/s]warmup run: 1510it [00:02, 1021.89it/s]warmup run: 530it [00:01, 573.43it/s]warmup run: 1402it [00:02, 1027.68it/s]warmup run: 2103it [00:03, 1113.27it/s]warmup run: 1617it [00:02, 1035.63it/s]warmup run: 639it [00:02, 684.12it/s]warmup run: 1511it [00:02, 1044.40it/s]warmup run: 2238it [00:03, 1182.43it/s]warmup run: 1725it [00:03, 1047.44it/s]warmup run: 742it [00:02, 762.22it/s]warmup run: 1620it [00:02, 1056.38it/s]warmup run: 2372it [00:03, 1229.06it/s]warmup run: 1832it [00:03, 1053.24it/s]warmup run: 847it [00:02, 832.98it/s]warmup run: 1729it [00:03, 1064.59it/s]warmup run: 2506it [00:03, 1261.84it/s]warmup run: 1940it [00:03, 1058.92it/s]warmup run: 954it [00:02, 895.25it/s]warmup run: 1838it [00:03, 1071.40it/s]warmup run: 2642it [00:03, 1289.17it/s]warmup run: 2059it [00:03, 1095.70it/s]warmup run: 1062it [00:02, 943.91it/s]warmup run: 1947it [00:03, 1076.29it/s]warmup run: 2776it [00:03, 1303.08it/s]warmup run: 2193it [00:03, 1167.32it/s]warmup run: 1176it [00:02, 998.20it/s]warmup run: 2067it [00:03, 1113.07it/s]warmup run: 2911it [00:03, 1316.33it/s]warmup run: 2329it [00:03, 1222.95it/s]warmup run: 1287it [00:02, 1027.76it/s]warmup run: 2202it [00:03, 1182.01it/s]warmup run: 3000it [00:04, 737.04it/s] warmup run: 2458it [00:03, 1241.84it/s]warmup run: 1401it [00:02, 1058.77it/s]warmup run: 2339it [00:03, 1236.27it/s]warmup run: 2594it [00:03, 1276.35it/s]warmup run: 1511it [00:02, 1059.78it/s]warmup run: 2476it [00:03, 1275.25it/s]warmup run: 2729it [00:03, 1297.71it/s]warmup run: 1620it [00:02, 1058.54it/s]warmup run: 2613it [00:03, 1302.60it/s]warmup run: 2864it [00:03, 1312.83it/s]warmup run: 1728it [00:03, 1064.62it/s]warmup run: 2749it [00:03, 1318.68it/s]warmup run: 2999it [00:04, 1321.82it/s]warmup run: 3000it [00:04, 733.12it/s] warmup run: 1837it [00:03, 1069.30it/s]warmup run: 2885it [00:03, 1328.92it/s]warmup run: 1945it [00:03, 1071.53it/s]warmup run: 3000it [00:04, 747.12it/s] warmup run: 2068it [00:03, 1117.54it/s]warmup run: 2202it [00:03, 1181.40it/s]warmup run: 2336it [00:03, 1228.52it/s]warmup run: 2469it [00:03, 1258.79it/s]warmup run: 2605it [00:03, 1279.72it/s]warmup run: 2741it [00:03, 1301.45it/s]warmup run: 2872it [00:03, 1301.89it/s]warmup run: 3000it [00:04, 741.62it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1772.80it/s]warmup should be done:   5%|▍         | 149/3000 [00:00<00:01, 1487.98it/s]warmup should be done:   5%|▌         | 160/3000 [00:00<00:01, 1597.42it/s]warmup should be done:   5%|▍         | 149/3000 [00:00<00:01, 1485.00it/s]warmup should be done:  11%|█▏        | 339/3000 [00:00<00:01, 1709.08it/s]warmup should be done:  11%|█         | 333/3000 [00:00<00:01, 1692.76it/s]warmup should be done:  12%|█▏        | 361/3000 [00:00<00:01, 1802.36it/s]warmup should be done:  11%|█         | 329/3000 [00:00<00:01, 1666.38it/s]warmup should be done:  17%|█▋        | 517/3000 [00:00<00:01, 1739.44it/s]warmup should be done:  17%|█▋        | 513/3000 [00:00<00:01, 1739.36it/s]warmup should be done:  18%|█▊        | 542/3000 [00:00<00:01, 1779.42it/s]warmup should be done:  17%|█▋        | 504/3000 [00:00<00:01, 1701.31it/s]warmup should be done:  23%|██▎       | 695/3000 [00:00<00:01, 1770.47it/s]warmup should be done:  23%|██▎       | 695/3000 [00:00<00:01, 1753.22it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1779.09it/s]warmup should be done:  23%|██▎       | 682/3000 [00:00<00:01, 1728.78it/s]warmup should be done:  29%|██▉       | 873/3000 [00:00<00:01, 1760.67it/s]warmup should be done:  29%|██▉       | 873/3000 [00:00<00:01, 1756.64it/s]warmup should be done:  29%|██▊       | 857/3000 [00:00<00:01, 1735.03it/s]warmup should be done:  30%|██▉       | 898/3000 [00:00<00:01, 1765.09it/s]warmup should be done:  35%|███▌      | 1051/3000 [00:00<00:01, 1766.54it/s]warmup should be done:  34%|███▍      | 1032/3000 [00:00<00:01, 1739.38it/s]warmup should be done:  36%|███▌      | 1077/3000 [00:00<00:01, 1773.29it/s]warmup should be done:  35%|███▍      | 1049/3000 [00:00<00:01, 1732.00it/s]warmup should be done:  41%|████      | 1228/3000 [00:00<00:01, 1766.24it/s]warmup should be done:  40%|████      | 1206/3000 [00:00<00:01, 1738.40it/s]warmup should be done:  42%|████▏     | 1255/3000 [00:00<00:00, 1766.44it/s]warmup should be done:  41%|████      | 1230/3000 [00:00<00:01, 1754.12it/s]warmup should be done:  47%|████▋     | 1406/3000 [00:00<00:00, 1769.88it/s]warmup should be done:  46%|████▌     | 1384/3000 [00:00<00:00, 1749.13it/s]warmup should be done:  48%|████▊     | 1433/3000 [00:00<00:00, 1770.61it/s]warmup should be done:  47%|████▋     | 1411/3000 [00:00<00:00, 1768.91it/s]warmup should be done:  53%|█████▎    | 1584/3000 [00:00<00:00, 1772.13it/s]warmup should be done:  52%|█████▏    | 1566/3000 [00:00<00:00, 1768.46it/s]warmup should be done:  54%|█████▎    | 1611/3000 [00:00<00:00, 1767.14it/s]warmup should be done:  53%|█████▎    | 1592/3000 [00:00<00:00, 1780.68it/s]warmup should be done:  59%|█████▉    | 1763/3000 [00:01<00:00, 1775.29it/s]warmup should be done:  58%|█████▊    | 1748/3000 [00:01<00:00, 1782.11it/s]warmup should be done:  59%|█████▉    | 1773/3000 [00:01<00:00, 1789.04it/s]warmup should be done:  60%|█████▉    | 1792/3000 [00:01<00:00, 1777.50it/s]warmup should be done:  65%|██████▍   | 1942/3000 [00:01<00:00, 1777.42it/s]warmup should be done:  64%|██████▍   | 1928/3000 [00:01<00:00, 1786.55it/s]warmup should be done:  65%|██████▌   | 1954/3000 [00:01<00:00, 1794.75it/s]warmup should be done:  66%|██████▌   | 1973/3000 [00:01<00:00, 1784.53it/s]warmup should be done:  71%|███████   | 2120/3000 [00:01<00:00, 1776.40it/s]warmup should be done:  70%|███████   | 2108/3000 [00:01<00:00, 1788.46it/s]warmup should be done:  71%|███████   | 2135/3000 [00:01<00:00, 1797.55it/s]warmup should be done:  72%|███████▏  | 2152/3000 [00:01<00:00, 1783.37it/s]warmup should be done:  77%|███████▋  | 2299/3000 [00:01<00:00, 1778.98it/s]warmup should be done:  76%|███████▋  | 2289/3000 [00:01<00:00, 1792.08it/s]warmup should be done:  77%|███████▋  | 2316/3000 [00:01<00:00, 1800.51it/s]warmup should be done:  78%|███████▊  | 2331/3000 [00:01<00:00, 1784.49it/s]warmup should be done:  83%|████████▎ | 2479/3000 [00:01<00:00, 1784.17it/s]warmup should be done:  82%|████████▏ | 2470/3000 [00:01<00:00, 1795.73it/s]warmup should be done:  83%|████████▎ | 2498/3000 [00:01<00:00, 1804.46it/s]warmup should be done:  84%|████████▍ | 2513/3000 [00:01<00:00, 1792.38it/s]warmup should be done:  89%|████████▊ | 2659/3000 [00:01<00:00, 1787.49it/s]warmup should be done:  88%|████████▊ | 2650/3000 [00:01<00:00, 1789.81it/s]warmup should be done:  89%|████████▉ | 2680/3000 [00:01<00:00, 1807.64it/s]warmup should be done:  90%|████████▉ | 2693/3000 [00:01<00:00, 1788.39it/s]warmup should be done:  95%|█████████▍| 2839/3000 [00:01<00:00, 1788.37it/s]warmup should be done:  94%|█████████▍| 2830/3000 [00:01<00:00, 1792.13it/s]warmup should be done:  95%|█████████▌| 2862/3000 [00:01<00:00, 1810.01it/s]warmup should be done:  96%|█████████▌| 2874/3000 [00:01<00:00, 1793.87it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1782.93it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1778.59it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1770.52it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1764.22it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 187/3000 [00:00<00:01, 1869.67it/s]warmup should be done:   6%|▌         | 179/3000 [00:00<00:01, 1787.58it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1777.23it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1801.11it/s]warmup should be done:  12%|█▏        | 365/3000 [00:00<00:01, 1828.95it/s]warmup should be done:  12%|█▏        | 367/3000 [00:00<00:01, 1830.86it/s]warmup should be done:  12%|█▏        | 363/3000 [00:00<00:01, 1814.44it/s]warmup should be done:  12%|█▏        | 374/3000 [00:00<00:01, 1799.38it/s]warmup should be done:  18%|█▊        | 552/3000 [00:00<00:01, 1846.10it/s]warmup should be done:  18%|█▊        | 548/3000 [00:00<00:01, 1830.23it/s]warmup should be done:  18%|█▊        | 552/3000 [00:00<00:01, 1837.31it/s]warmup should be done:  19%|█▊        | 560/3000 [00:00<00:01, 1825.88it/s]warmup should be done:  25%|██▍       | 738/3000 [00:00<00:01, 1850.24it/s]warmup should be done:  24%|██▍       | 734/3000 [00:00<00:01, 1841.63it/s]warmup should be done:  25%|██▍       | 737/3000 [00:00<00:01, 1839.33it/s]warmup should be done:  25%|██▍       | 743/3000 [00:00<00:01, 1820.47it/s]warmup should be done:  31%|███       | 925/3000 [00:00<00:01, 1853.88it/s]warmup should be done:  31%|███       | 921/3000 [00:00<00:01, 1839.45it/s]warmup should be done:  31%|███       | 919/3000 [00:00<00:01, 1827.37it/s]warmup should be done:  31%|███       | 929/3000 [00:00<00:01, 1831.83it/s]warmup should be done:  37%|███▋      | 1112/3000 [00:00<00:01, 1856.64it/s]warmup should be done:  37%|███▋      | 1106/3000 [00:00<00:01, 1841.28it/s]warmup should be done:  37%|███▋      | 1106/3000 [00:00<00:01, 1838.69it/s]warmup should be done:  37%|███▋      | 1115/3000 [00:00<00:01, 1838.90it/s]warmup should be done:  43%|████▎     | 1299/3000 [00:00<00:00, 1860.64it/s]warmup should be done:  43%|████▎     | 1291/3000 [00:00<00:00, 1836.28it/s]warmup should be done:  43%|████▎     | 1302/3000 [00:00<00:00, 1846.31it/s]warmup should be done:  43%|████▎     | 1290/3000 [00:00<00:00, 1789.07it/s]warmup should be done:  49%|████▉     | 1476/3000 [00:00<00:00, 1840.30it/s]warmup should be done:  50%|████▉     | 1486/3000 [00:00<00:00, 1845.33it/s]warmup should be done:  50%|████▉     | 1490/3000 [00:00<00:00, 1855.88it/s]warmup should be done:  49%|████▉     | 1473/3000 [00:00<00:00, 1800.93it/s]warmup should be done:  56%|█████▌    | 1665/3000 [00:00<00:00, 1855.48it/s]warmup should be done:  56%|█████▌    | 1671/3000 [00:00<00:00, 1840.41it/s]warmup should be done:  56%|█████▌    | 1678/3000 [00:00<00:00, 1862.10it/s]warmup should be done:  55%|█████▌    | 1657/3000 [00:00<00:00, 1810.63it/s]warmup should be done:  62%|██████▏   | 1852/3000 [00:01<00:00, 1859.56it/s]warmup should be done:  62%|██████▏   | 1856/3000 [00:01<00:00, 1835.30it/s]warmup should be done:  62%|██████▏   | 1866/3000 [00:01<00:00, 1866.48it/s]warmup should be done:  61%|██████▏   | 1839/3000 [00:01<00:00, 1783.70it/s]warmup should be done:  68%|██████▊   | 2038/3000 [00:01<00:00, 1857.70it/s]warmup should be done:  68%|██████▊   | 2053/3000 [00:01<00:00, 1865.56it/s]warmup should be done:  68%|██████▊   | 2040/3000 [00:01<00:00, 1799.59it/s]warmup should be done:  67%|██████▋   | 2020/3000 [00:01<00:00, 1789.84it/s]warmup should be done:  74%|███████▍  | 2224/3000 [00:01<00:00, 1855.47it/s]warmup should be done:  75%|███████▍  | 2240/3000 [00:01<00:00, 1863.18it/s]warmup should be done:  74%|███████▍  | 2221/3000 [00:01<00:00, 1799.04it/s]warmup should be done:  73%|███████▎  | 2204/3000 [00:01<00:00, 1804.48it/s]warmup should be done:  80%|████████  | 2410/3000 [00:01<00:00, 1853.01it/s]warmup should be done:  81%|████████  | 2427/3000 [00:01<00:00, 1860.98it/s]warmup should be done:  80%|████████  | 2410/3000 [00:01<00:00, 1825.33it/s]warmup should be done:  80%|███████▉  | 2385/3000 [00:01<00:00, 1787.55it/s]warmup should be done:  87%|████████▋ | 2596/3000 [00:01<00:00, 1850.79it/s]warmup should be done:  87%|████████▋ | 2614/3000 [00:01<00:00, 1860.58it/s]warmup should be done:  87%|████████▋ | 2600/3000 [00:01<00:00, 1844.82it/s]warmup should be done:  86%|████████▌ | 2573/3000 [00:01<00:00, 1812.49it/s]warmup should be done:  93%|█████████▎| 2782/3000 [00:01<00:00, 1849.80it/s]warmup should be done:  93%|█████████▎| 2802/3000 [00:01<00:00, 1864.03it/s]warmup should be done:  93%|█████████▎| 2787/3000 [00:01<00:00, 1850.60it/s]warmup should be done:  92%|█████████▏| 2755/3000 [00:01<00:00, 1713.18it/s]warmup should be done:  99%|█████████▉| 2967/3000 [00:01<00:00, 1849.36it/s]warmup should be done: 100%|█████████▉| 2990/3000 [00:01<00:00, 1867.14it/s]warmup should be done:  99%|█████████▉| 2973/3000 [00:01<00:00, 1852.96it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1853.89it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1846.54it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1839.67it/s]warmup should be done:  98%|█████████▊| 2940/3000 [00:01<00:00, 1750.36it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1789.83it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fd7cb4c5040>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fd7cb4c51f0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fd7cb4c5100>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fd7cb787df0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-12 02:02:12.532704: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fd3a1a64530 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:02:12.532774: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:02:12.542643: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:02:12.549696: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fd3a126b530 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:02:12.549751: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:02:12.552246: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fd3a126ba00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:02:12.552289: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:02:12.556800: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:02:12.557532: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fd3a126ed80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:02:12.557577: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:02:12.561110: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:02:12.566365: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:02:13.223697: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:02:13.331464: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:02:13.333340: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:02:13.369219: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:02:18.841069: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:02:18.853454: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:02:19.293155: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:02:19.586335: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][02:03:12.679][ERROR][RK0][tid #140547100505856]: replica 0 reaches 1000, calling init pre replica
[HCTR][02:03:12.680][ERROR][RK0][tid #140547100505856]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][02:03:12.685][ERROR][RK0][tid #140547100505856]: coll ps creation done
[HCTR][02:03:12.685][ERROR][RK0][tid #140547100505856]: replica 0 waits for coll ps creation barrier
[HCTR][02:03:12.740][ERROR][RK0][tid #140547100505856]: replica 1 reaches 1000, calling init pre replica
[HCTR][02:03:12.740][ERROR][RK0][tid #140547100505856]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][02:03:12.743][ERROR][RK0][tid #140547100505856]: coll ps creation done
[HCTR][02:03:12.743][ERROR][RK0][tid #140547100505856]: replica 1 waits for coll ps creation barrier
[HCTR][02:03:13.104][ERROR][RK0][tid #140547092113152]: replica 3 reaches 1000, calling init pre replica
[HCTR][02:03:13.104][ERROR][RK0][tid #140547092113152]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][02:03:13.109][ERROR][RK0][tid #140547092113152]: coll ps creation done
[HCTR][02:03:13.109][ERROR][RK0][tid #140547092113152]: replica 3 waits for coll ps creation barrier
[HCTR][02:03:13.175][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][02:03:13.175][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][02:03:13.179][ERROR][RK0][main]: coll ps creation done
[HCTR][02:03:13.179][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][02:03:13.179][ERROR][RK0][tid #140547100505856]: replica 0 preparing frequency
[HCTR][02:03:14.341][ERROR][RK0][tid #140547100505856]: replica 0 preparing frequency done
[HCTR][02:03:14.377][ERROR][RK0][tid #140547100505856]: replica 0 calling init per replica
[HCTR][02:03:14.377][ERROR][RK0][tid #140547100505856]: replica 1 calling init per replica
[HCTR][02:03:14.377][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][02:03:14.377][ERROR][RK0][tid #140547100505856]: Calling build_v2
[HCTR][02:03:14.377][ERROR][RK0][tid #140547092113152]: replica 3 calling init per replica
[HCTR][02:03:14.377][ERROR][RK0][tid #140547100505856]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:03:14.377][ERROR][RK0][main]: Calling build_v2
[HCTR][02:03:14.377][ERROR][RK0][tid #140547100505856]: Calling build_v2
[HCTR][02:03:14.377][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:03:14.377][ERROR][RK0][tid #140547100505856]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:03:14.377][ERROR][RK0][tid #140547092113152]: Calling build_v2
[HCTR][02:03:14.377][ERROR][RK0][tid #140547092113152]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-12 02:03:142022-12-12 02:03:14.[.3773842022-12-12 02:03:14377384: .2022-12-12 02:03:14: E377384.E : 377414 /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: E:136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc 136] :/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] using concurrent impl MPS136:using concurrent impl MPS
] 136
using concurrent impl MPS] 
using concurrent impl MPS
[2022-12-12 02:03:14.378640: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[196[] 2022-12-12 02:03:142022-12-12 02:03:14assigning 8 to cpu[..
2022-12-12 02:03:14378638378662.: E: 378686 E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc E:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc [196:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-12 02:03:14] 196:.assigning 8 to cpu] 196378747
assigning 8 to cpu] : 
assigning 8 to cpuE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[[2022-12-12 02:03:142022-12-12 02:03:14.[.3788392022-12-12 02:03:14378838: .: [E378836E2022-12-12 02:03:14 :  ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc378852: :: 213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc212E] :]  remote time is 8.68421212build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
] 
:build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[212
2022-12-12 02:03:14] [.build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-12 02:03:14378967
.: 378978E: [ E[2022-12-12 02:03:14/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 2022-12-12 02:03:14.:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.378997214:379006: ] 213: Ecpu time is 30] E 
remote time is 8.68421 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::[2132132022-12-12 02:03:14] ] .remote time is 8.68421remote time is 8.68421379088

: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-12 02:03:14[214.2022-12-12 02:03:14] 379128.cpu time is 30: 379130
E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214:] 214cpu time is 30] 
cpu time is 30
[2022-12-12 02:03:40.423480: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 02:03:40.476011: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-12 02:03:40.638444: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 02:03:40.638576: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 02:03:40.638661: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 02:03:40.638739: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 02:03:40.640462: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:03:40.640580: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:03:40.643022: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:03:40.644429: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:03:40.660761: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-12 02:03:40.660825: E[ 2022-12-12 02:03:40/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc.:660821205: ] Eworker 0 thread 1 initing device 1 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc[:202] 2022-12-12 02:03:402 solved.
660852: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc2022-12-12 02:03:40:.202660900] : 3 solvedE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205[] 2022-12-12 02:03:40worker 0 thread 2 initing device 2.
660930: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 02:03:40.661113: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:03:40.661162: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:03:40.661273: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:03:40.661334: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:03:40.661758: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:03:40.661804: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:03:40.662875: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:03:40.662956: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:03:40.662993: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:03:40.664374: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:03:40.664403: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-12 02:03:40
.664425: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:03:40.700723: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 02:03:40.703068: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 02:03:40.703130: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:03:40.703976: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 02:03:40.704574: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:03:40.705539: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:40.705583: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.04 MB
[2022-12-12 02:03:40.720924: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 02:03:40.722719: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 02:03:40.722770: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:03:40.723561: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 02:03:40.724056: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:03:40.725018: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:40.725060: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.04 MB
[2022-12-12 02:03:40.737478: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:03:40.738090: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:03:40.738133: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 02:03:40.755425: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:03:40.756038: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:03:40.756079: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[[2022-12-12 02:03:402022-12-12 02:03:40..757981757981: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes

[2022-12-12 02:03:40[.2022-12-12 02:03:40759762.: 759768E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 5] 
eager release cuda mem 5
[2022-12-12 02:03:40.759830[: 2022-12-12 02:03:40E. 759837/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :E638 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 400000000:
638] eager release cuda mem 400000000
[2022-12-12 02:03:40.771696: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 02:03:40.772180: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 02:03:40.772968: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:03:40.773307: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:03:40.773939: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:40.773982: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.04 MB
[2022-12-12 02:03:40.774425: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:40.774704: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.04 MB
[2022-12-12 02:03:40.825944: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:03:40.826543: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:03:40.826585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 02:03:40.834137: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:03:40.834720: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:03:40.834762: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[[[[2022-12-12 02:03:412022-12-12 02:03:412022-12-12 02:03:412022-12-12 02:03:41....534187534183534183534186: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 2 init p2p of link 3Device 0 init p2p of link 1Device 1 init p2p of link 2Device 3 init p2p of link 0



[[2022-12-12 02:03:412022-12-12 02:03:41.534464[: 2022-12-12 02:03:41E. 534476/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: .:E5344651980 : ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuEeager alloc mem 611.00 KB: 
1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 611.00 KB1980
] eager alloc mem 611.00 KB
[2022-12-12 02:03:41.534599: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:03:41.535343: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-12 02:03:41:[.6382022-12-12 02:03:41535356] .: eager release cuda mem 625663535364E
:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-12 02:03:41.535459: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:41.545207: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 02:03:41.545249: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[[2022-12-12 02:03:412022-12-12 02:03:41..545306545300: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801926] ] eager alloc mem 611.00 KBDevice 3 init p2p of link 1

[2022-12-12 02:03:41.545361: E[ 2022-12-12 02:03:41/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:5453651980: ] Eeager alloc mem 611.00 KB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-12 02:03:41.545425: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:03:41.545502: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:03:41.546152: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:41.546200: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:41.546243: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:41.546331: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:41.556775: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 02:03:41.556860: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:03:41.556954: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 02:03:41.[5570472022-12-12 02:03:41: .E557046 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 611.00 KB1926
] Device 3 init p2p of link 2
[2022-12-12 02:03:41.557135[: 2022-12-12 02:03:41E. 557152/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1926 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuDevice 0 init p2p of link 3:
1980] eager alloc mem 611.00 KB
[2022-12-12 02:03:41.557248: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:03:41.557677: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:41.557890: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:41.557992: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:41.558066: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:03:41.567034: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 02:03:41.567344: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 15999999 / 100000000 nodes ( 16.00 %~16.00 %) | remote 47999997 / 100000000 nodes ( 48.00 %) | cpu 36000004 / 100000000 nodes ( 36.00 %) | 7.63 GB | 0.906021 secs 
[2022-12-12 02:03:41.567558: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 02:03:41.567653: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 02:03:41.567711: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 02:03:41.567883: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 15999999 / 100000000 nodes ( 16.00 %~16.00 %) | remote 47999997 / 100000000 nodes ( 48.00 %) | cpu 36000004 / 100000000 nodes ( 36.00 %) | 7.63 GB | 0.906735 secs 
[2022-12-12 02:03:41.568079: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 15999999 / 100000000 nodes ( 16.00 %~16.00 %) | remote 47999997 / 100000000 nodes ( 48.00 %) | cpu 36000004 / 100000000 nodes ( 36.00 %) | 7.63 GB | 0.906285 secs 
[2022-12-12 02:03:41.568281: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 15999999 / 100000000 nodes ( 16.00 %~16.00 %) | remote 47999997 / 100000000 nodes ( 48.00 %) | cpu 36000004 / 100000000 nodes ( 36.00 %) | 7.63 GB | 0.927728 secs 
[2022-12-12 02:03:41.569149: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.33 GB
[2022-12-12 02:03:42.598468: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.58 GB
[2022-12-12 02:03:42.598922: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.58 GB
[2022-12-12 02:03:42.600697: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.58 GB
[2022-12-12 02:03:43.420559: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.82 GB
[2022-12-12 02:03:43.421180: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.82 GB
[2022-12-12 02:03:43.421484: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.82 GB
[2022-12-12 02:03:44.222962: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 15.07 GB
[2022-12-12 02:03:44.224230: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 15.07 GB
[2022-12-12 02:03:44.224665: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 15.07 GB
[2022-12-12 02:03:45. 47157: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 15.48 GB
[2022-12-12 02:03:45. 47288: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 15.48 GB
[2022-12-12 02:03:45. 47947: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 15.48 GB
[2022-12-12 02:03:45.824633: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 15.67 GB
[2022-12-12 02:03:45.824770: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 15.67 GB
[HCTR][02:03:45.987][ERROR][RK0][tid #140547092113152]: replica 3 calling init per replica done, doing barrier
[HCTR][02:03:45.987][ERROR][RK0][tid #140547100505856]: replica 1 calling init per replica done, doing barrier
[HCTR][02:03:45.987][ERROR][RK0][tid #140547100505856]: replica 0 calling init per replica done, doing barrier
[HCTR][02:03:45.987][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][02:03:45.987][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][02:03:45.987][ERROR][RK0][tid #140547100505856]: replica 0 calling init per replica done, doing barrier done
[HCTR][02:03:45.987][ERROR][RK0][tid #140547100505856]: replica 1 calling init per replica done, doing barrier done
[HCTR][02:03:45.987][ERROR][RK0][tid #140547092113152]: replica 3 calling init per replica done, doing barrier done
[HCTR][02:03:45.987][ERROR][RK0][tid #140547092113152]: init per replica done
[HCTR][02:03:45.987][ERROR][RK0][tid #140547100505856]: init per replica done
[HCTR][02:03:45.987][ERROR][RK0][main]: init per replica done
[HCTR][02:03:46.003][ERROR][RK0][tid #140547100505856]: init per replica done
[HCTR][02:03:46.023][ERROR][RK0][tid #140547100505856]: 1 allocated 3276800 at 0x7fb7e0238400
[HCTR][02:03:46.023][ERROR][RK0][tid #140547100505856]: 1 allocated 6553600 at 0x7fb7e0558400
[HCTR][02:03:46.023][ERROR][RK0][tid #140547100505856]: 1 allocated 3276800 at 0x7fb7e0b98400
[HCTR][02:03:46.023][ERROR][RK0][tid #140547100505856]: 1 allocated 6553600 at 0x7fb7e0eb8400
[HCTR][02:03:46.024][ERROR][RK0][tid #140547092113152]: 3 allocated 3276800 at 0x7fb7e0238400
[HCTR][02:03:46.024][ERROR][RK0][tid #140547092113152]: 3 allocated 6553600 at 0x7fb7e0558400
[HCTR][02:03:46.024][ERROR][RK0][tid #140547092113152]: 3 allocated 3276800 at 0x7fb7e0b98400
[HCTR][02:03:46.024][ERROR][RK0][tid #140547092113152]: 3 allocated 6553600 at 0x7fb7e0eb8400
[HCTR][02:03:46.024][ERROR][RK0][tid #140547100505856]: 2 allocated 3276800 at 0x7fb84c238400
[HCTR][02:03:46.024][ERROR][RK0][tid #140547100505856]: 2 allocated 6553600 at 0x7fb84c558400
[HCTR][02:03:46.024][ERROR][RK0][tid #140547100505856]: 2 allocated 3276800 at 0x7fb84cb98400
[HCTR][02:03:46.024][ERROR][RK0][tid #140547100505856]: 2 allocated 6553600 at 0x7fb84ceb8400
[HCTR][02:03:46.040][ERROR][RK0][main]: 0 allocated 3276800 at 0x7fb7d8320000
[HCTR][02:03:46.041][ERROR][RK0][main]: 0 allocated 6553600 at 0x7fb7d8640000
[HCTR][02:03:46.041][ERROR][RK0][main]: 0 allocated 3276800 at 0x7fb7d8c80000
[HCTR][02:03:46.041][ERROR][RK0][main]: 0 allocated 6553600 at 0x7fb7d8fa0000
