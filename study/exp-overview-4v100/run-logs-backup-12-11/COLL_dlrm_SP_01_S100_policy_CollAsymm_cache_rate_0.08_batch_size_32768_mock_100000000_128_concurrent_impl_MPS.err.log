2022-12-11 22:37:13.687023: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:37:13.744621: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:37:13.745660: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:37:13.747371: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:37:14.540162: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:37:14.540241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:37:14.553283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:37:14.584261: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:37:14.584415: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:37:14.586525: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 22:37:14.613202: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:37:14.613284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:37:14.614056: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:37:14.614131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:37:14.620451: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:37:14.620518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:37:14.628327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:37:14.628827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:37:14.632934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:37:14.661718: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:37:14.661946: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:37:14.661980: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:37:14.662184: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:37:14.663561: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:37:14.663666: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:37:14.663826: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 22:37:14.664183: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 22:37:14.665341: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][22:37:14.927][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:37:15.889][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:37:15.900][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:37:15.949][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.59s/it]warmup run: 108it [00:01, 88.91it/s]warmup run: 217it [00:01, 194.40it/s]warmup run: 325it [00:01, 310.04it/s]warmup run: 425it [00:01, 418.45it/s]warmup run: 0it [00:00, ?it/s]warmup run: 536it [00:02, 544.89it/s]warmup run: 646it [00:02, 659.61it/s]warmup run: 750it [00:02, 745.69it/s]warmup run: 1it [00:01,  1.49s/it]warmup run: 854it [00:02, 701.38it/s]warmup run: 101it [00:01, 88.16it/s]warmup run: 962it [00:02, 788.24it/s]warmup run: 209it [00:01, 198.41it/s]warmup run: 1070it [00:02, 860.55it/s]warmup run: 317it [00:01, 319.15it/s]warmup run: 1182it [00:02, 927.92it/s]warmup run: 426it [00:01, 444.69it/s]warmup run: 1292it [00:02, 973.69it/s]warmup run: 529it [00:01, 555.05it/s]warmup run: 1398it [00:02, 976.01it/s]warmup run: 633it [00:02, 658.08it/s]warmup run: 1508it [00:03, 1010.01it/s]warmup run: 737it [00:02, 746.05it/s]warmup run: 1617it [00:03, 1031.76it/s]warmup run: 839it [00:02, 812.85it/s]warmup run: 1727it [00:03, 1050.57it/s]warmup run: 941it [00:02, 863.81it/s]warmup run: 1835it [00:03, 1052.54it/s]warmup run: 1043it [00:02, 902.09it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 1942it [00:03, 1053.10it/s]warmup run: 1145it [00:02, 933.19it/s]warmup run: 93it [00:01, 83.61it/s]warmup run: 2049it [00:03, 1057.26it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1247it [00:02, 952.65it/s]warmup run: 200it [00:01, 196.06it/s]warmup run: 2185it [00:03, 1144.86it/s]warmup run: 1351it [00:02, 977.05it/s]warmup run: 295it [00:01, 301.37it/s]warmup run: 2321it [00:03, 1207.53it/s]warmup run: 1453it [00:02, 983.98it/s]warmup run: 394it [00:01, 415.76it/s]warmup run: 2458it [00:03, 1254.76it/s]warmup run: 1555it [00:03, 981.03it/s]warmup run: 499it [00:01, 536.91it/s]warmup run: 2595it [00:03, 1287.91it/s]warmup run: 1658it [00:03, 994.78it/s]warmup run: 601it [00:02, 640.64it/s]warmup run: 2733it [00:04, 1312.75it/s]warmup run: 1761it [00:03, 1004.93it/s]warmup run: 702it [00:02, 725.91it/s]warmup run: 2872it [00:04, 1333.82it/s]warmup run: 1869it [00:03, 1026.58it/s]warmup run: 811it [00:02, 817.17it/s]warmup run: 3000it [00:04, 702.15it/s] warmup run: 1975it [00:03, 1034.58it/s]warmup run: 913it [00:02, 867.82it/s]warmup run: 2104it [00:03, 1108.31it/s]warmup run: 1015it [00:02, 905.51it/s]warmup run: 2241it [00:03, 1185.03it/s]warmup run: 1116it [00:02, 931.02it/s]warmup run: 2378it [00:03, 1239.60it/s]warmup run: 1217it [00:02, 937.66it/s]warmup run: 2515it [00:03, 1278.15it/s]warmup run: 1318it [00:02, 956.41it/s]warmup run: 2651it [00:03, 1301.37it/s]warmup run: 1419it [00:02, 969.18it/s]warmup run: 2789it [00:04, 1322.53it/s]warmup run: 1521it [00:02, 982.03it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 2927it [00:04, 1337.64it/s]warmup run: 1622it [00:03, 985.50it/s]warmup run: 3000it [00:04, 719.33it/s] warmup run: 101it [00:01, 92.35it/s]warmup run: 1723it [00:03, 992.46it/s]warmup run: 201it [00:01, 197.36it/s]warmup run: 1824it [00:03, 995.67it/s]warmup run: 308it [00:01, 320.80it/s]warmup run: 1925it [00:03, 999.61it/s]warmup run: 414it [00:01, 444.51it/s]warmup run: 2034it [00:03, 1026.18it/s]warmup run: 522it [00:01, 567.25it/s]warmup run: 2169it [00:03, 1122.54it/s]warmup run: 630it [00:02, 677.66it/s]warmup run: 2305it [00:03, 1191.12it/s]warmup run: 739it [00:02, 774.30it/s]warmup run: 2441it [00:03, 1240.23it/s]warmup run: 848it [00:02, 853.09it/s]warmup run: 2577it [00:03, 1274.30it/s]warmup run: 956it [00:02, 912.53it/s]warmup run: 2713it [00:03, 1298.51it/s]warmup run: 1063it [00:02, 955.11it/s]warmup run: 2848it [00:04, 1312.39it/s]warmup run: 1170it [00:02, 981.66it/s]warmup run: 2984it [00:04, 1325.48it/s]warmup run: 3000it [00:04, 717.42it/s] warmup run: 1276it [00:02, 994.47it/s]warmup run: 1382it [00:02, 1012.44it/s]warmup run: 1488it [00:02, 1005.29it/s]warmup run: 1594it [00:02, 1020.46it/s]warmup run: 1700it [00:03, 1031.19it/s]warmup run: 1808it [00:03, 1043.38it/s]warmup run: 1914it [00:03, 1046.59it/s]warmup run: 2025it [00:03, 1064.16it/s]warmup run: 2156it [00:03, 1136.46it/s]warmup run: 2289it [00:03, 1191.52it/s]warmup run: 2421it [00:03, 1227.29it/s]warmup run: 2544it [00:03, 1215.50it/s]warmup run: 2676it [00:03, 1244.27it/s]warmup run: 2801it [00:03, 1215.48it/s]warmup run: 2938it [00:04, 1259.54it/s]warmup run: 3000it [00:04, 731.26it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1800.67it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1615.23it/s]warmup should be done:   5%|▌         | 151/3000 [00:00<00:01, 1505.36it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1719.32it/s]warmup should be done:  11%|█▏        | 343/3000 [00:00<00:01, 1727.14it/s]warmup should be done:  12%|█▏        | 365/3000 [00:00<00:01, 1817.86it/s]warmup should be done:  11%|█         | 330/3000 [00:00<00:01, 1668.32it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1762.72it/s]warmup should be done:  17%|█▋        | 507/3000 [00:00<00:01, 1714.50it/s]warmup should be done:  17%|█▋        | 523/3000 [00:00<00:01, 1756.24it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1772.28it/s]warmup should be done:  18%|█▊        | 547/3000 [00:00<00:01, 1810.87it/s]warmup should be done:  23%|██▎       | 685/3000 [00:00<00:01, 1738.49it/s]warmup should be done:  23%|██▎       | 704/3000 [00:00<00:01, 1774.22it/s]warmup should be done:  24%|██▎       | 709/3000 [00:00<00:01, 1772.34it/s]warmup should be done:  24%|██▍       | 729/3000 [00:00<00:01, 1775.70it/s]warmup should be done:  29%|██▉       | 863/3000 [00:00<00:01, 1751.71it/s]warmup should be done:  29%|██▉       | 884/3000 [00:00<00:01, 1780.62it/s]warmup should be done:  30%|██▉       | 887/3000 [00:00<00:01, 1773.73it/s]warmup should be done:  30%|███       | 907/3000 [00:00<00:01, 1666.71it/s]warmup should be done:  35%|███▍      | 1040/3000 [00:00<00:01, 1757.78it/s]warmup should be done:  36%|███▌      | 1065/3000 [00:00<00:01, 1773.61it/s]warmup should be done:  35%|███▌      | 1063/3000 [00:00<00:01, 1774.78it/s]warmup should be done:  36%|███▌      | 1087/3000 [00:00<00:01, 1707.72it/s]warmup should be done:  41%|████      | 1218/3000 [00:00<00:01, 1763.17it/s]warmup should be done:  41%|████▏     | 1243/3000 [00:00<00:00, 1782.13it/s]warmup should be done:  41%|████▏     | 1243/3000 [00:00<00:01, 1724.37it/s]warmup should be done:  42%|████▏     | 1259/3000 [00:00<00:01, 1685.66it/s]warmup should be done:  47%|████▋     | 1396/3000 [00:00<00:00, 1767.63it/s]warmup should be done:  47%|████▋     | 1424/3000 [00:00<00:00, 1789.28it/s]warmup should be done:  47%|████▋     | 1420/3000 [00:00<00:00, 1738.28it/s]warmup should be done:  48%|████▊     | 1429/3000 [00:00<00:00, 1682.66it/s]warmup should be done:  52%|█████▏    | 1573/3000 [00:00<00:00, 1758.41it/s]warmup should be done:  54%|█████▎    | 1606/3000 [00:00<00:00, 1796.27it/s]warmup should be done:  53%|█████▎    | 1598/3000 [00:00<00:00, 1750.25it/s]warmup should be done:  53%|█████▎    | 1600/3000 [00:00<00:00, 1688.98it/s]warmup should be done:  58%|█████▊    | 1750/3000 [00:01<00:00, 1761.69it/s]warmup should be done:  60%|█████▉    | 1786/3000 [00:01<00:00, 1797.01it/s]warmup should be done:  59%|█████▉    | 1774/3000 [00:01<00:00, 1677.56it/s]warmup should be done:  59%|█████▉    | 1770/3000 [00:01<00:00, 1678.24it/s]warmup should be done:  64%|██████▍   | 1927/3000 [00:01<00:00, 1763.47it/s]warmup should be done:  66%|██████▌   | 1966/3000 [00:01<00:00, 1792.36it/s]warmup should be done:  65%|██████▌   | 1955/3000 [00:01<00:00, 1715.23it/s]warmup should be done:  65%|██████▍   | 1939/3000 [00:01<00:00, 1679.88it/s]warmup should be done:  70%|███████   | 2106/3000 [00:01<00:00, 1768.49it/s]warmup should be done:  72%|███████▏  | 2146/3000 [00:01<00:00, 1792.61it/s]warmup should be done:  71%|███████   | 2133/3000 [00:01<00:00, 1732.18it/s]warmup should be done:  70%|███████   | 2108/3000 [00:01<00:00, 1675.93it/s]warmup should be done:  76%|███████▌  | 2284/3000 [00:01<00:00, 1771.68it/s]warmup should be done:  78%|███████▊  | 2326/3000 [00:01<00:00, 1790.97it/s]warmup should be done:  77%|███████▋  | 2307/3000 [00:01<00:00, 1727.57it/s]warmup should be done:  76%|███████▌  | 2277/3000 [00:01<00:00, 1678.38it/s]warmup should be done:  82%|████████▏ | 2465/3000 [00:01<00:00, 1780.82it/s]warmup should be done:  84%|████████▎ | 2508/3000 [00:01<00:00, 1797.16it/s]warmup should be done:  83%|████████▎ | 2483/3000 [00:01<00:00, 1737.09it/s]warmup should be done:  82%|████████▏ | 2447/3000 [00:01<00:00, 1682.57it/s]warmup should be done:  88%|████████▊ | 2645/3000 [00:01<00:00, 1784.47it/s]warmup should be done:  90%|████████▉ | 2688/3000 [00:01<00:00, 1796.19it/s]warmup should be done:  89%|████████▊ | 2659/3000 [00:01<00:00, 1742.94it/s]warmup should be done:  87%|████████▋ | 2618/3000 [00:01<00:00, 1689.20it/s]warmup should be done:  94%|█████████▍| 2825/3000 [00:01<00:00, 1788.26it/s]warmup should be done:  96%|█████████▌| 2868/3000 [00:01<00:00, 1796.93it/s]warmup should be done:  94%|█████████▍| 2835/3000 [00:01<00:00, 1747.63it/s]warmup should be done:  93%|█████████▎| 2787/3000 [00:01<00:00, 1686.66it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1785.09it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1761.71it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1741.19it/s]warmup should be done:  99%|█████████▊| 2959/3000 [00:01<00:00, 1695.78it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1700.49it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1613.76it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1664.28it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1765.23it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1739.47it/s]warmup should be done:  11%|█         | 329/3000 [00:00<00:01, 1646.63it/s]warmup should be done:  11%|█▏        | 338/3000 [00:00<00:01, 1690.90it/s]warmup should be done:  12%|█▏        | 363/3000 [00:00<00:01, 1819.42it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1799.79it/s]warmup should be done:  18%|█▊        | 548/3000 [00:00<00:01, 1833.33it/s]warmup should be done:  18%|█▊        | 525/3000 [00:00<00:01, 1769.04it/s]warmup should be done:  18%|█▊        | 544/3000 [00:00<00:01, 1818.70it/s]warmup should be done:  16%|█▋        | 494/3000 [00:00<00:01, 1616.05it/s]warmup should be done:  24%|██▍       | 734/3000 [00:00<00:01, 1842.53it/s]warmup should be done:  24%|██▎       | 712/3000 [00:00<00:01, 1806.44it/s]warmup should be done:  24%|██▍       | 728/3000 [00:00<00:01, 1826.63it/s]warmup should be done:  23%|██▎       | 680/3000 [00:00<00:01, 1711.08it/s]warmup should be done:  31%|███       | 920/3000 [00:00<00:01, 1848.09it/s]warmup should be done:  30%|███       | 913/3000 [00:00<00:01, 1831.53it/s]warmup should be done:  29%|██▉       | 867/3000 [00:00<00:01, 1766.51it/s]warmup should be done:  30%|██▉       | 893/3000 [00:00<00:01, 1780.38it/s]warmup should be done:  37%|███▋      | 1107/3000 [00:00<00:01, 1852.92it/s]warmup should be done:  37%|███▋      | 1097/3000 [00:00<00:01, 1833.63it/s]warmup should be done:  35%|███▌      | 1054/3000 [00:00<00:01, 1800.66it/s]warmup should be done:  36%|███▌      | 1081/3000 [00:00<00:01, 1813.26it/s]warmup should be done:  43%|████▎     | 1293/3000 [00:00<00:00, 1851.07it/s]warmup should be done:  41%|████▏     | 1239/3000 [00:00<00:00, 1815.97it/s]warmup should be done:  42%|████▏     | 1268/3000 [00:00<00:00, 1831.14it/s]warmup should be done:  43%|████▎     | 1281/3000 [00:00<00:00, 1809.03it/s]warmup should be done:  49%|████▉     | 1479/3000 [00:00<00:00, 1849.84it/s]warmup should be done:  48%|████▊     | 1427/3000 [00:00<00:00, 1833.72it/s]warmup should be done:  49%|████▊     | 1457/3000 [00:00<00:00, 1848.43it/s]warmup should be done:  49%|████▉     | 1464/3000 [00:00<00:00, 1812.77it/s]warmup should be done:  55%|█████▌    | 1664/3000 [00:00<00:00, 1842.08it/s]warmup should be done:  54%|█████▍    | 1614/3000 [00:00<00:00, 1843.73it/s]warmup should be done:  55%|█████▍    | 1646/3000 [00:00<00:00, 1858.78it/s]warmup should be done:  55%|█████▍    | 1646/3000 [00:00<00:00, 1811.60it/s]warmup should be done:  60%|██████    | 1801/3000 [00:01<00:00, 1850.26it/s]warmup should be done:  61%|██████    | 1835/3000 [00:01<00:00, 1866.16it/s]warmup should be done:  61%|██████    | 1828/3000 [00:01<00:00, 1812.52it/s]warmup should be done:  62%|██████▏   | 1849/3000 [00:01<00:00, 1796.24it/s]warmup should be done:  67%|██████▋   | 2023/3000 [00:01<00:00, 1870.09it/s]warmup should be done:  66%|██████▌   | 1987/3000 [00:01<00:00, 1846.66it/s]warmup should be done:  67%|██████▋   | 2010/3000 [00:01<00:00, 1812.19it/s]warmup should be done:  68%|██████▊   | 2033/3000 [00:01<00:00, 1808.62it/s]warmup should be done:  74%|███████▎  | 2212/3000 [00:01<00:00, 1873.17it/s]warmup should be done:  72%|███████▏  | 2174/3000 [00:01<00:00, 1853.30it/s]warmup should be done:  73%|███████▎  | 2192/3000 [00:01<00:00, 1812.52it/s]warmup should be done:  74%|███████▍  | 2215/3000 [00:01<00:00, 1784.22it/s]warmup should be done:  79%|███████▊  | 2361/3000 [00:01<00:00, 1856.84it/s]warmup should be done:  79%|███████▉  | 2377/3000 [00:01<00:00, 1822.62it/s]warmup should be done:  80%|████████  | 2400/3000 [00:01<00:00, 1832.15it/s]warmup should be done:  80%|███████▉  | 2397/3000 [00:01<00:00, 1793.08it/s]warmup should be done:  85%|████████▍ | 2549/3000 [00:01<00:00, 1861.90it/s]warmup should be done:  85%|████████▌ | 2564/3000 [00:01<00:00, 1836.43it/s]warmup should be done:  86%|████████▌ | 2586/3000 [00:01<00:00, 1838.43it/s]warmup should be done:  86%|████████▌ | 2583/3000 [00:01<00:00, 1811.30it/s]warmup should be done:  91%|█████████ | 2736/3000 [00:01<00:00, 1863.57it/s]warmup should be done:  92%|█████████▏| 2749/3000 [00:01<00:00, 1838.10it/s]warmup should be done:  92%|█████████▏| 2772/3000 [00:01<00:00, 1842.81it/s]warmup should be done:  92%|█████████▏| 2768/3000 [00:01<00:00, 1821.05it/s]warmup should be done:  97%|█████████▋| 2924/3000 [00:01<00:00, 1866.40it/s]warmup should be done:  98%|█████████▊| 2936/3000 [00:01<00:00, 1845.14it/s]warmup should be done:  99%|█████████▊| 2958/3000 [00:01<00:00, 1846.14it/s]warmup should be done:  98%|█████████▊| 2955/3000 [00:01<00:00, 1832.94it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1830.24it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1824.86it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1824.52it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1818.69it/s]2022-12-11 22:38:33.283945: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f76322655e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:38:33.284008: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:38:34.112165: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f763ea68100 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:38:34.112238: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:38:35.738961: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:38:36.872005: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:38:37.243565: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:38:38.313664: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:38:39.173084: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:38:39.423199: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f7632a682c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:38:39.423287: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:38:40.832031: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f763ea6b340 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:38:40.832091: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:38:41.120651: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:38:42.391458: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:38:43.460521: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:38:43.645197: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:38:44.699587: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:38:45.157904: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:38:46.397216: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][22:39:14.631][ERROR][RK0][tid #140145974040320]: replica 0 reaches 1000, calling init pre replica
[HCTR][22:39:14.632][ERROR][RK0][tid #140145974040320]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:39:14.637][ERROR][RK0][tid #140145974040320]: coll ps creation done
[HCTR][22:39:14.637][ERROR][RK0][tid #140145974040320]: replica 0 waits for coll ps creation barrier
[HCTR][22:39:14.644][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][22:39:14.644][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:39:14.647][ERROR][RK0][main]: coll ps creation done
[HCTR][22:39:14.647][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][22:39:14.798][ERROR][RK0][tid #140145974040320]: replica 3 reaches 1000, calling init pre replica
[HCTR][22:39:14.798][ERROR][RK0][tid #140145974040320]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:39:14.801][ERROR][RK0][tid #140145974040320]: coll ps creation done
[HCTR][22:39:14.801][ERROR][RK0][tid #140145974040320]: replica 3 waits for coll ps creation barrier
[HCTR][22:39:15.240][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][22:39:15.240][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:39:15.245][ERROR][RK0][main]: coll ps creation done
[HCTR][22:39:15.245][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][22:39:15.245][ERROR][RK0][tid #140145974040320]: replica 0 preparing frequency
[HCTR][22:39:16.173][ERROR][RK0][tid #140145974040320]: replica 0 preparing frequency done
[HCTR][22:39:16.205][ERROR][RK0][tid #140145974040320]: replica 0 calling init per replica
[HCTR][22:39:16.205][ERROR][RK0][tid #140145974040320]: replica 3 calling init per replica
[HCTR][22:39:16.205][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][22:39:16.205][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][22:39:16.205][ERROR][RK0][tid #140145974040320]: Calling build_v2
[HCTR][22:39:16.205][ERROR][RK0][main]: Calling build_v2
[HCTR][22:39:16.205][ERROR][RK0][tid #140145974040320]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:39:16.205][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:39:16.205][ERROR][RK0][tid #140145974040320]: Calling build_v2
[HCTR][22:39:16.205][ERROR][RK0][main]: Calling build_v2
[HCTR][22:39:16.205][ERROR][RK0][tid #140145974040320]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:39:16.205][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 22:39:16[.205159[[: 2022-12-11 22:39:16E2022-12-11 22:39:162022-12-11 22:39:16. ..205178/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc205188205183: :: : E136EE ]   /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccusing concurrent impl MPS/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:
::136136136] ] ] using concurrent impl MPSusing concurrent impl MPSusing concurrent impl MPS


[2022-12-11 22:39:16.206507: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 22:39:16.206543: E[ [2022-12-11 22:39:16/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 22:39:16.:.206559196206556: [] : E2022-12-11 22:39:16assigning 8 to cpuE .
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc206591/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:: :196E212]  ] [assigning 8 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 22:39:16
:
.196206683] : assigning 8 to cpu[E
2022-12-11 22:39:16 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc206741:[: 2122022-12-11 22:39:16E] . build symm link desc with 4X Tesla V100-SXM2-16GB out of 4206770/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
: :E213 ] [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.684212022-12-11 22:39:16:
.212206840] [: build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 22:39:16E
. 206872/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: [:E2022-12-11 22:39:16213[ .] 2022-12-11 22:39:16/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc206910remote time is 8.68421.:: 
206908214E: ] [ Ecpu time is 302022-12-11 22:39:16/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 
.:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc206981213:: ] 212Eremote time is 8.68421]  
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
[:2022-12-11 22:39:16214.] 207075[cpu time is 30: 2022-12-11 22:39:16
E. 207091/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E214 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30:
213] remote time is 8.68421
[2022-12-11 22:39:16.207196: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 22:39:40. 31522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 22:39:40. 89313: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 22:39:40. 89411: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 22:39:40. 92858: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 22:39:40.211978: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 22:39:40.570635: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 22:39:40.570736: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 22:39:46.639092: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1022
[2022-12-11 22:39:46.639187: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 22:39:48.446557: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 22:39:48.446640: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1022
[2022-12-11 22:39:48.466181: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 22:39:48.466256: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1022 blocks, 4 devices
[2022-12-11 22:39:49.490875: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 22:39:49.502954: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 22:39:49.503682: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 22:39:49.514040: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 22:39:49.609152: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 22:40:03.345929: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 22:40:03.350069: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 22:40:03.354177: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 22:40:03.365029: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 22:40:03.365102: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 22:40:03.365137: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 22:40:03.365169: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 22:40:03.365858: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:40:03.365903: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:40:03.366731: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:40:03.367288: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:40:03.389287: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 22:40:03.389397: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 22:40:03.389629: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[[2022-12-11 22:40:03.2022-12-11 22:40:03389740.: 389700E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc205:] 202worker 0 thread 3 initing device 3] 
1 solved
[2022-12-11 22:40:03.389804: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 22:40:03.390127: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:40:03.390185: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:40:03.391038: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:40:03.391623: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:40:03.392803: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:40:03.392871: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:40:03.393729: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:40:03.394116: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:40:03.394175: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:40:03.394316: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:40:03.395603: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:40:03.396207: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:40:03.449191: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1022.00 Bytes
[2022-12-11 22:40:03.451078: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1022
[2022-12-11 22:40:03.451136: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:40:03.451932: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:40:03.452387: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:40:03.453358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.453402: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.51 MB
[2022-12-11 22:40:03.469007: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:40:03.469655: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:40:03.469702: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[[2022-12-11 22:40:032022-12-11 22:40:03..473758473758: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1022.00 Byteseager alloc mem 1022.00 Bytes

[2022-12-11 22:40:03.475650: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1022
[2022-12-11 22:40:03.475688: E[ 2022-12-11 22:40:03/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:475703638: ] Eeager release cuda mem 1022 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:40:03.475757: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:40:03.476522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:40:03.477001: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:40:03.477432: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:40:03.477528: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:40:03.478368: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.478413: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.52 MB
[2022-12-11 22:40:03.478468: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.478519: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.51 MB
[2022-12-11 22:40:03.493119: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:40:03.493747: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[[2022-12-11 22:40:032022-12-11 22:40:03..493771493791: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 25.25 KBeager alloc mem 3.82 GB

[2022-12-11 22:40:03.494379: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:40:03.494422: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[2022-12-11 22:40:03.497987: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1022.00 Bytes
[2022-12-11 22:40:03.499787: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1022
[2022-12-11 22:40:03.499835: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:40:03.503292: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:40:03.503680: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:40:03.504605: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.504648: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.51 MB
[2022-12-11 22:40:03.519704: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:40:03.520274: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:40:03.520315: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[[[[2022-12-11 22:40:032022-12-11 22:40:032022-12-11 22:40:032022-12-11 22:40:03....858045858054858041858053: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] Device 1 init p2p of link 2] ] Device 3 init p2p of link 0
Device 2 init p2p of link 3Device 0 init p2p of link 1


[[2022-12-11 22:40:032022-12-11 22:40:03..858341[858341: 2022-12-11 22:40:03: E[.E 2022-12-11 22:40:03858354 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.: /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:858359E:1980:  1980] E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] eager alloc mem 611.00 KB :eager alloc mem 611.00 KB
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980
:] 1980eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KB
[[2022-12-11 22:40:032022-12-11 22:40:03..859206859209: : E[E 2022-12-11 22:40:03 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:859229:638: 638] E] eager release cuda mem 625663 eager release cuda mem 625663
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-11 22:40:03.859284: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.863587: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 22:40:03.863682: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:40:03.864388: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 22:40:03.864479: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.864507: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:40:03[.2022-12-11 22:40:03864730.: 864729E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1926:] 1926Device 3 init p2p of link 1] 
Device 0 init p2p of link 2
[2022-12-11 22:40:03.864879: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:40:03.864914: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:40:03.865298: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.865670: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.865759: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.868871: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 22:40:03.868960: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:40:03.869078: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 22:40:03.869172: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:40:03.869625: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 22:40:03.869715: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:40:03.869758: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.869963: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.870267: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 22:40:03.870351: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:40:03.870508: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.871124: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:40:03.873079: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:40:03.873338: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7997582 / 100000000 nodes ( 8.00 %~8.00 %) | remote 22196532 / 100000000 nodes ( 22.20 %) | cpu 69805886 / 100000000 nodes ( 69.81 %) | 3.82 GB | 0.483173 secs 
[2022-12-11 22:40:03.874339: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:40:03.874410: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:40:03.874521: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:40:03.874632: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7998592 / 100000000 nodes ( 8.00 %~8.00 %) | remote 22195522 / 100000000 nodes ( 22.20 %) | cpu 69805886 / 100000000 nodes ( 69.81 %) | 3.82 GB | 0.508736 secs 
[2022-12-11 22:40:03.874799: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7999733 / 100000000 nodes ( 8.00 %~8.00 %) | remote 22194381 / 100000000 nodes ( 22.19 %) | cpu 69805886 / 100000000 nodes ( 69.81 %) | 3.82 GB | 0.481944 secs 
[2022-12-11 22:40:03.874942: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7998207 / 100000000 nodes ( 8.00 %~8.00 %) | remote 22195907 / 100000000 nodes ( 22.20 %) | cpu 69805886 / 100000000 nodes ( 69.81 %) | 3.82 GB | 0.480779 secs 
[2022-12-11 22:40:03.875531: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.85 GB
[2022-12-11 22:40:05.151538: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.09 GB
[2022-12-11 22:40:05.151825: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.09 GB
[2022-12-11 22:40:05.152083: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.09 GB
[2022-12-11 22:40:05.771818: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.34 GB
[2022-12-11 22:40:05.771943: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.34 GB
[2022-12-11 22:40:05.772281: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.34 GB
[2022-12-11 22:40:06.440499: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.59 GB
[2022-12-11 22:40:06.440637: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.59 GB
[2022-12-11 22:40:06.440937: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.59 GB
[2022-12-11 22:40:07.248935: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.99 GB
[2022-12-11 22:40:07.249063: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.99 GB
[2022-12-11 22:40:07.249467: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.99 GB
[2022-12-11 22:40:08.  5443: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.19 GB
[2022-12-11 22:40:08.  5585: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.19 GB
[HCTR][22:40:08.156][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][22:40:08.156][ERROR][RK0][tid #140145974040320]: replica 0 calling init per replica done, doing barrier
[HCTR][22:40:08.156][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][22:40:08.156][ERROR][RK0][tid #140145974040320]: replica 3 calling init per replica done, doing barrier
[HCTR][22:40:08.156][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][22:40:08.156][ERROR][RK0][tid #140145974040320]: replica 0 calling init per replica done, doing barrier done
[HCTR][22:40:08.156][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][22:40:08.156][ERROR][RK0][tid #140145974040320]: replica 3 calling init per replica done, doing barrier done
[HCTR][22:40:08.156][ERROR][RK0][main]: init per replica done
[HCTR][22:40:08.156][ERROR][RK0][tid #140145974040320]: init per replica done
[HCTR][22:40:08.156][ERROR][RK0][main]: init per replica done
[HCTR][22:40:08.159][ERROR][RK0][tid #140145974040320]: init per replica done
[HCTR][22:40:08.164][ERROR][RK0][tid #140145974040320]: 3 allocated 3276800 at 0x7f642f720000
[HCTR][22:40:08.164][ERROR][RK0][tid #140145974040320]: 3 allocated 6553600 at 0x7f77c0600000
[HCTR][22:40:08.164][ERROR][RK0][tid #140145974040320]: 3 allocated 3276800 at 0x7f77c0c40000
[HCTR][22:40:08.164][ERROR][RK0][tid #140145974040320]: 3 allocated 6553600 at 0x7f77c0f60000
[HCTR][22:40:08.164][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f642f720000
[HCTR][22:40:08.164][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f77c0600000
[HCTR][22:40:08.164][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f77c0c40000
[HCTR][22:40:08.164][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f77c0f60000
[HCTR][22:40:08.165][ERROR][RK0][tid #140145974040320]: 0 allocated 3276800 at 0x7f61c4920000
[HCTR][22:40:08.165][ERROR][RK0][tid #140145974040320]: 0 allocated 6553600 at 0x7f61c4e00000
[HCTR][22:40:08.165][ERROR][RK0][tid #140145974040320]: 0 allocated 3276800 at 0x7f5f2e50e800
[HCTR][22:40:08.165][ERROR][RK0][tid #140145974040320]: 0 allocated 6553600 at 0x7f5f2e82e800
[HCTR][22:40:08.169][ERROR][RK0][tid #140145982433024]: 1 allocated 3276800 at 0x7f642f720000
[HCTR][22:40:08.169][ERROR][RK0][tid #140145982433024]: 1 allocated 6553600 at 0x7f77c0600000
[HCTR][22:40:08.170][ERROR][RK0][tid #140145982433024]: 1 allocated 3276800 at 0x7f77c0c40000
[HCTR][22:40:08.170][ERROR][RK0][tid #140145982433024]: 1 allocated 6553600 at 0x7f77c0f60000




