2022-12-11 22:14:20.942807: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:14:21.020093: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:14:21.023028: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:14:21.023306: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:14:21.774855: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:14:21.774942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:14:21.791440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:14:21.822130: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:14:21.822298: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:14:21.824275: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 22:14:21.844563: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:14:21.844642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:14:21.848025: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:14:21.848093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:14:21.853500: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:14:21.853575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:14:21.856917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:14:21.859859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:14:21.865856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:14:21.888559: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:14:21.888733: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:14:21.889446: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:14:21.889566: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:14:21.890160: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 22:14:21.891044: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 22:14:21.899002: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:14:21.899141: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:14:21.900587: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][22:14:23.118][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:14:23.132][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:14:23.162][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:14:23.173][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 103it [00:01, 92.22it/s]warmup run: 206it [00:01, 198.68it/s]warmup run: 309it [00:01, 314.64it/s]warmup run: 413it [00:01, 434.73it/s]warmup run: 1it [00:01,  1.52s/it]warmup run: 517it [00:01, 549.92it/s]warmup run: 106it [00:01, 90.93it/s]warmup run: 623it [00:02, 658.41it/s]warmup run: 214it [00:01, 199.01it/s]warmup run: 726it [00:02, 744.75it/s]warmup run: 325it [00:01, 321.80it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 831it [00:02, 820.29it/s]warmup run: 437it [00:01, 450.52it/s]warmup run: 106it [00:01, 96.18it/s]warmup run: 936it [00:02, 880.05it/s]warmup run: 549it [00:02, 575.21it/s]warmup run: 213it [00:01, 208.08it/s]warmup run: 1042it [00:02, 926.77it/s]warmup run: 661it [00:02, 689.00it/s]warmup run: 320it [00:01, 329.28it/s]warmup run: 1146it [00:02, 935.72it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 768it [00:02, 772.97it/s]warmup run: 428it [00:01, 454.55it/s]warmup run: 1253it [00:02, 972.59it/s]warmup run: 109it [00:01, 98.16it/s]warmup run: 876it [00:02, 847.43it/s]warmup run: 536it [00:01, 575.00it/s]warmup run: 1366it [00:02, 1016.04it/s]warmup run: 218it [00:01, 211.39it/s]warmup run: 985it [00:02, 909.49it/s]warmup run: 637it [00:02, 660.90it/s]warmup run: 1472it [00:02, 1028.54it/s]warmup run: 327it [00:01, 334.19it/s]warmup run: 1092it [00:02, 947.09it/s]warmup run: 745it [00:02, 757.17it/s]warmup run: 1580it [00:02, 1043.49it/s]warmup run: 435it [00:01, 458.27it/s]warmup run: 1199it [00:02, 978.87it/s]warmup run: 858it [00:02, 849.31it/s]warmup run: 1687it [00:03, 1049.63it/s]warmup run: 544it [00:01, 579.05it/s]warmup run: 1306it [00:02, 998.47it/s]warmup run: 971it [00:02, 920.96it/s]warmup run: 1794it [00:03, 1050.15it/s]warmup run: 654it [00:02, 690.58it/s]warmup run: 1412it [00:02, 984.89it/s]warmup run: 1080it [00:02, 966.16it/s]warmup run: 1901it [00:03, 1047.78it/s]warmup run: 764it [00:02, 786.74it/s]warmup run: 1515it [00:02, 992.51it/s]warmup run: 1188it [00:02, 991.44it/s]warmup run: 2007it [00:03, 1046.13it/s]warmup run: 873it [00:02, 862.60it/s]warmup run: 1618it [00:03, 989.55it/s]warmup run: 1296it [00:02, 1014.50it/s]warmup run: 2137it [00:03, 1119.23it/s]warmup run: 983it [00:02, 925.11it/s]warmup run: 1720it [00:03, 997.81it/s]warmup run: 1405it [00:02, 1034.77it/s]warmup run: 2267it [00:03, 1171.33it/s]warmup run: 1094it [00:02, 973.28it/s]warmup run: 1823it [00:03, 1004.42it/s]warmup run: 1513it [00:02, 1046.80it/s]warmup run: 2397it [00:03, 1207.67it/s]warmup run: 1206it [00:02, 1013.90it/s]warmup run: 1925it [00:03, 1003.00it/s]warmup run: 1621it [00:02, 1052.69it/s]warmup run: 2527it [00:03, 1234.93it/s]warmup run: 1318it [00:02, 1043.17it/s]warmup run: 2031it [00:03, 1019.75it/s]warmup run: 1729it [00:03, 1051.81it/s]warmup run: 2658it [00:03, 1256.18it/s]warmup run: 1429it [00:02, 1054.98it/s]warmup run: 2162it [00:03, 1105.37it/s]warmup run: 1838it [00:03, 1061.45it/s]warmup run: 1541it [00:02, 1071.10it/s]warmup run: 2784it [00:03, 1201.30it/s]warmup run: 2294it [00:03, 1167.91it/s]warmup run: 1949it [00:03, 1073.16it/s]warmup run: 1653it [00:02, 1082.96it/s]warmup run: 2917it [00:04, 1238.48it/s]warmup run: 2426it [00:03, 1212.65it/s]warmup run: 2069it [00:03, 1110.26it/s]warmup run: 3000it [00:04, 721.94it/s] warmup run: 1764it [00:03, 1071.24it/s]warmup run: 2556it [00:03, 1237.51it/s]warmup run: 2198it [00:03, 1163.02it/s]warmup run: 1873it [00:03, 1070.73it/s]warmup run: 2690it [00:03, 1267.94it/s]warmup run: 2331it [00:03, 1210.30it/s]warmup run: 1982it [00:03, 1068.29it/s]warmup run: 2824it [00:04, 1287.12it/s]warmup run: 2454it [00:03, 1214.58it/s]warmup run: 2110it [00:03, 1128.66it/s]warmup run: 2959it [00:04, 1305.56it/s]warmup run: 2588it [00:03, 1250.26it/s]warmup run: 3000it [00:04, 715.64it/s] warmup run: 2243it [00:03, 1186.34it/s]warmup run: 2721it [00:03, 1272.45it/s]warmup run: 2372it [00:03, 1215.30it/s]warmup run: 2854it [00:03, 1287.89it/s]warmup run: 2506it [00:03, 1249.90it/s]warmup run: 2983it [00:04, 1257.86it/s]warmup run: 3000it [00:04, 735.65it/s] warmup run: 2639it [00:03, 1272.81it/s]warmup run: 2769it [00:03, 1279.16it/s]warmup run: 2901it [00:03, 1290.95it/s]warmup run: 3000it [00:04, 741.93it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1749.78it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1711.23it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1673.42it/s]warmup should be done:   5%|▌         | 160/3000 [00:00<00:01, 1596.69it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1791.01it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1746.42it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1734.48it/s]warmup should be done:  11%|█         | 337/3000 [00:00<00:01, 1693.55it/s]warmup should be done:  18%|█▊        | 525/3000 [00:00<00:01, 1756.76it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1795.85it/s]warmup should be done:  17%|█▋        | 511/3000 [00:00<00:01, 1714.44it/s]warmup should be done:  17%|█▋        | 524/3000 [00:00<00:01, 1742.86it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1804.42it/s]warmup should be done:  23%|██▎       | 686/3000 [00:00<00:01, 1725.59it/s]warmup should be done:  23%|██▎       | 703/3000 [00:00<00:01, 1759.28it/s]warmup should be done:  23%|██▎       | 701/3000 [00:00<00:01, 1684.07it/s]warmup should be done:  30%|███       | 901/3000 [00:00<00:01, 1801.66it/s]warmup should be done:  29%|██▊       | 860/3000 [00:00<00:01, 1730.26it/s]warmup should be done:  29%|██▉       | 879/3000 [00:00<00:01, 1753.89it/s]warmup should be done:  29%|██▉       | 870/3000 [00:00<00:01, 1567.46it/s]warmup should be done:  35%|███▍      | 1036/3000 [00:00<00:01, 1737.99it/s]warmup should be done:  36%|███▌      | 1082/3000 [00:00<00:01, 1801.23it/s]warmup should be done:  35%|███▌      | 1056/3000 [00:00<00:01, 1757.74it/s]warmup should be done:  35%|███▍      | 1048/3000 [00:00<00:01, 1634.75it/s]warmup should be done:  40%|████      | 1213/3000 [00:00<00:01, 1745.66it/s]warmup should be done:  42%|████▏     | 1263/3000 [00:00<00:00, 1798.06it/s]warmup should be done:  41%|████      | 1232/3000 [00:00<00:01, 1753.68it/s]warmup should be done:  41%|████      | 1228/3000 [00:00<00:01, 1685.14it/s]warmup should be done:  46%|████▋     | 1390/3000 [00:00<00:00, 1752.80it/s]warmup should be done:  48%|████▊     | 1444/3000 [00:00<00:00, 1800.51it/s]warmup should be done:  47%|████▋     | 1410/3000 [00:00<00:00, 1760.77it/s]warmup should be done:  47%|████▋     | 1408/3000 [00:00<00:00, 1719.70it/s]warmup should be done:  52%|█████▏    | 1568/3000 [00:00<00:00, 1759.15it/s]warmup should be done:  54%|█████▍    | 1625/3000 [00:00<00:00, 1797.98it/s]warmup should be done:  53%|█████▎    | 1587/3000 [00:00<00:00, 1752.50it/s]warmup should be done:  53%|█████▎    | 1587/3000 [00:00<00:00, 1740.26it/s]warmup should be done:  58%|█████▊    | 1745/3000 [00:01<00:00, 1759.57it/s]warmup should be done:  60%|██████    | 1806/3000 [00:01<00:00, 1800.43it/s]warmup should be done:  59%|█████▉    | 1763/3000 [00:01<00:00, 1750.38it/s]warmup should be done:  59%|█████▉    | 1766/3000 [00:01<00:00, 1755.18it/s]warmup should be done:  64%|██████▍   | 1921/3000 [00:01<00:00, 1758.01it/s]warmup should be done:  66%|██████▌   | 1987/3000 [00:01<00:00, 1797.24it/s]warmup should be done:  65%|██████▍   | 1939/3000 [00:01<00:00, 1750.92it/s]warmup should be done:  65%|██████▍   | 1942/3000 [00:01<00:00, 1741.05it/s]warmup should be done:  70%|███████   | 2100/3000 [00:01<00:00, 1765.48it/s]warmup should be done:  72%|███████▏  | 2168/3000 [00:01<00:00, 1798.79it/s]warmup should be done:  71%|███████   | 2117/3000 [00:01<00:00, 1758.01it/s]warmup should be done:  71%|███████   | 2119/3000 [00:01<00:00, 1749.29it/s]warmup should be done:  76%|███████▌  | 2279/3000 [00:01<00:00, 1771.13it/s]warmup should be done:  78%|███████▊  | 2348/3000 [00:01<00:00, 1795.90it/s]warmup should be done:  76%|███████▋  | 2293/3000 [00:01<00:00, 1751.59it/s]warmup should be done:  77%|███████▋  | 2297/3000 [00:01<00:00, 1756.14it/s]warmup should be done:  82%|████████▏ | 2459/3000 [00:01<00:00, 1777.34it/s]warmup should be done:  84%|████████▍ | 2530/3000 [00:01<00:00, 1802.52it/s]warmup should be done:  82%|████████▏ | 2470/3000 [00:01<00:00, 1754.74it/s]warmup should be done:  82%|████████▎ | 2475/3000 [00:01<00:00, 1762.20it/s]warmup should be done:  88%|████████▊ | 2638/3000 [00:01<00:00, 1780.06it/s]warmup should be done:  90%|█████████ | 2711/3000 [00:01<00:00, 1800.59it/s]warmup should be done:  88%|████████▊ | 2646/3000 [00:01<00:00, 1750.92it/s]warmup should be done:  88%|████████▊ | 2654/3000 [00:01<00:00, 1769.81it/s]warmup should be done:  94%|█████████▍| 2817/3000 [00:01<00:00, 1782.87it/s]warmup should be done:  96%|█████████▋| 2893/3000 [00:01<00:00, 1803.49it/s]warmup should be done:  94%|█████████▍| 2824/3000 [00:01<00:00, 1759.45it/s]warmup should be done:  94%|█████████▍| 2832/3000 [00:01<00:00, 1770.95it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1799.82it/s]warmup should be done: 100%|█████████▉| 2996/3000 [00:01<00:00, 1784.88it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1756.99it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1756.68it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1753.18it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1731.80it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 183/3000 [00:00<00:01, 1827.40it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1614.18it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1731.17it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1741.21it/s]warmup should be done:  12%|█▏        | 345/3000 [00:00<00:01, 1740.83it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1778.50it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1817.05it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1764.64it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1780.61it/s]warmup should be done:  18%|█▊        | 540/3000 [00:00<00:01, 1802.14it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1762.82it/s]warmup should be done:  18%|█▊        | 548/3000 [00:00<00:01, 1790.30it/s]warmup should be done:  24%|██▎       | 712/3000 [00:00<00:01, 1803.53it/s]warmup should be done:  24%|██▍       | 723/3000 [00:00<00:01, 1810.86it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1782.68it/s]warmup should be done:  24%|██▍       | 728/3000 [00:00<00:01, 1740.08it/s]warmup should be done:  30%|██▉       | 895/3000 [00:00<00:01, 1811.04it/s]warmup should be done:  30%|███       | 905/3000 [00:00<00:01, 1813.33it/s]warmup should be done:  30%|██▉       | 897/3000 [00:00<00:01, 1800.88it/s]warmup should be done:  30%|███       | 903/3000 [00:00<00:01, 1741.16it/s]warmup should be done:  36%|███▌      | 1079/3000 [00:00<00:01, 1819.99it/s]warmup should be done:  36%|███▋      | 1088/3000 [00:00<00:01, 1817.37it/s]warmup should be done:  36%|███▌      | 1078/3000 [00:00<00:01, 1800.03it/s]warmup should be done:  36%|███▌      | 1079/3000 [00:00<00:01, 1747.04it/s]warmup should be done:  42%|████▏     | 1262/3000 [00:00<00:00, 1822.17it/s]warmup should be done:  42%|████▏     | 1271/3000 [00:00<00:00, 1819.40it/s]warmup should be done:  42%|████▏     | 1259/3000 [00:00<00:00, 1789.28it/s]warmup should be done:  42%|████▏     | 1260/3000 [00:00<00:00, 1766.06it/s]warmup should be done:  48%|████▊     | 1447/3000 [00:00<00:00, 1830.25it/s]warmup should be done:  48%|████▊     | 1454/3000 [00:00<00:00, 1820.04it/s]warmup should be done:  48%|████▊     | 1438/3000 [00:00<00:00, 1762.93it/s]warmup should be done:  48%|████▊     | 1440/3000 [00:00<00:00, 1773.52it/s]warmup should be done:  54%|█████▍    | 1631/3000 [00:00<00:00, 1832.93it/s]warmup should be done:  54%|█████▍    | 1621/3000 [00:00<00:00, 1782.07it/s]warmup should be done:  55%|█████▍    | 1637/3000 [00:00<00:00, 1763.02it/s]warmup should be done:  54%|█████▍    | 1618/3000 [00:00<00:00, 1746.17it/s]warmup should be done:  60%|██████    | 1815/3000 [00:01<00:00, 1835.03it/s]warmup should be done:  60%|██████    | 1804/3000 [00:01<00:00, 1795.17it/s]warmup should be done:  60%|██████    | 1814/3000 [00:01<00:00, 1758.68it/s]warmup should be done:  60%|█████▉    | 1795/3000 [00:01<00:00, 1751.75it/s]warmup should be done:  67%|██████▋   | 1999/3000 [00:01<00:00, 1832.84it/s]warmup should be done:  66%|██████▌   | 1986/3000 [00:01<00:00, 1799.99it/s]warmup should be done:  66%|██████▋   | 1992/3000 [00:01<00:00, 1764.03it/s]warmup should be done:  66%|██████▌   | 1971/3000 [00:01<00:00, 1753.35it/s]warmup should be done:  73%|███████▎  | 2183/3000 [00:01<00:00, 1830.76it/s]warmup should be done:  72%|███████▏  | 2167/3000 [00:01<00:00, 1801.86it/s]warmup should be done:  72%|███████▏  | 2169/3000 [00:01<00:00, 1752.87it/s]warmup should be done:  72%|███████▏  | 2147/3000 [00:01<00:00, 1744.35it/s]warmup should be done:  79%|███████▉  | 2367/3000 [00:01<00:00, 1802.27it/s]warmup should be done:  78%|███████▊  | 2348/3000 [00:01<00:00, 1779.06it/s]warmup should be done:  78%|███████▊  | 2347/3000 [00:01<00:00, 1760.56it/s]warmup should be done:  77%|███████▋  | 2324/3000 [00:01<00:00, 1749.56it/s]warmup should be done:  85%|████████▌ | 2553/3000 [00:01<00:00, 1819.43it/s]warmup should be done:  84%|████████▍ | 2530/3000 [00:01<00:00, 1790.55it/s]warmup should be done:  84%|████████▍ | 2526/3000 [00:01<00:00, 1767.70it/s]warmup should be done:  83%|████████▎ | 2501/3000 [00:01<00:00, 1754.96it/s]warmup should be done:  91%|█████████▏| 2739/3000 [00:01<00:00, 1830.81it/s]warmup should be done:  90%|█████████ | 2710/3000 [00:01<00:00, 1791.33it/s]warmup should be done:  90%|█████████ | 2705/3000 [00:01<00:00, 1772.98it/s]warmup should be done:  89%|████████▉ | 2678/3000 [00:01<00:00, 1756.56it/s]warmup should be done:  97%|█████████▋| 2923/3000 [00:01<00:00, 1825.56it/s]warmup should be done:  96%|█████████▌| 2883/3000 [00:01<00:00, 1771.34it/s]warmup should be done:  95%|█████████▌| 2856/3000 [00:01<00:00, 1762.09it/s]warmup should be done:  96%|█████████▋| 2890/3000 [00:01<00:00, 1750.47it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1815.83it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1780.59it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1776.43it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1755.53it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fe0bd5a1250>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fe0bd5a1160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fe0bd5a0190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fe0bd5a10a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 22:15:35.889330: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fdc912679c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:15:35.889416: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:15:35.898502: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:15:35.909375: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fdc95a6b590 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:15:35.909438: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:15:35.914830: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fdc91a6b500 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:15:35.914877: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:15:35.915063: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fdc91a64370 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:15:35.915112: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:15:35.916878: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:15:35.924193: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:15:35.927287: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:15:36.676131: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:15:36.703333: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:15:36.707488: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:15:36.718167: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:15:41.998117: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:15:42.421307: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:15:43.017035: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:15:43.072912: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][22:16:39.652][ERROR][RK0][tid #140585780356864]: replica 0 reaches 1000, calling init pre replica
[HCTR][22:16:39.653][ERROR][RK0][tid #140585780356864]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:16:39.657][ERROR][RK0][tid #140585780356864]: coll ps creation done
[HCTR][22:16:39.657][ERROR][RK0][tid #140585780356864]: replica 0 waits for coll ps creation barrier
[HCTR][22:16:39.693][ERROR][RK0][tid #140585914574592]: replica 3 reaches 1000, calling init pre replica
[HCTR][22:16:39.694][ERROR][RK0][tid #140585914574592]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:16:39.698][ERROR][RK0][tid #140585914574592]: coll ps creation done
[HCTR][22:16:39.698][ERROR][RK0][tid #140585914574592]: replica 3 waits for coll ps creation barrier
[HCTR][22:16:39.727][ERROR][RK0][tid #140585788749568]: replica 1 reaches 1000, calling init pre replica
[HCTR][22:16:39.727][ERROR][RK0][tid #140585788749568]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:16:39.731][ERROR][RK0][tid #140585788749568]: coll ps creation done
[HCTR][22:16:39.731][ERROR][RK0][tid #140585788749568]: replica 1 waits for coll ps creation barrier
[HCTR][22:16:40.086][ERROR][RK0][tid #140585788749568]: replica 2 reaches 1000, calling init pre replica
[HCTR][22:16:40.086][ERROR][RK0][tid #140585788749568]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:16:40.089][ERROR][RK0][tid #140585788749568]: coll ps creation done
[HCTR][22:16:40.089][ERROR][RK0][tid #140585788749568]: replica 2 waits for coll ps creation barrier
[HCTR][22:16:40.089][ERROR][RK0][tid #140585780356864]: replica 0 preparing frequency
[HCTR][22:16:41.054][ERROR][RK0][tid #140585780356864]: replica 0 preparing frequency done
[HCTR][22:16:41.091][ERROR][RK0][tid #140585780356864]: replica 0 calling init per replica
[HCTR][22:16:41.091][ERROR][RK0][tid #140585788749568]: replica 1 calling init per replica
[HCTR][22:16:41.091][ERROR][RK0][tid #140585788749568]: replica 2 calling init per replica
[HCTR][22:16:41.091][ERROR][RK0][tid #140585788749568]: Calling build_v2
[HCTR][22:16:41.091][ERROR][RK0][tid #140585788749568]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:16:41.091][ERROR][RK0][tid #140585788749568]: Calling build_v2
[HCTR][22:16:41.091][ERROR][RK0][tid #140585780356864]: Calling build_v2
[HCTR][22:16:41.091][ERROR][RK0][tid #140585788749568]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:16:41.091][ERROR][RK0][tid #140585780356864]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:16:41.091][ERROR][RK0][tid #140585914574592]: replica 3 calling init per replica
[HCTR][22:16:41.091][ERROR][RK0][tid #140585914574592]: Calling build_v2
[2022-12-11 22:16:41. 91307[HCTR][22:16:41.091][ERROR][RK0][tid #140585914574592]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
: E[ /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:2022-12-11 22:16:41136.[]  91324using concurrent impl MPS: 2022-12-11 22:16:41
E.  91351/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: :E136 ] [/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccusing concurrent impl MPS2022-12-11 22:16:41:
.136 91435] : using concurrent impl MPSE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 22:16:41. 93027: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 22:16:41. 93076: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 22:16:41. 93120: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 22:16:41. 93164: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 22:16:41. 93235: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 22:16:41. 93283: E[ 2022-12-11 22:16:41/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.: 93292212: [] E2022-12-11 22:16:41build symm link desc with 4X Tesla V100-SXM2-16GB out of 4 .
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 93323:: 196[E] 2022-12-11 22:16:41 assigning 8 to cpu./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
 93399:: 196E]  assigning 8 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
:213] remote time is 8.68421
[[2022-12-11 22:16:412022-12-11 22:16:41.. 93482 93475: [: E2022-12-11 22:16:41E . /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 93497/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:: :214E212]  ] cpu time is 30/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4
:
212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 22:16:41[.2022-12-11 22:16:41 93648.:  93657E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc213:] 213remote time is 8.68421] 
remote time is 8.68421
[[2022-12-11 22:16:412022-12-11 22:16:41.. 93761 93764: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::214214] ] cpu time is 30cpu time is 30

[2022-12-11 22:17:06.938078: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 22:17:07.  5573: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 22:17:07.  5675: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 22:17:07.  6919: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 22:17:07.105193: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 22:17:07.483021: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 22:17:07.483117: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 22:17:14.780217: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1022
[2022-12-11 22:17:14.780425: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 22:17:16.598191: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 22:17:16.598310: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1022
[2022-12-11 22:17:16.614456: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 22:17:16.614554: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1022 blocks, 4 devices
[2022-12-11 22:17:17.727024: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 22:17:17.746080: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 22:17:17.746880: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 22:17:17.756827: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 22:17:17.854876: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 22:17:19.786875: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 22:17:19.790810: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 22:17:19.790942: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 22:17:19.799880: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 22:17:19.799950: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 22:17:19.799984: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 22:17:19.800015: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 22:17:19.801203: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:17:19.801252: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:17:19.802425: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:17:19.802995: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-11 22:17:19.8238792022-12-11 22:17:19: .E823879 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 202/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :2021 solved] 
3 solved
[2022-12-11 22:17:19[.2022-12-11 22:17:19823999.: 824004E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc205:] 205worker 0 thread 1 initing device 1] 
worker 0 thread 3 initing device 3
[2022-12-11 22:17:19.824630: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 22:17:19.824740: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 22:17:19.824854: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:17:19.824913: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:17:19.825287: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:17:19.825339: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:17:19.826224: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:17:19.826257: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:17:19.826292: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:17:19.826361: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:17:19.834718: [E2022-12-11 22:17:19 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu834739:: 1980E]  eager alloc mem 381.47 MB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 381.47 MB
[2022-12-11 22:17:19.834900: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:17:19.836915: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:17:19.875861: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1022.00 Bytes
[2022-12-11 22:17:19.877742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1022
[2022-12-11 22:17:19.877796: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:17:19.878622: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 22:17:19.879066: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:17:19.880010: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:17:19.880056: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.87 MB
[2022-12-11 22:17:19.890003: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:17:19.890616: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:17:19.890661: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.86 GB
[2022-12-11 22:17:19.924644: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1022.00 Bytes
[2022-12-11 22:17:19.926545: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1022
[2022-12-11 22:17:19.926596: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:17:19.927368: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 22:17:19.927751: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:17:19.928678: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:17:19.928719: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.72 MB
[[2022-12-11 22:17:192022-12-11 22:17:19..933896933897: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1022.00 Byteseager alloc mem 1022.00 Bytes

[2022-12-11 22:17:19.935753: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1022
[2022-12-11 22:17:19.935814: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:17:19.936173: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1022
[2022-12-11 22:17:19.936233: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:17:19.936577: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 22:17:19.937297: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 22:17:19.937522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:17:19.937716: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:17:19.938456: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:17:19.938512: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.84 MB
[2022-12-11 22:17:19.938654: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:17:19.938711: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.84 MB
[2022-12-11 22:17:19.941112: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:17:19.941681: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:17:19.941724: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.84 GB
[2022-12-11 22:17:19.951553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:17:19.951674: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:17:19.952137: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:17:19.952178: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.86 GB
[2022-12-11 22:17:19.952250: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:17:19.952293: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.86 GB
[[[[2022-12-11 22:17:202022-12-11 22:17:202022-12-11 22:17:202022-12-11 22:17:20....209329209328209329209328: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 1 init p2p of link 2Device 2 init p2p of link 3Device 0 init p2p of link 1



[[[2022-12-11 22:17:202022-12-11 22:17:202022-12-11 22:17:20...209651209653209655: : : EEE   [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 22:17:20:::.198019801980209714] ] ] : eager alloc mem 611.00 KBeager alloc mem 611.00 KBeager alloc mem 611.00 KBE


 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:17:20.210566: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[[] [2022-12-11 22:17:202022-12-11 22:17:20eager release cuda mem 6256632022-12-11 22:17:20..
.210583210582210588: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:::638638638] ] ] eager release cuda mem 625663eager release cuda mem 625663eager release cuda mem 625663


[2022-12-11 22:17:20.218952: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 22:17:20.219089: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:17:20.219162: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[[2022-12-11 22:17:202022-12-11 22:17:20..219279219288: : E[E 2022-12-11 22:17:20 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:219303:1926: 1980] E] Device 1 init p2p of link 3 eager alloc mem 611.00 KB
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1926] Device 0 init p2p of link 2
[2022-12-11 22:17:20.219465: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB[
2022-12-11 22:17:20.219491: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:17:20.219888: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:17:20.220193: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:17:20.220257: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-11 22:17:20
.220280: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:17:20.223887: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 22:17:20.223995: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:17:20.224581: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 22:17:20.[2246582022-12-11 22:17:20: .E224676 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1926/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :Device 3 init p2p of link 21980
] eager alloc mem 611.00 KB
[2022-12-11 22:17:20.224747: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926[] 2022-12-11 22:17:20Device 0 init p2p of link 3.[
2247792022-12-11 22:17:20: .E224798 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :[eager alloc mem 611.00 KB6382022-12-11 22:17:20
] .eager release cuda mem 625663224868
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:17:20.225481: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:17:20[.2022-12-11 22:17:20225671.: 225676E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-11 22:17:20.227966: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 22:17:20.228230: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5954920 / 100000000 nodes ( 5.95 %~6.00 %) | remote 17370220 / 100000000 nodes ( 17.37 %) | cpu 76674860 / 100000000 nodes ( 76.67 %) | 2.84 GB | 0.401891 secs 
[2022-12-11 22:17:20.229234: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 22:17:20.229378: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 22:17:20.229491: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5987088 / 100000000 nodes ( 5.99 %~6.00 %) | remote 17338052 / 100000000 nodes ( 17.34 %) | cpu 76674860 / 100000000 nodes ( 76.67 %) | 2.86 GB | 0.404594 secs 
[2022-12-11 22:17:20.229682: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5995179 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17329961 / 100000000 nodes ( 17.33 %) | cpu 76674860 / 100000000 nodes ( 76.67 %) | 2.86 GB | 0.428437 secs 
[2022-12-11 22:17:20.229714: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 22:17:20.230019: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5987953 / 100000000 nodes ( 5.99 %~6.00 %) | remote 17337187 / 100000000 nodes ( 17.34 %) | cpu 76674860 / 100000000 nodes ( 76.67 %) | 2.86 GB | 0.404693 secs 
[2022-12-11 22:17:20.230535: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.56 GB
[2022-12-11 22:17:21.173479: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.81 GB
[2022-12-11 22:17:21.173634: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.81 GB
[2022-12-11 22:17:21.174528: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.81 GB
[2022-12-11 22:17:22.174761: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.06 GB
[2022-12-11 22:17:22.174952: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.06 GB
[2022-12-11 22:17:22.175611: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.06 GB
[2022-12-11 22:17:22.863332: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.30 GB
[2022-12-11 22:17:22.863465: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.30 GB
[2022-12-11 22:17:22.863805: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.30 GB
[2022-12-11 22:17:23.547469: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.71 GB
[2022-12-11 22:17:23.547593: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.71 GB
[2022-12-11 22:17:23.548483: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.71 GB
[2022-12-11 22:17:24.446499: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.90 GB
[2022-12-11 22:17:24.446647: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.90 GB
[HCTR][22:17:24.548][ERROR][RK0][tid #140585788749568]: replica 1 calling init per replica done, doing barrier
[HCTR][22:17:24.548][ERROR][RK0][tid #140585914574592]: replica 3 calling init per replica done, doing barrier
[HCTR][22:17:24.548][ERROR][RK0][tid #140585788749568]: replica 2 calling init per replica done, doing barrier
[HCTR][22:17:24.548][ERROR][RK0][tid #140585780356864]: replica 0 calling init per replica done, doing barrier
[HCTR][22:17:24.548][ERROR][RK0][tid #140585788749568]: replica 2 calling init per replica done, doing barrier done
[HCTR][22:17:24.548][ERROR][RK0][tid #140585788749568]: replica 1 calling init per replica done, doing barrier done
[HCTR][22:17:24.548][ERROR][RK0][tid #140585780356864]: replica 0 calling init per replica done, doing barrier done
[HCTR][22:17:24.548][ERROR][RK0][tid #140585914574592]: replica 3 calling init per replica done, doing barrier done
[HCTR][22:17:24.548][ERROR][RK0][tid #140585788749568]: init per replica done
[HCTR][22:17:24.548][ERROR][RK0][tid #140585788749568]: init per replica done
[HCTR][22:17:24.548][ERROR][RK0][tid #140585914574592]: init per replica done
[HCTR][22:17:24.551][ERROR][RK0][tid #140585780356864]: init per replica done
[HCTR][22:17:24.583][ERROR][RK0][tid #140585788749568]: 2 allocated 3276800 at 0x7fc318238400
[HCTR][22:17:24.583][ERROR][RK0][tid #140585788749568]: 2 allocated 6553600 at 0x7fc318558400
[HCTR][22:17:24.583][ERROR][RK0][tid #140585788749568]: 2 allocated 3276800 at 0x7fc318b98400
[HCTR][22:17:24.583][ERROR][RK0][tid #140585788749568]: 2 allocated 6553600 at 0x7fc318eb8400
[HCTR][22:17:24.584][ERROR][RK0][tid #140585914574592]: 3 allocated 3276800 at 0x7fc260238400
[HCTR][22:17:24.585][ERROR][RK0][tid #140585914574592]: 3 allocated 6553600 at 0x7fc260558400
[HCTR][22:17:24.585][ERROR][RK0][tid #140585914574592]: 3 allocated 3276800 at 0x7fc260b98400
[HCTR][22:17:24.585][ERROR][RK0][tid #140585914574592]: 3 allocated 6553600 at 0x7fc260eb8400
[HCTR][22:17:24.585][ERROR][RK0][tid #140585788749568]: 1 allocated 3276800 at 0x7fc21c238400
[HCTR][22:17:24.585][ERROR][RK0][tid #140585788749568]: 1 allocated 6553600 at 0x7fc21c558400
[HCTR][22:17:24.585][ERROR][RK0][tid #140585788749568]: 1 allocated 3276800 at 0x7fc21cb98400
[HCTR][22:17:24.585][ERROR][RK0][tid #140585788749568]: 1 allocated 6553600 at 0x7fc21ceb8400
[HCTR][22:17:24.588][ERROR][RK0][main]: 0 allocated 3276800 at 0x7fc21c320000
[HCTR][22:17:24.588][ERROR][RK0][main]: 0 allocated 6553600 at 0x7fc21c640000
[HCTR][22:17:24.588][ERROR][RK0][main]: 0 allocated 3276800 at 0x7fc21cc80000
[HCTR][22:17:24.588][ERROR][RK0][main]: 0 allocated 6553600 at 0x7fc21cfa0000
