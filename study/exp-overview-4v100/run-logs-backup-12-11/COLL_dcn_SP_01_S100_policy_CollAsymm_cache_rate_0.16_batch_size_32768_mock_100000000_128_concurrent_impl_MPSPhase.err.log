2022-12-12 02:19:15.984027: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:19:15.993171: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:19:16.000935: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:19:16.024291: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:19:16.960683: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:19:16.960765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:19:16.973422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:19:16.987026: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:19:16.987106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:19:16.996888: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:19:16.996969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:19:17.004376: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:19:17.004373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:19:17.004478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:19:17.008184: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:19:17.008355: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:19:17.010417: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 02:19:17.011654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:19:17.017999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:19:17.038935: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:19:17.039128: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:19:17.040712: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 02:19:17.045226: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:19:17.045392: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:19:17.046891: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 02:19:17.052785: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:19:17.052943: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:19:17.054323: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][02:19:18.289][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:19:18.305][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:19:18.333][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:19:18.353][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 83it [00:01, 74.49it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 162it [00:01, 156.00it/s]warmup run: 101it [00:01, 91.26it/s]warmup run: 268it [00:01, 282.21it/s]warmup run: 208it [00:01, 203.28it/s]warmup run: 377it [00:01, 416.39it/s]warmup run: 311it [00:01, 319.48it/s]warmup run: 487it [00:01, 547.35it/s]warmup run: 414it [00:01, 437.66it/s]warmup run: 590it [00:02, 650.39it/s]warmup run: 517it [00:01, 551.02it/s]warmup run: 698it [00:02, 749.70it/s]warmup run: 614it [00:02, 640.30it/s]warmup run: 800it [00:02, 814.96it/s]warmup run: 0it [00:00, ?it/s]warmup run: 723it [00:02, 744.73it/s]warmup run: 910it [00:02, 889.41it/s]warmup run: 1it [00:01,  1.52s/it]warmup run: 835it [00:02, 837.99it/s]warmup run: 1019it [00:02, 942.95it/s]warmup run: 107it [00:01, 91.54it/s]warmup run: 947it [00:02, 911.33it/s]warmup run: 1126it [00:02, 976.47it/s]warmup run: 218it [00:01, 202.54it/s]warmup run: 1058it [00:02, 965.36it/s]warmup run: 1233it [00:02, 1000.59it/s]warmup run: 321it [00:01, 313.81it/s]warmup run: 1166it [00:02, 996.76it/s]warmup run: 1339it [00:02, 1012.94it/s]warmup run: 416it [00:01, 416.25it/s]warmup run: 1275it [00:02, 1021.09it/s]warmup run: 1445it [00:02, 1018.12it/s]warmup run: 523it [00:02, 537.97it/s]warmup run: 1385it [00:02, 1041.60it/s]warmup run: 1550it [00:02, 1012.96it/s]warmup run: 630it [00:02, 649.64it/s]warmup run: 1494it [00:02, 1038.84it/s]warmup run: 1657it [00:03, 1028.17it/s]warmup run: 738it [00:02, 747.92it/s]warmup run: 1601it [00:02, 1039.11it/s]warmup run: 1764it [00:03, 1040.23it/s]warmup run: 847it [00:02, 831.32it/s]warmup run: 1707it [00:03, 1041.34it/s]warmup run: 1870it [00:03, 1044.39it/s]warmup run: 955it [00:02, 895.79it/s]warmup run: 1813it [00:03, 1042.58it/s]warmup run: 1976it [00:03, 1047.03it/s]warmup run: 1061it [00:02, 933.72it/s]warmup run: 1919it [00:03, 1047.11it/s]warmup run: 2104it [00:03, 1115.64it/s]warmup run: 1171it [00:02, 977.56it/s]warmup run: 2029it [00:03, 1062.52it/s]warmup run: 2240it [00:03, 1186.23it/s]warmup run: 1279it [00:02, 1005.27it/s]warmup run: 2160it [00:03, 1134.71it/s]warmup run: 2377it [00:03, 1239.27it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1387it [00:02, 1026.03it/s]warmup run: 2289it [00:03, 1180.65it/s]warmup run: 2513it [00:03, 1275.06it/s]warmup run: 100it [00:01, 90.85it/s]warmup run: 1494it [00:02, 1033.41it/s]warmup run: 2420it [00:03, 1218.95it/s]warmup run: 2651it [00:03, 1303.62it/s]warmup run: 204it [00:01, 200.13it/s]warmup run: 1603it [00:03, 1049.48it/s]warmup run: 2551it [00:03, 1244.45it/s]warmup run: 2786it [00:03, 1316.94it/s]warmup run: 309it [00:01, 319.95it/s]warmup run: 1711it [00:03, 1049.17it/s]warmup run: 2676it [00:03, 1220.32it/s]warmup run: 2922it [00:04, 1328.39it/s]warmup run: 415it [00:01, 443.46it/s]warmup run: 3000it [00:04, 726.79it/s] warmup run: 1818it [00:03, 1054.84it/s]warmup run: 2805it [00:03, 1238.63it/s]warmup run: 521it [00:01, 561.79it/s]warmup run: 1927it [00:03, 1064.98it/s]warmup run: 2938it [00:04, 1265.47it/s]warmup run: 627it [00:02, 668.38it/s]warmup run: 3000it [00:04, 727.77it/s] warmup run: 2039it [00:03, 1079.61it/s]warmup run: 733it [00:02, 759.30it/s]warmup run: 2174it [00:03, 1157.96it/s]warmup run: 839it [00:02, 833.81it/s]warmup run: 2309it [00:03, 1213.00it/s]warmup run: 946it [00:02, 894.03it/s]warmup run: 2444it [00:03, 1251.68it/s]warmup run: 1051it [00:02, 907.42it/s]warmup run: 2578it [00:03, 1277.19it/s]warmup run: 1160it [00:02, 956.95it/s]warmup run: 2713it [00:03, 1297.94it/s]warmup run: 1268it [00:02, 990.61it/s]warmup run: 2846it [00:04, 1306.45it/s]warmup run: 1375it [00:02, 1012.81it/s]warmup run: 2981it [00:04, 1317.52it/s]warmup run: 3000it [00:04, 720.72it/s] warmup run: 1484it [00:02, 1032.59it/s]warmup run: 1591it [00:02, 1042.49it/s]warmup run: 1701it [00:03, 1056.91it/s]warmup run: 1809it [00:03, 1062.32it/s]warmup run: 1917it [00:03, 1064.87it/s]warmup run: 2032it [00:03, 1089.52it/s]warmup run: 2166it [00:03, 1162.04it/s]warmup run: 2302it [00:03, 1218.80it/s]warmup run: 2436it [00:03, 1254.94it/s]warmup run: 2573it [00:03, 1287.12it/s]warmup run: 2707it [00:03, 1302.58it/s]warmup run: 2843it [00:03, 1317.82it/s]warmup run: 2980it [00:04, 1331.26it/s]warmup run: 3000it [00:04, 736.65it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1794.13it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1703.71it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1646.63it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1676.54it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1748.39it/s]warmup should be done:  11%|█▏        | 340/3000 [00:00<00:01, 1705.29it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1755.17it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1786.32it/s]warmup should be done:  18%|█▊        | 526/3000 [00:00<00:01, 1756.54it/s]warmup should be done:  17%|█▋        | 512/3000 [00:00<00:01, 1710.67it/s]warmup should be done:  18%|█▊        | 541/3000 [00:00<00:01, 1795.31it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1758.68it/s]warmup should be done:  24%|██▎       | 705/3000 [00:00<00:01, 1767.49it/s]warmup should be done:  23%|██▎       | 686/3000 [00:00<00:01, 1719.27it/s]warmup should be done:  24%|██▎       | 705/3000 [00:00<00:01, 1764.18it/s]warmup should be done:  24%|██▍       | 724/3000 [00:00<00:01, 1805.18it/s]warmup should be done:  29%|██▉       | 883/3000 [00:00<00:01, 1769.67it/s]warmup should be done:  29%|██▊       | 858/3000 [00:00<00:01, 1716.32it/s]warmup should be done:  29%|██▉       | 882/3000 [00:00<00:01, 1763.44it/s]warmup should be done:  30%|███       | 905/3000 [00:00<00:01, 1795.16it/s]warmup should be done:  35%|███▌      | 1062/3000 [00:00<00:01, 1773.72it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1767.97it/s]warmup should be done:  36%|███▌      | 1085/3000 [00:00<00:01, 1795.48it/s]warmup should be done:  34%|███▍      | 1030/3000 [00:00<00:01, 1567.06it/s]warmup should be done:  41%|████▏     | 1240/3000 [00:00<00:00, 1772.89it/s]warmup should be done:  41%|████▏     | 1238/3000 [00:00<00:00, 1770.17it/s]warmup should be done:  42%|████▏     | 1265/3000 [00:00<00:00, 1789.72it/s]warmup should be done:  40%|███▉      | 1189/3000 [00:00<00:01, 1567.24it/s]warmup should be done:  47%|████▋     | 1418/3000 [00:00<00:00, 1773.90it/s]warmup should be done:  47%|████▋     | 1417/3000 [00:00<00:00, 1773.53it/s]warmup should be done:  48%|████▊     | 1446/3000 [00:00<00:00, 1793.32it/s]warmup should be done:  45%|████▌     | 1350/3000 [00:00<00:01, 1578.99it/s]warmup should be done:  53%|█████▎    | 1596/3000 [00:00<00:00, 1775.20it/s]warmup should be done:  53%|█████▎    | 1596/3000 [00:00<00:00, 1777.24it/s]warmup should be done:  54%|█████▍    | 1626/3000 [00:00<00:00, 1789.51it/s]warmup should be done:  51%|█████     | 1528/3000 [00:00<00:00, 1637.88it/s]warmup should be done:  59%|█████▉    | 1775/3000 [00:01<00:00, 1776.95it/s]warmup should be done:  59%|█████▉    | 1777/3000 [00:01<00:00, 1786.03it/s]warmup should be done:  60%|██████    | 1806/3000 [00:01<00:00, 1791.81it/s]warmup should be done:  57%|█████▋    | 1706/3000 [00:01<00:00, 1680.63it/s]warmup should be done:  65%|██████▌   | 1953/3000 [00:01<00:00, 1777.57it/s]warmup should be done:  65%|██████▌   | 1956/3000 [00:01<00:00, 1770.38it/s]warmup should be done:  66%|██████▌   | 1986/3000 [00:01<00:00, 1790.71it/s]warmup should be done:  63%|██████▎   | 1885/3000 [00:01<00:00, 1710.91it/s]warmup should be done:  71%|███████   | 2132/3000 [00:01<00:00, 1781.07it/s]warmup should be done:  71%|███████   | 2135/3000 [00:01<00:00, 1773.83it/s]warmup should be done:  72%|███████▏  | 2166/3000 [00:01<00:00, 1756.98it/s]warmup should be done:  69%|██████▉   | 2063/3000 [00:01<00:00, 1731.18it/s]warmup should be done:  77%|███████▋  | 2312/3000 [00:01<00:00, 1785.36it/s]warmup should be done:  77%|███████▋  | 2314/3000 [00:01<00:00, 1776.89it/s]warmup should be done:  78%|███████▊  | 2342/3000 [00:01<00:00, 1719.84it/s]warmup should be done:  75%|███████▍  | 2242/3000 [00:01<00:00, 1746.16it/s]warmup should be done:  83%|████████▎ | 2493/3000 [00:01<00:00, 1790.42it/s]warmup should be done:  83%|████████▎ | 2492/3000 [00:01<00:00, 1736.16it/s]warmup should be done:  84%|████████▍ | 2525/3000 [00:01<00:00, 1749.70it/s]warmup should be done:  81%|████████  | 2421/3000 [00:01<00:00, 1758.58it/s]warmup should be done:  89%|████████▉ | 2673/3000 [00:01<00:00, 1791.98it/s]warmup should be done:  89%|████████▉ | 2669/3000 [00:01<00:00, 1744.70it/s]warmup should be done:  90%|█████████ | 2707/3000 [00:01<00:00, 1768.39it/s]warmup should be done:  87%|████████▋ | 2600/3000 [00:01<00:00, 1767.89it/s]warmup should be done:  95%|█████████▌| 2853/3000 [00:01<00:00, 1793.77it/s]warmup should be done:  95%|█████████▍| 2847/3000 [00:01<00:00, 1754.54it/s]warmup should be done:  96%|█████████▋| 2889/3000 [00:01<00:00, 1781.60it/s]warmup should be done:  93%|█████████▎| 2780/3000 [00:01<00:00, 1774.91it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1781.09it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1779.51it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1762.82it/s]warmup should be done:  99%|█████████▊| 2959/3000 [00:01<00:00, 1778.37it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1707.31it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1839.23it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1831.06it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1721.71it/s]warmup should be done:   5%|▌         | 156/3000 [00:00<00:01, 1557.32it/s]warmup should be done:  12%|█▏        | 370/3000 [00:00<00:01, 1848.45it/s]warmup should be done:  11%|█         | 332/3000 [00:00<00:01, 1675.22it/s]warmup should be done:  12%|█▏        | 368/3000 [00:00<00:01, 1830.87it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1791.44it/s]warmup should be done:  17%|█▋        | 509/3000 [00:00<00:01, 1717.11it/s]warmup should be done:  18%|█▊        | 552/3000 [00:00<00:01, 1832.09it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1814.20it/s]warmup should be done:  18%|█▊        | 555/3000 [00:00<00:01, 1796.27it/s]warmup should be done:  25%|██▍       | 736/3000 [00:00<00:01, 1834.06it/s]warmup should be done:  23%|██▎       | 687/3000 [00:00<00:01, 1739.10it/s]warmup should be done:  24%|██▍       | 728/3000 [00:00<00:01, 1826.48it/s]warmup should be done:  25%|██▍       | 742/3000 [00:00<00:01, 1823.42it/s]warmup should be done:  31%|███       | 920/3000 [00:00<00:01, 1833.24it/s]warmup should be done:  29%|██▊       | 861/3000 [00:00<00:01, 1734.46it/s]warmup should be done:  31%|███       | 925/3000 [00:00<00:01, 1819.40it/s]warmup should be done:  30%|███       | 911/3000 [00:00<00:01, 1749.89it/s]warmup should be done:  35%|███▍      | 1043/3000 [00:00<00:01, 1763.38it/s]warmup should be done:  37%|███▋      | 1104/3000 [00:00<00:01, 1823.50it/s]warmup should be done:  37%|███▋      | 1112/3000 [00:00<00:01, 1836.25it/s]warmup should be done:  36%|███▌      | 1087/3000 [00:00<00:01, 1749.21it/s]warmup should be done:  41%|████      | 1227/3000 [00:00<00:00, 1786.32it/s]warmup should be done:  43%|████▎     | 1296/3000 [00:00<00:00, 1835.06it/s]warmup should be done:  42%|████▏     | 1263/3000 [00:00<00:00, 1749.28it/s]warmup should be done:  43%|████▎     | 1287/3000 [00:00<00:00, 1745.53it/s]warmup should be done:  47%|████▋     | 1408/3000 [00:00<00:00, 1791.98it/s]warmup should be done:  49%|████▉     | 1483/3000 [00:00<00:00, 1845.46it/s]warmup should be done:  48%|████▊     | 1439/3000 [00:00<00:00, 1751.23it/s]warmup should be done:  49%|████▉     | 1466/3000 [00:00<00:00, 1758.49it/s]warmup should be done:  53%|█████▎    | 1588/3000 [00:00<00:00, 1785.01it/s]warmup should be done:  56%|█████▌    | 1668/3000 [00:00<00:00, 1844.65it/s]warmup should be done:  54%|█████▍    | 1615/3000 [00:00<00:00, 1753.73it/s]warmup should be done:  55%|█████▍    | 1646/3000 [00:00<00:00, 1768.92it/s]warmup should be done:  59%|█████▉    | 1769/3000 [00:01<00:00, 1792.60it/s]warmup should be done:  62%|██████▏   | 1855/3000 [00:01<00:00, 1851.73it/s]warmup should be done:  60%|█████▉    | 1799/3000 [00:01<00:00, 1778.08it/s]warmup should be done:  61%|██████    | 1824/3000 [00:01<00:00, 1770.93it/s]warmup should be done:  65%|██████▌   | 1952/3000 [00:01<00:00, 1803.70it/s]warmup should be done:  68%|██████▊   | 2041/3000 [00:01<00:00, 1839.34it/s]warmup should be done:  66%|██████▌   | 1982/3000 [00:01<00:00, 1791.51it/s]warmup should be done:  67%|██████▋   | 2002/3000 [00:01<00:00, 1768.79it/s]warmup should be done:  71%|███████   | 2133/3000 [00:01<00:00, 1777.58it/s]warmup should be done:  74%|███████▍  | 2227/3000 [00:01<00:00, 1844.45it/s]warmup should be done:  72%|███████▏  | 2164/3000 [00:01<00:00, 1800.03it/s]warmup should be done:  73%|███████▎  | 2180/3000 [00:01<00:00, 1765.54it/s]warmup should be done:  77%|███████▋  | 2316/3000 [00:01<00:00, 1791.81it/s]warmup should be done:  80%|████████  | 2413/3000 [00:01<00:00, 1847.94it/s]warmup should be done:  78%|███████▊  | 2347/3000 [00:01<00:00, 1807.60it/s]warmup should be done:  79%|███████▊  | 2357/3000 [00:01<00:00, 1739.31it/s]warmup should be done:  83%|████████▎ | 2501/3000 [00:01<00:00, 1806.42it/s]warmup should be done:  87%|████████▋ | 2599/3000 [00:01<00:00, 1850.30it/s]warmup should be done:  84%|████████▍ | 2531/3000 [00:01<00:00, 1815.27it/s]warmup should be done:  85%|████████▍ | 2536/3000 [00:01<00:00, 1753.26it/s]warmup should be done:  89%|████████▉ | 2684/3000 [00:01<00:00, 1812.56it/s]warmup should be done:  93%|█████████▎| 2785/3000 [00:01<00:00, 1851.48it/s]warmup should be done:  90%|█████████ | 2715/3000 [00:01<00:00, 1822.35it/s]warmup should be done:  91%|█████████ | 2716/3000 [00:01<00:00, 1766.01it/s]warmup should be done:  96%|█████████▌| 2867/3000 [00:01<00:00, 1817.51it/s]warmup should be done:  99%|█████████▉| 2971/3000 [00:01<00:00, 1846.66it/s]warmup should be done:  97%|█████████▋| 2899/3000 [00:01<00:00, 1824.88it/s]warmup should be done:  96%|█████████▋| 2893/3000 [00:01<00:00, 1767.09it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1840.62it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1785.15it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1782.60it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1777.19it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f562cad2280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f562cad3160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f562cad2190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f562cad30a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-12 02:20:25.726310: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f51fda68820 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:20:25.726369: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:20:25.733255: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:20:26.477524: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:20:27.517392: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f5209263480 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:20:27.517478: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:20:27.529840: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:20:27.531963: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f520926b550 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:20:27.532034: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:20:27.542510: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:20:27.582372: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f51fd26e9d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:20:27.582460: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:20:27.590172: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:20:28.365138: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:20:28.366766: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:20:28.394683: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:20:32.129120: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:20:33.735051: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:20:33.837076: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:20:34.713838: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][02:21:27.357][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][02:21:27.357][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:21:27.362][ERROR][RK0][main]: coll ps creation done
[HCTR][02:21:27.362][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][02:21:27.446][ERROR][RK0][tid #139990717667072]: replica 0 reaches 1000, calling init pre replica
[HCTR][02:21:27.447][ERROR][RK0][tid #139990717667072]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:21:27.451][ERROR][RK0][tid #139990717667072]: coll ps creation done
[HCTR][02:21:27.451][ERROR][RK0][tid #139990717667072]: replica 0 waits for coll ps creation barrier
[HCTR][02:21:27.572][ERROR][RK0][tid #139990726059776]: replica 3 reaches 1000, calling init pre replica
[HCTR][02:21:27.572][ERROR][RK0][tid #139990726059776]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:21:27.576][ERROR][RK0][tid #139990726059776]: coll ps creation done
[HCTR][02:21:27.576][ERROR][RK0][tid #139990726059776]: replica 3 waits for coll ps creation barrier
[HCTR][02:21:27.816][ERROR][RK0][tid #139990726059776]: replica 2 reaches 1000, calling init pre replica
[HCTR][02:21:27.816][ERROR][RK0][tid #139990726059776]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:21:27.819][ERROR][RK0][tid #139990726059776]: coll ps creation done
[HCTR][02:21:27.819][ERROR][RK0][tid #139990726059776]: replica 2 waits for coll ps creation barrier
[HCTR][02:21:27.819][ERROR][RK0][tid #139990717667072]: replica 0 preparing frequency
[HCTR][02:21:29.288][ERROR][RK0][tid #139990717667072]: replica 0 preparing frequency done
[HCTR][02:21:29.324][ERROR][RK0][tid #139990717667072]: replica 0 calling init per replica
[HCTR][02:21:29.324][ERROR][RK0][tid #139990726059776]: replica 3 calling init per replica
[HCTR][02:21:29.324][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][02:21:29.324][ERROR][RK0][tid #139990726059776]: replica 2 calling init per replica
[HCTR][02:21:29.324][ERROR][RK0][tid #139990717667072]: Calling build_v2
[HCTR][02:21:29.324][ERROR][RK0][tid #139990726059776]: Calling build_v2
[HCTR][02:21:29.324][ERROR][RK0][main]: Calling build_v2
[HCTR][02:21:29.324][ERROR][RK0][tid #139990717667072]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:21:29.324][ERROR][RK0][tid #139990726059776]: Calling build_v2
[HCTR][02:21:29.324][ERROR][RK0][tid #139990726059776]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:21:29.324][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:21:29.324][ERROR][RK0][tid #139990726059776]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-12 02:21:292022-12-12 02:21:292022-12-12 02:21:29[...324813324808324822: : 2022-12-12 02:21:29: EE.E  324828 /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc::E:136136 136] ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] using concurrent impl MPSPhaseusing concurrent impl MPSPhase:using concurrent impl MPSPhase

136
] using concurrent impl MPSPhase
[2022-12-12 02:21:29.325955: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] [assigning 8 to cpu2022-12-12 02:21:29
.325977: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196[] 2022-12-12 02:21:29assigning 8 to cpu.
326001: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:[2022-12-12 02:21:291962022-12-12 02:21:29.[] .3260222022-12-12 02:21:29assigning 8 to cpu326024: .
: E326033E :  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc212] :] assigning 8 to cpu[212build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
2022-12-12 02:21:29] 
.build symm link desc with 4X Tesla V100-SXM2-16GB out of 4326109
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-12 02:21:29[212.2022-12-12 02:21:29] 326146.build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 326151
E[:  2022-12-12 02:21:29E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[. :2022-12-12 02:21:29326161/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc213.: :] 326184E213remote time is 8.68421:  ] 
E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421 :[
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2122022-12-12 02:21:29:] .[213build symm link desc with 4X Tesla V100-SXM2-16GB out of 43262332022-12-12 02:21:29] 
: .remote time is 8.68421E326248
 : [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE[2022-12-12 02:21:29: 2022-12-12 02:21:29.214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.326276] :326285: cpu time is 30214: E
] E cpu time is 30 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::213214] ] remote time is 8.68421cpu time is 30

[2022-12-12 02:21:29.326363: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 02:21:55.295679: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 02:21:55.361141: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 02:21:55.361257: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 02:21:55.362315: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 02:21:55.497449: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 02:21:55.887269: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 02:21:55.887411: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 02:22:02.993956: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 02:22:02.994148: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 02:22:04.773339: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 02:22:04.773457: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 02:22:04.799379: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 02:22:04.799468: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 02:22:04.829669: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 02:22:04.842681: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 02:22:04.843517: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 02:22:04.853890: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 02:22:04.949726: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 02:22:04.952795: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-12 02:22:04.955209: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-12 02:22:04.957558: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-12 02:22:04.959906: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-12 02:22:06.360677: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 02:22:06.365264: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 02:22:06.365438: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 02:22:06.374204: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 02:22:06.374273: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 02:22:06.374309: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 02:22:06.374340: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 02:22:06.375227: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:22:06.375274: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:22:06.376179: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:22:06.376732: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:22:06.396027: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-12 02:22:06.396146: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-12 02:22:06.396983: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:22:06.397033: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:22:06.397618: E[ /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:2022-12-12 02:22:06202.] 3976502 solved: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:[2022022-12-12 02:22:06] .3 solved397725
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc[:2022-12-12 02:22:06205.] 397748worker 0 thread 2 initing device 2: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 02:22:06.397924: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:22:06.398419: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] [Building Coll Cache with ... num gpu device is 42022-12-12 02:22:06
.398442: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:22:06.398475: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-12 02:22:06
.[3984992022-12-12 02:22:06: .E398511 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 381.47 MB1980
] eager alloc mem 381.47 MB
[2022-12-12 02:22:06.[4002182022-12-12 02:22:06: .E400229 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 381.47 MB1980
] eager alloc mem 381.47 MB
[2022-12-12 02:22:06.401285: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-12 02:22:06] .eager alloc mem 381.47 MB401304
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:22:06.439616: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 02:22:06.441813: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 02:22:06.441891: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:22:06.443106: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 02:22:06.444117: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:22:06.445197: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:22:06.445258: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 60.96 MB
[[[2022-12-12 02:22:062022-12-12 02:22:062022-12-12 02:22:06...491967491967491967: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes


[2022-12-12 02:22:06[[.2022-12-12 02:22:062022-12-12 02:22:06493824..: 493826493827E: :  EE/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc  :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638::] 638638eager release cuda mem 1021] ] 
eager release cuda mem 1021eager release cuda mem 1021

[2022-12-12 02:22:06.[[4939162022-12-12 02:22:062022-12-12 02:22:06: ..E493921493921 : : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccEE:  638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] ::eager release cuda mem 400000000638638
] ] eager release cuda mem 400000000
eager release cuda mem 400000000
[2022-12-12 02:22:06.494900: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 02:22:06.495378: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 02:22:06.495867: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 02:22:06.496563: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:22:06.496607: E[ 2022-12-12 02:22:06/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:4966201980: ] Eeager alloc mem 611.00 KB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:22:06.497522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:22:06.497565: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:[432022-12-12 02:22:06] .[WORKER[0] alloc host memory 60.97 MB4975792022-12-12 02:22:06
: .E497588 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 625663638
] eager release cuda mem 625663[
2022-12-12 02:22:06.497648: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43[] 2022-12-12 02:22:06WORKER[0] alloc host memory 61.02 MB.
497670: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 60.99 MB
[2022-12-12 02:22:06.544489: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:22:06.545082: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:22:06.545126: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 02:22:06.571947: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:22:06.572196: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:22:06.572429: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:22:06.572524: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:22:06.572565: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 02:22:06.572766: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:22:06.572806: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 02:22:06.572992: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:22:06.573032: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[[[[2022-12-12 02:22:072022-12-12 02:22:072022-12-12 02:22:072022-12-12 02:22:07....308533308534308536308531: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 0 init p2p of link 1Device 1 init p2p of link 2Device 3 init p2p of link 0Device 2 init p2p of link 3



[2022-12-12 02:22:07[.2022-12-12 02:22:07[308811.2022-12-12 02:22:07: 308814.E: 308819 E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu E:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu 1980:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] 1980:eager alloc mem 611.00 KB] 1980
eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KB
[2022-12-12 02:22:07.308922: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-12 02:22:07[2022-12-12 02:22:07.2022-12-12 02:22:07.309672.309672: 309677: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638:638] 638] eager release cuda mem 625663] eager release cuda mem 625663
eager release cuda mem 625663[

2022-12-12 02:22:07.309744: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:22:07.316078: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 02:22:07.316192: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:22:07.316355: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-12 02:22:07.316391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 02:22:07.316467: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-12 02:22:07eager alloc mem 611.00 KB.
[3165002022-12-12 02:22:07: .E316503 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 611.00 KB1926
] Device 0 init p2p of link 2
[2022-12-12 02:22:07.316621: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:22:07.316996: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:22:07.317292: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:22:07.317337: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:22:07.317423: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:22:07.323718: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 02:22:07.323760: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 02:22:07.323813: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:22:07.323851: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:22:07.[3243212022-12-12 02:22:07: .E324331 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1926/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :Device 0 init p2p of link 31926
] Device 3 init p2p of link 2
[2022-12-12 02:22:07.324432: E[ 2022-12-12 02:22:07/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:3244451980: ] Eeager alloc mem 611.00 KB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:22:07.324620: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:22:07.324658: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:22:07.325238: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:22:07.325264: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:22:07.330790: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 02:22:07.330908: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 02:22:07.330987: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 02:22:07.331143: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15988701 / 100000000 nodes ( 15.99 %~16.00 %) | remote 34341405 / 100000000 nodes ( 34.34 %) | cpu 49669894 / 100000000 nodes ( 49.67 %) | 7.63 GB | 0.932682 secs 
[2022-12-12 02:22:07.331343: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15981376 / 100000000 nodes ( 15.98 %~16.00 %) | remote 34348730 / 100000000 nodes ( 34.35 %) | cpu 49669894 / 100000000 nodes ( 49.67 %) | 7.63 GB | 0.956075 secs 
[2022-12-12 02:22:07.331420: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 02:22:07.331523: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15983788 / 100000000 nodes ( 15.98 %~16.00 %) | remote 34346318 / 100000000 nodes ( 34.35 %) | cpu 49669894 / 100000000 nodes ( 49.67 %) | 7.63 GB | 0.934503 secs 
[2022-12-12 02:22:07.332454: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15996844 / 100000000 nodes ( 16.00 %~16.00 %) | remote 34333262 / 100000000 nodes ( 34.33 %) | cpu 49669894 / 100000000 nodes ( 49.67 %) | 7.63 GB | 0.933973 secs [
2022-12-12 02:22:07.332444: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 14.32 GB
[2022-12-12 02:22:08.317758: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.57 GB
[2022-12-12 02:22:08.317909: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.57 GB
[2022-12-12 02:22:08.318302: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 14.57 GB
[2022-12-12 02:22:09.165974: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.82 GB
[2022-12-12 02:22:09.166101: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.82 GB
[2022-12-12 02:22:09.166425: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 14.82 GB
[2022-12-12 02:22:09.933442: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 15.06 GB
[2022-12-12 02:22:09.933588: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 15.06 GB
[2022-12-12 02:22:09.934078: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 15.06 GB
[2022-12-12 02:22:09.934348: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 15.06 GB
[2022-12-12 02:22:09.934664: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 15.06 GB
[2022-12-12 02:22:10.751488: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 15.25 GB
[2022-12-12 02:22:10.751632: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 15.25 GB
[HCTR][02:22:10.979][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][02:22:10.979][ERROR][RK0][tid #139990726059776]: replica 2 calling init per replica done, doing barrier
[HCTR][02:22:10.979][ERROR][RK0][tid #139990726059776]: replica 3 calling init per replica done, doing barrier
[HCTR][02:22:10.979][ERROR][RK0][tid #139990717667072]: replica 0 calling init per replica done, doing barrier
[HCTR][02:22:10.979][ERROR][RK0][tid #139990726059776]: replica 2 calling init per replica done, doing barrier done
[HCTR][02:22:10.979][ERROR][RK0][tid #139990726059776]: replica 3 calling init per replica done, doing barrier done
[HCTR][02:22:10.979][ERROR][RK0][tid #139990717667072]: replica 0 calling init per replica done, doing barrier done
[HCTR][02:22:10.979][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][02:22:10.979][ERROR][RK0][tid #139990726059776]: init per replica done
[HCTR][02:22:10.979][ERROR][RK0][tid #139990726059776]: init per replica done
[HCTR][02:22:10.979][ERROR][RK0][main]: init per replica done
[HCTR][02:22:11.013][ERROR][RK0][tid #139990726059776]: 1 allocated 3276800 at 0x7f36e0238400
[HCTR][02:22:11.013][ERROR][RK0][tid #139990726059776]: 1 allocated 6553600 at 0x7f36e0558400
[HCTR][02:22:11.013][ERROR][RK0][tid #139990726059776]: 1 allocated 3276800 at 0x7f36e0b98400
[HCTR][02:22:11.014][ERROR][RK0][tid #139990726059776]: 1 allocated 6553600 at 0x7f36e0eb8400
[HCTR][02:22:11.014][ERROR][RK0][tid #139990726059776]: 3 allocated 3276800 at 0x7f374c238400
[HCTR][02:22:11.014][ERROR][RK0][tid #139990726059776]: 3 allocated 6553600 at 0x7f374c558400
[HCTR][02:22:11.014][ERROR][RK0][tid #139990726059776]: 3 allocated 3276800 at 0x7f374cb98400
[HCTR][02:22:11.014][ERROR][RK0][tid #139990726059776]: 3 allocated 6553600 at 0x7f374ceb8400
[HCTR][02:22:11.015][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f3640238400
[HCTR][02:22:11.015][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f3640558400
[HCTR][02:22:11.015][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f3640b98400
[HCTR][02:22:11.015][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f3640eb8400
[HCTR][02:22:11.017][ERROR][RK0][tid #139990717667072]: init per replica done
[HCTR][02:22:11.052][ERROR][RK0][tid #139990717667072]: 0 allocated 3276800 at 0x7f36b0320000
[HCTR][02:22:11.052][ERROR][RK0][tid #139990717667072]: 0 allocated 6553600 at 0x7f36b0640000
[HCTR][02:22:11.052][ERROR][RK0][tid #139990717667072]: 0 allocated 3276800 at 0x7f36b0c80000
[HCTR][02:22:11.052][ERROR][RK0][tid #139990717667072]: 0 allocated 6553600 at 0x7f36b0fa0000
