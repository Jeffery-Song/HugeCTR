2022-12-11 21:25:15.872794: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:25:15.925185: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:25:15.942711: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:25:15.944917: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:25:16.744333: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:25:16.744410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:25:16.757761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:25:16.779496: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:25:16.779572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:25:16.792348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:25:16.795394: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:25:16.795523: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:25:16.797480: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 21:25:16.804739: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:25:16.804804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:25:16.820536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:25:16.822914: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:25:16.822971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:25:16.824890: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:25:16.825025: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:25:16.826622: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 21:25:16.837551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:25:16.852116: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:25:16.852254: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:25:16.853593: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 21:25:16.868559: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:25:16.868690: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:25:16.870043: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][21:25:18.084][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:25:18.085][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:25:18.113][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:25:18.132][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.65s/it]warmup run: 111it [00:01, 88.25it/s]warmup run: 184it [00:01, 153.25it/s]warmup run: 252it [00:01, 211.08it/s]warmup run: 362it [00:02, 342.65it/s]warmup run: 1it [00:01,  1.50s/it]warmup run: 1it [00:01,  1.45s/it]warmup run: 461it [00:02, 455.59it/s]warmup run: 107it [00:01, 92.71it/s]warmup run: 108it [00:01, 96.68it/s]warmup run: 568it [00:02, 577.59it/s]warmup run: 212it [00:01, 198.36it/s]warmup run: 218it [00:01, 210.53it/s]warmup run: 678it [00:02, 692.23it/s]warmup run: 319it [00:01, 316.81it/s]warmup run: 328it [00:01, 334.33it/s]warmup run: 789it [00:02, 791.13it/s]warmup run: 426it [00:01, 439.02it/s]warmup run: 432it [00:01, 451.39it/s]warmup run: 894it [00:02, 856.71it/s]warmup run: 532it [00:02, 555.70it/s]warmup run: 540it [00:01, 570.99it/s]warmup run: 997it [00:02, 864.76it/s]warmup run: 0it [00:00, ?it/s]warmup run: 635it [00:02, 656.03it/s]warmup run: 641it [00:02, 662.02it/s]warmup run: 1097it [00:02, 899.68it/s]warmup run: 739it [00:02, 744.73it/s]warmup run: 746it [00:02, 752.42it/s]warmup run: 1207it [00:02, 952.88it/s]warmup run: 841it [00:02, 802.23it/s]warmup run: 850it [00:02, 822.84it/s]warmup run: 1315it [00:03, 986.42it/s]warmup run: 961it [00:02, 897.34it/s]warmup run: 942it [00:02, 815.15it/s]warmup run: 1427it [00:03, 1022.00it/s]warmup run: 1068it [00:02, 944.25it/s]warmup run: 1047it [00:02, 876.39it/s]warmup run: 1533it [00:03, 1031.88it/s]warmup run: 1176it [00:02, 980.88it/s]warmup run: 1151it [00:02, 918.52it/s]warmup run: 1639it [00:03, 1013.22it/s]warmup run: 1282it [00:02, 1002.37it/s]warmup run: 1261it [00:02, 966.93it/s]warmup run: 1749it [00:03, 1036.72it/s]warmup run: 1390it [00:02, 1023.97it/s]warmup run: 1377it [00:02, 1020.02it/s]warmup run: 1861it [00:03, 1060.42it/s]warmup run: 1499it [00:02, 1041.65it/s]warmup run: 1491it [00:02, 1050.53it/s]warmup run: 1969it [00:03, 1064.74it/s]warmup run: 1610it [00:02, 1059.66it/s]warmup run: 1605it [00:03, 1075.07it/s]warmup run: 2090it [00:03, 1107.05it/s]warmup run: 1720it [00:03, 1070.73it/s]warmup run: 1723it [00:03, 1103.67it/s]warmup run: 2229it [00:03, 1189.34it/s]warmup run: 1831it [00:03, 1080.14it/s]warmup run: 1839it [00:03, 1118.46it/s]warmup run: 2367it [00:03, 1244.88it/s]warmup run: 1944it [00:03, 1093.61it/s]warmup run: 1955it [00:03, 1128.04it/s]warmup run: 2506it [00:04, 1287.14it/s]warmup run: 2069it [00:03, 1138.52it/s]warmup run: 2079it [00:03, 1159.33it/s]warmup run: 2643it [00:04, 1311.70it/s]warmup run: 2207it [00:03, 1209.17it/s]warmup run: 2213it [00:03, 1212.73it/s]warmup run: 1it [00:01,  1.50s/it]warmup run: 2780it [00:04, 1326.96it/s]warmup run: 2343it [00:03, 1253.81it/s]warmup run: 2347it [00:03, 1250.42it/s]warmup run: 108it [00:01, 93.54it/s]warmup run: 2916it [00:04, 1334.30it/s]warmup run: 2477it [00:03, 1279.27it/s]warmup run: 2478it [00:03, 1267.57it/s]warmup run: 3000it [00:04, 683.13it/s] warmup run: 205it [00:01, 190.26it/s]warmup run: 2612it [00:03, 1298.61it/s]warmup run: 2611it [00:03, 1285.12it/s]warmup run: 310it [00:01, 307.28it/s]warmup run: 2746it [00:03, 1310.65it/s]warmup run: 2747it [00:03, 1306.51it/s]warmup run: 416it [00:01, 429.14it/s]warmup run: 2881it [00:03, 1320.15it/s]warmup run: 2882it [00:04, 1317.31it/s]warmup run: 521it [00:02, 545.38it/s]warmup run: 3000it [00:04, 739.58it/s] warmup run: 3000it [00:04, 724.73it/s] warmup run: 625it [00:02, 650.10it/s]warmup run: 734it [00:02, 751.56it/s]warmup run: 843it [00:02, 835.70it/s]warmup run: 952it [00:02, 901.35it/s]warmup run: 1061it [00:02, 951.89it/s]warmup run: 1169it [00:02, 987.25it/s]warmup run: 1277it [00:02, 995.40it/s]warmup run: 1384it [00:02, 1016.01it/s]warmup run: 1491it [00:02, 1031.42it/s]warmup run: 1598it [00:03, 1042.07it/s]warmup run: 1705it [00:03, 1038.62it/s]warmup run: 1813it [00:03, 1048.39it/s]warmup run: 1921it [00:03, 1057.14it/s]warmup run: 2033it [00:03, 1075.35it/s]warmup run: 2168it [00:03, 1154.59it/s]warmup run: 2303it [00:03, 1211.01it/s]warmup run: 2438it [00:03, 1250.34it/s]warmup run: 2573it [00:03, 1278.46it/s]warmup run: 2707it [00:03, 1295.35it/s]warmup run: 2841it [00:04, 1307.16it/s]warmup run: 2974it [00:04, 1312.90it/s]warmup run: 3000it [00:04, 723.01it/s] 


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 179/3000 [00:00<00:01, 1788.03it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1754.56it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1760.72it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1740.70it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1785.59it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1794.40it/s]warmup should be done:  12%|█▏        | 361/3000 [00:00<00:01, 1803.79it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1782.78it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1791.99it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1808.06it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1787.90it/s]warmup should be done:  18%|█▊        | 541/3000 [00:00<00:01, 1801.58it/s]warmup should be done:  24%|██▍       | 726/3000 [00:00<00:01, 1815.13it/s]warmup should be done:  24%|██▍       | 718/3000 [00:00<00:01, 1786.01it/s]warmup should be done:  24%|██▍       | 718/3000 [00:00<00:01, 1793.16it/s]warmup should be done:  24%|██▍       | 722/3000 [00:00<00:01, 1748.01it/s]warmup should be done:  30%|███       | 908/3000 [00:00<00:01, 1814.18it/s]warmup should be done:  30%|██▉       | 899/3000 [00:00<00:01, 1791.26it/s]warmup should be done:  30%|██▉       | 898/3000 [00:00<00:01, 1790.92it/s]warmup should be done:  30%|███       | 903/3000 [00:00<00:01, 1766.62it/s]warmup should be done:  36%|███▋      | 1090/3000 [00:00<00:01, 1812.98it/s]warmup should be done:  36%|███▌      | 1078/3000 [00:00<00:01, 1784.81it/s]warmup should be done:  36%|███▌      | 1079/3000 [00:00<00:01, 1778.47it/s]warmup should be done:  36%|███▌      | 1082/3000 [00:00<00:01, 1774.15it/s]warmup should be done:  42%|████▏     | 1272/3000 [00:00<00:00, 1814.53it/s]warmup should be done:  42%|████▏     | 1259/3000 [00:00<00:00, 1790.20it/s]warmup should be done:  42%|████▏     | 1260/3000 [00:00<00:00, 1786.11it/s]warmup should be done:  42%|████▏     | 1263/3000 [00:00<00:00, 1782.98it/s]warmup should be done:  48%|████▊     | 1454/3000 [00:00<00:00, 1810.95it/s]warmup should be done:  48%|████▊     | 1439/3000 [00:00<00:00, 1792.84it/s]warmup should be done:  48%|████▊     | 1440/3000 [00:00<00:00, 1790.09it/s]warmup should be done:  48%|████▊     | 1444/3000 [00:00<00:00, 1790.02it/s]warmup should be done:  54%|█████▍    | 1620/3000 [00:00<00:00, 1797.81it/s]warmup should be done:  55%|█████▍    | 1636/3000 [00:00<00:00, 1803.99it/s]warmup should be done:  54%|█████▍    | 1624/3000 [00:00<00:00, 1792.63it/s]warmup should be done:  54%|█████▍    | 1620/3000 [00:00<00:00, 1760.22it/s]warmup should be done:  60%|██████    | 1801/3000 [00:01<00:00, 1800.02it/s]warmup should be done:  61%|██████    | 1817/3000 [00:01<00:00, 1800.58it/s]warmup should be done:  60%|██████    | 1805/3000 [00:01<00:00, 1797.74it/s]warmup should be done:  60%|█████▉    | 1797/3000 [00:01<00:00, 1723.43it/s]warmup should be done:  66%|██████▌   | 1982/3000 [00:01<00:00, 1801.78it/s]warmup should be done:  67%|██████▋   | 1998/3000 [00:01<00:00, 1796.35it/s]warmup should be done:  66%|██████▌   | 1974/3000 [00:01<00:00, 1732.91it/s]warmup should be done:  66%|██████▌   | 1985/3000 [00:01<00:00, 1750.16it/s]warmup should be done:  72%|███████▏  | 2163/3000 [00:01<00:00, 1804.03it/s]warmup should be done:  73%|███████▎  | 2178/3000 [00:01<00:00, 1795.07it/s]warmup should be done:  72%|███████▏  | 2164/3000 [00:01<00:00, 1761.86it/s]warmup should be done:  72%|███████▏  | 2149/3000 [00:01<00:00, 1735.81it/s]warmup should be done:  78%|███████▊  | 2345/3000 [00:01<00:00, 1805.20it/s]warmup should be done:  79%|███████▊  | 2358/3000 [00:01<00:00, 1793.53it/s]warmup should be done:  78%|███████▊  | 2332/3000 [00:01<00:00, 1763.81it/s]warmup should be done:  78%|███████▊  | 2345/3000 [00:01<00:00, 1775.81it/s]warmup should be done:  84%|████████▍ | 2528/3000 [00:01<00:00, 1810.52it/s]warmup should be done:  85%|████████▍ | 2539/3000 [00:01<00:00, 1797.22it/s]warmup should be done:  84%|████████▍ | 2516/3000 [00:01<00:00, 1784.51it/s]warmup should be done:  84%|████████▍ | 2523/3000 [00:01<00:00, 1772.32it/s]warmup should be done:  90%|█████████ | 2710/3000 [00:01<00:00, 1812.25it/s]warmup should be done:  91%|█████████ | 2719/3000 [00:01<00:00, 1795.07it/s]warmup should be done:  90%|█████████ | 2700/3000 [00:01<00:00, 1799.80it/s]warmup should be done:  90%|█████████ | 2701/3000 [00:01<00:00, 1752.90it/s]warmup should be done:  96%|█████████▋| 2892/3000 [00:01<00:00, 1811.38it/s]warmup should be done:  97%|█████████▋| 2899/3000 [00:01<00:00, 1779.56it/s]warmup should be done:  96%|█████████▌| 2884/3000 [00:01<00:00, 1810.57it/s]warmup should be done:  96%|█████████▌| 2877/3000 [00:01<00:00, 1742.65it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1799.37it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1791.81it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1780.98it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1765.22it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1759.17it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1774.84it/s]warmup should be done:   5%|▌         | 160/3000 [00:00<00:01, 1596.61it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1771.55it/s]warmup should be done:  12%|█▏        | 367/3000 [00:00<00:01, 1840.76it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1798.95it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1795.14it/s]warmup should be done:  11%|█         | 327/3000 [00:00<00:01, 1638.59it/s]warmup should be done:  17%|█▋        | 509/3000 [00:00<00:01, 1720.66it/s]warmup should be done:  19%|█▊        | 556/3000 [00:00<00:01, 1862.06it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1812.43it/s]warmup should be done:  18%|█▊        | 542/3000 [00:00<00:01, 1806.61it/s]warmup should be done:  25%|██▍       | 745/3000 [00:00<00:01, 1870.66it/s]warmup should be done:  24%|██▍       | 724/3000 [00:00<00:01, 1811.86it/s]warmup should be done:  24%|██▍       | 725/3000 [00:00<00:01, 1810.60it/s]warmup should be done:  23%|██▎       | 682/3000 [00:00<00:01, 1703.81it/s]warmup should be done:  31%|███       | 934/3000 [00:00<00:01, 1875.10it/s]warmup should be done:  30%|███       | 906/3000 [00:00<00:01, 1812.45it/s]warmup should be done:  30%|███       | 910/3000 [00:00<00:01, 1822.12it/s]warmup should be done:  28%|██▊       | 853/3000 [00:00<00:01, 1700.71it/s]warmup should be done:  36%|███▋      | 1089/3000 [00:00<00:01, 1816.20it/s]warmup should be done:  36%|███▋      | 1093/3000 [00:00<00:01, 1811.52it/s]warmup should be done:  37%|███▋      | 1122/3000 [00:00<00:01, 1841.01it/s]warmup should be done:  34%|███▍      | 1024/3000 [00:00<00:01, 1686.31it/s]warmup should be done:  42%|████▏     | 1271/3000 [00:00<00:00, 1808.80it/s]warmup should be done:  43%|████▎     | 1276/3000 [00:00<00:00, 1815.28it/s]warmup should be done:  44%|████▎     | 1309/3000 [00:00<00:00, 1848.91it/s]warmup should be done:  40%|███▉      | 1193/3000 [00:00<00:01, 1685.92it/s]warmup should be done:  49%|████▊     | 1460/3000 [00:00<00:00, 1822.42it/s]warmup should be done:  48%|████▊     | 1452/3000 [00:00<00:00, 1780.98it/s]warmup should be done:  45%|████▌     | 1362/3000 [00:00<00:00, 1681.18it/s]warmup should be done:  50%|████▉     | 1494/3000 [00:00<00:00, 1831.87it/s]warmup should be done:  55%|█████▍    | 1644/3000 [00:00<00:00, 1826.44it/s]warmup should be done:  54%|█████▍    | 1633/3000 [00:00<00:00, 1789.38it/s]warmup should be done:  51%|█████     | 1537/3000 [00:00<00:00, 1702.23it/s]warmup should be done:  56%|█████▌    | 1678/3000 [00:00<00:00, 1829.40it/s]warmup should be done:  61%|██████    | 1827/3000 [00:01<00:00, 1812.51it/s]warmup should be done:  60%|██████    | 1813/3000 [00:01<00:00, 1791.10it/s]warmup should be done:  57%|█████▋    | 1715/3000 [00:01<00:00, 1724.39it/s]warmup should be done:  62%|██████▏   | 1861/3000 [00:01<00:00, 1797.21it/s]warmup should be done:  67%|██████▋   | 2009/3000 [00:01<00:00, 1814.46it/s]warmup should be done:  67%|██████▋   | 1998/3000 [00:01<00:00, 1808.85it/s]warmup should be done:  63%|██████▎   | 1895/3000 [00:01<00:00, 1746.36it/s]warmup should be done:  68%|██████▊   | 2045/3000 [00:01<00:00, 1807.85it/s]warmup should be done:  73%|███████▎  | 2192/3000 [00:01<00:00, 1816.23it/s]warmup should be done:  73%|███████▎  | 2184/3000 [00:01<00:00, 1821.79it/s]warmup should be done:  69%|██████▉   | 2077/3000 [00:01<00:00, 1765.79it/s]warmup should be done:  74%|███████▍  | 2229/3000 [00:01<00:00, 1815.82it/s]warmup should be done:  79%|███████▉  | 2375/3000 [00:01<00:00, 1819.23it/s]warmup should be done:  79%|███████▉  | 2367/3000 [00:01<00:00, 1819.64it/s]warmup should be done:  75%|███████▌  | 2256/3000 [00:01<00:00, 1770.95it/s]warmup should be done:  80%|████████  | 2413/3000 [00:01<00:00, 1822.07it/s]warmup should be done:  85%|████████▌ | 2558/3000 [00:01<00:00, 1821.26it/s]warmup should be done:  85%|████████▌ | 2552/3000 [00:01<00:00, 1827.91it/s]warmup should be done:  81%|████████  | 2435/3000 [00:01<00:00, 1775.82it/s]warmup should be done:  87%|████████▋ | 2598/3000 [00:01<00:00, 1830.08it/s]warmup should be done:  91%|█████████▏| 2741/3000 [00:01<00:00, 1822.13it/s]warmup should be done:  91%|█████████ | 2737/3000 [00:01<00:00, 1832.74it/s]warmup should be done:  87%|████████▋ | 2613/3000 [00:01<00:00, 1775.08it/s]warmup should be done:  93%|█████████▎| 2782/3000 [00:01<00:00, 1819.02it/s]warmup should be done:  97%|█████████▋| 2924/3000 [00:01<00:00, 1822.02it/s]warmup should be done:  97%|█████████▋| 2922/3000 [00:01<00:00, 1835.22it/s]warmup should be done:  93%|█████████▎| 2793/3000 [00:01<00:00, 1782.42it/s]warmup should be done:  99%|█████████▉| 2967/3000 [00:01<00:00, 1826.07it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1829.90it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1815.46it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1814.40it/s]warmup should be done:  99%|█████████▉| 2972/3000 [00:01<00:00, 1776.02it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1735.59it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f4528fbd070>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f4528fbd280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f4528fbd160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f4528fbc190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 21:26:30.052326: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f40fda65050 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:26:30.052389: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:26:30.059683: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:26:30.130514: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f410126a600 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:26:30.130586: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:26:30.138284: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:26:31.114677: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f40fd266990 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:26:31.114744: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:26:31.117838: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f4101267d70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:26:31.117876: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:26:31.127036: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:26:31.127272: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:26:31.261328: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:26:31.294320: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:26:31.771262: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:26:31.779707: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:26:37.152860: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:26:37.273587: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:26:37.276265: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:26:37.501391: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][21:27:36.081][ERROR][RK0][tid #139917577398016]: replica 3 reaches 1000, calling init pre replica
[HCTR][21:27:36.082][ERROR][RK0][tid #139917577398016]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:27:36.086][ERROR][RK0][tid #139917577398016]: coll ps creation done
[HCTR][21:27:36.086][ERROR][RK0][tid #139917577398016]: replica 3 waits for coll ps creation barrier
[HCTR][21:27:36.289][ERROR][RK0][tid #139917644506880]: replica 1 reaches 1000, calling init pre replica
[HCTR][21:27:36.289][ERROR][RK0][tid #139917644506880]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:27:36.293][ERROR][RK0][tid #139917644506880]: coll ps creation done
[HCTR][21:27:36.293][ERROR][RK0][tid #139917644506880]: replica 1 waits for coll ps creation barrier
[HCTR][21:27:36.477][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][21:27:36.477][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:27:36.482][ERROR][RK0][main]: coll ps creation done
[HCTR][21:27:36.482][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][21:27:36.721][ERROR][RK0][tid #139917577398016]: replica 0 reaches 1000, calling init pre replica
[HCTR][21:27:36.721][ERROR][RK0][tid #139917577398016]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:27:36.724][ERROR][RK0][tid #139917577398016]: coll ps creation done
[HCTR][21:27:36.724][ERROR][RK0][tid #139917577398016]: replica 0 waits for coll ps creation barrier
[HCTR][21:27:36.724][ERROR][RK0][tid #139917577398016]: replica 0 preparing frequency
[HCTR][21:27:37.674][ERROR][RK0][tid #139917577398016]: replica 0 preparing frequency done
[HCTR][21:27:37.702][ERROR][RK0][tid #139917577398016]: replica 0 calling init per replica
[HCTR][21:27:37.702][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][21:27:37.702][ERROR][RK0][tid #139917644506880]: replica 1 calling init per replica
[HCTR][21:27:37.702][ERROR][RK0][tid #139917577398016]: Calling build_v2
[HCTR][21:27:37.702][ERROR][RK0][main]: Calling build_v2
[HCTR][21:27:37.702][ERROR][RK0][tid #139917577398016]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:27:37.702][ERROR][RK0][tid #139917577398016]: replica 3 calling init per replica
[HCTR][21:27:37.702][ERROR][RK0][tid #139917644506880]: Calling build_v2
[HCTR][21:27:37.702][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:27:37.702][ERROR][RK0][tid #139917644506880]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:27:37.702][ERROR][RK0][tid #139917577398016]: Calling build_v2
[HCTR][21:27:37.702][ERROR][RK0][tid #139917577398016]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-11 21:27:372022-12-11 21:27:372022-12-11 21:27:37...702383702375702383: : : EEE [  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:2022-12-11 21:27:37::136.136] 136using concurrent impl MPS] ] 
using concurrent impl MPSusing concurrent impl MPS702431

: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 21:27:37.703512: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 21:27:37.703558: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 21:27:37:.196[703571] 2022-12-11 21:27:37: assigning 8 to cpu.E
703583 [: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 21:27:37E:. 212703604/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] [: :build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 21:27:37E196
. ] 703627/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpu: [:
E2022-12-11 21:27:37196 .] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc703665assigning 8 to cpu:: 
212E[]  2022-12-11 21:27:37build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.
:703704213: ] Eremote time is 8.68421 [
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 21:27:37:[.[2122022-12-11 21:27:377037372022-12-11 21:27:37] .: .build symm link desc with 4X Tesla V100-SXM2-16GB out of 4703742E703752
:  : E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE :[ /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2132022-12-11 21:27:37/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:] .:212remote time is 8.68421703792214] 
: ] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4Ecpu time is 30
[ 
2022-12-11 21:27:37/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:[7038342132022-12-11 21:27:37: ] .Eremote time is 8.68421703850 
: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: [214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 21:27:37] :.cpu time is 30213703883
] : remote time is 8.68421E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214[] 2022-12-11 21:27:37cpu time is 30.
703923: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 21:28:03.276566: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 21:28:03.338528: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 21:28:03.338638: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 21:28:03.340117: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 21:28:03.435654: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 21:28:03.825854: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 21:28:03.825944: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 21:28:11.702269: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 21:28:11.702390: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 21:28:13.466950: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 21:28:13.467045: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 21:28:13.481585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 21:28:13.481666: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 21:28:14.702975: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 21:28:14.720889: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 21:28:14.722096: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 21:28:14.737401: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 21:28:14.838865: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 21:28:16.176940: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 21:28:16.180888: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 21:28:16.181397: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 21:28:16.191007: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 21:28:16.191085: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 21:28:16.191123: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 21:28:16.191154: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 21:28:16.192116: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:28:16.192162: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:28:16.193284: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:28:16.193842: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:28:16.214079: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 21:28:16.214195: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205[] worker 0 thread 2 initing device 2
2022-12-11 21:28:16.214168: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 21:28:16.214263: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 21:28:16.214557: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 21:28:16.214644: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 21:28:16.216083: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:28:16.216141: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:28:16.216175: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:28:16.216230: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:28:16.216434: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:28:16.216489: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:28:16.217979: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB[
2022-12-11 21:28:16.218004: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:28:16.218048: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:28:16.219487: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB[
2022-12-11 21:28:16.219512: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-11 21:28:16
.219539: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:28:16.265002: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 21:28:16.266930: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:28:16.266987: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:28:16.267786: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:28:16.268236: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:28:16.269203: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:28:16.269246: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.22 MB
[2022-12-11 21:28:16.276498: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:28:16.277185: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:28:16.277229: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[[2022-12-11 21:28:162022-12-11 21:28:162022-12-11 21:28:16...315245315245315245: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes


[[2022-12-11 21:28:162022-12-11 21:28:16..317125317127: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 1021eager release cuda mem 1021

[[2022-12-11 21:28:162022-12-11 21:28:16..317194317194: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 400000000eager release cuda mem 400000000

[2022-12-11 21:28:16.317531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:28:16.317581: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:28:16.318031: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:28:16.318540: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:28:16.319286: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:28:16.319668: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:28:16.319728: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:28:16.319875: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:28:16.320583: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:28:16.320625: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:[432022-12-11 21:28:16] .WORKER[0] alloc host memory 15.25 MB320640
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:28:16.320689: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.26 MB
[2022-12-11 21:28:16.320794: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:28:16.320844: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.22 MB
[2022-12-11 21:28:16.329377: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:28:16.329540: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:28:16.329985: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:28:16.330027: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[2022-12-11 21:28:16.330190: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:28:16.330231: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[2022-12-11 21:28:16.331298: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:28:16.331892: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:28:16.331935: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[[[2022-12-11 21:28:162022-12-11 21:28:162022-12-11 21:28:162022-12-11 21:28:16....506565506570506576506573: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 1 init p2p of link 2Device 2 init p2p of link 3Device 0 init p2p of link 1



[2022-12-11 21:28:16.506892[: [2022-12-11 21:28:16[E2022-12-11 21:28:16.2022-12-11 21:28:16 .506901./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu506901: 506903:: E: 1980E E]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980:1980] 1980] eager alloc mem 611.00 KB] eager alloc mem 611.00 KB
eager alloc mem 611.00 KB

[2022-12-11 21:28:16.507779: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:28:16.507814: E[[ 2022-12-11 21:28:162022-12-11 21:28:16/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc..:507824507829638: : ] EEeager release cuda mem 625663  
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 625663eager release cuda mem 625663

[2022-12-11 21:28:16.517740: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 21:28:16.517854: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:28:16.517991: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 21:28:16.518074: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 21:28:16.518140: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB[
2022-12-11 21:28:16.518170: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 21:28:16.518242: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:28:16.518318: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:28:16.518655: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:28:16.518979: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:28:16.519075: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663[
2022-12-11 21:28:16.519116: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:28:16.521531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 21:28:16.521633: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:28:16.522447: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[[2022-12-11 21:28:162022-12-11 21:28:16..522613522617: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261926] ] Device 1 init p2p of link 0Device 2 init p2p of link 1

[2022-12-11 21:28:16[.2022-12-11 21:28:16522785.: 522791E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KB
[2022-12-11 21:28:16.522964: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 21:28:16.523051: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:28:16.523642: E[ 2022-12-11 21:28:16/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:523652638: ] Eeager release cuda mem 625663 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:28:16.523805: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:28:16.524726: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:28:16.525311: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3997859 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11971373 / 100000000 nodes ( 11.97 %) | cpu 84030768 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.309186 secs 
[2022-12-11 21:28:16.526694: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:28:16.526855: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:28:16.526955: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3989290 / 100000000 nodes ( 3.99 %~4.00 %) | remote 11979942 / 100000000 nodes ( 11.98 %) | cpu 84030768 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.31048 secs 
[2022-12-11 21:28:16.527479: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3988929 / 100000000 nodes ( 3.99 %~4.00 %) | remote 11980303 / 100000000 nodes ( 11.98 %) | cpu 84030768 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.335324 secs 
[2022-12-11 21:28:16.528852: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.61 GB
[2022-12-11 21:28:16.530074: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:28:16.530660: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3999560 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11969672 / 100000000 nodes ( 11.97 %) | cpu 84030768 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.314442 secs 
[2022-12-11 21:28:17.444554: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.85 GB
[2022-12-11 21:28:17.444685: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.85 GB
[2022-12-11 21:28:17.444952: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.85 GB
[2022-12-11 21:28:18.192062: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.10 GB
[2022-12-11 21:28:18.192183: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.10 GB
[2022-12-11 21:28:18.192688: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.10 GB
[2022-12-11 21:28:18.931490: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.34 GB
[2022-12-11 21:28:18.931649: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.34 GB
[2022-12-11 21:28:18.931954: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.34 GB
[2022-12-11 21:28:19.745541: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.75 GB
[2022-12-11 21:28:19.745669: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.75 GB
[2022-12-11 21:28:19.746657: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.75 GB
[2022-12-11 21:28:20.568168: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.94 GB
[2022-12-11 21:28:20.568293: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.94 GB
[HCTR][21:28:20.876][ERROR][RK0][tid #139917577398016]: replica 3 calling init per replica done, doing barrier
[HCTR][21:28:20.876][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][21:28:20.876][ERROR][RK0][tid #139917644506880]: replica 1 calling init per replica done, doing barrier
[HCTR][21:28:20.876][ERROR][RK0][tid #139917577398016]: replica 0 calling init per replica done, doing barrier
[HCTR][21:28:20.876][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][21:28:20.876][ERROR][RK0][tid #139917644506880]: replica 1 calling init per replica done, doing barrier done
[HCTR][21:28:20.876][ERROR][RK0][tid #139917577398016]: replica 0 calling init per replica done, doing barrier done
[HCTR][21:28:20.876][ERROR][RK0][tid #139917577398016]: replica 3 calling init per replica done, doing barrier done
[HCTR][21:28:20.876][ERROR][RK0][main]: init per replica done
[HCTR][21:28:20.876][ERROR][RK0][tid #139917577398016]: init per replica done
[HCTR][21:28:20.876][ERROR][RK0][tid #139917644506880]: init per replica done
[HCTR][21:28:20.879][ERROR][RK0][tid #139917577398016]: init per replica done
[HCTR][21:28:20.912][ERROR][RK0][tid #139917644506880]: 1 allocated 3276800 at 0x7f26d8238400
[HCTR][21:28:20.912][ERROR][RK0][tid #139917644506880]: 1 allocated 6553600 at 0x7f26d8558400
[HCTR][21:28:20.912][ERROR][RK0][tid #139917644506880]: 1 allocated 3276800 at 0x7f26d8b98400
[HCTR][21:28:20.912][ERROR][RK0][tid #139917644506880]: 1 allocated 6553600 at 0x7f26d8eb8400
[HCTR][21:28:20.915][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f2680320000
[HCTR][21:28:20.915][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f2680640000
[HCTR][21:28:20.915][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f2680c80000
[HCTR][21:28:20.915][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f2680fa0000
[HCTR][21:28:20.916][ERROR][RK0][tid #139917577398016]: 3 allocated 3276800 at 0x7f26b8238400
[HCTR][21:28:20.916][ERROR][RK0][tid #139917577398016]: 3 allocated 6553600 at 0x7f26b8558400
[HCTR][21:28:20.916][ERROR][RK0][tid #139917577398016]: 3 allocated 3276800 at 0x7f26b8b98400
[HCTR][21:28:20.916][ERROR][RK0][tid #139917577398016]: 3 allocated 6553600 at 0x7f26b8eb8400
[HCTR][21:28:20.916][ERROR][RK0][tid #139917585790720]: 2 allocated 3276800 at 0x7f27a4238400
[HCTR][21:28:20.916][ERROR][RK0][tid #139917585790720]: 2 allocated 6553600 at 0x7f27a4558400
[HCTR][21:28:20.916][ERROR][RK0][tid #139917585790720]: 2 allocated 3276800 at 0x7f27a4b98400
[HCTR][21:28:20.916][ERROR][RK0][tid #139917585790720]: 2 allocated 6553600 at 0x7f27a4eb8400
