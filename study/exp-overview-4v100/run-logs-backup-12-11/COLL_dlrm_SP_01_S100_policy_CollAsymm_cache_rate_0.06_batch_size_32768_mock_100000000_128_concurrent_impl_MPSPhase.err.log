2022-12-11 21:52:07.781871: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:52:07.837022: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:52:07.849199: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:52:07.852012: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:52:08.650762: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:52:08.650840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:52:08.667341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:52:08.686959: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:52:08.687034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:52:08.700131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:52:08.702387: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:52:08.702518: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:52:08.703956: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 21:52:08.713619: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:52:08.713687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:52:08.722964: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:52:08.723058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:52:08.726287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:52:08.730361: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:52:08.730495: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:52:08.731925: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 21:52:08.736372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:52:08.757127: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:52:08.757276: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:52:08.758813: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 21:52:08.768437: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:52:08.768561: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:52:08.769797: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][21:52:09.024][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:52:09.963][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:52:09.975][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:52:10.022][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.47s/it]warmup run: 45it [00:01, 39.42it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 142it [00:01, 143.43it/s]warmup run: 104it [00:01, 94.59it/s]warmup run: 249it [00:01, 270.88it/s]warmup run: 206it [00:01, 201.17it/s]warmup run: 356it [00:01, 402.12it/s]warmup run: 304it [00:01, 311.20it/s]warmup run: 459it [00:01, 521.27it/s]warmup run: 395it [00:01, 411.62it/s]warmup run: 556it [00:02, 616.34it/s]warmup run: 496it [00:01, 526.71it/s]warmup run: 660it [00:02, 715.11it/s]warmup run: 596it [00:02, 628.51it/s]warmup run: 763it [00:02, 793.02it/s]warmup run: 698it [00:02, 720.83it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 865it [00:02, 852.36it/s]warmup run: 801it [00:02, 796.95it/s]warmup run: 105it [00:01, 95.51it/s]warmup run: 969it [00:02, 901.69it/s]warmup run: 904it [00:02, 856.55it/s]warmup run: 211it [00:01, 206.50it/s]warmup run: 1073it [00:02, 939.14it/s]warmup run: 1004it [00:02, 894.52it/s]warmup run: 317it [00:01, 327.07it/s]warmup run: 1178it [00:02, 968.79it/s]warmup run: 1104it [00:02, 922.38it/s]warmup run: 422it [00:01, 448.14it/s]warmup run: 1285it [00:02, 995.60it/s]warmup run: 1204it [00:02, 943.57it/s]warmup run: 526it [00:01, 562.33it/s]warmup run: 1392it [00:02, 1014.99it/s]warmup run: 1304it [00:02, 956.16it/s]warmup run: 0it [00:00, ?it/s]warmup run: 627it [00:02, 658.12it/s]warmup run: 1497it [00:02, 985.46it/s] warmup run: 1406it [00:02, 973.91it/s]warmup run: 734it [00:02, 754.06it/s]warmup run: 1598it [00:03, 982.14it/s]warmup run: 1509it [00:02, 988.40it/s]warmup run: 842it [00:02, 835.14it/s]warmup run: 1704it [00:03, 1003.25it/s]warmup run: 1610it [00:03, 993.38it/s]warmup run: 948it [00:02, 892.82it/s]warmup run: 1809it [00:03, 1014.60it/s]warmup run: 1711it [00:03, 996.36it/s]warmup run: 1057it [00:02, 945.19it/s]warmup run: 1912it [00:03, 1010.39it/s]warmup run: 1818it [00:03, 1016.34it/s]warmup run: 1165it [00:02, 982.31it/s]warmup run: 2021it [00:03, 1032.84it/s]warmup run: 1926it [00:03, 1032.72it/s]warmup run: 1278it [00:02, 1023.02it/s]warmup run: 2157it [00:03, 1129.41it/s]warmup run: 2043it [00:03, 1071.75it/s]warmup run: 1388it [00:02, 1044.58it/s]warmup run: 2293it [00:03, 1196.93it/s]warmup run: 2177it [00:03, 1150.71it/s]warmup run: 1497it [00:02, 1053.19it/s]warmup run: 2429it [00:03, 1244.06it/s]warmup run: 2311it [00:03, 1204.69it/s]warmup run: 1606it [00:02, 1059.69it/s]warmup run: 2565it [00:03, 1277.66it/s]warmup run: 2446it [00:03, 1245.65it/s]warmup run: 1714it [00:03, 1061.55it/s]warmup run: 2700it [00:04, 1296.85it/s]warmup run: 2581it [00:03, 1274.44it/s]warmup run: 1822it [00:03, 1066.63it/s]warmup run: 2837it [00:04, 1316.52it/s]warmup run: 2715it [00:03, 1292.52it/s]warmup run: 1930it [00:03, 1069.93it/s]warmup run: 2974it [00:04, 1330.89it/s]warmup run: 3000it [00:04, 708.76it/s] warmup run: 2847it [00:04, 1300.68it/s]warmup run: 2046it [00:03, 1094.93it/s]warmup run: 2981it [00:04, 1310.78it/s]warmup run: 3000it [00:04, 721.42it/s] warmup run: 1it [00:01,  1.43s/it]warmup run: 2172it [00:03, 1142.70it/s]warmup run: 103it [00:01, 93.33it/s]warmup run: 2307it [00:03, 1203.17it/s]warmup run: 208it [00:01, 203.16it/s]warmup run: 2428it [00:03, 1202.18it/s]warmup run: 314it [00:01, 323.55it/s]warmup run: 2554it [00:03, 1219.26it/s]warmup run: 420it [00:01, 446.67it/s]warmup run: 2680it [00:03, 1228.56it/s]warmup run: 523it [00:01, 558.64it/s]warmup run: 2803it [00:03, 1227.05it/s]warmup run: 623it [00:02, 653.17it/s]warmup run: 2939it [00:04, 1264.85it/s]warmup run: 3000it [00:04, 733.49it/s] warmup run: 725it [00:02, 739.01it/s]warmup run: 831it [00:02, 817.89it/s]warmup run: 937it [00:02, 880.11it/s]warmup run: 1042it [00:02, 925.67it/s]warmup run: 1148it [00:02, 963.25it/s]warmup run: 1255it [00:02, 991.37it/s]warmup run: 1362it [00:02, 1013.38it/s]warmup run: 1472it [00:02, 1037.53it/s]warmup run: 1582it [00:02, 1055.83it/s]warmup run: 1691it [00:03, 1065.92it/s]warmup run: 1800it [00:03, 1069.91it/s]warmup run: 1911it [00:03, 1078.69it/s]warmup run: 2021it [00:03, 1084.24it/s]warmup run: 2154it [00:03, 1155.60it/s]warmup run: 2287it [00:03, 1206.01it/s]warmup run: 2420it [00:03, 1241.55it/s]warmup run: 2553it [00:03, 1265.80it/s]warmup run: 2685it [00:03, 1279.30it/s]warmup run: 2814it [00:03, 1280.39it/s]warmup run: 2944it [00:04, 1283.97it/s]warmup run: 3000it [00:04, 732.76it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   5%|▌         | 164/3000 [00:00<00:01, 1638.43it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1698.52it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1725.38it/s]warmup should be done:   5%|▍         | 138/3000 [00:00<00:02, 1373.18it/s]warmup should be done:  11%|█         | 336/3000 [00:00<00:01, 1685.96it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1771.13it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1717.23it/s]warmup should be done:  11%|█         | 317/3000 [00:00<00:01, 1616.57it/s]warmup should be done:  17%|█▋        | 507/3000 [00:00<00:01, 1694.88it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1778.78it/s]warmup should be done:  17%|█▋        | 496/3000 [00:00<00:01, 1693.13it/s]warmup should be done:  17%|█▋        | 516/3000 [00:00<00:01, 1708.57it/s]warmup should be done:  23%|██▎       | 679/3000 [00:00<00:01, 1704.61it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1789.52it/s]warmup should be done:  22%|██▎       | 675/3000 [00:00<00:01, 1731.19it/s]warmup should be done:  23%|██▎       | 696/3000 [00:00<00:01, 1740.76it/s]warmup should be done:  28%|██▊       | 850/3000 [00:00<00:01, 1699.17it/s]warmup should be done:  30%|██▉       | 893/3000 [00:00<00:01, 1784.58it/s]warmup should be done:  29%|██▉       | 871/3000 [00:00<00:01, 1736.34it/s]warmup should be done:  28%|██▊       | 849/3000 [00:00<00:01, 1705.61it/s]warmup should be done:  34%|███▍      | 1020/3000 [00:00<00:01, 1697.24it/s]warmup should be done:  36%|███▌      | 1072/3000 [00:00<00:01, 1778.51it/s]warmup should be done:  35%|███▍      | 1046/3000 [00:00<00:01, 1737.71it/s]warmup should be done:  34%|███▍      | 1022/3000 [00:00<00:01, 1713.45it/s]warmup should be done:  40%|███▉      | 1190/3000 [00:00<00:01, 1692.10it/s]warmup should be done:  42%|████▏     | 1251/3000 [00:00<00:00, 1781.15it/s]warmup should be done:  41%|████      | 1222/3000 [00:00<00:01, 1742.22it/s]warmup should be done:  40%|███▉      | 1194/3000 [00:00<00:01, 1633.07it/s]warmup should be done:  45%|████▌     | 1360/3000 [00:00<00:00, 1693.63it/s]warmup should be done:  48%|████▊     | 1430/3000 [00:00<00:00, 1778.89it/s]warmup should be done:  47%|████▋     | 1399/3000 [00:00<00:00, 1748.92it/s]warmup should be done:  46%|████▌     | 1377/3000 [00:00<00:00, 1690.95it/s]warmup should be done:  51%|█████     | 1530/3000 [00:00<00:00, 1692.63it/s]warmup should be done:  54%|█████▎    | 1609/3000 [00:00<00:00, 1779.28it/s]warmup should be done:  52%|█████▎    | 1575/3000 [00:00<00:00, 1750.86it/s]warmup should be done:  52%|█████▏    | 1558/3000 [00:00<00:00, 1726.89it/s]warmup should be done:  57%|█████▋    | 1700/3000 [00:01<00:00, 1690.53it/s]warmup should be done:  60%|█████▉    | 1787/3000 [00:01<00:00, 1779.01it/s]warmup should be done:  58%|█████▊    | 1751/3000 [00:01<00:00, 1746.52it/s]warmup should be done:  58%|█████▊    | 1732/3000 [00:01<00:00, 1715.35it/s]warmup should be done:  62%|██████▏   | 1871/3000 [00:01<00:00, 1693.74it/s]warmup should be done:  66%|██████▌   | 1965/3000 [00:01<00:00, 1776.28it/s]warmup should be done:  64%|██████▍   | 1927/3000 [00:01<00:00, 1748.75it/s]warmup should be done:  64%|██████▎   | 1911/3000 [00:01<00:00, 1736.67it/s]warmup should be done:  68%|██████▊   | 2044/3000 [00:01<00:00, 1703.29it/s]warmup should be done:  71%|███████▏  | 2144/3000 [00:01<00:00, 1779.04it/s]warmup should be done:  70%|███████   | 2105/3000 [00:01<00:00, 1755.61it/s]warmup should be done:  70%|██████▉   | 2090/3000 [00:01<00:00, 1750.24it/s]warmup should be done:  74%|███████▍  | 2218/3000 [00:01<00:00, 1711.58it/s]warmup should be done:  77%|███████▋  | 2322/3000 [00:01<00:00, 1775.22it/s]warmup should be done:  76%|███████▌  | 2281/3000 [00:01<00:00, 1756.22it/s]warmup should be done:  76%|███████▌  | 2268/3000 [00:01<00:00, 1756.28it/s]warmup should be done:  80%|███████▉  | 2392/3000 [00:01<00:00, 1717.82it/s]warmup should be done:  83%|████████▎ | 2503/3000 [00:01<00:00, 1784.31it/s]warmup should be done:  82%|████████▏ | 2460/3000 [00:01<00:00, 1764.73it/s]warmup should be done:  82%|████████▏ | 2447/3000 [00:01<00:00, 1765.81it/s]warmup should be done:  86%|████████▌ | 2566/3000 [00:01<00:00, 1724.25it/s]warmup should be done:  89%|████████▉ | 2683/3000 [00:01<00:00, 1788.85it/s]warmup should be done:  88%|████████▊ | 2637/3000 [00:01<00:00, 1756.84it/s]warmup should be done:  88%|████████▊ | 2626/3000 [00:01<00:00, 1771.27it/s]warmup should be done:  91%|█████████▏| 2741/3000 [00:01<00:00, 1730.21it/s]warmup should be done:  95%|█████████▌| 2862/3000 [00:01<00:00, 1784.41it/s]warmup should be done:  94%|█████████▍| 2814/3000 [00:01<00:00, 1760.60it/s]warmup should be done:  94%|█████████▎| 2805/3000 [00:01<00:00, 1775.42it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1779.32it/s]warmup should be done:  97%|█████████▋| 2916/3000 [00:01<00:00, 1734.19it/s]warmup should be done: 100%|█████████▉| 2992/3000 [00:01<00:00, 1763.52it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1749.08it/s]warmup should be done:  99%|█████████▉| 2984/3000 [00:01<00:00, 1779.62it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1728.11it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1708.27it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1789.99it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1714.91it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1723.00it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1691.63it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1770.98it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1792.18it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1763.15it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1773.18it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1781.28it/s]warmup should be done:  18%|█▊        | 535/3000 [00:00<00:01, 1787.71it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1761.91it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1694.61it/s]warmup should be done:  24%|██▍       | 717/3000 [00:00<00:01, 1797.67it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1762.87it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1737.37it/s]warmup should be done:  24%|██▍       | 721/3000 [00:00<00:01, 1742.77it/s]warmup should be done:  30%|██▉       | 897/3000 [00:00<00:01, 1795.09it/s]warmup should be done:  30%|██▉       | 891/3000 [00:00<00:01, 1754.49it/s]warmup should be done:  30%|██▉       | 898/3000 [00:00<00:01, 1774.00it/s]warmup should be done:  30%|███       | 906/3000 [00:00<00:01, 1779.68it/s]warmup should be done:  36%|███▌      | 1078/3000 [00:00<00:01, 1799.24it/s]warmup should be done:  36%|███▌      | 1076/3000 [00:00<00:01, 1785.44it/s]warmup should be done:  36%|███▌      | 1082/3000 [00:00<00:01, 1795.01it/s]warmup should be done:  36%|███▋      | 1092/3000 [00:00<00:01, 1805.81it/s]warmup should be done:  42%|████▏     | 1258/3000 [00:00<00:00, 1797.49it/s]warmup should be done:  42%|████▏     | 1260/3000 [00:00<00:00, 1802.49it/s]warmup should be done:  42%|████▏     | 1266/3000 [00:00<00:00, 1807.12it/s]warmup should be done:  43%|████▎     | 1277/3000 [00:00<00:00, 1819.09it/s]warmup should be done:  48%|████▊     | 1441/3000 [00:00<00:00, 1806.62it/s]warmup should be done:  48%|████▊     | 1446/3000 [00:00<00:00, 1818.77it/s]warmup should be done:  48%|████▊     | 1451/3000 [00:00<00:00, 1819.27it/s]warmup should be done:  49%|████▉     | 1463/3000 [00:00<00:00, 1831.60it/s]warmup should be done:  54%|█████▍    | 1624/3000 [00:00<00:00, 1811.11it/s]warmup should be done:  54%|█████▍    | 1628/3000 [00:00<00:00, 1818.94it/s]warmup should be done:  55%|█████▍    | 1636/3000 [00:00<00:00, 1828.38it/s]warmup should be done:  55%|█████▍    | 1649/3000 [00:00<00:00, 1839.07it/s]warmup should be done:  60%|██████    | 1807/3000 [00:01<00:00, 1815.53it/s]warmup should be done:  60%|██████    | 1810/3000 [00:01<00:00, 1804.42it/s]warmup should be done:  61%|██████    | 1821/3000 [00:01<00:00, 1834.43it/s]warmup should be done:  61%|██████    | 1836/3000 [00:01<00:00, 1846.97it/s]warmup should be done:  67%|██████▋   | 2005/3000 [00:01<00:00, 1835.75it/s]warmup should be done:  66%|██████▋   | 1991/3000 [00:01<00:00, 1783.65it/s]warmup should be done:  67%|██████▋   | 2023/3000 [00:01<00:00, 1853.06it/s]warmup should be done:  66%|██████▋   | 1989/3000 [00:01<00:00, 1687.95it/s]warmup should be done:  72%|███████▏  | 2170/3000 [00:01<00:00, 1773.36it/s]warmup should be done:  74%|███████▎  | 2209/3000 [00:01<00:00, 1853.24it/s]warmup should be done:  73%|███████▎  | 2189/3000 [00:01<00:00, 1766.51it/s]warmup should be done:  72%|███████▏  | 2160/3000 [00:01<00:00, 1588.66it/s]warmup should be done:  78%|███████▊  | 2348/3000 [00:01<00:00, 1770.62it/s]warmup should be done:  80%|███████▉  | 2395/3000 [00:01<00:00, 1852.02it/s]warmup should be done:  79%|███████▉  | 2367/3000 [00:01<00:00, 1762.55it/s]warmup should be done:  78%|███████▊  | 2342/3000 [00:01<00:00, 1652.62it/s]warmup should be done:  86%|████████▌ | 2581/3000 [00:01<00:00, 1853.63it/s]warmup should be done:  84%|████████▍ | 2526/3000 [00:01<00:00, 1763.16it/s]warmup should be done:  85%|████████▍ | 2546/3000 [00:01<00:00, 1768.76it/s]warmup should be done:  84%|████████▍ | 2527/3000 [00:01<00:00, 1708.32it/s]warmup should be done:  92%|█████████▏| 2768/3000 [00:01<00:00, 1856.53it/s]warmup should be done:  90%|█████████ | 2703/3000 [00:01<00:00, 1754.53it/s]warmup should be done:  91%|█████████ | 2725/3000 [00:01<00:00, 1773.41it/s]warmup should be done:  90%|█████████ | 2711/3000 [00:01<00:00, 1745.15it/s]warmup should be done:  98%|█████████▊| 2954/3000 [00:01<00:00, 1856.11it/s]warmup should be done:  96%|█████████▌| 2879/3000 [00:01<00:00, 1755.54it/s]warmup should be done:  97%|█████████▋| 2903/3000 [00:01<00:00, 1774.71it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1826.53it/s]warmup should be done:  97%|█████████▋| 2896/3000 [00:01<00:00, 1773.52it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1785.84it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1776.45it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1755.00it/s]2022-12-11 21:53:36.553482: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f5012a683f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:53:36.553553: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:53:38.158823: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:53:39.280900: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:53:41.254352: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:53:41.484499: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f5016a68050 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:53:41.484592: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:53:44.245573: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:53:45.345341: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:53:46.633036: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:53:48.242848: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f501626acf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:53:48.242906: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:53:49.889754: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:53:51.363561: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f50162645a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:53:51.363620: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:53:51.948857: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:53:53.882091: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:53:55.951359: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:53:57.881431: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:53:59.335030: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][21:54:29.770][ERROR][RK0][tid #139982362629888]: replica 2 reaches 1000, calling init pre replica
[HCTR][21:54:29.771][ERROR][RK0][tid #139982362629888]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:54:29.776][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][21:54:29.776][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:54:29.776][ERROR][RK0][tid #139982362629888]: coll ps creation done
[HCTR][21:54:29.776][ERROR][RK0][tid #139982362629888]: replica 2 waits for coll ps creation barrier
[HCTR][21:54:29.780][ERROR][RK0][main]: coll ps creation done
[HCTR][21:54:29.780][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][21:54:29.789][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][21:54:29.789][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:54:29.792][ERROR][RK0][main]: coll ps creation done
[HCTR][21:54:29.792][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][21:54:29.838][ERROR][RK0][tid #139982220019456]: replica 3 reaches 1000, calling init pre replica
[HCTR][21:54:29.838][ERROR][RK0][tid #139982220019456]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:54:29.841][ERROR][RK0][tid #139982220019456]: coll ps creation done
[HCTR][21:54:29.841][ERROR][RK0][tid #139982220019456]: replica 3 waits for coll ps creation barrier
[HCTR][21:54:29.841][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][21:54:30.774][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][21:54:30.809][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][21:54:30.809][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][21:54:30.809][ERROR][RK0][tid #139982362629888]: replica 2 calling init per replica
[HCTR][21:54:30.809][ERROR][RK0][main]: Calling build_v2
[HCTR][21:54:30.809][ERROR][RK0][main]: Calling build_v2
[HCTR][21:54:30.809][ERROR][RK0][tid #139982362629888]: Calling build_v2
[HCTR][21:54:30.809][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:54:30.809][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:54:30.809][ERROR][RK0][tid #139982362629888]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:54:30.809][ERROR][RK0][tid #139982220019456]: replica 3 calling init per replica
[[[2022-12-11 21:54:302022-12-11 21:54:30..8095048094922022-12-11 21:54:30: : .EE809510  : /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE:: 136136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] ] :using concurrent impl MPSPhaseusing concurrent impl MPSPhase136

] using concurrent impl MPSPhase
[HCTR][21:54:30.810][ERROR][RK0][tid #139982220019456]: Calling build_v2
[HCTR][21:54:30.810][ERROR][RK0][tid #139982220019456]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 21:54:30.810388: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[2022-12-11 21:54:30.810463: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-11 21:54:30.810504: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 21:54:30.810535: [E2022-12-11 21:54:30 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc810552:: 196E]  assigning 8 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[
:2022-12-11 21:54:30212.] 810584build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] [build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[2022-12-11 21:54:30
2022-12-11 21:54:30..810618810629: : [EE2022-12-11 21:54:30  ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc810651::: 212213E] ]  build symm link desc with 4X Tesla V100-SXM2-16GB out of 4remote time is 8.68421/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc

:213] remote time is 8.68421[
2022-12-11 21:54:30[.2022-12-11 21:54:30[810715.2022-12-11 21:54:30: 810719.E: 810727 E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc E:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 214:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] 213:cpu time is 30] 214
remote time is 8.68421] 
cpu time is 30
[2022-12-11 21:54:30.810809: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] [cpu time is 302022-12-11 21:54:30
.810843: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 21:54:30.811738: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 21:54:30.811814: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 21:54:30.811858: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 21:54:56.671203: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 21:54:56.736042: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 21:54:56.736149: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 21:54:56.737198: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 21:54:56.834401: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 21:54:57.199192: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 21:54:57.199287: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 21:55:04.657008: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1022
[2022-12-11 21:55:04.657116: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 21:55:06.473664: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 21:55:06.473785: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1022
[2022-12-11 21:55:06.477519: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 21:55:06.477581: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1022 blocks, 4 devices
[2022-12-11 21:55:06.501082: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 21:55:06.514698: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 21:55:06.515646: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 21:55:06.526609: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 21:55:06.617589: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 21:55:06.620411: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 21:55:06.622856: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 21:55:06.625218: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 21:55:06.627591: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 21:55:12.521269: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 21:55:12.526446: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 21:55:12.526996: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 21:55:12.538177: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 21:55:12.538245: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 21:55:12.538278: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 21:55:12.538309: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 21:55:12.539839: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:55:12.539888: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:55:12.540880: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:55:12.541437: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:55:12.560859: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 21:55:12.560958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 21:55:12.561247: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 21:55:12.561338: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 21:55:12.561648: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 21:55:12.561969: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 21:55:12.562037: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:55:12.562098: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:55:12.562295: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:55:12.562348: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:55:12.562689: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:55:12.562742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:55:12.563828: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:55:12.564406: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:55:12.564515: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:55:12.564929: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:55:12.565917: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:55:12.565973: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:55:12.633396: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1022.00 Bytes
[2022-12-11 21:55:12.635264: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1022
[2022-12-11 21:55:12.635322: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:55:12.636117: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 21:55:12.636609: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:55:12.637526: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:55:12.637572: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.86 MB
[2022-12-11 21:55:12.650713: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:55:12.651353: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:55:12.651399: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.86 GB
[[[2022-12-11 21:55:122022-12-11 21:55:122022-12-11 21:55:12...657200657199657199: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 1022.00 Byteseager alloc mem 1022.00 Byteseager alloc mem 1022.00 Bytes


[[[2022-12-11 21:55:122022-12-11 21:55:122022-12-11 21:55:12...659061659061659062: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:::638638638] ] ] eager release cuda mem 1022eager release cuda mem 1022eager release cuda mem 1022


[2022-12-11 21:55:12[[.2022-12-11 21:55:122022-12-11 21:55:12659161..: 659163659165E: :  EE/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc  :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638::] 638638eager release cuda mem 400000000] ] 
eager release cuda mem 400000000eager release cuda mem 400000000

[2022-12-11 21:55:12.660061: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 21:55:12.660553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 21:55:12.661036: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 21:55:12.661639: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 21:55:12eager alloc mem 611.00 KB.
661661: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:55:12.662008: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:55:12.662566: [E2022-12-11 21:55:12 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc662576:: 638E]  eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-11 21:55:12.662626: W [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc2022-12-11 21:55:12:.43662638] : WORKER[0] alloc host memory 22.86 MBW
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.80 MB
[2022-12-11 21:55:12.662928: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:55:12.662969: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.78 MB
[2022-12-11 21:55:12.670816: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:55:12.671486: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:55:12.671531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.86 GB
[2022-12-11 21:55:12.673947: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:55:12.674532: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:55:12.674579: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.85 GB
[2022-12-11 21:55:12.676151: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:55:12.676725: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:55:12.676764: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.85 GB
[[[2022-12-11 21:55:122022-12-11 21:55:12[2022-12-11 21:55:12..2022-12-11 21:55:12.931006931005.931004: : 931011: EE: E  E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:19261926:1926] ] 1926] Device 3 init p2p of link 0Device 0 init p2p of link 1] Device 2 init p2p of link 3Device 1 init p2p of link 2



[[2022-12-11 21:55:122022-12-11 21:55:12..931312[931316: 2022-12-11 21:55:12: E.E 931327 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:E:1980 1980[] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] 2022-12-11 21:55:12eager alloc mem 611.00 KB:eager alloc mem 611.00 KB.
1980
931362] : eager alloc mem 611.00 KBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:55:12.932152: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:55:12[.2022-12-11 21:55:12932178.: 932184E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :[/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc6382022-12-11 21:55:12:] .638eager release cuda mem 625663932210] 
: eager release cuda mem 625663E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[[2022-12-11 21:55:122022-12-11 21:55:12..935841935841: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261926] ] Device 3 init p2p of link 1Device 0 init p2p of link 2

[2022-12-11 21:55:12.935959: E[ 2022-12-11 21:55:12/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:9359721980: ] Eeager alloc mem 611.00 KB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:55:12.936353: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 21:55:12.936464: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:55:12.936572: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 21:55:12.936662: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:55:12.936736: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:55:12.936767: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:55:12.937235: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:55:12.937452: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:55:12.940097: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 21:55:12.940188: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:55:12.940452: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 21:55:12.940530: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:55:12.940948: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 21:55:12.940988: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:55:12.941026: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:55:12.941296: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:[6382022-12-11 21:55:12] .eager release cuda mem 625663941307
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 21:55:12.941415: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:55:12.941816: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:55:12.942180: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:55:12.943996: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 21:55:12.944251: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5977303 / 100000000 nodes ( 5.98 %~6.00 %) | remote 17346460 / 100000000 nodes ( 17.35 %) | cpu 76676237 / 100000000 nodes ( 76.68 %) | 2.85 GB | 0.382177 secs 
[2022-12-11 21:55:12.944596: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 21:55:12.944719: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 21:55:12.944832: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5970957 / 100000000 nodes ( 5.97 %~6.00 %) | remote 17352806 / 100000000 nodes ( 17.35 %) | cpu 76676237 / 100000000 nodes ( 76.68 %) | 2.85 GB | 0.382501 secs 
[2022-12-11 21:55:12.945012: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5991751 / 100000000 nodes ( 5.99 %~6.00 %) | remote 17332012 / 100000000 nodes ( 17.33 %) | cpu 76676237 / 100000000 nodes ( 76.68 %) | 2.86 GB | 0.405132 secs 
[2022-12-11 21:55:12.945078: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 21:55:12.945724: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5993361 / 100000000 nodes ( 5.99 %~6.00 %) | remote 17330402 / 100000000 nodes ( 17.33 %) | cpu 76676237 / 100000000 nodes ( 76.68 %) | 2.86 GB | 0.382997 secs 
[2022-12-11 21:55:12.945819: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 7.89 GB
[2022-12-11 21:55:13.871389: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 8.14 GB
[2022-12-11 21:55:13.871527: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 8.14 GB
[2022-12-11 21:55:13.871805: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 8.14 GB
[2022-12-11 21:55:14.661741: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 8.38 GB
[2022-12-11 21:55:14.661874: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 8.38 GB
[2022-12-11 21:55:14.662263: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 8.38 GB
[2022-12-11 21:55:15.472328: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 8.63 GB
[2022-12-11 21:55:15.472465: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 8.63 GB
[2022-12-11 21:55:15.472935: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 8.63 GB
[2022-12-11 21:55:15.473303: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 8.63 GB
[2022-12-11 21:55:15.473701: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 8.63 GB
[2022-12-11 21:55:16.294770: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 8.82 GB
[2022-12-11 21:55:16.294885: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 8.82 GB
[HCTR][21:55:16.312][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][21:55:16.312][ERROR][RK0][tid #139982220019456]: replica 3 calling init per replica done, doing barrier
[HCTR][21:55:16.312][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][21:55:16.312][ERROR][RK0][tid #139982362629888]: replica 2 calling init per replica done, doing barrier
[HCTR][21:55:16.312][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][21:55:16.312][ERROR][RK0][tid #139982220019456]: replica 3 calling init per replica done, doing barrier done
[HCTR][21:55:16.312][ERROR][RK0][tid #139982362629888]: replica 2 calling init per replica done, doing barrier done
[HCTR][21:55:16.312][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][21:55:16.312][ERROR][RK0][tid #139982220019456]: init per replica done
[HCTR][21:55:16.312][ERROR][RK0][tid #139982362629888]: init per replica done
[HCTR][21:55:16.312][ERROR][RK0][main]: init per replica done
[HCTR][21:55:16.315][ERROR][RK0][main]: init per replica done
[HCTR][21:55:16.319][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f3e0b520000
[HCTR][21:55:16.319][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f392e000000
[HCTR][21:55:16.319][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f392e640000
[HCTR][21:55:16.319][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f392e960000
[HCTR][21:55:16.321][ERROR][RK0][tid #139982220019456]: 3 allocated 3276800 at 0x7f3e0b520000
[HCTR][21:55:16.321][ERROR][RK0][tid #139982220019456]: 3 allocated 6553600 at 0x7f3862000000
[HCTR][21:55:16.321][ERROR][RK0][tid #139982220019456]: 3 allocated 3276800 at 0x7f3862640000
[HCTR][21:55:16.321][ERROR][RK0][tid #139982220019456]: 3 allocated 6553600 at 0x7f3862960000
[HCTR][21:55:16.322][ERROR][RK0][tid #139982362629888]: 2 allocated 3276800 at 0x7f3e0b520000
[HCTR][21:55:16.323][ERROR][RK0][tid #139982362629888]: 2 allocated 6553600 at 0x7f3846000000
[HCTR][21:55:16.323][ERROR][RK0][tid #139982362629888]: 2 allocated 3276800 at 0x7f3846640000
[HCTR][21:55:16.323][ERROR][RK0][tid #139982362629888]: 2 allocated 6553600 at 0x7f3846960000
[HCTR][21:55:16.324][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f381e320000
[HCTR][21:55:16.324][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f381e800000
[HCTR][21:55:16.324][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f381f50e800
[HCTR][21:55:16.324][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f381f82e800




