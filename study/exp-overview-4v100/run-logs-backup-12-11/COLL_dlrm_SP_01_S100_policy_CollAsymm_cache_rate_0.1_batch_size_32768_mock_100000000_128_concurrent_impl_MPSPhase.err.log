2022-12-11 23:29:20.349375: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:29:20.434814: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:29:20.435051: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:29:20.435051: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:29:21.238969: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:29:21.239048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:29:21.254407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:29:21.289770: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:29:21.289952: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:29:21.291520: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 23:29:21.335951: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:29:21.336025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:29:21.336810: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:29:21.336860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:29:21.336964: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:29:21.337010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:29:21.350663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:29:21.353533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:29:21.353936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:29:21.385217: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:29:21.385386: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:29:21.386209: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 23:29:21.388878: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:29:21.389010: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:29:21.389834: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 23:29:21.390202: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:29:21.390338: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:29:21.391768: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][23:29:21.667][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:29:22.625][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:29:22.635][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:29:22.677][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 104it [00:01, 93.62it/s]warmup run: 209it [00:01, 202.83it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 315it [00:01, 322.85it/s]warmup run: 109it [00:01, 95.86it/s]warmup run: 414it [00:01, 433.28it/s]warmup run: 218it [00:01, 207.00it/s]warmup run: 517it [00:01, 547.00it/s]warmup run: 327it [00:01, 328.53it/s]warmup run: 626it [00:02, 663.12it/s]warmup run: 426it [00:01, 436.70it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 729it [00:02, 748.18it/s]warmup run: 529it [00:01, 548.58it/s]warmup run: 107it [00:01, 97.93it/s]warmup run: 832it [00:02, 818.30it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 636it [00:02, 658.82it/s]warmup run: 209it [00:01, 204.70it/s]warmup run: 934it [00:02, 865.21it/s]warmup run: 107it [00:01, 97.06it/s]warmup run: 743it [00:02, 754.24it/s]warmup run: 308it [00:01, 316.06it/s]warmup run: 1040it [00:02, 917.21it/s]warmup run: 213it [00:01, 207.62it/s]warmup run: 848it [00:02, 827.14it/s]warmup run: 412it [00:01, 437.66it/s]warmup run: 1147it [00:02, 958.09it/s]warmup run: 319it [00:01, 327.50it/s]warmup run: 953it [00:02, 885.00it/s]warmup run: 513it [00:01, 548.21it/s]warmup run: 1251it [00:02, 969.80it/s]warmup run: 422it [00:01, 444.61it/s]warmup run: 1057it [00:02, 927.24it/s]warmup run: 616it [00:02, 650.45it/s]warmup run: 1360it [00:02, 1003.60it/s]warmup run: 527it [00:01, 561.31it/s]warmup run: 1162it [00:02, 959.23it/s]warmup run: 720it [00:02, 740.91it/s]warmup run: 631it [00:02, 663.41it/s]warmup run: 1465it [00:02, 1003.91it/s]warmup run: 1271it [00:02, 995.85it/s]warmup run: 820it [00:02, 803.80it/s]warmup run: 738it [00:02, 758.02it/s]warmup run: 1572it [00:02, 1022.55it/s]warmup run: 1378it [00:02, 1016.47it/s]warmup run: 927it [00:02, 872.21it/s]warmup run: 845it [00:02, 836.43it/s]warmup run: 1678it [00:03, 1032.11it/s]warmup run: 1485it [00:02, 1029.85it/s]warmup run: 1034it [00:02, 924.21it/s]warmup run: 953it [00:02, 898.57it/s]warmup run: 1784it [00:03, 1039.85it/s]warmup run: 1591it [00:02, 1035.17it/s]warmup run: 1141it [00:02, 964.68it/s]warmup run: 1058it [00:02, 935.98it/s]warmup run: 1889it [00:03, 1041.58it/s]warmup run: 1698it [00:03, 1043.87it/s]warmup run: 1251it [00:02, 1000.54it/s]warmup run: 1994it [00:03, 1043.47it/s]warmup run: 1163it [00:02, 956.60it/s]warmup run: 1804it [00:03, 1048.29it/s]warmup run: 1361it [00:02, 1026.97it/s]warmup run: 2122it [00:03, 1113.40it/s]warmup run: 1269it [00:02, 983.11it/s]warmup run: 1910it [00:03, 1050.09it/s]warmup run: 1471it [00:02, 1046.39it/s]warmup run: 2253it [00:03, 1170.74it/s]warmup run: 1378it [00:02, 1011.73it/s]warmup run: 2016it [00:03, 1001.54it/s]warmup run: 1581it [00:02, 1059.52it/s]warmup run: 2384it [00:03, 1209.86it/s]warmup run: 1485it [00:02, 1026.07it/s]warmup run: 2118it [00:03, 996.04it/s] warmup run: 1690it [00:03, 1067.31it/s]warmup run: 2514it [00:03, 1236.68it/s]warmup run: 1594it [00:02, 1042.88it/s]warmup run: 2249it [00:03, 1084.56it/s]warmup run: 1799it [00:03, 1071.50it/s]warmup run: 2646it [00:03, 1260.93it/s]warmup run: 1701it [00:03, 1047.75it/s]warmup run: 2381it [00:03, 1151.37it/s]warmup run: 1908it [00:03, 1068.54it/s]warmup run: 2778it [00:03, 1275.82it/s]warmup run: 1809it [00:03, 1056.49it/s]warmup run: 2514it [00:03, 1201.47it/s]warmup run: 2022it [00:03, 1088.47it/s]warmup run: 2911it [00:04, 1290.49it/s]warmup run: 1917it [00:03, 1062.85it/s]warmup run: 2646it [00:03, 1234.51it/s]warmup run: 2156it [00:03, 1161.50it/s]warmup run: 3000it [00:04, 725.33it/s] warmup run: 2030it [00:03, 1080.60it/s]warmup run: 2779it [00:04, 1261.63it/s]warmup run: 2290it [00:03, 1213.74it/s]warmup run: 2164it [00:03, 1155.85it/s]warmup run: 2913it [00:04, 1283.95it/s]warmup run: 2424it [00:03, 1250.99it/s]warmup run: 2294it [00:03, 1196.37it/s]warmup run: 3000it [00:04, 717.29it/s] warmup run: 2556it [00:03, 1270.70it/s]warmup run: 2429it [00:03, 1241.95it/s]warmup run: 2687it [00:03, 1282.39it/s]warmup run: 2561it [00:03, 1263.94it/s]warmup run: 2818it [00:03, 1288.81it/s]warmup run: 2696it [00:03, 1288.66it/s]warmup run: 2952it [00:04, 1301.64it/s]warmup run: 2833it [00:03, 1309.44it/s]warmup run: 3000it [00:04, 736.31it/s] warmup run: 2965it [00:04, 1264.59it/s]warmup run: 3000it [00:04, 732.93it/s] 

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1718.83it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1752.54it/s]warmup should be done:   5%|▌         | 158/3000 [00:00<00:01, 1572.66it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1643.67it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1754.29it/s]warmup should be done:  11%|█▏        | 340/3000 [00:00<00:01, 1713.94it/s]warmup should be done:  12%|█▏        | 345/3000 [00:00<00:01, 1734.38it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1716.21it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1759.72it/s]warmup should be done:  17%|█▋        | 520/3000 [00:00<00:01, 1749.88it/s]warmup should be done:  17%|█▋        | 522/3000 [00:00<00:01, 1746.94it/s]warmup should be done:  18%|█▊        | 529/3000 [00:00<00:01, 1736.01it/s]warmup should be done:  23%|██▎       | 703/3000 [00:00<00:01, 1758.60it/s]warmup should be done:  23%|██▎       | 701/3000 [00:00<00:01, 1772.83it/s]warmup should be done:  23%|██▎       | 701/3000 [00:00<00:01, 1761.63it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1748.76it/s]warmup should be done:  29%|██▉       | 881/3000 [00:00<00:01, 1760.67it/s]warmup should be done:  29%|██▉       | 881/3000 [00:00<00:01, 1780.23it/s]warmup should be done:  29%|██▉       | 878/3000 [00:00<00:01, 1758.37it/s]warmup should be done:  29%|██▉       | 883/3000 [00:00<00:01, 1755.93it/s]warmup should be done:  35%|███▌      | 1058/3000 [00:00<00:01, 1761.78it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1783.16it/s]warmup should be done:  35%|███▌      | 1055/3000 [00:00<00:01, 1759.06it/s]warmup should be done:  35%|███▌      | 1059/3000 [00:00<00:01, 1755.54it/s]warmup should be done:  41%|████      | 1236/3000 [00:00<00:00, 1765.55it/s]warmup should be done:  41%|████▏     | 1240/3000 [00:00<00:00, 1788.34it/s]warmup should be done:  41%|████      | 1232/3000 [00:00<00:01, 1760.92it/s]warmup should be done:  41%|████      | 1235/3000 [00:00<00:01, 1645.96it/s]warmup should be done:  47%|████▋     | 1420/3000 [00:00<00:00, 1789.28it/s]warmup should be done:  47%|████▋     | 1413/3000 [00:00<00:00, 1761.90it/s]warmup should be done:  47%|████▋     | 1409/3000 [00:00<00:00, 1763.59it/s]warmup should be done:  47%|████▋     | 1401/3000 [00:00<00:01, 1595.30it/s]warmup should be done:  53%|█████▎    | 1600/3000 [00:00<00:00, 1790.59it/s]warmup should be done:  53%|█████▎    | 1587/3000 [00:00<00:00, 1766.89it/s]warmup should be done:  53%|█████▎    | 1590/3000 [00:00<00:00, 1741.09it/s]warmup should be done:  53%|█████▎    | 1579/3000 [00:00<00:00, 1647.70it/s]warmup should be done:  59%|█████▉    | 1764/3000 [00:01<00:00, 1763.74it/s]warmup should be done:  59%|█████▉    | 1780/3000 [00:01<00:00, 1746.13it/s]warmup should be done:  59%|█████▉    | 1765/3000 [00:01<00:00, 1693.65it/s]warmup should be done:  59%|█████▊    | 1758/3000 [00:01<00:00, 1687.55it/s]warmup should be done:  65%|██████▍   | 1942/3000 [00:01<00:00, 1765.84it/s]warmup should be done:  65%|██████▌   | 1960/3000 [00:01<00:00, 1761.68it/s]warmup should be done:  65%|██████▍   | 1941/3000 [00:01<00:00, 1712.48it/s]warmup should be done:  65%|██████▍   | 1937/3000 [00:01<00:00, 1716.42it/s]warmup should be done:  71%|███████   | 2119/3000 [00:01<00:00, 1764.63it/s]warmup should be done:  71%|███████▏  | 2138/3000 [00:01<00:00, 1766.67it/s]warmup should be done:  71%|███████   | 2118/3000 [00:01<00:00, 1727.66it/s]warmup should be done:  70%|███████   | 2115/3000 [00:01<00:00, 1734.57it/s]warmup should be done:  77%|███████▋  | 2296/3000 [00:01<00:00, 1763.81it/s]warmup should be done:  77%|███████▋  | 2315/3000 [00:01<00:00, 1766.05it/s]warmup should be done:  77%|███████▋  | 2297/3000 [00:01<00:00, 1744.97it/s]warmup should be done:  76%|███████▋  | 2293/3000 [00:01<00:00, 1747.11it/s]warmup should be done:  82%|████████▏ | 2473/3000 [00:01<00:00, 1754.69it/s]warmup should be done:  83%|████████▎ | 2495/3000 [00:01<00:00, 1775.62it/s]warmup should be done:  82%|████████▏ | 2472/3000 [00:01<00:00, 1732.98it/s]warmup should be done:  82%|████████▏ | 2469/3000 [00:01<00:00, 1722.92it/s]warmup should be done:  88%|████████▊ | 2651/3000 [00:01<00:00, 1760.84it/s]warmup should be done:  89%|████████▉ | 2675/3000 [00:01<00:00, 1781.56it/s]warmup should be done:  88%|████████▊ | 2650/3000 [00:01<00:00, 1746.40it/s]warmup should be done:  88%|████████▊ | 2650/3000 [00:01<00:00, 1746.13it/s]warmup should be done:  94%|█████████▍| 2828/3000 [00:01<00:00, 1763.35it/s]warmup should be done:  95%|█████████▌| 2854/3000 [00:01<00:00, 1780.29it/s]warmup should be done:  94%|█████████▍| 2827/3000 [00:01<00:00, 1750.72it/s]warmup should be done:  94%|█████████▍| 2828/3000 [00:01<00:00, 1754.44it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1769.46it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1759.37it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1746.26it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1723.25it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1775.20it/s]warmup should be done:   6%|▌         | 179/3000 [00:00<00:01, 1784.51it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1711.92it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1741.07it/s]warmup should be done:  12%|█▏        | 364/3000 [00:00<00:01, 1820.14it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1759.54it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1725.12it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1748.27it/s]warmup should be done:  18%|█▊        | 549/3000 [00:00<00:01, 1832.53it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1761.67it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1761.18it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1730.64it/s]warmup should be done:  24%|██▍       | 733/3000 [00:00<00:01, 1831.60it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1770.88it/s]warmup should be done:  24%|██▎       | 708/3000 [00:00<00:01, 1748.00it/s]warmup should be done:  23%|██▎       | 702/3000 [00:00<00:01, 1711.59it/s]warmup should be done:  30%|██▉       | 898/3000 [00:00<00:01, 1796.83it/s]warmup should be done:  30%|██▉       | 891/3000 [00:00<00:01, 1776.62it/s]warmup should be done:  29%|██▉       | 880/3000 [00:00<00:01, 1734.04it/s]warmup should be done:  31%|███       | 917/3000 [00:00<00:01, 1766.02it/s]warmup should be done:  36%|███▌      | 1082/3000 [00:00<00:01, 1809.07it/s]warmup should be done:  36%|███▌      | 1074/3000 [00:00<00:01, 1792.19it/s]warmup should be done:  35%|███▌      | 1063/3000 [00:00<00:01, 1765.05it/s]warmup should be done:  37%|███▋      | 1102/3000 [00:00<00:01, 1791.88it/s]warmup should be done:  42%|████▏     | 1266/3000 [00:00<00:00, 1816.70it/s]warmup should be done:  42%|████▏     | 1256/3000 [00:00<00:00, 1798.11it/s]warmup should be done:  41%|████▏     | 1240/3000 [00:00<00:01, 1757.29it/s]warmup should be done:  43%|████▎     | 1285/3000 [00:00<00:00, 1802.77it/s]warmup should be done:  48%|████▊     | 1451/3000 [00:00<00:00, 1824.45it/s]warmup should be done:  48%|████▊     | 1439/3000 [00:00<00:00, 1806.72it/s]warmup should be done:  47%|████▋     | 1417/3000 [00:00<00:00, 1758.75it/s]warmup should be done:  49%|████▉     | 1468/3000 [00:00<00:00, 1810.28it/s]warmup should be done:  55%|█████▍    | 1636/3000 [00:00<00:00, 1830.13it/s]warmup should be done:  54%|█████▍    | 1622/3000 [00:00<00:00, 1812.81it/s]warmup should be done:  53%|█████▎    | 1594/3000 [00:00<00:00, 1759.88it/s]warmup should be done:  55%|█████▌    | 1652/3000 [00:00<00:00, 1819.29it/s]warmup should be done:  61%|██████    | 1820/3000 [00:01<00:00, 1831.47it/s]warmup should be done:  60%|██████    | 1805/3000 [00:01<00:00, 1817.17it/s]warmup should be done:  59%|█████▉    | 1771/3000 [00:01<00:00, 1761.15it/s]warmup should be done:  61%|██████    | 1837/3000 [00:01<00:00, 1827.65it/s]warmup should be done:  66%|██████▋   | 1989/3000 [00:01<00:00, 1821.42it/s]warmup should be done:  67%|██████▋   | 2004/3000 [00:01<00:00, 1812.29it/s]warmup should be done:  65%|██████▍   | 1948/3000 [00:01<00:00, 1761.73it/s]warmup should be done:  67%|██████▋   | 2021/3000 [00:01<00:00, 1830.42it/s]warmup should be done:  72%|███████▏  | 2173/3000 [00:01<00:00, 1824.30it/s]warmup should be done:  71%|███████   | 2126/3000 [00:01<00:00, 1766.70it/s]warmup should be done:  73%|███████▎  | 2186/3000 [00:01<00:00, 1673.81it/s]warmup should be done:  74%|███████▎  | 2205/3000 [00:01<00:00, 1668.51it/s]warmup should be done:  79%|███████▊  | 2357/3000 [00:01<00:00, 1827.95it/s]warmup should be done:  77%|███████▋  | 2304/3000 [00:01<00:00, 1769.61it/s]warmup should be done:  79%|███████▉  | 2372/3000 [00:01<00:00, 1725.54it/s]warmup should be done:  80%|███████▉  | 2388/3000 [00:01<00:00, 1711.83it/s]warmup should be done:  85%|████████▍ | 2541/3000 [00:01<00:00, 1830.63it/s]warmup should be done:  83%|████████▎ | 2482/3000 [00:01<00:00, 1770.50it/s]warmup should be done:  85%|████████▌ | 2559/3000 [00:01<00:00, 1765.73it/s]warmup should be done:  86%|████████▌ | 2572/3000 [00:01<00:00, 1746.92it/s]warmup should be done:  91%|█████████ | 2725/3000 [00:01<00:00, 1833.10it/s]warmup should be done:  89%|████████▊ | 2660/3000 [00:01<00:00, 1770.21it/s]warmup should be done:  92%|█████████▏| 2746/3000 [00:01<00:00, 1795.26it/s]warmup should be done:  92%|█████████▏| 2757/3000 [00:01<00:00, 1775.66it/s]warmup should be done:  97%|█████████▋| 2909/3000 [00:01<00:00, 1833.24it/s]warmup should be done:  95%|█████████▍| 2838/3000 [00:01<00:00, 1768.38it/s]warmup should be done:  98%|█████████▊| 2933/3000 [00:01<00:00, 1816.46it/s]warmup should be done:  98%|█████████▊| 2939/3000 [00:01<00:00, 1788.03it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1808.74it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1791.17it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1785.22it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1759.54it/s]2022-12-11 23:30:37.783217: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f80ce26b7c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:30:37.783276: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:30:40.490921: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:30:41.640997: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:30:43.039336: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:30:52.772984: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f80ce263e80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:30:52.773057: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:30:57.296540: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:30:58.052766: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f80ce267410 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:30:58.052818: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:30:58.167701: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f80cea67d80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:30:58.167757: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:30:59.218015: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:31:01.102423: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:31:02.374222: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:31:02.940818: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:31:04.369056: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:31:04.858696: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:31:06.279236: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:31:06.724333: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][23:31:34.644][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][23:31:34.644][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:31:34.648][ERROR][RK0][main]: coll ps creation done
[HCTR][23:31:34.648][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][23:31:34.654][ERROR][RK0][tid #140191356417792]: replica 1 reaches 1000, calling init pre replica
[HCTR][23:31:34.654][ERROR][RK0][tid #140191356417792]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:31:34.659][ERROR][RK0][tid #140191356417792]: coll ps creation done
[HCTR][23:31:34.659][ERROR][RK0][tid #140191356417792]: replica 1 waits for coll ps creation barrier
[HCTR][23:31:34.684][ERROR][RK0][tid #140191356417792]: replica 0 reaches 1000, calling init pre replica
[HCTR][23:31:34.684][ERROR][RK0][tid #140191356417792]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:31:34.688][ERROR][RK0][tid #140191356417792]: coll ps creation done
[HCTR][23:31:34.688][ERROR][RK0][tid #140191356417792]: replica 0 waits for coll ps creation barrier
[HCTR][23:31:34.930][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][23:31:34.930][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:31:34.934][ERROR][RK0][main]: coll ps creation done
[HCTR][23:31:34.934][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][23:31:34.934][ERROR][RK0][tid #140191356417792]: replica 0 preparing frequency
[HCTR][23:31:35.902][ERROR][RK0][tid #140191356417792]: replica 0 preparing frequency done
[HCTR][23:31:35.934][ERROR][RK0][tid #140191356417792]: replica 0 calling init per replica
[HCTR][23:31:35.934][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][23:31:35.934][ERROR][RK0][tid #140191356417792]: Calling build_v2
[HCTR][23:31:35.934][ERROR][RK0][tid #140191356417792]: replica 1 calling init per replica
[HCTR][23:31:35.934][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][23:31:35.934][ERROR][RK0][tid #140191356417792]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:31:35.934][ERROR][RK0][main]: Calling build_v2
[HCTR][23:31:35.934][ERROR][RK0][tid #140191356417792]: Calling build_v2
[HCTR][23:31:35.934][ERROR][RK0][tid #140191356417792]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:31:35.934][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:31:35.934][ERROR][RK0][main]: Calling build_v2
[HCTR][23:31:35.934][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-11 23:31:35.2022-12-11 23:31:352022-12-11 23:31:35934832.[.: 9348329348462022-12-11 23:31:35E: : . EE934857/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc  : :/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE136:: ] 136136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccusing concurrent impl MPSPhase] ] :
using concurrent impl MPSPhaseusing concurrent impl MPSPhase136

] using concurrent impl MPSPhase
[2022-12-11 23:31:35.935998: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] [assigning 8 to cpu2022-12-11 23:31:35
.936019: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-11 23:31:35.936045: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
[2022-12-11 23:31:352022-12-11 23:31:35..936070936074: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::196212] ] assigning 8 to cpu[build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
2022-12-11 23:31:35
.936114: E[ 2022-12-11 23:31:35/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[.:2022-12-11 23:31:35936133212.: ] 936144Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4:  
E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[ :2022-12-11 23:31:35/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc212.[:] 9361552022-12-11 23:31:35213build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: .] 
E936186remote time is 8.68421 : 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[E:2022-12-11 23:31:35[ 212.2022-12-11 23:31:35/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] 936223.:build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 936232213
E: ]  Eremote time is 8.68421/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc [
:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 23:31:35213:.[] 2149362762022-12-11 23:31:35remote time is 8.68421] : .
cpu time is 30E936291
 [: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 23:31:35E:. 213936322/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] : :remote time is 8.68421E214
 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30:[
2142022-12-11 23:31:35] .cpu time is 30936376
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 23:32:01.875706: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 23:32:01.945557: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 23:32:01.945670: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 23:32:01.946784: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 23:32:02. 45933: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 23:32:02.417782: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 23:32:02.417882: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 23:32:09.935905: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 23:32:09.936112: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 23:32:11.779599: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 23:32:11.779770: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 23:32:11.798656: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 23:32:11.798748: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 23:32:11.829013: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 23:32:11.842111: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 23:32:11.842941: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 23:32:11.853116: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 23:32:11.946754: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 23:32:11.949627: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 23:32:11.952186: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 23:32:11.954661: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 23:32:11.957133: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 23:32:13.560420: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 23:32:13.564518: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 23:32:13.564899: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 23:32:13.573230: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 23:32:13.573299: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 23:32:13.573344: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 23:32:13.573374: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 23:32:13.574044: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:32:13.574089: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:32:13.575008: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:32:13.575568: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:32:13.595311: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[[2022-12-11 23:32:132022-12-11 23:32:13..595415595388: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc::205202] ] worker 0 thread 3 initing device 31 solved

[2022-12-11 23:32:13.595479: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 23:32:13.596472: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 23:32:13.596556: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 23:32:13.597394: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:32:13.597466: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:32:13.597954: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:32:13.598028: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:32:13.599356: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:32:13.599426: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:32:13.[5995052022-12-11 23:32:13: .E599517 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 381.47 MB1980
] eager alloc mem 381.47 MB
[2022-12-11 23:32:13.601046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB[
2022-12-11 23:32:13.601069: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:32:13.602074: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:32:13.602704: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:32:13.670576: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:32:13.672411: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:32:13.672463: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:32:13.673228: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:32:13.673633: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:32:13.674577: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:32:13.674622: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.14 MB
[2022-12-11 23:32:13.692854: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:32:13.693452: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:32:13.693494: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[[[2022-12-11 23:32:132022-12-11 23:32:132022-12-11 23:32:13...700014700014700014: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes


[2022-12-11 23:32:13.[7019542022-12-11 23:32:13: .E701960 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 1021638
] eager release cuda mem 1021
[2022-12-11 23:32:13.702021[: 2022-12-11 23:32:13[E.2022-12-11 23:32:13 702027./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: 702026:E: 638 E] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc eager release cuda mem 400000000:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
638:] 638eager release cuda mem 400000000] 
eager release cuda mem 1021
[2022-12-11 23:32:13.702127: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:32:13.703004: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:32:13.703487: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:32:13.703982: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:32:13.704537: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:32:13.704638: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:32:13.704700: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:32:13.705490: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:32:13.705534: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.01 MB
[2022-12-11 23:32:13.705600: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:32:13.705646: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.14 MB
[2022-12-11 23:32:13.705672: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:32:13.705718: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.04 MB
[[2022-12-11 23:32:132022-12-11 23:32:13..724263724267: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 25.25 KBeager alloc mem 25.25 KB

[2022-12-11 23:32:13.724572: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[[2022-12-11 23:32:132022-12-11 23:32:13..724866724866: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 25855eager release cuda mem 25855

[2022-12-11 23:32:13[.2022-12-11 23:32:13724933.: 724936E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980eager alloc mem 4.76 GB] 
eager alloc mem 4.77 GB
[2022-12-11 23:32:13.725136: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:32:13.725177: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.76 GB
[[[[2022-12-11 23:32:142022-12-11 23:32:142022-12-11 23:32:142022-12-11 23:32:14....158246158244158242158243: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 1 init p2p of link 2Device 3 init p2p of link 0Device 2 init p2p of link 3Device 0 init p2p of link 1



[[[[2022-12-11 23:32:142022-12-11 23:32:142022-12-11 23:32:142022-12-11 23:32:14....158561158567158561158563: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1980198019801980] ] ] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KBeager alloc mem 611.00 KBeager alloc mem 611.00 KB



[[2022-12-11 23:32:14[2022-12-11 23:32:14[.2022-12-11 23:32:14.2022-12-11 23:32:14159504.159505.: 159506: 159510E: E:  E E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:638:] 638] 638eager release cuda mem 625663] eager release cuda mem 625663] 
eager release cuda mem 625663
eager release cuda mem 625663

[2022-12-11 23:32:14.164952: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 23:32:14.165041: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:32:14.165061: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 23:32:14.165155: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:32:14.165189: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 23:32:14.165258: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2[
2022-12-11 23:32:14.165296: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:32:14.165370: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:32:14.165836: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:32:14.165952: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:32:14.166100: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:32:14.166163: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:32:14.171481: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 23:32:14.171565: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:32:14.171694: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 23:32:14.171743: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1[
2022-12-11 23:32:14.171782: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 23:32:14eager alloc mem 611.00 KB.
171802: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3[
2022-12-11 23:32:14.171855: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:32:14.171916: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:32:14.172358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:32:14.172605: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:32:14.172665: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:32:14.172709: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:32:14.176953: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:32:14.177227: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9963984 / 100000000 nodes ( 9.96 %~10.00 %) | remote 27669126 / 100000000 nodes ( 27.67 %) | cpu 62366890 / 100000000 nodes ( 62.37 %) | 4.76 GB | 0.579786 secs 
[2022-12-11 23:32:14.177549: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:32:14.177818: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9998196 / 100000000 nodes ( 10.00 %~10.00 %) | remote 27634914 / 100000000 nodes ( 27.63 %) | cpu 62366890 / 100000000 nodes ( 62.37 %) | 4.77 GB | 0.579809 secs 
[2022-12-11 23:32:14.177940: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:32:14.178051: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:32:14.178268: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9999351 / 100000000 nodes ( 10.00 %~10.00 %) | remote 27633759 / 100000000 nodes ( 27.63 %) | cpu 62366890 / 100000000 nodes ( 62.37 %) | 4.77 GB | 0.604186 secs 
[2022-12-11 23:32:14.178441: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9971579 / 100000000 nodes ( 9.97 %~10.00 %) | remote 27661531 / 100000000 nodes ( 27.66 %) | cpu 62366890 / 100000000 nodes ( 62.37 %) | 4.76 GB | 0.579039 secs 
[2022-12-11 23:32:14.178707: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 9.80 GB
[2022-12-11 23:32:15.199530: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 10.05 GB
[2022-12-11 23:32:15.199784: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 10.05 GB
[2022-12-11 23:32:15.200210: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 10.05 GB
[2022-12-11 23:32:15.934457: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 10.29 GB
[2022-12-11 23:32:15.934697: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 10.29 GB
[2022-12-11 23:32:15.935049: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 10.29 GB
[2022-12-11 23:32:16.676900: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 10.54 GB
[2022-12-11 23:32:16.677022: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 10.54 GB
[2022-12-11 23:32:16.677345: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 10.54 GB
[2022-12-11 23:32:16.677596: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 10.54 GB
[2022-12-11 23:32:16.678438: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 10.54 GB
[2022-12-11 23:32:17.523076: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 10.73 GB
[2022-12-11 23:32:17.523222: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 10.73 GB
[HCTR][23:32:17.533][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][23:32:17.533][ERROR][RK0][tid #140191356417792]: replica 0 calling init per replica done, doing barrier
[HCTR][23:32:17.533][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][23:32:17.533][ERROR][RK0][tid #140191356417792]: replica 1 calling init per replica done, doing barrier
[HCTR][23:32:17.533][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][23:32:17.533][ERROR][RK0][tid #140191356417792]: replica 1 calling init per replica done, doing barrier done
[HCTR][23:32:17.533][ERROR][RK0][tid #140191356417792]: replica 0 calling init per replica done, doing barrier done
[HCTR][23:32:17.533][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][23:32:17.534][ERROR][RK0][main]: init per replica done
[HCTR][23:32:17.534][ERROR][RK0][main]: init per replica done
[HCTR][23:32:17.534][ERROR][RK0][tid #140191356417792]: init per replica done
[HCTR][23:32:17.536][ERROR][RK0][tid #140191356417792]: init per replica done
[HCTR][23:32:17.541][ERROR][RK0][tid #140191356417792]: 3 allocated 3276800 at 0x7f6ebf720000
[HCTR][23:32:17.541][ERROR][RK0][tid #140191356417792]: 3 allocated 6553600 at 0x7f6ec2800000
[HCTR][23:32:17.541][ERROR][RK0][tid #140191356417792]: 3 allocated 3276800 at 0x7f6ec2e40000
[HCTR][23:32:17.541][ERROR][RK0][tid #140191356417792]: 3 allocated 6553600 at 0x7f6ec3160000
[HCTR][23:32:17.542][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f6ebf720000
[HCTR][23:32:17.542][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f6ec2800000
[HCTR][23:32:17.542][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f6ec2e40000
[HCTR][23:32:17.542][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f6ec3160000
[HCTR][23:32:17.543][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f8257120000
[HCTR][23:32:17.543][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f8257600000
[HCTR][23:32:17.543][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f697e50e800
[HCTR][23:32:17.543][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f697e82e800
[HCTR][23:32:17.545][ERROR][RK0][tid #140191356417792]: 1 allocated 3276800 at 0x7f6ebf720000
[HCTR][23:32:17.545][ERROR][RK0][tid #140191356417792]: 1 allocated 6553600 at 0x7f6ec2800000
[HCTR][23:32:17.545][ERROR][RK0][tid #140191356417792]: 1 allocated 3276800 at 0x7f6ec2e40000
[HCTR][23:32:17.545][ERROR][RK0][tid #140191356417792]: 1 allocated 6553600 at 0x7f6ec3160000




