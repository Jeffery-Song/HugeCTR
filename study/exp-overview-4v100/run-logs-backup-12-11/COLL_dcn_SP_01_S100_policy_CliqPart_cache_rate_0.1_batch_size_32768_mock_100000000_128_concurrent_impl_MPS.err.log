2022-12-11 23:37:35.400499: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:37:35.472717: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:37:35.472772: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:37:35.475372: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:37:36.284597: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:37:36.284680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:37:36.297844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:37:36.329616: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:37:36.329796: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:37:36.331989: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 23:37:36.369799: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:37:36.369806: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:37:36.369881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:37:36.369881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:37:36.374005: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:37:36.374075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:37:36.382975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:37:36.384987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:37:36.389662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:37:36.415324: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:37:36.415514: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:37:36.416432: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:37:36.416563: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:37:36.417108: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 23:37:36.417974: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 23:37:36.420896: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:37:36.421025: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:37:36.422477: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][23:37:37.674][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:37:37.675][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:37:37.702][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:37:37.703][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.50s/it]warmup run: 105it [00:01, 91.20it/s]warmup run: 211it [00:01, 198.35it/s]warmup run: 317it [00:01, 315.75it/s]warmup run: 423it [00:01, 436.76it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 529it [00:01, 554.34it/s]warmup run: 101it [00:01, 90.78it/s]warmup run: 636it [00:02, 662.75it/s]warmup run: 203it [00:01, 196.65it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 744it [00:02, 759.08it/s]warmup run: 306it [00:01, 312.97it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 87it [00:01, 78.38it/s]warmup run: 851it [00:02, 836.42it/s]warmup run: 408it [00:01, 430.70it/s]warmup run: 105it [00:01, 93.83it/s]warmup run: 192it [00:01, 189.46it/s]warmup run: 958it [00:02, 896.26it/s]warmup run: 511it [00:01, 545.67it/s]warmup run: 210it [00:01, 202.24it/s]warmup run: 297it [00:01, 309.98it/s]warmup run: 1064it [00:02, 936.20it/s]warmup run: 614it [00:02, 649.43it/s]warmup run: 316it [00:01, 321.49it/s]warmup run: 402it [00:01, 432.95it/s]warmup run: 1172it [00:02, 973.98it/s]warmup run: 718it [00:02, 740.86it/s]warmup run: 421it [00:01, 442.35it/s]warmup run: 504it [00:01, 545.31it/s]warmup run: 1278it [00:02, 986.09it/s]warmup run: 822it [00:02, 815.81it/s]warmup run: 527it [00:01, 560.11it/s]warmup run: 613it [00:02, 661.60it/s]warmup run: 1385it [00:02, 1008.68it/s]warmup run: 926it [00:02, 873.60it/s]warmup run: 633it [00:02, 667.18it/s]warmup run: 717it [00:02, 749.94it/s]warmup run: 1490it [00:02, 1010.02it/s]warmup run: 1030it [00:02, 917.22it/s]warmup run: 735it [00:02, 748.90it/s]warmup run: 821it [00:02, 822.18it/s]warmup run: 1596it [00:03, 1023.72it/s]warmup run: 1141it [00:02, 968.99it/s]warmup run: 841it [00:02, 826.63it/s]warmup run: 926it [00:02, 882.15it/s]warmup run: 1705it [00:03, 1042.94it/s]warmup run: 1250it [00:02, 1002.38it/s]warmup run: 948it [00:02, 888.75it/s]warmup run: 1029it [00:02, 918.18it/s]warmup run: 1811it [00:03, 1047.74it/s]warmup run: 1363it [00:02, 1037.00it/s]warmup run: 1055it [00:02, 936.04it/s]warmup run: 1137it [00:02, 961.16it/s]warmup run: 1920it [00:03, 1057.99it/s]warmup run: 1471it [00:02, 1044.74it/s]warmup run: 1160it [00:02, 962.97it/s]warmup run: 1241it [00:02, 977.83it/s]warmup run: 2035it [00:03, 1084.59it/s]warmup run: 1579it [00:02, 1044.80it/s]warmup run: 1267it [00:02, 991.23it/s]warmup run: 1345it [00:02, 986.73it/s]warmup run: 2168it [00:03, 1155.79it/s]warmup run: 1686it [00:03, 1039.38it/s]warmup run: 1372it [00:02, 1000.01it/s]warmup run: 1453it [00:02, 1011.67it/s]warmup run: 2303it [00:03, 1213.36it/s]warmup run: 1792it [00:03, 1041.86it/s]warmup run: 1478it [00:02, 1015.58it/s]warmup run: 1557it [00:02, 998.39it/s] warmup run: 2434it [00:03, 1240.78it/s]warmup run: 1902it [00:03, 1056.16it/s]warmup run: 1583it [00:02, 1023.34it/s]warmup run: 2568it [00:03, 1269.86it/s]warmup run: 1659it [00:03, 986.54it/s]warmup run: 2012it [00:03, 1067.88it/s]warmup run: 1688it [00:03, 1018.43it/s]warmup run: 2702it [00:03, 1290.07it/s]warmup run: 1764it [00:03, 1003.00it/s]warmup run: 2147it [00:03, 1151.25it/s]warmup run: 1794it [00:03, 1028.50it/s]warmup run: 2835it [00:04, 1300.84it/s]warmup run: 1870it [00:03, 1019.21it/s]warmup run: 2282it [00:03, 1210.22it/s]warmup run: 1898it [00:03, 1026.15it/s]warmup run: 2969it [00:04, 1310.91it/s]warmup run: 1979it [00:03, 1038.07it/s]warmup run: 2418it [00:03, 1252.54it/s]warmup run: 3000it [00:04, 723.66it/s] warmup run: 2002it [00:03, 1018.55it/s]warmup run: 2108it [00:03, 1112.45it/s]warmup run: 2553it [00:03, 1281.48it/s]warmup run: 2135it [00:03, 1110.10it/s]warmup run: 2243it [00:03, 1181.60it/s]warmup run: 2689it [00:03, 1302.49it/s]warmup run: 2270it [00:03, 1178.56it/s]warmup run: 2378it [00:03, 1230.80it/s]warmup run: 2824it [00:03, 1314.64it/s]warmup run: 2405it [00:03, 1227.47it/s]warmup run: 2513it [00:03, 1265.62it/s]warmup run: 2959it [00:04, 1324.14it/s]warmup run: 2539it [00:03, 1260.72it/s]warmup run: 3000it [00:04, 731.65it/s] warmup run: 2644it [00:03, 1276.47it/s]warmup run: 2673it [00:03, 1284.07it/s]warmup run: 2779it [00:03, 1297.04it/s]warmup run: 2806it [00:03, 1297.47it/s]warmup run: 2915it [00:04, 1313.44it/s]warmup run: 2941it [00:04, 1312.80it/s]warmup run: 3000it [00:04, 724.95it/s] warmup run: 3000it [00:04, 727.08it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 179/3000 [00:00<00:01, 1784.01it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1713.71it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1744.76it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1713.11it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1796.11it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1753.54it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1772.20it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1743.75it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1763.34it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1758.33it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1769.20it/s]warmup should be done:  18%|█▊        | 540/3000 [00:00<00:01, 1779.05it/s]warmup should be done:  24%|██▎       | 708/3000 [00:00<00:01, 1775.93it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1765.55it/s]warmup should be done:  24%|██▎       | 711/3000 [00:00<00:01, 1773.37it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1785.72it/s]warmup should be done:  30%|██▉       | 885/3000 [00:00<00:01, 1772.59it/s]warmup should be done:  30%|██▉       | 888/3000 [00:00<00:01, 1781.86it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1779.03it/s]warmup should be done:  30%|██▉       | 899/3000 [00:00<00:01, 1778.64it/s]warmup should be done:  36%|███▌      | 1067/3000 [00:00<00:01, 1783.78it/s]warmup should be done:  36%|███▌      | 1069/3000 [00:00<00:01, 1781.66it/s]warmup should be done:  35%|███▌      | 1063/3000 [00:00<00:01, 1760.87it/s]warmup should be done:  36%|███▌      | 1078/3000 [00:00<00:01, 1779.53it/s]warmup should be done:  42%|████▏     | 1247/3000 [00:00<00:00, 1788.68it/s]warmup should be done:  42%|████▏     | 1249/3000 [00:00<00:00, 1786.49it/s]warmup should be done:  41%|████▏     | 1242/3000 [00:00<00:00, 1768.60it/s]warmup should be done:  42%|████▏     | 1257/3000 [00:00<00:00, 1782.12it/s]warmup should be done:  48%|████▊     | 1428/3000 [00:00<00:00, 1787.54it/s]warmup should be done:  48%|████▊     | 1426/3000 [00:00<00:00, 1780.42it/s]warmup should be done:  47%|████▋     | 1421/3000 [00:00<00:00, 1773.02it/s]warmup should be done:  48%|████▊     | 1436/3000 [00:00<00:00, 1783.04it/s]warmup should be done:  54%|█████▎    | 1609/3000 [00:00<00:00, 1791.45it/s]warmup should be done:  53%|█████▎    | 1600/3000 [00:00<00:00, 1776.51it/s]warmup should be done:  54%|█████▎    | 1605/3000 [00:00<00:00, 1771.46it/s]warmup should be done:  54%|█████▍    | 1615/3000 [00:00<00:00, 1782.50it/s]warmup should be done:  60%|█████▉    | 1789/3000 [00:01<00:00, 1792.99it/s]warmup should be done:  59%|█████▉    | 1778/3000 [00:01<00:00, 1777.54it/s]warmup should be done:  60%|█████▉    | 1794/3000 [00:01<00:00, 1782.20it/s]warmup should be done:  59%|█████▉    | 1783/3000 [00:01<00:00, 1770.35it/s]warmup should be done:  66%|██████▌   | 1969/3000 [00:01<00:00, 1792.67it/s]warmup should be done:  65%|██████▌   | 1957/3000 [00:01<00:00, 1778.61it/s]warmup should be done:  66%|██████▌   | 1973/3000 [00:01<00:00, 1784.18it/s]warmup should be done:  65%|██████▌   | 1962/3000 [00:01<00:00, 1773.38it/s]warmup should be done:  72%|███████▏  | 2150/3000 [00:01<00:00, 1796.20it/s]warmup should be done:  72%|███████▏  | 2154/3000 [00:01<00:00, 1791.11it/s]warmup should be done:  71%|███████   | 2135/3000 [00:01<00:00, 1773.75it/s]warmup should be done:  71%|███████▏  | 2140/3000 [00:01<00:00, 1773.80it/s]warmup should be done:  78%|███████▊  | 2333/3000 [00:01<00:00, 1803.65it/s]warmup should be done:  78%|███████▊  | 2335/3000 [00:01<00:00, 1795.43it/s]warmup should be done:  77%|███████▋  | 2318/3000 [00:01<00:00, 1775.34it/s]warmup should be done:  77%|███████▋  | 2313/3000 [00:01<00:00, 1764.35it/s]warmup should be done:  84%|████████▍ | 2516/3000 [00:01<00:00, 1808.82it/s]warmup should be done:  84%|████████▍ | 2518/3000 [00:01<00:00, 1804.11it/s]warmup should be done:  83%|████████▎ | 2496/3000 [00:01<00:00, 1772.36it/s]warmup should be done:  83%|████████▎ | 2490/3000 [00:01<00:00, 1761.18it/s]warmup should be done:  90%|████████▉ | 2699/3000 [00:01<00:00, 1814.55it/s]warmup should be done:  90%|█████████ | 2700/3000 [00:01<00:00, 1807.02it/s]warmup should be done:  89%|████████▉ | 2674/3000 [00:01<00:00, 1762.28it/s]warmup should be done:  89%|████████▉ | 2667/3000 [00:01<00:00, 1757.46it/s]warmup should be done:  96%|█████████▌| 2882/3000 [00:01<00:00, 1810.14it/s]warmup should be done:  96%|█████████▌| 2881/3000 [00:01<00:00, 1786.99it/s]warmup should be done:  95%|█████████▍| 2843/3000 [00:01<00:00, 1758.09it/s]warmup should be done:  95%|█████████▌| 2851/3000 [00:01<00:00, 1747.59it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1793.88it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1790.02it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1768.00it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1764.73it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1804.80it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1797.28it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1807.21it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1793.53it/s]warmup should be done:  12%|█▏        | 368/3000 [00:00<00:01, 1843.04it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1796.05it/s]warmup should be done:  12%|█▏        | 367/3000 [00:00<00:01, 1837.24it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1802.58it/s]warmup should be done:  18%|█▊        | 554/3000 [00:00<00:01, 1849.13it/s]warmup should be done:  18%|█▊        | 554/3000 [00:00<00:01, 1847.69it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1794.94it/s]warmup should be done:  18%|█▊        | 540/3000 [00:00<00:01, 1780.78it/s]warmup should be done:  25%|██▍       | 740/3000 [00:00<00:01, 1852.44it/s]warmup should be done:  25%|██▍       | 741/3000 [00:00<00:01, 1856.06it/s]warmup should be done:  24%|██▍       | 729/3000 [00:00<00:01, 1819.49it/s]warmup should be done:  24%|██▍       | 721/3000 [00:00<00:01, 1789.53it/s]warmup should be done:  31%|███       | 927/3000 [00:00<00:01, 1856.52it/s]warmup should be done:  31%|███       | 928/3000 [00:00<00:01, 1858.88it/s]warmup should be done:  31%|███       | 916/3000 [00:00<00:01, 1834.37it/s]warmup should be done:  30%|███       | 900/3000 [00:00<00:01, 1786.46it/s]warmup should be done:  37%|███▋      | 1115/3000 [00:00<00:01, 1862.02it/s]warmup should be done:  37%|███▋      | 1116/3000 [00:00<00:01, 1862.99it/s]warmup should be done:  37%|███▋      | 1103/3000 [00:00<00:01, 1843.34it/s]warmup should be done:  36%|███▌      | 1080/3000 [00:00<00:01, 1790.31it/s]warmup should be done:  43%|████▎     | 1302/3000 [00:00<00:00, 1861.78it/s]warmup should be done:  43%|████▎     | 1303/3000 [00:00<00:00, 1861.91it/s]warmup should be done:  43%|████▎     | 1288/3000 [00:00<00:00, 1845.12it/s]warmup should be done:  42%|████▏     | 1260/3000 [00:00<00:00, 1790.71it/s]warmup should be done:  50%|████▉     | 1489/3000 [00:00<00:00, 1864.01it/s]warmup should be done:  50%|████▉     | 1491/3000 [00:00<00:00, 1865.16it/s]warmup should be done:  49%|████▉     | 1475/3000 [00:00<00:00, 1852.04it/s]warmup should be done:  48%|████▊     | 1441/3000 [00:00<00:00, 1795.69it/s]warmup should be done:  56%|█████▌    | 1676/3000 [00:00<00:00, 1865.75it/s]warmup should be done:  56%|█████▌    | 1679/3000 [00:00<00:00, 1867.44it/s]warmup should be done:  55%|█████▌    | 1661/3000 [00:00<00:00, 1853.20it/s]warmup should be done:  54%|█████▍    | 1622/3000 [00:00<00:00, 1798.82it/s]warmup should be done:  62%|██████▏   | 1863/3000 [00:01<00:00, 1866.69it/s]warmup should be done:  62%|██████▏   | 1866/3000 [00:01<00:00, 1866.65it/s]warmup should be done:  62%|██████▏   | 1848/3000 [00:01<00:00, 1856.16it/s]warmup should be done:  60%|██████    | 1803/3000 [00:01<00:00, 1799.49it/s]warmup should be done:  68%|██████▊   | 2050/3000 [00:01<00:00, 1867.09it/s]warmup should be done:  68%|██████▊   | 2054/3000 [00:01<00:00, 1868.68it/s]warmup should be done:  68%|██████▊   | 2034/3000 [00:01<00:00, 1856.41it/s]warmup should be done:  66%|██████▌   | 1984/3000 [00:01<00:00, 1800.63it/s]warmup should be done:  75%|███████▍  | 2237/3000 [00:01<00:00, 1862.64it/s]warmup should be done:  75%|███████▍  | 2241/3000 [00:01<00:00, 1868.12it/s]warmup should be done:  74%|███████▍  | 2220/3000 [00:01<00:00, 1852.24it/s]warmup should be done:  72%|███████▏  | 2167/3000 [00:01<00:00, 1807.45it/s]warmup should be done:  81%|████████  | 2424/3000 [00:01<00:00, 1858.18it/s]warmup should be done:  81%|████████  | 2428/3000 [00:01<00:00, 1867.32it/s]warmup should be done:  80%|████████  | 2406/3000 [00:01<00:00, 1848.14it/s]warmup should be done:  78%|███████▊  | 2352/3000 [00:01<00:00, 1817.50it/s]warmup should be done:  87%|████████▋ | 2615/3000 [00:01<00:00, 1866.92it/s]warmup should be done:  87%|████████▋ | 2610/3000 [00:01<00:00, 1852.43it/s]warmup should be done:  85%|████████▍ | 2536/3000 [00:01<00:00, 1823.14it/s]warmup should be done:  86%|████████▋ | 2591/3000 [00:01<00:00, 1814.36it/s]warmup should be done:  93%|█████████▎| 2803/3000 [00:01<00:00, 1869.38it/s]warmup should be done:  91%|█████████ | 2722/3000 [00:01<00:00, 1833.97it/s]warmup should be done:  93%|█████████▎| 2796/3000 [00:01<00:00, 1842.28it/s]warmup should be done:  93%|█████████▎| 2777/3000 [00:01<00:00, 1827.84it/s]warmup should be done: 100%|█████████▉| 2990/3000 [00:01<00:00, 1867.99it/s]warmup should be done:  97%|█████████▋| 2906/3000 [00:01<00:00, 1830.47it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1862.61it/s]warmup should be done:  99%|█████████▉| 2964/3000 [00:01<00:00, 1838.90it/s]warmup should be done:  99%|█████████▉| 2981/3000 [00:01<00:00, 1812.88it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1846.67it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1830.70it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1808.89it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fcdf8c55160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fcdf8c550a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fcdf8f17e80>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fcdf8c55280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 23:38:41.583549: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fc9c926afe0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:38:41.583631: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:38:41.593640: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:38:41.610518: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fc9c926a030 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:38:41.610576: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:38:41.617641: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:38:42.607070: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:38:42.609109: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:38:42.644068: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fc9d5a64e00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:38:42.644128: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:38:42.651515: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fc9cd26af30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:38:42.651555: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:38:42.654288: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:38:42.658876: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:38:43.376019: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:38:43.383939: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:38:48.243758: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:38:48.486268: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:38:48.960235: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:38:49.547225: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][23:39:45.246][ERROR][RK0][tid #140505241327360]: replica 3 reaches 1000, calling init pre replica
[HCTR][23:39:45.246][ERROR][RK0][tid #140505241327360]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][23:39:45.250][ERROR][RK0][tid #140505241327360]: coll ps creation done
[HCTR][23:39:45.250][ERROR][RK0][tid #140505241327360]: replica 3 waits for coll ps creation barrier
[HCTR][23:39:45.278][ERROR][RK0][tid #140505241327360]: replica 0 reaches 1000, calling init pre replica
[HCTR][23:39:45.278][ERROR][RK0][tid #140505241327360]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][23:39:45.282][ERROR][RK0][tid #140505241327360]: coll ps creation done
[HCTR][23:39:45.282][ERROR][RK0][tid #140505241327360]: replica 0 waits for coll ps creation barrier
[HCTR][23:39:45.508][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][23:39:45.508][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][23:39:45.512][ERROR][RK0][main]: coll ps creation done
[HCTR][23:39:45.512][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][23:39:45.648][ERROR][RK0][tid #140505249720064]: replica 1 reaches 1000, calling init pre replica
[HCTR][23:39:45.648][ERROR][RK0][tid #140505249720064]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][23:39:45.652][ERROR][RK0][tid #140505249720064]: coll ps creation done
[HCTR][23:39:45.652][ERROR][RK0][tid #140505249720064]: replica 1 waits for coll ps creation barrier
[HCTR][23:39:45.652][ERROR][RK0][tid #140505241327360]: replica 0 preparing frequency
[HCTR][23:39:46.691][ERROR][RK0][tid #140505241327360]: replica 0 preparing frequency done
[HCTR][23:39:46.729][ERROR][RK0][tid #140505241327360]: replica 0 calling init per replica
[HCTR][23:39:46.729][ERROR][RK0][tid #140505241327360]: replica 3 calling init per replica
[HCTR][23:39:46.729][ERROR][RK0][tid #140505249720064]: replica 1 calling init per replica
[HCTR][23:39:46.729][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][23:39:46.729][ERROR][RK0][tid #140505241327360]: Calling build_v2
[HCTR][23:39:46.729][ERROR][RK0][tid #140505241327360]: Calling build_v2
[HCTR][23:39:46.729][ERROR][RK0][tid #140505249720064]: Calling build_v2
[HCTR][23:39:46.729][ERROR][RK0][tid #140505241327360]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:39:46.729][ERROR][RK0][main]: Calling build_v2
[HCTR][23:39:46.729][ERROR][RK0][tid #140505241327360]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:39:46.729][ERROR][RK0][tid #140505249720064]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:39:46.729][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[[2022-12-11 23:39:462022-12-11 23:39:46.2022-12-11 23:39:46.729677.7296792022-12-11 23:39:46: 729679: .E: E729686 E : /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: 136:136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] 136] :using concurrent impl MPS] using concurrent impl MPS136
using concurrent impl MPS
] 
using concurrent impl MPS
[2022-12-11 23:39:46.731016: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196[] 2022-12-11 23:39:46assigning 8 to cpu.
731039: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196[] 2022-12-11 23:39:46assigning 8 to cpu.[
7310652022-12-11 23:39:46: .E731070 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE[: 2022-12-11 23:39:46[196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.2022-12-11 23:39:46] :731095.assigning 8 to cpu212: 731107
] E: build symm link desc with 4X Tesla V100-SXM2-16GB out of 4 E
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc [[:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 23:39:462022-12-11 23:39:46196:..] 212731190731202assigning 8 to cpu] : : 
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4EE
  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::212213[] ] 2022-12-11 23:39:46build symm link desc with 4X Tesla V100-SXM2-16GB out of 4remote time is 8.68421.

731288[: 2022-12-11 23:39:46[[E.2022-12-11 23:39:462022-12-11 23:39:46 731295../hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 731318731321:E: : 213 EE] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc  remote time is 8.68421:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
212::] [214213build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 23:39:46] ] 
.cpu time is 30remote time is 8.68421731427

: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[2022-12-11 23:39:46:2022-12-11 23:39:46.214.731476] 731480: cpu time is 30: E
E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::213214] ] remote time is 8.68421cpu time is 30

[2022-12-11 23:39:46.731595: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 23:40:13.123485: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 23:40:13.188008: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 23:40:13.315672: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 23:40:13.315738: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 23:40:13.315771: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 23:40:13.315801: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 23:40:13.316593: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:40:13.316646: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:40:13.317560: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:40:13.318119: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-11 23:40:132022-12-11 23:40:13.[.338214338228: 2022-12-11 23:40:13: E.E 338249 /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc: /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:E:202 202] /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] 1 solved:2 solved
202
] 3 solved[
[2022-12-11 23:40:132022-12-11 23:40:13..[3383443383472022-12-11 23:40:13: : .EE338355  : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE:: 205205/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] ] :worker 0 thread 1 initing device 1worker 0 thread 2 initing device 2205

] worker 0 thread 3 initing device 3
[[2022-12-11 23:40:132022-12-11 23:40:13..338720338722: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::18151815] ] Building Coll Cache with ... num gpu device is 4Building Coll Cache with ... num gpu device is 4

[[2022-12-11 23:40:132022-12-11 23:40:13..338808338809: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 381.47 MB
eager alloc mem 381.47 MB
[2022-12-11 23:40:13.338904: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:40:13.338955: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:40:13.340556: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:40:13.340587: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:40:13.340637: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:40:13.342035: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:40:13.342068: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:40:13.342095: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:40:13.378128: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 23:40:13.380267: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 23:40:13.380359: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:40:13.381628: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:40:13.382522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:40:13.383599: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:40:13.383669: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.15 MB
[[[2022-12-11 23:40:132022-12-11 23:40:132022-12-11 23:40:13...437191437191437191: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes


[2022-12-11 23:40:13.439033: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 23:40:13[.[2022-12-11 23:40:134390712022-12-11 23:40:13.: .439074E439080:  : E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:] :638eager release cuda mem 5638] 
] eager release cuda mem 5eager release cuda mem 400000000

[2022-12-11 23:40:13.439162: [E2022-12-11 23:40:13 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc439171:: 638E]  eager release cuda mem 400000000/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 400000000
[2022-12-11 23:40:13.440038: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:40:13.440528: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:40:13.441012: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:40:13[.2022-12-11 23:40:13441643.: 441650E[:  2022-12-11 23:40:13E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu. :441663/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980: :] E1980eager alloc mem 611.00 KB ] 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB:
1980] eager alloc mem 611.00 KB
[[2022-12-11 23:40:13[2022-12-11 23:40:13.2022-12-11 23:40:13.442648.442650: 442656: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638:638] 638] eager release cuda mem 625663] eager release cuda mem 625663
eager release cuda mem 625663

[2022-12-11 23:40:13[[.2022-12-11 23:40:132022-12-11 23:40:13442742..: 442746442747W: :  WW/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc  :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc43::] 4343WORKER[0] alloc host memory 38.15 MB] ] 
WORKER[0] alloc host memory 38.15 MBWORKER[0] alloc host memory 38.15 MB

[2022-12-11 23:40:13.460075: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:40:13.460673: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:40:13.460718: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[[2022-12-11 23:40:132022-12-11 23:40:13..491123491132: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 25.25 KBeager alloc mem 25.25 KB

[2022-12-11 23:40:13[.2022-12-11 23:40:13491731.: 491737E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 25855] 
eager release cuda mem 25855
[2022-12-11 23:40:13[.2022-12-11 23:40:13491796.: 491799E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980eager alloc mem 4.77 GB] 
eager alloc mem 4.77 GB
[2022-12-11 23:40:13.492004: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:40:13.492578: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:40:13.492620: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[[[[2022-12-11 23:40:132022-12-11 23:40:132022-12-11 23:40:132022-12-11 23:40:13....955388955380955380955386: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 2 init p2p of link 3Device 1 init p2p of link 2Device 0 init p2p of link 1



[2022-12-11 23:40:13.955639[: 2022-12-11 23:40:13[E.2022-12-11 23:40:13 955645./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: 955653:E: 1980 [E] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 23:40:13 eager alloc mem 611.00 KB:./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
1980955677:] : 1980eager alloc mem 611.00 KBE] 
 eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-11 23:40:13.956498: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 23:40:13:.638956511] : eager release cuda mem 625663E
 [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 23:40:13[:.2022-12-11 23:40:13638956535.] : 956543eager release cuda mem 625663E: 
 E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-11 23:40:13.963911: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 23:40:13[.2022-12-11 23:40:13963991.: 964007E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1926:] [1980Device 0 init p2p of link 22022-12-11 23:40:13] 
.eager alloc mem 611.00 KB964033
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926[] 2022-12-11 23:40:13Device 1 init p2p of link 3.
964070: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 23:40:13.964122: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:40:13.964158: E[ 2022-12-11 23:40:13/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:9641691980: ] Eeager alloc mem 611.00 KB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:40:13.964841: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:40:13.964927: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:40:13.964976: [E2022-12-11 23:40:13 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc964987:: 638E]  eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-11 23:40:13.972764: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 23:40:13.972845: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:40:13.973046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 23:40:13.973140: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 23:40:13:.1980973147] : eager alloc mem 611.00 KBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 23:40:13.973206: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 23:40:13.973256: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:40:13.973308: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:40:13.973640: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:40:13.973951: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:40:13.974052: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:40:13.974109: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:40:13.980378: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:40:13.980652: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 10000000 / 100000000 nodes ( 10.00 %~10.00 %) | remote 30000000 / 100000000 nodes ( 30.00 %) | cpu 60000000 / 100000000 nodes ( 60.00 %) | 4.77 GB | 0.641859 secs 
[2022-12-11 23:40:13.980845: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:40:13.981020: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:40:13.981079: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:40:13.981127: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 10000000 / 100000000 nodes ( 10.00 %~10.00 %) | remote 30000000 / 100000000 nodes ( 30.00 %) | cpu 60000000 / 100000000 nodes ( 60.00 %) | 4.77 GB | 0.664497 secs 
[2022-12-11 23:40:13.981389: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 10000000 / 100000000 nodes ( 10.00 %~10.00 %) | remote 30000000 / 100000000 nodes ( 30.00 %) | cpu 60000000 / 100000000 nodes ( 60.00 %) | 4.77 GB | 0.642595 secs 
[2022-12-11 23:40:13.981488: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 10000000 / 100000000 nodes ( 10.00 %~10.00 %) | remote 30000000 / 100000000 nodes ( 30.00 %) | cpu 60000000 / 100000000 nodes ( 60.00 %) | 4.77 GB | 0.642549 secs 
[2022-12-11 23:40:13.981997: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.47 GB
[2022-12-11 23:40:14.930772: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.72 GB
[2022-12-11 23:40:14.931247: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.72 GB
[2022-12-11 23:40:14.931655: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.72 GB
[2022-12-11 23:40:15.749563: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.96 GB
[2022-12-11 23:40:15.749728: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.96 GB
[2022-12-11 23:40:15.750174: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.96 GB
[2022-12-11 23:40:16.621073: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.21 GB
[2022-12-11 23:40:16.621198: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.21 GB
[2022-12-11 23:40:16.621543: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.21 GB
[2022-12-11 23:40:17.539386: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.62 GB
[2022-12-11 23:40:17.539584: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.62 GB
[2022-12-11 23:40:17.539931: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.62 GB
[2022-12-11 23:40:18.231257: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.81 GB
[2022-12-11 23:40:18.231378: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.81 GB
[HCTR][23:40:18.395][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][23:40:18.395][ERROR][RK0][tid #140505241327360]: replica 3 calling init per replica done, doing barrier
[HCTR][23:40:18.395][ERROR][RK0][tid #140505241327360]: replica 0 calling init per replica done, doing barrier
[HCTR][23:40:18.395][ERROR][RK0][tid #140505249720064]: replica 1 calling init per replica done, doing barrier
[HCTR][23:40:18.395][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][23:40:18.395][ERROR][RK0][tid #140505241327360]: replica 3 calling init per replica done, doing barrier done
[HCTR][23:40:18.395][ERROR][RK0][tid #140505249720064]: replica 1 calling init per replica done, doing barrier done
[HCTR][23:40:18.395][ERROR][RK0][tid #140505241327360]: replica 0 calling init per replica done, doing barrier done
[HCTR][23:40:18.395][ERROR][RK0][main]: init per replica done
[HCTR][23:40:18.395][ERROR][RK0][tid #140505241327360]: init per replica done
[HCTR][23:40:18.395][ERROR][RK0][tid #140505249720064]: init per replica done
[HCTR][23:40:18.399][ERROR][RK0][tid #140505241327360]: init per replica done
[HCTR][23:40:18.429][ERROR][RK0][tid #140505241327360]: 2 allocated 3276800 at 0x7faf58238400
[HCTR][23:40:18.429][ERROR][RK0][tid #140505241327360]: 2 allocated 6553600 at 0x7faf58558400
[HCTR][23:40:18.429][ERROR][RK0][tid #140505241327360]: 2 allocated 3276800 at 0x7faf58b98400
[HCTR][23:40:18.429][ERROR][RK0][tid #140505241327360]: 2 allocated 6553600 at 0x7faf58eb8400
[HCTR][23:40:18.429][ERROR][RK0][tid #140505249720064]: 1 allocated 3276800 at 0x7fafd2238400
[HCTR][23:40:18.429][ERROR][RK0][tid #140505249720064]: 1 allocated 6553600 at 0x7fafd2558400
[HCTR][23:40:18.429][ERROR][RK0][tid #140505249720064]: 1 allocated 3276800 at 0x7fafd2b98400
[HCTR][23:40:18.429][ERROR][RK0][tid #140505249720064]: 1 allocated 6553600 at 0x7fafd2eb8400
[HCTR][23:40:18.430][ERROR][RK0][tid #140505241327360]: 3 allocated 3276800 at 0x7faed4238400
[HCTR][23:40:18.430][ERROR][RK0][tid #140505241327360]: 3 allocated 6553600 at 0x7faed4558400
[HCTR][23:40:18.430][ERROR][RK0][tid #140505241327360]: 3 allocated 3276800 at 0x7faed4b98400
[HCTR][23:40:18.430][ERROR][RK0][tid #140505241327360]: 3 allocated 6553600 at 0x7faed4eb8400
[HCTR][23:40:18.434][ERROR][RK0][tid #140505241327360]: 0 allocated 3276800 at 0x7faf9c320000
[HCTR][23:40:18.434][ERROR][RK0][tid #140505241327360]: 0 allocated 6553600 at 0x7faf9c640000
[HCTR][23:40:18.434][ERROR][RK0][tid #140505241327360]: 0 allocated 3276800 at 0x7faf9cc80000
[HCTR][23:40:18.434][ERROR][RK0][tid #140505241327360]: 0 allocated 6553600 at 0x7faf9cfa0000
