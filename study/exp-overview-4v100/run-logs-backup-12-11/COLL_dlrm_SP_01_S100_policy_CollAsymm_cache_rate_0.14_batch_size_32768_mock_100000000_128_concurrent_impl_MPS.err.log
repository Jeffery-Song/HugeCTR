2022-12-12 01:01:40.837424: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:01:40.903225: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:01:40.903523: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:01:40.905894: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:01:41.716979: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:01:41.717061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:01:41.730561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:01:41.761268: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:01:41.761442: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:01:41.763363: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 01:01:41.792936: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:01:41.793016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:01:41.805784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:01:41.808877: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:01:41.808933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:01:41.808998: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:01:41.809060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:01:41.823193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:01:41.823278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:01:41.836046: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:01:41.836210: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:01:41.837612: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 01:01:41.854420: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:01:41.854430: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:01:41.854630: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:01:41.854632: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:01:41.856290: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 01:01:41.856331: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][01:01:43.086][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:01:43.107][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:01:43.114][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:01:43.133][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.46s/it]warmup run: 99it [00:01, 87.98it/s]warmup run: 198it [00:01, 189.74it/s]warmup run: 299it [00:01, 303.30it/s]warmup run: 398it [00:01, 416.82it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 1it [00:01,  1.42s/it]warmup run: 499it [00:01, 529.74it/s]warmup run: 111it [00:01, 99.95it/s]warmup run: 112it [00:01, 101.86it/s]warmup run: 606it [00:02, 643.46it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 222it [00:01, 215.26it/s]warmup run: 220it [00:01, 214.55it/s]warmup run: 713it [00:02, 743.04it/s]warmup run: 103it [00:01, 90.57it/s]warmup run: 331it [00:01, 337.63it/s]warmup run: 327it [00:01, 335.07it/s]warmup run: 822it [00:02, 828.29it/s]warmup run: 208it [00:01, 197.71it/s]warmup run: 439it [00:01, 460.94it/s]warmup run: 435it [00:01, 459.50it/s]warmup run: 931it [00:02, 895.11it/s]warmup run: 314it [00:01, 316.17it/s]warmup run: 548it [00:01, 580.74it/s]warmup run: 543it [00:01, 578.96it/s]warmup run: 1039it [00:02, 944.37it/s]warmup run: 420it [00:01, 437.68it/s]warmup run: 657it [00:02, 689.69it/s]warmup run: 652it [00:02, 688.62it/s]warmup run: 1146it [00:02, 978.89it/s]warmup run: 526it [00:01, 555.41it/s]warmup run: 766it [00:02, 783.03it/s]warmup run: 761it [00:02, 782.30it/s]warmup run: 1252it [00:02, 985.48it/s]warmup run: 634it [00:02, 666.23it/s]warmup run: 875it [00:02, 858.76it/s]warmup run: 870it [00:02, 858.06it/s]warmup run: 1357it [00:02, 987.82it/s]warmup run: 739it [00:02, 755.17it/s]warmup run: 984it [00:02, 918.18it/s]warmup run: 978it [00:02, 915.40it/s]warmup run: 1460it [00:02, 990.31it/s]warmup run: 848it [00:02, 837.18it/s]warmup run: 1093it [00:02, 963.01it/s]warmup run: 1086it [00:02, 959.05it/s]warmup run: 1562it [00:02, 988.59it/s]warmup run: 955it [00:02, 897.80it/s]warmup run: 1201it [00:02, 992.49it/s]warmup run: 1195it [00:02, 994.57it/s]warmup run: 1663it [00:03, 988.70it/s]warmup run: 1061it [00:02, 940.42it/s]warmup run: 1309it [00:02, 1002.35it/s]warmup run: 1303it [00:02, 994.78it/s]warmup run: 1764it [00:03, 988.33it/s]warmup run: 1168it [00:02, 974.57it/s]warmup run: 1418it [00:02, 1026.92it/s]warmup run: 1408it [00:02, 988.12it/s]warmup run: 1866it [00:03, 996.60it/s]warmup run: 1275it [00:02, 999.90it/s]warmup run: 1528it [00:02, 1046.15it/s]warmup run: 1516it [00:02, 1013.48it/s]warmup run: 1970it [00:03, 1009.15it/s]warmup run: 1383it [00:02, 1020.79it/s]warmup run: 1636it [00:02, 1052.05it/s]warmup run: 1624it [00:02, 1031.79it/s]warmup run: 2092it [00:03, 1070.25it/s]warmup run: 1492it [00:02, 1039.98it/s]warmup run: 1744it [00:03, 1058.01it/s]warmup run: 1732it [00:03, 1045.63it/s]warmup run: 2222it [00:03, 1138.35it/s]warmup run: 1603it [00:02, 1059.93it/s]warmup run: 1852it [00:03, 1058.68it/s]warmup run: 1839it [00:03, 1050.31it/s]warmup run: 2351it [00:03, 1183.09it/s]warmup run: 1716it [00:03, 1079.13it/s]warmup run: 1959it [00:03, 1061.25it/s]warmup run: 1946it [00:03, 1055.31it/s]warmup run: 2476it [00:03, 1200.55it/s]warmup run: 1826it [00:03, 1064.37it/s]warmup run: 2080it [00:03, 1103.60it/s]warmup run: 2064it [00:03, 1090.57it/s]warmup run: 2609it [00:03, 1238.71it/s]warmup run: 1934it [00:03, 1063.65it/s]warmup run: 2210it [00:03, 1160.80it/s]warmup run: 2198it [00:03, 1163.41it/s]warmup run: 2743it [00:03, 1268.42it/s]warmup run: 2042it [00:03, 1060.80it/s]warmup run: 2334it [00:03, 1182.18it/s]warmup run: 2331it [00:03, 1210.72it/s]warmup run: 2880it [00:04, 1297.53it/s]warmup run: 2152it [00:03, 1071.97it/s]warmup run: 2455it [00:03, 1187.94it/s]warmup run: 2466it [00:03, 1249.99it/s]warmup run: 3000it [00:04, 716.55it/s] warmup run: 2260it [00:03, 1071.30it/s]warmup run: 2581it [00:03, 1207.32it/s]warmup run: 2598it [00:03, 1269.99it/s]warmup run: 2368it [00:03, 1050.87it/s]warmup run: 2705it [00:03, 1214.58it/s]warmup run: 2731it [00:03, 1287.72it/s]warmup run: 2476it [00:03, 1057.28it/s]warmup run: 2827it [00:03, 1187.02it/s]warmup run: 2865it [00:03, 1301.12it/s]warmup run: 2583it [00:03, 1059.40it/s]warmup run: 2949it [00:04, 1196.62it/s]warmup run: 3000it [00:04, 728.86it/s] warmup run: 3000it [00:04, 1313.52it/s]warmup run: 3000it [00:04, 739.19it/s] warmup run: 2690it [00:04, 1061.84it/s]warmup run: 2797it [00:04, 1053.98it/s]warmup run: 2903it [00:04, 1053.43it/s]warmup run: 3000it [00:04, 695.64it/s] 

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1775.23it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1658.94it/s]warmup should be done:   5%|▌         | 157/3000 [00:00<00:01, 1562.17it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1682.60it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1788.79it/s]warmup should be done:  12%|█▏        | 345/3000 [00:00<00:01, 1733.24it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1748.73it/s]warmup should be done:  11%|█▏        | 339/3000 [00:00<00:01, 1707.81it/s]warmup should be done:  17%|█▋        | 523/3000 [00:00<00:01, 1753.60it/s]warmup should be done:  17%|█▋        | 518/3000 [00:00<00:01, 1742.94it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1758.53it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1773.97it/s]warmup should be done:  23%|██▎       | 703/3000 [00:00<00:01, 1769.87it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1767.89it/s]warmup should be done:  24%|██▍       | 715/3000 [00:00<00:01, 1767.89it/s]warmup should be done:  23%|██▎       | 693/3000 [00:00<00:01, 1609.92it/s]warmup should be done:  29%|██▉       | 882/3000 [00:00<00:01, 1773.77it/s]warmup should be done:  29%|██▉       | 883/3000 [00:00<00:01, 1762.36it/s]warmup should be done:  30%|██▉       | 892/3000 [00:00<00:01, 1761.26it/s]warmup should be done:  29%|██▉       | 870/3000 [00:00<00:01, 1664.13it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1752.89it/s]warmup should be done:  36%|███▌      | 1069/3000 [00:00<00:01, 1756.52it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1733.32it/s]warmup should be done:  35%|███▍      | 1043/3000 [00:00<00:01, 1685.35it/s]warmup should be done:  41%|████      | 1236/3000 [00:00<00:01, 1745.12it/s]warmup should be done:  42%|████▏     | 1245/3000 [00:00<00:01, 1739.29it/s]warmup should be done:  41%|████      | 1234/3000 [00:00<00:01, 1674.54it/s]warmup should be done:  40%|████      | 1213/3000 [00:00<00:01, 1612.59it/s]warmup should be done:  47%|████▋     | 1419/3000 [00:00<00:00, 1731.24it/s]warmup should be done:  47%|████▋     | 1411/3000 [00:00<00:00, 1715.59it/s]warmup should be done:  47%|████▋     | 1402/3000 [00:00<00:00, 1652.52it/s]warmup should be done:  46%|████▋     | 1388/3000 [00:00<00:00, 1653.78it/s]warmup should be done:  53%|█████▎    | 1594/3000 [00:00<00:00, 1736.02it/s]warmup should be done:  53%|█████▎    | 1588/3000 [00:00<00:00, 1729.73it/s]warmup should be done:  52%|█████▏    | 1568/3000 [00:00<00:00, 1640.46it/s]warmup should be done:  52%|█████▏    | 1564/3000 [00:00<00:00, 1684.25it/s]warmup should be done:  59%|█████▉    | 1770/3000 [00:01<00:00, 1740.73it/s]warmup should be done:  59%|█████▉    | 1767/3000 [00:01<00:00, 1746.16it/s]warmup should be done:  58%|█████▊    | 1733/3000 [00:01<00:00, 1642.31it/s]warmup should be done:  58%|█████▊    | 1741/3000 [00:01<00:00, 1709.58it/s]warmup should be done:  65%|██████▍   | 1945/3000 [00:01<00:00, 1740.18it/s]warmup should be done:  65%|██████▍   | 1948/3000 [00:01<00:00, 1762.62it/s]warmup should be done:  63%|██████▎   | 1901/3000 [00:01<00:00, 1653.13it/s]warmup should be done:  64%|██████▍   | 1917/3000 [00:01<00:00, 1722.50it/s]warmup should be done:  71%|███████   | 2121/3000 [00:01<00:00, 1744.01it/s]warmup should be done:  71%|███████   | 2128/3000 [00:01<00:00, 1771.01it/s]warmup should be done:  69%|██████▉   | 2077/3000 [00:01<00:00, 1682.58it/s]warmup should be done:  70%|██████▉   | 2095/3000 [00:01<00:00, 1738.12it/s]warmup should be done:  77%|███████▋  | 2296/3000 [00:01<00:00, 1745.53it/s]warmup should be done:  77%|███████▋  | 2308/3000 [00:01<00:00, 1776.99it/s]warmup should be done:  75%|███████▌  | 2255/3000 [00:01<00:00, 1709.25it/s]warmup should be done:  76%|███████▌  | 2273/3000 [00:01<00:00, 1748.88it/s]warmup should be done:  82%|████████▏ | 2474/3000 [00:01<00:00, 1752.74it/s]warmup should be done:  83%|████████▎ | 2490/3000 [00:01<00:00, 1787.96it/s]warmup should be done:  81%|████████  | 2434/3000 [00:01<00:00, 1733.09it/s]warmup should be done:  82%|████████▏ | 2452/3000 [00:01<00:00, 1758.43it/s]warmup should be done:  89%|████████▊ | 2656/3000 [00:01<00:00, 1770.10it/s]warmup should be done:  89%|████████▉ | 2671/3000 [00:01<00:00, 1792.60it/s]warmup should be done:  87%|████████▋ | 2613/3000 [00:01<00:00, 1749.20it/s]warmup should be done:  88%|████████▊ | 2631/3000 [00:01<00:00, 1766.09it/s]warmup should be done:  94%|█████████▍| 2835/3000 [00:01<00:00, 1773.19it/s]warmup should be done:  95%|█████████▌| 2851/3000 [00:01<00:00, 1793.68it/s]warmup should be done:  93%|█████████▎| 2792/3000 [00:01<00:00, 1760.59it/s]warmup should be done:  94%|█████████▎| 2808/3000 [00:01<00:00, 1709.31it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1766.30it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1758.15it/s]warmup should be done:  99%|█████████▉| 2971/3000 [00:01<00:00, 1767.60it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1718.31it/s]warmup should be done:  99%|█████████▉| 2983/3000 [00:01<00:00, 1718.78it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1702.27it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1728.23it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1774.13it/s]warmup should be done:   5%|▌         | 154/3000 [00:00<00:01, 1532.33it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1730.75it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1782.67it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1796.21it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1797.48it/s]warmup should be done:  11%|█▏        | 339/3000 [00:00<00:01, 1714.86it/s]warmup should be done:  18%|█▊        | 542/3000 [00:00<00:01, 1815.21it/s]warmup should be done:  18%|█▊        | 545/3000 [00:00<00:01, 1825.54it/s]warmup should be done:  17%|█▋        | 524/3000 [00:00<00:01, 1775.57it/s]warmup should be done:  18%|█▊        | 536/3000 [00:00<00:01, 1706.79it/s]warmup should be done:  24%|██▍       | 726/3000 [00:00<00:01, 1821.94it/s]warmup should be done:  24%|██▎       | 709/3000 [00:00<00:01, 1804.19it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1727.90it/s]warmup should be done:  24%|██▍       | 728/3000 [00:00<00:01, 1702.26it/s]warmup should be done:  30%|███       | 910/3000 [00:00<00:01, 1827.84it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1791.60it/s]warmup should be done:  30%|██▉       | 892/3000 [00:00<00:01, 1747.33it/s]warmup should be done:  31%|███       | 918/3000 [00:00<00:01, 1769.55it/s]warmup should be done:  36%|███▋      | 1095/3000 [00:00<00:01, 1833.50it/s]warmup should be done:  36%|███▌      | 1076/3000 [00:00<00:01, 1812.31it/s]warmup should be done:  36%|███▌      | 1071/3000 [00:00<00:01, 1760.95it/s]warmup should be done:  37%|███▋      | 1109/3000 [00:00<00:01, 1812.94it/s]warmup should be done:  43%|████▎     | 1280/3000 [00:00<00:00, 1837.14it/s]warmup should be done:  42%|████▏     | 1261/3000 [00:00<00:00, 1821.80it/s]warmup should be done:  42%|████▏     | 1249/3000 [00:00<00:00, 1764.39it/s]warmup should be done:  43%|████▎     | 1298/3000 [00:00<00:00, 1834.56it/s]warmup should be done:  49%|████▉     | 1467/3000 [00:00<00:00, 1846.01it/s]warmup should be done:  48%|████▊     | 1447/3000 [00:00<00:00, 1832.13it/s]warmup should be done:  48%|████▊     | 1427/3000 [00:00<00:00, 1768.57it/s]warmup should be done:  49%|████▉     | 1483/3000 [00:00<00:00, 1833.09it/s]warmup should be done:  55%|█████▌    | 1653/3000 [00:00<00:00, 1849.81it/s]warmup should be done:  54%|█████▍    | 1632/3000 [00:00<00:00, 1835.57it/s]warmup should be done:  54%|█████▎    | 1607/3000 [00:00<00:00, 1776.58it/s]warmup should be done:  56%|█████▌    | 1667/3000 [00:00<00:00, 1830.03it/s]warmup should be done:  61%|██████▏   | 1838/3000 [00:01<00:00, 1829.06it/s]warmup should be done:  60%|█████▉    | 1786/3000 [00:01<00:00, 1780.07it/s]warmup should be done:  61%|██████    | 1816/3000 [00:01<00:00, 1792.28it/s]warmup should be done:  62%|██████▏   | 1851/3000 [00:01<00:00, 1827.89it/s]warmup should be done:  68%|██████▊   | 2025/3000 [00:01<00:00, 1841.09it/s]warmup should be done:  66%|██████▌   | 1966/3000 [00:01<00:00, 1783.45it/s]warmup should be done:  67%|██████▋   | 1996/3000 [00:01<00:00, 1776.55it/s]warmup should be done:  68%|██████▊   | 2034/3000 [00:01<00:00, 1825.52it/s]warmup should be done:  74%|███████▎  | 2211/3000 [00:01<00:00, 1846.57it/s]warmup should be done:  72%|███████▏  | 2145/3000 [00:01<00:00, 1779.67it/s]warmup should be done:  73%|███████▎  | 2179/3000 [00:01<00:00, 1791.57it/s]warmup should be done:  74%|███████▍  | 2217/3000 [00:01<00:00, 1822.67it/s]warmup should be done:  80%|███████▉  | 2396/3000 [00:01<00:00, 1841.83it/s]warmup should be done:  77%|███████▋  | 2323/3000 [00:01<00:00, 1766.54it/s]warmup should be done:  79%|███████▊  | 2360/3000 [00:01<00:00, 1795.36it/s]warmup should be done:  80%|████████  | 2400/3000 [00:01<00:00, 1820.99it/s]warmup should be done:  86%|████████▌ | 2583/3000 [00:01<00:00, 1848.60it/s]warmup should be done:  83%|████████▎ | 2501/3000 [00:01<00:00, 1768.46it/s]warmup should be done:  85%|████████▍ | 2541/3000 [00:01<00:00, 1798.33it/s]warmup should be done:  86%|████████▌ | 2583/3000 [00:01<00:00, 1821.99it/s]warmup should be done:  92%|█████████▏| 2768/3000 [00:01<00:00, 1827.93it/s]warmup should be done:  91%|█████████ | 2723/3000 [00:01<00:00, 1803.48it/s]warmup should be done:  89%|████████▉ | 2678/3000 [00:01<00:00, 1729.52it/s]warmup should be done:  92%|█████████▏| 2766/3000 [00:01<00:00, 1819.09it/s]warmup should be done:  98%|█████████▊| 2954/3000 [00:01<00:00, 1837.16it/s]warmup should be done:  97%|█████████▋| 2904/3000 [00:01<00:00, 1798.07it/s]warmup should be done:  95%|█████████▌| 2855/3000 [00:01<00:00, 1740.25it/s]warmup should be done:  98%|█████████▊| 2948/3000 [00:01<00:00, 1817.30it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1831.92it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1806.96it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1794.10it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1758.02it/s]2022-12-12 01:02:57.680811: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1d66267610 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:02:57.680876: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:02:57.718107: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1d66267810 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:02:57.718163: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:02:59.325226: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:03:00.166646: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:03:00.431334: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:03:01.285114: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:03:01.890946: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:03:02.695883: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:03:06.937307: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1d5a26b650 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:03:06.937373: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:03:09.224986: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:03:09.294612: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1d66264590 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:03:09.294672: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:03:10.332549: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:03:11.167503: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:03:11.742858: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:03:12.348932: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:03:13.829665: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][01:03:41.789][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][01:03:41.789][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:03:41.795][ERROR][RK0][main]: coll ps creation done
[HCTR][01:03:41.795][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][01:03:42.039][ERROR][RK0][tid #139764510471936]: replica 0 reaches 1000, calling init pre replica
[HCTR][01:03:42.040][ERROR][RK0][tid #139764510471936]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:03:42.046][ERROR][RK0][tid #139764510471936]: coll ps creation done
[HCTR][01:03:42.046][ERROR][RK0][tid #139764510471936]: replica 0 waits for coll ps creation barrier
[HCTR][01:03:42.347][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][01:03:42.347][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:03:42.352][ERROR][RK0][main]: coll ps creation done
[HCTR][01:03:42.352][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][01:03:42.557][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][01:03:42.557][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:03:42.561][ERROR][RK0][main]: coll ps creation done
[HCTR][01:03:42.561][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][01:03:42.561][ERROR][RK0][tid #139764510471936]: replica 0 preparing frequency
[HCTR][01:03:43.806][ERROR][RK0][tid #139764510471936]: replica 0 preparing frequency done
[HCTR][01:03:43.840][ERROR][RK0][tid #139764510471936]: replica 0 calling init per replica
[HCTR][01:03:43.840][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][01:03:43.840][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][01:03:43.840][ERROR][RK0][tid #139764510471936]: Calling build_v2
[HCTR][01:03:43.840][ERROR][RK0][main]: Calling build_v2
[HCTR][01:03:43.840][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][01:03:43.840][ERROR][RK0][tid #139764510471936]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:03:43.840][ERROR][RK0][main]: Calling build_v2
[HCTR][01:03:43.840][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:03:43.840][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:03:43.840][ERROR][RK0][main]: Calling build_v2
[HCTR][01:03:43.840][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-12 01:03:432022-12-12 01:03:43..2022-12-12 01:03:43840714840714.: : 840720EE:   E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136136:] ] 136using concurrent impl MPSusing concurrent impl MPS] 

using concurrent impl MPS
[2022-12-12 01:03:43.840801: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-12 01:03:43.841906: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-12 01:03:43.841963: E[ 2022-12-12 01:03:43/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:[8419721962022-12-12 01:03:43: ] .Eassigning 8 to cpu841986 
: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE[: 2022-12-12 01:03:43212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[.] :2022-12-12 01:03:43842014build symm link desc with 4X Tesla V100-SXM2-16GB out of 4196.: 
] 842039Eassigning 8 to cpu:  
E[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 2022-12-12 01:03:43:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.196:842097[] 212: 2022-12-12 01:03:43assigning 8 to cpu] E.
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4 842126
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E213 ] [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.684212022-12-12 01:03:43:
.212842193] [: build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-12 01:03:43E[
. 2022-12-12 01:03:43842214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.[: :8422012022-12-12 01:03:43E213: . ] E842244/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421 : :
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE214:[ ] 2122022-12-12 01:03:43/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30] .:
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4842320213
: ] Eremote time is 8.68421 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:[2022-12-12 01:03:432142022-12-12 01:03:43.] .842388cpu time is 30842393: 
: EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::213214] ] remote time is 8.68421cpu time is 30

[2022-12-12 01:03:43.842520: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 01:04:09.142075: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 01:04:09.212256: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 01:04:09.212369: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 01:04:09.213637: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 01:04:09.358542: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 01:04:09.749592: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 01:04:09.749720: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 01:04:16.936502: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 01:04:16.936631: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 01:04:18.712686: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 01:04:18.712910: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 01:04:18.759903: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 01:04:18.759996: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 01:04:21.435975: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 01:04:21.454918: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 01:04:21.455734: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 01:04:21.466146: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 01:04:21.565792: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 01:04:24.481053: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 01:04:24.485237: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 01:04:24.485381: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 01:04:24.495274: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 01:04:24.495354: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 01:04:24.495388: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 01:04:24.495419: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 01:04:24.496441: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:04:24.496516: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:04:24.497461: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:04:24.498006: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:04:24.517963: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 01:04:24.518079: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 01:04:24.518127: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-12 01:04:24.518223: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-12 01:04:24.518915: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:04:24.518959: E[ 2022-12-12 01:04:24/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:5189731815: ] EBuilding Coll Cache with ... num gpu device is 4 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:04:24.519034: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:04:24.519907: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-12 01:04:24.520006: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-12 01:04:24.520380: [E2022-12-12 01:04:24 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu520398:: 1980E]  eager alloc mem 381.47 MB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 381.47 MB
[2022-12-12 01:04:24.520709: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:04:24.520777: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:04:24.521991: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-12 01:04:24] .eager alloc mem 381.47 MB522020
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:04:24.522183: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:04:24.523694: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:04:24.556468: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 01:04:24.558476: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 01:04:24.558546: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:04:24.559565: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:04:24.560272: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:04:24.561273: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:04:24.561322: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.38 MB
[[2022-12-12 01:04:242022-12-12 01:04:24..598603598604: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[[2022-12-12 01:04:242022-12-12 01:04:24..600456600456: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 1021eager release cuda mem 1021

[[2022-12-12 01:04:242022-12-12 01:04:24..600542600543: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 400000000eager release cuda mem 400000000

[2022-12-12 01:04:24.601412: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:04:24.601894: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:04:24.602409: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB[
2022-12-12 01:04:24.602434: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:04:24[.2022-12-12 01:04:24603402.: 603407E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-12 01:04:24.[6034702022-12-12 01:04:24: .W603475 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.ccW: 43/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc] :WORKER[0] alloc host memory 53.35 MB43
] WORKER[0] alloc host memory 53.39 MB
[2022-12-12 01:04:24.618512: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:04:24.619125: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:04:24.619169: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[2022-12-12 01:04:24.633049: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 01:04:24.634885: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 01:04:24.634934: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:04:24.636252: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:04:24.636767: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:04:24.637723: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:04:24.637766: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.40 MB
[2022-12-12 01:04:24.659589: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:04:24.659799: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:04:24.660183: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:04:24.660225: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.67 GB
[2022-12-12 01:04:24.660391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:04:24.660436: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[2022-12-12 01:04:24.662980: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:04:24.663571: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:04:24.663614: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[[[[2022-12-12 01:04:252022-12-12 01:04:252022-12-12 01:04:252022-12-12 01:04:25....298457298458298458298471: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 0 init p2p of link 1Device 3 init p2p of link 0Device 2 init p2p of link 3Device 1 init p2p of link 2



[[2022-12-12 01:04:252022-12-12 01:04:25..298810298810: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[::2022-12-12 01:04:2519801980.] [] 298869eager alloc mem 611.00 KB2022-12-12 01:04:25eager alloc mem 611.00 KB: 
.
E298891 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 611.00 KB1980
] eager alloc mem 611.00 KB
[2022-12-12 01:04:25.299723: [E2022-12-12 01:04:25 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc299731:: 638E]  [eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[2022-12-12 01:04:25
:2022-12-12 01:04:25.638.299774] 299781: eager release cuda mem 625663: E
E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 625663eager release cuda mem 625663

[2022-12-12 01:04:25.307031: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-12 01:04:251926.] 307051Device 3 init p2p of link 1: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 01:04:25.307142[: 2022-12-12 01:04:25[E[.2022-12-12 01:04:25 2022-12-12 01:04:25307140./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.: 307153:307165E: 1980:  E] E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu eager alloc mem 611.00 KB :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1926::] 19261980Device 1 init p2p of link 3] ] 
Device 0 init p2p of link 2eager alloc mem 611.00 KB

[[2022-12-12 01:04:252022-12-12 01:04:25..307364307367: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[2022-12-12 01:04:25.308050: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:04:25.308092: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:04:25[.2022-12-12 01:04:25308235.: 308239E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-12 01:04:25.315711: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 01:04:25.315794: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:04:25.315813: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 01:04:25.315894: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:04:25.315967: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 01:04:25.316053: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:04:25.316073: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 01:04:25.316167: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:04:25.316595: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:04:25.316697: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:04:25.316855: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:04:25.316981: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:04:25.323378: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:04:25.323540: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:04:25.323687: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13996568 / 100000000 nodes ( 14.00 %~14.00 %) | remote 34832112 / 100000000 nodes ( 34.83 %) | cpu 51171320 / 100000000 nodes ( 51.17 %) | 6.68 GB | 0.804674 secs 
[2022-12-12 01:04:25.323771: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:04:25.323807: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:04:25.323912: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13985059 / 100000000 nodes ( 13.99 %~14.00 %) | remote 34843621 / 100000000 nodes ( 34.84 %) | cpu 51171320 / 100000000 nodes ( 51.17 %) | 6.67 GB | 0.804961 secs 
[2022-12-12 01:04:25.324208: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13993494 / 100000000 nodes ( 13.99 %~14.00 %) | remote 34835186 / 100000000 nodes ( 34.84 %) | cpu 51171320 / 100000000 nodes ( 51.17 %) | 6.68 GB | 0.827702 secs 
[2022-12-12 01:04:25.324325: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13999634 / 100000000 nodes ( 14.00 %~14.00 %) | remote 34829046 / 100000000 nodes ( 34.83 %) | cpu 51171320 / 100000000 nodes ( 51.17 %) | 6.68 GB | 0.803576 secs 
[2022-12-12 01:04:25.325059: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.71 GB
[2022-12-12 01:04:26.389891: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.95 GB
[2022-12-12 01:04:26.390061: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.95 GB
[2022-12-12 01:04:26.390311: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.95 GB
[2022-12-12 01:04:27.140596: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.20 GB
[2022-12-12 01:04:27.140713: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.20 GB
[2022-12-12 01:04:27.141078: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.20 GB
[2022-12-12 01:04:27.893462: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.44 GB
[2022-12-12 01:04:27.893604: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.44 GB
[2022-12-12 01:04:27.894409: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.44 GB
[2022-12-12 01:04:28.705306: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.85 GB
[2022-12-12 01:04:28.705447: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.85 GB
[2022-12-12 01:04:28.705748: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.85 GB
[2022-12-12 01:04:29.326869: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.04 GB
[2022-12-12 01:04:29.327000: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.04 GB
[HCTR][01:04:29.647][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][01:04:29.647][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][01:04:29.647][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][01:04:29.647][ERROR][RK0][tid #139764510471936]: replica 0 calling init per replica done, doing barrier
[HCTR][01:04:29.647][ERROR][RK0][tid #139764510471936]: replica 0 calling init per replica done, doing barrier done
[HCTR][01:04:29.647][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][01:04:29.647][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][01:04:29.647][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][01:04:29.647][ERROR][RK0][main]: init per replica done
[HCTR][01:04:29.647][ERROR][RK0][main]: init per replica done
[HCTR][01:04:29.647][ERROR][RK0][main]: init per replica done
[HCTR][01:04:29.654][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f0b53720000
[HCTR][01:04:29.654][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f1ee8600000
[HCTR][01:04:29.654][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f1ee8c40000
[HCTR][01:04:29.654][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f1ee8f60000
[HCTR][01:04:29.654][ERROR][RK0][tid #139764518864640]: 3 allocated 3276800 at 0x7f0b53720000
[HCTR][01:04:29.654][ERROR][RK0][tid #139764518864640]: 3 allocated 6553600 at 0x7f1ee8600000
[HCTR][01:04:29.654][ERROR][RK0][tid #139764518864640]: 3 allocated 3276800 at 0x7f1ee8c40000
[HCTR][01:04:29.654][ERROR][RK0][tid #139764518864640]: 3 allocated 6553600 at 0x7f1ee8f60000
[HCTR][01:04:29.656][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f0b53720000
[HCTR][01:04:29.656][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f1ee8600000
[HCTR][01:04:29.656][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f1ee8c40000
[HCTR][01:04:29.656][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f1ee8f60000
[HCTR][01:04:29.704][ERROR][RK0][tid #139764510471936]: init per replica done
[HCTR][01:04:29.712][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f059a320000
[HCTR][01:04:29.713][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f059a800000
[HCTR][01:04:29.713][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f059b50e800
[HCTR][01:04:29.713][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f059b82e800




