2022-12-11 23:51:08.019994: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:51:08.105052: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:51:08.105994: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:51:08.106419: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:51:08.929778: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:51:08.929858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:51:08.942703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:51:08.972606: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:51:08.972758: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:51:08.974681: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 23:51:08.992238: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:51:08.992251: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:51:08.992312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:51:08.992318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:51:08.994520: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:51:08.994581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:51:09.005455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:51:09.007168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:51:09.008320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:51:09.034574: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:51:09.034727: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:51:09.036347: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 23:51:09.036611: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:51:09.036716: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:51:09.037938: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:51:09.038014: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 23:51:09.038031: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:51:09.039443: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][23:51:10.260][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:51:10.271][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:51:10.309][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:51:10.311][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.53s/it]warmup run: 100it [00:01, 85.01it/s]warmup run: 180it [00:01, 162.46it/s]warmup run: 284it [00:01, 280.12it/s]warmup run: 386it [00:01, 398.54it/s]warmup run: 493it [00:02, 522.88it/s]warmup run: 601it [00:02, 639.83it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 1it [00:01,  1.48s/it]warmup run: 709it [00:02, 739.98it/s]warmup run: 93it [00:01, 83.02it/s]warmup run: 107it [00:01, 93.64it/s]warmup run: 817it [00:02, 823.74it/s]warmup run: 179it [00:01, 171.12it/s]warmup run: 216it [00:01, 204.49it/s]warmup run: 924it [00:02, 886.52it/s]warmup run: 282it [00:01, 290.53it/s]warmup run: 316it [00:01, 313.54it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1029it [00:02, 911.08it/s]warmup run: 367it [00:01, 383.08it/s]warmup run: 426it [00:01, 441.97it/s]warmup run: 1133it [00:02, 945.38it/s]warmup run: 481it [00:01, 527.75it/s]warmup run: 538it [00:01, 569.62it/s]warmup run: 1242it [00:02, 985.64it/s]warmup run: 584it [00:02, 635.45it/s]warmup run: 651it [00:02, 688.18it/s]warmup run: 1347it [00:02, 978.95it/s]warmup run: 685it [00:02, 722.66it/s]warmup run: 761it [00:02, 783.01it/s]warmup run: 1450it [00:02, 989.83it/s]warmup run: 783it [00:02, 785.96it/s]warmup run: 872it [00:02, 863.75it/s]warmup run: 1556it [00:03, 1008.65it/s]warmup run: 881it [00:02, 834.58it/s]warmup run: 980it [00:02, 916.13it/s]warmup run: 1659it [00:03, 1002.88it/s]warmup run: 981it [00:02, 877.69it/s]warmup run: 1091it [00:02, 967.29it/s]warmup run: 1761it [00:03, 982.85it/s] warmup run: 1090it [00:02, 935.47it/s]warmup run: 1202it [00:02, 1004.73it/s]warmup run: 1861it [00:03, 975.92it/s]warmup run: 1200it [00:02, 980.83it/s]warmup run: 1313it [00:02, 1033.97it/s]warmup run: 1963it [00:03, 987.72it/s]warmup run: 1308it [00:02, 1007.60it/s]warmup run: 1423it [00:02, 1050.77it/s]warmup run: 2082it [00:03, 1045.68it/s]warmup run: 1413it [00:02, 1018.41it/s]warmup run: 1536it [00:02, 1073.02it/s]warmup run: 2215it [00:03, 1128.16it/s]warmup run: 1518it [00:02, 1002.38it/s]warmup run: 1647it [00:02, 1069.94it/s]warmup run: 2349it [00:03, 1188.28it/s]warmup run: 1626it [00:03, 1022.49it/s]warmup run: 1760it [00:03, 1085.78it/s]warmup run: 2483it [00:03, 1231.05it/s]warmup run: 1730it [00:03, 1025.14it/s]warmup run: 1873it [00:03, 1098.75it/s]warmup run: 2616it [00:03, 1259.93it/s]warmup run: 1840it [00:03, 1046.48it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 1984it [00:03, 1082.02it/s]warmup run: 2751it [00:04, 1285.91it/s]warmup run: 1952it [00:03, 1066.50it/s]warmup run: 102it [00:01, 91.00it/s]warmup run: 2111it [00:03, 1136.20it/s]warmup run: 2887it [00:04, 1307.86it/s]warmup run: 2077it [00:03, 1119.30it/s]warmup run: 209it [00:01, 201.75it/s]warmup run: 2244it [00:03, 1193.01it/s]warmup run: 3000it [00:04, 703.03it/s] warmup run: 2210it [00:03, 1179.31it/s]warmup run: 319it [00:01, 326.69it/s]warmup run: 2378it [00:03, 1234.99it/s]warmup run: 2344it [00:03, 1225.86it/s]warmup run: 430it [00:01, 456.12it/s]warmup run: 2512it [00:03, 1265.97it/s]warmup run: 2479it [00:03, 1262.42it/s]warmup run: 540it [00:01, 578.65it/s]warmup run: 2647it [00:03, 1288.39it/s]warmup run: 2615it [00:03, 1289.27it/s]warmup run: 652it [00:02, 694.08it/s]warmup run: 2781it [00:03, 1301.12it/s]warmup run: 2750it [00:03, 1307.27it/s]warmup run: 763it [00:02, 790.91it/s]warmup run: 2916it [00:04, 1312.94it/s]warmup run: 2884it [00:04, 1316.06it/s]warmup run: 874it [00:02, 869.73it/s]warmup run: 3000it [00:04, 735.92it/s] warmup run: 3000it [00:04, 719.97it/s] warmup run: 983it [00:02, 922.18it/s]warmup run: 1092it [00:02, 966.01it/s]warmup run: 1200it [00:02, 992.09it/s]warmup run: 1308it [00:02, 1015.89it/s]warmup run: 1416it [00:02, 1032.47it/s]warmup run: 1524it [00:02, 1043.65it/s]warmup run: 1633it [00:02, 1055.44it/s]warmup run: 1741it [00:03, 1056.46it/s]warmup run: 1850it [00:03, 1065.37it/s]warmup run: 1958it [00:03, 1069.08it/s]warmup run: 2079it [00:03, 1110.93it/s]warmup run: 2215it [00:03, 1183.76it/s]warmup run: 2349it [00:03, 1230.28it/s]warmup run: 2485it [00:03, 1267.22it/s]warmup run: 2620it [00:03, 1290.16it/s]warmup run: 2755it [00:03, 1307.15it/s]warmup run: 2889it [00:03, 1315.50it/s]warmup run: 3000it [00:04, 739.01it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1774.25it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1698.61it/s]warmup should be done:   4%|▎         | 111/3000 [00:00<00:02, 1109.88it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1721.04it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1762.89it/s]warmup should be done:  10%|▉         | 290/3000 [00:00<00:01, 1508.10it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1778.51it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1763.27it/s]warmup should be done:  15%|█▌        | 456/3000 [00:00<00:01, 1574.11it/s]warmup should be done:  18%|█▊        | 535/3000 [00:00<00:01, 1775.59it/s]warmup should be done:  18%|█▊        | 530/3000 [00:00<00:01, 1764.54it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1658.13it/s]warmup should be done:  21%|██        | 633/3000 [00:00<00:01, 1649.66it/s]warmup should be done:  24%|██▍       | 716/3000 [00:00<00:01, 1785.83it/s]warmup should be done:  24%|██▎       | 709/3000 [00:00<00:01, 1772.61it/s]warmup should be done:  24%|██▎       | 707/3000 [00:00<00:01, 1706.04it/s]warmup should be done:  30%|██▉       | 896/3000 [00:00<00:01, 1789.86it/s]warmup should be done:  27%|██▋       | 811/3000 [00:00<00:01, 1693.90it/s]warmup should be done:  30%|██▉       | 887/3000 [00:00<00:01, 1775.15it/s]warmup should be done:  30%|██▉       | 885/3000 [00:00<00:01, 1728.86it/s]warmup should be done:  33%|███▎      | 989/3000 [00:00<00:01, 1720.80it/s]warmup should be done:  36%|███▌      | 1066/3000 [00:00<00:01, 1777.12it/s]warmup should be done:  36%|███▌      | 1075/3000 [00:00<00:01, 1777.35it/s]warmup should be done:  35%|███▌      | 1059/3000 [00:00<00:01, 1706.94it/s]warmup should be done:  39%|███▉      | 1163/3000 [00:00<00:01, 1724.04it/s]warmup should be done:  41%|████▏     | 1244/3000 [00:00<00:00, 1776.04it/s]warmup should be done:  42%|████▏     | 1256/3000 [00:00<00:00, 1784.86it/s]warmup should be done:  41%|████      | 1237/3000 [00:00<00:01, 1727.50it/s]warmup should be done:  45%|████▍     | 1342/3000 [00:00<00:00, 1743.96it/s]warmup should be done:  47%|████▋     | 1422/3000 [00:00<00:00, 1772.02it/s]warmup should be done:  48%|████▊     | 1435/3000 [00:00<00:00, 1776.69it/s]warmup should be done:  47%|████▋     | 1416/3000 [00:00<00:00, 1746.11it/s]warmup should be done:  51%|█████     | 1520/3000 [00:00<00:00, 1754.24it/s]warmup should be done:  54%|█████▍    | 1615/3000 [00:00<00:00, 1783.86it/s]warmup should be done:  53%|█████▎    | 1600/3000 [00:00<00:00, 1761.65it/s]warmup should be done:  53%|█████▎    | 1596/3000 [00:00<00:00, 1761.71it/s]warmup should be done:  57%|█████▋    | 1699/3000 [00:01<00:00, 1762.74it/s]warmup should be done:  59%|█████▉    | 1777/3000 [00:01<00:00, 1755.74it/s]warmup should be done:  60%|█████▉    | 1794/3000 [00:01<00:00, 1772.99it/s]warmup should be done:  59%|█████▉    | 1776/3000 [00:01<00:00, 1771.21it/s]warmup should be done:  63%|██████▎   | 1878/3000 [00:01<00:00, 1769.94it/s]warmup should be done:  65%|██████▌   | 1953/3000 [00:01<00:00, 1750.87it/s]warmup should be done:  66%|██████▌   | 1972/3000 [00:01<00:00, 1762.69it/s]warmup should be done:  65%|██████▌   | 1956/3000 [00:01<00:00, 1778.26it/s]warmup should be done:  69%|██████▊   | 2057/3000 [00:01<00:00, 1774.22it/s]warmup should be done:  71%|███████   | 2129/3000 [00:01<00:00, 1748.07it/s]warmup should be done:  72%|███████▏  | 2151/3000 [00:01<00:00, 1768.35it/s]warmup should be done:  71%|███████   | 2136/3000 [00:01<00:00, 1783.98it/s]warmup should be done:  75%|███████▍  | 2236/3000 [00:01<00:00, 1776.45it/s]warmup should be done:  77%|███████▋  | 2304/3000 [00:01<00:00, 1747.21it/s]warmup should be done:  78%|███████▊  | 2333/3000 [00:01<00:00, 1781.99it/s]warmup should be done:  77%|███████▋  | 2315/3000 [00:01<00:00, 1760.57it/s]warmup should be done:  80%|████████  | 2415/3000 [00:01<00:00, 1780.21it/s]warmup should be done:  84%|████████▎ | 2512/3000 [00:01<00:00, 1778.04it/s]warmup should be done:  83%|████████▎ | 2479/3000 [00:01<00:00, 1711.17it/s]warmup should be done:  83%|████████▎ | 2496/3000 [00:01<00:00, 1774.15it/s]warmup should be done:  86%|████████▋ | 2595/3000 [00:01<00:00, 1785.37it/s]warmup should be done:  90%|████████▉ | 2694/3000 [00:01<00:00, 1788.58it/s]warmup should be done:  89%|████████▊ | 2656/3000 [00:01<00:00, 1726.14it/s]warmup should be done:  89%|████████▉ | 2676/3000 [00:01<00:00, 1781.02it/s]warmup should be done:  92%|█████████▏| 2774/3000 [00:01<00:00, 1786.26it/s]warmup should be done:  96%|█████████▌| 2876/3000 [00:01<00:00, 1796.34it/s]warmup should be done:  94%|█████████▍| 2831/3000 [00:01<00:00, 1731.80it/s]warmup should be done:  95%|█████████▌| 2857/3000 [00:01<00:00, 1788.18it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1781.13it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1758.20it/s]warmup should be done:  98%|█████████▊| 2953/3000 [00:01<00:00, 1767.54it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1750.05it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1729.48it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 186/3000 [00:00<00:01, 1855.49it/s]warmup should be done:   5%|▍         | 148/3000 [00:00<00:01, 1476.45it/s]warmup should be done:   5%|▌         | 157/3000 [00:00<00:01, 1567.02it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1771.52it/s]warmup should be done:  12%|█▏        | 372/3000 [00:00<00:01, 1855.82it/s]warmup should be done:  11%|█         | 332/3000 [00:00<00:01, 1688.71it/s]warmup should be done:  12%|█▏        | 364/3000 [00:00<00:01, 1822.89it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1729.15it/s]warmup should be done:  19%|█▊        | 558/3000 [00:00<00:01, 1855.57it/s]warmup should be done:  17%|█▋        | 520/3000 [00:00<00:01, 1774.77it/s]warmup should be done:  18%|█▊        | 526/3000 [00:00<00:01, 1779.46it/s]warmup should be done:  18%|█▊        | 550/3000 [00:00<00:01, 1838.04it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1808.14it/s]warmup should be done:  25%|██▍       | 744/3000 [00:00<00:01, 1853.72it/s]warmup should be done:  24%|██▎       | 711/3000 [00:00<00:01, 1804.40it/s]warmup should be done:  25%|██▍       | 736/3000 [00:00<00:01, 1843.27it/s]warmup should be done:  30%|██▉       | 894/3000 [00:00<00:01, 1833.61it/s]warmup should be done:  31%|███       | 930/3000 [00:00<00:01, 1853.47it/s]warmup should be done:  30%|██▉       | 896/3000 [00:00<00:01, 1819.05it/s]warmup should be done:  31%|███       | 921/3000 [00:00<00:01, 1842.73it/s]warmup should be done:  36%|███▌      | 1080/3000 [00:00<00:01, 1839.65it/s]warmup should be done:  37%|███▋      | 1116/3000 [00:00<00:01, 1854.76it/s]warmup should be done:  36%|███▌      | 1081/3000 [00:00<00:01, 1828.68it/s]warmup should be done:  37%|███▋      | 1106/3000 [00:00<00:01, 1831.43it/s]warmup should be done:  42%|████▏     | 1265/3000 [00:00<00:00, 1830.38it/s]warmup should be done:  43%|████▎     | 1302/3000 [00:00<00:00, 1851.77it/s]warmup should be done:  42%|████▏     | 1264/3000 [00:00<00:00, 1824.49it/s]warmup should be done:  43%|████▎     | 1290/3000 [00:00<00:00, 1811.72it/s]warmup should be done:  50%|████▉     | 1488/3000 [00:00<00:00, 1853.56it/s]warmup should be done:  48%|████▊     | 1449/3000 [00:00<00:00, 1829.82it/s]warmup should be done:  48%|████▊     | 1451/3000 [00:00<00:00, 1837.02it/s]warmup should be done:  49%|████▉     | 1475/3000 [00:00<00:00, 1823.64it/s]warmup should be done:  54%|█████▍    | 1634/3000 [00:00<00:00, 1835.61it/s]warmup should be done:  56%|█████▌    | 1674/3000 [00:00<00:00, 1854.74it/s]warmup should be done:  55%|█████▍    | 1639/3000 [00:00<00:00, 1849.34it/s]warmup should be done:  55%|█████▌    | 1658/3000 [00:00<00:00, 1821.23it/s]warmup should be done:  61%|██████    | 1827/3000 [00:01<00:00, 1857.26it/s]warmup should be done:  61%|██████    | 1818/3000 [00:01<00:00, 1815.37it/s]warmup should be done:  61%|██████▏   | 1844/3000 [00:01<00:00, 1831.49it/s]warmup should be done:  62%|██████▏   | 1860/3000 [00:01<00:00, 1818.76it/s]warmup should be done:  67%|██████▋   | 2013/3000 [00:01<00:00, 1853.62it/s]warmup should be done:  68%|██████▊   | 2046/3000 [00:01<00:00, 1831.13it/s]warmup should be done:  68%|██████▊   | 2028/3000 [00:01<00:00, 1820.50it/s]warmup should be done:  67%|██████▋   | 2000/3000 [00:01<00:00, 1773.85it/s]warmup should be done:  73%|███████▎  | 2199/3000 [00:01<00:00, 1854.26it/s]warmup should be done:  74%|███████▍  | 2232/3000 [00:01<00:00, 1837.91it/s]warmup should be done:  74%|███████▎  | 2211/3000 [00:01<00:00, 1811.61it/s]warmup should be done:  73%|███████▎  | 2178/3000 [00:01<00:00, 1767.67it/s]warmup should be done:  80%|███████▉  | 2385/3000 [00:01<00:00, 1845.10it/s]warmup should be done:  81%|████████  | 2418/3000 [00:01<00:00, 1843.37it/s]warmup should be done:  80%|███████▉  | 2393/3000 [00:01<00:00, 1810.16it/s]warmup should be done:  78%|███████▊  | 2355/3000 [00:01<00:00, 1765.27it/s]warmup should be done:  86%|████████▌ | 2572/3000 [00:01<00:00, 1850.36it/s]warmup should be done:  87%|████████▋ | 2605/3000 [00:01<00:00, 1849.05it/s]warmup should be done:  86%|████████▌ | 2575/3000 [00:01<00:00, 1808.42it/s]warmup should be done:  84%|████████▍ | 2532/3000 [00:01<00:00, 1756.54it/s]warmup should be done:  92%|█████████▏| 2758/3000 [00:01<00:00, 1842.22it/s]warmup should be done:  93%|█████████▎| 2792/3000 [00:01<00:00, 1853.78it/s]warmup should be done:  92%|█████████▏| 2759/3000 [00:01<00:00, 1814.72it/s]warmup should be done:  90%|█████████ | 2709/3000 [00:01<00:00, 1758.80it/s]warmup should be done:  98%|█████████▊| 2944/3000 [00:01<00:00, 1845.18it/s]warmup should be done:  99%|█████████▉| 2979/3000 [00:01<00:00, 1857.09it/s]warmup should be done:  98%|█████████▊| 2941/3000 [00:01<00:00, 1815.95it/s]warmup should be done:  96%|█████████▌| 2885/3000 [00:01<00:00, 1757.99it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1848.83it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1828.36it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1819.68it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1783.21it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f1b85f7d280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f1b85f7d130>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f1b8623fe80>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f1b85f7d070>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 23:52:24.217344: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1755a67520 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:52:24.217411: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:52:24.226367: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:52:24.253842: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1755a684f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:52:24.253915: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:52:24.264556: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:52:24.269034: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1759a63b70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:52:24.269102: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:52:24.276700: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:52:24.302838: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1761a6b370 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:52:24.302900: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:52:24.309937: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:52:24.911074: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:52:25.000523: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:52:25.044317: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:52:25.080537: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:52:30.144951: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:52:30.295554: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:52:31.274401: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:52:31.275797: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][23:53:25.384][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][23:53:25.385][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:53:25.389][ERROR][RK0][main]: coll ps creation done
[HCTR][23:53:25.389][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][23:53:25.592][ERROR][RK0][tid #139738673559296]: replica 0 reaches 1000, calling init pre replica
[HCTR][23:53:25.592][ERROR][RK0][tid #139738673559296]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:53:25.597][ERROR][RK0][tid #139738673559296]: coll ps creation done
[HCTR][23:53:25.597][ERROR][RK0][tid #139738673559296]: replica 0 waits for coll ps creation barrier
[HCTR][23:53:25.686][ERROR][RK0][tid #139738681952000]: replica 2 reaches 1000, calling init pre replica
[HCTR][23:53:25.686][ERROR][RK0][tid #139738681952000]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:53:25.690][ERROR][RK0][tid #139738681952000]: coll ps creation done
[HCTR][23:53:25.690][ERROR][RK0][tid #139738681952000]: replica 2 waits for coll ps creation barrier
[HCTR][23:53:25.700][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][23:53:25.700][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:53:25.704][ERROR][RK0][main]: coll ps creation done
[HCTR][23:53:25.704][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][23:53:25.704][ERROR][RK0][tid #139738673559296]: replica 0 preparing frequency
[HCTR][23:53:26.615][ERROR][RK0][tid #139738673559296]: replica 0 preparing frequency done
[HCTR][23:53:26.647][ERROR][RK0][tid #139738673559296]: replica 0 calling init per replica
[HCTR][23:53:26.647][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][23:53:26.647][ERROR][RK0][tid #139738681952000]: replica 2 calling init per replica
[HCTR][23:53:26.647][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][23:53:26.647][ERROR][RK0][tid #139738673559296]: Calling build_v2
[HCTR][23:53:26.647][ERROR][RK0][main]: Calling build_v2
[HCTR][23:53:26.647][ERROR][RK0][tid #139738681952000]: Calling build_v2
[HCTR][23:53:26.647][ERROR][RK0][tid #139738673559296]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:53:26.647][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:53:26.647][ERROR][RK0][tid #139738681952000]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:53:26.647][ERROR][RK0][main]: Calling build_v2
[HCTR][23:53:26.647][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-11 23:53:26.2022-12-11 23:53:26647285.2022-12-11 23:53:26: 647285.E: 647294 E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc[ E:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc 1362022-12-11 23:53:26:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] .136:using concurrent impl MPS647324] 136
: using concurrent impl MPS] E
using concurrent impl MPS 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 23:53:26.648495: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 23:53:26.[6485422022-12-11 23:53:26: .E648548 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE:[ 2122022-12-11 23:53:26/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] .:build symm link desc with 4X Tesla V100-SXM2-16GB out of 4648570196
: ] E[assigning 8 to cpu[ 2022-12-11 23:53:26
2022-12-11 23:53:26/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc..:648599648614196: : ] EEassigning 8 to cpu  
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::[196[2132022-12-11 23:53:26] 2022-12-11 23:53:26] .assigning 8 to cpu.remote time is 8.68421648706
648708
: : EE [ /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 23:53:26/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:.:212648776212] : ] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4
 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30[
[2022-12-11 23:53:262022-12-11 23:53:26..648826648828: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::213213] ] remote time is 8.68421remote time is 8.68421

[[2022-12-11 23:53:262022-12-11 23:53:26..[6488846488852022-12-11 23:53:26: : .EE648881  : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE:: 214214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] ] :cpu time is 30cpu time is 30212

] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 23:53:26.649034: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 23:53:26.649065: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 23:53:52.551782: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 23:53:52.622681: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 23:53:52.622888: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 23:53:52.624939: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 23:53:52.713610: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 23:53:53. 87614: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 23:53:53. 87747: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 23:54:00.979646: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 23:54:00.979768: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 23:54:02.724151: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 23:54:02.724242: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 23:54:02.731126: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 23:54:02.731191: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 23:54:03.744608: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 23:54:03.758674: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 23:54:03.759438: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 23:54:03.770104: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 23:54:03.865235: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 23:54:41.392743: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 23:54:41.398572: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 23:54:41.410113: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 23:54:41.422152: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 23:54:41.422217: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 23:54:41.422251: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 23:54:41.422283: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 23:54:41.423156: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:54:41.423207: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:54:41.424090: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:54:41.424637: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:54:41.444835: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 23:54:41.444944: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 23:54:41.446156: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:54:41.446217: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:54:41.446489: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 23:54:41.446560: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 23:54:41.447517: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:54:41.448119: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 23:54:41:.1980448135] : eager alloc mem 381.47 MBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:54:41.448204: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:54:41.449287: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:54:41.449854: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:54:41.452180: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 23:54:41.452294: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 23:54:41.453295: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:54:41.453364: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:54:41.454383: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:54:41.455128: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:54:41.494878: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:54:41.496805: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:54:41.496857: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:54:41.497643: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:54:41.498145: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:54:41.499167: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:54:41.499215: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 37.77 MB
[2022-12-11 23:54:41.517001: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:54:41.517589: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:54:41.517633: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.73 GB
[[2022-12-11 23:54:412022-12-11 23:54:41..540585540585: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-11 23:54:41.542492: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:54:41.542542: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:54:41.542843: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:54:41.542892: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:54:41.543331: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:54:41.544220: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:54:41.544445: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:54:41.544744: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:54:41.545407: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:54:41.545454: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 37.94 MB
[2022-12-11 23:54:41.545731: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:54:41.545791: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.13 MB
[2022-12-11 23:54:41.550244: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:54:41.552119: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:54:41.552166: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:54:41.552942: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:54:41.553387: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:54:41.554332: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:54:41.554373: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.07 MB
[2022-12-11 23:54:41.566115: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:54:41.566718: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[[2022-12-11 23:54:412022-12-11 23:54:41..566742566760: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 25.25 KBeager alloc mem 4.75 GB

[2022-12-11 23:54:41.567367: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:54:41.567421: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[2022-12-11 23:54:41.574127: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:54:41.574715: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:54:41.574759: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.76 GB
[[[[2022-12-11 23:54:422022-12-11 23:54:422022-12-11 23:54:422022-12-11 23:54:42.... 21478 21486 21483 21479: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 2 init p2p of link 3Device 1 init p2p of link 2Device 0 init p2p of link 1



[[[2022-12-11 23:54:42[2022-12-11 23:54:422022-12-11 23:54:42.2022-12-11 23:54:42.. 21827. 21828 21831:  21829: : E: EE E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::1980:19801980] 1980] ] eager alloc mem 611.00 KB] eager alloc mem 611.00 KBeager alloc mem 611.00 KB
eager alloc mem 611.00 KB


[2022-12-11 23:54:42.[ 227672022-12-11 23:54:42[: [.2022-12-11 23:54:42E2022-12-11 23:54:42 22773. .:  22782/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc 22785E: ::  E638E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc ]  :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:
:] 638638eager release cuda mem 625663] ] 
eager release cuda mem 625663eager release cuda mem 625663

[2022-12-11 23:54:42. 27859: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 23:54:42. 27957: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:54:42. 28110: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 23:54:42. 28210: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:54:42. 28766: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:54:42. 29012: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:54:42. 29466: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 23:54:42. 29581: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:54:42. 29635: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 23:54:42. 29745: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:54:42. 30380: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:54:42. 30546: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:54:42. 34511: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 23:54:42. 34559: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0[
2022-12-11 23:54:42. 34592: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:54:42[.2022-12-11 23:54:42 34644[.: 2022-12-11 23:54:42 34660E.:   34666E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:  :E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1926 :] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980Device 0 init p2p of link 3:] 
1926eager alloc mem 611.00 KB] 
Device 3 init p2p of link 2
[2022-12-11 23:54:42. 34829: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 611.00 KB2022-12-11 23:54:42
. 34855: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:54:42. 35388: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:54:42. 35561: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:54:42. 35627: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:54:42. 35661: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:54:42. 39977: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:54:42. 40261: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9996040 / 100000000 nodes ( 10.00 %~10.00 %) | remote 27126375 / 100000000 nodes ( 27.13 %) | cpu 62877585 / 100000000 nodes ( 62.88 %) | 4.77 GB | 0.592075 secs 
[2022-12-11 23:54:42. 40469: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:54:42. 40761: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9902322 / 100000000 nodes ( 9.90 %~10.00 %) | remote 27220093 / 100000000 nodes ( 27.22 %) | cpu 62877585 / 100000000 nodes ( 62.88 %) | 4.73 GB | 0.617563 secs 
[2022-12-11 23:54:42. 41754: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.43 GB
[[2022-12-11 23:54:422022-12-11 23:54:42.. 42005 42012: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 40400000eager release cuda mem 40400000

[2022-12-11 23:54:42. 42379: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9979592 / 100000000 nodes ( 9.98 %~10.00 %) | remote 27142823 / 100000000 nodes ( 27.14 %) | cpu 62877585 / 100000000 nodes ( 62.88 %) | 4.76 GB | 0.589036 secs 
[2022-12-11 23:54:42. 42469: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9944461 / 100000000 nodes ( 9.94 %~10.00 %) | remote 27177954 / 100000000 nodes ( 27.18 %) | cpu 62877585 / 100000000 nodes ( 62.88 %) | 4.75 GB | 0.596276 secs 
[2022-12-11 23:54:43.241243: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.67 GB
[2022-12-11 23:54:43.241384: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.67 GB
[2022-12-11 23:54:43.241676: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.67 GB
[2022-12-11 23:54:44.  1908: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.92 GB
[2022-12-11 23:54:44.  2096: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.92 GB
[2022-12-11 23:54:44.  2461: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.92 GB
[2022-12-11 23:54:44.688412: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.16 GB
[2022-12-11 23:54:44.688551: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.16 GB
[2022-12-11 23:54:44.689493: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.16 GB
[2022-12-11 23:54:45.880646: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.57 GB
[2022-12-11 23:54:45.880787: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.57 GB
[2022-12-11 23:54:45.881120: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.57 GB
[2022-12-11 23:54:46.444743: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.76 GB
[2022-12-11 23:54:46.444864: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.76 GB
[HCTR][23:54:46.466][ERROR][RK0][tid #139738673559296]: replica 0 calling init per replica done, doing barrier
[HCTR][23:54:46.466][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][23:54:46.466][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][23:54:46.466][ERROR][RK0][tid #139738681952000]: replica 2 calling init per replica done, doing barrier
[HCTR][23:54:46.466][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][23:54:46.466][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][23:54:46.466][ERROR][RK0][tid #139738681952000]: replica 2 calling init per replica done, doing barrier done
[HCTR][23:54:46.466][ERROR][RK0][tid #139738673559296]: replica 0 calling init per replica done, doing barrier done
[HCTR][23:54:46.466][ERROR][RK0][main]: init per replica done
[HCTR][23:54:46.466][ERROR][RK0][main]: init per replica done
[HCTR][23:54:46.466][ERROR][RK0][tid #139738681952000]: init per replica done
[HCTR][23:54:46.470][ERROR][RK0][tid #139738673559296]: init per replica done
[HCTR][23:54:46.507][ERROR][RK0][main]: 3 allocated 3276800 at 0x7efcac238400
[HCTR][23:54:46.507][ERROR][RK0][main]: 3 allocated 6553600 at 0x7efcac558400
[HCTR][23:54:46.507][ERROR][RK0][main]: 3 allocated 3276800 at 0x7efcacb98400
[HCTR][23:54:46.507][ERROR][RK0][main]: 3 allocated 6553600 at 0x7efcaceb8400
[HCTR][23:54:46.508][ERROR][RK0][tid #139738673559296]: 0 allocated 3276800 at 0x7efc98320000
[HCTR][23:54:46.508][ERROR][RK0][tid #139738673559296]: 0 allocated 6553600 at 0x7efc98640000
[HCTR][23:54:46.508][ERROR][RK0][tid #139738673559296]: 0 allocated 3276800 at 0x7efc98c80000
[HCTR][23:54:46.508][ERROR][RK0][tid #139738673559296]: 0 allocated 6553600 at 0x7efc98fa0000
[HCTR][23:54:46.509][ERROR][RK0][tid #139738681952000]: 2 allocated 3276800 at 0x7efd30238400
[HCTR][23:54:46.509][ERROR][RK0][tid #139738681952000]: 2 allocated 6553600 at 0x7efd30558400
[HCTR][23:54:46.509][ERROR][RK0][tid #139738681952000]: 2 allocated 3276800 at 0x7efd30b98400
[HCTR][23:54:46.509][ERROR][RK0][tid #139738681952000]: 2 allocated 6553600 at 0x7efd30eb8400
[HCTR][23:54:46.510][ERROR][RK0][main]: 1 allocated 3276800 at 0x7efc90238400
[HCTR][23:54:46.510][ERROR][RK0][main]: 1 allocated 6553600 at 0x7efc90558400
[HCTR][23:54:46.510][ERROR][RK0][main]: 1 allocated 3276800 at 0x7efc90b98400
[HCTR][23:54:46.510][ERROR][RK0][main]: 1 allocated 6553600 at 0x7efc90eb8400
