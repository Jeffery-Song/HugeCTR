2022-12-12 02:37:15.325745: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:37:15.395589: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:37:15.395736: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:37:15.396018: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:37:16.186582: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:37:16.186663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:37:16.199763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:37:16.231381: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:37:16.231567: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:37:16.232989: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 02:37:16.290651: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:37:16.290658: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:37:16.290729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:37:16.290731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:37:16.303390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:37:16.305950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:37:16.325640: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:37:16.325719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:37:16.335646: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:37:16.335895: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:37:16.337635: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 02:37:16.339333: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:37:16.339508: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:37:16.341067: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 02:37:16.342894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:37:16.374978: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:37:16.375164: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:37:16.376480: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][02:37:17.576][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:37:17.593][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:37:17.649][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:37:17.656][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 1it [00:01,  1.52s/it]warmup run: 102it [00:01, 92.06it/s]warmup run: 101it [00:01, 86.50it/s]warmup run: 205it [00:01, 199.25it/s]warmup run: 208it [00:01, 193.93it/s]warmup run: 307it [00:01, 314.48it/s]warmup run: 316it [00:01, 313.45it/s]warmup run: 412it [00:01, 437.21it/s]warmup run: 424it [00:01, 437.13it/s]warmup run: 518it [00:01, 556.34it/s]warmup run: 532it [00:02, 557.43it/s]warmup run: 620it [00:02, 655.11it/s]warmup run: 633it [00:02, 646.25it/s]warmup run: 0it [00:00, ?it/s]warmup run: 728it [00:02, 754.93it/s]warmup run: 735it [00:02, 730.67it/s]warmup run: 839it [00:02, 843.95it/s]warmup run: 842it [00:02, 813.55it/s]warmup run: 952it [00:02, 919.23it/s]warmup run: 950it [00:02, 882.76it/s]warmup run: 1066it [00:02, 979.16it/s]warmup run: 1055it [00:02, 927.01it/s]warmup run: 1176it [00:02, 993.56it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1160it [00:02, 947.02it/s]warmup run: 1284it [00:02, 1008.86it/s]warmup run: 108it [00:01, 98.21it/s]warmup run: 1264it [00:02, 971.55it/s]warmup run: 214it [00:01, 209.06it/s]warmup run: 1367it [00:02, 986.40it/s]warmup run: 1391it [00:02, 979.21it/s] warmup run: 324it [00:01, 334.94it/s]warmup run: 1475it [00:02, 1011.25it/s]warmup run: 1505it [00:02, 1024.26it/s]warmup run: 422it [00:01, 442.84it/s]warmup run: 1582it [00:03, 1026.19it/s]warmup run: 1613it [00:02, 1038.14it/s]warmup run: 521it [00:01, 548.30it/s]warmup run: 1688it [00:03, 1036.01it/s]warmup run: 1721it [00:03, 1047.59it/s]warmup run: 627it [00:02, 658.79it/s]warmup run: 1795it [00:03, 1044.62it/s]warmup run: 1828it [00:03, 1053.95it/s]warmup run: 1936it [00:03, 1058.95it/s]warmup run: 727it [00:02, 721.58it/s]warmup run: 1901it [00:03, 1021.93it/s]warmup run: 2044it [00:03, 1063.74it/s]warmup run: 2005it [00:03, 1009.71it/s]warmup run: 824it [00:02, 759.94it/s]warmup run: 2174it [00:03, 1132.86it/s]warmup run: 2132it [00:03, 1085.31it/s]warmup run: 918it [00:02, 790.50it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 2288it [00:03, 1129.91it/s]warmup run: 2260it [00:03, 1140.69it/s]warmup run: 1010it [00:02, 816.54it/s]warmup run: 97it [00:01, 87.20it/s]warmup run: 2409it [00:03, 1152.95it/s]warmup run: 2389it [00:03, 1183.40it/s]warmup run: 194it [00:01, 187.94it/s]warmup run: 1101it [00:02, 824.35it/s]warmup run: 2533it [00:03, 1176.61it/s]warmup run: 2520it [00:03, 1219.19it/s]warmup run: 284it [00:01, 287.62it/s]warmup run: 1190it [00:02, 840.19it/s]warmup run: 2655it [00:03, 1188.90it/s]warmup run: 2649it [00:03, 1239.83it/s]warmup run: 375it [00:01, 390.97it/s]warmup run: 1279it [00:02, 841.92it/s]warmup run: 2776it [00:03, 1194.17it/s]warmup run: 2781it [00:04, 1261.10it/s]warmup run: 465it [00:01, 488.40it/s]warmup run: 1367it [00:02, 851.02it/s]warmup run: 2902it [00:04, 1212.19it/s]warmup run: 2913it [00:04, 1277.66it/s]warmup run: 556it [00:02, 579.07it/s]warmup run: 1460it [00:02, 872.32it/s]warmup run: 3000it [00:04, 709.56it/s] warmup run: 3000it [00:04, 721.46it/s] warmup run: 644it [00:02, 638.84it/s]warmup run: 1549it [00:03, 857.50it/s]warmup run: 734it [00:02, 702.14it/s]warmup run: 1636it [00:03, 859.12it/s]warmup run: 826it [00:02, 757.24it/s]warmup run: 1725it [00:03, 867.58it/s]warmup run: 926it [00:02, 821.61it/s]warmup run: 1824it [00:03, 901.77it/s]warmup run: 1032it [00:02, 887.15it/s]warmup run: 1928it [00:03, 941.35it/s]warmup run: 1134it [00:02, 923.53it/s]warmup run: 2042it [00:03, 998.75it/s]warmup run: 1242it [00:02, 968.49it/s]warmup run: 2174it [00:03, 1093.57it/s]warmup run: 1347it [00:02, 991.01it/s]warmup run: 2301it [00:03, 1144.60it/s]warmup run: 1454it [00:02, 1010.89it/s]warmup run: 2423it [00:03, 1165.96it/s]warmup run: 2549it [00:03, 1191.48it/s]warmup run: 1558it [00:03, 947.42it/s] warmup run: 2669it [00:04, 1170.46it/s]warmup run: 1655it [00:03, 930.87it/s]warmup run: 2789it [00:04, 1177.05it/s]warmup run: 1758it [00:03, 957.51it/s]warmup run: 2920it [00:04, 1214.88it/s]warmup run: 1862it [00:03, 980.93it/s]warmup run: 3000it [00:04, 686.71it/s] warmup run: 1971it [00:03, 1011.28it/s]warmup run: 2098it [00:03, 1086.53it/s]warmup run: 2233it [00:03, 1163.69it/s]warmup run: 2364it [00:03, 1205.81it/s]warmup run: 2499it [00:03, 1247.47it/s]warmup run: 2633it [00:03, 1274.24it/s]warmup run: 2768it [00:04, 1296.12it/s]warmup run: 2900it [00:04, 1301.14it/s]warmup run: 3000it [00:04, 702.00it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1770.93it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1714.40it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1673.95it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1659.31it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1781.12it/s]warmup should be done:  12%|█▏        | 345/3000 [00:00<00:01, 1730.03it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1730.41it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1725.89it/s]warmup should be done:  17%|█▋        | 520/3000 [00:00<00:01, 1735.73it/s]warmup should be done:  17%|█▋        | 521/3000 [00:00<00:01, 1727.77it/s]warmup should be done:  18%|█▊        | 536/3000 [00:00<00:01, 1774.23it/s]warmup should be done:  17%|█▋        | 517/3000 [00:00<00:01, 1688.18it/s]warmup should be done:  23%|██▎       | 695/3000 [00:00<00:01, 1730.24it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1752.77it/s]warmup should be done:  23%|██▎       | 686/3000 [00:00<00:01, 1680.14it/s]warmup should be done:  23%|██▎       | 694/3000 [00:00<00:01, 1663.15it/s]warmup should be done:  29%|██▉       | 869/3000 [00:00<00:01, 1727.59it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1753.98it/s]warmup should be done:  28%|██▊       | 855/3000 [00:00<00:01, 1666.92it/s]warmup should be done:  29%|██▉       | 871/3000 [00:00<00:01, 1698.95it/s]warmup should be done:  35%|███▍      | 1042/3000 [00:00<00:01, 1718.47it/s]warmup should be done:  36%|███▌      | 1066/3000 [00:00<00:01, 1751.86it/s]warmup should be done:  34%|███▍      | 1025/3000 [00:00<00:01, 1675.81it/s]warmup should be done:  35%|███▍      | 1042/3000 [00:00<00:01, 1685.22it/s]warmup should be done:  40%|████      | 1214/3000 [00:00<00:01, 1718.67it/s]warmup should be done:  41%|████▏     | 1242/3000 [00:00<00:01, 1751.44it/s]warmup should be done:  40%|███▉      | 1193/3000 [00:00<00:01, 1667.71it/s]warmup should be done:  41%|████      | 1216/3000 [00:00<00:01, 1702.35it/s]warmup should be done:  46%|████▋     | 1388/3000 [00:00<00:00, 1722.27it/s]warmup should be done:  47%|████▋     | 1418/3000 [00:00<00:00, 1753.30it/s]warmup should be done:  45%|████▌     | 1362/3000 [00:00<00:00, 1673.45it/s]warmup should be done:  46%|████▋     | 1391/3000 [00:00<00:00, 1715.03it/s]warmup should be done:  52%|█████▏    | 1562/3000 [00:00<00:00, 1724.71it/s]warmup should be done:  53%|█████▎    | 1595/3000 [00:00<00:00, 1757.22it/s]warmup should be done:  51%|█████     | 1532/3000 [00:00<00:00, 1680.52it/s]warmup should be done:  52%|█████▏    | 1566/3000 [00:00<00:00, 1724.48it/s]warmup should be done:  58%|█████▊    | 1735/3000 [00:01<00:00, 1724.71it/s]warmup should be done:  59%|█████▉    | 1772/3000 [00:01<00:00, 1761.00it/s]warmup should be done:  57%|█████▋    | 1703/3000 [00:01<00:00, 1687.74it/s]warmup should be done:  58%|█████▊    | 1741/3000 [00:01<00:00, 1730.40it/s]warmup should be done:  64%|██████▎   | 1908/3000 [00:01<00:00, 1724.28it/s]warmup should be done:  65%|██████▍   | 1949/3000 [00:01<00:00, 1762.65it/s]warmup should be done:  62%|██████▏   | 1874/3000 [00:01<00:00, 1691.95it/s]warmup should be done:  64%|██████▍   | 1916/3000 [00:01<00:00, 1734.20it/s]warmup should be done:  69%|██████▉   | 2083/3000 [00:01<00:00, 1729.91it/s]warmup should be done:  71%|███████   | 2126/3000 [00:01<00:00, 1763.24it/s]warmup should be done:  68%|██████▊   | 2047/3000 [00:01<00:00, 1701.50it/s]warmup should be done:  70%|██████▉   | 2091/3000 [00:01<00:00, 1737.59it/s]warmup should be done:  75%|███████▌  | 2256/3000 [00:01<00:00, 1729.51it/s]warmup should be done:  77%|███████▋  | 2303/3000 [00:01<00:00, 1760.49it/s]warmup should be done:  74%|███████▍  | 2218/3000 [00:01<00:00, 1686.14it/s]warmup should be done:  76%|███████▌  | 2265/3000 [00:01<00:00, 1737.13it/s]warmup should be done:  81%|████████  | 2431/3000 [00:01<00:00, 1734.73it/s]warmup should be done:  83%|████████▎ | 2481/3000 [00:01<00:00, 1766.11it/s]warmup should be done:  81%|████████▏ | 2442/3000 [00:01<00:00, 1745.44it/s]warmup should be done:  80%|███████▉  | 2387/3000 [00:01<00:00, 1670.24it/s]warmup should be done:  87%|████████▋ | 2605/3000 [00:01<00:00, 1735.65it/s]warmup should be done:  89%|████████▊ | 2659/3000 [00:01<00:00, 1768.77it/s]warmup should be done:  87%|████████▋ | 2618/3000 [00:01<00:00, 1747.86it/s]warmup should be done:  85%|████████▌ | 2562/3000 [00:01<00:00, 1692.38it/s]warmup should be done:  93%|█████████▎| 2780/3000 [00:01<00:00, 1737.19it/s]warmup should be done:  95%|█████████▍| 2837/3000 [00:01<00:00, 1771.40it/s]warmup should be done:  93%|█████████▎| 2794/3000 [00:01<00:00, 1750.26it/s]warmup should be done:  91%|█████████▏| 2738/3000 [00:01<00:00, 1709.66it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1761.09it/s]warmup should be done:  98%|█████████▊| 2955/3000 [00:01<00:00, 1739.95it/s]warmup should be done:  99%|█████████▉| 2970/3000 [00:01<00:00, 1751.61it/s]warmup should be done:  97%|█████████▋| 2916/3000 [00:01<00:00, 1728.80it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1729.68it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1728.05it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1688.76it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1718.43it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1790.09it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1704.95it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1691.60it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1765.98it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1749.22it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1735.54it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1699.00it/s]warmup should be done:  18%|█▊        | 532/3000 [00:00<00:01, 1780.73it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1765.93it/s]warmup should be done:  17%|█▋        | 521/3000 [00:00<00:01, 1672.60it/s]warmup should be done:  18%|█▊        | 532/3000 [00:00<00:01, 1707.01it/s]warmup should be done:  24%|██▎       | 711/3000 [00:00<00:01, 1779.80it/s]warmup should be done:  24%|██▎       | 708/3000 [00:00<00:01, 1777.79it/s]warmup should be done:  23%|██▎       | 695/3000 [00:00<00:01, 1697.17it/s]warmup should be done:  23%|██▎       | 703/3000 [00:00<00:01, 1495.87it/s]warmup should be done:  30%|██▉       | 892/3000 [00:00<00:01, 1787.50it/s]warmup should be done:  30%|██▉       | 888/3000 [00:00<00:01, 1782.69it/s]warmup should be done:  29%|██▉       | 874/3000 [00:00<00:01, 1726.90it/s]warmup should be done:  29%|██▉       | 877/3000 [00:00<00:01, 1573.54it/s]warmup should be done:  36%|███▌      | 1067/3000 [00:00<00:01, 1784.52it/s]warmup should be done:  36%|███▌      | 1073/3000 [00:00<00:01, 1793.25it/s]warmup should be done:  35%|███▌      | 1059/3000 [00:00<00:01, 1765.74it/s]warmup should be done:  35%|███▌      | 1050/3000 [00:00<00:01, 1622.66it/s]warmup should be done:  42%|████▏     | 1246/3000 [00:00<00:00, 1783.51it/s]warmup should be done:  42%|████▏     | 1253/3000 [00:00<00:00, 1790.64it/s]warmup should be done:  41%|████▏     | 1242/3000 [00:00<00:00, 1784.02it/s]warmup should be done:  41%|████      | 1219/3000 [00:00<00:01, 1641.54it/s]warmup should be done:  48%|████▊     | 1426/3000 [00:00<00:00, 1786.98it/s]warmup should be done:  48%|████▊     | 1433/3000 [00:00<00:00, 1790.31it/s]warmup should be done:  48%|████▊     | 1425/3000 [00:00<00:00, 1795.71it/s]warmup should be done:  46%|████▌     | 1385/3000 [00:00<00:00, 1645.45it/s]warmup should be done:  54%|█████▎    | 1606/3000 [00:00<00:00, 1789.80it/s]warmup should be done:  54%|█████▍    | 1613/3000 [00:00<00:00, 1781.97it/s]warmup should be done:  54%|█████▎    | 1609/3000 [00:00<00:00, 1807.09it/s]warmup should be done:  52%|█████▏    | 1555/3000 [00:00<00:00, 1660.05it/s]warmup should be done:  60%|█████▉    | 1786/3000 [00:01<00:00, 1790.00it/s]warmup should be done:  60%|█████▉    | 1792/3000 [00:01<00:00, 1781.67it/s]warmup should be done:  60%|█████▉    | 1792/3000 [00:01<00:00, 1811.77it/s]warmup should be done:  58%|█████▊    | 1727/3000 [00:01<00:00, 1675.99it/s]warmup should be done:  66%|██████▌   | 1966/3000 [00:01<00:00, 1790.75it/s]warmup should be done:  66%|██████▌   | 1975/3000 [00:01<00:00, 1814.49it/s]warmup should be done:  66%|██████▌   | 1971/3000 [00:01<00:00, 1727.66it/s]warmup should be done:  63%|██████▎   | 1899/3000 [00:01<00:00, 1688.54it/s]warmup should be done:  72%|███████▏  | 2146/3000 [00:01<00:00, 1792.35it/s]warmup should be done:  72%|███████▏  | 2157/3000 [00:01<00:00, 1806.59it/s]warmup should be done:  72%|███████▏  | 2145/3000 [00:01<00:00, 1725.76it/s]warmup should be done:  69%|██████▉   | 2072/3000 [00:01<00:00, 1700.07it/s]warmup should be done:  78%|███████▊  | 2326/3000 [00:01<00:00, 1793.29it/s]warmup should be done:  78%|███████▊  | 2341/3000 [00:01<00:00, 1814.62it/s]warmup should be done:  77%|███████▋  | 2318/3000 [00:01<00:00, 1702.61it/s]warmup should be done:  75%|███████▍  | 2244/3000 [00:01<00:00, 1705.69it/s]warmup should be done:  84%|████████▎ | 2506/3000 [00:01<00:00, 1794.60it/s]warmup should be done:  84%|████████▍ | 2525/3000 [00:01<00:00, 1820.48it/s]warmup should be done:  83%|████████▎ | 2500/3000 [00:01<00:00, 1736.00it/s]warmup should be done:  80%|████████  | 2415/3000 [00:01<00:00, 1702.82it/s]warmup should be done:  90%|████████▉ | 2686/3000 [00:01<00:00, 1795.29it/s]warmup should be done:  90%|█████████ | 2709/3000 [00:01<00:00, 1824.44it/s]warmup should be done:  89%|████████▉ | 2684/3000 [00:01<00:00, 1764.66it/s]warmup should be done:  86%|████████▌ | 2586/3000 [00:01<00:00, 1704.44it/s]warmup should be done:  96%|█████████▌| 2866/3000 [00:01<00:00, 1795.64it/s]warmup should be done:  96%|█████████▋| 2892/3000 [00:01<00:00, 1823.82it/s]warmup should be done:  96%|█████████▌| 2865/3000 [00:01<00:00, 1776.91it/s]warmup should be done:  92%|█████████▏| 2760/3000 [00:01<00:00, 1712.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1791.08it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1786.80it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1764.26it/s]warmup should be done:  98%|█████████▊| 2933/3000 [00:01<00:00, 1715.87it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1675.01it/s]2022-12-12 02:38:33.709673: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f192e267030 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:38:33.709738: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:38:37.445966: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:38:39.259102: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:38:41.029975: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:38:47.578894: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f192ea68520 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:38:47.578960: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:38:48.866095: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f192e263bf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:38:48.866158: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:38:49.167814: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:38:50.309593: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:38:50.465547: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:38:51.056655: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f192e26b800 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:38:51.056720: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:38:51.602726: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:38:51.756969: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:38:53.009726: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:38:53.905439: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:38:55.555860: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:38:57.285650: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][02:39:25.453][ERROR][RK0][tid #139746407864064]: replica 1 reaches 1000, calling init pre replica
[HCTR][02:39:25.453][ERROR][RK0][tid #139746407864064]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:39:25.459][ERROR][RK0][tid #139746407864064]: coll ps creation done
[HCTR][02:39:25.459][ERROR][RK0][tid #139746407864064]: replica 1 waits for coll ps creation barrier
[HCTR][02:39:25.504][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][02:39:25.504][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:39:25.508][ERROR][RK0][main]: coll ps creation done
[HCTR][02:39:25.508][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][02:39:25.597][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][02:39:25.597][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:39:25.605][ERROR][RK0][main]: coll ps creation done
[HCTR][02:39:25.605][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][02:39:25.628][ERROR][RK0][tid #139746399471360]: replica 3 reaches 1000, calling init pre replica
[HCTR][02:39:25.628][ERROR][RK0][tid #139746399471360]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:39:25.635][ERROR][RK0][tid #139746399471360]: coll ps creation done
[HCTR][02:39:25.635][ERROR][RK0][tid #139746399471360]: replica 3 waits for coll ps creation barrier
[HCTR][02:39:25.635][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][02:39:26.990][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][02:39:27.042][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][02:39:27.042][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][02:39:27.042][ERROR][RK0][tid #139746399471360]: replica 3 calling init per replica
[HCTR][02:39:27.042][ERROR][RK0][tid #139746407864064]: replica 1 calling init per replica
[HCTR][02:39:27.042][ERROR][RK0][main]: Calling build_v2
[HCTR][02:39:27.042][ERROR][RK0][main]: Calling build_v2
[HCTR][02:39:27.042][ERROR][RK0][tid #139746399471360]: Calling build_v2
[HCTR][02:39:27.042][ERROR][RK0][tid #139746407864064]: Calling build_v2
[HCTR][02:39:27.042][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:39:27.042][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:39:27.042][ERROR][RK0][tid #139746407864064]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:39:27.042][ERROR][RK0][tid #139746399471360]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[[2022-12-12 02:39:27.2022-12-12 02:39:27 429022022-12-12 02:39:27.: 2022-12-12 02:39:27. 42913E. 42907:   42907: E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: E :E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136 /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:] /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136using concurrent impl MPS:136] 
136] using concurrent impl MPS] using concurrent impl MPS
using concurrent impl MPS

[2022-12-12 02:39:27. 44218: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-12 02:39:27. 44244: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] [assigning 8 to cpu2022-12-12 02:39:27
.[ 442702022-12-12 02:39:27[: .2022-12-12 02:39:27E 44280[. : 2022-12-12 02:39:27 44295/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE.: :  44321E196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:  ] :E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpu212 :
] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc196build symm link desc with 4X Tesla V100-SXM2-16GB out of 4:] 
212assigning 8 to cpu] 
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[
2022-12-12 02:39:27[.2022-12-12 02:39:27 44447.[:  444602022-12-12 02:39:27E: .[ E 444732022-12-12 02:39:27/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc : .:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE 44480212: : ] 213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccEbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4] : 
remote time is 8.68421213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
] :[remote time is 8.68421212[2022-12-12 02:39:27
] 2022-12-12 02:39:27.build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[. 44607
2022-12-12 02:39:27 44615: .[: E 446392022-12-12 02:39:27E : . /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE 44668/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: : :213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE214] : ] remote time is 8.68421214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30
] :
cpu time is 30213[
] 2022-12-12 02:39:27remote time is 8.68421.
 44797: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-12 02:39:27:.214 44826] : cpu time is 30E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 02:39:52.515819: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 02:39:52.581476: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 02:39:52.581586: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 02:39:52.582719: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 02:39:52.723418: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 02:39:53.110747: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 02:39:53.110899: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 02:40:00.605407: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 02:40:00.605637: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 02:40:02.334811: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 02:40:02.334907: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 02:40:02.380354: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 02:40:02.380439: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 02:40:03.406043: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 02:40:03.423483: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 02:40:03.424808: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 02:40:03.434584: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 02:40:03.529807: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 02:40:06.676155: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 02:40:06.682007: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 02:40:06.682398: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 02:40:06.696732: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 02:40:06.696816: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 02:40:06.696849: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 02:40:06.696966: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 02:40:06.697806: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:40:06.697858: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:40:06.699119: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:40:06.699697: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:40:06.718420: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 02:40:06.718535: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 02:40:06.718677: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-12 02:40:06.718757: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-12 02:40:06.719258: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:40:06.719313: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:40:06.719408: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:40:06.719460: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:40:06.720658: E[ 2022-12-12 02:40:06/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:7206721980: ] Eeager alloc mem 381.47 MB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:40:06.721708: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-12 02:40:06eager alloc mem 381.47 MB.
721735: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:40:06.724182: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-12 02:40:06.724309: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-12 02:40:06.725165: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:40:06.725225: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:40:06.726273: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:40:06.726902: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:40:06.761131: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 02:40:06.763383: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 02:40:06.763634: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:40:06.765145: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:40:06.766178: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:40:06.767324: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:06.767413: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 68.56 MB
[2022-12-12 02:40:06.795255: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 02:40:06.797106: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 02:40:06.797154: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:40:06.797945: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:40:06.798420: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:40:06.799416: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:06.799459: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 68.58 MB
[2022-12-12 02:40:06.813621: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 02:40:06.815472: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 02:40:06.815527: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:40:06.816309: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:40:06.816932: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:40:06.817926: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:06.817970: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 68.64 MB
[2022-12-12 02:40:06.834547: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 02:40:06.836345: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 02:40:06.836395: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:40:06.837157: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:40:06.837605: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:40:06.838585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:06.838629: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 68.63 MB
[2022-12-12 02:40:06.843598: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:40:06.844219: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:40:06.844265: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.57 GB
[2022-12-12 02:40:06.851059: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:40:06.851633: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:40:06.851673: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.58 GB
[2022-12-12 02:40:06.869937: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:40:06.870520: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:40:06.870564: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.58 GB
[2022-12-12 02:40:06.881655: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:40:06.882252: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:40:06.882304: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.58 GB
[[[2022-12-12 02:40:07[2022-12-12 02:40:072022-12-12 02:40:07.2022-12-12 02:40:07..688254.688251688255: 688271: : E: EE E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::1926:19261926] 1926] ] Device 2 init p2p of link 3] Device 0 init p2p of link 1Device 3 init p2p of link 0Device 1 init p2p of link 2



[2022-12-12 02:40:07.688608: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-12 02:40:07] .eager alloc mem 611.00 KB688625
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:40:07.688669: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB[
2022-12-12 02:40:07.688688: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:40:07.689434: [E2022-12-12 02:40:07 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc689446:: 638E]  eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-12 02:40:07.689498: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:07.689584: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:07.697040: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 02:40:07.697139: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:40:07.697178: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-12 02:40:07.697278: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-12 02:40:07:.1980697284] : eager alloc mem 611.00 KBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-12 02:40:07.697398: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB[
2022-12-12 02:40:07.697404: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 02:40:07.697574: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:40:07.697946: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:07.698090: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:07.698214: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:07.698444: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:07.705692: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 02:40:07.705782: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:40:07.705986: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 02:40:07.706072: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:40:07.706181: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 02:40:07.706264: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:40:07.706347: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 02:40:07.706444: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:40:07.706585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:07.706867: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:07.707074: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:07.707254: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:40:07.713575: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:40:07.713797: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:40:07.713912: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 17993724 / 100000000 nodes ( 17.99 %~18.00 %) | remote 33606598 / 100000000 nodes ( 33.61 %) | cpu 48399678 / 100000000 nodes ( 48.40 %) | 8.58 GB | 0.994465 secs 
[2022-12-12 02:40:07.714028: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:40:07.714060: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:40:07.714148: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 17971583 / 100000000 nodes ( 17.97 %~18.00 %) | remote 33628739 / 100000000 nodes ( 33.63 %) | cpu 48399678 / 100000000 nodes ( 48.40 %) | 8.57 GB | 1.0163 secs 
[2022-12-12 02:40:07.714487: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 17978962 / 100000000 nodes ( 17.98 %~18.00 %) | remote 33621360 / 100000000 nodes ( 33.62 %) | cpu 48399678 / 100000000 nodes ( 48.40 %) | 8.58 GB | 0.995184 secs 
[2022-12-12 02:40:07.714625: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 17991658 / 100000000 nodes ( 17.99 %~18.00 %) | remote 33608664 / 100000000 nodes ( 33.61 %) | cpu 48399678 / 100000000 nodes ( 48.40 %) | 8.58 GB | 0.98942 secs 
[2022-12-12 02:40:07.714746: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.60 GB
[2022-12-12 02:40:08.617906: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.85 GB
[2022-12-12 02:40:08.618033: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.85 GB
[2022-12-12 02:40:08.618266: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.85 GB
[2022-12-12 02:40:09.412534: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.10 GB
[2022-12-12 02:40:09.412659: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.10 GB
[2022-12-12 02:40:09.413162: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.10 GB
[2022-12-12 02:40:10.443696: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.34 GB
[2022-12-12 02:40:10.443873: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.34 GB
[2022-12-12 02:40:10.444406: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.34 GB
[2022-12-12 02:40:11.409912: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.75 GB
[2022-12-12 02:40:11.410029: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.75 GB
[2022-12-12 02:40:11.410358: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.75 GB
[2022-12-12 02:40:12.124539: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.94 GB
[2022-12-12 02:40:12.124677: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.94 GB
[HCTR][02:40:12.124][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][02:40:12.124][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][02:40:12.124][ERROR][RK0][tid #139746399471360]: replica 3 calling init per replica done, doing barrier
[HCTR][02:40:12.124][ERROR][RK0][tid #139746407864064]: replica 1 calling init per replica done, doing barrier
[HCTR][02:40:12.124][ERROR][RK0][tid #139746399471360]: replica 3 calling init per replica done, doing barrier done
[HCTR][02:40:12.124][ERROR][RK0][tid #139746407864064]: replica 1 calling init per replica done, doing barrier done
[HCTR][02:40:12.124][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][02:40:12.124][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][02:40:12.124][ERROR][RK0][tid #139746399471360]: init per replica done
[HCTR][02:40:12.124][ERROR][RK0][tid #139746407864064]: init per replica done
[HCTR][02:40:12.124][ERROR][RK0][main]: init per replica done
[HCTR][02:40:12.132][ERROR][RK0][tid #139746399471360]: 3 allocated 3276800 at 0x7f071d920000
[HCTR][02:40:12.132][ERROR][RK0][tid #139746399471360]: 3 allocated 6553600 at 0x7f0722600000
[HCTR][02:40:12.132][ERROR][RK0][tid #139746399471360]: 3 allocated 3276800 at 0x7f0722c40000
[HCTR][02:40:12.132][ERROR][RK0][tid #139746399471360]: 3 allocated 6553600 at 0x7f0722f60000
[HCTR][02:40:12.132][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f071d920000
[HCTR][02:40:12.132][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f0722600000
[HCTR][02:40:12.132][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f0722c40000
[HCTR][02:40:12.132][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f0722f60000
[HCTR][02:40:12.133][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f0721920000
[HCTR][02:40:12.133][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f0726600000
[HCTR][02:40:12.133][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f0726c40000
[HCTR][02:40:12.133][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f0726f60000
[HCTR][02:40:12.201][ERROR][RK0][main]: init per replica done
[HCTR][02:40:12.212][ERROR][RK0][tid #139746399471360]: 0 allocated 3276800 at 0x7f1ab6d20000
[HCTR][02:40:12.212][ERROR][RK0][tid #139746399471360]: 0 allocated 6553600 at 0x7f1ab7200000
[HCTR][02:40:12.212][ERROR][RK0][tid #139746399471360]: 0 allocated 3276800 at 0x7f00a250e800
[HCTR][02:40:12.212][ERROR][RK0][tid #139746399471360]: 0 allocated 6553600 at 0x7f00a282e800




