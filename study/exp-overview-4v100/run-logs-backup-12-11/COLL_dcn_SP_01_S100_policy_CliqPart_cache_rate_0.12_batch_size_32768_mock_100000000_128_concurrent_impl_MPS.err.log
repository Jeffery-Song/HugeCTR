2022-12-12 00:25:36.551300: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:25:36.555355: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:25:36.639836: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:25:36.641615: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:25:37.470388: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:25:37.470472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 00:25:37.482983: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:25:37.483062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 00:25:37.483529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 00:25:37.498697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 00:25:37.506194: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:25:37.506280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 00:25:37.510597: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:25:37.510676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 00:25:37.512557: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:25:37.512685: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:25:37.513589: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 00:25:37.518731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 00:25:37.522559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 00:25:37.531462: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:25:37.531630: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:25:37.533252: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 00:25:37.549430: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:25:37.549583: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:25:37.550364: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 00:25:37.558265: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:25:37.558553: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:25:37.560081: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][00:25:38.792][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:25:38.808][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:25:38.834][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:25:38.844][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.55s/it]warmup run: 83it [00:01, 69.60it/s]warmup run: 194it [00:01, 181.17it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 304it [00:01, 303.20it/s]warmup run: 98it [00:01, 89.90it/s]warmup run: 412it [00:01, 426.91it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 203it [00:01, 201.40it/s]warmup run: 519it [00:02, 546.06it/s]warmup run: 110it [00:01, 99.05it/s]warmup run: 308it [00:01, 321.95it/s]warmup run: 627it [00:02, 657.27it/s]warmup run: 221it [00:01, 214.39it/s]warmup run: 414it [00:01, 446.33it/s]warmup run: 734it [00:02, 752.25it/s]warmup run: 327it [00:01, 332.76it/s]warmup run: 521it [00:01, 566.57it/s]warmup run: 838it [00:02, 821.75it/s]warmup run: 430it [00:01, 448.44it/s]warmup run: 630it [00:02, 680.07it/s]warmup run: 947it [00:02, 890.24it/s]warmup run: 537it [00:01, 567.27it/s]warmup run: 740it [00:02, 777.96it/s]warmup run: 1056it [00:02, 942.54it/s]warmup run: 645it [00:02, 676.99it/s]warmup run: 850it [00:02, 858.21it/s]warmup run: 1164it [00:02, 980.75it/s]warmup run: 752it [00:02, 767.96it/s]warmup run: 960it [00:02, 920.25it/s]warmup run: 1272it [00:02, 1007.32it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 860it [00:02, 844.42it/s]warmup run: 1069it [00:02, 966.33it/s]warmup run: 1379it [00:02, 1023.29it/s]warmup run: 100it [00:01, 91.49it/s]warmup run: 966it [00:02, 899.18it/s]warmup run: 1178it [00:02, 1000.37it/s]warmup run: 1486it [00:02, 1016.27it/s]warmup run: 208it [00:01, 206.00it/s]warmup run: 1076it [00:02, 952.29it/s]warmup run: 1288it [00:02, 1026.80it/s]warmup run: 1591it [00:03, 1020.44it/s]warmup run: 317it [00:01, 331.22it/s]warmup run: 1189it [00:02, 1000.36it/s]warmup run: 1398it [00:02, 1046.62it/s]warmup run: 1696it [00:03, 1027.78it/s]warmup run: 426it [00:01, 458.60it/s]warmup run: 1301it [00:02, 1033.85it/s]warmup run: 1508it [00:02, 1059.55it/s]warmup run: 1801it [00:03, 1025.50it/s]warmup run: 536it [00:01, 581.91it/s]warmup run: 1414it [00:02, 1061.08it/s]warmup run: 1617it [00:02, 1061.26it/s]warmup run: 1908it [00:03, 1038.08it/s]warmup run: 646it [00:02, 693.83it/s]warmup run: 1528it [00:02, 1080.33it/s]warmup run: 1726it [00:03, 1067.00it/s]warmup run: 2018it [00:03, 1055.68it/s]warmup run: 756it [00:02, 789.53it/s]warmup run: 1640it [00:02, 1091.92it/s]warmup run: 1835it [00:03, 1070.79it/s]warmup run: 2154it [00:03, 1144.51it/s]warmup run: 866it [00:02, 866.71it/s]warmup run: 1757it [00:03, 1112.89it/s]warmup run: 1944it [00:03, 1073.17it/s]warmup run: 2290it [00:03, 1208.21it/s]warmup run: 975it [00:02, 925.25it/s]warmup run: 1875it [00:03, 1130.92it/s]warmup run: 2064it [00:03, 1109.69it/s]warmup run: 2423it [00:03, 1244.36it/s]warmup run: 1083it [00:02, 967.60it/s]warmup run: 1990it [00:03, 1115.62it/s]warmup run: 2198it [00:03, 1177.57it/s]warmup run: 2558it [00:03, 1275.60it/s]warmup run: 1193it [00:02, 1004.52it/s]warmup run: 2121it [00:03, 1172.27it/s]warmup run: 2332it [00:03, 1225.86it/s]warmup run: 2694it [00:03, 1298.28it/s]warmup run: 1302it [00:02, 1026.05it/s]warmup run: 2254it [00:03, 1216.92it/s]warmup run: 2466it [00:03, 1259.71it/s]warmup run: 2829it [00:04, 1311.06it/s]warmup run: 1413it [00:02, 1048.14it/s]warmup run: 2389it [00:03, 1254.40it/s]warmup run: 2600it [00:03, 1280.78it/s]warmup run: 2962it [00:04, 1315.14it/s]warmup run: 3000it [00:04, 712.41it/s] warmup run: 1522it [00:02, 1033.91it/s]warmup run: 2515it [00:03, 1247.89it/s]warmup run: 2729it [00:03, 1270.07it/s]warmup run: 2641it [00:03, 1244.17it/s]warmup run: 1629it [00:02, 1008.29it/s]warmup run: 2857it [00:03, 1253.36it/s]warmup run: 2766it [00:03, 1241.33it/s]warmup run: 2983it [00:04, 1247.69it/s]warmup run: 1732it [00:03, 966.09it/s] warmup run: 3000it [00:04, 739.88it/s] warmup run: 2895it [00:03, 1255.74it/s]warmup run: 1831it [00:03, 970.80it/s]warmup run: 3000it [00:04, 740.91it/s] warmup run: 1941it [00:03, 1007.60it/s]warmup run: 2050it [00:03, 1031.12it/s]warmup run: 2176it [00:03, 1097.75it/s]warmup run: 2314it [00:03, 1179.76it/s]warmup run: 2444it [00:03, 1213.54it/s]warmup run: 2566it [00:03, 1197.67it/s]warmup run: 2702it [00:03, 1245.09it/s]warmup run: 2839it [00:03, 1279.92it/s]warmup run: 2977it [00:04, 1307.92it/s]warmup run: 3000it [00:04, 733.58it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 182/3000 [00:00<00:01, 1813.40it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1705.23it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1756.43it/s]warmup should be done:   5%|▌         | 160/3000 [00:00<00:01, 1598.67it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1826.52it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1786.16it/s]warmup should be done:  11%|█         | 337/3000 [00:00<00:01, 1696.44it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1773.70it/s]warmup should be done:  17%|█▋        | 516/3000 [00:00<00:01, 1738.22it/s]warmup should be done:  18%|█▊        | 532/3000 [00:00<00:01, 1760.17it/s]warmup should be done:  18%|█▊        | 536/3000 [00:00<00:01, 1761.44it/s]warmup should be done:  18%|█▊        | 549/3000 [00:00<00:01, 1778.11it/s]warmup should be done:  23%|██▎       | 696/3000 [00:00<00:01, 1761.55it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1777.48it/s]warmup should be done:  24%|██▍       | 717/3000 [00:00<00:01, 1777.49it/s]warmup should be done:  24%|██▍       | 733/3000 [00:00<00:01, 1800.92it/s]warmup should be done:  29%|██▉       | 876/3000 [00:00<00:01, 1773.36it/s]warmup should be done:  30%|██▉       | 893/3000 [00:00<00:01, 1782.17it/s]warmup should be done:  30%|██▉       | 895/3000 [00:00<00:01, 1777.87it/s]warmup should be done:  30%|███       | 915/3000 [00:00<00:01, 1807.55it/s]warmup should be done:  35%|███▌      | 1056/3000 [00:00<00:01, 1781.57it/s]warmup should be done:  36%|███▌      | 1072/3000 [00:00<00:01, 1783.31it/s]warmup should be done:  36%|███▌      | 1073/3000 [00:00<00:01, 1776.17it/s]warmup should be done:  37%|███▋      | 1096/3000 [00:00<00:01, 1773.19it/s]warmup should be done:  41%|████      | 1236/3000 [00:00<00:00, 1787.03it/s]warmup should be done:  42%|████▏     | 1252/3000 [00:00<00:00, 1786.00it/s]warmup should be done:  42%|████▏     | 1252/3000 [00:00<00:00, 1778.71it/s]warmup should be done:  43%|████▎     | 1276/3000 [00:00<00:00, 1778.99it/s]warmup should be done:  47%|████▋     | 1415/3000 [00:00<00:00, 1777.73it/s]warmup should be done:  48%|████▊     | 1430/3000 [00:00<00:00, 1777.76it/s]warmup should be done:  48%|████▊     | 1431/3000 [00:00<00:00, 1781.85it/s]warmup should be done:  49%|████▊     | 1456/3000 [00:00<00:00, 1783.73it/s]warmup should be done:  53%|█████▎    | 1595/3000 [00:00<00:00, 1781.73it/s]warmup should be done:  54%|█████▎    | 1609/3000 [00:00<00:00, 1780.21it/s]warmup should be done:  54%|█████▎    | 1610/3000 [00:00<00:00, 1780.26it/s]warmup should be done:  55%|█████▍    | 1635/3000 [00:00<00:00, 1785.35it/s]warmup should be done:  59%|█████▉    | 1776/3000 [00:01<00:00, 1787.52it/s]warmup should be done:  60%|█████▉    | 1789/3000 [00:01<00:00, 1785.03it/s]warmup should be done:  60%|█████▉    | 1789/3000 [00:01<00:00, 1781.58it/s]warmup should be done:  60%|██████    | 1815/3000 [00:01<00:00, 1788.00it/s]warmup should be done:  65%|██████▌   | 1957/3000 [00:01<00:00, 1794.19it/s]warmup should be done:  66%|██████▌   | 1969/3000 [00:01<00:00, 1787.79it/s]warmup should be done:  66%|██████▌   | 1970/3000 [00:01<00:00, 1787.44it/s]warmup should be done:  66%|██████▋   | 1994/3000 [00:01<00:00, 1763.76it/s]warmup should be done:  71%|███████▏  | 2138/3000 [00:01<00:00, 1796.22it/s]warmup should be done:  72%|███████▏  | 2148/3000 [00:01<00:00, 1786.41it/s]warmup should be done:  72%|███████▏  | 2149/3000 [00:01<00:00, 1783.10it/s]warmup should be done:  72%|███████▏  | 2171/3000 [00:01<00:00, 1752.39it/s]warmup should be done:  77%|███████▋  | 2318/3000 [00:01<00:00, 1797.09it/s]warmup should be done:  78%|███████▊  | 2329/3000 [00:01<00:00, 1786.87it/s]warmup should be done:  78%|███████▊  | 2327/3000 [00:01<00:00, 1761.94it/s]warmup should be done:  78%|███████▊  | 2352/3000 [00:01<00:00, 1768.63it/s]warmup should be done:  83%|████████▎ | 2498/3000 [00:01<00:00, 1796.78it/s]warmup should be done:  84%|████████▎ | 2509/3000 [00:01<00:00, 1788.79it/s]warmup should be done:  83%|████████▎ | 2504/3000 [00:01<00:00, 1724.30it/s]warmup should be done:  84%|████████▍ | 2534/3000 [00:01<00:00, 1783.69it/s]warmup should be done:  90%|████████▉ | 2689/3000 [00:01<00:00, 1791.89it/s]warmup should be done:  89%|████████▉ | 2678/3000 [00:01<00:00, 1772.68it/s]warmup should be done:  90%|█████████ | 2715/3000 [00:01<00:00, 1790.67it/s]warmup should be done:  89%|████████▉ | 2677/3000 [00:01<00:00, 1714.42it/s]warmup should be done:  96%|█████████▌| 2869/3000 [00:01<00:00, 1792.31it/s]warmup should be done:  96%|█████████▌| 2865/3000 [00:01<00:00, 1799.96it/s]warmup should be done:  97%|█████████▋| 2896/3000 [00:01<00:00, 1796.05it/s]warmup should be done:  95%|█████████▍| 2849/3000 [00:01<00:00, 1713.32it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1786.35it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1783.76it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1783.35it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1755.40it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1757.38it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1776.27it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1752.76it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1749.79it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1768.62it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1802.56it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1790.25it/s]warmup should be done:  12%|█▏        | 363/3000 [00:00<00:01, 1814.57it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1818.98it/s]warmup should be done:  18%|█▊        | 532/3000 [00:00<00:01, 1769.61it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1797.18it/s]warmup should be done:  18%|█▊        | 548/3000 [00:00<00:01, 1827.44it/s]warmup should be done:  24%|██▍       | 728/3000 [00:00<00:01, 1829.80it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1787.47it/s]warmup should be done:  24%|██▍       | 731/3000 [00:00<00:01, 1804.61it/s]warmup should be done:  24%|██▍       | 719/3000 [00:00<00:01, 1764.67it/s]warmup should be done:  30%|███       | 914/3000 [00:00<00:01, 1838.69it/s]warmup should be done:  30%|██▉       | 898/3000 [00:00<00:01, 1805.18it/s]warmup should be done:  30%|███       | 904/3000 [00:00<00:01, 1792.68it/s]warmup should be done:  30%|███       | 912/3000 [00:00<00:01, 1768.18it/s]warmup should be done:  36%|███▌      | 1082/3000 [00:00<00:01, 1816.30it/s]warmup should be done:  37%|███▋      | 1098/3000 [00:00<00:01, 1823.79it/s]warmup should be done:  36%|███▋      | 1092/3000 [00:00<00:01, 1820.84it/s]warmup should be done:  36%|███▋      | 1089/3000 [00:00<00:01, 1752.69it/s]warmup should be done:  42%|████▏     | 1266/3000 [00:00<00:00, 1823.51it/s]warmup should be done:  43%|████▎     | 1278/3000 [00:00<00:00, 1831.35it/s]warmup should be done:  43%|████▎     | 1281/3000 [00:00<00:00, 1782.99it/s]warmup should be done:  43%|████▎     | 1279/3000 [00:00<00:00, 1797.58it/s]warmup should be done:  48%|████▊     | 1455/3000 [00:00<00:00, 1842.27it/s]warmup should be done:  49%|████▉     | 1466/3000 [00:00<00:00, 1845.74it/s]warmup should be done:  49%|████▉     | 1465/3000 [00:00<00:00, 1800.66it/s]warmup should be done:  49%|████▉     | 1466/3000 [00:00<00:00, 1817.35it/s]warmup should be done:  55%|█████▍    | 1644/3000 [00:00<00:00, 1855.66it/s]warmup should be done:  55%|█████▌    | 1655/3000 [00:00<00:00, 1857.48it/s]warmup should be done:  55%|█████▍    | 1649/3000 [00:00<00:00, 1811.75it/s]warmup should be done:  55%|█████▍    | 1648/3000 [00:00<00:00, 1789.80it/s]warmup should be done:  61%|██████    | 1833/3000 [00:01<00:00, 1863.47it/s]warmup should be done:  61%|██████    | 1831/3000 [00:01<00:00, 1805.70it/s]warmup should be done:  61%|██████▏   | 1841/3000 [00:01<00:00, 1820.43it/s]warmup should be done:  61%|██████    | 1828/3000 [00:01<00:00, 1785.11it/s]warmup should be done:  67%|██████▋   | 2021/3000 [00:01<00:00, 1867.21it/s]warmup should be done:  67%|██████▋   | 2015/3000 [00:01<00:00, 1815.38it/s]warmup should be done:  68%|██████▊   | 2027/3000 [00:01<00:00, 1832.29it/s]warmup should be done:  67%|██████▋   | 2013/3000 [00:01<00:00, 1801.83it/s]warmup should be done:  74%|███████▎  | 2209/3000 [00:01<00:00, 1869.70it/s]warmup should be done:  73%|███████▎  | 2200/3000 [00:01<00:00, 1824.46it/s]warmup should be done:  74%|███████▍  | 2213/3000 [00:01<00:00, 1838.68it/s]warmup should be done:  73%|███████▎  | 2194/3000 [00:01<00:00, 1735.30it/s]warmup should be done:  80%|███████▉  | 2397/3000 [00:01<00:00, 1870.98it/s]warmup should be done:  80%|███████▉  | 2385/3000 [00:01<00:00, 1830.46it/s]warmup should be done:  80%|███████▉  | 2399/3000 [00:01<00:00, 1844.34it/s]warmup should be done:  79%|███████▉  | 2370/3000 [00:01<00:00, 1740.17it/s]warmup should be done:  86%|████████▌ | 2585/3000 [00:01<00:00, 1858.49it/s]warmup should be done:  86%|████████▌ | 2586/3000 [00:01<00:00, 1849.61it/s]warmup should be done:  86%|████████▌ | 2569/3000 [00:01<00:00, 1822.93it/s]warmup should be done:  85%|████████▌ | 2555/3000 [00:01<00:00, 1772.46it/s]warmup should be done:  92%|█████████▏| 2771/3000 [00:01<00:00, 1839.25it/s]warmup should be done:  92%|█████████▏| 2773/3000 [00:01<00:00, 1853.80it/s]warmup should be done:  92%|█████████▏| 2754/3000 [00:01<00:00, 1829.96it/s]warmup should be done:  91%|█████████▏| 2743/3000 [00:01<00:00, 1802.87it/s]warmup should be done:  99%|█████████▊| 2960/3000 [00:01<00:00, 1855.68it/s]warmup should be done:  98%|█████████▊| 2940/3000 [00:01<00:00, 1836.38it/s]warmup should be done:  98%|█████████▊| 2955/3000 [00:01<00:00, 1767.28it/s]warmup should be done:  98%|█████████▊| 2927/3000 [00:01<00:00, 1812.00it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1832.04it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1820.01it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1820.08it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1790.34it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fb337b60280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fb337b600a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fb337b60160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fb337e22e80>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-12 00:26:49.534671: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7faf052673b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:26:49.534728: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:26:49.542577: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:26:50.326316: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:26:51.451223: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7faf05264850 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:26:51.451303: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:26:51.464215: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:26:51.502140: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7faf052678b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:26:51.502214: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:26:51.511182: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:26:51.571374: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7faf0526ec10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:26:51.571438: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:26:51.578680: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:26:52.282571: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:26:52.337827: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:26:52.380874: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:26:55.573205: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:26:57.597950: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:26:57.894865: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:26:58.520066: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][00:27:51.976][ERROR][RK0][tid #140389990262528]: replica 3 reaches 1000, calling init pre replica
[HCTR][00:27:51.976][ERROR][RK0][tid #140389990262528]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][00:27:51.979][ERROR][RK0][tid #140389990262528]: coll ps creation done
[HCTR][00:27:51.979][ERROR][RK0][tid #140389990262528]: replica 3 waits for coll ps creation barrier
[HCTR][00:27:52.164][ERROR][RK0][tid #140389990262528]: replica 1 reaches 1000, calling init pre replica
[HCTR][00:27:52.165][ERROR][RK0][tid #140389990262528]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][00:27:52.169][ERROR][RK0][tid #140389990262528]: coll ps creation done
[HCTR][00:27:52.169][ERROR][RK0][tid #140389990262528]: replica 1 waits for coll ps creation barrier
[HCTR][00:27:52.175][ERROR][RK0][tid #140389990262528]: replica 2 reaches 1000, calling init pre replica
[HCTR][00:27:52.176][ERROR][RK0][tid #140389990262528]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][00:27:52.178][ERROR][RK0][tid #140389990262528]: coll ps creation done
[HCTR][00:27:52.178][ERROR][RK0][tid #140389990262528]: replica 2 waits for coll ps creation barrier
[HCTR][00:27:52.188][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][00:27:52.188][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][00:27:52.192][ERROR][RK0][main]: coll ps creation done
[HCTR][00:27:52.192][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][00:27:52.192][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][00:27:53.129][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][00:27:53.163][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][00:27:53.163][ERROR][RK0][tid #140389990262528]: replica 1 calling init per replica
[HCTR][00:27:53.163][ERROR][RK0][tid #140389990262528]: replica 2 calling init per replica
[HCTR][00:27:53.163][ERROR][RK0][tid #140389990262528]: replica 3 calling init per replica
[HCTR][00:27:53.163][ERROR][RK0][main]: Calling build_v2
[HCTR][00:27:53.163][ERROR][RK0][tid #140389990262528]: Calling build_v2
[HCTR][00:27:53.163][ERROR][RK0][tid #140389990262528]: Calling build_v2
[HCTR][00:27:53.163][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:27:53.163][ERROR][RK0][tid #140389990262528]: Calling build_v2
[HCTR][00:27:53.163][ERROR][RK0][tid #140389990262528]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:27:53.163][ERROR][RK0][tid #140389990262528]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:27:53.163][ERROR][RK0][tid #140389990262528]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[[2022-12-12 00:27:53.2022-12-12 00:27:532022-12-12 00:27:532022-12-12 00:27:53163158...: 163165163182163169E: : :  EEE/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc   :/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136:::] 136136136using concurrent impl MPS] ] ] 
using concurrent impl MPSusing concurrent impl MPSusing concurrent impl MPS


[2022-12-12 00:27:53.164466: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-12 00:27:53.164493: E[ 2022-12-12 00:27:53/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:164515196[: ] [2022-12-12 00:27:53Eassigning 8 to cpu2022-12-12 00:27:53. 
.164526/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc164536: :: E[196E 2022-12-12 00:27:53]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.assigning 8 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:164590
:212: 196] E] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4 assigning 8 to cpu
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[
[:2022-12-12 00:27:532022-12-12 00:27:53212..] [164678164702build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-12 00:27:53: : 
.EE164724  : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE:2022-12-12 00:27:53: 212.213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] 164785] :build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: remote time is 8.68421212
E
]  build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[
:[2022-12-12 00:27:532132022-12-12 00:27:53.[] .1648712022-12-12 00:27:53remote time is 8.68421164873: .
: E164891E[ :  2022-12-12 00:27:53/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.: :164940213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214: ] :] Eremote time is 8.68421213cpu time is 30 
] 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421[:
2022-12-12 00:27:53214.] 165037[cpu time is 30: 2022-12-12 00:27:53
E. 165057/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E214 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30:
214] cpu time is 30
[2022-12-12 00:28:16.945609: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 00:28:17. 18068: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-12 00:28:17.174421: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 00:28:17.174555: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 00:28:17.174639: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 00:28:17.174715: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 00:28:17.179306: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:28:17.179462: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:28:17.181441: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:28:17.182866: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-12 00:28:172022-12-12 00:28:17..200907200907: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc::202202] ] 1 solved2 solved

[[2022-12-12 00:28:172022-12-12 00:28:17..200998201000: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc::205205] ] worker 0 thread 1 initing device 1worker 0 thread 2 initing device 2

[2022-12-12 00:28:17.201242: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[18152022-12-12 00:28:17] .Building Coll Cache with ... num gpu device is 4201257
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:28:17.201298: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-12 00:28:17eager alloc mem 381.47 MB.
201315: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:28:17.202549: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:28:17.202581: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:28:17.202666: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 00:28:17.202741: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 00:28:17.203570: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-12 00:28:17
.203594: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:28:17.204138: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:28:17.204213: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:28:17.205292: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:28:17.205892: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:28:17.278066: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 00:28:17.279994: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 00:28:17.280050: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:28:17.280880: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:28:17.281424: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:28:17.282411: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:28:17.282455: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.78 MB
[2022-12-12 00:28:17.304014: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 00:28:17.304079: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 00:28:17.305313: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:28:17.305778: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 00:28:17.305825: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:2022-12-12 00:28:17638.] 305837eager release cuda mem 400000000: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 00:28:17.305893: [E2022-12-12 00:28:17 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc305899:: 638E]  eager release cuda mem 400000000/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 25855
[2022-12-12 00:28:17.305958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[2022-12-12 00:28:17.317788: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:28:17.318275: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:28:17.318968: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:28:17.319000: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:28:17.319935: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:28:17.319997: W [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc2022-12-12 00:28:17:.43320006] : WORKER[0] alloc host memory 45.78 MBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:28:17.320065: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.78 MB
[2022-12-12 00:28:17.326180: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 00:28:17.328033: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 00:28:17.328097: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:28:17.328908: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:28:17.329447: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:28:17.330414: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:28:17.330459: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.78 MB
[2022-12-12 00:28:17.343000: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:28:17.343197: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:28:17.343611: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:28:17.343656: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[2022-12-12 00:28:17.343775: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:28:17.343817: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[2022-12-12 00:28:17.352939: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:28:17.353552: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:28:17.353593: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[[[[2022-12-12 00:28:172022-12-12 00:28:172022-12-12 00:28:172022-12-12 00:28:17....890182890181890182890194: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 1 init p2p of link 2Device 2 init p2p of link 3Device 0 init p2p of link 1Device 3 init p2p of link 0



[[2022-12-12 00:28:172022-12-12 00:28:17..890529890532: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 611.00 KB[eager alloc mem 611.00 KB
2022-12-12 00:28:17
.890573: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:28:17.890781: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-12 00:28:172022-12-12 00:28:17..891393891394: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] [eager release cuda mem 625663eager release cuda mem 6256632022-12-12 00:28:17

.891434: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:28:17.891630: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:28:17.899944: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] [Device 2 init p2p of link 02022-12-12 00:28:17
.899969: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-12 00:28:17.900021: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-12 00:28:17:.1926900049] : [Device 3 init p2p of link 1E2022-12-12 00:28:17
 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu900076:: 1980E]  eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-12 00:28:17.[9001592022-12-12 00:28:17: .E900177 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1926/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :Device 1 init p2p of link 31980
] eager alloc mem 611.00 KB
[2022-12-12 00:28:17.900324: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:28:17.[9009132022-12-12 00:28:17: .E900917 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 625663638
] eager release cuda mem 625663
[2022-12-12 00:28:17.901054: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:28:17.901143: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:28:17.910175: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 00:28:17.910258: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-12 00:28:17] .eager alloc mem 611.00 KB910267
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 00:28:17.910361: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:28:17.910433: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 00:28:17.910495: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 00:28:17.910551: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:28:17.910589: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:28:17.911075: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:28:17.911161: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:28:17.911363: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:28:17.911399: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:28:17.919302: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:28:17.919567: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:28:17.919611: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 11999999 / 100000000 nodes ( 12.00 %~12.00 %) | remote 35999997 / 100000000 nodes ( 36.00 %) | cpu 52000004 / 100000000 nodes ( 52.00 %) | 5.73 GB | 0.718324 secs 
[2022-12-12 00:28:17.919783: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:28:17.919847: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-12 00:28:17:.638919869] : eager release cuda mem 48399996E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 11999999 / 100000000 nodes ( 12.00 %~12.00 %) | remote 35999997 / 100000000 nodes ( 36.00 %) | cpu 52000004 / 100000000 nodes ( 52.00 %) | 5.73 GB | 0.74045 secs 
[2022-12-12 00:28:17.920115: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 11999999 / 100000000 nodes ( 12.00 %~12.00 %) | remote 35999997 / 100000000 nodes ( 36.00 %) | cpu 52000004 / 100000000 nodes ( 52.00 %) | 5.73 GB | 0.715931 secs 
[2022-12-12 00:28:17.920302: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 11999999 / 100000000 nodes ( 12.00 %~12.00 %) | remote 35999997 / 100000000 nodes ( 36.00 %) | cpu 52000004 / 100000000 nodes ( 52.00 %) | 5.73 GB | 0.719 secs 
[2022-12-12 00:28:17.920782: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.43 GB
[2022-12-12 00:28:18.860308: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.67 GB
[2022-12-12 00:28:18.860687: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.67 GB
[2022-12-12 00:28:18.861027: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.67 GB
[2022-12-12 00:28:19.706780: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.92 GB
[2022-12-12 00:28:19.706988: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.92 GB
[2022-12-12 00:28:19.707727: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.92 GB
[2022-12-12 00:28:20.531365: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.16 GB
[2022-12-12 00:28:20.531483: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.16 GB
[2022-12-12 00:28:20.531804: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.16 GB
[2022-12-12 00:28:21.308839: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.57 GB
[2022-12-12 00:28:21.308978: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.57 GB
[2022-12-12 00:28:21.309535: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.57 GB
[2022-12-12 00:28:22. 75195: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.76 GB
[2022-12-12 00:28:22. 75388: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.76 GB
[HCTR][00:28:22.474][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][00:28:22.474][ERROR][RK0][tid #140389990262528]: replica 2 calling init per replica done, doing barrier
[HCTR][00:28:22.474][ERROR][RK0][tid #140389990262528]: replica 1 calling init per replica done, doing barrier
[HCTR][00:28:22.474][ERROR][RK0][tid #140389990262528]: replica 3 calling init per replica done, doing barrier
[HCTR][00:28:22.474][ERROR][RK0][tid #140389990262528]: replica 2 calling init per replica done, doing barrier done
[HCTR][00:28:22.474][ERROR][RK0][tid #140389990262528]: replica 3 calling init per replica done, doing barrier done
[HCTR][00:28:22.474][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][00:28:22.474][ERROR][RK0][tid #140389990262528]: replica 1 calling init per replica done, doing barrier done
[HCTR][00:28:22.474][ERROR][RK0][tid #140389990262528]: init per replica done
[HCTR][00:28:22.475][ERROR][RK0][tid #140389990262528]: init per replica done
[HCTR][00:28:22.475][ERROR][RK0][tid #140389990262528]: init per replica done
[HCTR][00:28:22.477][ERROR][RK0][main]: init per replica done
[HCTR][00:28:22.509][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f9460238400
[HCTR][00:28:22.509][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f9460558400
[HCTR][00:28:22.509][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f9460b98400
[HCTR][00:28:22.509][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f9460eb8400
[HCTR][00:28:22.511][ERROR][RK0][tid #140389990262528]: 2 allocated 3276800 at 0x7f94cc238400
[HCTR][00:28:22.511][ERROR][RK0][tid #140389990262528]: 2 allocated 6553600 at 0x7f94cc558400
[HCTR][00:28:22.511][ERROR][RK0][tid #140389990262528]: 2 allocated 3276800 at 0x7f94ccb98400
[HCTR][00:28:22.511][ERROR][RK0][tid #140389990262528]: 2 allocated 6553600 at 0x7f94cceb8400
[HCTR][00:28:22.513][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f93c8238400
[HCTR][00:28:22.513][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f93c8558400
[HCTR][00:28:22.513][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f93c8b98400
[HCTR][00:28:22.513][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f93c8eb8400
[HCTR][00:28:22.513][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f93e8320000
[HCTR][00:28:22.513][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f93e8640000
[HCTR][00:28:22.513][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f93e8c80000
[HCTR][00:28:22.513][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f93e8fa0000
