2022-12-11 19:49:58.961910: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:49:59.023276: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:49:59.027670: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:49:59.028345: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:49:59.813795: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:49:59.813888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 19:49:59.827178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 19:49:59.857945: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:49:59.858100: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:49:59.860091: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 19:49:59.885726: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:49:59.885808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 19:49:59.886125: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:49:59.886153: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:49:59.886189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 19:49:59.886209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 19:49:59.899261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 19:49:59.899729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 19:49:59.901002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 19:49:59.928668: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:49:59.928823: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:49:59.929830: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:49:59.929942: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:49:59.930361: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 19:49:59.931461: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 19:49:59.932749: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:49:59.932936: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:49:59.935123: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][19:50:01.161][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:50:01.175][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:50:01.219][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:50:01.235][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1it [00:01,  1.47s/it]warmup run: 106it [00:01, 96.45it/s]warmup run: 109it [00:01, 96.48it/s]warmup run: 211it [00:01, 206.35it/s]warmup run: 219it [00:01, 209.19it/s]warmup run: 316it [00:01, 325.57it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 329it [00:01, 332.07it/s]warmup run: 418it [00:01, 442.08it/s]warmup run: 107it [00:01, 96.63it/s]warmup run: 440it [00:01, 460.30it/s]warmup run: 518it [00:01, 549.98it/s]warmup run: 213it [00:01, 206.93it/s]warmup run: 552it [00:01, 585.26it/s]warmup run: 615it [00:02, 634.84it/s]warmup run: 320it [00:01, 327.91it/s]warmup run: 665it [00:02, 700.37it/s]warmup run: 711it [00:02, 692.32it/s]warmup run: 427it [00:01, 451.79it/s]warmup run: 778it [00:02, 799.22it/s]warmup run: 811it [00:02, 766.70it/s]warmup run: 537it [00:01, 575.75it/s]warmup run: 889it [00:02, 876.11it/s]warmup run: 915it [00:02, 837.21it/s]warmup run: 648it [00:02, 690.70it/s]warmup run: 999it [00:02, 931.27it/s]warmup run: 1019it [00:02, 891.34it/s]warmup run: 757it [00:02, 783.35it/s]warmup run: 1110it [00:02, 978.25it/s]warmup run: 1124it [00:02, 935.45it/s]warmup run: 863it [00:02, 851.46it/s]warmup run: 1221it [00:02, 1012.96it/s]warmup run: 1229it [00:02, 967.81it/s]warmup run: 970it [00:02, 906.69it/s]warmup run: 1331it [00:02, 1017.77it/s]warmup run: 1332it [00:02, 984.77it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1076it [00:02, 948.53it/s]warmup run: 1439it [00:02, 1019.37it/s]warmup run: 1435it [00:02, 980.22it/s]warmup run: 96it [00:01, 87.39it/s]warmup run: 1182it [00:02, 974.85it/s]warmup run: 1545it [00:02, 981.08it/s] warmup run: 1536it [00:02, 981.98it/s]warmup run: 201it [00:01, 198.45it/s]warmup run: 1288it [00:02, 993.12it/s]warmup run: 1648it [00:03, 992.45it/s]warmup run: 299it [00:01, 308.44it/s]warmup run: 1637it [00:03, 896.35it/s]warmup run: 1393it [00:02, 1003.08it/s]warmup run: 1753it [00:03, 1006.14it/s]warmup run: 400it [00:01, 425.62it/s]warmup run: 1742it [00:03, 936.46it/s]warmup run: 1498it [00:02, 1013.31it/s]warmup run: 1857it [00:03, 1014.52it/s]warmup run: 507it [00:01, 549.81it/s]warmup run: 1848it [00:03, 970.35it/s]warmup run: 1603it [00:02, 1013.65it/s]warmup run: 1962it [00:03, 1023.53it/s]warmup run: 615it [00:02, 663.40it/s]warmup run: 1957it [00:03, 1002.19it/s]warmup run: 1708it [00:03, 1022.65it/s]warmup run: 2081it [00:03, 1070.18it/s]warmup run: 723it [00:02, 761.49it/s]warmup run: 2081it [00:03, 1070.75it/s]warmup run: 1815it [00:03, 1034.79it/s]warmup run: 2211it [00:03, 1136.69it/s]warmup run: 831it [00:02, 840.06it/s]warmup run: 2209it [00:03, 1128.51it/s]warmup run: 1920it [00:03, 1039.22it/s]warmup run: 2342it [00:03, 1185.38it/s]warmup run: 939it [00:02, 902.49it/s]warmup run: 2337it [00:03, 1170.76it/s]warmup run: 2031it [00:03, 1058.66it/s]warmup run: 2471it [00:03, 1215.83it/s]warmup run: 1047it [00:02, 950.89it/s]warmup run: 2461it [00:03, 1191.13it/s]warmup run: 2162it [00:03, 1130.84it/s]warmup run: 2600it [00:03, 1236.28it/s]warmup run: 1154it [00:02, 982.97it/s]warmup run: 2590it [00:03, 1218.45it/s]warmup run: 2291it [00:03, 1175.74it/s]warmup run: 2730it [00:03, 1253.93it/s]warmup run: 1261it [00:02, 1007.48it/s]warmup run: 2718it [00:03, 1235.64it/s]warmup run: 2418it [00:03, 1201.90it/s]warmup run: 2859it [00:04, 1263.67it/s]warmup run: 1369it [00:02, 1027.48it/s]warmup run: 2846it [00:04, 1246.80it/s]warmup run: 2547it [00:03, 1226.33it/s]warmup run: 2989it [00:04, 1272.47it/s]warmup run: 3000it [00:04, 727.22it/s] warmup run: 1476it [00:02, 1035.00it/s]warmup run: 2975it [00:04, 1256.83it/s]warmup run: 2678it [00:03, 1248.57it/s]warmup run: 3000it [00:04, 711.19it/s] warmup run: 1583it [00:02, 1045.21it/s]warmup run: 2808it [00:03, 1262.88it/s]warmup run: 1693it [00:03, 1059.63it/s]warmup run: 2941it [00:04, 1280.13it/s]warmup run: 3000it [00:04, 730.30it/s] warmup run: 1801it [00:03, 1065.04it/s]warmup run: 1909it [00:03, 1046.67it/s]warmup run: 2020it [00:03, 1063.74it/s]warmup run: 2156it [00:03, 1149.37it/s]warmup run: 2289it [00:03, 1202.72it/s]warmup run: 2425it [00:03, 1247.73it/s]warmup run: 2560it [00:03, 1277.84it/s]warmup run: 2696it [00:03, 1301.89it/s]warmup run: 2831it [00:03, 1313.46it/s]warmup run: 2967it [00:04, 1325.89it/s]warmup run: 3000it [00:04, 736.60it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1754.29it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1647.93it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1684.89it/s]warmup should be done:   5%|▌         | 158/3000 [00:00<00:01, 1572.36it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1782.45it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1711.20it/s]warmup should be done:  11%|█         | 334/3000 [00:00<00:01, 1681.89it/s]warmup should be done:  11%|█▏        | 339/3000 [00:00<00:01, 1696.48it/s]warmup should be done:  18%|█▊        | 536/3000 [00:00<00:01, 1783.27it/s]warmup should be done:  17%|█▋        | 507/3000 [00:00<00:01, 1700.82it/s]warmup should be done:  17%|█▋        | 511/3000 [00:00<00:01, 1704.37it/s]warmup should be done:  17%|█▋        | 514/3000 [00:00<00:01, 1686.89it/s]warmup should be done:  23%|██▎       | 681/3000 [00:00<00:01, 1715.25it/s]warmup should be done:  24%|██▍       | 717/3000 [00:00<00:01, 1790.37it/s]warmup should be done:  23%|██▎       | 684/3000 [00:00<00:01, 1714.10it/s]warmup should be done:  23%|██▎       | 683/3000 [00:00<00:01, 1676.68it/s]warmup should be done:  29%|██▊       | 856/3000 [00:00<00:01, 1714.98it/s]warmup should be done:  28%|██▊       | 853/3000 [00:00<00:01, 1710.32it/s]warmup should be done:  30%|██▉       | 897/3000 [00:00<00:01, 1786.03it/s]warmup should be done:  28%|██▊       | 851/3000 [00:00<00:01, 1668.19it/s]warmup should be done:  34%|███▍      | 1026/3000 [00:00<00:01, 1714.92it/s]warmup should be done:  34%|███▍      | 1028/3000 [00:00<00:01, 1710.28it/s]warmup should be done:  36%|███▌      | 1076/3000 [00:00<00:01, 1782.84it/s]warmup should be done:  34%|███▍      | 1018/3000 [00:00<00:01, 1659.44it/s]warmup should be done:  40%|████      | 1200/3000 [00:00<00:01, 1720.47it/s]warmup should be done:  42%|████▏     | 1256/3000 [00:00<00:00, 1787.73it/s]warmup should be done:  40%|████      | 1200/3000 [00:00<00:01, 1705.23it/s]warmup should be done:  40%|███▉      | 1193/3000 [00:00<00:01, 1686.33it/s]warmup should be done:  46%|████▌     | 1375/3000 [00:00<00:00, 1727.00it/s]warmup should be done:  48%|████▊     | 1437/3000 [00:00<00:00, 1792.01it/s]warmup should be done:  46%|████▌     | 1371/3000 [00:00<00:00, 1705.65it/s]warmup should be done:  46%|████▌     | 1370/3000 [00:00<00:00, 1709.90it/s]warmup should be done:  52%|█████▏    | 1548/3000 [00:00<00:00, 1723.06it/s]warmup should be done:  51%|█████▏    | 1543/3000 [00:00<00:00, 1708.58it/s]warmup should be done:  54%|█████▍    | 1617/3000 [00:00<00:00, 1789.04it/s]warmup should be done:  52%|█████▏    | 1546/3000 [00:00<00:00, 1723.91it/s]warmup should be done:  57%|█████▋    | 1715/3000 [00:01<00:00, 1710.80it/s]warmup should be done:  57%|█████▋    | 1721/3000 [00:01<00:00, 1721.83it/s]warmup should be done:  60%|█████▉    | 1797/3000 [00:01<00:00, 1789.70it/s]warmup should be done:  57%|█████▋    | 1723/3000 [00:01<00:00, 1735.49it/s]warmup should be done:  63%|██████▎   | 1887/3000 [00:01<00:00, 1712.28it/s]warmup should be done:  63%|██████▎   | 1895/3000 [00:01<00:00, 1727.04it/s]warmup should be done:  66%|██████▌   | 1976/3000 [00:01<00:00, 1780.33it/s]warmup should be done:  63%|██████▎   | 1899/3000 [00:01<00:00, 1742.93it/s]warmup should be done:  69%|██████▉   | 2070/3000 [00:01<00:00, 1732.02it/s]warmup should be done:  69%|██████▊   | 2059/3000 [00:01<00:00, 1710.33it/s]warmup should be done:  72%|███████▏  | 2156/3000 [00:01<00:00, 1783.33it/s]warmup should be done:  69%|██████▉   | 2075/3000 [00:01<00:00, 1747.60it/s]warmup should be done:  75%|███████▍  | 2246/3000 [00:01<00:00, 1740.01it/s]warmup should be done:  74%|███████▍  | 2231/3000 [00:01<00:00, 1710.82it/s]warmup should be done:  78%|███████▊  | 2335/3000 [00:01<00:00, 1781.98it/s]warmup should be done:  75%|███████▌  | 2251/3000 [00:01<00:00, 1750.86it/s]warmup should be done:  81%|████████  | 2421/3000 [00:01<00:00, 1740.67it/s]warmup should be done:  80%|████████  | 2405/3000 [00:01<00:00, 1716.65it/s]warmup should be done:  84%|████████▍ | 2514/3000 [00:01<00:00, 1783.35it/s]warmup should be done:  81%|████████  | 2428/3000 [00:01<00:00, 1755.86it/s]warmup should be done:  86%|████████▌ | 2579/3000 [00:01<00:00, 1723.23it/s]warmup should be done:  87%|████████▋ | 2596/3000 [00:01<00:00, 1736.20it/s]warmup should be done:  90%|████████▉ | 2694/3000 [00:01<00:00, 1786.25it/s]warmup should be done:  87%|████████▋ | 2605/3000 [00:01<00:00, 1759.77it/s]warmup should be done:  92%|█████████▏| 2752/3000 [00:01<00:00, 1723.14it/s]warmup should be done:  96%|█████████▌| 2873/3000 [00:01<00:00, 1784.27it/s]warmup should be done:  93%|█████████▎| 2783/3000 [00:01<00:00, 1764.39it/s]warmup should be done:  92%|█████████▏| 2770/3000 [00:01<00:00, 1686.29it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1784.87it/s]warmup should be done:  98%|█████████▊| 2925/3000 [00:01<00:00, 1724.21it/s]warmup should be done:  99%|█████████▊| 2962/3000 [00:01<00:00, 1770.01it/s]warmup should be done:  98%|█████████▊| 2950/3000 [00:01<00:00, 1717.44it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1730.66it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1717.91it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1713.38it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1779.93it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1796.75it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1738.68it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1765.54it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1776.51it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1790.78it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1801.50it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1639.63it/s]warmup should be done:  18%|█▊        | 540/3000 [00:00<00:01, 1808.16it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1774.28it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1810.84it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1694.61it/s]warmup should be done:  24%|██▍       | 723/3000 [00:00<00:01, 1816.34it/s]warmup should be done:  24%|██▎       | 712/3000 [00:00<00:01, 1776.15it/s]warmup should be done:  24%|██▍       | 726/3000 [00:00<00:01, 1814.60it/s]warmup should be done:  24%|██▍       | 717/3000 [00:00<00:01, 1732.26it/s]warmup should be done:  30%|███       | 907/3000 [00:00<00:01, 1823.52it/s]warmup should be done:  30%|██▉       | 891/3000 [00:00<00:01, 1777.53it/s]warmup should be done:  30%|███       | 908/3000 [00:00<00:01, 1816.22it/s]warmup should be done:  30%|██▉       | 893/3000 [00:00<00:01, 1740.82it/s]warmup should be done:  36%|███▋      | 1091/3000 [00:00<00:01, 1826.21it/s]warmup should be done:  36%|███▌      | 1071/3000 [00:00<00:01, 1781.85it/s]warmup should be done:  36%|███▋      | 1091/3000 [00:00<00:01, 1818.48it/s]warmup should be done:  36%|███▌      | 1074/3000 [00:00<00:01, 1763.33it/s]warmup should be done:  42%|████▏     | 1274/3000 [00:00<00:00, 1822.50it/s]warmup should be done:  42%|████▏     | 1273/3000 [00:00<00:00, 1815.19it/s]warmup should be done:  42%|████▏     | 1250/3000 [00:00<00:00, 1779.52it/s]warmup should be done:  42%|████▏     | 1251/3000 [00:00<00:00, 1752.78it/s]warmup should be done:  49%|████▊     | 1458/3000 [00:00<00:00, 1827.21it/s]warmup should be done:  49%|████▊     | 1456/3000 [00:00<00:00, 1818.49it/s]warmup should be done:  48%|████▊     | 1428/3000 [00:00<00:00, 1755.94it/s]warmup should be done:  48%|████▊     | 1430/3000 [00:00<00:00, 1764.16it/s]warmup should be done:  55%|█████▍    | 1643/3000 [00:00<00:00, 1832.25it/s]warmup should be done:  55%|█████▍    | 1639/3000 [00:00<00:00, 1820.42it/s]warmup should be done:  53%|█████▎    | 1604/3000 [00:00<00:00, 1753.84it/s]warmup should be done:  54%|█████▎    | 1610/3000 [00:00<00:00, 1773.92it/s]warmup should be done:  61%|██████    | 1828/3000 [00:01<00:00, 1834.99it/s]warmup should be done:  61%|██████    | 1822/3000 [00:01<00:00, 1820.30it/s]warmup should be done:  59%|█████▉    | 1780/3000 [00:01<00:00, 1750.38it/s]warmup should be done:  60%|█████▉    | 1789/3000 [00:01<00:00, 1776.29it/s]warmup should be done:  67%|██████▋   | 2012/3000 [00:01<00:00, 1830.38it/s]warmup should be done:  67%|██████▋   | 2005/3000 [00:01<00:00, 1818.80it/s]warmup should be done:  65%|██████▌   | 1956/3000 [00:01<00:00, 1753.27it/s]warmup should be done:  66%|██████▌   | 1969/3000 [00:01<00:00, 1781.54it/s]warmup should be done:  73%|███████▎  | 2196/3000 [00:01<00:00, 1831.39it/s]warmup should be done:  73%|███████▎  | 2187/3000 [00:01<00:00, 1817.33it/s]warmup should be done:  71%|███████   | 2134/3000 [00:01<00:00, 1760.99it/s]warmup should be done:  72%|███████▏  | 2149/3000 [00:01<00:00, 1784.82it/s]warmup should be done:  79%|███████▉  | 2370/3000 [00:01<00:00, 1818.31it/s]warmup should be done:  77%|███████▋  | 2313/3000 [00:01<00:00, 1767.66it/s]warmup should be done:  79%|███████▉  | 2380/3000 [00:01<00:00, 1806.81it/s]warmup should be done:  78%|███████▊  | 2328/3000 [00:01<00:00, 1784.01it/s]warmup should be done:  85%|████████▌ | 2554/3000 [00:01<00:00, 1823.54it/s]warmup should be done:  83%|████████▎ | 2492/3000 [00:01<00:00, 1772.08it/s]warmup should be done:  86%|████████▌ | 2566/3000 [00:01<00:00, 1821.12it/s]warmup should be done:  84%|████████▎ | 2508/3000 [00:01<00:00, 1788.76it/s]warmup should be done:  91%|█████████▏| 2738/3000 [00:01<00:00, 1827.31it/s]warmup should be done:  92%|█████████▏| 2751/3000 [00:01<00:00, 1828.35it/s]warmup should be done:  89%|████████▉ | 2671/3000 [00:01<00:00, 1774.72it/s]warmup should be done:  90%|████████▉ | 2687/3000 [00:01<00:00, 1775.09it/s]warmup should be done:  97%|█████████▋| 2923/3000 [00:01<00:00, 1831.31it/s]warmup should be done:  98%|█████████▊| 2936/3000 [00:01<00:00, 1834.03it/s]warmup should be done:  95%|█████████▍| 2849/3000 [00:01<00:00, 1775.82it/s]warmup should be done:  96%|█████████▌| 2866/3000 [00:01<00:00, 1777.46it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1823.57it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1820.12it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1769.94it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1764.58it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f4321501040>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f4321500190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f4321500280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f4321501160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 19:51:12.349349: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f3ef126b570 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:51:12.349412: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:51:12.358968: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:51:13.183442: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:51:14.163549: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f3efda64c50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:51:14.163646: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:51:14.173880: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:51:14.224365: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f3ef1267ec0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:51:14.224460: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:51:14.235021: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:51:14.260535: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f3ef126e6b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:51:14.260596: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:51:14.275924: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:51:14.910534: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:51:15.032051: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:51:15.143011: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:51:18.607841: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:51:20.282741: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:51:20.404172: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:51:21.480133: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][19:52:28.426][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][19:52:28.427][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:52:28.430][ERROR][RK0][main]: coll ps creation done
[HCTR][19:52:28.430][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][19:52:28.532][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][19:52:28.533][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:52:28.536][ERROR][RK0][main]: coll ps creation done
[HCTR][19:52:28.536][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][19:52:28.546][ERROR][RK0][tid #139908861638400]: replica 1 reaches 1000, calling init pre replica
[HCTR][19:52:28.547][ERROR][RK0][tid #139908861638400]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:52:28.549][ERROR][RK0][tid #139908861638400]: coll ps creation done
[HCTR][19:52:28.549][ERROR][RK0][tid #139908861638400]: replica 1 waits for coll ps creation barrier
[HCTR][19:52:28.703][ERROR][RK0][tid #139908794529536]: replica 2 reaches 1000, calling init pre replica
[HCTR][19:52:28.703][ERROR][RK0][tid #139908794529536]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:52:28.706][ERROR][RK0][tid #139908794529536]: coll ps creation done
[HCTR][19:52:28.706][ERROR][RK0][tid #139908794529536]: replica 2 waits for coll ps creation barrier
[HCTR][19:52:28.706][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][19:52:29.628][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][19:52:29.653][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][19:52:29.653][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][19:52:29.653][ERROR][RK0][tid #139908794529536]: replica 2 calling init per replica
[HCTR][19:52:29.653][ERROR][RK0][main]: Calling build_v2
[HCTR][19:52:29.653][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:52:29.653][ERROR][RK0][tid #139908794529536]: Calling build_v2
[HCTR][19:52:29.653][ERROR][RK0][tid #139908861638400]: replica 1 calling init per replica
[HCTR][19:52:29.654][ERROR][RK0][tid #139908794529536]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:52:29.654][ERROR][RK0][tid #139908861638400]: Calling build_v2
[HCTR][19:52:29.654][ERROR][RK0][main]: Calling build_v2
[HCTR][19:52:29.654][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:52:29.654][ERROR][RK0][tid #139908861638400]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 19:52:29.654046: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136[2022-12-11 19:52:29] .using concurrent impl MPSPhase2022-12-11 19:52:29654065
.: 654091E: [ E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc2022-12-11 19:52:29 :./hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136654116:] : 136using concurrent impl MPSPhaseE] 
 using concurrent impl MPSPhase/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc
:136] using concurrent impl MPSPhase
[2022-12-11 19:52:29.655051: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 19:52:29.655111: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 19:52:29.655161: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 19:52:29.655193: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 19:52:29.655244: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 19:52:29:.196655265] : [assigning 8 to cpuE2022-12-11 19:52:29
 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc655286:: 196E]  assigning 8 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
:[1962022-12-11 19:52:29] .assigning 8 to cpu655322
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 19:52:29.655368: E[ 2022-12-11 19:52:29/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:655381212: ] Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421[
2022-12-11 19:52:29.655424: [E[2022-12-11 19:52:29 2022-12-11 19:52:29./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.655422:655437: 213: E] E remote time is 8.68421 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::212[214] 2022-12-11 19:52:29] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4.cpu time is 30
655494
: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 19:52:29:.214655525] : cpu time is 30E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 19:52:29.655568: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 19:52:52.584862: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 19:52:52.649724: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 19:52:52.649825: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 19:52:52.651230: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 19:52:52.743064: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 19:52:53.112671: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 19:52:53.112807: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 19:52:58.989873: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 19:52:58.990033: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 19:53:00.820046: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 19:53:00.820152: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 19:53:00.823603: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 19:53:00.823659: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 19:53:00.853633: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 19:53:00.865902: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 19:53:00.866665: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 19:53:00.877098: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 19:53:00.978379: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 19:53:00.981155: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 19:53:00.983694: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 19:53:00.986118: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 19:53:00.988526: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 19:53:04.335672: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 19:53:04.344976: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 19:53:04.345188: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 19:53:04.356568: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 19:53:04.356655: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 19:53:04.356699: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 19:53:04.356742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 19:53:04.359298: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:53:04.359365: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:53:04.360452: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:53:04.361259: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:53:04.380489: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 19:53:04.380625: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[[2022-12-11 19:53:04.3809652022-12-11 19:53:04: .E380964 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 202/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :2022 solved] 
3 solved
[2022-12-11 19:53:04[.2022-12-11 19:53:04381080.: 381084E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc205:] 205worker 0 thread 2 initing device 2] 
worker 0 thread 3 initing device 3
[2022-12-11 19:53:04.381271: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:53:04.381331: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:53:04.381745: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:53:04.381794: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:53:04.381976: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:53:04.382030: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:53:04.383135: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:53:04.388733: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:53:04.389705: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:53:04.389773: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:53:04.389804: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:53:04.391334: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:53:04.467844: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 19:53:04.469866: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 19:53:04.469938: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:53:04.471049: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:53:04.471663: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:53:04.472627: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:53:04.474305: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:53:04.474991: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:53:04.475052: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 493.16 MB
[[2022-12-11 19:53:042022-12-11 19:53:04..489155489155: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-11 19:53:04.491003: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 19:53:04eager release cuda mem 1021.
491023: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 19:53:04.491066: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 19:53:04.eager release cuda mem 400000000491085
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:53:04.491566: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 19:53:04.491936: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:53:04.492425: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:53:04.492859: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:53:04.492931: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:53:04.493381: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 19:53:04.493434: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:53:04.493750: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:53:04.493844: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:53:04.494175: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:53:04.494617: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:53:04.495533: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:53:04.496576: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:53:04.496655: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:53:04.497216: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:53:04.497259: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 492.14 MB
[2022-12-11 19:53:04.497303: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:53:04.497345: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 492.19 MB
[2022-12-11 19:53:04.497371: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:53:04.498002: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:53:04.498043: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 492.84 MB
[[[2022-12-11 19:53:04[2022-12-11 19:53:042022-12-11 19:53:04.2022-12-11 19:53:04..541092.541092541097: 541094: : E: EE E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::1926:19261926] 1926] ] Device 1 init p2p of link 2] Device 3 init p2p of link 0Device 2 init p2p of link 3
Device 0 init p2p of link 1


[2022-12-11 19:53:04.541265[: [2022-12-11 19:53:04E2022-12-11 19:53:04. .541273/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu541274: :: E1980E ]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:
:2022-12-11 19:53:0419801980.] ] 541314eager alloc mem 611.00 KBeager alloc mem 611.00 KB: 

E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:53:04.542089: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:53:04.542114: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-11 19:53:04
[.2022-12-11 19:53:04542136.: 542142E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-11 19:53:04.543976: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 19:53:04.544039: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-11 19:53:041926.] 544062Device 1 init p2p of link 3: 
[E2022-12-11 19:53:04 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu544074:: 1980E]  eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1926] Device 3 init p2p of link 1
[[2022-12-11 19:53:042022-12-11 19:53:04..544134544143: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261980] ] Device 2 init p2p of link 0eager alloc mem 611.00 KB

[2022-12-11 19:53:04.544190: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:53:04.544252: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:53:04.544824: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:53:04.544978: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-11 19:53:04
.544998: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:53:04.545061: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:53:04.546301: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 19:53:04.546378: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:53:04.546799: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 19:53:04.546854: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[2022-12-11 19:53:04:2022-12-11 19:53:04.1926.546869] 546882: Device 2 init p2p of link 1: E
E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261980] ] Device 3 init p2p of link 2eager alloc mem 611.00 KB

[2022-12-11 19:53:04.546965: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:53:04.546994: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:53:04.547111: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:53:04.547718: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:53:04.547771: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:53:04.547803: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:53:04.547951: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:53:04.548901: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1000000 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2995241 / 100000000 nodes ( 3.00 %) | cpu 96004759 / 100000000 nodes ( 96.00 %) | 493.16 MB | 0.189544 secs 
[2022-12-11 19:53:04.549420: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 7.18 GB
[2022-12-11 19:53:04.549669: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:53:04.549860: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:53:04.549915: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:53:04.550215: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 997996 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2997245 / 100000000 nodes ( 3.00 %) | cpu 96004759 / 100000000 nodes ( 96.00 %) | 492.19 MB | 0.168907 secs 
[2022-12-11 19:53:04.550756: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 997903 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2997338 / 100000000 nodes ( 3.00 %) | cpu 96004759 / 100000000 nodes ( 96.00 %) | 492.14 MB | 0.168744 secs 
[2022-12-11 19:53:04.551154: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 999342 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2995899 / 100000000 nodes ( 3.00 %) | cpu 96004759 / 100000000 nodes ( 96.00 %) | 492.84 MB | 0.169374 secs 
[2022-12-11 19:53:05.775159: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 7.43 GB
[2022-12-11 19:53:05.775334: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 7.43 GB
[2022-12-11 19:53:05.775617: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 7.43 GB
[2022-12-11 19:53:06.549095: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 7.67 GB
[2022-12-11 19:53:06.549350: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 7.67 GB
[2022-12-11 19:53:06.549686: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 7.67 GB
[2022-12-11 19:53:07.428407: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 7.92 GB
[2022-12-11 19:53:07.428540: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 7.92 GB
[2022-12-11 19:53:07.429009: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 7.92 GB
[2022-12-11 19:53:07.429337: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 7.92 GB
[2022-12-11 19:53:07.429657: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 7.92 GB
[2022-12-11 19:53:08. 71656: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 8.11 GB
[2022-12-11 19:53:08. 71778: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 8.11 GB
[HCTR][19:53:08.163][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][19:53:08.163][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][19:53:08.163][ERROR][RK0][tid #139908861638400]: replica 1 calling init per replica done, doing barrier
[HCTR][19:53:08.163][ERROR][RK0][tid #139908794529536]: replica 2 calling init per replica done, doing barrier
[HCTR][19:53:08.163][ERROR][RK0][tid #139908794529536]: replica 2 calling init per replica done, doing barrier done
[HCTR][19:53:08.163][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][19:53:08.163][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][19:53:08.163][ERROR][RK0][tid #139908861638400]: replica 1 calling init per replica done, doing barrier done
[HCTR][19:53:08.163][ERROR][RK0][main]: init per replica done
[HCTR][19:53:08.163][ERROR][RK0][tid #139908861638400]: init per replica done
[HCTR][19:53:08.163][ERROR][RK0][tid #139908794529536]: init per replica done
[HCTR][19:53:08.165][ERROR][RK0][main]: init per replica done
[HCTR][19:53:08.202][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f25d8320000
[HCTR][19:53:08.202][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f25d8640000
[HCTR][19:53:08.202][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f25d8c80000
[HCTR][19:53:08.202][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f25d8fa0000
[HCTR][19:53:08.203][ERROR][RK0][tid #139908861638400]: 1 allocated 3276800 at 0x7f25cc238400
[HCTR][19:53:08.203][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f2614238400
[HCTR][19:53:08.203][ERROR][RK0][tid #139908861638400]: 1 allocated 6553600 at 0x7f25cc558400
[HCTR][19:53:08.203][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f2614558400
[HCTR][19:53:08.203][ERROR][RK0][tid #139908861638400]: 1 allocated 3276800 at 0x7f25ccb98400
[HCTR][19:53:08.203][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f2614b98400
[HCTR][19:53:08.203][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f2614eb8400
[HCTR][19:53:08.203][ERROR][RK0][tid #139908861638400]: 1 allocated 6553600 at 0x7f25cceb8400
[HCTR][19:53:08.203][ERROR][RK0][tid #139908794529536]: 2 allocated 3276800 at 0x7f2530238400
[HCTR][19:53:08.203][ERROR][RK0][tid #139908794529536]: 2 allocated 6553600 at 0x7f2530558400
[HCTR][19:53:08.203][ERROR][RK0][tid #139908794529536]: 2 allocated 3276800 at 0x7f2530b98400
[HCTR][19:53:08.203][ERROR][RK0][tid #139908794529536]: 2 allocated 6553600 at 0x7f2530eb8400
