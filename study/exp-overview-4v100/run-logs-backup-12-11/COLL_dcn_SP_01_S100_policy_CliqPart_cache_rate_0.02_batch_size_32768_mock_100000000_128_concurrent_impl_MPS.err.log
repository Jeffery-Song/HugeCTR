2022-12-11 20:21:31.734046: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:21:31.803763: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:21:31.803861: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:21:31.803920: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:21:32.574518: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:21:32.574596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 20:21:32.587488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 20:21:32.623743: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:21:32.623922: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:21:32.624841: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 20:21:32.659192: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:21:32.659243: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:21:32.659261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 20:21:32.659296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 20:21:32.665962: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:21:32.666035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 20:21:32.671779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 20:21:32.674117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 20:21:32.677978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 20:21:32.705666: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:21:32.705887: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:21:32.707710: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 20:21:32.708964: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:21:32.709091: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:21:32.710138: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 20:21:32.711237: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:21:32.711351: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:21:32.712034: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][20:21:34.848][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:21:34.850][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:21:34.867][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:21:34.891][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 1it [00:01,  1.44s/it]warmup run: 110it [00:01, 96.25it/s]warmup run: 95it [00:01, 85.58it/s]warmup run: 220it [00:01, 208.03it/s]warmup run: 199it [00:01, 194.71it/s]warmup run: 330it [00:01, 330.24it/s]warmup run: 303it [00:01, 313.07it/s]warmup run: 439it [00:01, 454.71it/s]warmup run: 408it [00:01, 435.41it/s]warmup run: 1it [00:01,  1.52s/it]warmup run: 545it [00:01, 568.81it/s]warmup run: 1it [00:01,  1.49s/it]warmup run: 511it [00:01, 548.75it/s]warmup run: 107it [00:01, 91.46it/s]warmup run: 652it [00:02, 674.52it/s]warmup run: 105it [00:01, 91.49it/s]warmup run: 619it [00:02, 661.96it/s]warmup run: 212it [00:01, 196.02it/s]warmup run: 758it [00:02, 763.10it/s]warmup run: 215it [00:01, 203.36it/s]warmup run: 727it [00:02, 758.61it/s]warmup run: 316it [00:01, 309.75it/s]warmup run: 864it [00:02, 835.98it/s]warmup run: 318it [00:01, 316.16it/s]warmup run: 834it [00:02, 836.69it/s]warmup run: 422it [00:01, 430.32it/s]warmup run: 970it [00:02, 893.40it/s]warmup run: 412it [00:01, 417.32it/s]warmup run: 938it [00:02, 861.14it/s]warmup run: 520it [00:02, 532.63it/s]warmup run: 1077it [00:02, 939.96it/s]warmup run: 512it [00:01, 526.96it/s]warmup run: 1045it [00:02, 915.06it/s]warmup run: 628it [00:02, 647.03it/s]warmup run: 1185it [00:02, 977.44it/s]warmup run: 614it [00:02, 630.61it/s]warmup run: 1148it [00:02, 944.86it/s]warmup run: 736it [00:02, 746.34it/s]warmup run: 1291it [00:02, 1000.53it/s]warmup run: 721it [00:02, 731.75it/s]warmup run: 1251it [00:02, 964.77it/s]warmup run: 844it [00:02, 828.53it/s]warmup run: 1398it [00:02, 1019.38it/s]warmup run: 827it [00:02, 812.76it/s]warmup run: 1356it [00:02, 989.05it/s]warmup run: 952it [00:02, 892.43it/s]warmup run: 1507it [00:02, 1037.08it/s]warmup run: 934it [00:02, 878.03it/s]warmup run: 1462it [00:02, 1009.13it/s]warmup run: 1058it [00:02, 937.23it/s]warmup run: 1614it [00:02, 1044.57it/s]warmup run: 1040it [00:02, 925.72it/s]warmup run: 1568it [00:02, 1022.55it/s]warmup run: 1721it [00:03, 1051.59it/s]warmup run: 1164it [00:02, 928.63it/s]warmup run: 1148it [00:02, 967.03it/s]warmup run: 1673it [00:03, 1026.51it/s]warmup run: 1829it [00:03, 1058.18it/s]warmup run: 1273it [00:02, 972.49it/s]warmup run: 1254it [00:02, 991.45it/s]warmup run: 1779it [00:03, 1034.28it/s]warmup run: 1937it [00:03, 1063.86it/s]warmup run: 1385it [00:02, 1013.54it/s]warmup run: 1363it [00:02, 1017.19it/s]warmup run: 1884it [00:03, 1033.09it/s]warmup run: 2045it [00:03, 1045.18it/s]warmup run: 1497it [00:02, 1042.48it/s]warmup run: 1469it [00:02, 1027.07it/s]warmup run: 1988it [00:03, 1026.91it/s]warmup run: 2181it [00:03, 1136.43it/s]warmup run: 1605it [00:03, 993.22it/s] warmup run: 1575it [00:03, 1005.38it/s]warmup run: 2100it [00:03, 1054.36it/s]warmup run: 2317it [00:03, 1200.66it/s]warmup run: 1708it [00:03, 990.90it/s]warmup run: 1678it [00:03, 999.19it/s] warmup run: 2232it [00:03, 1132.43it/s]warmup run: 2452it [00:03, 1244.65it/s]warmup run: 1821it [00:03, 1028.17it/s]warmup run: 1780it [00:03, 995.29it/s]warmup run: 2364it [00:03, 1187.46it/s]warmup run: 2588it [00:03, 1278.13it/s]warmup run: 1934it [00:03, 1057.17it/s]warmup run: 1881it [00:03, 996.84it/s]warmup run: 2490it [00:03, 1207.52it/s]warmup run: 2724it [00:03, 1302.25it/s]warmup run: 2052it [00:03, 1091.07it/s]warmup run: 1982it [00:03, 999.90it/s]warmup run: 2625it [00:03, 1248.40it/s]warmup run: 2859it [00:04, 1315.71it/s]warmup run: 2186it [00:03, 1163.08it/s]warmup run: 2098it [00:03, 1045.29it/s]warmup run: 2752it [00:03, 1252.24it/s]warmup run: 2996it [00:04, 1329.16it/s]warmup run: 3000it [00:04, 729.29it/s] warmup run: 2320it [00:03, 1212.76it/s]warmup run: 2224it [00:03, 1108.37it/s]warmup run: 2886it [00:04, 1276.74it/s]warmup run: 2451it [00:03, 1240.89it/s]warmup run: 2350it [00:03, 1153.17it/s]warmup run: 3000it [00:04, 719.93it/s] warmup run: 2584it [00:03, 1265.42it/s]warmup run: 2476it [00:03, 1184.20it/s]warmup run: 2714it [00:03, 1273.20it/s]warmup run: 2602it [00:03, 1204.41it/s]warmup run: 2844it [00:04, 1279.26it/s]warmup run: 2728it [00:04, 1220.52it/s]warmup run: 2974it [00:04, 1284.95it/s]warmup run: 2851it [00:04, 1215.29it/s]warmup run: 3000it [00:04, 713.53it/s] warmup run: 2983it [00:04, 1245.87it/s]warmup run: 3000it [00:04, 706.69it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1773.60it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1688.20it/s]warmup should be done:   5%|▌         | 153/3000 [00:00<00:01, 1528.43it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1720.98it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1752.10it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1774.37it/s]warmup should be done:  11%|█         | 334/3000 [00:00<00:01, 1690.43it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1748.07it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1764.39it/s]warmup should be done:  18%|█▊        | 525/3000 [00:00<00:01, 1730.36it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1740.36it/s]warmup should be done:  17%|█▋        | 504/3000 [00:00<00:01, 1604.32it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1773.93it/s]warmup should be done:  23%|██▎       | 701/3000 [00:00<00:01, 1738.35it/s]warmup should be done:  24%|██▎       | 711/3000 [00:00<00:01, 1751.78it/s]warmup should be done:  23%|██▎       | 682/3000 [00:00<00:01, 1668.44it/s]warmup should be done:  29%|██▉       | 884/3000 [00:00<00:01, 1775.28it/s]warmup should be done:  29%|██▉       | 875/3000 [00:00<00:01, 1734.56it/s]warmup should be done:  30%|██▉       | 887/3000 [00:00<00:01, 1750.26it/s]warmup should be done:  29%|██▊       | 859/3000 [00:00<00:01, 1700.92it/s]warmup should be done:  35%|███▌      | 1062/3000 [00:00<00:01, 1775.21it/s]warmup should be done:  35%|███▍      | 1049/3000 [00:00<00:01, 1734.30it/s]warmup should be done:  35%|███▌      | 1063/3000 [00:00<00:01, 1750.81it/s]warmup should be done:  34%|███▍      | 1032/3000 [00:00<00:01, 1709.20it/s]warmup should be done:  41%|████▏     | 1240/3000 [00:00<00:00, 1771.38it/s]warmup should be done:  41%|████      | 1223/3000 [00:00<00:01, 1733.94it/s]warmup should be done:  41%|████▏     | 1240/3000 [00:00<00:01, 1753.90it/s]warmup should be done:  40%|████      | 1205/3000 [00:00<00:01, 1713.55it/s]warmup should be done:  47%|████▋     | 1398/3000 [00:00<00:00, 1737.84it/s]warmup should be done:  47%|████▋     | 1416/3000 [00:00<00:00, 1747.30it/s]warmup should be done:  47%|████▋     | 1418/3000 [00:00<00:00, 1727.63it/s]warmup should be done:  46%|████▌     | 1377/3000 [00:00<00:00, 1710.00it/s]warmup should be done:  52%|█████▏    | 1574/3000 [00:00<00:00, 1743.78it/s]warmup should be done:  53%|█████▎    | 1592/3000 [00:00<00:00, 1748.80it/s]warmup should be done:  53%|█████▎    | 1592/3000 [00:00<00:00, 1728.87it/s]warmup should be done:  52%|█████▏    | 1549/3000 [00:00<00:00, 1704.40it/s]warmup should be done:  58%|█████▊    | 1752/3000 [00:01<00:00, 1752.08it/s]warmup should be done:  59%|█████▉    | 1768/3000 [00:01<00:00, 1749.49it/s]warmup should be done:  59%|█████▉    | 1766/3000 [00:01<00:00, 1725.68it/s]warmup should be done:  57%|█████▋    | 1720/3000 [00:01<00:00, 1702.63it/s]warmup should be done:  64%|██████▍   | 1932/3000 [00:01<00:00, 1764.15it/s]warmup should be done:  65%|██████▍   | 1944/3000 [00:01<00:00, 1749.58it/s]warmup should be done:  65%|██████▍   | 1939/3000 [00:01<00:00, 1710.55it/s]warmup should be done:  63%|██████▎   | 1891/3000 [00:01<00:00, 1703.43it/s]warmup should be done:  70%|███████   | 2112/3000 [00:01<00:00, 1773.36it/s]warmup should be done:  71%|███████   | 2119/3000 [00:01<00:00, 1734.29it/s]warmup should be done:  70%|███████   | 2111/3000 [00:01<00:00, 1708.19it/s]warmup should be done:  69%|██████▉   | 2069/3000 [00:01<00:00, 1725.73it/s]warmup should be done:  76%|███████▋  | 2290/3000 [00:01<00:00, 1768.47it/s]warmup should be done:  76%|███████▋  | 2294/3000 [00:01<00:00, 1736.71it/s]warmup should be done:  76%|███████▌  | 2283/3000 [00:01<00:00, 1709.90it/s]warmup should be done:  75%|███████▍  | 2249/3000 [00:01<00:00, 1745.90it/s]warmup should be done:  82%|████████▏ | 2471/3000 [00:01<00:00, 1778.56it/s]warmup should be done:  82%|████████▏ | 2468/3000 [00:01<00:00, 1734.04it/s]warmup should be done:  82%|████████▏ | 2459/3000 [00:01<00:00, 1722.05it/s]warmup should be done:  81%|████████  | 2424/3000 [00:01<00:00, 1720.90it/s]warmup should be done:  88%|████████▊ | 2650/3000 [00:01<00:00, 1780.98it/s]warmup should be done:  88%|████████▊ | 2642/3000 [00:01<00:00, 1732.69it/s]warmup should be done:  88%|████████▊ | 2634/3000 [00:01<00:00, 1729.26it/s]warmup should be done:  87%|████████▋ | 2598/3000 [00:01<00:00, 1724.70it/s]warmup should be done:  94%|█████████▍| 2831/3000 [00:01<00:00, 1788.18it/s]warmup should be done:  94%|█████████▍| 2816/3000 [00:01<00:00, 1732.45it/s]warmup should be done:  94%|█████████▎| 2809/3000 [00:01<00:00, 1735.21it/s]warmup should be done:  92%|█████████▏| 2772/3000 [00:01<00:00, 1727.78it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1759.01it/s]warmup should be done: 100%|█████████▉| 2995/3000 [00:01<00:00, 1748.99it/s]warmup should be done: 100%|█████████▉| 2986/3000 [00:01<00:00, 1742.57it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1745.76it/s]warmup should be done:  98%|█████████▊| 2946/3000 [00:01<00:00, 1730.82it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1737.48it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1709.68it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 179/3000 [00:00<00:01, 1786.74it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1757.36it/s]warmup should be done:   5%|▍         | 141/3000 [00:00<00:02, 1403.41it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1742.33it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1786.11it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1781.45it/s]warmup should be done:  11%|█         | 327/3000 [00:00<00:01, 1667.20it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1744.82it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1815.87it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1781.00it/s]warmup should be done:  17%|█▋        | 511/3000 [00:00<00:01, 1741.94it/s]warmup should be done:  18%|█▊        | 529/3000 [00:00<00:01, 1762.14it/s]warmup should be done:  24%|██▍       | 717/3000 [00:00<00:01, 1786.59it/s]warmup should be done:  23%|██▎       | 696/3000 [00:00<00:01, 1781.75it/s]warmup should be done:  24%|██▎       | 709/3000 [00:00<00:01, 1775.86it/s]warmup should be done:  24%|██▍       | 725/3000 [00:00<00:01, 1805.45it/s]warmup should be done:  30%|██▉       | 898/3000 [00:00<00:01, 1793.21it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1786.62it/s]warmup should be done:  29%|██▉       | 881/3000 [00:00<00:01, 1803.34it/s]warmup should be done:  30%|███       | 909/3000 [00:00<00:01, 1817.10it/s]warmup should be done:  36%|███▌      | 1078/3000 [00:00<00:01, 1795.17it/s]warmup should be done:  36%|███▌      | 1071/3000 [00:00<00:01, 1794.27it/s]warmup should be done:  36%|███▋      | 1093/3000 [00:00<00:01, 1824.37it/s]warmup should be done:  36%|███▌      | 1065/3000 [00:00<00:01, 1813.80it/s]warmup should be done:  42%|████▏     | 1252/3000 [00:00<00:00, 1796.79it/s]warmup should be done:  42%|████▏     | 1248/3000 [00:00<00:00, 1818.35it/s]warmup should be done:  42%|████▏     | 1258/3000 [00:00<00:00, 1788.99it/s]warmup should be done:  43%|████▎     | 1276/3000 [00:00<00:00, 1823.21it/s]warmup should be done:  48%|████▊     | 1435/3000 [00:00<00:00, 1805.31it/s]warmup should be done:  48%|████▊     | 1432/3000 [00:00<00:00, 1822.76it/s]warmup should be done:  49%|████▊     | 1461/3000 [00:00<00:00, 1829.01it/s]warmup should be done:  48%|████▊     | 1437/3000 [00:00<00:00, 1785.95it/s]warmup should be done:  54%|█████▍    | 1618/3000 [00:00<00:00, 1810.26it/s]warmup should be done:  54%|█████▍    | 1617/3000 [00:00<00:00, 1828.98it/s]warmup should be done:  55%|█████▍    | 1646/3000 [00:00<00:00, 1832.57it/s]warmup should be done:  54%|█████▍    | 1616/3000 [00:00<00:00, 1763.65it/s]warmup should be done:  60%|██████    | 1800/3000 [00:01<00:00, 1812.55it/s]warmup should be done:  60%|██████    | 1802/3000 [00:01<00:00, 1833.37it/s]warmup should be done:  61%|██████    | 1831/3000 [00:01<00:00, 1835.46it/s]warmup should be done:  60%|█████▉    | 1793/3000 [00:01<00:00, 1762.52it/s]warmup should be done:  66%|██████▌   | 1982/3000 [00:01<00:00, 1813.46it/s]warmup should be done:  66%|██████▌   | 1987/3000 [00:01<00:00, 1836.04it/s]warmup should be done:  67%|██████▋   | 2015/3000 [00:01<00:00, 1835.80it/s]warmup should be done:  66%|██████▌   | 1970/3000 [00:01<00:00, 1762.30it/s]warmup should be done:  72%|███████▏  | 2171/3000 [00:01<00:00, 1835.01it/s]warmup should be done:  72%|███████▏  | 2164/3000 [00:01<00:00, 1809.92it/s]warmup should be done:  73%|███████▎  | 2199/3000 [00:01<00:00, 1835.43it/s]warmup should be done:  72%|███████▏  | 2147/3000 [00:01<00:00, 1753.55it/s]warmup should be done:  79%|███████▊  | 2356/3000 [00:01<00:00, 1838.53it/s]warmup should be done:  79%|███████▉  | 2383/3000 [00:01<00:00, 1835.98it/s]warmup should be done:  78%|███████▊  | 2345/3000 [00:01<00:00, 1804.98it/s]warmup should be done:  78%|███████▊  | 2327/3000 [00:01<00:00, 1765.45it/s]warmup should be done:  85%|████████▍ | 2541/3000 [00:01<00:00, 1839.50it/s]warmup should be done:  86%|████████▌ | 2568/3000 [00:01<00:00, 1838.13it/s]warmup should be done:  84%|████████▍ | 2527/3000 [00:01<00:00, 1807.88it/s]warmup should be done:  84%|████████▎ | 2508/3000 [00:01<00:00, 1777.28it/s]warmup should be done:  91%|█████████ | 2726/3000 [00:01<00:00, 1841.54it/s]warmup should be done:  92%|█████████▏| 2753/3000 [00:01<00:00, 1839.70it/s]warmup should be done:  90%|█████████ | 2708/3000 [00:01<00:00, 1794.55it/s]warmup should be done:  90%|████████▉ | 2688/3000 [00:01<00:00, 1782.33it/s]warmup should be done:  98%|█████████▊| 2938/3000 [00:01<00:00, 1841.68it/s]warmup should be done:  97%|█████████▋| 2911/3000 [00:01<00:00, 1840.46it/s]warmup should be done:  96%|█████████▋| 2889/3000 [00:01<00:00, 1798.52it/s]warmup should be done:  96%|█████████▌| 2867/3000 [00:01<00:00, 1765.03it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1828.15it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1813.05it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1796.96it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1771.76it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f1ee4118160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f1ee4118280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f1ee4118070>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f1ee43dae80>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 20:22:46.332173: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1ab5a67d50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:22:46.332248: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:22:46.335558: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1ab1264b20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:22:46.335598: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:22:46.342756: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:22:46.343810: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:22:47.435472: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:22:47.476777: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:22:47.504691: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1ab926bd10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:22:47.504750: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:22:47.512476: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:22:47.534339: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1ab126b450 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:22:47.534392: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:22:47.541167: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:22:48.256232: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:22:48.303696: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:22:52.881389: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:22:52.897138: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:22:53.531280: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:22:54.682277: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][20:23:57.116][ERROR][RK0][tid #139752925816576]: replica 0 reaches 1000, calling init pre replica
[HCTR][20:23:57.116][ERROR][RK0][tid #139752925816576]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][20:23:57.122][ERROR][RK0][tid #139752925816576]: coll ps creation done
[HCTR][20:23:57.122][ERROR][RK0][tid #139752925816576]: replica 0 waits for coll ps creation barrier
[HCTR][20:23:57.318][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][20:23:57.319][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][20:23:57.320][ERROR][RK0][tid #139752925816576]: replica 3 reaches 1000, calling init pre replica
[HCTR][20:23:57.321][ERROR][RK0][tid #139752925816576]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][20:23:57.323][ERROR][RK0][main]: coll ps creation done
[HCTR][20:23:57.323][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][20:23:57.324][ERROR][RK0][tid #139752925816576]: coll ps creation done
[HCTR][20:23:57.324][ERROR][RK0][tid #139752925816576]: replica 3 waits for coll ps creation barrier
[HCTR][20:23:57.362][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][20:23:57.362][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][20:23:57.365][ERROR][RK0][main]: coll ps creation done
[HCTR][20:23:57.365][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][20:23:57.365][ERROR][RK0][tid #139752925816576]: replica 0 preparing frequency
[HCTR][20:23:58.303][ERROR][RK0][tid #139752925816576]: replica 0 preparing frequency done
[HCTR][20:23:58.333][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][20:23:58.333][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][20:23:58.333][ERROR][RK0][tid #139752925816576]: replica 0 calling init per replica
[HCTR][20:23:58.333][ERROR][RK0][tid #139752925816576]: replica 3 calling init per replica
[HCTR][20:23:58.333][ERROR][RK0][main]: Calling build_v2
[HCTR][20:23:58.333][ERROR][RK0][main]: Calling build_v2
[HCTR][20:23:58.333][ERROR][RK0][tid #139752925816576]: Calling build_v2
[HCTR][20:23:58.333][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:23:58.333][ERROR][RK0][tid #139752925816576]: Calling build_v2
[HCTR][20:23:58.333][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:23:58.333][ERROR][RK0][tid #139752925816576]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:23:58.334][ERROR][RK0][tid #139752925816576]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[2022-12-11 20:23:58.2022-12-11 20:23:58334046.: 334046[E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc2022-12-11 20:23:58136:.] 136334067using concurrent impl MPS] : 
using concurrent impl MPSE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 20:23:58.334067: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 20:23:58.335145: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] [assigning 8 to cpu2022-12-11 20:23:58
.335168: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 20:23:58.335200[: 2022-12-11 20:23:58E. 335209/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E196 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpu:[
2122022-12-11 20:23:58] .build symm link desc with 4X Tesla V100-SXM2-16GB out of 4335282
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[
2022-12-11 20:23:58[.2022-12-11 20:23:58335332[.: 2022-12-11 20:23:58335330E.:  335350[E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 2022-12-11 20:23:58 :E./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc213 335381:] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 212remote time is 8.68421:E] 
213 build symm link desc with 4X Tesla V100-SXM2-16GB out of 4] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[
remote time is 8.68421:2022-12-11 20:23:58
196.] 335471assigning 8 to cpu[: [
2022-12-11 20:23:58E2022-12-11 20:23:58. .335500/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc335501: :: E214E ]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[cpu time is 30/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:2022-12-11 20:23:58
:214.213] 335560] cpu time is 30: remote time is 8.68421
E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] [build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 20:23:58
.335657: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 20:23:58:.214335687] : cpu time is 30E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 20:23:58.335754: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 20:24:23.666140: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 20:24:23.738558: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 20:24:23.878252: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 20:24:23.878314: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 20:24:23.878348: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 20:24:23.878378: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 20:24:23.879242: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:24:23.879294: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:24:23.880293: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:24:23.880858: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:24:23.901743: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 20:24:23.901841: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 20:24:23.902380: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:24:23.902434: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:24:23.903293: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:24:23.903315: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 20:24:23.903408: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 20:24:23.903866: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:24:23.904066: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:24:23.904119: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:24:23.904765: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 20:24:23.904819: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 20:24:23.905162: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:24:23.905208: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:24:23.906198: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:24:23.906786: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:24:23.907450: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:24:23.908056: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:24:23.960516: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 20:24:23.962330: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 20:24:23.962382: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 20:24:23.963187: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:24:23.963741: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:24:23.964645: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:24:23.967413: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:24:23.968098: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:24:23.968143: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.44 MB
[2022-12-11 20:24:23.995445: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 20:24:23.997319: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 20:24:23.997368: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 20:24:23.998123: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:24:24.   857: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:24:24.  1817: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:24:24.  7029: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:24:24.  7695: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:24:24.  7739: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.44 MB
[[2022-12-11 20:24:242022-12-11 20:24:24.. 13756 13750: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes

[2022-12-11 20:24:24. 15588: E[ 2022-12-11 20:24:24/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.: 15601638: ] Eeager release cuda mem 5 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 20:24:24. 15652: [E2022-12-11 20:24:24 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc 15663:: 638E]  eager release cuda mem 400000000/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 400000000
[2022-12-11 20:24:24. 16500: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:24:24. 16988: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:24:24. 17339: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:24:24. 18145: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:24:24. 18232: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:24:24. 19048: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:24:24. 22905: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:24:24. 23558: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:24:24. 23600: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.44 MB
[2022-12-11 20:24:24. 25178: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:24:24. 25828: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:24:24. 26277: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.44 MB
[[[[2022-12-11 20:24:242022-12-11 20:24:242022-12-11 20:24:242022-12-11 20:24:24....111164111168111167111173: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 0 init p2p of link 1Device 1 init p2p of link 2Device 3 init p2p of link 0Device 2 init p2p of link 3



[2022-12-11 20:24:24.111444[: [2022-12-11 20:24:24E2022-12-11 20:24:24. .111452/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu111459: :: E[1980E 2022-12-11 20:24:24]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:111502
:1980: 1980] E] eager alloc mem 611.00 KB eager alloc mem 611.00 KB
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-11 20:24:24.112342[: [2022-12-11 20:24:24E2022-12-11 20:24:24. .[112350/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc1123532022-12-11 20:24:24: :: .E638E112374 ]  : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE:
: 638638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] ] :eager release cuda mem 625663eager release cuda mem 625663638

] eager release cuda mem 625663
[2022-12-11 20:24:24.115166: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2[
2022-12-11 20:24:24.115197: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 20:24:24.115280: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-11 20:24:242022-12-11 20:24:24..115329115323: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801926] ] eager alloc mem 611.00 KBDevice 1 init p2p of link 3

[2022-12-11 20:24:24.115388: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 20:24:24.115447: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:24:24.115489: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:24:24.116061: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:24:24.116127: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[[2022-12-11 20:24:242022-12-11 20:24:24..116264116265: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 625663eager release cuda mem 625663

[2022-12-11 20:24:24.118451: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 20:24:24.118544: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:24:24.118686: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 20:24:24.118776: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:24:24.118863: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 20:24:24.[1189382022-12-11 20:24:24: .E118953 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1926/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :Device 1 init p2p of link 01980
] eager alloc mem 611.00 KB
[2022-12-11 20:24:24.119070: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:24:24.119308: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:24:24.119547: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:24:24.119778: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:24:24.119883: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:24:24.121270: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:24:24.121787: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:24:24.121931: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 1999999 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5999997 / 100000000 nodes ( 6.00 %) | cpu 92000004 / 100000000 nodes ( 92.00 %) | 981.44 MB | 0.242648 secs 
[2022-12-11 20:24:24.122167: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:24:24.122234: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:24:24.122430: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 1999999 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5999997 / 100000000 nodes ( 6.00 %) | cpu 92000004 / 100000000 nodes ( 92.00 %) | 981.44 MB | 0.217234 secs 
[2022-12-11 20:24:24.123017: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 1999999 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5999997 / 100000000 nodes ( 6.00 %) | cpu 92000004 / 100000000 nodes ( 92.00 %) | 981.44 MB | 0.21891 secs 
[2022-12-11 20:24:24.123418: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 1999999 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5999997 / 100000000 nodes ( 6.00 %) | cpu 92000004 / 100000000 nodes ( 92.00 %) | 981.44 MB | 0.221002 secs 
[2022-12-11 20:24:24.123539: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.66 GB
[2022-12-11 20:24:25.116317: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.90 GB
[2022-12-11 20:24:25.118020: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.90 GB
[2022-12-11 20:24:25.118840: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.90 GB
[2022-12-11 20:24:26. 31707: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.15 GB
[2022-12-11 20:24:26. 32242: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.15 GB
[2022-12-11 20:24:26. 33142: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.15 GB
[2022-12-11 20:24:26.778018: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.39 GB
[2022-12-11 20:24:26.778212: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.39 GB
[2022-12-11 20:24:26.778514: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.39 GB
[2022-12-11 20:24:27.553998: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.80 GB
[2022-12-11 20:24:27.554124: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.80 GB
[2022-12-11 20:24:27.554472: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.80 GB
[2022-12-11 20:24:28.515685: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.99 GB
[2022-12-11 20:24:28.515840: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.99 GB
[HCTR][20:24:28.646][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][20:24:28.646][ERROR][RK0][tid #139752925816576]: replica 3 calling init per replica done, doing barrier
[HCTR][20:24:28.646][ERROR][RK0][tid #139752925816576]: replica 0 calling init per replica done, doing barrier
[HCTR][20:24:28.646][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][20:24:28.646][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][20:24:28.646][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][20:24:28.646][ERROR][RK0][tid #139752925816576]: replica 3 calling init per replica done, doing barrier done
[HCTR][20:24:28.646][ERROR][RK0][tid #139752925816576]: replica 0 calling init per replica done, doing barrier done
[HCTR][20:24:28.646][ERROR][RK0][main]: init per replica done
[HCTR][20:24:28.646][ERROR][RK0][main]: init per replica done
[HCTR][20:24:28.646][ERROR][RK0][tid #139752925816576]: init per replica done
[HCTR][20:24:28.649][ERROR][RK0][tid #139752925816576]: init per replica done
[HCTR][20:24:28.683][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f01ba238400
[HCTR][20:24:28.683][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f01ba558400
[HCTR][20:24:28.683][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f01bab98400
[HCTR][20:24:28.683][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f01baeb8400
[HCTR][20:24:28.683][ERROR][RK0][tid #139752925816576]: 3 allocated 3276800 at 0x7f0108238400
[HCTR][20:24:28.683][ERROR][RK0][tid #139752925816576]: 3 allocated 6553600 at 0x7f0108558400
[HCTR][20:24:28.683][ERROR][RK0][tid #139752925816576]: 3 allocated 3276800 at 0x7f0108b98400
[HCTR][20:24:28.683][ERROR][RK0][tid #139752925816576]: 3 allocated 6553600 at 0x7f0108eb8400
[HCTR][20:24:28.684][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f00d4238400
[HCTR][20:24:28.684][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f00d4558400
[HCTR][20:24:28.684][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f00d4b98400
[HCTR][20:24:28.684][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f00d4eb8400
[HCTR][20:24:28.685][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f00fc320000
[HCTR][20:24:28.685][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f00fc640000
[HCTR][20:24:28.685][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f00fcc80000
[HCTR][20:24:28.685][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f00fcfa0000
