2022-12-11 18:26:47.172966: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:26:47.259578: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:26:47.260487: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:26:47.260582: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:26:48.011142: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:26:48.011208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 18:26:48.025079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 18:26:48.058607: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:26:48.058777: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:26:48.060284: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 18:26:48.098863: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:26:48.098936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 18:26:48.101388: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:26:48.101441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 18:26:48.112769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 18:26:48.114296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 18:26:48.139558: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:26:48.139642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 18:26:48.148221: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:26:48.148386: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:26:48.149790: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 18:26:48.151024: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:26:48.151201: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:26:48.152668: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 18:26:48.152831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 18:26:48.182930: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:26:48.183095: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:26:48.184488: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][18:26:49.381][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:26:49.392][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:26:49.447][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:26:49.447][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:00,  3.49it/s]warmup run: 1it [00:00,  3.44it/s]warmup run: 1it [00:00,  3.38it/s]warmup run: 1it [00:00,  3.35it/s]warmup run: 80it [00:00, 265.36it/s]warmup run: 87it [00:00, 284.93it/s]warmup run: 77it [00:00, 249.18it/s]warmup run: 77it [00:00, 247.65it/s]warmup run: 146it [00:00, 392.44it/s]warmup run: 158it [00:00, 417.77it/s]warmup run: 146it [00:00, 387.11it/s]warmup run: 146it [00:00, 386.83it/s]warmup run: 208it [00:00, 463.41it/s]warmup run: 225it [00:00, 496.20it/s]warmup run: 218it [00:00, 489.73it/s]warmup run: 226it [00:00, 513.43it/s]warmup run: 274it [00:00, 522.24it/s]warmup run: 294it [00:00, 555.08it/s]warmup run: 290it [00:00, 558.95it/s]warmup run: 294it [00:00, 563.73it/s]warmup run: 335it [00:00, 543.13it/s]warmup run: 364it [00:00, 598.89it/s]warmup run: 358it [00:00, 594.98it/s]warmup run: 372it [00:00, 629.33it/s]warmup run: 404it [00:00, 587.19it/s]warmup run: 427it [00:00, 621.26it/s]warmup run: 431it [00:00, 613.10it/s]warmup run: 451it [00:00, 677.36it/s]warmup run: 469it [00:00, 604.47it/s]warmup run: 501it [00:00, 638.55it/s]warmup run: 525it [00:01, 695.01it/s]warmup run: 494it [00:01, 632.67it/s]warmup run: 538it [00:01, 628.57it/s]warmup run: 576it [00:01, 671.67it/s]warmup run: 603it [00:01, 718.92it/s]warmup run: 564it [00:01, 650.74it/s]warmup run: 605it [00:01, 638.87it/s]warmup run: 652it [00:01, 697.37it/s]warmup run: 681it [00:01, 737.03it/s]warmup run: 633it [00:01, 660.97it/s]warmup run: 671it [00:01, 643.32it/s]warmup run: 726it [00:01, 709.45it/s]warmup run: 701it [00:01, 663.64it/s]warmup run: 757it [00:01, 733.98it/s]warmup run: 740it [00:01, 656.14it/s]warmup run: 801it [00:01, 720.87it/s]warmup run: 772it [00:01, 674.96it/s]warmup run: 832it [00:01, 734.50it/s]warmup run: 807it [00:01, 659.46it/s]warmup run: 875it [00:01, 724.40it/s]warmup run: 843it [00:01, 682.60it/s]warmup run: 908it [00:01, 740.29it/s]warmup run: 875it [00:01, 665.02it/s]warmup run: 949it [00:01, 725.37it/s]warmup run: 917it [00:01, 697.81it/s]warmup run: 985it [00:01, 746.54it/s]warmup run: 942it [00:01, 665.42it/s]warmup run: 1022it [00:01, 726.68it/s]warmup run: 990it [00:01, 705.76it/s]warmup run: 1061it [00:01, 746.89it/s]warmup run: 1099it [00:01, 739.43it/s]warmup run: 1009it [00:01, 660.23it/s]warmup run: 1065it [00:01, 718.81it/s]warmup run: 1139it [00:01, 754.26it/s]warmup run: 1076it [00:01, 660.29it/s]warmup run: 1138it [00:01, 721.88it/s]warmup run: 1174it [00:01, 727.99it/s]warmup run: 1217it [00:01, 760.63it/s]warmup run: 1145it [00:02, 667.70it/s]warmup run: 1211it [00:02, 714.45it/s]warmup run: 1247it [00:02, 720.68it/s]warmup run: 1294it [00:02, 757.61it/s]warmup run: 1212it [00:02, 665.59it/s]warmup run: 1320it [00:02, 722.67it/s]warmup run: 1283it [00:02, 710.12it/s]warmup run: 1370it [00:02, 755.99it/s]warmup run: 1279it [00:02, 666.79it/s]warmup run: 1394it [00:02, 727.04it/s]warmup run: 1446it [00:02, 745.88it/s]warmup run: 1355it [00:02, 700.80it/s]warmup run: 1347it [00:02, 667.93it/s]warmup run: 1467it [00:02, 715.08it/s]warmup run: 1521it [00:02, 736.80it/s]warmup run: 1426it [00:02, 683.46it/s]warmup run: 1414it [00:02, 666.65it/s]warmup run: 1540it [00:02, 717.55it/s]warmup run: 1595it [00:02, 736.84it/s]warmup run: 1495it [00:02, 669.06it/s]warmup run: 1484it [00:02, 675.52it/s]warmup run: 1614it [00:02, 722.83it/s]warmup run: 1669it [00:02, 717.70it/s]warmup run: 1563it [00:02, 671.82it/s]warmup run: 1552it [00:02, 676.34it/s]warmup run: 1687it [00:02, 719.95it/s]warmup run: 1741it [00:02, 708.03it/s]warmup run: 1631it [00:02, 669.36it/s]warmup run: 1636it [00:02, 723.40it/s]warmup run: 1760it [00:02, 703.52it/s]warmup run: 1819it [00:02, 727.92it/s]warmup run: 1699it [00:02, 662.79it/s]warmup run: 1712it [00:02, 734.19it/s]warmup run: 1831it [00:02, 704.17it/s]warmup run: 1893it [00:02, 729.79it/s]warmup run: 1766it [00:02, 664.22it/s]warmup run: 1787it [00:02, 736.41it/s]warmup run: 1903it [00:02, 707.19it/s]warmup run: 1967it [00:02, 729.46it/s]warmup run: 1835it [00:02, 668.77it/s]warmup run: 1862it [00:03, 738.08it/s]warmup run: 1976it [00:03, 710.74it/s]warmup run: 2043it [00:03, 735.75it/s]warmup run: 1908it [00:03, 684.34it/s]warmup run: 1936it [00:03, 738.47it/s]warmup run: 2048it [00:03, 713.38it/s]warmup run: 2117it [00:03, 733.85it/s]warmup run: 1979it [00:03, 691.42it/s]warmup run: 2011it [00:03, 739.64it/s]warmup run: 2120it [00:03, 714.13it/s]warmup run: 2191it [00:03, 731.20it/s]warmup run: 2053it [00:03, 704.51it/s]warmup run: 2088it [00:03, 747.25it/s]warmup run: 2192it [00:03, 713.68it/s]warmup run: 2266it [00:03, 734.08it/s]warmup run: 2127it [00:03, 712.12it/s]warmup run: 2163it [00:03, 747.20it/s]warmup run: 2265it [00:03, 715.55it/s]warmup run: 2342it [00:03, 741.58it/s]warmup run: 2199it [00:03, 713.35it/s]warmup run: 2238it [00:03, 745.88it/s]warmup run: 2339it [00:03, 720.85it/s]warmup run: 2417it [00:03, 741.19it/s]warmup run: 2274it [00:03, 721.93it/s]warmup run: 2318it [00:03, 759.71it/s]warmup run: 2412it [00:03, 714.05it/s]warmup run: 2492it [00:03, 738.79it/s]warmup run: 2350it [00:03, 730.29it/s]warmup run: 2405it [00:03, 791.50it/s]warmup run: 2490it [00:03, 731.88it/s]warmup run: 2566it [00:03, 736.11it/s]warmup run: 2424it [00:03, 727.95it/s]warmup run: 2485it [00:03, 761.88it/s]warmup run: 2569it [00:03, 748.60it/s]warmup run: 2654it [00:03, 777.99it/s]warmup run: 2497it [00:03, 713.23it/s]warmup run: 2562it [00:03, 762.95it/s]warmup run: 2648it [00:03, 760.08it/s]warmup run: 2570it [00:03, 715.67it/s]warmup run: 2645it [00:04, 723.65it/s]warmup run: 2732it [00:04, 503.65it/s]warmup run: 2725it [00:04, 526.37it/s]warmup run: 2639it [00:04, 480.93it/s]warmup run: 2805it [00:04, 551.66it/s]warmup run: 2800it [00:04, 576.50it/s]warmup run: 2716it [00:04, 540.31it/s]warmup run: 2718it [00:04, 485.08it/s]warmup run: 2880it [00:04, 597.82it/s]warmup run: 2875it [00:04, 618.61it/s]warmup run: 2783it [00:04, 569.02it/s]warmup run: 2790it [00:04, 536.58it/s]warmup run: 2950it [00:04, 622.24it/s]warmup run: 2948it [00:04, 646.75it/s]warmup run: 3000it [00:04, 664.31it/s]warmup run: 2850it [00:04, 592.17it/s]warmup run: 2853it [00:04, 551.34it/s]warmup run: 3000it [00:04, 654.83it/s]warmup run: 2917it [00:04, 607.48it/s]warmup run: 2915it [00:04, 568.26it/s]warmup run: 2984it [00:04, 598.71it/s]warmup run: 2983it [00:04, 614.06it/s]warmup run: 3000it [00:04, 628.36it/s]warmup run: 3000it [00:04, 628.13it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1735.99it/s]warmup should be done:   4%|▍         | 130/3000 [00:00<00:02, 1294.46it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1722.95it/s]warmup should be done:   5%|▌         | 164/3000 [00:00<00:01, 1635.92it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1765.30it/s]warmup should be done:  11%|█▏        | 343/3000 [00:00<00:01, 1726.25it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1750.43it/s]warmup should be done:  10%|█         | 309/3000 [00:00<00:01, 1582.20it/s]warmup should be done:  18%|█▊        | 526/3000 [00:00<00:01, 1754.65it/s]warmup should be done:  17%|█▋        | 519/3000 [00:00<00:01, 1738.89it/s]warmup should be done:  16%|█▋        | 490/3000 [00:00<00:01, 1685.06it/s]warmup should be done:  18%|█▊        | 532/3000 [00:00<00:01, 1773.12it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1771.03it/s]warmup should be done:  23%|██▎       | 694/3000 [00:00<00:01, 1741.57it/s]warmup should be done:  24%|██▎       | 711/3000 [00:00<00:01, 1777.22it/s]warmup should be done:  22%|██▏       | 673/3000 [00:00<00:01, 1739.20it/s]warmup should be done:  29%|██▉       | 870/3000 [00:00<00:01, 1746.55it/s]warmup should be done:  29%|██▉       | 884/3000 [00:00<00:01, 1770.81it/s]warmup should be done:  29%|██▊       | 856/3000 [00:00<00:01, 1768.80it/s]warmup should be done:  30%|██▉       | 889/3000 [00:00<00:01, 1737.26it/s]warmup should be done:  35%|███▌      | 1062/3000 [00:00<00:01, 1770.54it/s]warmup should be done:  35%|███▍      | 1038/3000 [00:00<00:01, 1784.41it/s]warmup should be done:  36%|███▌      | 1071/3000 [00:00<00:01, 1763.26it/s]warmup should be done:  35%|███▍      | 1045/3000 [00:00<00:01, 1684.74it/s]warmup should be done:  41%|████      | 1218/3000 [00:00<00:00, 1788.98it/s]warmup should be done:  41%|████▏     | 1240/3000 [00:00<00:00, 1769.89it/s]warmup should be done:  42%|████▏     | 1248/3000 [00:00<00:00, 1759.73it/s]warmup should be done:  41%|████      | 1224/3000 [00:00<00:01, 1717.31it/s]warmup should be done:  47%|████▋     | 1400/3000 [00:00<00:00, 1798.58it/s]warmup should be done:  47%|████▋     | 1418/3000 [00:00<00:00, 1770.69it/s]warmup should be done:  48%|████▊     | 1430/3000 [00:00<00:00, 1776.88it/s]warmup should be done:  47%|████▋     | 1404/3000 [00:00<00:00, 1740.63it/s]warmup should be done:  53%|█████▎    | 1583/3000 [00:00<00:00, 1805.79it/s]warmup should be done:  53%|█████▎    | 1596/3000 [00:00<00:00, 1770.21it/s]warmup should be done:  54%|█████▎    | 1611/3000 [00:00<00:00, 1786.81it/s]warmup should be done:  53%|█████▎    | 1579/3000 [00:00<00:00, 1709.53it/s]warmup should be done:  59%|█████▉    | 1764/3000 [00:01<00:00, 1804.23it/s]warmup should be done:  59%|█████▉    | 1774/3000 [00:01<00:00, 1768.77it/s]warmup should be done:  60%|█████▉    | 1790/3000 [00:01<00:00, 1745.13it/s]warmup should be done:  58%|█████▊    | 1751/3000 [00:01<00:00, 1685.82it/s]warmup should be done:  65%|██████▍   | 1946/3000 [00:01<00:00, 1807.54it/s]warmup should be done:  65%|██████▌   | 1952/3000 [00:01<00:00, 1771.62it/s]warmup should be done:  66%|██████▌   | 1967/3000 [00:01<00:00, 1752.20it/s]warmup should be done:  64%|██████▍   | 1923/3000 [00:01<00:00, 1694.86it/s]warmup should be done:  71%|███████   | 2127/3000 [00:01<00:00, 1806.95it/s]warmup should be done:  71%|███████   | 2130/3000 [00:01<00:00, 1764.29it/s]warmup should be done:  71%|███████▏  | 2143/3000 [00:01<00:00, 1748.35it/s]warmup should be done:  70%|███████   | 2102/3000 [00:01<00:00, 1721.98it/s]warmup should be done:  77%|███████▋  | 2308/3000 [00:01<00:00, 1805.65it/s]warmup should be done:  77%|███████▋  | 2308/3000 [00:01<00:00, 1768.23it/s]warmup should be done:  77%|███████▋  | 2318/3000 [00:01<00:00, 1735.62it/s]warmup should be done:  76%|███████▌  | 2275/3000 [00:01<00:00, 1708.92it/s]warmup should be done:  83%|████████▎ | 2491/3000 [00:01<00:00, 1810.73it/s]warmup should be done:  83%|████████▎ | 2485/3000 [00:01<00:00, 1767.25it/s]warmup should be done:  83%|████████▎ | 2493/3000 [00:01<00:00, 1739.40it/s]warmup should be done:  82%|████████▏ | 2457/3000 [00:01<00:00, 1739.53it/s]warmup should be done:  89%|████████▉ | 2674/3000 [00:01<00:00, 1814.61it/s]warmup should be done:  89%|████████▊ | 2662/3000 [00:01<00:00, 1748.75it/s]warmup should be done:  88%|████████▊ | 2639/3000 [00:01<00:00, 1763.12it/s]warmup should be done:  89%|████████▉ | 2668/3000 [00:01<00:00, 1689.00it/s]warmup should be done:  95%|█████████▌| 2856/3000 [00:01<00:00, 1813.92it/s]warmup should be done:  95%|█████████▍| 2837/3000 [00:01<00:00, 1733.07it/s]warmup should be done:  94%|█████████▍| 2822/3000 [00:01<00:00, 1780.78it/s]warmup should be done:  95%|█████████▍| 2847/3000 [00:01<00:00, 1717.20it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1781.04it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1756.16it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1746.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1733.96it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1647.27it/s]warmup should be done:   6%|▌         | 179/3000 [00:00<00:01, 1782.56it/s]warmup should be done:   6%|▌         | 186/3000 [00:00<00:01, 1854.99it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1704.62it/s]warmup should be done:  12%|█▎        | 375/3000 [00:00<00:01, 1873.80it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1774.85it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1748.24it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1828.91it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1816.87it/s]warmup should be done:  18%|█▊        | 552/3000 [00:00<00:01, 1842.97it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1760.30it/s]warmup should be done:  19%|█▉        | 563/3000 [00:00<00:01, 1858.37it/s]warmup should be done:  24%|██▍       | 726/3000 [00:00<00:01, 1836.82it/s]warmup should be done:  25%|██▍       | 738/3000 [00:00<00:01, 1846.43it/s]warmup should be done:  25%|██▍       | 749/3000 [00:00<00:01, 1855.61it/s]warmup should be done:  23%|██▎       | 704/3000 [00:00<00:01, 1726.23it/s]warmup should be done:  30%|███       | 914/3000 [00:00<00:01, 1848.82it/s]warmup should be done:  31%|███       | 925/3000 [00:00<00:01, 1853.61it/s]warmup should be done:  31%|███       | 936/3000 [00:00<00:01, 1860.19it/s]warmup should be done:  30%|██▉       | 887/3000 [00:00<00:01, 1759.67it/s]warmup should be done:  37%|███▋      | 1101/3000 [00:00<00:01, 1855.37it/s]warmup should be done:  37%|███▋      | 1112/3000 [00:00<00:01, 1856.87it/s]warmup should be done:  37%|███▋      | 1123/3000 [00:00<00:01, 1860.32it/s]warmup should be done:  36%|███▌      | 1068/3000 [00:00<00:01, 1775.49it/s]warmup should be done:  43%|████▎     | 1287/3000 [00:00<00:00, 1854.46it/s]warmup should be done:  43%|████▎     | 1298/3000 [00:00<00:00, 1855.62it/s]warmup should be done:  44%|████▎     | 1310/3000 [00:00<00:00, 1854.82it/s]warmup should be done:  42%|████▏     | 1247/3000 [00:00<00:00, 1780.08it/s]warmup should be done:  49%|████▉     | 1474/3000 [00:00<00:00, 1858.57it/s]warmup should be done:  50%|████▉     | 1486/3000 [00:00<00:00, 1861.65it/s]warmup should be done:  50%|████▉     | 1498/3000 [00:00<00:00, 1860.87it/s]warmup should be done:  48%|████▊     | 1428/3000 [00:00<00:00, 1788.41it/s]warmup should be done:  55%|█████▌    | 1660/3000 [00:00<00:00, 1851.75it/s]warmup should be done:  56%|█████▌    | 1673/3000 [00:00<00:00, 1859.61it/s]warmup should be done:  54%|█████▎    | 1611/3000 [00:00<00:00, 1801.03it/s]warmup should be done:  56%|█████▌    | 1685/3000 [00:00<00:00, 1852.52it/s]warmup should be done:  62%|██████▏   | 1846/3000 [00:01<00:00, 1853.33it/s]warmup should be done:  62%|██████▏   | 1861/3000 [00:01<00:00, 1864.66it/s]warmup should be done:  62%|██████▏   | 1873/3000 [00:01<00:00, 1860.73it/s]warmup should be done:  60%|█████▉    | 1793/3000 [00:01<00:00, 1806.51it/s]warmup should be done:  68%|██████▊   | 2033/3000 [00:01<00:00, 1856.93it/s]warmup should be done:  68%|██████▊   | 2048/3000 [00:01<00:00, 1861.35it/s]warmup should be done:  69%|██████▊   | 2062/3000 [00:01<00:00, 1867.78it/s]warmup should be done:  66%|██████▌   | 1976/3000 [00:01<00:00, 1811.46it/s]warmup should be done:  74%|███████▍  | 2220/3000 [00:01<00:00, 1858.19it/s]warmup should be done:  75%|███████▍  | 2236/3000 [00:01<00:00, 1865.59it/s]warmup should be done:  75%|███████▌  | 2251/3000 [00:01<00:00, 1871.26it/s]warmup should be done:  72%|███████▏  | 2159/3000 [00:01<00:00, 1814.21it/s]warmup should be done:  81%|████████  | 2423/3000 [00:01<00:00, 1864.95it/s]warmup should be done:  81%|████████▏ | 2439/3000 [00:01<00:00, 1873.52it/s]warmup should be done:  78%|███████▊  | 2342/3000 [00:01<00:00, 1818.74it/s]warmup should be done:  80%|████████  | 2406/3000 [00:01<00:00, 1820.50it/s]warmup should be done:  87%|████████▋ | 2612/3000 [00:01<00:00, 1869.52it/s]warmup should be done:  88%|████████▊ | 2627/3000 [00:01<00:00, 1875.13it/s]warmup should be done:  84%|████████▍ | 2526/3000 [00:01<00:00, 1824.47it/s]warmup should be done:  86%|████████▋ | 2593/3000 [00:01<00:00, 1833.67it/s]warmup should be done:  93%|█████████▎| 2799/3000 [00:01<00:00, 1851.96it/s]warmup should be done:  90%|█████████ | 2709/3000 [00:01<00:00, 1821.39it/s]warmup should be done:  94%|█████████▍| 2815/3000 [00:01<00:00, 1861.66it/s]warmup should be done:  93%|█████████▎| 2780/3000 [00:01<00:00, 1844.14it/s]warmup should be done: 100%|█████████▉| 2987/3000 [00:01<00:00, 1859.65it/s]warmup should be done:  96%|█████████▋| 2892/3000 [00:01<00:00, 1821.97it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1862.56it/s]warmup should be done:  99%|█████████▉| 2967/3000 [00:01<00:00, 1851.25it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1856.41it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1841.06it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1793.70it/s]2022-12-11 18:27:30.526560: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe09d9e29b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:27:30.526619: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:27:30.577119: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:27:30.939459: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe0959e0320 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:27:30.939530: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:27:30.950199: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe091665bf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:27:30.950262: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:27:30.956936: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe09d9c1be0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:27:30.957015: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:27:31.062046: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:27:31.069368: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:27:31.069377: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:27:31.499049: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:27:31.852520: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:27:31.864468: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:27:31.892160: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:27:32.189774: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:27:32.595619: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:27:32.597394: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:27:32.698422: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][18:28:40.042][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][18:28:40.042][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:28:40.054][ERROR][RK0][main]: coll ps creation done
[HCTR][18:28:40.054][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][18:28:40.261][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][18:28:40.261][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:28:40.265][ERROR][RK0][main]: coll ps creation done
[HCTR][18:28:40.265][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][18:28:40.658][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][18:28:40.658][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:28:40.661][ERROR][RK0][main]: coll ps creation done
[HCTR][18:28:40.661][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][18:28:40.805][ERROR][RK0][tid #140602968618752]: replica 1 reaches 1000, calling init pre replica
[HCTR][18:28:40.805][ERROR][RK0][tid #140602968618752]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:28:40.809][ERROR][RK0][tid #140602968618752]: coll ps creation done
[HCTR][18:28:40.809][ERROR][RK0][tid #140602968618752]: replica 1 waits for coll ps creation barrier
[HCTR][18:28:40.809][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][18:28:49.124][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][18:28:49.166][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][18:28:49.166][ERROR][RK0][main]: Calling build_v2
[HCTR][18:28:49.166][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:28:49.166][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][18:28:49.166][ERROR][RK0][tid #140602968618752]: replica 1 calling init per replica
[HCTR][18:28:49.166][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][18:28:49.167][ERROR][RK0][main]: Calling build_v2
[HCTR][18:28:49.167][ERROR][RK0][tid #140602968618752]: Calling build_v2
[HCTR][18:28:49.167][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:28:49.167][ERROR][RK0][tid #140602968618752]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:28:49.167][ERROR][RK0][main]: Calling build_v2
[[HCTR][18:28:49.167][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
2022-12-11 18:28:49.167059: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[[2022-12-11 18:28:492022-12-11 18:28:49..167140167147: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:[:136136] 2022-12-11 18:28:49] using concurrent impl MPS.using concurrent impl MPS
167196
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 18:28:49.170025: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 18:28:49.170103: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 18:28:49.170149: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 18:28:49.170181: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 18:28:49[.2022-12-11 18:28:49170440.: 170462E: [ E2022-12-11 18:28:49/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc .:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc170487196:: ] 196Eassigning 8 to cpu]  
assigning 8 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
:196] assigning 8 to cpu
[2022-12-11 18:28:49.170572: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 18:28:49.170619: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 18:28:49.170648: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2142022-12-11 18:28:49] .cpu time is 30170660
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 18:28:49.[1706982022-12-11 18:28:49: .E170708 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: 212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :build symm link desc with 4X Tesla V100-SXM2-16GB out of 4213
] remote time is 8.68421
[[2022-12-11 18:28:492022-12-11 18:28:49..170758170760: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::213214] ] remote time is 8.68421cpu time is 30

[2022-12-11 18:28:49.170815: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 18:29:22.299109: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 18:29:22.743452: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 3.29 GB
[2022-12-11 18:29:22.743561: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 3.29 GB
[2022-12-11 18:29:22.744703: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 18:29:23.560449: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 18:29:25.376739: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 2
[2022-12-11 18:29:25.376940: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 18:30:30.496942: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1001
[2022-12-11 18:30:30.497062: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 18:30:45.424966: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 18:30:45.425237: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1001
[2022-12-11 18:30:45.678919: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 18:30:45.679011: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1001 blocks, 4 devices
[2022-12-11 18:30:47.336700: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 18:30:47.349672: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 18:30:47.350613: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 18:30:47.360715: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 18:30:47.454955: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 18:30:51.252394: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 18:30:51.256976: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 18:30:51.261283: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 18:30:51.273114: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 18:30:51.273183: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 18:30:51.273219: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 18:30:51.273251: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 18:30:51.274170: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:30:51.274347: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:30:51.278207: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:30:51.281982: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:30:51.446290: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 18:30:51.446403: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 18:30:51.453179: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 18:30:51.453290: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 18:30:51.454857: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 18:30:51.454943: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 18:30:51.455734: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:30:51.455788: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:30:51.459756: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:30:51.463649: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:30:51.474665: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:30:51.474866: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:30:51.484953: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:30:51.489084: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:30:51.490583: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:30:51.490755: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:30:51.502496: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:30:51.506356: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:30:51.822910: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 18:30:51.823303: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:30:51.837196: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1001
[2022-12-11 18:30:51.837271: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:30:51.841729: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:30:51.842518: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:30:51.849252: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:51.849614: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.50 MB
[2022-12-11 18:30:51.875119: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:30:51.880455: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:30:51.880523: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.23 GB
[2022-12-11 18:30:52. 85353: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 18:30:52. 85776: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:30:52. 99730: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1001
[2022-12-11 18:30:52. 99785: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:30:52.104103: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:30:52.104691: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:30:52.111293: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.111501: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.50 MB
[2022-12-11 18:30:52.132235: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:30:52.137372: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:30:52.137418: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.23 GB
[2022-12-11 18:30:52.141508: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 18:30:52.141784: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:30:52.155727: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1001
[2022-12-11 18:30:52.155777: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:30:52.222218: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:30:52.222810: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:30:52.229430: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.229638: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.50 MB
[2022-12-11 18:30:52.247619: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:30:52.252723: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:30:52.252769: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.23 GB
[2022-12-11 18:30:52.443544: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 18:30:52.443910: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:30:52.457764: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1001
[2022-12-11 18:30:52.457815: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:30:52.462288: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:30:52.463054: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:30:52.470016: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.470191: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.13 MB
[2022-12-11 18:30:52.491944: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:30:52.496917: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:30:52.496961: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.81 GB
[[[[2022-12-11 18:30:522022-12-11 18:30:522022-12-11 18:30:52.2022-12-11 18:30:52..912026.912027912015: 912037: : E: EE E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::1926:19261926] 1926] ] Device 0 init p2p of link 1] Device 2 init p2p of link 3Device 3 init p2p of link 0
Device 1 init p2p of link 2


[2022-12-11 18:30:52.912486: E[ 2022-12-11 18:30:52/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:9124961980: ] Eeager alloc mem 5.26 MB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:30:52.912647: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-11 18:30:521980.] 912664eager alloc mem 5.26 MB: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:30:52.919100: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.919216: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 18:30:52eager release cuda mem 5518079.
919240: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 55180792022-12-11 18:30:52
.919280: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.923195: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 18:30:52.923304: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:30:52.923544: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 18:30:52.923645: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:30:52.924165: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 18:30:52.924274: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:30:52.924405: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 18:30:52.924510: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:30:52.929299: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.929654: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.930267: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.930518: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.933240: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 18:30:52.933330: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:30:52.934011: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 18:30:52.934115: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:30:52.934156: E[ 2022-12-11 18:30:52/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:9341741926: ] EDevice 2 init p2p of link 1 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[[2022-12-11 18:30:522022-12-11 18:30:52..934275934275: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 5.26 MBeager alloc mem 5.26 MB

[2022-12-11 18:30:52.939290: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.940115: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.940424: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.940454: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:30:52.941890: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 18:30:52.942429: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8780960 / 882774585 nodes ( 0.99 %~1.00 %) | remote 6179418 / 882774585 nodes ( 0.70 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.23 GB | 1.66822 secs 
[2022-12-11 18:30:52.943374: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.40 GB
[2022-12-11 18:30:52.943900: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 18:30:52.944147: [E2022-12-11 18:30:52 [./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 18:30:52944161:.: 638944182E] :  eager release cuda mem 38842080E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
 :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu638:] 1955eager release cuda mem 38842080] 
Asymm Coll cache (policy: coll_cache_asymm_link) | local 8780960 / 882774585 nodes ( 0.99 %~1.00 %) | remote 6179418 / 882774585 nodes ( 0.70 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.23 GB | 1.45346 secs 
[2022-12-11 18:30:52.944571: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7898186 / 882774585 nodes ( 0.89 %~1.00 %) | remote 7062192 / 882774585 nodes ( 0.80 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 3.81 GB | 1.46976 secs 
[2022-12-11 18:30:52.944669: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8780960 / 882774585 nodes ( 0.99 %~1.00 %) | remote 6179418 / 882774585 nodes ( 0.70 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.23 GB | 1.48889 secs 
[2022-12-11 18:30:54.168461: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.65 GB
[2022-12-11 18:30:54.168644: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.65 GB
[2022-12-11 18:30:54.168965: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.65 GB
[2022-12-11 18:30:54.942118: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.90 GB
[2022-12-11 18:30:54.942242: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.90 GB
[2022-12-11 18:30:54.974983: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.90 GB
[2022-12-11 18:30:55.761063: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.14 GB
[2022-12-11 18:30:55.761182: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.14 GB
[2022-12-11 18:30:55.761501: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.14 GB
[2022-12-11 18:30:56.560755: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.55 GB
[2022-12-11 18:30:56.560887: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.55 GB
[2022-12-11 18:30:56.561301: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.55 GB
[2022-12-11 18:30:57.222976: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.74 GB
[2022-12-11 18:30:57.223104: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.74 GB
[HCTR][18:30:57.327][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][18:30:57.327][ERROR][RK0][tid #140602968618752]: replica 1 calling init per replica done, doing barrier
[HCTR][18:30:57.327][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][18:30:57.327][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][18:30:57.327][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][18:30:57.327][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][18:30:57.327][ERROR][RK0][tid #140602968618752]: replica 1 calling init per replica done, doing barrier done
[HCTR][18:30:57.327][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][18:30:57.327][ERROR][RK0][tid #140602968618752]: init per replica done
[HCTR][18:30:57.327][ERROR][RK0][main]: init per replica done
[HCTR][18:30:57.327][ERROR][RK0][main]: init per replica done
[HCTR][18:30:57.347][ERROR][RK0][main]: init per replica done




