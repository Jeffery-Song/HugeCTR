2022-12-11 18:51:36.414314: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:51:36.469126: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:51:36.480545: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:51:36.481938: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:51:37.262394: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:51:37.262470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 18:51:37.275411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 18:51:37.310057: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:51:37.310217: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:51:37.312326: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 18:51:37.320034: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:51:37.320096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 18:51:37.332576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 18:51:37.338219: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:51:37.338286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 18:51:37.339732: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:51:37.339797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 18:51:37.350874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 18:51:37.352165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 18:51:37.365393: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:51:37.365539: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:51:37.367048: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 18:51:37.381463: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:51:37.381616: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:51:37.382862: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:51:37.382969: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:51:37.383071: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 18:51:37.384438: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][18:51:38.582][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:51:38.600][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:51:38.634][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:51:38.650][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:00,  3.60it/s]warmup run: 1it [00:00,  3.58it/s]warmup run: 1it [00:00,  3.39it/s]warmup run: 80it [00:00, 269.94it/s]warmup run: 87it [00:00, 292.24it/s]warmup run: 81it [00:00, 262.86it/s]warmup run: 155it [00:00, 426.10it/s]warmup run: 159it [00:00, 430.74it/s]warmup run: 157it [00:00, 418.97it/s]warmup run: 229it [00:00, 524.81it/s]warmup run: 228it [00:00, 512.08it/s]warmup run: 228it [00:00, 508.31it/s]warmup run: 306it [00:00, 598.77it/s]warmup run: 300it [00:00, 575.66it/s]warmup run: 299it [00:00, 568.66it/s]warmup run: 381it [00:00, 642.97it/s]warmup run: 377it [00:00, 632.77it/s]warmup run: 368it [00:00, 602.91it/s]warmup run: 457it [00:00, 677.60it/s]warmup run: 447it [00:00, 649.47it/s]warmup run: 435it [00:00, 621.37it/s]warmup run: 533it [00:00, 699.95it/s]warmup run: 517it [00:00, 664.35it/s]warmup run: 508it [00:01, 651.82it/s]warmup run: 610it [00:01, 719.30it/s]warmup run: 589it [00:01, 677.03it/s]warmup run: 581it [00:01, 673.10it/s]warmup run: 687it [00:01, 731.28it/s]warmup run: 663it [00:01, 693.81it/s]warmup run: 653it [00:01, 686.26it/s]warmup run: 1it [00:01,  1.27s/it]warmup run: 737it [00:01, 705.34it/s]warmup run: 762it [00:01, 712.32it/s]warmup run: 733it [00:01, 719.72it/s]warmup run: 79it [00:01, 79.25it/s]warmup run: 812it [00:01, 715.43it/s]warmup run: 807it [00:01, 718.92it/s]warmup run: 835it [00:01, 690.77it/s]warmup run: 171it [00:01, 184.98it/s]warmup run: 885it [00:01, 707.67it/s]warmup run: 880it [00:01, 721.20it/s]warmup run: 913it [00:01, 714.10it/s]warmup run: 263it [00:01, 296.61it/s]warmup run: 957it [00:01, 695.92it/s]warmup run: 953it [00:01, 720.22it/s]warmup run: 986it [00:01, 712.03it/s]warmup run: 346it [00:01, 390.95it/s]warmup run: 1041it [00:01, 737.85it/s]warmup run: 1026it [00:01, 716.89it/s]warmup run: 1058it [00:01, 693.82it/s]warmup run: 440it [00:01, 502.14it/s]warmup run: 1125it [00:01, 765.90it/s]warmup run: 1098it [00:01, 716.24it/s]warmup run: 1128it [00:01, 677.73it/s]warmup run: 533it [00:01, 598.10it/s]warmup run: 1203it [00:01, 766.81it/s]warmup run: 1170it [00:01, 703.19it/s]warmup run: 1197it [00:01, 668.15it/s]warmup run: 620it [00:01, 658.20it/s]warmup run: 1290it [00:02, 796.99it/s]warmup run: 1241it [00:02, 701.31it/s]warmup run: 1265it [00:02, 663.71it/s]warmup run: 706it [00:02, 708.72it/s]warmup run: 1370it [00:02, 787.23it/s]warmup run: 1313it [00:02, 703.56it/s]warmup run: 1336it [00:02, 674.48it/s]warmup run: 792it [00:02, 745.42it/s]warmup run: 1449it [00:02, 771.24it/s]warmup run: 1385it [00:02, 707.68it/s]warmup run: 1406it [00:02, 680.20it/s]warmup run: 878it [00:02, 770.57it/s]warmup run: 1527it [00:02, 764.93it/s]warmup run: 1462it [00:02, 724.13it/s]warmup run: 1476it [00:02, 685.15it/s]warmup run: 963it [00:02, 786.83it/s]warmup run: 1541it [00:02, 741.80it/s]warmup run: 1604it [00:02, 749.33it/s]warmup run: 1547it [00:02, 691.16it/s]warmup run: 1051it [00:02, 811.76it/s]warmup run: 1626it [00:02, 771.49it/s]warmup run: 1685it [00:02, 765.96it/s]warmup run: 1618it [00:02, 695.10it/s]warmup run: 1140it [00:02, 832.16it/s]warmup run: 1704it [00:02, 767.56it/s]warmup run: 1762it [00:02, 745.03it/s]warmup run: 1688it [00:02, 695.83it/s]warmup run: 1231it [00:02, 852.58it/s]warmup run: 1781it [00:02, 749.26it/s]warmup run: 1837it [00:02, 730.58it/s]warmup run: 1759it [00:02, 698.80it/s]warmup run: 1319it [00:02, 858.90it/s]warmup run: 1857it [00:02, 741.06it/s]warmup run: 1830it [00:02, 699.39it/s]warmup run: 1911it [00:02, 701.74it/s]warmup run: 1409it [00:02, 868.69it/s]warmup run: 1932it [00:02, 734.44it/s]warmup run: 1901it [00:02, 699.70it/s]warmup run: 1982it [00:02, 687.99it/s]warmup run: 1499it [00:02, 877.20it/s]warmup run: 2008it [00:03, 741.06it/s]warmup run: 1971it [00:03, 689.72it/s]warmup run: 2051it [00:03, 680.19it/s]warmup run: 1588it [00:03, 869.08it/s]warmup run: 2087it [00:03, 754.48it/s]warmup run: 2042it [00:03, 695.24it/s]warmup run: 2120it [00:03, 664.65it/s]warmup run: 1677it [00:03, 872.82it/s]warmup run: 2163it [00:03, 754.01it/s]warmup run: 2115it [00:03, 704.67it/s]warmup run: 2187it [00:03, 658.66it/s]warmup run: 1765it [00:03, 868.43it/s]warmup run: 2239it [00:03, 742.57it/s]warmup run: 2187it [00:03, 707.57it/s]warmup run: 2253it [00:03, 657.71it/s]warmup run: 1853it [00:03, 868.52it/s]warmup run: 2260it [00:03, 711.85it/s]warmup run: 2314it [00:03, 731.23it/s]warmup run: 2319it [00:03, 653.10it/s]warmup run: 1942it [00:03, 872.44it/s]warmup run: 2340it [00:03, 735.03it/s]warmup run: 2388it [00:03, 699.68it/s]warmup run: 2389it [00:03, 664.45it/s]warmup run: 2030it [00:03, 873.52it/s]warmup run: 2416it [00:03, 739.82it/s]warmup run: 2461it [00:03, 706.71it/s]warmup run: 2460it [00:03, 676.89it/s]warmup run: 2119it [00:03, 877.74it/s]warmup run: 2492it [00:03, 743.13it/s]warmup run: 2539it [00:03, 727.26it/s]warmup run: 2531it [00:03, 685.94it/s]warmup run: 2209it [00:03, 883.08it/s]warmup run: 2567it [00:03, 740.70it/s]warmup run: 2613it [00:03, 730.51it/s]warmup run: 2602it [00:03, 691.63it/s]warmup run: 2298it [00:03, 882.22it/s]warmup run: 2642it [00:03, 732.75it/s]warmup run: 2387it [00:04, 883.76it/s]warmup run: 2476it [00:04, 876.09it/s]warmup run: 2687it [00:04, 491.54it/s]warmup run: 2672it [00:04, 450.57it/s]warmup run: 2564it [00:04, 874.60it/s]warmup run: 2716it [00:04, 510.11it/s]warmup run: 2759it [00:04, 540.80it/s]warmup run: 2742it [00:04, 503.22it/s]warmup run: 2789it [00:04, 559.42it/s]warmup run: 2832it [00:04, 584.97it/s]warmup run: 2811it [00:04, 546.26it/s]warmup run: 2862it [00:04, 600.73it/s]warmup run: 2904it [00:04, 619.10it/s]warmup run: 2883it [00:04, 589.41it/s]warmup run: 2652it [00:04, 560.14it/s]warmup run: 2937it [00:04, 637.99it/s]warmup run: 2973it [00:04, 636.46it/s]warmup run: 2952it [00:04, 613.71it/s]warmup run: 3000it [00:04, 652.96it/s]warmup run: 2741it [00:04, 630.29it/s]warmup run: 3000it [00:04, 649.84it/s]warmup run: 3000it [00:04, 643.86it/s]warmup run: 2824it [00:04, 675.29it/s]warmup run: 2913it [00:04, 727.48it/s]warmup run: 2999it [00:04, 761.43it/s]warmup run: 3000it [00:04, 610.59it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1804.83it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1699.53it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1744.86it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1742.05it/s]warmup should be done:  12%|█▏        | 364/3000 [00:00<00:01, 1818.85it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1778.01it/s]warmup should be done:  11%|█▏        | 340/3000 [00:00<00:01, 1677.50it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1713.84it/s]warmup should be done:  18%|█▊        | 546/3000 [00:00<00:01, 1810.77it/s]warmup should be done:  18%|█▊        | 536/3000 [00:00<00:01, 1783.52it/s]warmup should be done:  17%|█▋        | 518/3000 [00:00<00:01, 1722.04it/s]warmup should be done:  18%|█▊        | 530/3000 [00:00<00:01, 1750.76it/s]warmup should be done:  24%|██▍       | 728/3000 [00:00<00:01, 1811.76it/s]warmup should be done:  23%|██▎       | 698/3000 [00:00<00:01, 1749.28it/s]warmup should be done:  24%|██▎       | 709/3000 [00:00<00:01, 1763.64it/s]warmup should be done:  24%|██▍       | 715/3000 [00:00<00:01, 1745.06it/s]warmup should be done:  30%|███       | 910/3000 [00:00<00:01, 1805.28it/s]warmup should be done:  29%|██▉       | 878/3000 [00:00<00:01, 1764.88it/s]warmup should be done:  30%|██▉       | 886/3000 [00:00<00:01, 1764.49it/s]warmup should be done:  30%|██▉       | 893/3000 [00:00<00:01, 1756.99it/s]warmup should be done:  36%|███▋      | 1091/3000 [00:00<00:01, 1806.34it/s]warmup should be done:  35%|███▌      | 1059/3000 [00:00<00:01, 1776.95it/s]warmup should be done:  36%|███▌      | 1069/3000 [00:00<00:01, 1751.47it/s]warmup should be done:  35%|███▌      | 1063/3000 [00:00<00:01, 1735.62it/s]warmup should be done:  42%|████▏     | 1272/3000 [00:00<00:00, 1806.12it/s]warmup should be done:  41%|████      | 1237/3000 [00:00<00:00, 1763.58it/s]warmup should be done:  42%|████▏     | 1247/3000 [00:00<00:00, 1760.03it/s]warmup should be done:  41%|████      | 1237/3000 [00:00<00:01, 1715.58it/s]warmup should be done:  48%|████▊     | 1453/3000 [00:00<00:00, 1803.97it/s]warmup should be done:  48%|████▊     | 1425/3000 [00:00<00:00, 1765.03it/s]warmup should be done:  47%|████▋     | 1412/3000 [00:00<00:00, 1724.34it/s]warmup should be done:  47%|████▋     | 1414/3000 [00:00<00:00, 1694.02it/s]warmup should be done:  53%|█████▎    | 1603/3000 [00:00<00:00, 1768.32it/s]warmup should be done:  54%|█████▍    | 1634/3000 [00:00<00:00, 1765.26it/s]warmup should be done:  53%|█████▎    | 1589/3000 [00:00<00:00, 1737.22it/s]warmup should be done:  53%|█████▎    | 1589/3000 [00:00<00:00, 1708.98it/s]warmup should be done:  59%|█████▉    | 1780/3000 [00:01<00:00, 1767.59it/s]warmup should be done:  60%|██████    | 1811/3000 [00:01<00:00, 1762.06it/s]warmup should be done:  59%|█████▉    | 1766/3000 [00:01<00:00, 1744.96it/s]warmup should be done:  59%|█████▊    | 1761/3000 [00:01<00:00, 1687.58it/s]warmup should be done:  65%|██████▌   | 1957/3000 [00:01<00:00, 1766.91it/s]warmup should be done:  66%|██████▋   | 1988/3000 [00:01<00:00, 1761.31it/s]warmup should be done:  65%|██████▍   | 1942/3000 [00:01<00:00, 1746.54it/s]warmup should be done:  64%|██████▍   | 1934/3000 [00:01<00:00, 1698.61it/s]warmup should be done:  71%|███████   | 2134/3000 [00:01<00:00, 1767.01it/s]warmup should be done:  71%|███████   | 2117/3000 [00:01<00:00, 1732.05it/s]warmup should be done:  72%|███████▏  | 2165/3000 [00:01<00:00, 1731.18it/s]warmup should be done:  70%|███████   | 2109/3000 [00:01<00:00, 1711.72it/s]warmup should be done:  77%|███████▋  | 2312/3000 [00:01<00:00, 1770.54it/s]warmup should be done:  78%|███████▊  | 2342/3000 [00:01<00:00, 1740.54it/s]warmup should be done:  76%|███████▋  | 2291/3000 [00:01<00:00, 1727.23it/s]warmup should be done:  76%|███████▌  | 2283/3000 [00:01<00:00, 1719.18it/s]warmup should be done:  83%|████████▎ | 2492/3000 [00:01<00:00, 1776.64it/s]warmup should be done:  82%|████████▏ | 2467/3000 [00:01<00:00, 1735.94it/s]warmup should be done:  84%|████████▍ | 2517/3000 [00:01<00:00, 1719.22it/s]warmup should be done:  82%|████████▏ | 2461/3000 [00:01<00:00, 1734.73it/s]warmup should be done:  89%|████████▉ | 2672/3000 [00:01<00:00, 1782.05it/s]warmup should be done:  88%|████████▊ | 2641/3000 [00:01<00:00, 1729.66it/s]warmup should be done:  90%|████████▉ | 2692/3000 [00:01<00:00, 1727.01it/s]warmup should be done:  88%|████████▊ | 2636/3000 [00:01<00:00, 1738.66it/s]warmup should be done:  95%|█████████▌| 2851/3000 [00:01<00:00, 1779.05it/s]warmup should be done:  94%|█████████▍| 2818/3000 [00:01<00:00, 1740.60it/s]warmup should be done:  94%|█████████▎| 2811/3000 [00:01<00:00, 1740.55it/s]warmup should be done:  96%|█████████▌| 2865/3000 [00:01<00:00, 1711.16it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1765.62it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1759.54it/s]warmup should be done: 100%|█████████▉| 2993/3000 [00:01<00:00, 1695.42it/s]warmup should be done: 100%|█████████▉| 2986/3000 [00:01<00:00, 1717.60it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1728.82it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1722.76it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1807.68it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1659.65it/s]warmup should be done:   6%|▌         | 182/3000 [00:00<00:01, 1815.93it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1636.47it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1757.52it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1803.10it/s]warmup should be done:  12%|█▏        | 365/3000 [00:00<00:01, 1820.22it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1746.01it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1798.06it/s]warmup should be done:  18%|█▊        | 549/3000 [00:00<00:01, 1826.39it/s]warmup should be done:  17%|█▋        | 523/3000 [00:00<00:01, 1705.55it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1736.65it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1822.05it/s]warmup should be done:  24%|██▍       | 732/3000 [00:00<00:01, 1823.03it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1751.10it/s]warmup should be done:  24%|██▍       | 726/3000 [00:00<00:01, 1769.94it/s]warmup should be done:  30%|███       | 907/3000 [00:00<00:01, 1837.01it/s]warmup should be done:  31%|███       | 917/3000 [00:00<00:01, 1830.73it/s]warmup should be done:  30%|██▉       | 891/3000 [00:00<00:01, 1783.22it/s]warmup should be done:  30%|███       | 910/3000 [00:00<00:01, 1794.09it/s]warmup should be done:  36%|███▋      | 1094/3000 [00:00<00:01, 1845.57it/s]warmup should be done:  37%|███▋      | 1101/3000 [00:00<00:01, 1832.22it/s]warmup should be done:  36%|███▌      | 1070/3000 [00:00<00:01, 1776.85it/s]warmup should be done:  36%|███▋      | 1095/3000 [00:00<00:01, 1810.86it/s]warmup should be done:  43%|████▎     | 1280/3000 [00:00<00:00, 1848.12it/s]warmup should be done:  43%|████▎     | 1285/3000 [00:00<00:00, 1831.13it/s]warmup should be done:  42%|████▏     | 1252/3000 [00:00<00:00, 1790.34it/s]warmup should be done:  43%|████▎     | 1279/3000 [00:00<00:00, 1817.25it/s]warmup should be done:  49%|████▉     | 1467/3000 [00:00<00:00, 1854.20it/s]warmup should be done:  48%|████▊     | 1437/3000 [00:00<00:00, 1807.08it/s]warmup should be done:  49%|████▉     | 1469/3000 [00:00<00:00, 1790.17it/s]warmup should be done:  49%|████▉     | 1464/3000 [00:00<00:00, 1825.01it/s]warmup should be done:  55%|█████▌    | 1653/3000 [00:00<00:00, 1855.53it/s]warmup should be done:  54%|█████▍    | 1622/3000 [00:00<00:00, 1818.49it/s]warmup should be done:  55%|█████▍    | 1649/3000 [00:00<00:00, 1791.74it/s]warmup should be done:  55%|█████▍    | 1647/3000 [00:00<00:00, 1814.70it/s]warmup should be done:  61%|██████▏   | 1840/3000 [00:01<00:00, 1858.70it/s]warmup should be done:  60%|██████    | 1804/3000 [00:01<00:00, 1818.05it/s]warmup should be done:  61%|██████    | 1832/3000 [00:01<00:00, 1824.62it/s]warmup should be done:  61%|██████    | 1829/3000 [00:01<00:00, 1776.32it/s]warmup should be done:  68%|██████▊   | 2027/3000 [00:01<00:00, 1860.43it/s]warmup should be done:  66%|██████▋   | 1989/3000 [00:01<00:00, 1825.12it/s]warmup should be done:  67%|██████▋   | 2012/3000 [00:01<00:00, 1789.78it/s]warmup should be done:  67%|██████▋   | 2015/3000 [00:01<00:00, 1818.36it/s]warmup should be done:  74%|███████▍  | 2214/3000 [00:01<00:00, 1861.55it/s]warmup should be done:  72%|███████▏  | 2174/3000 [00:01<00:00, 1830.71it/s]warmup should be done:  73%|███████▎  | 2196/3000 [00:01<00:00, 1803.16it/s]warmup should be done:  73%|███████▎  | 2197/3000 [00:01<00:00, 1786.84it/s]warmup should be done:  80%|████████  | 2401/3000 [00:01<00:00, 1862.80it/s]warmup should be done:  79%|███████▊  | 2358/3000 [00:01<00:00, 1833.44it/s]warmup should be done:  79%|███████▉  | 2380/3000 [00:01<00:00, 1813.42it/s]warmup should be done:  79%|███████▉  | 2376/3000 [00:01<00:00, 1743.91it/s]warmup should be done:  86%|████████▋ | 2589/3000 [00:01<00:00, 1865.16it/s]warmup should be done:  85%|████████▍ | 2543/3000 [00:01<00:00, 1837.02it/s]warmup should be done:  86%|████████▌ | 2566/3000 [00:01<00:00, 1826.42it/s]warmup should be done:  85%|████████▌ | 2557/3000 [00:01<00:00, 1761.71it/s]warmup should be done:  93%|█████████▎| 2776/3000 [00:01<00:00, 1865.88it/s]warmup should be done:  91%|█████████ | 2727/3000 [00:01<00:00, 1837.77it/s]warmup should be done:  92%|█████████▏| 2749/3000 [00:01<00:00, 1821.15it/s]warmup should be done:  91%|█████████▏| 2740/3000 [00:01<00:00, 1779.49it/s]warmup should be done:  99%|█████████▉| 2964/3000 [00:01<00:00, 1867.27it/s]warmup should be done:  97%|█████████▋| 2911/3000 [00:01<00:00, 1837.42it/s]warmup should be done:  98%|█████████▊| 2932/3000 [00:01<00:00, 1819.41it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1847.72it/s]warmup should be done:  97%|█████████▋| 2919/3000 [00:01<00:00, 1767.22it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1812.59it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1807.50it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1787.78it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f33abb73190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f33abb73280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f33abb730a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f33abb73160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 18:52:18.797273: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f2f815bf9d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:52:18.797330: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:52:18.804528: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:52:19.836722: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:52:20.424435: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f2f815c3ed0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:52:20.424504: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:52:20.435992: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:52:20.462781: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f2f81dc7860 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:52:20.462848: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:52:20.466773: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f2f815c2bb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:52:20.466831: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:52:20.471454: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:52:20.477387: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:52:21.079042: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:52:21.108242: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:52:21.258335: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:52:21.491121: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:52:22.498364: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:52:22.524985: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:52:22.960572: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][18:53:30.901][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][18:53:30.901][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:53:30.904][ERROR][RK0][main]: coll ps creation done
[HCTR][18:53:30.904][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][18:53:32.423][ERROR][RK0][tid #139842121889536]: replica 2 reaches 1000, calling init pre replica
[HCTR][18:53:32.424][ERROR][RK0][tid #139842121889536]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:53:32.428][ERROR][RK0][tid #139842121889536]: coll ps creation done
[HCTR][18:53:32.428][ERROR][RK0][tid #139842121889536]: replica 2 waits for coll ps creation barrier
[HCTR][18:53:32.590][ERROR][RK0][tid #139842121889536]: replica 1 reaches 1000, calling init pre replica
[HCTR][18:53:32.590][ERROR][RK0][tid #139842121889536]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:53:32.594][ERROR][RK0][tid #139842121889536]: coll ps creation done
[HCTR][18:53:32.594][ERROR][RK0][tid #139842121889536]: replica 1 waits for coll ps creation barrier
[HCTR][18:53:32.647][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][18:53:32.647][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:53:32.651][ERROR][RK0][main]: coll ps creation done
[HCTR][18:53:32.651][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][18:53:32.651][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][18:53:42.799][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][18:53:42.835][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][18:53:42.835][ERROR][RK0][main]: Calling build_v2
[HCTR][18:53:42.835][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][18:53:42.835][ERROR][RK0][tid #139842121889536]: replica 1 calling init per replica
[HCTR][18:53:42.835][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:53:42.835][ERROR][RK0][main]: Calling build_v2
[HCTR][18:53:42.835][ERROR][RK0][tid #139842121889536]: Calling build_v2
[HCTR][18:53:42.835][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:53:42.835][ERROR][RK0][tid #139842121889536]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[2022-12-11 18:53:422022-12-11 18:53:42[..835756835759: : EE  2022-12-11 18:53:42/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc.::835763136136: ] ] Eusing concurrent impl MPSusing concurrent impl MPS 

/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[HCTR][18:53:42.835][ERROR][RK0][tid #139842121889536]: replica 2 calling init per replica
[HCTR][18:53:42.836][ERROR][RK0][tid #139842121889536]: Calling build_v2
[HCTR][18:53:42.836][ERROR][RK0][tid #139842121889536]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 18:53:42.836108: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 18:53:42.837158: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196[] 2022-12-11 18:53:42assigning 8 to cpu.
837180: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 18:53:42.837249: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 18:53:42:.[2128372552022-12-11 18:53:42] : .build symm link desc with 4X Tesla V100-SXM2-16GB out of 4E837283
 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE[: [2022-12-11 18:53:42196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 18:53:42.] :.837340assigning 8 to cpu196837352: 
] : Eassigning 8 to cpuE 
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::212213] ] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4remote time is 8.68421

[[[2022-12-11 18:53:422022-12-11 18:53:422022-12-11 18:53:42...837484837480837487: : : [EEE2022-12-11 18:53:42   ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc837516:::: 214212213E] ] ]  cpu time is 30build symm link desc with 4X Tesla V100-SXM2-16GB out of 4remote time is 8.68421/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc


:212[[] 2022-12-11 18:53:422022-12-11 18:53:42build symm link desc with 4X Tesla V100-SXM2-16GB out of 4..
837692837696: : EE [ /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 18:53:42/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:.:214837751213] : ] cpu time is 30Eremote time is 8.68421
 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2132022-12-11 18:53:42] .remote time is 8.68421837853
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30[
2022-12-11 18:53:42.837887: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 18:54:17.419859: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 18:54:17.911055: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 3.29 GB
[2022-12-11 18:54:17.911157: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 3.29 GB
[2022-12-11 18:54:17.912192: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 18:54:18.804323: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 18:54:20.654134: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 2
[2022-12-11 18:54:20.654236: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 18:55:34. 84606: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1001
[2022-12-11 18:55:34. 84770: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 18:55:49.129943: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 18:55:49.130129: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1001
[2022-12-11 18:55:49.437458: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 18:55:49.437538: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1001 blocks, 4 devices
[2022-12-11 18:55:50.772161: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 18:55:50.791712: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 18:55:50.792570: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 18:55:50.802867: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 18:55:50.897264: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 18:55:55.480164: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 18:55:55.484631: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 18:55:55.485204: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 18:55:55.496916: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 18:55:55.496993: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 18:55:55.497027: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 18:55:55.497058: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 18:55:55.497775: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:55:55.497823: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:55:55.501693: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:55:55.505459: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:55:55.676975: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 18:55:55.677086: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 18:55:55.679380: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 18:55:55.679485: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 18:55:55.680766: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 18:55:55.680860: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 18:55:55.681618: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:55:55.681667: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:55:55.685679: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:55:55.689542: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:55:55.738645: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:55:55.738794: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:55:55.742710: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:55:55.742895: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:55:55.752870: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:55:55.753034: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:55:55.761319: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:55:55.761481: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:55:55.940624: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 18:55:55.940980: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:55:55.954819: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1001
[2022-12-11 18:55:55.954875: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:55:55.959072: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:55:55.959881: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:55.966397: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:55.966627: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.13 MB
[2022-12-11 18:55:55.982209: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:55:55.987335: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:55:55.987472: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.81 GB
[2022-12-11 18:55:56.298358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 18:55:56.298614: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:55:56.312531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1001
[2022-12-11 18:55:56.312582: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:55:56.316741: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:55:56.317240: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:56.323756: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:56.323932: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.13 MB
[2022-12-11 18:55:56.337721: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:55:56.342796: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:55:56.342837: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.81 GB
[2022-12-11 18:55:56.537521: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 18:55:56.537765: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:55:56.551599: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1001
[2022-12-11 18:55:56.551648: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:55:56.555837: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:55:56.556352: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:56.563425: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:56.563625: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.50 MB
[2022-12-11 18:55:56.604239: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:55:56.609217: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:55:56.609260: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.23 GB
[2022-12-11 18:55:56.676132: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 18:55:56.676519: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:55:56.690358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1001
[2022-12-11 18:55:56.690412: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:55:56.694674: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:55:56.695452: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:56.702541: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:56.702719: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.50 MB
[2022-12-11 18:55:56.746282: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:55:56.751334: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:55:56.751377: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.23 GB
[[2022-12-11 18:55:572022-12-11 18:55:57..190090190089: : EE[ [ 2022-12-11 18:55:57/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 18:55:57/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:.:19009519261901011926: ] : ] EDevice 3 init p2p of link 0EDevice 2 init p2p of link 3 
 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261926] ] Device 0 init p2p of link 1Device 1 init p2p of link 2

[2022-12-11 18:55:57.190421: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:57.190457: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:57.190614: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:57.194173: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:57.196887: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:57.196965: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:57.197134: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:57.200608: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:57.200729: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 18:55:57.200852: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:57.201277: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 18:55:57.201382: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:57.201799: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 18:55:57.201923: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:57.203638: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 18:55:57.203753: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:57.206942: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:57.207563: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:57.208013: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[[2022-12-11 18:55:572022-12-11 18:55:57..209741209740: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::6381926] ] eager release cuda mem 5518079Device 3 init p2p of link 2

[2022-12-11 18:55:57.209913: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:57.210628: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 18:55:57.210724: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:57.211861: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 18:55:57.211946: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:57.213364: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 18:55:57.213460: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:55:57.216135: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:57.216895: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:57.217934: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:55:57.219408: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[[2022-12-11 18:55:572022-12-11 18:55:57..219581219587: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 38842080eager release cuda mem 38842080

[2022-12-11 18:55:57.220100: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8780960 / 882774585 nodes ( 0.99 %~1.00 %) | remote 6179418 / 882774585 nodes ( 0.70 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.23 GB | 1.53844 secs 
[2022-12-11 18:55:57.220184: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8780960 / 882774585 nodes ( 0.99 %~1.00 %) | remote 6179418 / 882774585 nodes ( 0.70 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.23 GB | 1.47733 secs 
[2022-12-11 18:55:57.220670: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 18:55:57.221022: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7898186 / 882774585 nodes ( 0.89 %~1.00 %) | remote 7062192 / 882774585 nodes ( 0.80 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 3.81 GB | 1.48226 secs 
[2022-12-11 18:55:57.223014: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 18:55:57.223337: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7898186 / 882774585 nodes ( 0.89 %~1.00 %) | remote 7062192 / 882774585 nodes ( 0.80 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 3.81 GB | 1.72553 secs 
[2022-12-11 18:55:57.225303: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.46 GB
[2022-12-11 18:55:58.118021: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.70 GB
[2022-12-11 18:55:58.118177: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.70 GB
[2022-12-11 18:55:58.118513: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.70 GB
[2022-12-11 18:55:58.925583: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.95 GB
[2022-12-11 18:55:58.925708: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.95 GB
[2022-12-11 18:55:58.926137: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.95 GB
[2022-12-11 18:55:59.726649: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.19 GB
[2022-12-11 18:55:59.726764: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.19 GB
[2022-12-11 18:55:59.727103: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.19 GB
[2022-12-11 18:56:00.613779: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.60 GB
[2022-12-11 18:56:00.613921: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.60 GB
[2022-12-11 18:56:00.614371: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.60 GB
[2022-12-11 18:56:01.490058: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.79 GB
[2022-12-11 18:56:01.490179: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.79 GB
[HCTR][18:56:01.651][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][18:56:01.651][ERROR][RK0][tid #139842121889536]: replica 2 calling init per replica done, doing barrier
[HCTR][18:56:01.651][ERROR][RK0][tid #139842121889536]: replica 1 calling init per replica done, doing barrier
[HCTR][18:56:01.651][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][18:56:01.651][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][18:56:01.651][ERROR][RK0][tid #139842121889536]: replica 2 calling init per replica done, doing barrier done
[HCTR][18:56:01.651][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][18:56:01.651][ERROR][RK0][tid #139842121889536]: replica 1 calling init per replica done, doing barrier done
[HCTR][18:56:01.651][ERROR][RK0][tid #139842121889536]: init per replica done
[HCTR][18:56:01.651][ERROR][RK0][main]: init per replica done
[HCTR][18:56:01.651][ERROR][RK0][tid #139842121889536]: init per replica done
[HCTR][18:56:01.812][ERROR][RK0][main]: init per replica done
