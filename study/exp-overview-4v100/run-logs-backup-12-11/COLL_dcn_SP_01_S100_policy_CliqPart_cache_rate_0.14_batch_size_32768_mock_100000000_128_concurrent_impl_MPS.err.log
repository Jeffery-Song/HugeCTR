2022-12-12 01:12:57.777911: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:12:57.783304: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:12:57.811978: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:12:57.842504: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:12:58.704050: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:12:58.704134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:12:58.707239: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:12:58.707309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:12:58.717501: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:12:58.717628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:12:58.717884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:12:58.719627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:12:58.721379: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:12:58.721432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:12:58.733154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:12:58.736663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:12:58.747977: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:12:58.748167: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:12:58.748935: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:12:58.749068: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:12:58.749621: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 01:12:58.750510: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 01:12:58.763071: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:12:58.763275: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:12:58.764918: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 01:12:58.768228: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:12:58.768378: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:12:58.769990: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][01:13:00.004][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:13:00.026][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:13:00.059][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:13:00.061][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 1it [00:01,  1.50s/it]warmup run: 100it [00:01, 89.17it/s]warmup run: 102it [00:01, 88.30it/s]warmup run: 208it [00:01, 201.20it/s]warmup run: 196it [00:01, 182.12it/s]warmup run: 311it [00:01, 316.50it/s]warmup run: 300it [00:01, 298.63it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 415it [00:01, 435.99it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 405it [00:01, 420.77it/s]warmup run: 103it [00:01, 92.63it/s]warmup run: 525it [00:01, 562.72it/s]warmup run: 104it [00:01, 91.23it/s]warmup run: 515it [00:02, 548.08it/s]warmup run: 207it [00:01, 200.74it/s]warmup run: 636it [00:02, 680.06it/s]warmup run: 209it [00:01, 198.27it/s]warmup run: 626it [00:02, 666.76it/s]warmup run: 314it [00:01, 321.96it/s]warmup run: 746it [00:02, 777.29it/s]warmup run: 310it [00:01, 309.87it/s]warmup run: 733it [00:02, 759.35it/s]warmup run: 417it [00:01, 439.42it/s]warmup run: 852it [00:02, 846.75it/s]warmup run: 417it [00:01, 434.22it/s]warmup run: 839it [00:02, 833.22it/s]warmup run: 517it [00:01, 546.93it/s]warmup run: 958it [00:02, 895.06it/s]warmup run: 524it [00:01, 554.54it/s]warmup run: 946it [00:02, 895.11it/s]warmup run: 624it [00:02, 658.14it/s]warmup run: 1063it [00:02, 924.97it/s]warmup run: 625it [00:02, 651.07it/s]warmup run: 1053it [00:02, 941.76it/s]warmup run: 731it [00:02, 754.70it/s]warmup run: 1170it [00:02, 963.57it/s]warmup run: 733it [00:02, 749.65it/s]warmup run: 1161it [00:02, 978.73it/s]warmup run: 835it [00:02, 825.52it/s]warmup run: 1275it [00:02, 974.66it/s]warmup run: 840it [00:02, 828.04it/s]warmup run: 1268it [00:02, 1000.68it/s]warmup run: 943it [00:02, 890.69it/s]warmup run: 1383it [00:02, 1004.28it/s]warmup run: 948it [00:02, 893.64it/s]warmup run: 1374it [00:02, 1011.58it/s]warmup run: 1050it [00:02, 938.50it/s]warmup run: 1488it [00:02, 1016.81it/s]warmup run: 1053it [00:02, 935.80it/s]warmup run: 1480it [00:02, 1008.89it/s]warmup run: 1159it [00:02, 978.49it/s]warmup run: 1593it [00:02, 1018.83it/s]warmup run: 1160it [00:02, 972.99it/s]warmup run: 1586it [00:03, 1022.52it/s]warmup run: 1265it [00:02, 989.22it/s]warmup run: 1703it [00:03, 1041.93it/s]warmup run: 1268it [00:02, 1001.59it/s]warmup run: 1692it [00:03, 1032.64it/s]warmup run: 1373it [00:02, 1014.23it/s]warmup run: 1809it [00:03, 1032.13it/s]warmup run: 1376it [00:02, 1021.78it/s]warmup run: 1801it [00:03, 1047.22it/s]warmup run: 1479it [00:02, 1025.48it/s]warmup run: 1920it [00:03, 1053.40it/s]warmup run: 1483it [00:02, 1033.48it/s]warmup run: 1907it [00:03, 1044.52it/s]warmup run: 1585it [00:02, 1031.82it/s]warmup run: 2037it [00:03, 1086.07it/s]warmup run: 1590it [00:02, 1042.75it/s]warmup run: 2016it [00:03, 1057.17it/s]warmup run: 1692it [00:03, 1041.40it/s]warmup run: 2175it [00:03, 1171.54it/s]warmup run: 1698it [00:03, 1051.40it/s]warmup run: 2149it [00:03, 1135.95it/s]warmup run: 1798it [00:03, 1045.48it/s]warmup run: 2301it [00:03, 1195.28it/s]warmup run: 1805it [00:03, 1056.29it/s]warmup run: 2282it [00:03, 1192.17it/s]warmup run: 1905it [00:03, 1051.96it/s]warmup run: 2421it [00:03, 1195.07it/s]warmup run: 1912it [00:03, 1057.07it/s]warmup run: 2416it [00:03, 1234.94it/s]warmup run: 2022it [00:03, 1085.55it/s]warmup run: 2550it [00:03, 1221.77it/s]warmup run: 2025it [00:03, 1077.39it/s]warmup run: 2550it [00:03, 1263.72it/s]warmup run: 2159it [00:03, 1169.87it/s]warmup run: 2684it [00:03, 1256.39it/s]warmup run: 2159it [00:03, 1155.19it/s]warmup run: 2684it [00:03, 1284.16it/s]warmup run: 2296it [00:03, 1228.53it/s]warmup run: 2818it [00:03, 1279.42it/s]warmup run: 2296it [00:03, 1217.20it/s]warmup run: 2817it [00:04, 1295.61it/s]warmup run: 2433it [00:03, 1270.09it/s]warmup run: 2953it [00:04, 1299.98it/s]warmup run: 2433it [00:03, 1260.47it/s]warmup run: 3000it [00:04, 727.09it/s] warmup run: 2950it [00:04, 1305.37it/s]warmup run: 2566it [00:03, 1287.44it/s]warmup run: 3000it [00:04, 719.64it/s] warmup run: 2560it [00:03, 1240.20it/s]warmup run: 2701it [00:03, 1304.16it/s]warmup run: 2698it [00:03, 1279.92it/s]warmup run: 2832it [00:03, 1304.90it/s]warmup run: 2834it [00:03, 1302.29it/s]warmup run: 2966it [00:04, 1313.31it/s]warmup run: 3000it [00:04, 733.22it/s] warmup run: 2971it [00:04, 1322.20it/s]warmup run: 3000it [00:04, 726.86it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 182/3000 [00:00<00:01, 1814.01it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1729.69it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1741.69it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1745.94it/s]warmup should be done:  12%|█▏        | 367/3000 [00:00<00:01, 1832.61it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1791.00it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1773.29it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1790.82it/s]warmup should be done:  18%|█▊        | 551/3000 [00:00<00:01, 1829.73it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1797.53it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1794.15it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1770.93it/s]warmup should be done:  25%|██▍       | 736/3000 [00:00<00:01, 1835.17it/s]warmup should be done:  24%|██▍       | 719/3000 [00:00<00:01, 1799.08it/s]warmup should be done:  24%|██▍       | 722/3000 [00:00<00:01, 1810.72it/s]warmup should be done:  24%|██▎       | 711/3000 [00:00<00:01, 1773.03it/s]warmup should be done:  30%|██▉       | 899/3000 [00:00<00:01, 1798.44it/s]warmup should be done:  30%|███       | 905/3000 [00:00<00:01, 1814.69it/s]warmup should be done:  30%|██▉       | 889/3000 [00:00<00:01, 1772.77it/s]warmup should be done:  31%|███       | 920/3000 [00:00<00:01, 1826.50it/s]warmup should be done:  36%|███▌      | 1079/3000 [00:00<00:01, 1794.16it/s]warmup should be done:  36%|███▌      | 1087/3000 [00:00<00:01, 1811.08it/s]warmup should be done:  36%|███▌      | 1067/3000 [00:00<00:01, 1769.35it/s]warmup should be done:  37%|███▋      | 1103/3000 [00:00<00:01, 1775.27it/s]warmup should be done:  42%|████▏     | 1259/3000 [00:00<00:00, 1795.97it/s]warmup should be done:  42%|████▏     | 1245/3000 [00:00<00:00, 1770.95it/s]warmup should be done:  42%|████▏     | 1269/3000 [00:00<00:00, 1769.78it/s]warmup should be done:  43%|████▎     | 1281/3000 [00:00<00:00, 1751.13it/s]warmup should be done:  47%|████▋     | 1423/3000 [00:00<00:00, 1771.11it/s]warmup should be done:  48%|████▊     | 1439/3000 [00:00<00:00, 1780.99it/s]warmup should be done:  48%|████▊     | 1449/3000 [00:00<00:00, 1778.32it/s]warmup should be done:  49%|████▊     | 1457/3000 [00:00<00:00, 1740.30it/s]warmup should be done:  53%|█████▎    | 1601/3000 [00:00<00:00, 1770.98it/s]warmup should be done:  54%|█████▍    | 1618/3000 [00:00<00:00, 1783.07it/s]warmup should be done:  54%|█████▍    | 1629/3000 [00:00<00:00, 1784.88it/s]warmup should be done:  54%|█████▍    | 1632/3000 [00:00<00:00, 1731.22it/s]warmup should be done:  59%|█████▉    | 1780/3000 [00:01<00:00, 1775.20it/s]warmup should be done:  60%|█████▉    | 1798/3000 [00:01<00:00, 1785.32it/s]warmup should be done:  60%|██████    | 1810/3000 [00:01<00:00, 1791.25it/s]warmup should be done:  60%|██████    | 1806/3000 [00:01<00:00, 1728.36it/s]warmup should be done:  65%|██████▌   | 1960/3000 [00:01<00:00, 1782.57it/s]warmup should be done:  66%|██████▌   | 1978/3000 [00:01<00:00, 1786.89it/s]warmup should be done:  66%|██████▋   | 1994/3000 [00:01<00:00, 1805.83it/s]warmup should be done:  66%|██████▌   | 1985/3000 [00:01<00:00, 1745.63it/s]warmup should be done:  71%|███████▏  | 2142/3000 [00:01<00:00, 1791.79it/s]warmup should be done:  72%|███████▏  | 2157/3000 [00:01<00:00, 1786.24it/s]warmup should be done:  73%|███████▎  | 2178/3000 [00:01<00:00, 1816.04it/s]warmup should be done:  72%|███████▏  | 2165/3000 [00:01<00:00, 1760.13it/s]warmup should be done:  77%|███████▋  | 2324/3000 [00:01<00:00, 1797.80it/s]warmup should be done:  79%|███████▊  | 2362/3000 [00:01<00:00, 1820.95it/s]warmup should be done:  78%|███████▊  | 2343/3000 [00:01<00:00, 1765.39it/s]warmup should be done:  78%|███████▊  | 2336/3000 [00:01<00:00, 1690.50it/s]warmup should be done:  83%|████████▎ | 2504/3000 [00:01<00:00, 1798.42it/s]warmup should be done:  85%|████████▍ | 2545/3000 [00:01<00:00, 1797.24it/s]warmup should be done:  84%|████████▍ | 2524/3000 [00:01<00:00, 1777.69it/s]warmup should be done:  84%|████████▎ | 2511/3000 [00:01<00:00, 1706.81it/s]warmup should be done:  89%|████████▉ | 2684/3000 [00:01<00:00, 1795.71it/s]warmup should be done:  91%|█████████ | 2725/3000 [00:01<00:00, 1787.51it/s]warmup should be done:  90%|█████████ | 2704/3000 [00:01<00:00, 1782.68it/s]warmup should be done:  90%|████████▉ | 2691/3000 [00:01<00:00, 1732.72it/s]warmup should be done:  95%|█████████▌| 2864/3000 [00:01<00:00, 1796.74it/s]warmup should be done:  97%|█████████▋| 2904/3000 [00:01<00:00, 1781.24it/s]warmup should be done:  96%|█████████▌| 2884/3000 [00:01<00:00, 1787.67it/s]warmup should be done:  96%|█████████▌| 2871/3000 [00:01<00:00, 1751.80it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1792.66it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1783.86it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1777.06it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1765.78it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 183/3000 [00:00<00:01, 1829.07it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1735.65it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1802.38it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1777.82it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1830.20it/s]warmup should be done:  12%|█▏        | 369/3000 [00:00<00:01, 1841.50it/s]warmup should be done:  12%|█▏        | 361/3000 [00:00<00:01, 1812.35it/s]warmup should be done:  12%|█▏        | 363/3000 [00:00<00:01, 1819.41it/s]warmup should be done:  18%|█▊        | 551/3000 [00:00<00:01, 1838.05it/s]warmup should be done:  18%|█▊        | 554/3000 [00:00<00:01, 1844.62it/s]warmup should be done:  18%|█▊        | 548/3000 [00:00<00:01, 1837.25it/s]warmup should be done:  18%|█▊        | 549/3000 [00:00<00:01, 1836.09it/s]warmup should be done:  25%|██▍       | 737/3000 [00:00<00:01, 1845.41it/s]warmup should be done:  25%|██▍       | 739/3000 [00:00<00:01, 1845.53it/s]warmup should be done:  24%|██▍       | 733/3000 [00:00<00:01, 1842.09it/s]warmup should be done:  24%|██▍       | 735/3000 [00:00<00:01, 1844.94it/s]warmup should be done:  31%|███       | 919/3000 [00:00<00:01, 1845.97it/s]warmup should be done:  31%|███       | 924/3000 [00:00<00:01, 1842.90it/s]warmup should be done:  31%|███       | 922/3000 [00:00<00:01, 1841.01it/s]warmup should be done:  31%|███       | 921/3000 [00:00<00:01, 1848.72it/s]warmup should be done:  37%|███▋      | 1106/3000 [00:00<00:01, 1852.88it/s]warmup should be done:  37%|███▋      | 1109/3000 [00:00<00:01, 1844.91it/s]warmup should be done:  37%|███▋      | 1108/3000 [00:00<00:01, 1844.99it/s]warmup should be done:  37%|███▋      | 1107/3000 [00:00<00:01, 1851.48it/s]warmup should be done:  43%|████▎     | 1292/3000 [00:00<00:00, 1854.49it/s]warmup should be done:  43%|████▎     | 1294/3000 [00:00<00:00, 1840.70it/s]warmup should be done:  43%|████▎     | 1293/3000 [00:00<00:00, 1846.26it/s]warmup should be done:  43%|████▎     | 1293/3000 [00:00<00:00, 1835.04it/s]warmup should be done:  49%|████▉     | 1479/3000 [00:00<00:00, 1859.20it/s]warmup should be done:  49%|████▉     | 1481/3000 [00:00<00:00, 1847.33it/s]warmup should be done:  49%|████▉     | 1479/3000 [00:00<00:00, 1850.02it/s]warmup should be done:  49%|████▉     | 1479/3000 [00:00<00:00, 1841.16it/s]warmup should be done:  56%|█████▌    | 1666/3000 [00:00<00:00, 1860.82it/s]warmup should be done:  56%|█████▌    | 1668/3000 [00:00<00:00, 1852.87it/s]warmup should be done:  56%|█████▌    | 1665/3000 [00:00<00:00, 1845.42it/s]warmup should be done:  56%|█████▌    | 1665/3000 [00:00<00:00, 1845.58it/s]warmup should be done:  62%|██████▏   | 1853/3000 [00:01<00:00, 1863.13it/s]warmup should be done:  62%|██████▏   | 1855/3000 [00:01<00:00, 1857.74it/s]warmup should be done:  62%|██████▏   | 1851/3000 [00:01<00:00, 1847.82it/s]warmup should be done:  62%|██████▏   | 1850/3000 [00:01<00:00, 1838.46it/s]warmup should be done:  68%|██████▊   | 2040/3000 [00:01<00:00, 1865.05it/s]warmup should be done:  68%|██████▊   | 2042/3000 [00:01<00:00, 1860.70it/s]warmup should be done:  68%|██████▊   | 2036/3000 [00:01<00:00, 1847.76it/s]warmup should be done:  68%|██████▊   | 2035/3000 [00:01<00:00, 1840.14it/s]warmup should be done:  74%|███████▍  | 2227/3000 [00:01<00:00, 1863.13it/s]warmup should be done:  74%|███████▍  | 2221/3000 [00:01<00:00, 1846.87it/s]warmup should be done:  74%|███████▍  | 2229/3000 [00:01<00:00, 1846.55it/s]warmup should be done:  74%|███████▍  | 2220/3000 [00:01<00:00, 1842.80it/s]warmup should be done:  80%|████████  | 2414/3000 [00:01<00:00, 1858.84it/s]warmup should be done:  80%|████████  | 2406/3000 [00:01<00:00, 1845.34it/s]warmup should be done:  81%|████████  | 2417/3000 [00:01<00:00, 1855.47it/s]warmup should be done:  80%|████████  | 2405/3000 [00:01<00:00, 1843.13it/s]warmup should be done:  87%|████████▋ | 2602/3000 [00:01<00:00, 1863.74it/s]warmup should be done:  86%|████████▋ | 2591/3000 [00:01<00:00, 1845.48it/s]warmup should be done:  87%|████████▋ | 2605/3000 [00:01<00:00, 1861.81it/s]warmup should be done:  86%|████████▋ | 2590/3000 [00:01<00:00, 1843.31it/s]warmup should be done:  93%|█████████▎| 2791/3000 [00:01<00:00, 1868.88it/s]warmup should be done:  93%|█████████▎| 2776/3000 [00:01<00:00, 1846.42it/s]warmup should be done:  93%|█████████▎| 2794/3000 [00:01<00:00, 1867.24it/s]warmup should be done:  93%|█████████▎| 2776/3000 [00:01<00:00, 1845.72it/s]warmup should be done:  99%|█████████▉| 2978/3000 [00:01<00:00, 1869.13it/s]warmup should be done:  99%|█████████▊| 2961/3000 [00:01<00:00, 1847.45it/s]warmup should be done:  99%|█████████▉| 2982/3000 [00:01<00:00, 1870.57it/s]warmup should be done:  99%|█████████▊| 2961/3000 [00:01<00:00, 1830.48it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1855.82it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1854.94it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1844.26it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1837.64it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f65d3018100>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f65d3017190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f65d3018250>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f65d3018070>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-12 01:14:04.519127: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f61a5a64970 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:14:04.519194: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:14:04.527198: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:14:05.409158: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:14:06.236968: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f61a9a67e90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:14:06.237051: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:14:06.247362: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:14:06.268297: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f61a9267b90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:14:06.268385: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:14:06.275772: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f61a5a6b500 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:14:06.275817: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:14:06.280932: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:14:06.283256: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:14:06.926268: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:14:07.014818: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:14:07.016413: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:14:10.638683: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:14:12.926851: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:14:13.172211: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:14:13.251870: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][01:15:06.587][ERROR][RK0][tid #140057717491456]: replica 3 reaches 1000, calling init pre replica
[HCTR][01:15:06.587][ERROR][RK0][tid #140057717491456]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][01:15:06.592][ERROR][RK0][tid #140057717491456]: coll ps creation done
[HCTR][01:15:06.592][ERROR][RK0][tid #140057717491456]: replica 3 waits for coll ps creation barrier
[HCTR][01:15:06.679][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][01:15:06.679][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][01:15:06.683][ERROR][RK0][main]: coll ps creation done
[HCTR][01:15:06.683][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][01:15:06.685][ERROR][RK0][tid #140057717491456]: replica 1 reaches 1000, calling init pre replica
[HCTR][01:15:06.685][ERROR][RK0][tid #140057717491456]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][01:15:06.689][ERROR][RK0][tid #140057717491456]: coll ps creation done
[HCTR][01:15:06.689][ERROR][RK0][tid #140057717491456]: replica 1 waits for coll ps creation barrier
[HCTR][01:15:06.966][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][01:15:06.966][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][01:15:06.969][ERROR][RK0][main]: coll ps creation done
[HCTR][01:15:06.969][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][01:15:06.969][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][01:15:08.198][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][01:15:08.235][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][01:15:08.235][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][01:15:08.235][ERROR][RK0][tid #140057717491456]: replica 1 calling init per replica
[HCTR][01:15:08.235][ERROR][RK0][main]: Calling build_v2
[HCTR][01:15:08.235][ERROR][RK0][tid #140057717491456]: replica 3 calling init per replica
[HCTR][01:15:08.235][ERROR][RK0][main]: Calling build_v2
[HCTR][01:15:08.235][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:15:08.235][ERROR][RK0][tid #140057717491456]: Calling build_v2
[HCTR][01:15:08.235][ERROR][RK0][tid #140057717491456]: Calling build_v2
[HCTR][01:15:08.235][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:15:08.235][ERROR][RK0][tid #140057717491456]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:15:08.235][ERROR][RK0][tid #140057717491456]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-12 01:15:08.236033: [[E 2022-12-12 01:15:082022-12-12 01:15:08/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc.[.:236058236055136: 2022-12-12 01:15:08: ] E.Eusing concurrent impl MPS 236077 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:E:136 136] /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] using concurrent impl MPS:using concurrent impl MPS
136
] using concurrent impl MPS
[2022-12-12 01:15:08.237263: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-12 01:15:08.237332: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 01:15:08.237376: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 01:15:08.237407: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 01:15:08.237486: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-12 01:15:08.237515: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-12 01:15:08:[.1962022-12-12 01:15:08237534] .: assigning 8 to cpu237549E
:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc212:] [196build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-12 01:15:08] 
.assigning 8 to cpu237612
: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-12 01:15:08:.212237652] : build symm link desc with 4X Tesla V100-SXM2-16GB out of 4E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 01:15:08[.2022-12-12 01:15:08237693.: 237700E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2132022-12-12 01:15:08:] .214remote time is 8.68421237707] 
: cpu time is 30E
[ 2022-12-12 01:15:08/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:237771212: ] Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 01:15:08.237830: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 01:15:08.237886: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 01:15:31.772766: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 01:15:31.842637: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-12 01:15:32. 41235: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 01:15:32. 41322: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 01:15:32. 41364: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 01:15:32. 41398: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 01:15:32. 42414: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:15:32. 42466: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:15:32. 43564: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:15:32. 44148: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:15:32. 62845: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 01:15:32. 62937: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 01:15:32. 63380: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:15:32. 63424: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:15:32. 64183: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:15:32. 64739: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:15:32. 65276: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-12 01:15:32. 65371: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-12 01:15:32. 65773: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:15:32. 65836: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:15:32. 66656: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:15:32. 67207: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:15:32. 69417: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-12 01:15:32. 69490: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-12 01:15:32. 70127: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:15:32. 70181: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:15:32. 71089: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:15:32. 71667: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:15:32.103188: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 01:15:32.105064: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 01:15:32.105123: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:15:32.105955: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:15:32.106517: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:15:32.107489: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:15:32.107540: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.41 MB
[2022-12-12 01:15:32.127072: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 01:15:32.128897: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 01:15:32.128947: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:15:32.129686: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:15:32.130101: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:15:32.131049: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:15:32.131094: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.41 MB
[2022-12-12 01:15:32.156448: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:15:32.157054: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:15:32.157100: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[[2022-12-12 01:15:322022-12-12 01:15:32..174929174936: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes

[2022-12-12 01:15:32.176732: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[[2022-12-12 01:15:322022-12-12 01:15:32..176780176778: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 400000000eager release cuda mem 5

[2022-12-12 01:15:32.176863: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:15:32.177619: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:15:32.178116: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:15:32.178583: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:15:32.178652: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:15:32.178979: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:15:32.179529: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:15:32.[1795762022-12-12 01:15:32: .W179578[ : 2022-12-12 01:15:32/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.ccE.: 17960143/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: ] :EWORKER[0] alloc host memory 53.41 MB638 
] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 25855:
638] eager release cuda mem 625663
[2022-12-12 01:15:32.179721[: 2022-12-12 01:15:32E. 179730/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :W1980 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cceager alloc mem 6.68 GB:
43] WORKER[0] alloc host memory 53.41 MB
[2022-12-12 01:15:32.205083: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:15:32.205672: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:15:32.205715: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[2022-12-12 01:15:32.205975: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:15:32.206546: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:15:32.206589: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[[[[2022-12-12 01:15:322022-12-12 01:15:322022-12-12 01:15:322022-12-12 01:15:32....817496817494817495817494: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 0 init p2p of link 1Device 1 init p2p of link 2Device 3 init p2p of link 0Device 2 init p2p of link 3



[2022-12-12 01:15:32[[.2022-12-12 01:15:322022-12-12 01:15:32817893..: 817895817896E: :  EE[/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu  2022-12-12 01:15:32:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.1980::817952] 19801980: eager alloc mem 611.00 KB] ] E
eager alloc mem 611.00 KBeager alloc mem 611.00 KB 

/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:15:32.818870[: 2022-12-12 01:15:32[E.2022-12-12 01:15:32 818880./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: [818886:E2022-12-12 01:15:32: 638 .E] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc818919 eager release cuda mem 625663:: /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
638E:]  638eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] 
:eager release cuda mem 625663638
] eager release cuda mem 625663
[2022-12-12 01:15:32.830852: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 01:15:32.830924: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19262022-12-12 01:15:32] .Device 2 init p2p of link 0830974
[: 2022-12-12 01:15:32E. 831005/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1926 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuDevice 1 init p2p of link 3:[
19802022-12-12 01:15:32] .eager alloc mem 611.00 KB831026
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-12 01:15:32.831098: [E2022-12-12 01:15:32 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu831118:: 1980E]  eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-12 01:15:32.831197: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:15:32.831871: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:15:32.831960: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663[
2022-12-12 01:15:32.831979: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:15:32.832026: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:15:32.842398: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 01:15:32.842452: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 01:15:32.842506: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:15:32.842561: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:15:32.842707: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 01:15:32.842762: E[ 2022-12-12 01:15:32/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:8427961926: ] EDevice 0 init p2p of link 3 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:15:32.842910: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:15:32.843325: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:15:32.843376: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:15:32.843635: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:15:32.843746: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:15:32.852526: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:15:32.852684: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:15:32.852845: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 14000000 / 100000000 nodes ( 14.00 %~14.00 %) | remote 42000000 / 100000000 nodes ( 42.00 %) | cpu 44000000 / 100000000 nodes ( 44.00 %) | 6.68 GB | 0.789429 secs 
[2022-12-12 01:15:32.852926: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:15:32.852983: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:15:32.853072: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 14000000 / 100000000 nodes ( 14.00 %~14.00 %) | remote 42000000 / 100000000 nodes ( 42.00 %) | cpu 44000000 / 100000000 nodes ( 44.00 %) | 6.68 GB | 0.782908 secs 
[2022-12-12 01:15:32.853356: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 14000000 / 100000000 nodes ( 14.00 %~14.00 %) | remote 42000000 / 100000000 nodes ( 42.00 %) | cpu 44000000 / 100000000 nodes ( 44.00 %) | 6.68 GB | 0.787536 secs 
[2022-12-12 01:15:32.853524: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 14000000 / 100000000 nodes ( 14.00 %~14.00 %) | remote 42000000 / 100000000 nodes ( 42.00 %) | cpu 44000000 / 100000000 nodes ( 44.00 %) | 6.68 GB | 0.811063 secs 
[2022-12-12 01:15:32.855271: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.38 GB
[2022-12-12 01:15:33.758298: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.62 GB
[2022-12-12 01:15:33.758428: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.62 GB
[2022-12-12 01:15:33.758757: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.62 GB
[2022-12-12 01:15:34.644424: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.87 GB
[2022-12-12 01:15:34.645070: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.87 GB
[2022-12-12 01:15:34.645536: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.87 GB
[2022-12-12 01:15:35.545757: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.12 GB
[2022-12-12 01:15:35.546034: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.12 GB
[2022-12-12 01:15:35.546747: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.12 GB
[2022-12-12 01:15:36.415298: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.53 GB
[2022-12-12 01:15:36.415544: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.53 GB
[2022-12-12 01:15:36.415980: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.53 GB
[2022-12-12 01:15:37. 34715: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.72 GB
[2022-12-12 01:15:37. 34848: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.72 GB
[HCTR][01:15:37.172][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][01:15:37.172][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][01:15:37.172][ERROR][RK0][tid #140057717491456]: replica 1 calling init per replica done, doing barrier
[HCTR][01:15:37.172][ERROR][RK0][tid #140057717491456]: replica 3 calling init per replica done, doing barrier
[HCTR][01:15:37.172][ERROR][RK0][tid #140057717491456]: replica 3 calling init per replica done, doing barrier done
[HCTR][01:15:37.172][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][01:15:37.172][ERROR][RK0][tid #140057717491456]: replica 1 calling init per replica done, doing barrier done
[HCTR][01:15:37.172][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][01:15:37.172][ERROR][RK0][tid #140057717491456]: init per replica done
[HCTR][01:15:37.172][ERROR][RK0][main]: init per replica done
[HCTR][01:15:37.172][ERROR][RK0][tid #140057717491456]: init per replica done
[HCTR][01:15:37.206][ERROR][RK0][tid #140057717491456]: 1 allocated 3276800 at 0x7f4624238400
[HCTR][01:15:37.206][ERROR][RK0][tid #140057717491456]: 1 allocated 6553600 at 0x7f4624558400
[HCTR][01:15:37.206][ERROR][RK0][tid #140057717491456]: 1 allocated 3276800 at 0x7f4624b98400
[HCTR][01:15:37.206][ERROR][RK0][tid #140057717491456]: 1 allocated 6553600 at 0x7f4624eb8400
[HCTR][01:15:37.207][ERROR][RK0][tid #140057725884160]: 2 allocated 3276800 at 0x7f4684238400
[HCTR][01:15:37.207][ERROR][RK0][tid #140057725884160]: 2 allocated 6553600 at 0x7f4684558400
[HCTR][01:15:37.207][ERROR][RK0][tid #140057725884160]: 2 allocated 3276800 at 0x7f4684b98400
[HCTR][01:15:37.207][ERROR][RK0][tid #140057725884160]: 2 allocated 6553600 at 0x7f4684eb8400
[HCTR][01:15:37.208][ERROR][RK0][tid #140057717491456]: 3 allocated 3276800 at 0x7f4624238400
[HCTR][01:15:37.208][ERROR][RK0][tid #140057717491456]: 3 allocated 6553600 at 0x7f4624558400
[HCTR][01:15:37.208][ERROR][RK0][tid #140057717491456]: 3 allocated 3276800 at 0x7f4624b98400
[HCTR][01:15:37.208][ERROR][RK0][tid #140057717491456]: 3 allocated 6553600 at 0x7f4624eb8400
[HCTR][01:15:37.227][ERROR][RK0][main]: init per replica done
[HCTR][01:15:37.264][ERROR][RK0][tid #140057717491456]: 0 allocated 3276800 at 0x7f46b0320000
[HCTR][01:15:37.265][ERROR][RK0][tid #140057717491456]: 0 allocated 6553600 at 0x7f46b0640000
[HCTR][01:15:37.265][ERROR][RK0][tid #140057717491456]: 0 allocated 3276800 at 0x7f46b0c80000
[HCTR][01:15:37.265][ERROR][RK0][tid #140057717491456]: 0 allocated 6553600 at 0x7f46b0fa0000
