2022-12-12 02:48:50.278694: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:48:50.361402: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:48:50.361402: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:48:50.361539: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:48:51.196158: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:48:51.196242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:48:51.209489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:48:51.243229: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:48:51.243419: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:48:51.245021: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 02:48:51.281710: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:48:51.281795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:48:51.289033: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:48:51.289116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:48:51.290377: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:48:51.290433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:48:51.294666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:48:51.303956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:48:51.304098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:48:51.328088: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:48:51.328340: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:48:51.330002: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 02:48:51.335725: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:48:51.335884: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:48:51.337333: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 02:48:51.337506: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:48:51.337634: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:48:51.339082: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][02:48:52.506][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:48:53.463][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:48:53.467][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:48:53.512][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.50s/it]warmup run: 102it [00:01, 88.47it/s]warmup run: 204it [00:01, 191.33it/s]warmup run: 307it [00:01, 305.56it/s]warmup run: 1it [00:01,  1.47s/it]warmup run: 411it [00:01, 424.60it/s]warmup run: 75it [00:01, 66.15it/s]warmup run: 512it [00:02, 534.06it/s]warmup run: 146it [00:01, 138.25it/s]warmup run: 613it [00:02, 634.61it/s]warmup run: 244it [00:01, 254.43it/s]warmup run: 719it [00:02, 732.41it/s]warmup run: 0it [00:00, ?it/s]warmup run: 348it [00:01, 383.34it/s]warmup run: 821it [00:02, 802.31it/s]warmup run: 456it [00:01, 515.73it/s]warmup run: 926it [00:02, 865.00it/s]warmup run: 556it [00:02, 618.62it/s]warmup run: 1030it [00:02, 910.33it/s]warmup run: 659it [00:02, 713.57it/s]warmup run: 1134it [00:02, 946.12it/s]warmup run: 759it [00:02, 784.69it/s]warmup run: 1237it [00:02, 964.24it/s]warmup run: 860it [00:02, 843.63it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 1340it [00:02, 966.04it/s]warmup run: 961it [00:02, 887.47it/s]warmup run: 99it [00:01, 89.37it/s]warmup run: 1443it [00:02, 983.35it/s]warmup run: 1066it [00:02, 930.82it/s]warmup run: 196it [00:01, 190.08it/s]warmup run: 1545it [00:03, 986.82it/s]warmup run: 1173it [00:02, 969.76it/s]warmup run: 300it [00:01, 309.47it/s]warmup run: 1649it [00:03, 1000.54it/s]warmup run: 1276it [00:02, 977.45it/s]warmup run: 406it [00:01, 434.55it/s]warmup run: 1752it [00:03, 1008.02it/s]warmup run: 1381it [00:02, 996.80it/s]warmup run: 512it [00:01, 554.11it/s]warmup run: 1854it [00:03, 993.09it/s] warmup run: 1486it [00:02, 1009.73it/s]warmup run: 616it [00:02, 658.82it/s]warmup run: 1955it [00:03, 973.80it/s]warmup run: 1589it [00:03, 995.20it/s] warmup run: 716it [00:02, 715.96it/s]warmup run: 2053it [00:03, 973.48it/s]warmup run: 1691it [00:03, 1001.33it/s]warmup run: 812it [00:02, 775.21it/s]warmup run: 2168it [00:03, 1023.39it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1794it [00:03, 1008.55it/s]warmup run: 913it [00:02, 834.50it/s]warmup run: 2297it [00:03, 1101.83it/s]warmup run: 102it [00:01, 92.79it/s]warmup run: 1896it [00:03, 1009.15it/s]warmup run: 1017it [00:02, 889.54it/s]warmup run: 2430it [00:03, 1167.07it/s]warmup run: 206it [00:01, 201.81it/s]warmup run: 1998it [00:03, 1007.94it/s]warmup run: 1117it [00:02, 919.66it/s]warmup run: 2562it [00:03, 1211.42it/s]warmup run: 305it [00:01, 312.80it/s]warmup run: 2126it [00:03, 1087.16it/s]warmup run: 1217it [00:02, 930.48it/s]warmup run: 2694it [00:04, 1243.62it/s]warmup run: 409it [00:01, 434.39it/s]warmup run: 2245it [00:03, 1115.53it/s]warmup run: 1316it [00:02, 943.14it/s]warmup run: 2825it [00:04, 1261.93it/s]warmup run: 511it [00:01, 546.83it/s]warmup run: 2378it [00:03, 1178.30it/s]warmup run: 1416it [00:02, 959.20it/s]warmup run: 2954it [00:04, 1268.32it/s]warmup run: 3000it [00:04, 701.12it/s] warmup run: 617it [00:02, 656.86it/s]warmup run: 2511it [00:03, 1222.81it/s]warmup run: 1518it [00:02, 976.31it/s]warmup run: 723it [00:02, 750.11it/s]warmup run: 2644it [00:03, 1254.54it/s]warmup run: 1620it [00:03, 988.60it/s]warmup run: 826it [00:02, 819.09it/s]warmup run: 2776it [00:04, 1271.44it/s]warmup run: 1721it [00:03, 977.14it/s]warmup run: 928it [00:02, 871.54it/s]warmup run: 2904it [00:04, 1262.82it/s]warmup run: 1820it [00:03, 979.58it/s]warmup run: 3000it [00:04, 701.10it/s] warmup run: 1035it [00:02, 923.22it/s]warmup run: 1921it [00:03, 986.89it/s]warmup run: 1141it [00:02, 959.69it/s]warmup run: 2036it [00:03, 1033.58it/s]warmup run: 1247it [00:02, 987.06it/s]warmup run: 2168it [00:03, 1117.13it/s]warmup run: 1352it [00:02, 1000.43it/s]warmup run: 2300it [00:03, 1175.55it/s]warmup run: 1456it [00:02, 999.30it/s] warmup run: 2435it [00:03, 1225.37it/s]warmup run: 1562it [00:02, 1015.09it/s]warmup run: 2570it [00:03, 1259.93it/s]warmup run: 1668it [00:03, 1027.78it/s]warmup run: 2701it [00:03, 1273.29it/s]warmup run: 1773it [00:03, 1028.04it/s]warmup run: 2831it [00:04, 1279.95it/s]warmup run: 1877it [00:03, 1027.31it/s]warmup run: 2961it [00:04, 1285.29it/s]warmup run: 3000it [00:04, 712.76it/s] warmup run: 1981it [00:03, 1013.71it/s]warmup run: 2109it [00:03, 1089.30it/s]warmup run: 2242it [00:03, 1158.25it/s]warmup run: 2375it [00:03, 1208.79it/s]warmup run: 2507it [00:03, 1240.82it/s]warmup run: 2641it [00:03, 1267.61it/s]warmup run: 2773it [00:03, 1282.46it/s]warmup run: 2906it [00:04, 1294.03it/s]warmup run: 3000it [00:04, 726.71it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1642.91it/s]warmup should be done:   5%|▌         | 158/3000 [00:00<00:01, 1578.88it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1646.70it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1655.48it/s]warmup should be done:  11%|█         | 333/3000 [00:00<00:01, 1662.40it/s]warmup should be done:  11%|█         | 332/3000 [00:00<00:01, 1670.73it/s]warmup should be done:  11%|█         | 333/3000 [00:00<00:01, 1665.82it/s]warmup should be done:  11%|█▏        | 338/3000 [00:00<00:01, 1688.49it/s]warmup should be done:  17%|█▋        | 511/3000 [00:00<00:01, 1715.60it/s]warmup should be done:  17%|█▋        | 504/3000 [00:00<00:01, 1685.12it/s]warmup should be done:  17%|█▋        | 500/3000 [00:00<00:01, 1651.88it/s]warmup should be done:  17%|█▋        | 507/3000 [00:00<00:01, 1597.40it/s]warmup should be done:  23%|██▎       | 678/3000 [00:00<00:01, 1706.47it/s]warmup should be done:  23%|██▎       | 688/3000 [00:00<00:01, 1734.58it/s]warmup should be done:  22%|██▏       | 672/3000 [00:00<00:01, 1675.53it/s]warmup should be done:  22%|██▏       | 671/3000 [00:00<00:01, 1613.48it/s]warmup should be done:  28%|██▊       | 850/3000 [00:00<00:01, 1711.12it/s]warmup should be done:  29%|██▊       | 862/3000 [00:00<00:01, 1723.68it/s]warmup should be done:  28%|██▊       | 843/3000 [00:00<00:01, 1685.36it/s]warmup should be done:  28%|██▊       | 842/3000 [00:00<00:01, 1644.82it/s]warmup should be done:  34%|███▍      | 1022/3000 [00:00<00:01, 1707.71it/s]warmup should be done:  35%|███▍      | 1037/3000 [00:00<00:01, 1729.29it/s]warmup should be done:  34%|███▎      | 1012/3000 [00:00<00:01, 1681.10it/s]warmup should be done:  34%|███▎      | 1012/3000 [00:00<00:01, 1661.50it/s]warmup should be done:  40%|███▉      | 1194/3000 [00:00<00:01, 1708.56it/s]warmup should be done:  40%|████      | 1210/3000 [00:00<00:01, 1725.86it/s]warmup should be done:  39%|███▉      | 1182/3000 [00:00<00:01, 1685.00it/s]warmup should be done:  39%|███▉      | 1182/3000 [00:00<00:01, 1673.46it/s]warmup should be done:  46%|████▌     | 1366/3000 [00:00<00:00, 1711.07it/s]warmup should be done:  46%|████▌     | 1384/3000 [00:00<00:00, 1728.26it/s]warmup should be done:  45%|████▌     | 1352/3000 [00:00<00:00, 1687.35it/s]warmup should be done:  45%|████▌     | 1350/3000 [00:00<00:00, 1659.80it/s]warmup should be done:  51%|█████▏    | 1538/3000 [00:00<00:00, 1710.22it/s]warmup should be done:  52%|█████▏    | 1558/3000 [00:00<00:00, 1730.34it/s]warmup should be done:  51%|█████     | 1522/3000 [00:00<00:00, 1689.79it/s]warmup should be done:  51%|█████     | 1525/3000 [00:00<00:00, 1685.08it/s]warmup should be done:  57%|█████▋    | 1710/3000 [00:01<00:00, 1709.05it/s]warmup should be done:  58%|█████▊    | 1732/3000 [00:01<00:00, 1730.55it/s]warmup should be done:  56%|█████▋    | 1691/3000 [00:01<00:00, 1681.11it/s]warmup should be done:  57%|█████▋    | 1700/3000 [00:01<00:00, 1703.03it/s]warmup should be done:  63%|██████▎   | 1881/3000 [00:01<00:00, 1704.04it/s]warmup should be done:  64%|██████▎   | 1910/3000 [00:01<00:00, 1743.41it/s]warmup should be done:  62%|██████▏   | 1863/3000 [00:01<00:00, 1691.67it/s]warmup should be done:  62%|██████▏   | 1874/3000 [00:01<00:00, 1713.83it/s]warmup should be done:  68%|██████▊   | 2052/3000 [00:01<00:00, 1689.08it/s]warmup should be done:  68%|██████▊   | 2034/3000 [00:01<00:00, 1695.85it/s]warmup should be done:  70%|██████▉   | 2085/3000 [00:01<00:00, 1681.92it/s]warmup should be done:  68%|██████▊   | 2048/3000 [00:01<00:00, 1720.17it/s]warmup should be done:  74%|███████▍  | 2223/3000 [00:01<00:00, 1694.07it/s]warmup should be done:  74%|███████▎  | 2205/3000 [00:01<00:00, 1697.59it/s]warmup should be done:  74%|███████▍  | 2222/3000 [00:01<00:00, 1725.07it/s]warmup should be done:  75%|███████▌  | 2254/3000 [00:01<00:00, 1678.81it/s]warmup should be done:  80%|███████▉  | 2398/3000 [00:01<00:00, 1709.83it/s]warmup should be done:  79%|███████▉  | 2375/3000 [00:01<00:00, 1696.32it/s]warmup should be done:  80%|███████▉  | 2397/3000 [00:01<00:00, 1731.11it/s]warmup should be done:  81%|████████  | 2423/3000 [00:01<00:00, 1669.28it/s]warmup should be done:  86%|████████▌ | 2570/3000 [00:01<00:00, 1703.35it/s]warmup should be done:  85%|████████▍ | 2545/3000 [00:01<00:00, 1685.99it/s]warmup should be done:  86%|████████▌ | 2574/3000 [00:01<00:00, 1741.19it/s]warmup should be done:  86%|████████▋ | 2591/3000 [00:01<00:00, 1663.93it/s]warmup should be done:  91%|█████████ | 2718/3000 [00:01<00:00, 1696.70it/s]warmup should be done:  91%|█████████▏| 2741/3000 [00:01<00:00, 1690.97it/s]warmup should be done:  92%|█████████▏| 2750/3000 [00:01<00:00, 1744.43it/s]warmup should be done:  92%|█████████▏| 2758/3000 [00:01<00:00, 1649.46it/s]warmup should be done:  96%|█████████▋| 2888/3000 [00:01<00:00, 1696.41it/s]warmup should be done:  97%|█████████▋| 2911/3000 [00:01<00:00, 1681.08it/s]warmup should be done:  98%|█████████▊| 2925/3000 [00:01<00:00, 1744.61it/s]warmup should be done:  97%|█████████▋| 2924/3000 [00:01<00:00, 1641.00it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1701.36it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1697.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1688.64it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1688.03it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1669.61it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1807.34it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1733.17it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1664.80it/s]warmup should be done:  11%|█▏        | 340/3000 [00:00<00:01, 1700.86it/s]warmup should be done:  12%|█▏        | 363/3000 [00:00<00:01, 1811.91it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1767.21it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1712.00it/s]warmup should be done:  18%|█▊        | 549/3000 [00:00<00:01, 1832.33it/s]warmup should be done:  17%|█▋        | 514/3000 [00:00<00:01, 1715.81it/s]warmup should be done:  18%|█▊        | 535/3000 [00:00<00:01, 1782.28it/s]warmup should be done:  17%|█▋        | 520/3000 [00:00<00:01, 1739.29it/s]warmup should be done:  23%|██▎       | 693/3000 [00:00<00:01, 1744.52it/s]warmup should be done:  24%|██▍       | 735/3000 [00:00<00:01, 1841.40it/s]warmup should be done:  23%|██▎       | 695/3000 [00:00<00:01, 1740.09it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1778.74it/s]warmup should be done:  29%|██▉       | 872/3000 [00:00<00:01, 1760.79it/s]warmup should be done:  31%|███       | 920/3000 [00:00<00:01, 1833.30it/s]warmup should be done:  29%|██▉       | 870/3000 [00:00<00:01, 1736.99it/s]warmup should be done:  30%|██▉       | 892/3000 [00:00<00:01, 1774.35it/s]warmup should be done:  35%|███▌      | 1051/3000 [00:00<00:01, 1769.14it/s]warmup should be done:  36%|███▌      | 1072/3000 [00:00<00:01, 1781.74it/s]warmup should be done:  35%|███▍      | 1044/3000 [00:00<00:01, 1735.48it/s]warmup should be done:  37%|███▋      | 1104/3000 [00:00<00:01, 1823.77it/s]warmup should be done:  41%|████      | 1229/3000 [00:00<00:00, 1772.61it/s]warmup should be done:  42%|████▏     | 1251/3000 [00:00<00:00, 1781.84it/s]warmup should be done:  41%|████      | 1218/3000 [00:00<00:01, 1732.69it/s]warmup should be done:  43%|████▎     | 1287/3000 [00:00<00:00, 1818.89it/s]warmup should be done:  47%|████▋     | 1409/3000 [00:00<00:00, 1778.27it/s]warmup should be done:  48%|████▊     | 1432/3000 [00:00<00:00, 1790.64it/s]warmup should be done:  46%|████▋     | 1392/3000 [00:00<00:00, 1726.97it/s]warmup should be done:  49%|████▉     | 1470/3000 [00:00<00:00, 1821.96it/s]warmup should be done:  53%|█████▎    | 1587/3000 [00:00<00:00, 1778.60it/s]warmup should be done:  54%|█████▎    | 1612/3000 [00:00<00:00, 1790.28it/s]warmup should be done:  52%|█████▏    | 1567/3000 [00:00<00:00, 1732.09it/s]warmup should be done:  55%|█████▌    | 1653/3000 [00:00<00:00, 1814.29it/s]warmup should be done:  59%|█████▉    | 1766/3000 [00:01<00:00, 1780.77it/s]warmup should be done:  60%|█████▉    | 1792/3000 [00:01<00:00, 1784.05it/s]warmup should be done:  58%|█████▊    | 1743/3000 [00:01<00:00, 1738.72it/s]warmup should be done:  61%|██████    | 1835/3000 [00:01<00:00, 1812.43it/s]warmup should be done:  65%|██████▍   | 1945/3000 [00:01<00:00, 1783.04it/s]warmup should be done:  66%|██████▌   | 1971/3000 [00:01<00:00, 1783.56it/s]warmup should be done:  64%|██████▍   | 1920/3000 [00:01<00:00, 1745.71it/s]warmup should be done:  67%|██████▋   | 2017/3000 [00:01<00:00, 1804.73it/s]warmup should be done:  71%|███████   | 2125/3000 [00:01<00:00, 1785.78it/s]warmup should be done:  70%|██████▉   | 2098/3000 [00:01<00:00, 1754.14it/s]warmup should be done:  72%|███████▏  | 2150/3000 [00:01<00:00, 1780.41it/s]warmup should be done:  73%|███████▎  | 2198/3000 [00:01<00:00, 1802.23it/s]warmup should be done:  77%|███████▋  | 2304/3000 [00:01<00:00, 1785.82it/s]warmup should be done:  76%|███████▌  | 2278/3000 [00:01<00:00, 1766.49it/s]warmup should be done:  78%|███████▊  | 2329/3000 [00:01<00:00, 1780.20it/s]warmup should be done:  79%|███████▉  | 2379/3000 [00:01<00:00, 1797.81it/s]warmup should be done:  83%|████████▎ | 2483/3000 [00:01<00:00, 1786.67it/s]warmup should be done:  82%|████████▏ | 2457/3000 [00:01<00:00, 1771.62it/s]warmup should be done:  84%|████████▎ | 2508/3000 [00:01<00:00, 1782.26it/s]warmup should be done:  85%|████████▌ | 2560/3000 [00:01<00:00, 1799.85it/s]warmup should be done:  89%|████████▊ | 2662/3000 [00:01<00:00, 1753.24it/s]warmup should be done:  90%|████████▉ | 2687/3000 [00:01<00:00, 1777.82it/s]warmup should be done:  88%|████████▊ | 2635/3000 [00:01<00:00, 1728.64it/s]warmup should be done:  91%|█████████▏| 2740/3000 [00:01<00:00, 1751.53it/s]warmup should be done:  95%|█████████▍| 2843/3000 [00:01<00:00, 1768.22it/s]warmup should be done:  96%|█████████▌| 2866/3000 [00:01<00:00, 1779.42it/s]warmup should be done:  94%|█████████▍| 2813/3000 [00:01<00:00, 1743.26it/s]warmup should be done:  97%|█████████▋| 2920/3000 [00:01<00:00, 1763.32it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1797.25it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1780.69it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1767.91it/s]warmup should be done: 100%|█████████▉| 2988/3000 [00:01<00:00, 1743.75it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1740.20it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f0b866b2160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f0b866b2070>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f0b866b1190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f0b866b2280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-12 02:50:01.386720: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0755a641d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:50:01.386778: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:50:01.388772: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0755266da0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:50:01.388810: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:50:01.396602: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:50:01.399050: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:50:02.410385: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:50:02.413278: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:50:02.477051: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0755a68160 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:50:02.477101: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:50:02.486578: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:50:02.546767: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f075526e650 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:50:02.546820: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:50:02.554714: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:50:03.165341: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:50:03.244280: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:50:07.720316: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:50:08.656294: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:50:08.703060: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:50:09.495895: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][02:51:02.285][ERROR][RK0][tid #139670365128448]: replica 3 reaches 1000, calling init pre replica
[HCTR][02:51:02.285][ERROR][RK0][tid #139670365128448]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][02:51:02.290][ERROR][RK0][tid #139670365128448]: coll ps creation done
[HCTR][02:51:02.290][ERROR][RK0][tid #139670365128448]: replica 3 waits for coll ps creation barrier
[HCTR][02:51:02.323][ERROR][RK0][tid #139669954082560]: replica 1 reaches 1000, calling init pre replica
[HCTR][02:51:02.323][ERROR][RK0][tid #139669954082560]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][02:51:02.328][ERROR][RK0][tid #139669954082560]: coll ps creation done
[HCTR][02:51:02.328][ERROR][RK0][tid #139669954082560]: replica 1 waits for coll ps creation barrier
[HCTR][02:51:02.377][ERROR][RK0][tid #139669954082560]: replica 0 reaches 1000, calling init pre replica
[HCTR][02:51:02.377][ERROR][RK0][tid #139669954082560]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][02:51:02.382][ERROR][RK0][tid #139669954082560]: coll ps creation done
[HCTR][02:51:02.382][ERROR][RK0][tid #139669954082560]: replica 0 waits for coll ps creation barrier
[HCTR][02:51:02.685][ERROR][RK0][tid #139669962475264]: replica 2 reaches 1000, calling init pre replica
[HCTR][02:51:02.685][ERROR][RK0][tid #139669962475264]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][02:51:02.690][ERROR][RK0][tid #139669962475264]: coll ps creation done
[HCTR][02:51:02.690][ERROR][RK0][tid #139669962475264]: replica 2 waits for coll ps creation barrier
[HCTR][02:51:02.690][ERROR][RK0][tid #139669954082560]: replica 0 preparing frequency
[HCTR][02:51:03.619][ERROR][RK0][tid #139669954082560]: replica 0 preparing frequency done
[HCTR][02:51:03.658][ERROR][RK0][tid #139669954082560]: replica 0 calling init per replica
[HCTR][02:51:03.658][ERROR][RK0][tid #139669962475264]: replica 2 calling init per replica
[HCTR][02:51:03.658][ERROR][RK0][tid #139670365128448]: replica 3 calling init per replica
[HCTR][02:51:03.658][ERROR][RK0][tid #139669954082560]: replica 1 calling init per replica
[HCTR][02:51:03.658][ERROR][RK0][tid #139669954082560]: Calling build_v2
[HCTR][02:51:03.658][ERROR][RK0][tid #139669962475264]: Calling build_v2
[HCTR][02:51:03.658][ERROR][RK0][tid #139670365128448]: Calling build_v2
[HCTR][02:51:03.658][ERROR][RK0][tid #139669954082560]: Calling build_v2
[HCTR][02:51:03.658][ERROR][RK0][tid #139669954082560]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:51:03.658][ERROR][RK0][tid #139669962475264]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:51:03.658][ERROR][RK0][tid #139670365128448]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:51:03.658][ERROR][RK0][tid #139669954082560]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[[2022-12-12 02:51:032022-12-12 02:51:03.2022-12-12 02:51:032022-12-12 02:51:03.658437..658443: 658436658443: E: : E EE /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136::136] 136136] using concurrent impl MPS] ] using concurrent impl MPS
using concurrent impl MPSusing concurrent impl MPS


[2022-12-12 02:51:03.659795: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-12 02:51:03196[.] 2022-12-12 02:51:03659821assigning 8 to cpu.[: 
6598472022-12-12 02:51:03E: . E659868/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[ : :2022-12-12 02:51:03/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE196.: ] 659905196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpu: ] :
Eassigning 8 to cpu196 
] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpu:
212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 02:51:03[[.2022-12-12 02:51:032022-12-12 02:51:03660016..: 660023660020E: :  EE[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc  2022-12-12 02:51:03:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.212::660031] 213212: build symm link desc with 4X Tesla V100-SXM2-16GB out of 4] ] E
remote time is 8.68421build symm link desc with 4X Tesla V100-SXM2-16GB out of 4 

/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[[:2022-12-12 02:51:03[2022-12-12 02:51:03212.2022-12-12 02:51:03.] 660140.660147build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 660154: 
E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:213:2022-12-12 02:51:03214] 213.] remote time is 8.68421] 660224cpu time is 30
remote time is 8.68421: 

[E2022-12-12 02:51:03[ .2022-12-12 02:51:03/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc660285.:: 660298213E: ]  Eremote time is 8.68421/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 
:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214:] [214cpu time is 302022-12-12 02:51:03] 
.cpu time is 30660374
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 02:51:28.723405: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 02:51:28.784921: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-12 02:51:28.912729: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 02:51:28.912801: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 02:51:28.912835: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 02:51:28.912864: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 02:51:28.913729: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:51:28.913775: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:51:28.914677: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:51:28.915228: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-12 02:51:282022-12-12 02:51:28[..2022-12-12 02:51:28934740934769.: : 934777EE:   E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc202202:] ] 2022 solved1 solved] 

3 solved
[[2022-12-12 02:51:28[2022-12-12 02:51:28.2022-12-12 02:51:28.934888.934890: 934893: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205:205] 205] worker 0 thread 2 initing device 2] worker 0 thread 1 initing device 1
worker 0 thread 3 initing device 3

[[2022-12-12 02:51:28[2022-12-12 02:51:28.2022-12-12 02:51:28.935197.935199: 935201: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815:1815] 1815] Building Coll Cache with ... num gpu device is 4] Building Coll Cache with ... num gpu device is 4
Building Coll Cache with ... num gpu device is 4

[[[2022-12-12 02:51:282022-12-12 02:51:282022-12-12 02:51:28...935293935293935293: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 381.47 MBeager alloc mem 381.47 MBeager alloc mem 381.47 MB


[2022-12-12 02:51:28.937078: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:51:28.937105: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:51:28.937138: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:51:28.938567: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:51:28.938596: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:51:28.938628: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:51:29. 11000: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 02:51:29. 12875: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 02:51:29. 12922: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:51:29. 13805: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:51:29. 14397: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:51:29. 15406: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:51:29. 15452: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 68.66 MB
[[[2022-12-12 02:51:292022-12-12 02:51:292022-12-12 02:51:29.. 29768. 29768:  29768: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980:1980] 1980] eager alloc mem 5.00 Bytes] eager alloc mem 5.00 Bytes
eager alloc mem 5.00 Bytes

[2022-12-12 02:51:29[[.2022-12-12 02:51:292022-12-12 02:51:29 31593..:  31596 31596E: :  EE/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc  :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638::] 638638eager release cuda mem 5] ] 
eager release cuda mem 5eager release cuda mem 5

[2022-12-12 02:51:29[.2022-12-12 02:51:29[ 31685.2022-12-12 02:51:29:  31688.E:  31693 E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc E:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc 638:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] 638:eager release cuda mem 400000000] 638
eager release cuda mem 400000000] 
eager release cuda mem 400000000
[2022-12-12 02:51:29. 32659: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:51:29. 33139: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:51:29. 33623: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:51:29. 34297: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:51:29. 34329: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-12 02:51:29] .eager alloc mem 611.00 KB 34348
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:51:29. 35257: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:51:29. 35301: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 68.66 MB
[2022-12-12 02:51:29. 35324: [E2022-12-12 02:51:29 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc 35330:: 638E]  eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-12 02:51:29. 35383: W [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc2022-12-12 02:51:29:.43 35396] : WORKER[0] alloc host memory 68.66 MBW
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 68.66 MB
[2022-12-12 02:51:29. 50063: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:51:29. 50647: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:51:29. 50690: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.59 GB
[2022-12-12 02:51:29.120872: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:51:29.121456: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:51:29.121497: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.59 GB
[2022-12-12 02:51:29.121857: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:51:29.122234: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:51:29.122424: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:51:29.122465: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.59 GB
[2022-12-12 02:51:29.122810: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:51:29.122854: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.59 GB
[[[2022-12-12 02:51:29[2022-12-12 02:51:292022-12-12 02:51:29.2022-12-12 02:51:29..938457.938458938469: 938459: : E: EE E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::1926:19261926] 1926] ] Device 3 init p2p of link 0Device 0 init p2p of link 1] Device 2 init p2p of link 3

Device 1 init p2p of link 2

[[2022-12-12 02:51:29[2022-12-12 02:51:29.2022-12-12 02:51:29.938789.938791: 938796: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980:1980] 1980] eager alloc mem 611.00 KB] eager alloc mem 611.00 KB
eager alloc mem 611.00 KB

[2022-12-12 02:51:29.939025: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:51:29.[[9397462022-12-12 02:51:292022-12-12 02:51:29: ..E939750939749 : : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccEE:  638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] ::eager release cuda mem 625663638638
] ] eager release cuda mem 625663eager release cuda mem 625663

[2022-12-12 02:51:29.939878: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:51:29.951254: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 02:51:29.951313: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 02:51:29.951356: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-12 02:51:29:.1980951358] : eager alloc mem 611.00 KBE
 [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-12 02:51:29:.1926951415] [: Device 0 init p2p of link 22022-12-12 02:51:29E
. 951442/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1980 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB:
1926] Device 1 init p2p of link 3
[2022-12-12 02:51:29.951551: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:51:29.951580: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:51:29.952222: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:51:29.952310: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:51:29.952379: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:51:29.952414: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:51:29.964204: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[[2022-12-12 02:51:292022-12-12 02:51:29..964278964286: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261980] ] Device 2 init p2p of link 1eager alloc mem 611.00 KB

[2022-12-12 02:51:29.964387: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:51:29.964539: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 02:51:29.964588: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 02:51:29.964630: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:51:29.964680: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:51:29.965142: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:51:29.965212: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:51:29.965467: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:51:29.965509: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:51:29.976133: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:51:29.976309: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:51:29.976462: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 18000000 / 100000000 nodes ( 18.00 %~18.00 %) | remote 54000000 / 100000000 nodes ( 54.00 %) | cpu 28000000 / 100000000 nodes ( 28.00 %) | 8.59 GB | 1.04118 secs 
[2022-12-12 02:51:29.976595: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:51:29.976660: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:51:29.976710: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 18000000 / 100000000 nodes ( 18.00 %~18.00 %) | remote 54000000 / 100000000 nodes ( 54.00 %) | cpu 28000000 / 100000000 nodes ( 28.00 %) | 8.59 GB | 1.04143 secs 
[2022-12-12 02:51:29.977038: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 18000000 / 100000000 nodes ( 18.00 %~18.00 %) | remote 54000000 / 100000000 nodes ( 54.00 %) | cpu 28000000 / 100000000 nodes ( 28.00 %) | 8.59 GB | 1.06327 secs 
[2022-12-12 02:51:29.977171: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 18000000 / 100000000 nodes ( 18.00 %~18.00 %) | remote 54000000 / 100000000 nodes ( 54.00 %) | cpu 28000000 / 100000000 nodes ( 28.00 %) | 8.59 GB | 1.04189 secs 
[2022-12-12 02:51:29.977910: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 15.29 GB
[2022-12-12 02:51:30.887104: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 15.53 GB
[2022-12-12 02:51:30.887301: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 15.53 GB
[2022-12-12 02:51:30.887753: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 15.53 GB
[2022-12-12 02:51:31.754381: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 0.00 Bytes
[2022-12-12 02:51:31.760481: F /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2069] Check failed: e == cudaSuccess || e == cudaErrorCudartUnloading [682354]CUDA: out of memory
