2022-12-12 00:17:35.022703: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:17:35.030669: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:17:35.153403: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:17:35.154105: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:17:35.948389: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:17:35.948474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 00:17:35.960969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 00:17:35.961998: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:17:35.962057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 00:17:35.978005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 00:17:35.992210: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:17:35.992371: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:17:35.993941: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 00:17:36.006782: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:17:36.006862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 00:17:36.008516: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:17:36.008666: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:17:36.010670: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 00:17:36.010865: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:17:36.010946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 00:17:36.019591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 00:17:36.023770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 00:17:36.052147: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:17:36.052307: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:17:36.053710: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 00:17:36.059979: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:17:36.060129: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:17:36.061727: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][00:17:37.307][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:17:37.308][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:17:37.308][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:17:37.309][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.56s/it]warmup run: 106it [00:01, 88.71it/s]warmup run: 219it [00:01, 199.97it/s]warmup run: 322it [00:01, 309.80it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 429it [00:01, 430.46it/s]warmup run: 106it [00:01, 96.26it/s]warmup run: 530it [00:02, 537.34it/s]warmup run: 213it [00:01, 208.16it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 636it [00:02, 646.00it/s]warmup run: 321it [00:01, 330.86it/s]warmup run: 106it [00:01, 95.95it/s]warmup run: 744it [00:02, 744.27it/s]warmup run: 433it [00:01, 462.75it/s]warmup run: 212it [00:01, 206.51it/s]warmup run: 847it [00:02, 811.40it/s]warmup run: 540it [00:01, 579.72it/s]warmup run: 318it [00:01, 326.35it/s]warmup run: 950it [00:02, 856.01it/s]warmup run: 648it [00:02, 687.69it/s]warmup run: 424it [00:01, 448.48it/s]warmup run: 1053it [00:02, 901.91it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 755it [00:02, 777.79it/s]warmup run: 522it [00:01, 550.78it/s]warmup run: 1155it [00:02, 911.74it/s]warmup run: 108it [00:01, 98.58it/s]warmup run: 860it [00:02, 844.72it/s]warmup run: 623it [00:02, 648.78it/s]warmup run: 1263it [00:02, 956.89it/s]warmup run: 215it [00:01, 210.74it/s]warmup run: 967it [00:02, 902.13it/s]warmup run: 730it [00:02, 747.17it/s]warmup run: 1371it [00:02, 990.37it/s]warmup run: 321it [00:01, 330.99it/s]warmup run: 1074it [00:02, 947.11it/s]warmup run: 837it [00:02, 826.99it/s]warmup run: 1480it [00:02, 1018.36it/s]warmup run: 428it [00:01, 455.17it/s]warmup run: 1182it [00:02, 983.23it/s]warmup run: 940it [00:02, 879.98it/s]warmup run: 1587it [00:03, 1031.32it/s]warmup run: 536it [00:01, 575.50it/s]warmup run: 1293it [00:02, 1017.75it/s]warmup run: 1044it [00:02, 923.26it/s]warmup run: 1693it [00:03, 1035.38it/s]warmup run: 645it [00:02, 686.21it/s]warmup run: 1401it [00:02, 1032.02it/s]warmup run: 1147it [00:02, 943.21it/s]warmup run: 1801it [00:03, 1046.46it/s]warmup run: 754it [00:02, 780.22it/s]warmup run: 1509it [00:02, 1035.34it/s]warmup run: 1252it [00:02, 972.50it/s]warmup run: 1907it [00:03, 1033.62it/s]warmup run: 863it [00:02, 858.07it/s]warmup run: 1622it [00:02, 1061.14it/s]warmup run: 1358it [00:02, 995.58it/s]warmup run: 2017it [00:03, 1051.90it/s]warmup run: 972it [00:02, 917.70it/s]warmup run: 1733it [00:03, 1074.14it/s]warmup run: 1465it [00:02, 1015.09it/s]warmup run: 2152it [00:03, 1138.73it/s]warmup run: 1080it [00:02, 961.75it/s]warmup run: 1842it [00:03, 1076.63it/s]warmup run: 1571it [00:02, 1025.86it/s]warmup run: 2287it [00:03, 1200.20it/s]warmup run: 1189it [00:02, 995.58it/s]warmup run: 1951it [00:03, 1071.13it/s]warmup run: 1676it [00:03, 1017.79it/s]warmup run: 2422it [00:03, 1243.83it/s]warmup run: 1298it [00:02, 1020.26it/s]warmup run: 2073it [00:03, 1112.69it/s]warmup run: 1780it [00:03, 1008.43it/s]warmup run: 2554it [00:03, 1266.39it/s]warmup run: 1408it [00:02, 1041.22it/s]warmup run: 2207it [00:03, 1179.50it/s]warmup run: 1883it [00:03, 1012.26it/s]warmup run: 2687it [00:03, 1283.72it/s]warmup run: 1517it [00:02, 1045.00it/s]warmup run: 2337it [00:03, 1214.97it/s]warmup run: 1985it [00:03, 996.65it/s] warmup run: 2821it [00:04, 1299.07it/s]warmup run: 1625it [00:02, 1034.12it/s]warmup run: 2472it [00:03, 1253.41it/s]warmup run: 2116it [00:03, 1087.50it/s]warmup run: 2954it [00:04, 1305.61it/s]warmup run: 2603it [00:03, 1268.55it/s]warmup run: 1731it [00:03, 1024.34it/s]warmup run: 3000it [00:04, 708.50it/s] warmup run: 2230it [00:03, 1101.77it/s]warmup run: 2737it [00:03, 1288.91it/s]warmup run: 1835it [00:03, 1024.35it/s]warmup run: 2365it [00:03, 1173.44it/s]warmup run: 2867it [00:03, 1291.85it/s]warmup run: 1943it [00:03, 1037.78it/s]warmup run: 2500it [00:03, 1224.30it/s]warmup run: 3000it [00:04, 1300.40it/s]warmup run: 2064it [00:03, 1087.13it/s]warmup run: 3000it [00:04, 740.38it/s] warmup run: 2629it [00:03, 1243.49it/s]warmup run: 2200it [00:03, 1165.49it/s]warmup run: 2763it [00:03, 1270.35it/s]warmup run: 2335it [00:03, 1220.08it/s]warmup run: 2896it [00:04, 1287.96it/s]warmup run: 2470it [00:03, 1257.63it/s]warmup run: 3000it [00:04, 723.52it/s] warmup run: 2606it [00:03, 1285.57it/s]warmup run: 2742it [00:03, 1304.99it/s]warmup run: 2876it [00:03, 1314.19it/s]warmup run: 3000it [00:04, 741.49it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1719.51it/s]warmup should be done:   6%|▌         | 179/3000 [00:00<00:01, 1783.68it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1686.05it/s]warmup should be done:   5%|▌         | 150/3000 [00:00<00:01, 1494.41it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1763.36it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1739.35it/s]warmup should be done:  11%|█         | 320/3000 [00:00<00:01, 1612.95it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1752.31it/s]warmup should be done:  18%|█▊        | 530/3000 [00:00<00:01, 1767.49it/s]warmup should be done:  16%|█▋        | 488/3000 [00:00<00:01, 1642.67it/s]warmup should be done:  17%|█▋        | 521/3000 [00:00<00:01, 1731.60it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1723.68it/s]warmup should be done:  22%|██▏       | 657/3000 [00:00<00:01, 1661.30it/s]warmup should be done:  24%|██▎       | 709/3000 [00:00<00:01, 1775.00it/s]warmup should be done:  23%|██▎       | 699/3000 [00:00<00:01, 1747.31it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1750.26it/s]warmup should be done:  30%|██▉       | 887/3000 [00:00<00:01, 1767.08it/s]warmup should be done:  29%|██▉       | 876/3000 [00:00<00:01, 1752.09it/s]warmup should be done:  27%|██▋       | 824/3000 [00:00<00:01, 1614.78it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1713.82it/s]warmup should be done:  35%|███▌      | 1052/3000 [00:00<00:01, 1754.01it/s]warmup should be done:  36%|███▌      | 1065/3000 [00:00<00:01, 1769.00it/s]warmup should be done:  33%|███▎      | 1001/3000 [00:00<00:01, 1664.09it/s]warmup should be done:  35%|███▌      | 1062/3000 [00:00<00:01, 1693.81it/s]warmup should be done:  41%|████      | 1229/3000 [00:00<00:01, 1756.37it/s]warmup should be done:  41%|████▏     | 1244/3000 [00:00<00:00, 1773.00it/s]warmup should be done:  39%|███▉      | 1178/3000 [00:00<00:01, 1696.73it/s]warmup should be done:  41%|████      | 1232/3000 [00:00<00:01, 1683.69it/s]warmup should be done:  47%|████▋     | 1405/3000 [00:00<00:00, 1756.44it/s]warmup should be done:  47%|████▋     | 1422/3000 [00:00<00:00, 1774.39it/s]warmup should be done:  45%|████▌     | 1356/3000 [00:00<00:00, 1720.83it/s]warmup should be done:  47%|████▋     | 1413/3000 [00:00<00:00, 1722.46it/s]warmup should be done:  53%|█████▎    | 1581/3000 [00:00<00:00, 1757.10it/s]warmup should be done:  53%|█████▎    | 1600/3000 [00:00<00:00, 1773.25it/s]warmup should be done:  51%|█████     | 1533/3000 [00:00<00:00, 1735.10it/s]warmup should be done:  53%|█████▎    | 1594/3000 [00:00<00:00, 1749.13it/s]warmup should be done:  59%|█████▊    | 1758/3000 [00:01<00:00, 1758.14it/s]warmup should be done:  59%|█████▉    | 1778/3000 [00:01<00:00, 1774.07it/s]warmup should be done:  57%|█████▋    | 1711/3000 [00:01<00:00, 1746.60it/s]warmup should be done:  59%|█████▉    | 1776/3000 [00:01<00:00, 1770.14it/s]warmup should be done:  64%|██████▍   | 1935/3000 [00:01<00:00, 1759.08it/s]warmup should be done:  65%|██████▌   | 1956/3000 [00:01<00:00, 1746.98it/s]warmup should be done:  63%|██████▎   | 1888/3000 [00:01<00:00, 1752.28it/s]warmup should be done:  65%|██████▌   | 1958/3000 [00:01<00:00, 1784.47it/s]warmup should be done:  70%|███████   | 2112/3000 [00:01<00:00, 1760.54it/s]warmup should be done:  69%|██████▉   | 2065/3000 [00:01<00:00, 1756.71it/s]warmup should be done:  71%|███████▏  | 2140/3000 [00:01<00:00, 1793.26it/s]warmup should be done:  71%|███████   | 2131/3000 [00:01<00:00, 1626.08it/s]warmup should be done:  76%|███████▋  | 2289/3000 [00:01<00:00, 1739.21it/s]warmup should be done:  75%|███████▍  | 2241/3000 [00:01<00:00, 1755.85it/s]warmup should be done:  77%|███████▋  | 2322/3000 [00:01<00:00, 1800.63it/s]warmup should be done:  77%|███████▋  | 2307/3000 [00:01<00:00, 1663.46it/s]warmup should be done:  82%|████████▏ | 2468/3000 [00:01<00:00, 1751.40it/s]warmup should be done:  81%|████████  | 2419/3000 [00:01<00:00, 1762.23it/s]warmup should be done:  83%|████████▎ | 2504/3000 [00:01<00:00, 1806.17it/s]warmup should be done:  83%|████████▎ | 2485/3000 [00:01<00:00, 1695.22it/s]warmup should be done:  88%|████████▊ | 2647/3000 [00:01<00:00, 1761.03it/s]warmup should be done:  87%|████████▋ | 2596/3000 [00:01<00:00, 1764.17it/s]warmup should be done:  90%|████████▉ | 2686/3000 [00:01<00:00, 1809.93it/s]warmup should be done:  89%|████████▊ | 2662/3000 [00:01<00:00, 1715.14it/s]warmup should be done:  94%|█████████▍| 2826/3000 [00:01<00:00, 1769.44it/s]warmup should be done:  92%|█████████▏| 2774/3000 [00:01<00:00, 1768.20it/s]warmup should be done:  96%|█████████▌| 2868/3000 [00:01<00:00, 1812.41it/s]warmup should be done:  94%|█████████▍| 2835/3000 [00:01<00:00, 1702.15it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1768.56it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1756.77it/s]warmup should be done:  98%|█████████▊| 2953/3000 [00:01<00:00, 1772.81it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1725.39it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1725.37it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 185/3000 [00:00<00:01, 1848.47it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1836.81it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1764.09it/s]warmup should be done:   6%|▌         | 179/3000 [00:00<00:01, 1780.65it/s]warmup should be done:  12%|█▏        | 371/3000 [00:00<00:01, 1851.70it/s]warmup should be done:  12%|█▏        | 369/3000 [00:00<00:01, 1840.13it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1812.24it/s]warmup should be done:  12%|█▏        | 363/3000 [00:00<00:01, 1813.89it/s]warmup should be done:  18%|█▊        | 554/3000 [00:00<00:01, 1841.72it/s]warmup should be done:  19%|█▊        | 557/3000 [00:00<00:01, 1850.22it/s]warmup should be done:  18%|█▊        | 547/3000 [00:00<00:01, 1827.57it/s]warmup should be done:  18%|█▊        | 551/3000 [00:00<00:01, 1841.84it/s]warmup should be done:  25%|██▍       | 739/3000 [00:00<00:01, 1843.60it/s]warmup should be done:  24%|██▍       | 731/3000 [00:00<00:01, 1831.36it/s]warmup should be done:  25%|██▍       | 739/3000 [00:00<00:01, 1855.48it/s]warmup should be done:  25%|██▍       | 743/3000 [00:00<00:01, 1850.69it/s]warmup should be done:  31%|███       | 924/3000 [00:00<00:01, 1842.78it/s]warmup should be done:  31%|███       | 927/3000 [00:00<00:01, 1862.05it/s]warmup should be done:  31%|███       | 929/3000 [00:00<00:01, 1848.88it/s]warmup should be done:  30%|███       | 915/3000 [00:00<00:01, 1786.67it/s]warmup should be done:  37%|███▋      | 1109/3000 [00:00<00:01, 1843.61it/s]warmup should be done:  37%|███▋      | 1115/3000 [00:00<00:01, 1865.74it/s]warmup should be done:  37%|███▋      | 1115/3000 [00:00<00:01, 1850.39it/s]warmup should be done:  37%|███▋      | 1098/3000 [00:00<00:01, 1800.95it/s]warmup should be done:  43%|████▎     | 1294/3000 [00:00<00:00, 1839.29it/s]warmup should be done:  43%|████▎     | 1302/3000 [00:00<00:00, 1857.16it/s]warmup should be done:  43%|████▎     | 1280/3000 [00:00<00:00, 1805.17it/s]warmup should be done:  43%|████▎     | 1301/3000 [00:00<00:00, 1782.57it/s]warmup should be done:  49%|████▉     | 1480/3000 [00:00<00:00, 1842.68it/s]warmup should be done:  50%|████▉     | 1490/3000 [00:00<00:00, 1862.42it/s]warmup should be done:  49%|████▉     | 1464/3000 [00:00<00:00, 1813.28it/s]warmup should be done:  49%|████▉     | 1480/3000 [00:00<00:00, 1772.60it/s]warmup should be done:  56%|█████▌    | 1665/3000 [00:00<00:00, 1843.28it/s]warmup should be done:  56%|█████▌    | 1678/3000 [00:00<00:00, 1866.24it/s]warmup should be done:  55%|█████▍    | 1648/3000 [00:00<00:00, 1819.06it/s]warmup should be done:  55%|█████▌    | 1658/3000 [00:00<00:00, 1757.96it/s]warmup should be done:  62%|██████▏   | 1851/3000 [00:01<00:00, 1845.67it/s]warmup should be done:  62%|██████▏   | 1867/3000 [00:01<00:00, 1870.62it/s]warmup should be done:  61%|██████    | 1832/3000 [00:01<00:00, 1823.36it/s]warmup should be done:  61%|██████▏   | 1844/3000 [00:01<00:00, 1786.05it/s]warmup should be done:  68%|██████▊   | 2036/3000 [00:01<00:00, 1844.14it/s]warmup should be done:  68%|██████▊   | 2055/3000 [00:01<00:00, 1871.56it/s]warmup should be done:  67%|██████▋   | 2016/3000 [00:01<00:00, 1825.53it/s]warmup should be done:  68%|██████▊   | 2029/3000 [00:01<00:00, 1802.86it/s]warmup should be done:  75%|███████▍  | 2243/3000 [00:01<00:00, 1873.11it/s]warmup should be done:  74%|███████▍  | 2221/3000 [00:01<00:00, 1840.67it/s]warmup should be done:  73%|███████▎  | 2200/3000 [00:01<00:00, 1827.30it/s]warmup should be done:  74%|███████▍  | 2214/3000 [00:01<00:00, 1815.73it/s]warmup should be done:  81%|████████  | 2431/3000 [00:01<00:00, 1872.37it/s]warmup should be done:  80%|████████  | 2406/3000 [00:01<00:00, 1838.95it/s]warmup should be done:  79%|███████▉  | 2383/3000 [00:01<00:00, 1827.95it/s]warmup should be done:  80%|███████▉  | 2399/3000 [00:01<00:00, 1824.83it/s]warmup should be done:  87%|████████▋ | 2619/3000 [00:01<00:00, 1873.24it/s]warmup should be done:  86%|████████▋ | 2591/3000 [00:01<00:00, 1841.18it/s]warmup should be done:  86%|████████▌ | 2566/3000 [00:01<00:00, 1827.90it/s]warmup should be done:  86%|████████▌ | 2582/3000 [00:01<00:00, 1794.63it/s]warmup should be done:  93%|█████████▎| 2776/3000 [00:01<00:00, 1843.13it/s]warmup should be done:  92%|█████████▏| 2749/3000 [00:01<00:00, 1825.08it/s]warmup should be done:  94%|█████████▎| 2807/3000 [00:01<00:00, 1835.93it/s]warmup should be done:  92%|█████████▏| 2769/3000 [00:01<00:00, 1814.48it/s]warmup should be done:  99%|█████████▊| 2961/3000 [00:01<00:00, 1817.12it/s]warmup should be done:  98%|█████████▊| 2933/3000 [00:01<00:00, 1827.90it/s]warmup should be done: 100%|█████████▉| 2993/3000 [00:01<00:00, 1840.64it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1854.71it/s]warmup should be done:  99%|█████████▊| 2956/3000 [00:01<00:00, 1829.25it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1836.38it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1815.71it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1813.29it/s]2022-12-12 00:18:51.588493: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fa532a6b0a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:18:51.588553: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:18:51.745216: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fa52a268260 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:18:51.745287: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:18:53.187374: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:18:54.195020: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:18:54.298252: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:18:55.299946: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:18:55.703828: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:18:56.721024: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:19:04.908206: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fa52a264040 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:19:04.908271: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:19:05.757279: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fa532a67800 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:19:05.757342: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:19:08.775769: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:19:09.731827: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:19:10.859981: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:19:11.794827: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:19:12.588179: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:19:13.591256: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][00:19:40.042][ERROR][RK0][tid #140347585853184]: replica 1 reaches 1000, calling init pre replica
[HCTR][00:19:40.042][ERROR][RK0][tid #140347585853184]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:19:40.047][ERROR][RK0][tid #140347585853184]: coll ps creation done
[HCTR][00:19:40.047][ERROR][RK0][tid #140347585853184]: replica 1 waits for coll ps creation barrier
[HCTR][00:19:40.226][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][00:19:40.226][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:19:40.230][ERROR][RK0][main]: coll ps creation done
[HCTR][00:19:40.230][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][00:19:40.428][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][00:19:40.428][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:19:40.433][ERROR][RK0][main]: coll ps creation done
[HCTR][00:19:40.433][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][00:19:40.654][ERROR][RK0][tid #140347585853184]: replica 0 reaches 1000, calling init pre replica
[HCTR][00:19:40.655][ERROR][RK0][tid #140347585853184]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:19:40.659][ERROR][RK0][tid #140347585853184]: coll ps creation done
[HCTR][00:19:40.659][ERROR][RK0][tid #140347585853184]: replica 0 waits for coll ps creation barrier
[HCTR][00:19:40.659][ERROR][RK0][tid #140347585853184]: replica 0 preparing frequency
[HCTR][00:19:41.573][ERROR][RK0][tid #140347585853184]: replica 0 preparing frequency done
[HCTR][00:19:41.605][ERROR][RK0][tid #140347585853184]: replica 0 calling init per replica
[HCTR][00:19:41.605][ERROR][RK0][tid #140347585853184]: Calling build_v2
[HCTR][00:19:41.605][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][00:19:41.605][ERROR][RK0][tid #140347585853184]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:19:41.605][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][00:19:41.605][ERROR][RK0][tid #140347585853184]: replica 1 calling init per replica
[HCTR][00:19:41.605][ERROR][RK0][main]: Calling build_v2
[HCTR][00:19:41.605][ERROR][RK0][tid #140347585853184]: Calling build_v2
[HCTR][00:19:41.605][ERROR][RK0][main]: Calling build_v2
[HCTR][00:19:41.605][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:19:41.605][ERROR][RK0][tid #140347585853184]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:19:41.605][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-12 00:19:41.605775: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[[2022-12-12 00:19:41.605825: E 2022-12-12 00:19:41/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc.:605828136: ] [Eusing concurrent impl MPSPhase 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc2022-12-12 00:19:41:.136605858] : using concurrent impl MPSPhaseE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[2022-12-12 00:19:41.606757: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-12 00:19:41.606806: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 00:19:41.606853: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 00:19:41.606883: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 00:19:41.607090: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-12 00:19:41.607119: E[ 2022-12-12 00:19:41[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.2022-12-12 00:19:41:607141.196: 607147] E: assigning 8 to cpu E
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc212:] 196build symm link desc with 4X Tesla V100-SXM2-16GB out of 4] 
assigning 8 to cpu
[2022-12-12 00:19:41[.2022-12-12 00:19:41607254.: 607270E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc212:] 213build symm link desc with 4X Tesla V100-SXM2-16GB out of 4] 
remote time is 8.68421
[2022-12-12 00:19:41.607333: [E2022-12-12 00:19:41 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc607336[:: 2022-12-12 00:19:41214E.]  607335cpu time is 30/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 
:E213 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421:
212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 00:19:41.607461[: 2022-12-12 00:19:41E. 607477/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E214 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30:
213] remote time is 8.68421
[2022-12-12 00:19:41.607574: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 00:20:05.617502: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 00:20:05.686165: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 00:20:05.686278: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 00:20:05.688221: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 00:20:05.803938: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 00:20:06.183322: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 00:20:06.183414: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 00:20:13.525791: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 00:20:13.525910: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 00:20:15.266963: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 00:20:15.267055: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 00:20:15.290514: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 00:20:15.290597: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 00:20:15.320720: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 00:20:15.332684: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 00:20:15.333458: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 00:20:15.343298: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 00:20:15.439758: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 00:20:15.442996: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-12 00:20:15.445496: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-12 00:20:15.447938: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-12 00:20:15.450374: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-12 00:20:16.716248: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 00:20:16.720739: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 00:20:16.721126: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 00:20:16.729291: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 00:20:16.729474: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 00:20:16.729561: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 00:20:16.729641: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 00:20:16.731077: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:20:16.731185: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:20:16.733036: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:20:16.734413: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:20:16.751970: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 00:20:16.752063: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[[2022-12-12 00:20:16.7522052022-12-12 00:20:16: .E752220 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 202/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :1 solved202
] 2 solved
[2022-12-12 00:20:16.752296[: 2022-12-12 00:20:16E. 752304/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc: :E205 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccworker 0 thread 1 initing device 1:
205] worker 0 thread 2 initing device 2
[2022-12-12 00:20:16.753013: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:20:16.753068: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:20:16.753104: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:20:16.753154: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:20:16.753259: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:20:16.753310: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:20:16.754859: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-12 00:20:16
.754884: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:20:16.755426: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:20:16.756358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:20:16.756418: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:20:16.756449: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-12 00:20:162022-12-12 00:20:16..825541825541: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-12 00:20:16.827413: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 00:20:16.827464: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:20:16.827785: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 00:20:16.827838: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:20:16.828263: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:20:16.828997: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:20:16.829245: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:16.829424: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:16.830187: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:16.830232: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.76 MB
[2022-12-12 00:20:16.830371: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:16.830414: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.77 MB
[2022-12-12 00:20:16.832519: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 00:20:16.834321: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 00:20:16.834371: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:20:16.835137: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:20:16.835585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:16.836512: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:16.836558: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.62 MB
[2022-12-12 00:20:16.851666: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 00:20:16.853472: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 00:20:16.853523: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:20:16.854271: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:20:16.854709: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:16.855642: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:16.855685: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.58 MB
[2022-12-12 00:20:16.857657: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:20:16.858233: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:20:16.858275: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.71 GB
[2022-12-12 00:20:16.885117: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:20:16.885699: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:20:16.885740: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[2022-12-12 00:20:16.886749: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:20:16.887313: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:20:16.887352: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[2022-12-12 00:20:16.911872: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:20:16.912468: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:20:16.912511: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.70 GB
[[2022-12-12 00:20:17[[2022-12-12 00:20:17.2022-12-12 00:20:172022-12-12 00:20:17.428529..428527: 428534428534: E: : E EE /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926::1926] 19261926] Device 3 init p2p of link 0] ] Device 2 init p2p of link 3
Device 1 init p2p of link 2Device 0 init p2p of link 1


[2022-12-12 00:20:17.428828: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-12 00:20:17[] .2022-12-12 00:20:17eager alloc mem 611.00 KB428848.
: 428854E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KB
[2022-12-12 00:20:17.428958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:17.429660: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:17.[4296912022-12-12 00:20:17: .E429697 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 625663638
] eager release cuda mem 625663
[2022-12-12 00:20:17.429795: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:17.435522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-12 00:20:17.435617: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:17.436224: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-12 00:20:17.436267: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 00:20:17.436320: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:17.436370: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:17.436429: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-12 00:20:17
.436442: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 00:20:17.436538: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:17.437122: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:17.437179: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:17.437337: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:17.441606: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 00:20:17.441687: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:17.442517: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:17.442869: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 00:20:17.442968: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:17.443508: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 00:20:17.443591: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:17.443791: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:17.444143: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 00:20:17.444231: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:20:17.444388: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:17.445030: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:20:17.447630: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:20:17.447908: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11947473 / 100000000 nodes ( 11.95 %~12.00 %) | remote 32954835 / 100000000 nodes ( 32.95 %) | cpu 55097692 / 100000000 nodes ( 55.10 %) | 5.70 GB | 0.694766 secs 
[2022-12-12 00:20:17.448572: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:20:17.448815: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:2022-12-12 00:20:17638.] 448841eager release cuda mem 48399996: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11998960 / 100000000 nodes ( 12.00 %~12.00 %) | remote 32903348 / 100000000 nodes ( 32.90 %) | cpu 55097692 / 100000000 nodes ( 55.10 %) | 5.73 GB | 0.695544 secs 
[2022-12-12 00:20:17.449173: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11958227 / 100000000 nodes ( 11.96 %~12.00 %) | remote 32944081 / 100000000 nodes ( 32.94 %) | cpu 55097692 / 100000000 nodes ( 55.10 %) | 5.71 GB | 0.718003 secs 
[2022-12-12 00:20:17.449655: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 10.73 GB
[2022-12-12 00:20:17.450093: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:20:17.450372: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11996228 / 100000000 nodes ( 12.00 %~12.00 %) | remote 32906080 / 100000000 nodes ( 32.91 %) | cpu 55097692 / 100000000 nodes ( 55.10 %) | 5.73 GB | 0.697324 secs 
[2022-12-12 00:20:18.464890: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 10.98 GB
[2022-12-12 00:20:18.465029: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 10.98 GB
[2022-12-12 00:20:18.465307: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 10.98 GB
[2022-12-12 00:20:19.344124: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 11.23 GB
[2022-12-12 00:20:19.344239: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 11.23 GB
[2022-12-12 00:20:19.344669: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 11.23 GB
[2022-12-12 00:20:20.100156: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 11.47 GB
[2022-12-12 00:20:20.100288: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 11.47 GB
[2022-12-12 00:20:20.100608: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 11.47 GB
[2022-12-12 00:20:20.100843: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 11.47 GB
[2022-12-12 00:20:20.101846: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 11.47 GB
[2022-12-12 00:20:20.889954: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 11.66 GB
[2022-12-12 00:20:20.890078: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 11.66 GB
[HCTR][00:20:21.187][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][00:20:21.187][ERROR][RK0][tid #140347585853184]: replica 1 calling init per replica done, doing barrier
[HCTR][00:20:21.187][ERROR][RK0][tid #140347585853184]: replica 0 calling init per replica done, doing barrier
[HCTR][00:20:21.187][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][00:20:21.187][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][00:20:21.187][ERROR][RK0][tid #140347585853184]: replica 0 calling init per replica done, doing barrier done
[HCTR][00:20:21.187][ERROR][RK0][tid #140347585853184]: replica 1 calling init per replica done, doing barrier done
[HCTR][00:20:21.187][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][00:20:21.187][ERROR][RK0][main]: init per replica done
[HCTR][00:20:21.187][ERROR][RK0][tid #140347585853184]: init per replica done
[HCTR][00:20:21.187][ERROR][RK0][main]: init per replica done
[HCTR][00:20:21.189][ERROR][RK0][tid #140347585853184]: init per replica done
[HCTR][00:20:21.193][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f9323520000
[HCTR][00:20:21.193][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f9326e00000
[HCTR][00:20:21.193][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f9327440000
[HCTR][00:20:21.193][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f9327760000
[HCTR][00:20:21.194][ERROR][RK0][tid #140347585853184]: 1 allocated 3276800 at 0x7f9327520000
[HCTR][00:20:21.194][ERROR][RK0][tid #140347585853184]: 1 allocated 6553600 at 0x7f932ae00000
[HCTR][00:20:21.194][ERROR][RK0][tid #140347585853184]: 1 allocated 3276800 at 0x7f932b440000
[HCTR][00:20:21.194][ERROR][RK0][tid #140347585853184]: 1 allocated 6553600 at 0x7f932b760000
[HCTR][00:20:21.195][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f9327520000
[HCTR][00:20:21.195][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f932ae00000
[HCTR][00:20:21.195][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f932b440000
[HCTR][00:20:21.195][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f932b760000
[HCTR][00:20:21.199][ERROR][RK0][tid #140347585853184]: 0 allocated 3276800 at 0x7f8daa320000
[HCTR][00:20:21.199][ERROR][RK0][tid #140347585853184]: 0 allocated 6553600 at 0x7fa6bb200000
[HCTR][00:20:21.199][ERROR][RK0][tid #140347585853184]: 0 allocated 3276800 at 0x7f8daad0e800
[HCTR][00:20:21.199][ERROR][RK0][tid #140347585853184]: 0 allocated 6553600 at 0x7f8dab02e800




