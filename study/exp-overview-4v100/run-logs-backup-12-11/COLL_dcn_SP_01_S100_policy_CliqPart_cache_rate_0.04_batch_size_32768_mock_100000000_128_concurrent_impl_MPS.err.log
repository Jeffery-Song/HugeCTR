2022-12-11 21:11:10.684512: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:11:10.691589: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:11:10.767011: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:11:10.794930: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:11:11.590680: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:11:11.590763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:11:11.603176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:11:11.605600: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:11:11.605655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:11:11.620012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:11:11.638008: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:11:11.638088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:11:11.638787: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:11:11.638896: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:11:11.638935: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:11:11.638999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:11:11.640610: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 21:11:11.650041: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:11:11.650184: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:11:11.650196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:11:11.652167: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 21:11:11.653711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:11:11.680118: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:11:11.680288: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:11:11.681692: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 21:11:11.685299: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:11:11.685439: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:11:11.686711: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][21:11:11.964][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:11:12.924][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:11:12.930][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:11:12.930][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.55s/it]warmup run: 101it [00:01, 85.12it/s]warmup run: 210it [00:01, 193.31it/s]warmup run: 317it [00:01, 309.92it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 424it [00:01, 431.06it/s]warmup run: 108it [00:01, 96.67it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 530it [00:02, 547.88it/s]warmup run: 217it [00:01, 209.46it/s]warmup run: 101it [00:01, 91.95it/s]warmup run: 637it [00:02, 657.37it/s]warmup run: 324it [00:01, 329.37it/s]warmup run: 202it [00:01, 197.68it/s]warmup run: 745it [00:02, 754.10it/s]warmup run: 430it [00:01, 450.24it/s]warmup run: 307it [00:01, 318.10it/s]warmup run: 853it [00:02, 834.53it/s]warmup run: 538it [00:01, 570.15it/s]warmup run: 412it [00:01, 441.03it/s]warmup run: 961it [00:02, 896.87it/s]warmup run: 644it [00:02, 674.37it/s]warmup run: 518it [00:01, 559.81it/s]warmup run: 1070it [00:02, 949.00it/s]warmup run: 751it [00:02, 765.90it/s]warmup run: 625it [00:02, 669.26it/s]warmup run: 1184it [00:02, 1001.67it/s]warmup run: 859it [00:02, 843.41it/s]warmup run: 732it [00:02, 763.36it/s]warmup run: 1296it [00:02, 1034.66it/s]warmup run: 964it [00:02, 896.96it/s]warmup run: 839it [00:02, 840.22it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1406it [00:02, 1024.80it/s]warmup run: 1069it [00:02, 922.05it/s]warmup run: 943it [00:02, 892.30it/s]warmup run: 1516it [00:02, 1045.56it/s]warmup run: 1183it [00:02, 980.21it/s]warmup run: 1053it [00:02, 947.29it/s]warmup run: 1627it [00:03, 1062.95it/s]warmup run: 1292it [00:02, 1010.21it/s]warmup run: 1163it [00:02, 987.91it/s]warmup run: 1740it [00:03, 1080.98it/s]warmup run: 1399it [00:02, 1023.87it/s]warmup run: 1270it [00:02, 1005.35it/s]warmup run: 1853it [00:03, 1094.06it/s]warmup run: 1506it [00:02, 1034.99it/s]warmup run: 1380it [00:02, 1031.39it/s]warmup run: 1964it [00:03, 1096.36it/s]warmup run: 1488it [00:02, 1041.37it/s]warmup run: 1613it [00:02, 1029.11it/s]warmup run: 2095it [00:03, 1157.61it/s]warmup run: 1719it [00:03, 1037.40it/s]warmup run: 1595it [00:02, 1046.40it/s]warmup run: 2228it [00:03, 1207.31it/s]warmup run: 1702it [00:03, 1050.24it/s]warmup run: 1825it [00:03, 1039.27it/s]warmup run: 2366it [00:03, 1258.63it/s]warmup run: 1809it [00:03, 1054.68it/s]warmup run: 1930it [00:03, 1010.80it/s]warmup run: 2504it [00:03, 1294.85it/s]warmup run: 1916it [00:03, 1053.52it/s]warmup run: 2035it [00:03, 1021.42it/s]warmup run: 2643it [00:03, 1320.47it/s]warmup run: 2027it [00:03, 1068.96it/s]warmup run: 2168it [00:03, 1110.54it/s]warmup run: 2780it [00:03, 1334.59it/s]warmup run: 2160it [00:03, 1145.01it/s]warmup run: 2304it [00:03, 1182.31it/s]warmup run: 2919it [00:04, 1348.31it/s]warmup run: 2290it [00:03, 1190.44it/s]warmup run: 2423it [00:03, 1179.50it/s]warmup run: 3000it [00:04, 726.13it/s] warmup run: 2424it [00:03, 1232.74it/s]warmup run: 2560it [00:03, 1235.50it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 2553it [00:03, 1249.09it/s]warmup run: 2698it [00:03, 1275.94it/s]warmup run: 106it [00:01, 97.43it/s]warmup run: 2687it [00:03, 1273.70it/s]warmup run: 2834it [00:03, 1300.73it/s]warmup run: 204it [00:01, 200.04it/s]warmup run: 2818it [00:03, 1284.21it/s]warmup run: 2972it [00:04, 1322.00it/s]warmup run: 3000it [00:04, 729.26it/s] warmup run: 304it [00:01, 313.61it/s]warmup run: 2950it [00:04, 1293.17it/s]warmup run: 408it [00:01, 436.15it/s]warmup run: 3000it [00:04, 734.55it/s] warmup run: 514it [00:01, 556.98it/s]warmup run: 621it [00:02, 668.36it/s]warmup run: 728it [00:02, 761.78it/s]warmup run: 834it [00:02, 836.32it/s]warmup run: 940it [00:02, 893.70it/s]warmup run: 1047it [00:02, 940.58it/s]warmup run: 1152it [00:02, 949.56it/s]warmup run: 1261it [00:02, 986.89it/s]warmup run: 1370it [00:02, 1014.57it/s]warmup run: 1479it [00:02, 1035.34it/s]warmup run: 1588it [00:02, 1050.34it/s]warmup run: 1696it [00:03, 1057.04it/s]warmup run: 1805it [00:03, 1053.09it/s]warmup run: 1912it [00:03, 1057.41it/s]warmup run: 2024it [00:03, 1075.42it/s]warmup run: 2160it [00:03, 1158.04it/s]warmup run: 2296it [00:03, 1218.05it/s]warmup run: 2433it [00:03, 1260.89it/s]warmup run: 2567it [00:03, 1282.80it/s]warmup run: 2702it [00:03, 1300.67it/s]warmup run: 2836it [00:03, 1312.06it/s]warmup run: 2972it [00:04, 1325.83it/s]warmup run: 3000it [00:04, 739.35it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1807.38it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1691.27it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1644.94it/s]warmup should be done:   5%|▌         | 160/3000 [00:00<00:01, 1591.35it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1752.41it/s]warmup should be done:  11%|█         | 337/3000 [00:00<00:01, 1692.28it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1737.83it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1739.41it/s]warmup should be done:  18%|█▊        | 529/3000 [00:00<00:01, 1778.16it/s]warmup should be done:  17%|█▋        | 512/3000 [00:00<00:01, 1717.56it/s]warmup should be done:  17%|█▋        | 522/3000 [00:00<00:01, 1735.50it/s]warmup should be done:  18%|█▊        | 542/3000 [00:00<00:01, 1766.36it/s]warmup should be done:  24%|██▎       | 712/3000 [00:00<00:01, 1795.53it/s]warmup should be done:  23%|██▎       | 690/3000 [00:00<00:01, 1739.47it/s]warmup should be done:  23%|██▎       | 698/3000 [00:00<00:01, 1741.41it/s]warmup should be done:  24%|██▍       | 723/3000 [00:00<00:01, 1782.89it/s]warmup should be done:  30%|██▉       | 893/3000 [00:00<00:01, 1800.35it/s]warmup should be done:  29%|██▉       | 865/3000 [00:00<00:01, 1740.94it/s]warmup should be done:  29%|██▉       | 873/3000 [00:00<00:01, 1735.39it/s]warmup should be done:  30%|███       | 903/3000 [00:00<00:01, 1787.39it/s]warmup should be done:  36%|███▌      | 1074/3000 [00:00<00:01, 1802.50it/s]warmup should be done:  35%|███▍      | 1041/3000 [00:00<00:01, 1744.59it/s]warmup should be done:  35%|███▍      | 1047/3000 [00:00<00:01, 1734.29it/s]warmup should be done:  36%|███▌      | 1083/3000 [00:00<00:01, 1789.06it/s]warmup should be done:  42%|████▏     | 1255/3000 [00:00<00:00, 1802.65it/s]warmup should be done:  41%|████      | 1216/3000 [00:00<00:01, 1745.60it/s]warmup should be done:  42%|████▏     | 1264/3000 [00:00<00:00, 1794.23it/s]warmup should be done:  41%|████      | 1221/3000 [00:00<00:01, 1648.22it/s]warmup should be done:  48%|████▊     | 1436/3000 [00:00<00:00, 1804.43it/s]warmup should be done:  46%|████▋     | 1394/3000 [00:00<00:00, 1753.48it/s]warmup should be done:  48%|████▊     | 1445/3000 [00:00<00:00, 1798.54it/s]warmup should be done:  46%|████▌     | 1387/3000 [00:00<00:00, 1637.40it/s]warmup should be done:  54%|█████▍    | 1618/3000 [00:00<00:00, 1807.64it/s]warmup should be done:  52%|█████▏    | 1571/3000 [00:00<00:00, 1758.60it/s]warmup should be done:  54%|█████▍    | 1626/3000 [00:00<00:00, 1801.09it/s]warmup should be done:  52%|█████▏    | 1552/3000 [00:00<00:00, 1631.10it/s]warmup should be done:  60%|██████    | 1801/3000 [00:01<00:00, 1811.74it/s]warmup should be done:  58%|█████▊    | 1748/3000 [00:01<00:00, 1759.43it/s]warmup should be done:  60%|██████    | 1807/3000 [00:01<00:00, 1803.01it/s]warmup should be done:  57%|█████▋    | 1716/3000 [00:01<00:00, 1628.85it/s]warmup should be done:  66%|██████▌   | 1983/3000 [00:01<00:00, 1812.67it/s]warmup should be done:  64%|██████▍   | 1926/3000 [00:01<00:00, 1762.71it/s]warmup should be done:  66%|██████▋   | 1989/3000 [00:01<00:00, 1807.47it/s]warmup should be done:  63%|██████▎   | 1880/3000 [00:01<00:00, 1626.15it/s]warmup should be done:  72%|███████▏  | 2165/3000 [00:01<00:00, 1813.84it/s]warmup should be done:  70%|███████   | 2105/3000 [00:01<00:00, 1770.86it/s]warmup should be done:  72%|███████▏  | 2170/3000 [00:01<00:00, 1786.40it/s]warmup should be done:  68%|██████▊   | 2043/3000 [00:01<00:00, 1626.24it/s]warmup should be done:  78%|███████▊  | 2347/3000 [00:01<00:00, 1814.12it/s]warmup should be done:  76%|███████▌  | 2283/3000 [00:01<00:00, 1773.51it/s]warmup should be done:  78%|███████▊  | 2351/3000 [00:01<00:00, 1791.70it/s]warmup should be done:  74%|███████▎  | 2207/3000 [00:01<00:00, 1627.81it/s]warmup should be done:  84%|████████▍ | 2530/3000 [00:01<00:00, 1818.65it/s]warmup should be done:  82%|████████▏ | 2463/3000 [00:01<00:00, 1780.60it/s]warmup should be done:  84%|████████▍ | 2531/3000 [00:01<00:00, 1790.65it/s]warmup should be done:  79%|███████▉  | 2371/3000 [00:01<00:00, 1629.95it/s]warmup should be done:  90%|█████████ | 2712/3000 [00:01<00:00, 1814.15it/s]warmup should be done:  88%|████████▊ | 2642/3000 [00:01<00:00, 1741.58it/s]warmup should be done:  90%|█████████ | 2713/3000 [00:01<00:00, 1796.50it/s]warmup should be done:  85%|████████▍ | 2538/3000 [00:01<00:00, 1638.97it/s]warmup should be done:  96%|█████████▋| 2894/3000 [00:01<00:00, 1803.26it/s]warmup should be done:  94%|█████████▍| 2823/3000 [00:01<00:00, 1759.26it/s]warmup should be done:  96%|█████████▋| 2893/3000 [00:01<00:00, 1779.86it/s]warmup should be done:  90%|█████████ | 2704/3000 [00:01<00:00, 1642.49it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1802.07it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1789.55it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1753.74it/s]warmup should be done:  96%|█████████▌| 2870/3000 [00:01<00:00, 1646.00it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1659.39it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1693.16it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1737.70it/s]warmup should be done:   5%|▍         | 141/3000 [00:00<00:02, 1408.35it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1722.13it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1819.19it/s]warmup should be done:  11%|█▏        | 340/3000 [00:00<00:01, 1691.13it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1799.97it/s]warmup should be done:  10%|█         | 314/3000 [00:00<00:01, 1592.23it/s]warmup should be done:  18%|█▊        | 550/3000 [00:00<00:01, 1844.80it/s]warmup should be done:  18%|█▊        | 545/3000 [00:00<00:01, 1826.84it/s]warmup should be done:  17%|█▋        | 514/3000 [00:00<00:01, 1712.07it/s]warmup should be done:  16%|█▌        | 486/3000 [00:00<00:01, 1646.15it/s]warmup should be done:  23%|██▎       | 688/3000 [00:00<00:01, 1722.87it/s]warmup should be done:  25%|██▍       | 737/3000 [00:00<00:01, 1851.33it/s]warmup should be done:  24%|██▍       | 732/3000 [00:00<00:01, 1840.46it/s]warmup should be done:  22%|██▏       | 662/3000 [00:00<00:01, 1688.18it/s]warmup should be done:  29%|██▊       | 861/3000 [00:00<00:01, 1723.30it/s]warmup should be done:  31%|███       | 924/3000 [00:00<00:01, 1856.16it/s]warmup should be done:  31%|███       | 919/3000 [00:00<00:01, 1848.41it/s]warmup should be done:  28%|██▊       | 835/3000 [00:00<00:01, 1700.46it/s]warmup should be done:  34%|███▍      | 1035/3000 [00:00<00:01, 1726.51it/s]warmup should be done:  37%|███▋      | 1106/3000 [00:00<00:01, 1853.18it/s]warmup should be done:  34%|███▎      | 1009/3000 [00:00<00:01, 1711.95it/s]warmup should be done:  37%|███▋      | 1110/3000 [00:00<00:01, 1787.96it/s]warmup should be done:  43%|████▎     | 1292/3000 [00:00<00:00, 1852.40it/s]warmup should be done:  40%|████      | 1208/3000 [00:00<00:01, 1722.34it/s]warmup should be done:  39%|███▉      | 1181/3000 [00:00<00:01, 1699.91it/s]warmup should be done:  43%|████▎     | 1294/3000 [00:00<00:00, 1804.03it/s]warmup should be done:  46%|████▌     | 1381/3000 [00:00<00:00, 1714.17it/s]warmup should be done:  49%|████▉     | 1478/3000 [00:00<00:00, 1841.88it/s]warmup should be done:  45%|████▌     | 1361/3000 [00:00<00:00, 1728.70it/s]warmup should be done:  49%|████▉     | 1479/3000 [00:00<00:00, 1816.51it/s]warmup should be done:  52%|█████▏    | 1565/3000 [00:00<00:00, 1751.58it/s]warmup should be done:  56%|█████▌    | 1665/3000 [00:00<00:00, 1848.62it/s]warmup should be done:  51%|█████▏    | 1540/3000 [00:00<00:00, 1747.54it/s]warmup should be done:  55%|█████▌    | 1663/3000 [00:00<00:00, 1822.96it/s]warmup should be done:  58%|█████▊    | 1751/3000 [00:01<00:00, 1783.20it/s]warmup should be done:  62%|██████▏   | 1852/3000 [00:01<00:00, 1852.41it/s]warmup should be done:  57%|█████▋    | 1721/3000 [00:01<00:00, 1765.99it/s]warmup should be done:  62%|██████▏   | 1848/3000 [00:01<00:00, 1830.90it/s]warmup should be done:  65%|██████▍   | 1936/3000 [00:01<00:00, 1803.44it/s]warmup should be done:  68%|██████▊   | 2038/3000 [00:01<00:00, 1854.67it/s]warmup should be done:  63%|██████▎   | 1904/3000 [00:01<00:00, 1784.02it/s]warmup should be done:  68%|██████▊   | 2032/3000 [00:01<00:00, 1828.54it/s]warmup should be done:  70%|██████▉   | 2087/3000 [00:01<00:00, 1795.54it/s]warmup should be done:  71%|███████   | 2117/3000 [00:01<00:00, 1796.17it/s]warmup should be done:  74%|███████▍  | 2224/3000 [00:01<00:00, 1848.03it/s]warmup should be done:  74%|███████▍  | 2216/3000 [00:01<00:00, 1829.35it/s]warmup should be done:  76%|███████▌  | 2269/3000 [00:01<00:00, 1801.64it/s]warmup should be done:  80%|████████  | 2410/3000 [00:01<00:00, 1850.54it/s]warmup should be done:  77%|███████▋  | 2304/3000 [00:01<00:00, 1815.77it/s]warmup should be done:  80%|████████  | 2400/3000 [00:01<00:00, 1829.70it/s]warmup should be done:  82%|████████▏ | 2452/3000 [00:01<00:00, 1807.43it/s]warmup should be done:  87%|████████▋ | 2596/3000 [00:01<00:00, 1850.46it/s]warmup should be done:  83%|████████▎ | 2491/3000 [00:01<00:00, 1829.07it/s]warmup should be done:  86%|████████▌ | 2585/3000 [00:01<00:00, 1834.05it/s]warmup should be done:  88%|████████▊ | 2635/3000 [00:01<00:00, 1813.06it/s]warmup should be done:  93%|█████████▎| 2782/3000 [00:01<00:00, 1852.89it/s]warmup should be done:  89%|████████▉ | 2677/3000 [00:01<00:00, 1836.88it/s]warmup should be done:  92%|█████████▏| 2770/3000 [00:01<00:00, 1838.02it/s]warmup should be done:  94%|█████████▍| 2818/3000 [00:01<00:00, 1818.05it/s]warmup should be done:  99%|█████████▉| 2969/3000 [00:01<00:00, 1857.55it/s]warmup should be done:  95%|█████████▌| 2862/3000 [00:01<00:00, 1839.75it/s]warmup should be done:  98%|█████████▊| 2954/3000 [00:01<00:00, 1834.40it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1846.00it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1827.21it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1782.74it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1757.70it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f144fe890a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f144fe89220>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f144fe88190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f144fe89160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 21:12:24.714536: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1025268170 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:12:24.714605: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:12:24.722400: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:12:24.723576: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f101d26b230 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:12:24.723631: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:12:24.737048: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:12:25.789862: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f102526ab10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:12:25.789935: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:12:25.790105: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f101d2670e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:12:25.790136: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:12:25.800803: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:12:25.800803: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:12:25.895523: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:12:25.925804: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:12:26.477862: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:12:26.626434: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:12:31.377774: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:12:31.406092: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:12:31.941200: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:12:32.625186: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][21:13:31.333][ERROR][RK0][tid #139707920914176]: replica 3 reaches 1000, calling init pre replica
[HCTR][21:13:31.333][ERROR][RK0][tid #139707920914176]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][21:13:31.337][ERROR][RK0][tid #139707920914176]: coll ps creation done
[HCTR][21:13:31.337][ERROR][RK0][tid #139707920914176]: replica 3 waits for coll ps creation barrier
[HCTR][21:13:31.484][ERROR][RK0][tid #139707434399488]: replica 1 reaches 1000, calling init pre replica
[HCTR][21:13:31.484][ERROR][RK0][tid #139707434399488]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][21:13:31.488][ERROR][RK0][tid #139707434399488]: coll ps creation done
[HCTR][21:13:31.488][ERROR][RK0][tid #139707434399488]: replica 1 waits for coll ps creation barrier
[HCTR][21:13:31.625][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][21:13:31.625][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][21:13:31.629][ERROR][RK0][main]: coll ps creation done
[HCTR][21:13:31.629][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][21:13:31.821][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][21:13:31.821][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][21:13:31.826][ERROR][RK0][main]: coll ps creation done
[HCTR][21:13:31.826][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][21:13:31.826][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][21:13:32.779][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][21:13:32.807][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][21:13:32.807][ERROR][RK0][tid #139707434399488]: replica 1 calling init per replica
[HCTR][21:13:32.807][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][21:13:32.807][ERROR][RK0][tid #139707920914176]: replica 3 calling init per replica
[HCTR][21:13:32.807][ERROR][RK0][main]: Calling build_v2
[HCTR][21:13:32.807][ERROR][RK0][tid #139707434399488]: Calling build_v2
[HCTR][21:13:32.807][ERROR][RK0][main]: Calling build_v2
[HCTR][21:13:32.807][ERROR][RK0][tid #139707920914176]: Calling build_v2
[HCTR][21:13:32.807][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:13:32.807][ERROR][RK0][tid #139707434399488]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:13:32.807][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:13:32.807][ERROR][RK0][tid #139707920914176]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[[2022-12-11 21:13:32.2022-12-11 21:13:328074072022-12-11 21:13:32.2022-12-11 21:13:32: .807404.E807419: 807407 : E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc 136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] :136:using concurrent impl MPS136] 136
] using concurrent impl MPS] using concurrent impl MPS
using concurrent impl MPS

[2022-12-11 21:13:32.808699: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] [assigning 8 to cpu2022-12-11 21:13:32
.808722: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[1962022-12-11 21:13:32] .assigning 8 to cpu[808745
2022-12-11 21:13:32: .E808751[ : 2022-12-11 21:13:32/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE.[: 8087722022-12-11 21:13:32196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: .] :E808790assigning 8 to cpu212 : 
] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccEbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 
196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] [:[assigning 8 to cpu2022-12-11 21:13:322122022-12-11 21:13:32
.] .808879build symm link desc with 4X Tesla V100-SXM2-16GB out of 4808893: 
: EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[:212[2022-12-11 21:13:32213] 2022-12-11 21:13:32.] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4.808954remote time is 8.68421
808951: 
: E[[E 2022-12-11 21:13:322022-12-11 21:13:32 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc../hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:809017809012:213: : 212] EE] remote time is 8.68421  build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
::[2142132022-12-11 21:13:32] ] .cpu time is 30[remote time is 8.68421809109
2022-12-11 21:13:32
: .E809127[ : 2022-12-11 21:13:32/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE.: 809159214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: ] :Ecpu time is 30213 
] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421:
214] cpu time is 30
[2022-12-11 21:13:32.809261: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 21:13:58.373815: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 21:13:58.431742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 21:13:58.582785: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 21:13:58.582864: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 21:13:58.582915: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 21:13:58.582961: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 21:13:58.583803: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:13:58.583875: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:13:58.585056: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:13:58.585879: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:13:58.607064: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 21:13:58.607134: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 21:13:58.607376: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:13:58.607426: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:13:58.608170: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:13:58.608733: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-11 21:13:58.2022-12-11 21:13:58612710.: 612708E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc202:] 2022 solved] 
1 solved
[[2022-12-11 21:13:582022-12-11 21:13:58..612834612835: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc::205205] ] worker 0 thread 1 initing device 1worker 0 thread 2 initing device 2

[2022-12-11 21:13:58.613180: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:13:58.613239: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:13:58.613438: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:13:58.613497: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:13:58.614636: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:13:58.614675: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:13:58.618275: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:13:58.618408: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:13:58.665174: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 21:13:58.667040: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 21:13:58.667099: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:13:58.667878: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:13:58.668288: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:13:58.669191: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:13:58.669233: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.26 MB
[2022-12-11 21:13:58.677987: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:13:58.678678: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:13:58.678723: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[2022-12-11 21:13:58.693023: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 21:13:58.694753: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 21:13:58.694798: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:13:58.695506: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:13:58.695926: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:13:58.696833: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:13:58.696873: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.26 MB
[2022-12-11 21:13:58.705193: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:13:58.705848: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:13:58.705890: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[2022-12-11 21:13:582022-12-11 21:13:58..726307726306: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes

[2022-12-11 21:13:58.728117: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 21:13:58.728143: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 21:13:58eager release cuda mem 5.
728165: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:13:58.728197: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:13:58.738653: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:13:58.739760: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:13:58.740439: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:13:58.740657: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:13:58.741414: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:13:58.741484: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.26 MB
[2022-12-11 21:13:58.741635: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:13:58.741708: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.26 MB
[2022-12-11 21:13:58.751519: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:13:58.752105: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:13:58.752147: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[2022-12-11 21:13:58.752982: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:13:58.753556: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:13:58.753598: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[[[2022-12-11 21:13:582022-12-11 21:13:582022-12-11 21:13:582022-12-11 21:13:58....924262924257924262924262: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 2 init p2p of link 3Device 1 init p2p of link 2Device 0 init p2p of link 1Device 3 init p2p of link 0



[2022-12-11 21:13:58.[924544[2022-12-11 21:13:58: 2022-12-11 21:13:58.E.[924553 9245532022-12-11 21:13:58: /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: .E:E924576 1980 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE:eager alloc mem 611.00 KB: 1980
1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] ] :eager alloc mem 611.00 KBeager alloc mem 611.00 KB1980

] eager alloc mem 611.00 KB
[2022-12-11 21:13:58.925429: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-11 21:13:58
[.2022-12-11 21:13:58925451.: 925462E: [ E2022-12-11 21:13:58/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc .:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc925491638:: ] 638Eeager release cuda mem 625663]  
eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-11 21:13:58.928979: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 21:13:58.929069: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:13:58.929165: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 21:13:58.929227: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19262022-12-11 21:13:58] [.Device 3 init p2p of link 12022-12-11 21:13:58929258
.: 929261E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1926eager alloc mem 611.00 KB] 
[Device 0 init p2p of link 22022-12-11 21:13:58
.929350: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:13:58.929414: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:13:58.929839: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:13:58.930110: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:13:58.930145: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663[
2022-12-11 21:13:58.930171: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:13:58.933070: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 21:13:58.933152: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-11 21:13:582022-12-11 21:13:58..933810933811: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[:19262022-12-11 21:13:581926] .] Device 0 init p2p of link 3933872Device 1 init p2p of link 0
: [
E2022-12-11 21:13:58 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu933928:: 1926E]  [Device 3 init p2p of link 2/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 21:13:58
[:.2022-12-11 21:13:58638933975.] : 933987eager release cuda mem 625663E: 
 E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[ :2022-12-11 21:13:58/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980.:] 9340471980eager alloc mem 611.00 KB: ] 
Eeager alloc mem 611.00 KB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:13:58.934835: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:13:58.934882: E[ 2022-12-11 21:13:58/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:934894638: ] Eeager release cuda mem 625663 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:13:58.936440: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:13:58.936698: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 3999999 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11999997 / 100000000 nodes ( 12.00 %) | cpu 84000004 / 100000000 nodes ( 84.00 %) | 1.91 GB | 0.323222 secs 
[2022-12-11 21:13:58.937959: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:13:58.938125: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:13:58.938199: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:13:58.938559: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 3999999 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11999997 / 100000000 nodes ( 12.00 %) | cpu 84000004 / 100000000 nodes ( 84.00 %) | 1.91 GB | 0.354702 secs 
[2022-12-11 21:13:58.938812: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 3999999 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11999997 / 100000000 nodes ( 12.00 %) | cpu 84000004 / 100000000 nodes ( 84.00 %) | 1.91 GB | 0.325597 secs 
[2022-12-11 21:13:58.939225: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 3999999 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11999997 / 100000000 nodes ( 12.00 %) | cpu 84000004 / 100000000 nodes ( 84.00 %) | 1.91 GB | 0.331815 secs 
[2022-12-11 21:13:58.939471: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.61 GB
[2022-12-11 21:13:59.923745: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.86 GB
[2022-12-11 21:13:59.924274: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.86 GB
[2022-12-11 21:13:59.957964: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.86 GB
[2022-12-11 21:14:00.918835: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.10 GB
[2022-12-11 21:14:00.919035: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.10 GB
[2022-12-11 21:14:00.922602: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.10 GB
[2022-12-11 21:14:01.614500: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.35 GB
[2022-12-11 21:14:01.614860: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.35 GB
[2022-12-11 21:14:01.615690: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.35 GB
[2022-12-11 21:14:02.338612: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.76 GB
[2022-12-11 21:14:02.338744: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.76 GB
[2022-12-11 21:14:02.339088: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.76 GB
[2022-12-11 21:14:03.369485: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.95 GB
[2022-12-11 21:14:03.369654: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.95 GB
[HCTR][21:14:03.426][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][21:14:03.426][ERROR][RK0][tid #139707434399488]: replica 1 calling init per replica done, doing barrier
[HCTR][21:14:03.426][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][21:14:03.426][ERROR][RK0][tid #139707920914176]: replica 3 calling init per replica done, doing barrier
[HCTR][21:14:03.426][ERROR][RK0][tid #139707920914176]: replica 3 calling init per replica done, doing barrier done
[HCTR][21:14:03.426][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][21:14:03.426][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][21:14:03.426][ERROR][RK0][tid #139707434399488]: replica 1 calling init per replica done, doing barrier done
[HCTR][21:14:03.426][ERROR][RK0][tid #139707920914176]: init per replica done
[HCTR][21:14:03.426][ERROR][RK0][main]: init per replica done
[HCTR][21:14:03.426][ERROR][RK0][tid #139707434399488]: init per replica done
[HCTR][21:14:03.429][ERROR][RK0][main]: init per replica done
[HCTR][21:14:03.461][ERROR][RK0][tid #139707434399488]: 2 allocated 3276800 at 0x7ef624238400
[HCTR][21:14:03.461][ERROR][RK0][tid #139707434399488]: 2 allocated 6553600 at 0x7ef624558400
[HCTR][21:14:03.461][ERROR][RK0][tid #139707434399488]: 2 allocated 3276800 at 0x7ef624b98400
[HCTR][21:14:03.461][ERROR][RK0][tid #139707434399488]: 2 allocated 6553600 at 0x7ef624eb8400
[HCTR][21:14:03.463][ERROR][RK0][main]: 3 allocated 3276800 at 0x7ef61c238400
[HCTR][21:14:03.463][ERROR][RK0][main]: 3 allocated 6553600 at 0x7ef61c558400
[HCTR][21:14:03.463][ERROR][RK0][main]: 3 allocated 3276800 at 0x7ef61cb98400
[HCTR][21:14:03.463][ERROR][RK0][main]: 3 allocated 6553600 at 0x7ef61ceb8400
[HCTR][21:14:03.465][ERROR][RK0][tid #139707434399488]: 1 allocated 3276800 at 0x7ef6e0238400
[HCTR][21:14:03.465][ERROR][RK0][tid #139707434399488]: 1 allocated 6553600 at 0x7ef6e0558400
[HCTR][21:14:03.465][ERROR][RK0][tid #139707434399488]: 1 allocated 3276800 at 0x7ef6e0b98400
[HCTR][21:14:03.465][ERROR][RK0][tid #139707434399488]: 1 allocated 6553600 at 0x7ef6e0eb8400
[HCTR][21:14:03.467][ERROR][RK0][main]: 0 allocated 3276800 at 0x7ef6b4320000
[HCTR][21:14:03.467][ERROR][RK0][main]: 0 allocated 6553600 at 0x7ef6b4640000
[HCTR][21:14:03.467][ERROR][RK0][main]: 0 allocated 3276800 at 0x7ef6b4c80000
[HCTR][21:14:03.467][ERROR][RK0][main]: 0 allocated 6553600 at 0x7ef6b4fa0000
