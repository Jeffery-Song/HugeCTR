2022-12-12 02:56:26.628234: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:56:26.681707: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:56:26.696966: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:56:26.697235: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:56:27.506636: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:56:27.506724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:56:27.523754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:56:27.546719: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:56:27.546808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:56:27.557569: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:56:27.557842: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:56:27.560167: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 02:56:27.564438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:56:27.564940: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:56:27.564997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:56:27.567185: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:56:27.567279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:56:27.578407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:56:27.581907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:56:27.599952: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:56:27.600193: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:56:27.602605: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 02:56:27.611877: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:56:27.612038: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:56:27.613407: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 02:56:27.613439: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:56:27.613601: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:56:27.615325: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][02:56:29.767][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:56:29.781][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:56:29.810][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:56:29.822][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.57s/it]warmup run: 105it [00:01, 87.29it/s]warmup run: 212it [00:01, 191.80it/s]warmup run: 319it [00:01, 307.30it/s]warmup run: 423it [00:01, 423.31it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 522it [00:02, 527.23it/s]warmup run: 99it [00:01, 90.24it/s]warmup run: 625it [00:02, 630.35it/s]warmup run: 200it [00:01, 196.42it/s]warmup run: 729it [00:02, 723.68it/s]warmup run: 298it [00:01, 307.37it/s]warmup run: 835it [00:02, 804.68it/s]warmup run: 410it [00:01, 443.56it/s]warmup run: 941it [00:02, 869.91it/s]warmup run: 516it [00:01, 562.44it/s]warmup run: 1044it [00:02, 905.72it/s]warmup run: 624it [00:02, 674.06it/s]warmup run: 1153it [00:02, 954.42it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 1it [00:01,  1.43s/it]warmup run: 727it [00:02, 757.42it/s]warmup run: 1258it [00:02, 979.88it/s]warmup run: 109it [00:01, 98.67it/s]warmup run: 107it [00:01, 97.10it/s]warmup run: 829it [00:02, 819.19it/s]warmup run: 1365it [00:02, 1005.43it/s]warmup run: 219it [00:01, 213.50it/s]warmup run: 214it [00:01, 208.88it/s]warmup run: 931it [00:02, 869.55it/s]warmup run: 1472it [00:02, 1023.53it/s]warmup run: 329it [00:01, 338.21it/s]warmup run: 321it [00:01, 330.02it/s]warmup run: 1033it [00:02, 903.84it/s]warmup run: 1579it [00:03, 1035.91it/s]warmup run: 427it [00:01, 444.50it/s]warmup run: 427it [00:01, 452.17it/s]warmup run: 1134it [00:02, 922.60it/s]warmup run: 1690it [00:03, 1056.73it/s]warmup run: 534it [00:01, 570.77it/s]warmup run: 523it [00:01, 538.70it/s]warmup run: 1238it [00:02, 951.69it/s]warmup run: 1803it [00:03, 1076.17it/s]warmup run: 642it [00:02, 679.72it/s]warmup run: 624it [00:02, 638.64it/s]warmup run: 1339it [00:02, 954.97it/s]warmup run: 1917it [00:03, 1092.51it/s]warmup run: 750it [00:02, 772.50it/s]warmup run: 723it [00:02, 719.26it/s]warmup run: 1441it [00:02, 972.48it/s]warmup run: 2035it [00:03, 1116.65it/s]warmup run: 858it [00:02, 849.46it/s]warmup run: 824it [00:02, 791.53it/s]warmup run: 1543it [00:02, 985.24it/s]warmup run: 2169it [00:03, 1180.58it/s]warmup run: 966it [00:02, 909.09it/s]warmup run: 922it [00:02, 840.95it/s]warmup run: 1650it [00:03, 1008.21it/s]warmup run: 2297it [00:03, 1208.81it/s]warmup run: 1075it [00:02, 956.93it/s]warmup run: 1023it [00:02, 885.91it/s]warmup run: 1762it [00:03, 1039.32it/s]warmup run: 1183it [00:02, 991.01it/s]warmup run: 2419it [00:03, 1173.42it/s]warmup run: 1125it [00:02, 921.07it/s]warmup run: 1871it [00:03, 1052.91it/s]warmup run: 1291it [00:02, 1015.64it/s]warmup run: 2551it [00:03, 1215.86it/s]warmup run: 1226it [00:02, 944.90it/s]warmup run: 1983it [00:03, 1072.48it/s]warmup run: 1399it [00:02, 1033.90it/s]warmup run: 2682it [00:03, 1241.91it/s]warmup run: 1326it [00:02, 949.71it/s]warmup run: 2114it [00:03, 1140.79it/s]warmup run: 2813it [00:04, 1260.94it/s]warmup run: 1507it [00:02, 1025.15it/s]warmup run: 1426it [00:02, 961.65it/s]warmup run: 2245it [00:03, 1189.43it/s]warmup run: 2947it [00:04, 1281.98it/s]warmup run: 1617it [00:02, 1045.30it/s]warmup run: 1526it [00:02, 971.21it/s]warmup run: 2380it [00:03, 1236.63it/s]warmup run: 3000it [00:04, 706.81it/s] warmup run: 1724it [00:03, 1049.78it/s]warmup run: 1626it [00:03, 978.13it/s]warmup run: 2514it [00:03, 1266.04it/s]warmup run: 1832it [00:03, 1058.60it/s]warmup run: 1727it [00:03, 987.39it/s]warmup run: 2647it [00:03, 1282.61it/s]warmup run: 1939it [00:03, 1058.94it/s]warmup run: 1827it [00:03, 987.93it/s]warmup run: 2778it [00:03, 1289.81it/s]warmup run: 2057it [00:03, 1094.61it/s]warmup run: 1927it [00:03, 991.12it/s]warmup run: 2910it [00:04, 1298.49it/s]warmup run: 3000it [00:04, 728.28it/s] warmup run: 2191it [00:03, 1166.30it/s]warmup run: 2033it [00:03, 1010.09it/s]warmup run: 2325it [00:03, 1216.84it/s]warmup run: 2167it [00:03, 1108.00it/s]warmup run: 2461it [00:03, 1256.80it/s]warmup run: 2298it [00:03, 1166.33it/s]warmup run: 2597it [00:03, 1284.95it/s]warmup run: 2432it [00:03, 1216.38it/s]warmup run: 2733it [00:03, 1304.97it/s]warmup run: 2566it [00:03, 1251.09it/s]warmup run: 2867it [00:03, 1314.27it/s]warmup run: 2700it [00:03, 1276.04it/s]warmup run: 2833it [00:04, 1289.34it/s]warmup run: 3000it [00:04, 740.68it/s] warmup run: 2962it [00:04, 1264.16it/s]warmup run: 3000it [00:04, 714.95it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1659.40it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1753.91it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1694.14it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1686.76it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1717.23it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1772.50it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1761.38it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1720.68it/s]warmup should be done:  17%|█▋        | 515/3000 [00:00<00:01, 1722.59it/s]warmup should be done:  18%|█▊        | 530/3000 [00:00<00:01, 1770.94it/s]warmup should be done:  17%|█▋        | 518/3000 [00:00<00:01, 1725.55it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1758.12it/s]warmup should be done:  23%|██▎       | 691/3000 [00:00<00:01, 1735.79it/s]warmup should be done:  24%|██▎       | 711/3000 [00:00<00:01, 1782.45it/s]warmup should be done:  23%|██▎       | 694/3000 [00:00<00:01, 1738.67it/s]warmup should be done:  24%|██▎       | 712/3000 [00:00<00:01, 1767.53it/s]warmup should be done:  29%|██▉       | 865/3000 [00:00<00:01, 1734.02it/s]warmup should be done:  29%|██▉       | 871/3000 [00:00<00:01, 1747.94it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1781.33it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1769.55it/s]warmup should be done:  35%|███▍      | 1040/3000 [00:00<00:01, 1738.81it/s]warmup should be done:  36%|███▌      | 1069/3000 [00:00<00:01, 1780.23it/s]warmup should be done:  36%|███▌      | 1068/3000 [00:00<00:01, 1772.23it/s]warmup should be done:  35%|███▍      | 1046/3000 [00:00<00:01, 1728.65it/s]warmup should be done:  40%|████      | 1214/3000 [00:00<00:01, 1733.48it/s]warmup should be done:  42%|████▏     | 1248/3000 [00:00<00:00, 1781.73it/s]warmup should be done:  42%|████▏     | 1246/3000 [00:00<00:00, 1772.30it/s]warmup should be done:  41%|████      | 1220/3000 [00:00<00:01, 1731.01it/s]warmup should be done:  46%|████▋     | 1388/3000 [00:00<00:00, 1733.60it/s]warmup should be done:  48%|████▊     | 1427/3000 [00:00<00:00, 1781.49it/s]warmup should be done:  47%|████▋     | 1424/3000 [00:00<00:00, 1774.41it/s]warmup should be done:  46%|████▋     | 1394/3000 [00:00<00:00, 1724.94it/s]warmup should be done:  52%|█████▏    | 1562/3000 [00:00<00:00, 1735.33it/s]warmup should be done:  54%|█████▎    | 1606/3000 [00:00<00:00, 1781.92it/s]warmup should be done:  53%|█████▎    | 1602/3000 [00:00<00:00, 1773.69it/s]warmup should be done:  52%|█████▏    | 1567/3000 [00:00<00:00, 1701.53it/s]warmup should be done:  58%|█████▊    | 1737/3000 [00:01<00:00, 1738.33it/s]warmup should be done:  60%|█████▉    | 1785/3000 [00:01<00:00, 1784.04it/s]warmup should be done:  59%|█████▉    | 1780/3000 [00:01<00:00, 1775.52it/s]warmup should be done:  58%|█████▊    | 1744/3000 [00:01<00:00, 1722.04it/s]warmup should be done:  64%|██████▎   | 1912/3000 [00:01<00:00, 1739.35it/s]warmup should be done:  65%|██████▌   | 1964/3000 [00:01<00:00, 1784.78it/s]warmup should be done:  65%|██████▌   | 1958/3000 [00:01<00:00, 1773.95it/s]warmup should be done:  64%|██████▍   | 1921/3000 [00:01<00:00, 1734.90it/s]warmup should be done:  70%|██████▉   | 2087/3000 [00:01<00:00, 1741.83it/s]warmup should be done:  71%|███████▏  | 2143/3000 [00:01<00:00, 1782.72it/s]warmup should be done:  71%|███████   | 2136/3000 [00:01<00:00, 1774.18it/s]warmup should be done:  70%|██████▉   | 2095/3000 [00:01<00:00, 1704.93it/s]warmup should be done:  77%|███████▋  | 2323/3000 [00:01<00:00, 1785.12it/s]warmup should be done:  75%|███████▌  | 2262/3000 [00:01<00:00, 1715.81it/s]warmup should be done:  77%|███████▋  | 2314/3000 [00:01<00:00, 1742.60it/s]warmup should be done:  76%|███████▌  | 2271/3000 [00:01<00:00, 1719.24it/s]warmup should be done:  83%|████████▎ | 2502/3000 [00:01<00:00, 1781.39it/s]warmup should be done:  81%|████████▏ | 2441/3000 [00:01<00:00, 1735.80it/s]warmup should be done:  83%|████████▎ | 2495/3000 [00:01<00:00, 1762.39it/s]warmup should be done:  82%|████████▏ | 2450/3000 [00:01<00:00, 1738.11it/s]warmup should be done:  89%|████████▉ | 2682/3000 [00:01<00:00, 1785.91it/s]warmup should be done:  87%|████████▋ | 2620/3000 [00:01<00:00, 1750.35it/s]warmup should be done:  89%|████████▉ | 2675/3000 [00:01<00:00, 1770.67it/s]warmup should be done:  88%|████████▊ | 2627/3000 [00:01<00:00, 1745.64it/s]warmup should be done:  95%|█████████▌| 2861/3000 [00:01<00:00, 1784.53it/s]warmup should be done:  93%|█████████▎| 2799/3000 [00:01<00:00, 1761.36it/s]warmup should be done:  95%|█████████▌| 2853/3000 [00:01<00:00, 1767.38it/s]warmup should be done:  94%|█████████▎| 2806/3000 [00:01<00:00, 1757.59it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1780.71it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1769.69it/s]warmup should be done:  99%|█████████▉| 2978/3000 [00:01<00:00, 1769.32it/s]warmup should be done: 100%|█████████▉| 2986/3000 [00:01<00:00, 1768.39it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1741.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1736.27it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1838.45it/s]warmup should be done:   6%|▌         | 183/3000 [00:00<00:01, 1825.00it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1751.14it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1710.35it/s]warmup should be done:  12%|█▏        | 369/3000 [00:00<00:01, 1844.75it/s]warmup should be done:  12%|█▏        | 367/3000 [00:00<00:01, 1830.30it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1790.81it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1809.83it/s]warmup should be done:  18%|█▊        | 554/3000 [00:00<00:01, 1843.84it/s]warmup should be done:  18%|█▊        | 551/3000 [00:00<00:01, 1833.01it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1821.07it/s]warmup should be done:  18%|█▊        | 545/3000 [00:00<00:01, 1818.42it/s]warmup should be done:  24%|██▍       | 729/3000 [00:00<00:01, 1836.09it/s]warmup should be done:  25%|██▍       | 736/3000 [00:00<00:01, 1836.19it/s]warmup should be done:  25%|██▍       | 739/3000 [00:00<00:01, 1840.08it/s]warmup should be done:  24%|██▍       | 730/3000 [00:00<00:01, 1828.76it/s]warmup should be done:  30%|███       | 915/3000 [00:00<00:01, 1843.59it/s]warmup should be done:  31%|███       | 921/3000 [00:00<00:01, 1838.80it/s]warmup should be done:  30%|███       | 915/3000 [00:00<00:01, 1835.72it/s]warmup should be done:  31%|███       | 924/3000 [00:00<00:01, 1837.87it/s]warmup should be done:  37%|███▋      | 1100/3000 [00:00<00:01, 1838.54it/s]warmup should be done:  37%|███▋      | 1100/3000 [00:00<00:01, 1841.28it/s]warmup should be done:  37%|███▋      | 1106/3000 [00:00<00:01, 1839.52it/s]warmup should be done:  37%|███▋      | 1109/3000 [00:00<00:01, 1841.67it/s]warmup should be done:  43%|████▎     | 1284/3000 [00:00<00:00, 1838.11it/s]warmup should be done:  43%|████▎     | 1290/3000 [00:00<00:00, 1835.79it/s]warmup should be done:  43%|████▎     | 1285/3000 [00:00<00:00, 1834.02it/s]warmup should be done:  43%|████▎     | 1294/3000 [00:00<00:00, 1814.56it/s]warmup should be done:  49%|████▉     | 1468/3000 [00:00<00:00, 1838.62it/s]warmup should be done:  49%|████▉     | 1475/3000 [00:00<00:00, 1840.02it/s]warmup should be done:  49%|████▉     | 1469/3000 [00:00<00:00, 1833.89it/s]warmup should be done:  49%|████▉     | 1476/3000 [00:00<00:00, 1815.42it/s]warmup should be done:  55%|█████▌    | 1654/3000 [00:00<00:00, 1842.44it/s]warmup should be done:  55%|█████▌    | 1660/3000 [00:00<00:00, 1837.56it/s]warmup should be done:  55%|█████▌    | 1655/3000 [00:00<00:00, 1840.18it/s]warmup should be done:  55%|█████▌    | 1660/3000 [00:00<00:00, 1821.65it/s]warmup should be done:  61%|██████▏   | 1844/3000 [00:01<00:00, 1835.86it/s]warmup should be done:  61%|██████▏   | 1839/3000 [00:01<00:00, 1834.99it/s]warmup should be done:  61%|██████▏   | 1840/3000 [00:01<00:00, 1816.81it/s]warmup should be done:  61%|██████▏   | 1843/3000 [00:01<00:00, 1812.66it/s]warmup should be done:  67%|██████▋   | 2024/3000 [00:01<00:00, 1839.41it/s]warmup should be done:  68%|██████▊   | 2028/3000 [00:01<00:00, 1830.57it/s]warmup should be done:  68%|██████▊   | 2025/3000 [00:01<00:00, 1812.30it/s]warmup should be done:  67%|██████▋   | 2022/3000 [00:01<00:00, 1647.15it/s]warmup should be done:  74%|███████▎  | 2208/3000 [00:01<00:00, 1836.11it/s]warmup should be done:  74%|███████▍  | 2213/3000 [00:01<00:00, 1833.61it/s]warmup should be done:  74%|███████▎  | 2207/3000 [00:01<00:00, 1809.37it/s]warmup should be done:  73%|███████▎  | 2203/3000 [00:01<00:00, 1692.83it/s]warmup should be done:  80%|███████▉  | 2393/3000 [00:01<00:00, 1839.54it/s]warmup should be done:  80%|███████▉  | 2397/3000 [00:01<00:00, 1834.15it/s]warmup should be done:  80%|███████▉  | 2389/3000 [00:01<00:00, 1809.72it/s]warmup should be done:  79%|███████▉  | 2379/3000 [00:01<00:00, 1709.71it/s]warmup should be done:  86%|████████▌ | 2578/3000 [00:01<00:00, 1840.06it/s]warmup should be done:  86%|████████▌ | 2582/3000 [00:01<00:00, 1837.30it/s]warmup should be done:  86%|████████▌ | 2572/3000 [00:01<00:00, 1812.71it/s]warmup should be done:  85%|████████▌ | 2562/3000 [00:01<00:00, 1743.27it/s]warmup should be done:  92%|█████████▏| 2764/3000 [00:01<00:00, 1844.40it/s]warmup should be done:  92%|█████████▏| 2767/3000 [00:01<00:00, 1839.67it/s]warmup should be done:  92%|█████████▏| 2755/3000 [00:01<00:00, 1815.78it/s]warmup should be done:  92%|█████████▏| 2745/3000 [00:01<00:00, 1768.57it/s]warmup should be done:  98%|█████████▊| 2953/3000 [00:01<00:00, 1843.20it/s]warmup should be done:  98%|█████████▊| 2949/3000 [00:01<00:00, 1839.21it/s]warmup should be done:  98%|█████████▊| 2938/3000 [00:01<00:00, 1818.21it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1837.13it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1834.84it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1820.92it/s]warmup should be done:  97%|█████████▋| 2923/3000 [00:01<00:00, 1753.43it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1774.88it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fe646012250>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fe6460120a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fe646011190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fe646012160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-12 02:57:39.835838: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe215a68a20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:57:39.835915: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:57:39.843167: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe221a670b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:57:39.843245: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:57:39.847221: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:57:39.851309: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe221a6a860 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:57:39.851344: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:57:39.852176: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:57:39.852437: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe221a64310 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:57:39.852490: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:57:39.859610: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:57:39.860622: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:57:40.503799: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:57:40.514758: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:57:40.530995: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:57:40.617853: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:57:45.556700: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:57:46.065959: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:57:46.677693: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:57:46.811324: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][02:58:39.021][ERROR][RK0][tid #140609478178560]: replica 3 reaches 1000, calling init pre replica
[HCTR][02:58:39.022][ERROR][RK0][tid #140609478178560]: coll ps creation, with 4 devices, using policy rep_cache
[HCTR][02:58:39.026][ERROR][RK0][tid #140609478178560]: coll ps creation done
[HCTR][02:58:39.026][ERROR][RK0][tid #140609478178560]: replica 3 waits for coll ps creation barrier
[HCTR][02:58:39.184][ERROR][RK0][tid #140609486571264]: replica 1 reaches 1000, calling init pre replica
[HCTR][02:58:39.184][ERROR][RK0][tid #140609486571264]: coll ps creation, with 4 devices, using policy rep_cache
[HCTR][02:58:39.189][ERROR][RK0][tid #140609486571264]: coll ps creation done
[HCTR][02:58:39.189][ERROR][RK0][tid #140609486571264]: replica 1 waits for coll ps creation barrier
[HCTR][02:58:39.321][ERROR][RK0][tid #140609478178560]: replica 2 reaches 1000, calling init pre replica
[HCTR][02:58:39.321][ERROR][RK0][tid #140609478178560]: coll ps creation, with 4 devices, using policy rep_cache
[HCTR][02:58:39.326][ERROR][RK0][tid #140609478178560]: coll ps creation done
[HCTR][02:58:39.326][ERROR][RK0][tid #140609478178560]: replica 2 waits for coll ps creation barrier
[HCTR][02:58:39.342][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][02:58:39.342][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy rep_cache
[HCTR][02:58:39.345][ERROR][RK0][main]: coll ps creation done
[HCTR][02:58:39.345][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][02:58:39.345][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][02:58:40.556][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][02:58:40.593][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][02:58:40.593][ERROR][RK0][tid #140609486571264]: replica 1 calling init per replica
[HCTR][02:58:40.593][ERROR][RK0][tid #140609478178560]: replica 3 calling init per replica
[HCTR][02:58:40.593][ERROR][RK0][main]: Calling build_v2
[HCTR][02:58:40.593][ERROR][RK0][tid #140609478178560]: replica 2 calling init per replica
[HCTR][02:58:40.593][ERROR][RK0][tid #140609486571264]: Calling build_v2
[HCTR][02:58:40.593][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:58:40.593][ERROR][RK0][tid #140609478178560]: Calling build_v2
[HCTR][02:58:40.593][ERROR][RK0][tid #140609486571264]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:58:40.593][ERROR][RK0][tid #140609478178560]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:58:40.593][ERROR][RK0][tid #140609478178560]: Calling build_v2
[HCTR][02:58:40.593][ERROR][RK0][tid #140609478178560]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-12 02:58:40.2022-12-12 02:58:40593745.2022-12-12 02:58:40: 593744.E: 593744 E: [/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc E:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc 2022-12-12 02:58:40136:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc.] 136:593794using concurrent impl MPS] 136: 
using concurrent impl MPS] E
using concurrent impl MPS 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-12 02:58:40.594949: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] [assigning 8 to cpu2022-12-12 02:58:40
.594971: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196[] 2022-12-12 02:58:40assigning 8 to cpu[.
2022-12-12 02:58:40594996.: 595001E:  [E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[2022-12-12 02:58:40 :2022-12-12 02:58:40./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc196.595023:] 595029: 212assigning 8 to cpu: E] 
E build symm link desc with 4X Tesla V100-SXM2-16GB out of 4 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::196212] ] [assigning 8 to cpubuild symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-12 02:58:40

.[5951232022-12-12 02:58:40: .[E5951362022-12-12 02:58:40 : ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE595150: : 213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE] : remote time is 8.68421212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
] :[build symm link desc with 4X Tesla V100-SXM2-16GB out of 4213[2022-12-12 02:58:40
] 2022-12-12 02:58:40.remote time is 8.68421.595178
595203[: : 2022-12-12 02:58:40[EE.2022-12-12 02:58:40  595224./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 595234::E: 212214]  E] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc cpu time is 30
:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
213:] 214remote time is 8.68421[] 
2022-12-12 02:58:40cpu time is 30.
[5953112022-12-12 02:58:40: .E595330 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: 213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :remote time is 8.68421214
] cpu time is 30
[2022-12-12 02:58:40.595387: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 02:59:06.599009: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 02:59:06.663599: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 02:59:06.663679: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:919] num_cached_nodes = 18000000
[2022-12-12 02:59:06.818141: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 02:59:06.818235: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 02:59:06.818271: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 02:59:06.818302: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 02:59:06.819837: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:59:06.820865: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:59:06.821424: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-12 02:59:062022-12-12 02:59:06..839816839820: [: EE2022-12-12 02:59:06  ./hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc839854::: 202202E] ]  1 solved3 solved/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc

:202] [2 solved[2022-12-12 02:59:06
2022-12-12 02:59:06..839938839940[: : 2022-12-12 02:59:06EE.  839956/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc: ::E205205 ] ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccworker 0 thread 1 initing device 1worker 0 thread 3 initing device 3:

205] worker 0 thread 2 initing device 2
[2022-12-12 02:59:06.840242: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:59:06.840586: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:59:06.841252: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:59:06.841452: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:59:06.841481: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:59:06.842986: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:59:06.843049: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-12 02:59:061980.] 843064eager alloc mem 381.47 MB: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:59:06.844501: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:59:06.884390: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.00 Bytes
[2022-12-12 02:59:06.885542: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 64.00 Bytes
[2022-12-12 02:59:06.887292: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64
[2022-12-12 02:59:06.887343: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 2
[2022-12-12 02:59:06.887385: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:59:06.888335: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:59:06.888875: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:06.889896: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:59:06.889980: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:59:06.890624: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:59:06.890666: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.58 GB
[[2022-12-12 02:59:062022-12-12 02:59:06..911006911006: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 2.00 Byteseager alloc mem 2.00 Bytes

[2022-12-12 02:59:06.911712: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 64.00 Bytes
[2022-12-12 02:59:06.912013: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 64.00 Bytes
[2022-12-12 02:59:06.913398: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64
[2022-12-12 02:59:06.913441: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 2
[2022-12-12 02:59:06.913476: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:59:06.913701: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64
[2022-12-12 02:59:06.913742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 2
[2022-12-12 02:59:06.913778: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:59:06.939085: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.00 Bytes
[2022-12-12 02:59:06.939342: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 64.00 Bytes
[2022-12-12 02:59:06.940094: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:59:06.940585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:59:06.941011: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64
[2022-12-12 02:59:06.941052: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 2
[2022-12-12 02:59:06.941088: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:59:06.941253: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:06.941447: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:06.941806: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:59:06.942163: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:06.942231: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:59:06.942303: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:59:06.942451: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:59:06.942538: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:59:06.942917: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:59:06.942956: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.58 GB
[2022-12-12 02:59:06.943126: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663[
2022-12-12 02:59:06.943150: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:59:06.943192: [E2022-12-12 02:59:06 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu943200:: 1980E]  eager alloc mem 8.58 GB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 25.25 KB
[2022-12-12 02:59:06.943830: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:59:06.943868: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.58 GB
[2022-12-12 02:59:07.765177: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:07.765437: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:07.765666: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:07.765980: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663[
2022-12-12 02:59:07.765986: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:07.766050: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:07.766219: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:59:07.766281: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:07.766454: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:59:07.766532: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:07.766767: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:59:07.[7668112022-12-12 02:59:07: .E766821 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager release cuda mem 6256631980
] eager alloc mem 611.00 KB
[2022-12-12 02:59:07.766913: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:07.766999: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:59:07.767058: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:07.767251: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:59:07.767306: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:07.767567: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:59:07.767603: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:59:07.767629: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:59:07.767687: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:59:07.767771: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:59:07.767808: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:59:07.768005[: 2022-12-12 02:59:07E. 768017/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1793 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:Collaborative GPU cache (policy: rep_cache) | local 18000000 / 100000000 nodes ( 18.00 %~18.00 %) | remote 0 / 100000000 nodes ( 0.00 %) | cpu 82000000 / 100000000 nodes ( 82.00 %) | 8.58 GB | 0.926762 secs 638
] eager release cuda mem 625663
[2022-12-12 02:59:07.768069: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:59:07.768301: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1793] Collaborative GPU cache (policy: rep_cache) | local 18000000 / 100000000 nodes ( 18.00 %~18.00 %) | remote 0 / 100000000 nodes ( 0.00 %) | cpu 82000000 / 100000000 nodes ( 82.00 %) | 8.58 GB | 0.927725 secs 
[2022-12-12 02:59:07.768402: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:59:07.768439: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:59:07.768643: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1793] Collaborative GPU cache (policy: rep_cache) | local 18000000 / 100000000 nodes ( 18.00 %~18.00 %) | remote 0 / 100000000 nodes ( 0.00 %) | cpu 82000000 / 100000000 nodes ( 82.00 %) | 8.58 GB | 0.928409 secs 
[2022-12-12 02:59:07.768961: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1793] Collaborative GPU cache (policy: rep_cache) | local 18000000 / 100000000 nodes ( 18.00 %~18.00 %) | remote 0 / 100000000 nodes ( 0.00 %) | cpu 82000000 / 100000000 nodes ( 82.00 %) | 8.58 GB | 0.949131 secs 
[2022-12-12 02:59:07.769808: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 15.28 GB
[2022-12-12 02:59:08.695033: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 15.53 GB
[2022-12-12 02:59:08.695168: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 15.53 GB
[2022-12-12 02:59:08.695666: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 15.53 GB
[2022-12-12 02:59:09.400866: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 0.00 Bytes
[2022-12-12 02:59:09.403921: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 15.77 GB
[2022-12-12 02:59:09.404884: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 15.77 GB
[c5fed35d0705:697047:0:703315] Caught signal 11 (Segmentation fault: address not mapped to object at address (nil))
2022-12-12 02:59:18.629800: E tensorflow/core/common_runtime/base_collective_executor.cc:249] BaseCollectiveExecutor::StartAbort UNAVAILABLE: Error reported from /job:worker/task:3: Task /job:worker/replica:0/task:3 heartbeat timeout. This indicates that the remote task has failed, got preempted, or crashed unexpectedly. [type.googleapis.com/tensorflow.CoordinationServiceError='\"\n\n\x06worker\x10\x03']
BFD: DWARF error: section .debug_info is larger than its filesize! (0x93ef57 vs 0x530ea0)
BFD: DWARF error: section .debug_info is larger than its filesize! (0x93ef57 vs 0x530ea0)
==== backtrace (tid: 703315) ====
 0 0x0000000000014420 __funlockfile()  :0
 1 0x0000000000252354 cuGetErrorString()  ???:0
 2 0x00000000000931ac coll_cache_lib::common::cuda::create_ctx_with_sm_count()  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/mps_util.h:45
 3 0x000000000005cadc coll_cache_lib::ExtractSession::ExtractSession(std::shared_ptr<coll_cache_lib::CacheContext>)::{lambda(int, int)#1}::operator()(int, int) const::{lambda(CUstream_st*)#2}::operator()()  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2062
 4 0x0000000000051308 std::function<void (CUstream_st*)>::operator()()  /usr/include/c++/9/bits/std_function.h:688
 5 0x0000000000051308 coll_cache_lib::ExtractionThreadCtx::thread_func()  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2280
 6 0x0000000001ae3fd0 execute_native_thread_routine()  /dt9-src/libstdc++-v3/src/nonshared11/../c++11/thread.cc:80
 7 0x0000000001ae3fd0 std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >::~unique_ptr()  /dt9-build/x86_64-pc-linux-gnu/libstdc++-v3/include/bits/unique_ptr.h:292
 8 0x0000000001ae3fd0 execute_native_thread_routine()  /dt9-src/libstdc++-v3/src/nonshared11/../c++11/thread.cc:79
 9 0x0000000000008609 start_thread()  /build/glibc-SzIz7B/glibc-2.31/nptl/pthread_create.c:477
10 0x000000000011f133 clone()  ???:0
=================================
