2022-12-11 23:02:41.887152: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:02:41.896183: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:02:41.972675: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:02:41.973034: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:02:42.764671: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:02:42.764747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:02:42.777521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:02:42.782552: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:02:42.782616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:02:42.794828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:02:42.805597: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:02:42.805672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:02:42.811804: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:02:42.811878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:02:42.812684: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:02:42.812808: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:02:42.814987: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 23:02:42.823408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:02:42.827257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:02:42.828387: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:02:42.828533: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:02:42.830290: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 23:02:42.856517: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:02:42.856671: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:02:42.858100: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 23:02:42.860321: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:02:42.860496: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:02:42.862449: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][23:02:44.055][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:02:44.071][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:02:44.113][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:02:44.130][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.53s/it]warmup run: 1it [00:01,  1.43s/it]warmup run: 109it [00:01, 92.55it/s]warmup run: 108it [00:01, 97.51it/s]warmup run: 219it [00:01, 201.65it/s]warmup run: 218it [00:01, 212.31it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 1it [00:01,  1.47s/it]warmup run: 329it [00:01, 321.68it/s]warmup run: 325it [00:01, 332.84it/s]warmup run: 105it [00:01, 93.92it/s]warmup run: 111it [00:01, 97.97it/s]warmup run: 440it [00:01, 447.93it/s]warmup run: 432it [00:01, 456.10it/s]warmup run: 210it [00:01, 202.34it/s]warmup run: 215it [00:01, 203.68it/s]warmup run: 550it [00:02, 569.24it/s]warmup run: 540it [00:01, 575.55it/s]warmup run: 314it [00:01, 319.07it/s]warmup run: 323it [00:01, 324.55it/s]warmup run: 663it [00:02, 686.10it/s]warmup run: 648it [00:02, 683.80it/s]warmup run: 419it [00:01, 439.93it/s]warmup run: 428it [00:01, 444.03it/s]warmup run: 771it [00:02, 775.45it/s]warmup run: 755it [00:02, 773.65it/s]warmup run: 518it [00:01, 544.91it/s]warmup run: 534it [00:01, 560.79it/s]warmup run: 878it [00:02, 835.01it/s]warmup run: 861it [00:02, 845.61it/s]warmup run: 627it [00:02, 660.99it/s]warmup run: 638it [00:02, 662.36it/s]warmup run: 983it [00:02, 880.28it/s]warmup run: 969it [00:02, 906.53it/s]warmup run: 736it [00:02, 760.56it/s]warmup run: 743it [00:02, 752.48it/s]warmup run: 1087it [00:02, 917.63it/s]warmup run: 1076it [00:02, 951.15it/s]warmup run: 846it [00:02, 845.12it/s]warmup run: 848it [00:02, 826.30it/s]warmup run: 1193it [00:02, 955.18it/s]warmup run: 1185it [00:02, 988.87it/s]warmup run: 956it [00:02, 911.10it/s]warmup run: 951it [00:02, 879.44it/s]warmup run: 1297it [00:02, 958.88it/s]warmup run: 1292it [00:02, 1009.36it/s]warmup run: 1066it [00:02, 962.40it/s]warmup run: 1055it [00:02, 922.53it/s]warmup run: 1399it [00:02, 961.65it/s]warmup run: 1400it [00:02, 1029.09it/s]warmup run: 1179it [00:02, 1006.93it/s]warmup run: 1159it [00:02, 952.68it/s]warmup run: 1503it [00:02, 982.55it/s]warmup run: 1507it [00:02, 1039.63it/s]warmup run: 1291it [00:02, 1037.82it/s]warmup run: 1263it [00:02, 921.52it/s]warmup run: 1608it [00:03, 1001.88it/s]warmup run: 1616it [00:02, 1052.84it/s]warmup run: 1404it [00:02, 1062.55it/s]warmup run: 1368it [00:02, 957.06it/s]warmup run: 1711it [00:03, 1002.33it/s]warmup run: 1724it [00:03, 1052.01it/s]warmup run: 1515it [00:02, 1072.89it/s]warmup run: 1474it [00:02, 985.30it/s]warmup run: 1817it [00:03, 1017.41it/s]warmup run: 1834it [00:03, 1064.28it/s]warmup run: 1626it [00:02, 1078.11it/s]warmup run: 1581it [00:02, 1007.17it/s]warmup run: 1924it [00:03, 1030.24it/s]warmup run: 1945it [00:03, 1076.69it/s]warmup run: 1736it [00:03, 1078.93it/s]warmup run: 1687it [00:03, 1020.30it/s]warmup run: 2036it [00:03, 1056.69it/s]warmup run: 2064it [00:03, 1109.32it/s]warmup run: 1846it [00:03, 1081.67it/s]warmup run: 1793it [00:03, 1029.98it/s]warmup run: 2167it [00:03, 1131.23it/s]warmup run: 2198it [00:03, 1176.00it/s]warmup run: 1956it [00:03, 1077.10it/s]warmup run: 1898it [00:03, 1035.71it/s]warmup run: 2298it [00:03, 1183.83it/s]warmup run: 2332it [00:03, 1223.34it/s]warmup run: 2080it [00:03, 1123.76it/s]warmup run: 2005it [00:03, 1044.96it/s]warmup run: 2429it [00:03, 1220.33it/s]warmup run: 2467it [00:03, 1260.23it/s]warmup run: 2215it [00:03, 1189.09it/s]warmup run: 2140it [00:03, 1133.87it/s]warmup run: 2560it [00:03, 1246.07it/s]warmup run: 2602it [00:03, 1284.52it/s]warmup run: 2351it [00:03, 1238.06it/s]warmup run: 2276it [00:03, 1198.61it/s]warmup run: 2691it [00:03, 1263.92it/s]warmup run: 2737it [00:03, 1301.94it/s]warmup run: 2487it [00:03, 1272.73it/s]warmup run: 2411it [00:03, 1243.65it/s]warmup run: 2821it [00:04, 1273.04it/s]warmup run: 2870it [00:03, 1308.17it/s]warmup run: 2620it [00:03, 1289.72it/s]warmup run: 2547it [00:03, 1275.77it/s]warmup run: 2952it [00:04, 1282.00it/s]warmup run: 3000it [00:04, 739.70it/s] warmup run: 3000it [00:04, 711.23it/s] warmup run: 2755it [00:03, 1305.37it/s]warmup run: 2680it [00:03, 1291.63it/s]warmup run: 2889it [00:03, 1314.90it/s]warmup run: 2813it [00:04, 1302.09it/s]warmup run: 3000it [00:04, 739.40it/s] warmup run: 2947it [00:04, 1312.85it/s]warmup run: 3000it [00:04, 722.99it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1755.15it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1678.25it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1717.44it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1725.63it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1782.16it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1752.07it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1761.05it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1748.53it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1760.85it/s]warmup should be done:  18%|█▊        | 536/3000 [00:00<00:01, 1780.43it/s]warmup should be done:  18%|█▊        | 526/3000 [00:00<00:01, 1749.27it/s]warmup should be done:  18%|█▊        | 529/3000 [00:00<00:01, 1755.55it/s]warmup should be done:  24%|██▎       | 707/3000 [00:00<00:01, 1773.89it/s]warmup should be done:  24%|██▍       | 716/3000 [00:00<00:01, 1785.57it/s]warmup should be done:  23%|██▎       | 703/3000 [00:00<00:01, 1755.70it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1759.30it/s]warmup should be done:  30%|██▉       | 886/3000 [00:00<00:01, 1778.84it/s]warmup should be done:  30%|██▉       | 895/3000 [00:00<00:01, 1783.14it/s]warmup should be done:  29%|██▉       | 879/3000 [00:00<00:01, 1754.00it/s]warmup should be done:  29%|██▉       | 882/3000 [00:00<00:01, 1752.68it/s]warmup should be done:  35%|███▌      | 1064/3000 [00:00<00:01, 1775.92it/s]warmup should be done:  35%|███▌      | 1055/3000 [00:00<00:01, 1753.67it/s]warmup should be done:  36%|███▌      | 1074/3000 [00:00<00:01, 1780.90it/s]warmup should be done:  35%|███▌      | 1058/3000 [00:00<00:01, 1750.42it/s]warmup should be done:  41%|████      | 1232/3000 [00:00<00:01, 1756.11it/s]warmup should be done:  41%|████▏     | 1242/3000 [00:00<00:00, 1769.52it/s]warmup should be done:  42%|████▏     | 1253/3000 [00:00<00:00, 1780.91it/s]warmup should be done:  41%|████      | 1234/3000 [00:00<00:01, 1748.07it/s]warmup should be done:  47%|████▋     | 1419/3000 [00:00<00:00, 1769.50it/s]warmup should be done:  48%|████▊     | 1432/3000 [00:00<00:00, 1781.60it/s]warmup should be done:  47%|████▋     | 1408/3000 [00:00<00:00, 1752.96it/s]warmup should be done:  47%|████▋     | 1410/3000 [00:00<00:00, 1749.70it/s]warmup should be done:  53%|█████▎    | 1596/3000 [00:00<00:00, 1768.07it/s]warmup should be done:  53%|█████▎    | 1584/3000 [00:00<00:00, 1748.43it/s]warmup should be done:  53%|█████▎    | 1585/3000 [00:00<00:00, 1740.02it/s]warmup should be done:  54%|█████▎    | 1611/3000 [00:00<00:00, 1757.62it/s]warmup should be done:  59%|█████▉    | 1774/3000 [00:01<00:00, 1769.80it/s]warmup should be done:  59%|█████▊    | 1760/3000 [00:01<00:00, 1742.78it/s]warmup should be done:  59%|█████▊    | 1759/3000 [00:01<00:00, 1733.28it/s]warmup should be done:  60%|█████▉    | 1791/3000 [00:01<00:00, 1770.46it/s]warmup should be done:  65%|██████▌   | 1952/3000 [00:01<00:00, 1772.40it/s]warmup should be done:  66%|██████▌   | 1972/3000 [00:01<00:00, 1779.60it/s]warmup should be done:  64%|██████▍   | 1933/3000 [00:01<00:00, 1724.67it/s]warmup should be done:  64%|██████▍   | 1935/3000 [00:01<00:00, 1726.27it/s]warmup should be done:  71%|███████   | 2131/3000 [00:01<00:00, 1774.97it/s]warmup should be done:  72%|███████▏  | 2152/3000 [00:01<00:00, 1785.67it/s]warmup should be done:  70%|███████   | 2106/3000 [00:01<00:00, 1719.39it/s]warmup should be done:  70%|███████   | 2108/3000 [00:01<00:00, 1723.36it/s]warmup should be done:  77%|███████▋  | 2310/3000 [00:01<00:00, 1778.77it/s]warmup should be done:  78%|███████▊  | 2333/3000 [00:01<00:00, 1790.27it/s]warmup should be done:  76%|███████▌  | 2282/3000 [00:01<00:00, 1728.34it/s]warmup should be done:  76%|███████▌  | 2278/3000 [00:01<00:00, 1718.21it/s]warmup should be done:  83%|████████▎ | 2490/3000 [00:01<00:00, 1782.87it/s]warmup should be done:  84%|████████▍ | 2513/3000 [00:01<00:00, 1792.99it/s]warmup should be done:  82%|████████▏ | 2458/3000 [00:01<00:00, 1737.24it/s]warmup should be done:  82%|████████▏ | 2453/3000 [00:01<00:00, 1724.91it/s]warmup should be done:  89%|████████▉ | 2670/3000 [00:01<00:00, 1785.67it/s]warmup should be done:  90%|████████▉ | 2694/3000 [00:01<00:00, 1797.01it/s]warmup should be done:  88%|████████▊ | 2626/3000 [00:01<00:00, 1722.12it/s]warmup should be done:  88%|████████▊ | 2632/3000 [00:01<00:00, 1685.67it/s]warmup should be done:  95%|█████████▍| 2849/3000 [00:01<00:00, 1782.86it/s]warmup should be done:  96%|█████████▌| 2874/3000 [00:01<00:00, 1797.79it/s]warmup should be done:  93%|█████████▎| 2800/3000 [00:01<00:00, 1724.70it/s]warmup should be done:  94%|█████████▎| 2805/3000 [00:01<00:00, 1698.47it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1785.13it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1774.39it/s]warmup should be done:  99%|█████████▉| 2975/3000 [00:01<00:00, 1731.06it/s]warmup should be done:  99%|█████████▉| 2976/3000 [00:01<00:00, 1690.92it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1735.64it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1725.73it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1718.18it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1708.93it/s]warmup should be done:   5%|▌         | 153/3000 [00:00<00:01, 1525.70it/s]warmup should be done:   5%|▌         | 153/3000 [00:00<00:01, 1521.75it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1758.17it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1738.19it/s]warmup should be done:  11%|█         | 327/3000 [00:00<00:01, 1651.14it/s]warmup should be done:  11%|█         | 335/3000 [00:00<00:01, 1696.18it/s]warmup should be done:  18%|█▊        | 525/3000 [00:00<00:01, 1751.68it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1775.32it/s]warmup should be done:  17%|█▋        | 518/3000 [00:00<00:01, 1756.41it/s]warmup should be done:  17%|█▋        | 498/3000 [00:00<00:01, 1674.42it/s]warmup should be done:  24%|██▎       | 705/3000 [00:00<00:01, 1768.94it/s]warmup should be done:  23%|██▎       | 697/3000 [00:00<00:01, 1768.15it/s]warmup should be done:  22%|██▏       | 671/3000 [00:00<00:01, 1694.59it/s]warmup should be done:  24%|██▎       | 709/3000 [00:00<00:01, 1771.49it/s]warmup should be done:  30%|██▉       | 886/3000 [00:00<00:01, 1782.49it/s]warmup should be done:  28%|██▊       | 854/3000 [00:00<00:01, 1742.65it/s]warmup should be done:  30%|██▉       | 892/3000 [00:00<00:01, 1789.23it/s]warmup should be done:  29%|██▉       | 874/3000 [00:00<00:01, 1752.22it/s]warmup should be done:  36%|███▌      | 1068/3000 [00:00<00:01, 1792.06it/s]warmup should be done:  35%|███▍      | 1038/3000 [00:00<00:01, 1774.28it/s]warmup should be done:  36%|███▌      | 1073/3000 [00:00<00:01, 1793.32it/s]warmup should be done:  35%|███▌      | 1051/3000 [00:00<00:01, 1756.98it/s]warmup should be done:  42%|████▏     | 1249/3000 [00:00<00:00, 1794.89it/s]warmup should be done:  41%|████      | 1221/3000 [00:00<00:00, 1789.49it/s]warmup should be done:  42%|████▏     | 1254/3000 [00:00<00:00, 1797.92it/s]warmup should be done:  41%|████      | 1227/3000 [00:00<00:01, 1746.37it/s]warmup should be done:  47%|████▋     | 1401/3000 [00:00<00:00, 1792.35it/s]warmup should be done:  48%|████▊     | 1431/3000 [00:00<00:00, 1800.67it/s]warmup should be done:  48%|████▊     | 1436/3000 [00:00<00:00, 1804.63it/s]warmup should be done:  47%|████▋     | 1406/3000 [00:00<00:00, 1759.37it/s]warmup should be done:  53%|█████▎    | 1583/3000 [00:00<00:00, 1799.52it/s]warmup should be done:  54%|█████▍    | 1619/3000 [00:00<00:00, 1810.64it/s]warmup should be done:  54%|█████▎    | 1612/3000 [00:00<00:00, 1796.66it/s]warmup should be done:  53%|█████▎    | 1585/3000 [00:00<00:00, 1768.16it/s]warmup should be done:  60%|█████▉    | 1793/3000 [00:01<00:00, 1799.86it/s]warmup should be done:  60%|██████    | 1801/3000 [00:01<00:00, 1803.80it/s]warmup should be done:  59%|█████▉    | 1765/3000 [00:01<00:00, 1774.99it/s]warmup should be done:  59%|█████▉    | 1763/3000 [00:01<00:00, 1771.96it/s]warmup should be done:  66%|██████▌   | 1975/3000 [00:01<00:00, 1804.50it/s]warmup should be done:  66%|██████▌   | 1985/3000 [00:01<00:00, 1813.01it/s]warmup should be done:  65%|██████▍   | 1943/3000 [00:01<00:00, 1776.08it/s]warmup should be done:  65%|██████▍   | 1944/3000 [00:01<00:00, 1781.21it/s]warmup should be done:  72%|███████▏  | 2157/3000 [00:01<00:00, 1807.67it/s]warmup should be done:  72%|███████▏  | 2169/3000 [00:01<00:00, 1821.02it/s]warmup should be done:  71%|███████   | 2121/3000 [00:01<00:00, 1776.84it/s]warmup should be done:  71%|███████   | 2123/3000 [00:01<00:00, 1776.54it/s]warmup should be done:  78%|███████▊  | 2339/3000 [00:01<00:00, 1809.94it/s]warmup should be done:  78%|███████▊  | 2353/3000 [00:01<00:00, 1826.64it/s]warmup should be done:  77%|███████▋  | 2300/3000 [00:01<00:00, 1780.30it/s]warmup should be done:  77%|███████▋  | 2308/3000 [00:01<00:00, 1796.84it/s]warmup should be done:  84%|████████▍ | 2520/3000 [00:01<00:00, 1807.89it/s]warmup should be done:  85%|████████▍ | 2538/3000 [00:01<00:00, 1830.83it/s]warmup should be done:  83%|████████▎ | 2479/3000 [00:01<00:00, 1780.32it/s]warmup should be done:  83%|████████▎ | 2493/3000 [00:01<00:00, 1810.87it/s]warmup should be done:  91%|█████████ | 2722/3000 [00:01<00:00, 1830.79it/s]warmup should be done:  89%|████████▊ | 2658/3000 [00:01<00:00, 1782.74it/s]warmup should be done:  89%|████████▉ | 2678/3000 [00:01<00:00, 1820.27it/s]warmup should be done:  90%|█████████ | 2701/3000 [00:01<00:00, 1778.59it/s]warmup should be done:  97%|█████████▋| 2906/3000 [00:01<00:00, 1832.81it/s]warmup should be done:  95%|█████████▍| 2837/3000 [00:01<00:00, 1783.58it/s]warmup should be done:  96%|█████████▌| 2884/3000 [00:01<00:00, 1792.63it/s]warmup should be done:  95%|█████████▌| 2861/3000 [00:01<00:00, 1813.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1809.49it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1790.88it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1777.04it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1766.53it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f258fdad160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f258fdad280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f258fdad0a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f259006fe80>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 23:03:54.511151: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f215d267760 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:03:54.511233: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:03:54.522517: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:03:54.527882: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f215d26e350 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:03:54.527929: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:03:54.535988: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:03:55.458058: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:03:55.532451: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f215d2682d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:03:55.532515: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:03:55.533560: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f2165a674d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:03:55.533599: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:03:55.542551: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:03:55.542623: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:03:55.561242: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:03:56.235420: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:03:56.236192: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:04:00.918255: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:04:01.100135: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:04:01.771951: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:04:01.790932: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][23:04:57.159][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][23:04:57.160][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:04:57.163][ERROR][RK0][main]: coll ps creation done
[HCTR][23:04:57.163][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][23:04:57.164][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][23:04:57.165][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:04:57.168][ERROR][RK0][main]: coll ps creation done
[HCTR][23:04:57.168][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][23:04:57.333][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][23:04:57.333][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:04:57.338][ERROR][RK0][main]: coll ps creation done
[HCTR][23:04:57.338][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][23:04:57.433][ERROR][RK0][tid #139781522585344]: replica 0 reaches 1000, calling init pre replica
[HCTR][23:04:57.434][ERROR][RK0][tid #139781522585344]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:04:57.437][ERROR][RK0][tid #139781522585344]: coll ps creation done
[HCTR][23:04:57.437][ERROR][RK0][tid #139781522585344]: replica 0 waits for coll ps creation barrier
[HCTR][23:04:57.437][ERROR][RK0][tid #139781522585344]: replica 0 preparing frequency
[HCTR][23:04:58.360][ERROR][RK0][tid #139781522585344]: replica 0 preparing frequency done
[HCTR][23:04:58.393][ERROR][RK0][tid #139781522585344]: replica 0 calling init per replica
[HCTR][23:04:58.393][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][23:04:58.393][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][23:04:58.393][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][23:04:58.393][ERROR][RK0][tid #139781522585344]: Calling build_v2
[HCTR][23:04:58.393][ERROR][RK0][main]: Calling build_v2
[HCTR][23:04:58.393][ERROR][RK0][main]: Calling build_v2
[HCTR][23:04:58.393][ERROR][RK0][tid #139781522585344]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:04:58.393][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:04:58.393][ERROR][RK0][main]: Calling build_v2
[HCTR][23:04:58.393][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:04:58.393][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[[2022-12-11 23:04:582022-12-11 23:04:582022-12-11 23:04:582022-12-11 23:04:58....393262393260393262393275: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc::::136136136136] ] ] ] using concurrent impl MPSusing concurrent impl MPSusing concurrent impl MPSusing concurrent impl MPS



[2022-12-11 23:04:58.394713: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-11 23:04:58.394737: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-11 23:04:58.[3947652022-12-11 23:04:58: [.E2022-12-11 23:04:58394778 .[: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc3947902022-12-11 23:04:58E:: . 196E394814/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc]  : :assigning 8 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE212
: ] 196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4] :[
assigning 8 to cpu2122022-12-11 23:04:58
] [.build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 23:04:58394945
.: 395002E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[ :2022-12-11 23:04:58/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc212.[:] 3950582022-12-11 23:04:58213build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: .] 
E395070remote time is 8.68421[ : 
2022-12-11 23:04:58/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE.[: 3951712022-12-11 23:04:58213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :.] E212395198remote time is 8.68421 ] : 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4E:
 [213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 23:04:58] :[.remote time is 8.684212142022-12-11 23:04:58395302
] .: cpu time is 30[395325E
2022-12-11 23:04:58:  .E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc395385 :: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214E:]  213cpu time is 30/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] 
:remote time is 8.68421214
] cpu time is 30
[2022-12-11 23:04:58.395534: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 23:05:23.776538: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 23:05:23.852205: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 23:05:23.852315: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 23:05:23.853625: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 23:05:23.959099: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 23:05:24.336603: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 23:05:24.336713: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 23:05:32. 99960: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 23:05:32.100071: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 23:05:33.946916: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 23:05:33.947116: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 23:05:33.951512: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 23:05:33.951637: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 23:05:35. 64373: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 23:05:35. 78172: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 23:05:35. 79050: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 23:05:35. 90154: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 23:05:35.184243: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 23:05:42.119458: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 23:05:42.124417: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 23:05:42.124844: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 23:05:42.136029: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 23:05:42.136099: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 23:05:42.136136: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 23:05:42.136171: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 23:05:42.136886: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:05:42.136932: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:05:42.138048: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:05:42.138630: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:05:42.160052: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 23:05:42.160129: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 23:05:42.160139: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 23:05:42.160278: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 23:05:42.160452: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:05:42.160498: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:05:42.161264: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:05:42.161657: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 23:05:42.161760: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 23:05:42.161819: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:05:42.162501: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:05:42.162557: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:05:42.163394: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:05:42.163942: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:05:42.167871: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:05:42.168009: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:05:42.169152: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:05:42.169777: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:05:42.221275: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:05:42.223149: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:05:42.223218: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:05:42.224015: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 23:05:42.224445: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:05:42.225381: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:05:42.225424: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.51 MB
[2022-12-11 23:05:42.240732: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:05:42.241369: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:05:42.241412: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[2022-12-11 23:05:42.249396: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:05:42.251268: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:05:42.251323: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:05:42.252067: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 23:05:42.252480: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:05:42.253504: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:05:42.253548: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.51 MB
[2022-12-11 23:05:42.265419: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:05:42.265732: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:05:42.267182: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:05:42.267240: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:05:42.267642: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:05:42.267715: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:05:42.267977: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 23:05:42.268678: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-11 23:05:421980.] 268704eager alloc mem 25.25 KB: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 23:05:42.268896: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:05:42.269111: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:05:42.269292: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:05:42.269337: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[2022-12-11 23:05:42.269836: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:05:42.269881: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.49 MB
[2022-12-11 23:05:42.270076: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:05:42.270139: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.23 MB
[2022-12-11 23:05:42.284721: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:05:42.285338: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[[2022-12-11 23:05:422022-12-11 23:05:42..285360285380: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 25.25 KBeager alloc mem 3.78 GB

[2022-12-11 23:05:42.285966: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:05:42.286007: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[[[[2022-12-11 23:05:422022-12-11 23:05:422022-12-11 23:05:422022-12-11 23:05:42....628619628628628628628643: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 2 init p2p of link 3Device 0 init p2p of link 1Device 1 init p2p of link 2



[[2022-12-11 23:05:422022-12-11 23:05:42..[[6289466289462022-12-11 23:05:422022-12-11 23:05:42: : ..EE628959628958  : : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuEE::  19801980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] ] ::eager alloc mem 611.00 KBeager alloc mem 611.00 KB19801980

] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[2022-12-11 23:05:42.[629860[2022-12-11 23:05:42[: 2022-12-11 23:05:42.2022-12-11 23:05:42E.629870. 629873: 629874/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: E: :E E638 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 625663:638:
638] 638] eager release cuda mem 625663] eager release cuda mem 625663
eager release cuda mem 625663

[2022-12-11 23:05:42.634743: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 23:05:42.634850: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:05:42.635081: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 23:05:42.635120: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 23:05:42.[6351732022-12-11 23:05:42: .E635189 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE:[ 19262022-12-11 23:05:42/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] .:Device 3 init p2p of link 16352291980
: ] Eeager alloc mem 611.00 KB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:05:42.635341: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:05:42.635643: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:05:42.636048: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:2022-12-11 23:05:42638.] 636065eager release cuda mem 625663: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:05:42.636128: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:05:42.639956: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 23:05:42.640044: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:05:42.640548: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 23:05:42.640634: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:05:42.640836: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:05:42.641154: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 23:05:42.641189: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 23:05:42.641232: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:05:42.641285: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:05:42.641419: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:05:42.642010: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:05:42.642071: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:05:42.644517: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 23:05:42.644790: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7924994 / 100000000 nodes ( 7.92 %~8.00 %) | remote 22008043 / 100000000 nodes ( 22.01 %) | cpu 70066963 / 100000000 nodes ( 70.07 %) | 3.78 GB | 0.476835 secs 
[2022-12-11 23:05:42.645099: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 23:05:42.645376: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7997763 / 100000000 nodes ( 8.00 %~8.00 %) | remote 21935274 / 100000000 nodes ( 21.94 %) | cpu 70066963 / 100000000 nodes ( 70.07 %) | 3.82 GB | 0.50845 secs 
[2022-12-11 23:05:42.645636: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 23:05:42.645901: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7993949 / 100000000 nodes ( 7.99 %~8.00 %) | remote 21939088 / 100000000 nodes ( 21.94 %) | cpu 70066963 / 100000000 nodes ( 70.07 %) | 3.82 GB | 0.485414 secs 
[2022-12-11 23:05:42.646249: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 23:05:42.646317: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.52 GB
[2022-12-11 23:05:42.646710: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7997861 / 100000000 nodes ( 8.00 %~8.00 %) | remote 21935176 / 100000000 nodes ( 21.94 %) | cpu 70066963 / 100000000 nodes ( 70.07 %) | 3.82 GB | 0.484168 secs 
[2022-12-11 23:05:43.480281: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.76 GB
[2022-12-11 23:05:43.480421: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.76 GB
[2022-12-11 23:05:43.480690: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.76 GB
[2022-12-11 23:05:44.132322: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.01 GB
[2022-12-11 23:05:44.132452: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.01 GB
[2022-12-11 23:05:44.132916: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.01 GB
[2022-12-11 23:05:44.904842: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.26 GB
[2022-12-11 23:05:44.905010: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.26 GB
[2022-12-11 23:05:44.905346: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.26 GB
[2022-12-11 23:05:45.666914: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.66 GB
[2022-12-11 23:05:45.667172: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.66 GB
[2022-12-11 23:05:45.667472: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.66 GB
[2022-12-11 23:05:46.582878: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.86 GB
[2022-12-11 23:05:46.583043: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.86 GB
[HCTR][23:05:46.621][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][23:05:46.621][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][23:05:46.621][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][23:05:46.621][ERROR][RK0][tid #139781522585344]: replica 0 calling init per replica done, doing barrier
[HCTR][23:05:46.622][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][23:05:46.622][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][23:05:46.622][ERROR][RK0][tid #139781522585344]: replica 0 calling init per replica done, doing barrier done
[HCTR][23:05:46.622][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][23:05:46.622][ERROR][RK0][main]: init per replica done
[HCTR][23:05:46.622][ERROR][RK0][main]: init per replica done
[HCTR][23:05:46.622][ERROR][RK0][main]: init per replica done
[HCTR][23:05:46.624][ERROR][RK0][tid #139781522585344]: init per replica done
[HCTR][23:05:46.656][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f06a4238400
[HCTR][23:05:46.656][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f06a4558400
[HCTR][23:05:46.657][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f06a4b98400
[HCTR][23:05:46.657][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f06a4eb8400
[HCTR][23:05:46.657][ERROR][RK0][tid #139781522585344]: 2 allocated 3276800 at 0x7f0738238400
[HCTR][23:05:46.657][ERROR][RK0][tid #139781522585344]: 2 allocated 6553600 at 0x7f0738558400
[HCTR][23:05:46.657][ERROR][RK0][tid #139781522585344]: 2 allocated 3276800 at 0x7f0738b98400
[HCTR][23:05:46.657][ERROR][RK0][tid #139781522585344]: 2 allocated 6553600 at 0x7f0738eb8400
[HCTR][23:05:46.658][ERROR][RK0][tid #139781522585344]: 1 allocated 3276800 at 0x7f0724238400
[HCTR][23:05:46.658][ERROR][RK0][tid #139781522585344]: 1 allocated 6553600 at 0x7f0724558400
[HCTR][23:05:46.658][ERROR][RK0][tid #139781522585344]: 1 allocated 3276800 at 0x7f0724b98400
[HCTR][23:05:46.658][ERROR][RK0][tid #139781522585344]: 1 allocated 6553600 at 0x7f0724eb8400
[HCTR][23:05:46.660][ERROR][RK0][tid #139781522585344]: 0 allocated 3276800 at 0x7f0668320000
[HCTR][23:05:46.660][ERROR][RK0][tid #139781522585344]: 0 allocated 6553600 at 0x7f0668640000
[HCTR][23:05:46.660][ERROR][RK0][tid #139781522585344]: 0 allocated 3276800 at 0x7f0668c80000
[HCTR][23:05:46.660][ERROR][RK0][tid #139781522585344]: 0 allocated 6553600 at 0x7f0668fa0000
