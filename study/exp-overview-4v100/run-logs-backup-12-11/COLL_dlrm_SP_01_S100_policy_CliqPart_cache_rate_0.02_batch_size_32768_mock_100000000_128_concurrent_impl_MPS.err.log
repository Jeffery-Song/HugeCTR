2022-12-11 19:58:31.231250: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:58:31.306385: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:58:31.306421: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:58:31.307584: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:58:32.105701: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:58:32.105778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 19:58:32.118488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 19:58:32.149848: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:58:32.150014: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:58:32.152108: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 19:58:32.173699: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:58:32.173772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 19:58:32.177861: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:58:32.177930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 19:58:32.179575: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:58:32.179629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 19:58:32.185839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 19:58:32.189970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 19:58:32.191849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 19:58:32.216196: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:58:32.216362: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:58:32.217928: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 19:58:32.221420: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:58:32.221557: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:58:32.222924: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 19:58:32.223185: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:58:32.223312: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:58:32.225812: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][19:58:33.449][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:58:33.468][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:58:33.498][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:58:33.523][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 98it [00:01, 89.17it/s]warmup run: 0it [00:00, ?it/s]warmup run: 197it [00:01, 193.02it/s]warmup run: 1it [00:01,  1.49s/it]warmup run: 303it [00:01, 315.37it/s]warmup run: 106it [00:01, 92.43it/s]warmup run: 410it [00:01, 441.56it/s]warmup run: 210it [00:01, 197.56it/s]warmup run: 520it [00:01, 568.21it/s]warmup run: 313it [00:01, 311.46it/s]warmup run: 631it [00:02, 685.15it/s]warmup run: 420it [00:01, 435.23it/s]warmup run: 738it [00:02, 775.03it/s]warmup run: 1it [00:01,  1.56s/it]warmup run: 528it [00:01, 556.78it/s]warmup run: 843it [00:02, 843.92it/s]warmup run: 103it [00:01, 86.12it/s]warmup run: 640it [00:02, 675.47it/s]warmup run: 950it [00:02, 902.32it/s]warmup run: 205it [00:01, 185.98it/s]warmup run: 751it [00:02, 775.40it/s]warmup run: 1057it [00:02, 947.22it/s]warmup run: 307it [00:01, 296.20it/s]warmup run: 860it [00:02, 853.46it/s]warmup run: 1164it [00:02, 980.74it/s]warmup run: 409it [00:01, 410.95it/s]warmup run: 970it [00:02, 916.35it/s]warmup run: 1272it [00:02, 1007.54it/s]warmup run: 509it [00:02, 519.26it/s]warmup run: 1083it [00:02, 972.45it/s]warmup run: 1379it [00:02, 1019.57it/s]warmup run: 616it [00:02, 633.34it/s]warmup run: 1194it [00:02, 1009.55it/s]warmup run: 1488it [00:02, 1038.57it/s]warmup run: 716it [00:02, 717.07it/s]warmup run: 1304it [00:02, 1030.61it/s]warmup run: 1595it [00:02, 1043.86it/s]warmup run: 815it [00:02, 775.12it/s]warmup run: 1414it [00:02, 1049.54it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 1703it [00:03, 1053.73it/s]warmup run: 917it [00:02, 837.97it/s]warmup run: 108it [00:01, 97.62it/s]warmup run: 1524it [00:02, 1061.40it/s]warmup run: 1810it [00:03, 1057.76it/s]warmup run: 1019it [00:02, 885.02it/s]warmup run: 214it [00:01, 207.91it/s]warmup run: 1634it [00:03, 1063.33it/s]warmup run: 1917it [00:03, 1060.71it/s]warmup run: 1121it [00:02, 922.26it/s]warmup run: 322it [00:01, 330.50it/s]warmup run: 1743it [00:03, 1051.06it/s]warmup run: 2030it [00:03, 1080.20it/s]warmup run: 1226it [00:02, 956.51it/s]warmup run: 432it [00:01, 458.92it/s]warmup run: 1854it [00:03, 1067.03it/s]warmup run: 2163it [00:03, 1153.16it/s]warmup run: 1331it [00:02, 981.99it/s]warmup run: 543it [00:01, 584.04it/s]warmup run: 1965it [00:03, 1079.35it/s]warmup run: 2297it [00:03, 1207.33it/s]warmup run: 1435it [00:02, 998.21it/s]warmup run: 650it [00:02, 687.92it/s]warmup run: 2091it [00:03, 1132.00it/s]warmup run: 2431it [00:03, 1246.74it/s]warmup run: 1542it [00:03, 1017.66it/s]warmup run: 756it [00:02, 774.23it/s]warmup run: 2224it [00:03, 1189.50it/s]warmup run: 2566it [00:03, 1275.24it/s]warmup run: 1647it [00:03, 1026.72it/s]warmup run: 862it [00:02, 844.94it/s]warmup run: 2350it [00:03, 1209.12it/s]warmup run: 2700it [00:03, 1292.79it/s]warmup run: 1754it [00:03, 1037.47it/s]warmup run: 968it [00:02, 899.97it/s]warmup run: 2477it [00:03, 1225.82it/s]warmup run: 2834it [00:03, 1306.37it/s]warmup run: 1868it [00:03, 1066.95it/s]warmup run: 2600it [00:03, 1139.05it/s]warmup run: 1073it [00:02, 857.75it/s]warmup run: 2969it [00:04, 1318.63it/s]warmup run: 3000it [00:04, 737.94it/s] warmup run: 1983it [00:03, 1089.06it/s]warmup run: 2716it [00:03, 1143.93it/s]warmup run: 1180it [00:02, 913.26it/s]warmup run: 2113it [00:03, 1149.91it/s]warmup run: 2853it [00:04, 1207.12it/s]warmup run: 1289it [00:02, 959.94it/s]warmup run: 2246it [00:03, 1203.01it/s]warmup run: 2990it [00:04, 1252.99it/s]warmup run: 1396it [00:02, 989.85it/s]warmup run: 3000it [00:04, 722.71it/s] warmup run: 2380it [00:03, 1241.39it/s]warmup run: 1500it [00:02, 992.18it/s]warmup run: 2513it [00:03, 1265.92it/s]warmup run: 1607it [00:02, 1012.15it/s]warmup run: 2645it [00:03, 1281.40it/s]warmup run: 1712it [00:03, 1021.45it/s]warmup run: 2778it [00:04, 1293.13it/s]warmup run: 1818it [00:03, 1031.91it/s]warmup run: 2912it [00:04, 1306.34it/s]warmup run: 1927it [00:03, 1046.63it/s]warmup run: 3000it [00:04, 705.76it/s] warmup run: 2034it [00:03, 1052.41it/s]warmup run: 2165it [00:03, 1127.93it/s]warmup run: 2297it [00:03, 1184.57it/s]warmup run: 2430it [00:03, 1226.36it/s]warmup run: 2563it [00:03, 1255.53it/s]warmup run: 2695it [00:03, 1273.20it/s]warmup run: 2828it [00:03, 1289.04it/s]warmup run: 2961it [00:04, 1300.90it/s]warmup run: 3000it [00:04, 728.05it/s] 

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1749.66it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1725.42it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1616.95it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1703.96it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1760.15it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1756.12it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1741.38it/s]warmup should be done:  11%|█         | 328/3000 [00:00<00:01, 1637.56it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1758.81it/s]warmup should be done:  17%|█▋        | 503/3000 [00:00<00:01, 1686.08it/s]warmup should be done:  17%|█▋        | 523/3000 [00:00<00:01, 1737.43it/s]warmup should be done:  18%|█▊        | 529/3000 [00:00<00:01, 1751.02it/s]warmup should be done:  23%|██▎       | 678/3000 [00:00<00:01, 1711.12it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1764.15it/s]warmup should be done:  23%|██▎       | 698/3000 [00:00<00:01, 1742.08it/s]warmup should be done:  24%|██▎       | 705/3000 [00:00<00:01, 1753.10it/s]warmup should be done:  29%|██▉       | 884/3000 [00:00<00:01, 1768.90it/s]warmup should be done:  28%|██▊       | 853/3000 [00:00<00:01, 1723.18it/s]warmup should be done:  29%|██▉       | 881/3000 [00:00<00:01, 1748.79it/s]warmup should be done:  29%|██▉       | 873/3000 [00:00<00:01, 1733.85it/s]warmup should be done:  34%|███▍      | 1027/3000 [00:00<00:01, 1727.72it/s]warmup should be done:  35%|███▌      | 1062/3000 [00:00<00:01, 1770.86it/s]warmup should be done:  35%|███▌      | 1056/3000 [00:00<00:01, 1744.88it/s]warmup should be done:  35%|███▍      | 1047/3000 [00:00<00:01, 1717.00it/s]warmup should be done:  41%|████▏     | 1240/3000 [00:00<00:00, 1773.30it/s]warmup should be done:  40%|████      | 1202/3000 [00:00<00:01, 1733.60it/s]warmup should be done:  41%|████      | 1231/3000 [00:00<00:01, 1743.60it/s]warmup should be done:  41%|████      | 1219/3000 [00:00<00:01, 1712.00it/s]warmup should be done:  46%|████▌     | 1377/3000 [00:00<00:00, 1737.81it/s]warmup should be done:  47%|████▋     | 1419/3000 [00:00<00:00, 1775.81it/s]warmup should be done:  47%|████▋     | 1406/3000 [00:00<00:00, 1740.47it/s]warmup should be done:  46%|████▋     | 1391/3000 [00:00<00:00, 1713.15it/s]warmup should be done:  52%|█████▏    | 1553/3000 [00:00<00:00, 1743.02it/s]warmup should be done:  53%|█████▎    | 1597/3000 [00:00<00:00, 1762.38it/s]warmup should be done:  53%|█████▎    | 1581/3000 [00:00<00:00, 1740.71it/s]warmup should be done:  52%|█████▏    | 1563/3000 [00:00<00:00, 1706.68it/s]warmup should be done:  58%|█████▊    | 1729/3000 [00:01<00:00, 1747.24it/s]warmup should be done:  59%|█████▉    | 1775/3000 [00:01<00:00, 1765.45it/s]warmup should be done:  59%|█████▊    | 1756/3000 [00:01<00:00, 1741.93it/s]warmup should be done:  58%|█████▊    | 1734/3000 [00:01<00:00, 1702.40it/s]warmup should be done:  64%|██████▎   | 1905/3000 [00:01<00:00, 1750.80it/s]warmup should be done:  65%|██████▌   | 1952/3000 [00:01<00:00, 1766.24it/s]warmup should be done:  64%|██████▍   | 1931/3000 [00:01<00:00, 1741.81it/s]warmup should be done:  64%|██████▎   | 1905/3000 [00:01<00:00, 1695.88it/s]warmup should be done:  71%|███████   | 2129/3000 [00:01<00:00, 1760.95it/s]warmup should be done:  70%|███████   | 2106/3000 [00:01<00:00, 1741.15it/s]warmup should be done:  69%|██████▉   | 2081/3000 [00:01<00:00, 1712.38it/s]warmup should be done:  69%|██████▉   | 2075/3000 [00:01<00:00, 1688.43it/s]warmup should be done:  76%|███████▌  | 2281/3000 [00:01<00:00, 1738.13it/s]warmup should be done:  77%|███████▋  | 2306/3000 [00:01<00:00, 1749.41it/s]warmup should be done:  75%|███████▌  | 2257/3000 [00:01<00:00, 1726.01it/s]warmup should be done:  75%|███████▍  | 2244/3000 [00:01<00:00, 1687.44it/s]warmup should be done:  82%|████████▏ | 2457/3000 [00:01<00:00, 1742.69it/s]warmup should be done:  83%|████████▎ | 2481/3000 [00:01<00:00, 1747.31it/s]warmup should be done:  81%|████████  | 2436/3000 [00:01<00:00, 1743.25it/s]warmup should be done:  81%|████████  | 2416/3000 [00:01<00:00, 1694.95it/s]warmup should be done:  88%|████████▊ | 2634/3000 [00:01<00:00, 1747.87it/s]warmup should be done:  89%|████████▊ | 2656/3000 [00:01<00:00, 1744.03it/s]warmup should be done:  87%|████████▋ | 2614/3000 [00:01<00:00, 1754.13it/s]warmup should be done:  86%|████████▌ | 2587/3000 [00:01<00:00, 1698.23it/s]warmup should be done:  94%|█████████▎| 2809/3000 [00:01<00:00, 1737.53it/s]warmup should be done:  94%|█████████▍| 2831/3000 [00:01<00:00, 1742.30it/s]warmup should be done:  93%|█████████▎| 2793/3000 [00:01<00:00, 1762.52it/s]warmup should be done:  92%|█████████▏| 2759/3000 [00:01<00:00, 1703.84it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1756.05it/s]warmup should be done:  99%|█████████▉| 2984/3000 [00:01<00:00, 1738.81it/s]warmup should be done:  99%|█████████▉| 2972/3000 [00:01<00:00, 1769.41it/s]warmup should be done:  98%|█████████▊| 2931/3000 [00:01<00:00, 1708.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1742.97it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1736.37it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1708.35it/s]



warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1758.10it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1728.44it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1714.32it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1690.89it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1791.39it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1753.13it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1754.39it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1740.64it/s]warmup should be done:  18%|█▊        | 541/3000 [00:00<00:01, 1810.18it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1772.71it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1759.23it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1717.40it/s]warmup should be done:  24%|██▍       | 725/3000 [00:00<00:01, 1819.40it/s]warmup should be done:  24%|██▎       | 712/3000 [00:00<00:01, 1784.25it/s]warmup should be done:  24%|██▎       | 707/3000 [00:00<00:01, 1771.49it/s]warmup should be done:  23%|██▎       | 704/3000 [00:00<00:01, 1733.78it/s]warmup should be done:  30%|███       | 909/3000 [00:00<00:01, 1824.24it/s]warmup should be done:  30%|██▉       | 886/3000 [00:00<00:01, 1776.11it/s]warmup should be done:  30%|██▉       | 891/3000 [00:00<00:01, 1778.11it/s]warmup should be done:  29%|██▉       | 882/3000 [00:00<00:01, 1747.25it/s]warmup should be done:  36%|███▋      | 1093/3000 [00:00<00:01, 1829.34it/s]warmup should be done:  36%|███▌      | 1065/3000 [00:00<00:01, 1778.80it/s]warmup should be done:  36%|███▌      | 1070/3000 [00:00<00:01, 1780.75it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1758.14it/s]warmup should be done:  43%|████▎     | 1276/3000 [00:00<00:00, 1828.46it/s]warmup should be done:  41%|████▏     | 1243/3000 [00:00<00:00, 1777.73it/s]warmup should be done:  42%|████▏     | 1249/3000 [00:00<00:00, 1781.60it/s]warmup should be done:  41%|████      | 1236/3000 [00:00<00:01, 1757.98it/s]warmup should be done:  49%|████▊     | 1461/3000 [00:00<00:00, 1832.73it/s]warmup should be done:  47%|████▋     | 1423/3000 [00:00<00:00, 1781.75it/s]warmup should be done:  48%|████▊     | 1428/3000 [00:00<00:00, 1779.39it/s]warmup should be done:  47%|████▋     | 1416/3000 [00:00<00:00, 1770.20it/s]warmup should be done:  55%|█████▍    | 1645/3000 [00:00<00:00, 1830.52it/s]warmup should be done:  53%|█████▎    | 1602/3000 [00:00<00:00, 1782.97it/s]warmup should be done:  54%|█████▎    | 1609/3000 [00:00<00:00, 1786.52it/s]warmup should be done:  53%|█████▎    | 1596/3000 [00:00<00:00, 1778.94it/s]warmup should be done:  61%|██████    | 1830/3000 [00:01<00:00, 1834.02it/s]warmup should be done:  60%|█████▉    | 1788/3000 [00:01<00:00, 1783.05it/s]warmup should be done:  59%|█████▉    | 1776/3000 [00:01<00:00, 1783.03it/s]warmup should be done:  59%|█████▉    | 1781/3000 [00:01<00:00, 1714.03it/s]warmup should be done:  67%|██████▋   | 2014/3000 [00:01<00:00, 1829.16it/s]warmup should be done:  66%|██████▌   | 1971/3000 [00:01<00:00, 1796.16it/s]warmup should be done:  65%|██████▌   | 1955/3000 [00:01<00:00, 1784.83it/s]warmup should be done:  66%|██████▌   | 1966/3000 [00:01<00:00, 1752.77it/s]warmup should be done:  72%|███████▏  | 2151/3000 [00:01<00:00, 1790.51it/s]warmup should be done:  73%|███████▎  | 2197/3000 [00:01<00:00, 1792.57it/s]warmup should be done:  72%|███████▏  | 2152/3000 [00:01<00:00, 1782.00it/s]warmup should be done:  71%|███████   | 2134/3000 [00:01<00:00, 1713.32it/s]warmup should be done:  78%|███████▊  | 2334/3000 [00:01<00:00, 1801.77it/s]warmup should be done:  79%|███████▉  | 2377/3000 [00:01<00:00, 1765.21it/s]warmup should be done:  78%|███████▊  | 2338/3000 [00:01<00:00, 1803.02it/s]warmup should be done:  77%|███████▋  | 2312/3000 [00:01<00:00, 1732.09it/s]warmup should be done:  84%|████████▍ | 2518/3000 [00:01<00:00, 1811.08it/s]warmup should be done:  85%|████████▌ | 2554/3000 [00:01<00:00, 1766.23it/s]warmup should be done:  84%|████████▍ | 2524/3000 [00:01<00:00, 1818.67it/s]warmup should be done:  83%|████████▎ | 2491/3000 [00:01<00:00, 1746.75it/s]warmup should be done:  90%|█████████ | 2703/3000 [00:01<00:00, 1820.65it/s]warmup should be done:  91%|█████████ | 2736/3000 [00:01<00:00, 1779.75it/s]warmup should be done:  90%|█████████ | 2710/3000 [00:01<00:00, 1828.43it/s]warmup should be done:  89%|████████▉ | 2669/3000 [00:01<00:00, 1755.83it/s]warmup should be done:  96%|█████████▌| 2886/3000 [00:01<00:00, 1818.83it/s]warmup should be done:  96%|█████████▋| 2895/3000 [00:01<00:00, 1833.78it/s]warmup should be done:  97%|█████████▋| 2915/3000 [00:01<00:00, 1771.57it/s]warmup should be done:  95%|█████████▍| 2846/3000 [00:01<00:00, 1759.90it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1796.22it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1793.76it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1789.95it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1757.74it/s]2022-12-11 19:59:48.961479: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f74c2a654d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:59:48.961553: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:59:50.232592: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f74ba26b550 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:59:50.232663: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:59:50.233327: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f74c2267ae0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:59:50.233370: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:59:50.568578: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:59:51.699704: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:59:51.879856: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:59:52.707963: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:59:53.011705: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:59:53.716682: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:59:54.145649: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:59:55.578651: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:59:55.594379: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:59:57.169691: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f74c2268420 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:59:57.169745: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:59:58.731819: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:59:59.783909: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:00:01.015811: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][20:00:38.888][ERROR][RK0][tid #140140303324928]: replica 2 reaches 1000, calling init pre replica
[HCTR][20:00:38.888][ERROR][RK0][tid #140140303324928]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][20:00:38.894][ERROR][RK0][tid #140140303324928]: coll ps creation done
[HCTR][20:00:38.894][ERROR][RK0][tid #140140303324928]: replica 2 waits for coll ps creation barrier
[HCTR][20:00:38.918][ERROR][RK0][tid #140139548374784]: replica 3 reaches 1000, calling init pre replica
[HCTR][20:00:38.918][ERROR][RK0][tid #140139548374784]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][20:00:38.922][ERROR][RK0][tid #140139548374784]: coll ps creation done
[HCTR][20:00:38.922][ERROR][RK0][tid #140139548374784]: replica 3 waits for coll ps creation barrier
[HCTR][20:00:38.937][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][20:00:38.937][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][20:00:38.941][ERROR][RK0][main]: coll ps creation done
[HCTR][20:00:38.941][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][20:00:39.151][ERROR][RK0][tid #140140034889472]: replica 1 reaches 1000, calling init pre replica
[HCTR][20:00:39.152][ERROR][RK0][tid #140140034889472]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][20:00:39.155][ERROR][RK0][tid #140140034889472]: coll ps creation done
[HCTR][20:00:39.155][ERROR][RK0][tid #140140034889472]: replica 1 waits for coll ps creation barrier
[HCTR][20:00:39.155][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][20:00:40.111][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][20:00:40.146][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][20:00:40.146][ERROR][RK0][tid #140140034889472]: replica 1 calling init per replica
[HCTR][20:00:40.146][ERROR][RK0][tid #140140303324928]: replica 2 calling init per replica
[HCTR][20:00:40.146][ERROR][RK0][tid #140139548374784]: replica 3 calling init per replica
[HCTR][20:00:40.146][ERROR][RK0][main]: Calling build_v2
[HCTR][20:00:40.146][ERROR][RK0][tid #140140034889472]: Calling build_v2
[HCTR][20:00:40.146][ERROR][RK0][tid #140140303324928]: Calling build_v2
[HCTR][20:00:40.146][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:00:40.146][ERROR][RK0][tid #140139548374784]: Calling build_v2
[HCTR][20:00:40.146][ERROR][RK0][tid #140140034889472]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:00:40.146][ERROR][RK0][tid #140140303324928]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:00:40.146][ERROR][RK0][tid #140139548374784]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 20:00:40.146175: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136[] [[2022-12-11 20:00:40using concurrent impl MPS2022-12-11 20:00:40.
.2022-12-11 20:00:40146202146206.: : 146206EE:   E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136136:] ] 136using concurrent impl MPSusing concurrent impl MPS] 

using concurrent impl MPS
[2022-12-11 20:00:40.147052: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 20:00:40.147107: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 20:00:40.147151: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 20:00:40.147180: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 20:00:40.147558: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 20:00:40196.[] 1475892022-12-11 20:00:40assigning 8 to cpu: .
E147611 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: 196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :assigning 8 to cpu196
] assigning 8 to cpu
[2022-12-11 20:00:40.147697: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212[] 2022-12-11 20:00:40build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[.
2022-12-11 20:00:40147732.: 147739E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc [:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 20:00:40212:.] 212147786build symm link desc with 4X Tesla V100-SXM2-16GB out of 4] : 
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:[2022-12-11 20:00:402132022-12-11 20:00:40.] .147871remote time is 8.68421147880: 
: EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[::2022-12-11 20:00:40213213.] ] 147944remote time is 8.68421remote time is 8.68421: 

E [[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 20:00:402022-12-11 20:00:40:..214148034148037] : : cpu time is 30EE
  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::214214] ] cpu time is 30cpu time is 30

[2022-12-11 20:01:03.687703: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 20:01:03.753619: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 20:01:03.891751: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 20:01:03.891816: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 20:01:03.891849: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 20:01:03.891879: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 20:01:03.894178: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:01:03.894240: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:01:03.896022: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:01:03.896610: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:01:03.916840: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 20:01:03.916896: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 20:01:03.916913: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 20:01:03.916961: [E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:2022-12-11 20:01:03205.] 916924worker 0 thread 2 initing device 2: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 20:01:03.917023: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 20:01:03.917171: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:01:03.917219: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:01:03.917407: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:01:03.917457: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:01:03.918430: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:01:03.918494: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:01:03.919194: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:01:03.919251: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:01:03.919920: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:01:03.920176: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:01:03.921768: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:01:03.922466: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:01:03.993544: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 20:01:03.995453: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 20:01:03.995512: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 20:01:03.996409: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:01:03.998162: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:01:03.999153: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:01:04.  1930: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:01:04.  2628: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:01:04.  2677: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.44 MB
[[[2022-12-11 20:01:042022-12-11 20:01:042022-12-11 20:01:04... 26301 26301 26301: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes


[2022-12-11 20:01:04. 28151[: 2022-12-11 20:01:04E.  28161/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :E638 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 5:
638] eager release cuda mem 5
[[2022-12-11 20:01:04[2022-12-11 20:01:04.2022-12-11 20:01:04. 28219. 28217:  28225: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638:638] 638] eager release cuda mem 400000000] eager release cuda mem 5

eager release cuda mem 400000000
[2022-12-11 20:01:04. 28315: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 20:01:04. 29181: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:01:04. 29668: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:01:04. 30163: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:01:04. 30693: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:01:04. 30820: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:01:04. 31590: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:01:04. 31711: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 611.00 KB2022-12-11 20:01:04
. 31745: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:01:04. 32676: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:01:04. 36503: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:01:04. 37080: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:01:04. 37166: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:01:04. 37210: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.44 MB
[2022-12-11 20:01:04. 37746: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:01:04. 37789: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.44 MB
[2022-12-11 20:01:04. 38564: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:01:04. 39226: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:01:04. 39270: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.44 MB
[[[[2022-12-11 20:01:042022-12-11 20:01:042022-12-11 20:01:042022-12-11 20:01:04....124217124217124217124217: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 1 init p2p of link 2Device 0 init p2p of link 1Device 2 init p2p of link 3



[2022-12-11 20:01:04.[124421[2022-12-11 20:01:04: [2022-12-11 20:01:04.E2022-12-11 20:01:04.124426 .124428: /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu124432: E:: E 1980E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980
:1980] 1980] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

eager alloc mem 611.00 KB
[2022-12-11 20:01:04.125251: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:01:04.125296: E[ 2022-12-11 20:01:04[/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.2022-12-11 20:01:04:125307.638: 125314] E: eager release cuda mem 625663 E
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-11 20:01:04.127583: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 20:01:04.127671: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:01:04.127779: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[[2022-12-11 20:01:042022-12-11 20:01:04..127859127866: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2022-12-11 20:01:04:1926.1980] 127889] Device 2 init p2p of link 0: eager alloc mem 611.00 KB
E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 20:01:04.127986: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 611.00 KB2022-12-11 20:01:04
.128004: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:01:04.128417: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:01:04.128722: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:01:04.128807: [E2022-12-11 20:01:04 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc128815:: 638E]  eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-11 20:01:04.130209: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 20:01:04.130290: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:01:04.130880: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 20:01:04.130960: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:01:04.131044: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:01:04.131119: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 20:01:04.131162: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 20:01:04.131202: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:01:04.131247: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:01:04.131772: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:01:04.132009: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:01:04.132054: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:01:04.132450: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:01:04.133316: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 1999999 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5999997 / 100000000 nodes ( 6.00 %) | cpu 92000004 / 100000000 nodes ( 92.00 %) | 981.44 MB | 0.215873 secs 
[2022-12-11 20:01:04.133708: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:01:04.134274: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 1999999 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5999997 / 100000000 nodes ( 6.00 %) | cpu 92000004 / 100000000 nodes ( 92.00 %) | 981.44 MB | 0.217068 secs 
[2022-12-11 20:01:04.134462: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:01:04.134563: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:01:04.135036: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 1999999 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5999997 / 100000000 nodes ( 6.00 %) | cpu 92000004 / 100000000 nodes ( 92.00 %) | 981.44 MB | 0.215798 secs 
[2022-12-11 20:01:04.135544: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 1999999 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5999997 / 100000000 nodes ( 6.00 %) | cpu 92000004 / 100000000 nodes ( 92.00 %) | 981.44 MB | 0.241316 secs 
[2022-12-11 20:01:04.136183: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 5.99 GB
[2022-12-11 20:01:05.437358: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 6.23 GB
[2022-12-11 20:01:05.437606: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 6.23 GB
[2022-12-11 20:01:05.437877: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 6.23 GB
[2022-12-11 20:01:06. 96922: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 6.48 GB
[2022-12-11 20:01:06. 97058: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 6.48 GB
[2022-12-11 20:01:06. 97314: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 6.48 GB
[2022-12-11 20:01:06.886090: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 6.72 GB
[2022-12-11 20:01:06.886207: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 6.72 GB
[2022-12-11 20:01:06.886526: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 6.72 GB
[2022-12-11 20:01:07.653555: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.13 GB
[2022-12-11 20:01:07.653698: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.13 GB
[2022-12-11 20:01:07.654534: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.13 GB
[2022-12-11 20:01:08.422538: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.32 GB
[2022-12-11 20:01:08.422726: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.32 GB
[HCTR][20:01:08.630][ERROR][RK0][tid #140140303324928]: replica 2 calling init per replica done, doing barrier
[HCTR][20:01:08.630][ERROR][RK0][tid #140139548374784]: replica 3 calling init per replica done, doing barrier
[HCTR][20:01:08.630][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][20:01:08.630][ERROR][RK0][tid #140140034889472]: replica 1 calling init per replica done, doing barrier
[HCTR][20:01:08.630][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][20:01:08.630][ERROR][RK0][tid #140140303324928]: replica 2 calling init per replica done, doing barrier done
[HCTR][20:01:08.630][ERROR][RK0][tid #140139548374784]: replica 3 calling init per replica done, doing barrier done
[HCTR][20:01:08.630][ERROR][RK0][tid #140140034889472]: replica 1 calling init per replica done, doing barrier done
[HCTR][20:01:08.630][ERROR][RK0][tid #140140303324928]: init per replica done
[HCTR][20:01:08.630][ERROR][RK0][tid #140139548374784]: init per replica done
[HCTR][20:01:08.630][ERROR][RK0][tid #140140034889472]: init per replica done
[HCTR][20:01:08.633][ERROR][RK0][main]: init per replica done
[HCTR][20:01:08.637][ERROR][RK0][tid #140140303324928]: 2 allocated 3276800 at 0x7f5e12b20000
[HCTR][20:01:08.637][ERROR][RK0][tid #140140303324928]: 2 allocated 6553600 at 0x7f5e13000000
[HCTR][20:01:08.637][ERROR][RK0][tid #140140303324928]: 2 allocated 3276800 at 0x7f5e13640000
[HCTR][20:01:08.637][ERROR][RK0][tid #140140303324928]: 2 allocated 6553600 at 0x7f5e13960000
[HCTR][20:01:08.637][ERROR][RK0][tid #140139548374784]: 3 allocated 3276800 at 0x7f5d62b20000
[HCTR][20:01:08.637][ERROR][RK0][tid #140139548374784]: 3 allocated 6553600 at 0x7f5d63000000
[HCTR][20:01:08.637][ERROR][RK0][tid #140139548374784]: 3 allocated 3276800 at 0x7f5d63640000
[HCTR][20:01:08.637][ERROR][RK0][tid #140139548374784]: 3 allocated 6553600 at 0x7f5d63960000
[HCTR][20:01:08.638][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f5de6b20000
[HCTR][20:01:08.638][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f5de7000000
[HCTR][20:01:08.638][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f5de7640000
[HCTR][20:01:08.638][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f5de7960000
[HCTR][20:01:08.640][ERROR][RK0][tid #140139548374784]: 0 allocated 3276800 at 0x7f610b120000
[HCTR][20:01:08.640][ERROR][RK0][tid #140139548374784]: 0 allocated 6553600 at 0x7f610b600000
[HCTR][20:01:08.640][ERROR][RK0][tid #140139548374784]: 0 allocated 3276800 at 0x7f5e7250e800
[HCTR][20:01:08.640][ERROR][RK0][tid #140139548374784]: 0 allocated 6553600 at 0x7f5e7282e800




