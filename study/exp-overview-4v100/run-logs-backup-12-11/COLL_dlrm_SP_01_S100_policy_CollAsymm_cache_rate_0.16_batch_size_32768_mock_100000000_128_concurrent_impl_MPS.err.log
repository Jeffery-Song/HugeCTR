2022-12-12 01:49:22.749969: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:49:22.808280: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:49:22.818635: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:49:22.819031: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:49:23.617347: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:49:23.617421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:49:23.630737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:49:23.661913: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:49:23.662068: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:49:23.663957: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 01:49:23.674827: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:49:23.674894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:49:23.687963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:49:23.689503: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:49:23.689556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:49:23.694125: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:49:23.694196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:49:23.703875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:49:23.709953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:49:23.719683: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:49:23.719861: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:49:23.721493: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 01:49:23.734977: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:49:23.735127: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:49:23.736495: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 01:49:23.742409: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:49:23.742573: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:49:23.744174: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][01:49:25.009][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:49:25.018][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:49:25.021][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:49:25.021][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.56s/it]warmup run: 1it [00:01,  1.60s/it]warmup run: 89it [00:01, 74.16it/s]warmup run: 79it [00:01, 64.16it/s]warmup run: 154it [00:01, 135.59it/s]warmup run: 156it [00:01, 137.77it/s]warmup run: 265it [00:01, 264.42it/s]warmup run: 259it [00:01, 253.33it/s]warmup run: 370it [00:01, 389.16it/s]warmup run: 363it [00:02, 375.91it/s]warmup run: 1it [00:01,  1.46s/it]warmup run: 475it [00:02, 510.86it/s]warmup run: 467it [00:02, 496.84it/s]warmup run: 109it [00:01, 96.66it/s]warmup run: 569it [00:02, 598.73it/s]warmup run: 574it [00:02, 614.36it/s]warmup run: 212it [00:01, 201.67it/s]warmup run: 663it [00:02, 673.76it/s]warmup run: 680it [00:02, 714.78it/s]warmup run: 316it [00:01, 317.53it/s]warmup run: 758it [00:02, 740.61it/s]warmup run: 786it [00:02, 798.38it/s]warmup run: 418it [00:01, 433.39it/s]warmup run: 868it [00:02, 832.12it/s]warmup run: 893it [00:02, 868.53it/s]warmup run: 0it [00:00, ?it/s]warmup run: 515it [00:01, 535.25it/s]warmup run: 973it [00:02, 890.41it/s]warmup run: 997it [00:02, 911.86it/s]warmup run: 625it [00:02, 655.30it/s]warmup run: 1081it [00:02, 942.96it/s]warmup run: 1110it [00:02, 971.61it/s]warmup run: 729it [00:02, 744.90it/s]warmup run: 1187it [00:02, 976.14it/s]warmup run: 1217it [00:02, 999.33it/s]warmup run: 840it [00:02, 834.89it/s]warmup run: 1296it [00:02, 1007.65it/s]warmup run: 1324it [00:02, 1014.43it/s]warmup run: 947it [00:02, 895.64it/s]warmup run: 1405it [00:02, 1029.14it/s]warmup run: 1430it [00:03, 1022.45it/s]warmup run: 1054it [00:02, 942.01it/s]warmup run: 1514it [00:03, 1044.99it/s]warmup run: 1537it [00:03, 1034.78it/s]warmup run: 1160it [00:02, 968.10it/s]warmup run: 1623it [00:03, 1057.08it/s]warmup run: 1644it [00:03, 1044.57it/s]warmup run: 1265it [00:02, 987.58it/s]warmup run: 1731it [00:03, 1060.57it/s]warmup run: 1752it [00:03, 1051.96it/s]warmup run: 1371it [00:02, 1007.02it/s]warmup run: 1841it [00:03, 1071.71it/s]warmup run: 1859it [00:03, 1057.03it/s]warmup run: 1476it [00:02, 1009.07it/s]warmup run: 1950it [00:03, 1077.11it/s]warmup run: 1967it [00:03, 1063.27it/s]warmup run: 1582it [00:02, 1023.69it/s]warmup run: 2073it [00:03, 1122.68it/s]warmup run: 2089it [00:03, 1109.98it/s]warmup run: 1687it [00:03, 1029.95it/s]warmup run: 2210it [00:03, 1194.43it/s]warmup run: 2227it [00:03, 1190.52it/s]warmup run: 1794it [00:03, 1039.38it/s]warmup run: 2347it [00:03, 1244.65it/s]warmup run: 2366it [00:03, 1247.78it/s]warmup run: 1902it [00:03, 1049.39it/s]warmup run: 2484it [00:03, 1279.92it/s]warmup run: 2505it [00:03, 1288.23it/s]warmup run: 2011it [00:03, 1061.10it/s]warmup run: 2619it [00:03, 1300.73it/s]warmup run: 2643it [00:04, 1313.77it/s]warmup run: 1it [00:01,  1.49s/it]warmup run: 2145it [00:03, 1143.39it/s]warmup run: 2756it [00:04, 1319.01it/s]warmup run: 2782it [00:04, 1334.36it/s]warmup run: 107it [00:01, 93.42it/s]warmup run: 2279it [00:03, 1201.33it/s]warmup run: 2892it [00:04, 1330.99it/s]warmup run: 2916it [00:04, 1325.69it/s]warmup run: 215it [00:01, 202.92it/s]warmup run: 3000it [00:04, 698.90it/s] warmup run: 3000it [00:04, 703.45it/s] warmup run: 2413it [00:03, 1240.65it/s]warmup run: 318it [00:01, 315.97it/s]warmup run: 2547it [00:03, 1268.94it/s]warmup run: 425it [00:01, 438.87it/s]warmup run: 2680it [00:03, 1286.13it/s]warmup run: 532it [00:01, 557.77it/s]warmup run: 2811it [00:03, 1291.14it/s]warmup run: 639it [00:02, 665.62it/s]warmup run: 2945it [00:04, 1303.01it/s]warmup run: 3000it [00:04, 726.04it/s] warmup run: 746it [00:02, 758.14it/s]warmup run: 853it [00:02, 834.01it/s]warmup run: 960it [00:02, 895.47it/s]warmup run: 1068it [00:02, 945.70it/s]warmup run: 1178it [00:02, 986.50it/s]warmup run: 1285it [00:02, 1007.20it/s]warmup run: 1394it [00:02, 1030.38it/s]warmup run: 1502it [00:02, 1044.28it/s]warmup run: 1610it [00:02, 1051.14it/s]warmup run: 1718it [00:03, 1057.61it/s]warmup run: 1826it [00:03, 1062.82it/s]warmup run: 1934it [00:03, 1053.20it/s]warmup run: 2041it [00:03, 1026.35it/s]warmup run: 2151it [00:03, 1046.67it/s]warmup run: 2261it [00:03, 1061.16it/s]warmup run: 2373it [00:03, 1078.08it/s]warmup run: 2511it [00:03, 1165.13it/s]warmup run: 2643it [00:03, 1210.33it/s]warmup run: 2779it [00:04, 1253.21it/s]warmup run: 2909it [00:04, 1265.89it/s]warmup run: 3000it [00:04, 712.93it/s] 


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   5%|▌         | 158/3000 [00:00<00:01, 1575.37it/s]warmup should be done:   5%|▍         | 148/3000 [00:00<00:01, 1477.19it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1690.92it/s]warmup should be done:   5%|▌         | 164/3000 [00:00<00:01, 1631.56it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1717.53it/s]warmup should be done:  10%|█         | 314/3000 [00:00<00:01, 1581.00it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1749.60it/s]warmup should be done:  11%|█         | 316/3000 [00:00<00:01, 1537.62it/s]warmup should be done:  17%|█▋        | 521/3000 [00:00<00:01, 1746.78it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1772.55it/s]warmup should be done:  16%|█▌        | 473/3000 [00:00<00:01, 1560.01it/s]warmup should be done:  16%|█▌        | 485/3000 [00:00<00:01, 1599.98it/s]warmup should be done:  23%|██▎       | 702/3000 [00:00<00:01, 1769.37it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1790.66it/s]warmup should be done:  22%|██▏       | 654/3000 [00:00<00:01, 1654.64it/s]warmup should be done:  22%|██▏       | 646/3000 [00:00<00:01, 1580.25it/s]warmup should be done:  29%|██▉       | 882/3000 [00:00<00:01, 1778.70it/s]warmup should be done:  30%|██▉       | 893/3000 [00:00<00:01, 1793.43it/s]warmup should be done:  28%|██▊       | 833/3000 [00:00<00:01, 1701.80it/s]warmup should be done:  27%|██▋       | 812/3000 [00:00<00:01, 1606.05it/s]warmup should be done:  36%|███▌      | 1073/3000 [00:00<00:01, 1795.19it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1776.10it/s]warmup should be done:  33%|███▎      | 1004/3000 [00:00<00:01, 1699.06it/s]warmup should be done:  33%|███▎      | 977/3000 [00:00<00:01, 1619.98it/s]warmup should be done:  41%|████▏     | 1240/3000 [00:00<00:00, 1782.55it/s]warmup should be done:  42%|████▏     | 1253/3000 [00:00<00:00, 1786.39it/s]warmup should be done:  39%|███▉      | 1181/3000 [00:00<00:01, 1721.03it/s]warmup should be done:  38%|███▊      | 1142/3000 [00:00<00:01, 1627.72it/s]warmup should be done:  47%|████▋     | 1420/3000 [00:00<00:00, 1786.46it/s]warmup should be done:  48%|████▊     | 1434/3000 [00:00<00:00, 1792.50it/s]warmup should be done:  45%|████▌     | 1361/3000 [00:00<00:00, 1744.53it/s]warmup should be done:  44%|████▎     | 1308/3000 [00:00<00:01, 1635.57it/s]warmup should be done:  54%|█████▍    | 1614/3000 [00:00<00:00, 1790.05it/s]warmup should be done:  51%|█████▏    | 1540/3000 [00:00<00:00, 1755.72it/s]warmup should be done:  53%|█████▎    | 1599/3000 [00:00<00:00, 1762.66it/s]warmup should be done:  49%|████▉     | 1474/3000 [00:00<00:00, 1640.57it/s]warmup should be done:  60%|█████▉    | 1794/3000 [00:01<00:00, 1791.27it/s]warmup should be done:  57%|█████▋    | 1720/3000 [00:01<00:00, 1768.86it/s]warmup should be done:  59%|█████▉    | 1776/3000 [00:01<00:00, 1743.46it/s]warmup should be done:  55%|█████▍    | 1639/3000 [00:01<00:00, 1635.05it/s]warmup should be done:  66%|██████▌   | 1974/3000 [00:01<00:00, 1791.28it/s]warmup should be done:  63%|██████▎   | 1900/3000 [00:01<00:00, 1777.47it/s]warmup should be done:  60%|██████    | 1803/3000 [00:01<00:00, 1610.53it/s]warmup should be done:  65%|██████▌   | 1951/3000 [00:01<00:00, 1681.26it/s]warmup should be done:  72%|███████▏  | 2154/3000 [00:01<00:00, 1789.68it/s]warmup should be done:  69%|██████▉   | 2078/3000 [00:01<00:00, 1730.13it/s]warmup should be done:  66%|██████▌   | 1965/3000 [00:01<00:00, 1613.22it/s]warmup should be done:  71%|███████   | 2120/3000 [00:01<00:00, 1674.12it/s]warmup should be done:  78%|███████▊  | 2334/3000 [00:01<00:00, 1789.92it/s]warmup should be done:  71%|███████   | 2129/3000 [00:01<00:00, 1618.38it/s]warmup should be done:  76%|███████▋  | 2291/3000 [00:01<00:00, 1684.02it/s]warmup should be done:  75%|███████▌  | 2252/3000 [00:01<00:00, 1658.46it/s]warmup should be done:  84%|████████▍ | 2515/3000 [00:01<00:00, 1795.12it/s]warmup should be done:  76%|███████▋  | 2291/3000 [00:01<00:00, 1616.59it/s]warmup should be done:  82%|████████▏ | 2460/3000 [00:01<00:00, 1676.24it/s]warmup should be done:  81%|████████  | 2432/3000 [00:01<00:00, 1699.13it/s]warmup should be done:  90%|████████▉ | 2695/3000 [00:01<00:00, 1796.34it/s]warmup should be done:  82%|████████▏ | 2469/3000 [00:01<00:00, 1663.65it/s]warmup should be done:  88%|████████▊ | 2638/3000 [00:01<00:00, 1704.35it/s]warmup should be done:  87%|████████▋ | 2611/3000 [00:01<00:00, 1725.34it/s]warmup should be done:  96%|█████████▌| 2875/3000 [00:01<00:00, 1795.20it/s]warmup should be done:  88%|████████▊ | 2643/3000 [00:01<00:00, 1681.68it/s]warmup should be done:  94%|█████████▍| 2813/3000 [00:01<00:00, 1715.81it/s]warmup should be done:  93%|█████████▎| 2791/3000 [00:01<00:00, 1745.32it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1788.94it/s]warmup should be done: 100%|█████████▉| 2990/3000 [00:01<00:00, 1730.61it/s]warmup should be done:  99%|█████████▉| 2973/3000 [00:01<00:00, 1764.53it/s]warmup should be done:  94%|█████████▎| 2812/3000 [00:01<00:00, 1620.36it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1728.96it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1716.48it/s]warmup should be done: 100%|█████████▉| 2985/3000 [00:01<00:00, 1651.84it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1627.69it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1777.43it/s]warmup should be done:   5%|▌         | 155/3000 [00:00<00:01, 1543.03it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1803.69it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1696.83it/s]warmup should be done:  12%|█▏        | 365/3000 [00:00<00:01, 1822.89it/s]warmup should be done:  11%|█         | 321/3000 [00:00<00:01, 1608.77it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1832.70it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1753.52it/s]warmup should be done:  18%|█▊        | 553/3000 [00:00<00:01, 1849.04it/s]warmup should be done:  18%|█▊        | 551/3000 [00:00<00:01, 1838.08it/s]warmup should be done:  16%|█▌        | 485/3000 [00:00<00:01, 1621.66it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1774.83it/s]warmup should be done:  25%|██▍       | 737/3000 [00:00<00:01, 1845.34it/s]warmup should be done:  25%|██▍       | 740/3000 [00:00<00:01, 1854.13it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1793.98it/s]warmup should be done:  22%|██▏       | 648/3000 [00:00<00:01, 1599.22it/s]warmup should be done:  31%|███       | 923/3000 [00:00<00:01, 1849.96it/s]warmup should be done:  31%|███       | 927/3000 [00:00<00:01, 1856.61it/s]warmup should be done:  30%|██▉       | 897/3000 [00:00<00:01, 1806.32it/s]warmup should be done:  27%|██▋       | 818/3000 [00:00<00:01, 1625.05it/s]warmup should be done:  37%|███▋      | 1110/3000 [00:00<00:01, 1854.15it/s]warmup should be done:  37%|███▋      | 1114/3000 [00:00<00:01, 1858.82it/s]warmup should be done:  36%|███▌      | 1078/3000 [00:00<00:01, 1806.56it/s]warmup should be done:  33%|███▎      | 985/3000 [00:00<00:01, 1637.89it/s]warmup should be done:  43%|████▎     | 1296/3000 [00:00<00:00, 1853.73it/s]warmup should be done:  43%|████▎     | 1300/3000 [00:00<00:00, 1857.51it/s]warmup should be done:  42%|████▏     | 1259/3000 [00:00<00:00, 1801.89it/s]warmup should be done:  38%|███▊      | 1149/3000 [00:00<00:01, 1625.00it/s]warmup should be done:  49%|████▉     | 1483/3000 [00:00<00:00, 1857.07it/s]warmup should be done:  50%|████▉     | 1487/3000 [00:00<00:00, 1860.24it/s]warmup should be done:  48%|████▊     | 1441/3000 [00:00<00:00, 1807.49it/s]warmup should be done:  44%|████▍     | 1319/3000 [00:00<00:01, 1645.80it/s]warmup should be done:  56%|█████▌    | 1675/3000 [00:00<00:00, 1864.47it/s]warmup should be done:  56%|█████▌    | 1669/3000 [00:00<00:00, 1851.60it/s]warmup should be done:  54%|█████▍    | 1625/3000 [00:00<00:00, 1816.60it/s]warmup should be done:  50%|████▉     | 1487/3000 [00:00<00:00, 1655.28it/s]warmup should be done:  62%|██████▏   | 1863/3000 [00:01<00:00, 1867.91it/s]warmup should be done:  62%|██████▏   | 1855/3000 [00:01<00:00, 1853.39it/s]warmup should be done:  60%|██████    | 1807/3000 [00:01<00:00, 1805.65it/s]warmup should be done:  55%|█████▌    | 1658/3000 [00:01<00:00, 1670.50it/s]warmup should be done:  68%|██████▊   | 2050/3000 [00:01<00:00, 1868.39it/s]warmup should be done:  68%|██████▊   | 2041/3000 [00:01<00:00, 1848.27it/s]warmup should be done:  66%|██████▋   | 1989/3000 [00:01<00:00, 1808.57it/s]warmup should be done:  61%|██████    | 1830/3000 [00:01<00:00, 1682.63it/s]warmup should be done:  75%|███████▍  | 2237/3000 [00:01<00:00, 1867.17it/s]warmup should be done:  74%|███████▍  | 2227/3000 [00:01<00:00, 1849.50it/s]warmup should be done:  72%|███████▏  | 2171/3000 [00:01<00:00, 1810.45it/s]warmup should be done:  67%|██████▋   | 1999/3000 [00:01<00:00, 1678.77it/s]warmup should be done:  81%|████████  | 2424/3000 [00:01<00:00, 1866.74it/s]warmup should be done:  80%|████████  | 2412/3000 [00:01<00:00, 1844.96it/s]warmup should be done:  78%|███████▊  | 2354/3000 [00:01<00:00, 1813.54it/s]warmup should be done:  72%|███████▏  | 2167/3000 [00:01<00:00, 1668.47it/s]warmup should be done:  87%|████████▋ | 2611/3000 [00:01<00:00, 1867.37it/s]warmup should be done:  87%|████████▋ | 2598/3000 [00:01<00:00, 1847.45it/s]warmup should be done:  85%|████████▍ | 2536/3000 [00:01<00:00, 1815.08it/s]warmup should be done:  78%|███████▊  | 2336/3000 [00:01<00:00, 1674.50it/s]warmup should be done:  93%|█████████▎| 2799/3000 [00:01<00:00, 1870.29it/s]warmup should be done:  91%|█████████ | 2720/3000 [00:01<00:00, 1819.91it/s]warmup should be done:  93%|█████████▎| 2783/3000 [00:01<00:00, 1837.89it/s]warmup should be done:  83%|████████▎ | 2504/3000 [00:01<00:00, 1662.05it/s]warmup should be done: 100%|█████████▉| 2987/3000 [00:01<00:00, 1872.17it/s]warmup should be done:  97%|█████████▋| 2903/3000 [00:01<00:00, 1822.46it/s]warmup should be done:  99%|█████████▉| 2969/3000 [00:01<00:00, 1843.23it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1862.02it/s]warmup should be done:  89%|████████▉ | 2674/3000 [00:01<00:00, 1672.54it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1845.64it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1805.22it/s]warmup should be done:  95%|█████████▍| 2842/3000 [00:01<00:00, 1653.29it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1659.68it/s]2022-12-12 01:50:41.060873: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f4dfaa6b2c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:50:41.060969: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:50:41.675219: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f4dee267a40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:50:41.675276: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:50:41.715271: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f4dfaa68dd0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:50:41.715350: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:50:42.508910: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f4dfa2646b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:50:42.508979: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:50:43.334221: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:50:44.133846: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:50:44.456118: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:50:45.229249: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:50:45.414947: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:50:45.430513: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:50:45.731334: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:50:46.490559: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:50:46.535316: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:50:47.206541: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:50:48.379912: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:50:48.494298: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][01:51:14.045][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][01:51:14.045][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:51:14.050][ERROR][RK0][main]: coll ps creation done
[HCTR][01:51:14.050][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][01:51:14.225][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][01:51:14.225][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:51:14.229][ERROR][RK0][main]: coll ps creation done
[HCTR][01:51:14.229][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][01:51:14.331][ERROR][RK0][tid #139973151930112]: replica 2 reaches 1000, calling init pre replica
[HCTR][01:51:14.331][ERROR][RK0][tid #139973151930112]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:51:14.335][ERROR][RK0][tid #139973151930112]: coll ps creation done
[HCTR][01:51:14.335][ERROR][RK0][tid #139973151930112]: replica 2 waits for coll ps creation barrier
[HCTR][01:51:14.621][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][01:51:14.622][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:51:14.625][ERROR][RK0][main]: coll ps creation done
[HCTR][01:51:14.625][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][01:51:14.625][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][01:51:15.602][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][01:51:15.644][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][01:51:15.644][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][01:51:15.644][ERROR][RK0][tid #139973151930112]: replica 2 calling init per replica
[HCTR][01:51:15.644][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][01:51:15.644][ERROR][RK0][main]: Calling build_v2
[HCTR][01:51:15.644][ERROR][RK0][tid #139973151930112]: Calling build_v2
[HCTR][01:51:15.644][ERROR][RK0][main]: Calling build_v2
[HCTR][01:51:15.644][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:51:15.644][ERROR][RK0][tid #139973151930112]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:51:15.644][ERROR][RK0][main]: Calling build_v2
[HCTR][01:51:15.644][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:51:15.644][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[[2022-12-12 01:51:15.2022-12-12 01:51:156441922022-12-12 01:51:15.: .2022-12-12 01:51:15644192E644192.:  : 644197E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE:  : E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc :] :/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136using concurrent impl MPS136:] 
] 136using concurrent impl MPSusing concurrent impl MPS] 

using concurrent impl MPS
[2022-12-12 01:51:15.645475: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-12 01:51:15.645502: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[1962022-12-12 01:51:15] [.assigning 8 to cpu2022-12-12 01:51:15645526
.: 645531E[:  2022-12-12 01:51:15E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc. :645554/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc196: :] [E212assigning 8 to cpu2022-12-12 01:51:15 ] 
./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4645588:
: 196E]  assigning 8 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
[[:2022-12-12 01:51:152022-12-12 01:51:15212..] 645643645640build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: : 
E[E 2022-12-12 01:51:15 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:645663:2022-12-12 01:51:15213: 212.] E] 645692remote time is 8.68421 build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
E:[ 2122022-12-12 01:51:15[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] .2022-12-12 01:51:15:build symm link desc with 4X Tesla V100-SXM2-16GB out of 4645747.213
: 645755] E: remote time is 8.68421 E
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[ :2022-12-12 01:51:15/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214.[:] 6457972022-12-12 01:51:15213cpu time is 30: .] 
E645812remote time is 8.68421 : 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: [213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-12 01:51:15] :.remote time is 8.68421214645875
] : cpu time is 30E
[ 2022-12-12 01:51:15/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:645913214: ] Ecpu time is 30 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 01:51:38.524136: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 01:51:38.583332: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 01:51:38.583435: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 01:51:38.584945: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 01:51:38.675784: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 01:51:39. 43112: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 01:51:39. 43193: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 01:51:46.682127: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 01:51:46.682258: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 01:51:48.526611: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 01:51:48.526786: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 01:51:48.529792: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 01:51:48.529848: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 01:51:49.567061: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 01:51:49.586704: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 01:51:49.587583: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 01:51:49.597895: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 01:51:49.696072: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 01:51:54.546131: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 01:51:54.551076: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 01:51:54.551761: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 01:51:54.562571: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 01:51:54.562641: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 01:51:54.562675: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 01:51:54.562706: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 01:51:54.563794: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:51:54.563843: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:51:54.564694: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:51:54.565250: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:51:54.587258: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 01:51:54.587375: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 01:51:54.588249: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:51:54.588314: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:51:54.589184: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-12 01:51:54.5896612022-12-12 01:51:54: .E589648 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 202/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :2021 solved] 
2 solved
[[2022-12-12 01:51:542022-12-12 01:51:54[..2022-12-12 01:51:54589757589759.: : 589760EE:   E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu205205:] ] 1980worker 0 thread 1 initing device 1worker 0 thread 2 initing device 2] 

eager alloc mem 381.47 MB
[2022-12-12 01:51:54.590409: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:51:54.590461: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:51:54.590646: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:51:54.590701: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:51:54.591738: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:51:54.591778: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:51:54.592761: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-12 01:51:54eager alloc mem 381.47 MB.
592783: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:51:54.662984: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 01:51:54.664914: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 01:51:54.664971: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:51:54.665864: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 01:51:54.666508: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:51:54.667569: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:51:54.667623: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.03 MB
[[[2022-12-12 01:51:542022-12-12 01:51:542022-12-12 01:51:54...691128691128691128: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes


[[2022-12-12 01:51:54[2022-12-12 01:51:54.2022-12-12 01:51:54.693009.693013: 693016: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638:638] 638] eager release cuda mem 1021] eager release cuda mem 1021
eager release cuda mem 1021

[[[2022-12-12 01:51:542022-12-12 01:51:542022-12-12 01:51:54...693107693108693110: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:::638638638] ] ] eager release cuda mem 400000000eager release cuda mem 400000000eager release cuda mem 400000000


[2022-12-12 01:51:54.694059: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 01:51:54.694574: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 01:51:54.695050: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 01:51:54.695748: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:51:54.[6957922022-12-12 01:51:54: .E695799 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 611.00 KB1980
] eager alloc mem 611.00 KB
[2022-12-12 01:51:54.696775: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:51:54.696819: W [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc2022-12-12 01:51:54:.[436968292022-12-12 01:51:54] : .WORKER[0] alloc host memory 61.00 MBE696839
 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 625663638
] eager release cuda mem 625663
[2022-12-12 01:51:54.[6969062022-12-12 01:51:54: .W696911 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.ccW: 43/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc] :WORKER[0] alloc host memory 60.98 MB43
] WORKER[0] alloc host memory 61.01 MB
[2022-12-12 01:51:54.698788: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:51:54.699393: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:51:54.699440: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 01:51:54.726277: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:51:54.726890: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:51:54.726934: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 01:51:54.727784: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:51:54.727886: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:51:54.728364: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:51:54.728405: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 01:51:54.728466: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:51:54.728511: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[[[[2022-12-12 01:51:552022-12-12 01:51:552022-12-12 01:51:552022-12-12 01:51:55....450278450280450275450275: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 2 init p2p of link 3Device 3 init p2p of link 0Device 1 init p2p of link 2Device 0 init p2p of link 1



[2022-12-12 01:51:55.450549: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-12 01:51:55] .eager alloc mem 611.00 KB450565
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:51:55.450622: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:51:55.451341: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 611.00 KB2022-12-12 01:51:55
.451377[: 2022-12-12 01:51:55E. 451389/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :E638 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 625663:
638] eager release cuda mem 625663
[2022-12-12 01:51:55.451469: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:51:55.452316: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:51:55.458166: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 01:51:55.458264: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:51:55.458350: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] [Device 2 init p2p of link 02022-12-12 01:51:55
.458374: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-12 01:51:55.458453: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:51:55.458487: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:51:55.458658: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-12 01:51:55.458764: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:51:55.459067: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:51:55.459266: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-12 01:51:55eager release cuda mem 625663.
459284: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:51:55.459567: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:51:55.466366: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 01:51:55.466453: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:51:55.466637: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 01:51:55.466724: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:51:55.466748: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 01:51:55.466832: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-12 01:51:55eager alloc mem 611.00 KB.
466844: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 01:51:55.466948: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:51:55.467261: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:51:55.467525: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:51:55.467655: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:51:55.467745: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:51:55.473822: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 01:51:55.474134: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15991612 / 100000000 nodes ( 15.99 %~16.00 %) | remote 34432260 / 100000000 nodes ( 34.43 %) | cpu 49576128 / 100000000 nodes ( 49.58 %) | 7.63 GB | 0.885844 secs 
[2022-12-12 01:51:55.474226: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 01:51:55.474281: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 01:51:55.474330: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 01:51:55.474587: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15993695 / 100000000 nodes ( 15.99 %~16.00 %) | remote 34430177 / 100000000 nodes ( 34.43 %) | cpu 49576128 / 100000000 nodes ( 49.58 %) | 7.63 GB | 0.883901 secs 
[2022-12-12 01:51:55.474810: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15984249 / 100000000 nodes ( 15.98 %~16.00 %) | remote 34439623 / 100000000 nodes ( 34.44 %) | cpu 49576128 / 100000000 nodes ( 49.58 %) | 7.63 GB | 0.884365 secs 
[2022-12-12 01:51:55.474936: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15998729 / 100000000 nodes ( 16.00 %~16.00 %) | remote 34425143 / 100000000 nodes ( 34.43 %) | cpu 49576128 / 100000000 nodes ( 49.58 %) | 7.63 GB | 0.911101 secs 
[2022-12-12 01:51:55.475872: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.66 GB
[2022-12-12 01:51:56.651824: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.91 GB
[2022-12-12 01:51:56.652009: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.91 GB
[2022-12-12 01:51:56.652487: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.91 GB
[2022-12-12 01:51:57.273839: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.15 GB
[2022-12-12 01:51:57.274010: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.15 GB
[2022-12-12 01:51:57.274711: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.15 GB
[2022-12-12 01:51:58. 74523: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.40 GB
[2022-12-12 01:51:58. 74700: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.40 GB
[2022-12-12 01:51:58. 75053: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.40 GB
[2022-12-12 01:51:59. 38073: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.81 GB
[2022-12-12 01:51:59. 38599: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.81 GB
[2022-12-12 01:51:59. 39425: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.81 GB
[2022-12-12 01:51:59.769719: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.00 GB
[2022-12-12 01:51:59.769857: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.00 GB
[HCTR][01:51:59.824][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][01:51:59.824][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][01:51:59.824][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][01:51:59.824][ERROR][RK0][tid #139973151930112]: replica 2 calling init per replica done, doing barrier
[HCTR][01:51:59.825][ERROR][RK0][tid #139973151930112]: replica 2 calling init per replica done, doing barrier done
[HCTR][01:51:59.825][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][01:51:59.825][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][01:51:59.825][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][01:51:59.825][ERROR][RK0][tid #139973151930112]: init per replica done
[HCTR][01:51:59.825][ERROR][RK0][main]: init per replica done
[HCTR][01:51:59.825][ERROR][RK0][main]: init per replica done
[HCTR][01:51:59.828][ERROR][RK0][main]: init per replica done
[HCTR][01:51:59.832][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f3be7720000
[HCTR][01:51:59.832][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f4f7c600000
[HCTR][01:51:59.832][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f4f7cc40000
[HCTR][01:51:59.832][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f4f7cf60000
[HCTR][01:51:59.833][ERROR][RK0][tid #139973151930112]: 2 allocated 3276800 at 0x7f3be7720000
[HCTR][01:51:59.833][ERROR][RK0][tid #139973151930112]: 2 allocated 6553600 at 0x7f4f7a600000
[HCTR][01:51:59.833][ERROR][RK0][tid #139973151930112]: 2 allocated 3276800 at 0x7f4f7ac40000
[HCTR][01:51:59.833][ERROR][RK0][tid #139973151930112]: 2 allocated 6553600 at 0x7f4f7af60000
[HCTR][01:51:59.834][ERROR][RK0][tid #139973160322816]: 3 allocated 3276800 at 0x7f3be7720000
[HCTR][01:51:59.834][ERROR][RK0][tid #139973160322816]: 3 allocated 6553600 at 0x7f4f7c600000
[HCTR][01:51:59.834][ERROR][RK0][tid #139973160322816]: 3 allocated 3276800 at 0x7f4f7cc40000
[HCTR][01:51:59.834][ERROR][RK0][tid #139973160322816]: 3 allocated 6553600 at 0x7f4f7cf60000
[HCTR][01:51:59.837][ERROR][RK0][tid #139973151930112]: 0 allocated 3276800 at 0x7f3886720000
[HCTR][01:51:59.837][ERROR][RK0][tid #139973151930112]: 0 allocated 6553600 at 0x7f3886c00000
[HCTR][01:51:59.837][ERROR][RK0][tid #139973151930112]: 0 allocated 3276800 at 0x7f35f650e800
[HCTR][01:51:59.837][ERROR][RK0][tid #139973151930112]: 0 allocated 6553600 at 0x7f35f682e800




