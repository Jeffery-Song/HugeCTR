2022-12-11 19:44:54.638440: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:44:54.716942: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:44:54.717379: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:44:54.717519: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:44:55.509413: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:44:55.509492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 19:44:55.522783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 19:44:55.556672: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:44:55.556842: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:44:55.558452: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 19:44:55.576309: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:44:55.576377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 19:44:55.588585: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:44:55.588659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 19:44:55.589289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 19:44:55.590563: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:44:55.590624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 19:44:55.604087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 19:44:55.604195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 19:44:55.618816: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:44:55.618989: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:44:55.620325: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 19:44:55.632896: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:44:55.633055: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:44:55.634345: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 19:44:55.634921: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:44:55.635031: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:44:55.636219: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][19:44:56.885][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:44:56.885][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:44:56.895][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:44:56.904][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.61s/it]warmup run: 107it [00:01, 87.14it/s]warmup run: 216it [00:01, 191.87it/s]warmup run: 300it [00:01, 257.52it/s]warmup run: 411it [00:02, 382.83it/s]warmup run: 521it [00:02, 507.19it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 633it [00:02, 628.00it/s]warmup run: 108it [00:01, 94.96it/s]warmup run: 745it [00:02, 736.31it/s]warmup run: 217it [00:01, 206.22it/s]warmup run: 852it [00:02, 816.14it/s]warmup run: 322it [00:01, 322.39it/s]warmup run: 962it [00:02, 888.46it/s]warmup run: 429it [00:01, 444.77it/s]warmup run: 537it [00:01, 564.62it/s]warmup run: 1069it [00:02, 923.92it/s]warmup run: 649it [00:02, 681.96it/s]warmup run: 1182it [00:02, 979.84it/s]warmup run: 1it [00:01,  1.40s/it]warmup run: 761it [00:02, 783.63it/s]warmup run: 1294it [00:02, 1017.72it/s]warmup run: 104it [00:01, 95.82it/s]warmup run: 874it [00:02, 868.46it/s]warmup run: 1406it [00:02, 1046.96it/s]warmup run: 211it [00:01, 209.31it/s]warmup run: 985it [00:02, 929.71it/s]warmup run: 1517it [00:03, 1063.47it/s]warmup run: 319it [00:01, 333.16it/s]warmup run: 1099it [00:02, 985.74it/s]warmup run: 1629it [00:03, 1077.49it/s]warmup run: 425it [00:01, 455.84it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1740it [00:03, 1072.17it/s]warmup run: 1210it [00:02, 993.21it/s]warmup run: 527it [00:01, 564.91it/s]warmup run: 1853it [00:03, 1088.67it/s]warmup run: 1323it [00:02, 1030.33it/s]warmup run: 640it [00:02, 687.14it/s]warmup run: 1964it [00:03, 1093.27it/s]warmup run: 1438it [00:02, 1063.02it/s]warmup run: 756it [00:02, 797.63it/s]warmup run: 2086it [00:03, 1128.71it/s]warmup run: 1553it [00:02, 1086.12it/s]warmup run: 870it [00:02, 883.37it/s]warmup run: 2216it [00:03, 1177.76it/s]warmup run: 984it [00:02, 950.77it/s]warmup run: 1665it [00:03, 1072.83it/s]warmup run: 2345it [00:03, 1210.25it/s]warmup run: 1097it [00:02, 999.02it/s]warmup run: 1775it [00:03, 1068.62it/s]warmup run: 2480it [00:03, 1249.39it/s]warmup run: 1211it [00:02, 1037.27it/s]warmup run: 1884it [00:03, 1070.47it/s]warmup run: 2614it [00:03, 1274.36it/s]warmup run: 1326it [00:02, 1066.89it/s]warmup run: 1993it [00:03, 1066.07it/s]warmup run: 2748it [00:04, 1292.44it/s]warmup run: 1442it [00:02, 1091.87it/s]warmup run: 2120it [00:03, 1124.49it/s]warmup run: 2881it [00:04, 1302.08it/s]warmup run: 1557it [00:02, 1108.06it/s]warmup run: 2259it [00:03, 1200.16it/s]warmup run: 3000it [00:04, 701.79it/s] warmup run: 1672it [00:02, 1118.52it/s]warmup run: 2390it [00:03, 1229.95it/s]warmup run: 1788it [00:03, 1130.42it/s]warmup run: 2525it [00:03, 1265.48it/s]warmup run: 1903it [00:03, 1121.64it/s]warmup run: 2657it [00:03, 1279.07it/s]warmup run: 2017it [00:03, 1113.60it/s]warmup run: 2791it [00:03, 1294.44it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 2153it [00:03, 1183.92it/s]warmup run: 2926it [00:04, 1308.66it/s]warmup run: 3000it [00:04, 735.71it/s] warmup run: 105it [00:01, 93.58it/s]warmup run: 2287it [00:03, 1229.60it/s]warmup run: 211it [00:01, 202.94it/s]warmup run: 2423it [00:03, 1267.26it/s]warmup run: 318it [00:01, 323.29it/s]warmup run: 2559it [00:03, 1294.58it/s]warmup run: 424it [00:01, 445.12it/s]warmup run: 2697it [00:03, 1318.01it/s]warmup run: 531it [00:01, 564.01it/s]warmup run: 2832it [00:03, 1326.02it/s]warmup run: 639it [00:02, 674.06it/s]warmup run: 2966it [00:03, 1330.17it/s]warmup run: 3000it [00:03, 759.02it/s] warmup run: 747it [00:02, 767.54it/s]warmup run: 854it [00:02, 842.47it/s]warmup run: 961it [00:02, 901.84it/s]warmup run: 1070it [00:02, 951.44it/s]warmup run: 1178it [00:02, 987.30it/s]warmup run: 1285it [00:02, 1010.27it/s]warmup run: 1392it [00:02, 1022.37it/s]warmup run: 1501it [00:02, 1039.62it/s]warmup run: 1609it [00:02, 1050.50it/s]warmup run: 1717it [00:03, 1046.21it/s]warmup run: 1824it [00:03, 1040.73it/s]warmup run: 1932it [00:03, 1049.75it/s]warmup run: 2049it [00:03, 1083.87it/s]warmup run: 2185it [00:03, 1164.74it/s]warmup run: 2321it [00:03, 1221.73it/s]warmup run: 2456it [00:03, 1259.87it/s]warmup run: 2591it [00:03, 1285.27it/s]warmup run: 2726it [00:03, 1303.48it/s]warmup run: 2860it [00:03, 1311.77it/s]warmup run: 2995it [00:04, 1322.21it/s]warmup run: 3000it [00:04, 734.16it/s] 


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1758.48it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1679.10it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1725.22it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1617.09it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1773.78it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1748.31it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1772.43it/s]warmup should be done:  11%|█▏        | 343/3000 [00:00<00:01, 1725.71it/s]warmup should be done:  18%|█▊        | 526/3000 [00:00<00:01, 1762.38it/s]warmup should be done:  17%|█▋        | 522/3000 [00:00<00:01, 1754.53it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1776.47it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1618.08it/s]warmup should be done:  24%|██▎       | 705/3000 [00:00<00:01, 1770.98it/s]warmup should be done:  23%|██▎       | 701/3000 [00:00<00:01, 1768.46it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1784.16it/s]warmup should be done:  23%|██▎       | 697/3000 [00:00<00:01, 1585.61it/s]warmup should be done:  29%|██▉       | 883/3000 [00:00<00:01, 1772.80it/s]warmup should be done:  29%|██▉       | 879/3000 [00:00<00:01, 1771.85it/s]warmup should be done:  30%|██▉       | 892/3000 [00:00<00:01, 1783.94it/s]warmup should be done:  29%|██▉       | 871/3000 [00:00<00:01, 1636.67it/s]warmup should be done:  35%|███▌      | 1057/3000 [00:00<00:01, 1773.82it/s]warmup should be done:  35%|███▌      | 1061/3000 [00:00<00:01, 1752.14it/s]warmup should be done:  36%|███▌      | 1071/3000 [00:00<00:01, 1763.79it/s]warmup should be done:  35%|███▍      | 1047/3000 [00:00<00:01, 1676.32it/s]warmup should be done:  41%|████      | 1235/3000 [00:00<00:00, 1773.18it/s]warmup should be done:  42%|████▏     | 1249/3000 [00:00<00:00, 1766.62it/s]warmup should be done:  41%|████      | 1237/3000 [00:00<00:01, 1745.42it/s]warmup should be done:  41%|████      | 1216/3000 [00:00<00:01, 1678.35it/s]warmup should be done:  47%|████▋     | 1414/3000 [00:00<00:00, 1775.35it/s]warmup should be done:  48%|████▊     | 1427/3000 [00:00<00:00, 1770.34it/s]warmup should be done:  47%|████▋     | 1412/3000 [00:00<00:00, 1743.30it/s]warmup should be done:  46%|████▋     | 1388/3000 [00:00<00:00, 1690.25it/s]warmup should be done:  53%|█████▎    | 1593/3000 [00:00<00:00, 1776.84it/s]warmup should be done:  54%|█████▎    | 1605/3000 [00:00<00:00, 1772.22it/s]warmup should be done:  53%|█████▎    | 1587/3000 [00:00<00:00, 1742.69it/s]warmup should be done:  52%|█████▏    | 1558/3000 [00:00<00:00, 1685.56it/s]warmup should be done:  59%|█████▉    | 1772/3000 [00:01<00:00, 1777.99it/s]warmup should be done:  59%|█████▉    | 1783/3000 [00:01<00:00, 1771.68it/s]warmup should be done:  59%|█████▊    | 1762/3000 [00:01<00:00, 1741.65it/s]warmup should be done:  58%|█████▊    | 1731/3000 [00:01<00:00, 1696.68it/s]warmup should be done:  65%|██████▌   | 1950/3000 [00:01<00:00, 1774.52it/s]warmup should be done:  65%|██████▌   | 1962/3000 [00:01<00:00, 1776.78it/s]warmup should be done:  65%|██████▍   | 1937/3000 [00:01<00:00, 1740.84it/s]warmup should be done:  63%|██████▎   | 1901/3000 [00:01<00:00, 1695.73it/s]warmup should be done:  71%|███████   | 2129/3000 [00:01<00:00, 1776.63it/s]warmup should be done:  71%|███████▏  | 2140/3000 [00:01<00:00, 1768.38it/s]warmup should be done:  70%|███████   | 2115/3000 [00:01<00:00, 1751.85it/s]warmup should be done:  69%|██████▉   | 2074/3000 [00:01<00:00, 1704.33it/s]warmup should be done:  77%|███████▋  | 2307/3000 [00:01<00:00, 1777.23it/s]warmup should be done:  76%|███████▋  | 2294/3000 [00:01<00:00, 1760.70it/s]warmup should be done:  77%|███████▋  | 2317/3000 [00:01<00:00, 1760.59it/s]warmup should be done:  75%|███████▌  | 2250/3000 [00:01<00:00, 1718.93it/s]warmup should be done:  83%|████████▎ | 2486/3000 [00:01<00:00, 1780.02it/s]warmup should be done:  82%|████████▏ | 2473/3000 [00:01<00:00, 1766.89it/s]warmup should be done:  83%|████████▎ | 2495/3000 [00:01<00:00, 1765.46it/s]warmup should be done:  81%|████████  | 2425/3000 [00:01<00:00, 1725.58it/s]warmup should be done:  89%|████████▉ | 2665/3000 [00:01<00:00, 1780.64it/s]warmup should be done:  88%|████████▊ | 2653/3000 [00:01<00:00, 1775.22it/s]warmup should be done:  89%|████████▉ | 2675/3000 [00:01<00:00, 1774.91it/s]warmup should be done:  87%|████████▋ | 2604/3000 [00:01<00:00, 1744.54it/s]warmup should be done:  95%|█████████▍| 2844/3000 [00:01<00:00, 1783.26it/s]warmup should be done:  94%|█████████▍| 2834/3000 [00:01<00:00, 1782.67it/s]warmup should be done:  95%|█████████▌| 2853/3000 [00:01<00:00, 1737.60it/s]warmup should be done:  93%|█████████▎| 2781/3000 [00:01<00:00, 1749.88it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1770.78it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1763.07it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1761.82it/s]warmup should be done:  99%|█████████▊| 2961/3000 [00:01<00:00, 1764.71it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1708.33it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1771.22it/s]warmup should be done:   5%|▌         | 158/3000 [00:00<00:01, 1574.02it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1669.66it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1751.50it/s]warmup should be done:  11%|█         | 336/3000 [00:00<00:01, 1690.59it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1807.32it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1760.69it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1810.95it/s]warmup should be done:  17%|█▋        | 519/3000 [00:00<00:01, 1752.30it/s]warmup should be done:  18%|█▊        | 546/3000 [00:00<00:01, 1820.47it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1794.55it/s]warmup should be done:  18%|█▊        | 548/3000 [00:00<00:01, 1830.62it/s]warmup should be done:  24%|██▍       | 730/3000 [00:00<00:01, 1826.99it/s]warmup should be done:  23%|██▎       | 702/3000 [00:00<00:01, 1781.12it/s]warmup should be done:  24%|██▍       | 734/3000 [00:00<00:01, 1839.97it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1774.16it/s]warmup should be done:  30%|██▉       | 885/3000 [00:00<00:01, 1798.20it/s]warmup should be done:  30%|███       | 914/3000 [00:00<00:01, 1829.28it/s]warmup should be done:  31%|███       | 920/3000 [00:00<00:01, 1845.14it/s]warmup should be done:  30%|██▉       | 892/3000 [00:00<00:01, 1735.76it/s]warmup should be done:  36%|███▌      | 1068/3000 [00:00<00:01, 1808.24it/s]warmup should be done:  37%|███▋      | 1098/3000 [00:00<00:01, 1831.63it/s]warmup should be done:  37%|███▋      | 1106/3000 [00:00<00:01, 1847.15it/s]warmup should be done:  36%|███▌      | 1066/3000 [00:00<00:01, 1711.55it/s]warmup should be done:  42%|████▏     | 1250/3000 [00:00<00:00, 1810.35it/s]warmup should be done:  43%|████▎     | 1291/3000 [00:00<00:00, 1843.17it/s]warmup should be done:  43%|████▎     | 1282/3000 [00:00<00:00, 1817.28it/s]warmup should be done:  41%|████▏     | 1244/3000 [00:00<00:01, 1731.81it/s]warmup should be done:  48%|████▊     | 1434/3000 [00:00<00:00, 1818.19it/s]warmup should be done:  49%|████▉     | 1476/3000 [00:00<00:00, 1845.11it/s]warmup should be done:  49%|████▉     | 1464/3000 [00:00<00:00, 1782.24it/s]warmup should be done:  48%|████▊     | 1425/3000 [00:00<00:00, 1754.19it/s]warmup should be done:  54%|█████▍    | 1618/3000 [00:00<00:00, 1822.40it/s]warmup should be done:  55%|█████▌    | 1662/3000 [00:00<00:00, 1847.92it/s]warmup should be done:  55%|█████▍    | 1647/3000 [00:00<00:00, 1794.46it/s]warmup should be done:  54%|█████▎    | 1609/3000 [00:00<00:00, 1779.00it/s]warmup should be done:  60%|██████    | 1801/3000 [00:01<00:00, 1824.12it/s]warmup should be done:  62%|██████▏   | 1848/3000 [00:01<00:00, 1849.34it/s]warmup should be done:  61%|██████    | 1831/3000 [00:01<00:00, 1807.72it/s]warmup should be done:  60%|█████▉    | 1792/3000 [00:01<00:00, 1794.02it/s]warmup should be done:  66%|██████▌   | 1984/3000 [00:01<00:00, 1823.38it/s]warmup should be done:  68%|██████▊   | 2034/3000 [00:01<00:00, 1850.58it/s]warmup should be done:  67%|██████▋   | 2014/3000 [00:01<00:00, 1813.31it/s]warmup should be done:  66%|██████▌   | 1976/3000 [00:01<00:00, 1805.70it/s]warmup should be done:  72%|███████▏  | 2167/3000 [00:01<00:00, 1825.10it/s]warmup should be done:  74%|███████▍  | 2220/3000 [00:01<00:00, 1850.01it/s]warmup should be done:  73%|███████▎  | 2198/3000 [00:01<00:00, 1819.26it/s]warmup should be done:  72%|███████▏  | 2160/3000 [00:01<00:00, 1813.24it/s]warmup should be done:  78%|███████▊  | 2350/3000 [00:01<00:00, 1826.05it/s]warmup should be done:  80%|████████  | 2406/3000 [00:01<00:00, 1851.45it/s]warmup should be done:  79%|███████▉  | 2382/3000 [00:01<00:00, 1823.43it/s]warmup should be done:  78%|███████▊  | 2344/3000 [00:01<00:00, 1821.18it/s]warmup should be done:  84%|████████▍ | 2533/3000 [00:01<00:00, 1824.56it/s]warmup should be done:  86%|████████▋ | 2592/3000 [00:01<00:00, 1852.42it/s]warmup should be done:  86%|████████▌ | 2566/3000 [00:01<00:00, 1827.15it/s]warmup should be done:  84%|████████▍ | 2528/3000 [00:01<00:00, 1825.64it/s]warmup should be done:  93%|█████████▎| 2778/3000 [00:01<00:00, 1853.75it/s]warmup should be done:  91%|█████████ | 2716/3000 [00:01<00:00, 1807.60it/s]warmup should be done:  92%|█████████▏| 2750/3000 [00:01<00:00, 1828.77it/s]warmup should be done:  90%|█████████ | 2712/3000 [00:01<00:00, 1828.93it/s]warmup should be done:  99%|█████████▉| 2964/3000 [00:01<00:00, 1854.44it/s]warmup should be done:  97%|█████████▋| 2897/3000 [00:01<00:00, 1799.34it/s]warmup should be done:  98%|█████████▊| 2933/3000 [00:01<00:00, 1827.06it/s]warmup should be done:  97%|█████████▋| 2896/3000 [00:01<00:00, 1830.86it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1845.46it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1817.63it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1801.18it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1791.41it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f8793597340>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f8793597160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f8793596190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f8793597220>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 19:46:09.698196: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f836d2666b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:46:09.698264: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:46:09.705405: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:46:10.712433: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:46:11.412210: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f836d267450 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:46:11.412310: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:46:11.418059: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f836d264c50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:46:11.418106: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:46:11.426131: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:46:11.428904: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:46:11.475117: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f836da6a800 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:46:11.475176: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:46:11.482333: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:46:12.123715: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:46:12.227529: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:46:12.294191: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:46:16.344162: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:46:17.416838: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:46:17.531126: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:46:18.624347: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][19:47:25.262][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][19:47:25.262][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:47:25.267][ERROR][RK0][main]: coll ps creation done
[HCTR][19:47:25.267][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][19:47:25.318][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][19:47:25.318][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:47:25.322][ERROR][RK0][main]: coll ps creation done
[HCTR][19:47:25.322][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][19:47:25.471][ERROR][RK0][tid #140202613921536]: replica 0 reaches 1000, calling init pre replica
[HCTR][19:47:25.471][ERROR][RK0][tid #140202613921536]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:47:25.476][ERROR][RK0][tid #140202613921536]: coll ps creation done
[HCTR][19:47:25.476][ERROR][RK0][tid #140202613921536]: replica 0 waits for coll ps creation barrier
[HCTR][19:47:25.577][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][19:47:25.577][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:47:25.582][ERROR][RK0][main]: coll ps creation done
[HCTR][19:47:25.582][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][19:47:25.582][ERROR][RK0][tid #140202613921536]: replica 0 preparing frequency
[HCTR][19:47:26.531][ERROR][RK0][tid #140202613921536]: replica 0 preparing frequency done
[HCTR][19:47:26.566][ERROR][RK0][tid #140202613921536]: replica 0 calling init per replica
[HCTR][19:47:26.566][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][19:47:26.566][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][19:47:26.566][ERROR][RK0][tid #140202613921536]: Calling build_v2
[HCTR][19:47:26.566][ERROR][RK0][main]: Calling build_v2
[HCTR][19:47:26.566][ERROR][RK0][tid #140202613921536]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:47:26.566][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:47:26.566][ERROR][RK0][main]: Calling build_v2
[HCTR][19:47:26.566][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:47:26.566][ERROR][RK0][main]: replica 3 calling init per replica
[[2022-12-11 19:47:26.[HCTR][19:47:26.566][ERROR][RK0][main]: Calling build_v2
5661502022-12-11 19:47:26[: .E5661632022-12-11 19:47:26 : ./hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE566170: [HCTR][19:47:26.566][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
: 136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE] : using concurrent impl MPS136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc
] :using concurrent impl MPS136
] using concurrent impl MPS
[2022-12-11 19:47:26.566417: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 19:47:26.567470: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 19:47:26.567528: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 19:47:26.567571: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 19:47:26213.] 567579remote time is 8.68421: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 19:47:26196.] 567617assigning 8 to cpu: [
E2022-12-11 19:47:26 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc567634:: 214E]  [cpu time is 30/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 19:47:26
:.196567676] : assigning 8 to cpuE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 19:47:26212[.] 2022-12-11 19:47:26567738build symm link desc with 4X Tesla V100-SXM2-16GB out of 4.: 
567768E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc [:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 19:47:26196:.] 212567837assigning 8 to cpu] : 
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421[
2022-12-11 19:47:26.567933: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 19:47:26:.213567951] : remote time is 8.68421E
[ [2022-12-11 19:47:26/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 19:47:26.:.567954214568008: ] : Ecpu time is 30E 
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::212214] ] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4cpu time is 30

[2022-12-11 19:47:26.568149: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 19:47:26.568222: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 19:47:52.645267: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 19:47:52.710150: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 19:47:52.710259: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 19:47:52.711334: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 19:47:52.801302: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 19:47:53.170378: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 19:47:53.170465: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 19:48:01.142445: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1022
[2022-12-11 19:48:01.142560: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 19:48:02.866911: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 19:48:02.867024: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1022
[2022-12-11 19:48:02.873100: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 19:48:02.873168: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1022 blocks, 4 devices
[2022-12-11 19:48:03.985235: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 19:48:04.  1226: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 19:48:04.  1977: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 19:48:04. 11886: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 19:48:04.107881: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 19:48:05.170406: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 19:48:05.174117: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 19:48:05.174247: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 19:48:05.183142: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 19:48:05.183216: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 19:48:05.183255: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 19:48:05.183288: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 19:48:05.185214: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:48:05.185265: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:48:05.186198: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:48:05.186873: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:48:05.205801: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 19:48:05.205988: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 19:48:05.207619: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 19:48:05.207723: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 19:48:05.209465: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:48:05.209537: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:48:05.210409: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:48:05.210561: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:48:05.210662: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:48:05.212033: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:48:05.212258: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:48:05.213535: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:48:05.214063: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 19:48:05.214152: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 19:48:05.214964: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:48:05.215018: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:48:05.215831: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:48:05.216459: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:48:05.295196: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1022.00 Bytes
[2022-12-11 19:48:05.297086: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1022
[2022-12-11 19:48:05.297140: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:48:05.298045: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:48:05.298503: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:48:05.299475: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[[2022-12-11 19:48:052022-12-11 19:48:05..300870300870: : EE [ /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 19:48:05/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:.:19803009371980] : ] eager alloc mem 1022.00 BytesEeager alloc mem 1022.00 Bytes
 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:48:05.301641: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:48:05.301686: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 491.62 MB
[[2022-12-11 19:48:052022-12-11 19:48:05..302770302774: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 1022eager release cuda mem 1022

[[2022-12-11 19:48:052022-12-11 19:48:05..302846302848: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 400000000eager release cuda mem 400000000

[2022-12-11 19:48:05.303720: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:48:05.304211: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:48:05.304656: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:48:05.304702: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:48:05.305568: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:48:05.305614: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:48:05.307382: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:48:05.308026: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:48:05.308068: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 493.01 MB
[2022-12-11 19:48:05.308191: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:48:05.308839: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:48:05.308880: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 492.93 MB
[2022-12-11 19:48:05.320517: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1022.00 Bytes
[2022-12-11 19:48:05.322369: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1022
[2022-12-11 19:48:05.322418: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:48:05.323221: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:48:05.324657: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:48:05.325562: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:48:05.327784: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:48:05.328452: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:48:05.328495: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 493.16 MB
[[[2022-12-11 19:48:05[2022-12-11 19:48:052022-12-11 19:48:05.2022-12-11 19:48:05..371942.371942371944: 371955: : E: EE E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::1926:19261926] 1926] ] Device 3 init p2p of link 0] Device 0 init p2p of link 1Device 2 init p2p of link 3
Device 1 init p2p of link 2


[2022-12-11 19:48:05.372235[: [2022-12-11 19:48:05E[2022-12-11 19:48:05. 2022-12-11 19:48:05.372243/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.372250: :372254: E1980: E ] E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980:1980] 1980] eager alloc mem 611.00 KB] eager alloc mem 611.00 KB
eager alloc mem 611.00 KB

[2022-12-11 19:48:05[.2022-12-11 19:48:05373137.: 373139E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :[/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[6382022-12-11 19:48:05:2022-12-11 19:48:05] .638.eager release cuda mem 625663373184] 373191
: eager release cuda mem 625663: E
E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 625663eager release cuda mem 625663

[2022-12-11 19:48:05.375309: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] [Device 3 init p2p of link 12022-12-11 19:48:05
.375338: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 19:48:05.375392: E[ [2022-12-11 19:48:05/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 19:48:05.[:.3754052022-12-11 19:48:051926375420: .] : E375433Device 1 init p2p of link 3E : 
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :1926/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980] :] Device 0 init p2p of link 21980eager alloc mem 611.00 KB[
] 
2022-12-11 19:48:05eager alloc mem 611.00 KB.
375549: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:48:05.375611: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:48:05.376330: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 19:48:05[:.2022-12-11 19:48:05638376345.] : 376353eager release cuda mem 625663E: 
 E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc [:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 19:48:05638:.] 638376416eager release cuda mem 625663] : 
eager release cuda mem 625663E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:48:05.378263: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 19:48:05.378342: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:48:05.378544: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 19:48:05:.1926378561] : Device 3 init p2p of link 2E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 19:48:05.378659[: 2022-12-11 19:48:05E. 378676/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1980 [] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 19:48:05eager alloc mem 611.00 KB:.
1980378714] : eager alloc mem 611.00 KBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 19:48:05.378841: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:48:05.379104: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:48:05.379537: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:48:05.379565: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:48:05.379638: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:48:05.379968: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:48:05.380940: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 999675 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2996360 / 100000000 nodes ( 3.00 %) | cpu 96003965 / 100000000 nodes ( 96.00 %) | 493.01 MB | 0.171427 secs 
[2022-12-11 19:48:05.381808: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:[6382022-12-11 19:48:05] .eager release cuda mem 4399996381828
: E[ 2022-12-11 19:48:05/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:381865638: ] Eeager release cuda mem 4399996 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:48:05.382523: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 999527 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2996508 / 100000000 nodes ( 3.00 %) | cpu 96003965 / 100000000 nodes ( 96.00 %) | 492.93 MB | 0.167521 secs 
[2022-12-11 19:48:05.382967: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1000000 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2996035 / 100000000 nodes ( 3.00 %) | cpu 96003965 / 100000000 nodes ( 96.00 %) | 493.16 MB | 0.172343 secs 
[2022-12-11 19:48:05.383359: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 996833 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2999202 / 100000000 nodes ( 3.00 %) | cpu 96003965 / 100000000 nodes ( 96.00 %) | 491.62 MB | 0.198101 secs 
[2022-12-11 19:48:05.383920: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.18 GB
[2022-12-11 19:48:06.312307: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.42 GB
[2022-12-11 19:48:06.312460: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.42 GB
[2022-12-11 19:48:06.312901: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.42 GB
[2022-12-11 19:48:07.142941: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.67 GB
[2022-12-11 19:48:07.143064: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.67 GB
[2022-12-11 19:48:07.143402: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.67 GB
[2022-12-11 19:48:07.978599: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.92 GB
[2022-12-11 19:48:07.978736: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.92 GB
[2022-12-11 19:48:07.979068: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.92 GB
[2022-12-11 19:48:08.915736: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.32 GB
[2022-12-11 19:48:08.915975: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.32 GB
[2022-12-11 19:48:08.916308: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.32 GB
[2022-12-11 19:48:09.788779: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.52 GB
[2022-12-11 19:48:09.788934: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.52 GB
[HCTR][19:48:10.053][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][19:48:10.053][ERROR][RK0][tid #140202613921536]: replica 0 calling init per replica done, doing barrier
[HCTR][19:48:10.053][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][19:48:10.053][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][19:48:10.053][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][19:48:10.053][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][19:48:10.053][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][19:48:10.053][ERROR][RK0][tid #140202613921536]: replica 0 calling init per replica done, doing barrier done
[HCTR][19:48:10.053][ERROR][RK0][main]: init per replica done
[HCTR][19:48:10.053][ERROR][RK0][main]: init per replica done
[HCTR][19:48:10.053][ERROR][RK0][main]: init per replica done
[HCTR][19:48:10.056][ERROR][RK0][tid #140202613921536]: init per replica done
[HCTR][19:48:10.088][ERROR][RK0][tid #140202622314240]: 2 allocated 3276800 at 0x7f6a88238400
[HCTR][19:48:10.088][ERROR][RK0][tid #140202622314240]: 2 allocated 6553600 at 0x7f6a88558400
[HCTR][19:48:10.088][ERROR][RK0][tid #140202622314240]: 2 allocated 3276800 at 0x7f6a88b98400
[HCTR][19:48:10.088][ERROR][RK0][tid #140202622314240]: 2 allocated 6553600 at 0x7f6a88eb8400
[HCTR][19:48:10.092][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f6a54238400
[HCTR][19:48:10.092][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f6a54558400
[HCTR][19:48:10.092][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f6a54b98400
[HCTR][19:48:10.092][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f6a54eb8400
[HCTR][19:48:10.093][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f697c238400
[HCTR][19:48:10.093][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f697c558400
[HCTR][19:48:10.093][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f697cb98400
[HCTR][19:48:10.093][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f697ceb8400
[HCTR][19:48:10.095][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f6968320000
[HCTR][19:48:10.095][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f6968640000
[HCTR][19:48:10.095][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f6968c80000
[HCTR][19:48:10.095][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f6968fa0000
