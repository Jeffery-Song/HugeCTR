2022-12-12 01:31:09.139150: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:31:09.214358: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:31:09.218707: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:31:09.219476: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:31:10.064331: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:31:10.064407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:31:10.076834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:31:10.110444: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:31:10.110602: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:31:10.112170: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 01:31:10.149397: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:31:10.149477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:31:10.161879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:31:10.191094: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:31:10.191252: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:31:10.191553: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:31:10.191634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:31:10.192096: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 01:31:10.192972: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:31:10.193072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:31:10.203935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:31:10.208944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:31:10.234747: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:31:10.234913: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:31:10.235767: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 01:31:10.237271: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:31:10.237378: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:31:10.238612: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][01:31:10.457][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:31:10.493][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:31:11.482][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:31:11.511][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 105it [00:01, 94.69it/s]warmup run: 212it [00:01, 206.26it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 320it [00:01, 328.82it/s]warmup run: 103it [00:01, 93.40it/s]warmup run: 425it [00:01, 448.71it/s]warmup run: 208it [00:01, 203.25it/s]warmup run: 531it [00:01, 566.19it/s]warmup run: 313it [00:01, 322.28it/s]warmup run: 639it [00:02, 676.28it/s]warmup run: 409it [00:01, 428.60it/s]warmup run: 742it [00:02, 748.05it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 516it [00:01, 551.67it/s]warmup run: 853it [00:02, 836.66it/s]warmup run: 98it [00:01, 88.25it/s]warmup run: 625it [00:02, 667.31it/s]warmup run: 959it [00:02, 893.66it/s]warmup run: 198it [00:01, 192.37it/s]warmup run: 729it [00:02, 754.86it/s]warmup run: 1064it [00:02, 929.17it/s]warmup run: 295it [00:01, 301.15it/s]warmup run: 833it [00:02, 826.32it/s]warmup run: 1168it [00:02, 952.90it/s]warmup run: 394it [00:01, 415.50it/s]warmup run: 942it [00:02, 894.54it/s]warmup run: 1271it [00:02, 954.89it/s]warmup run: 497it [00:01, 533.17it/s]warmup run: 1047it [00:02, 923.01it/s]warmup run: 1378it [00:02, 984.99it/s]warmup run: 597it [00:02, 631.70it/s]warmup run: 1150it [00:02, 926.46it/s]warmup run: 1485it [00:02, 1007.38it/s]warmup run: 698it [00:02, 719.46it/s]warmup run: 1255it [00:02, 959.66it/s]warmup run: 1589it [00:02, 1007.01it/s]warmup run: 800it [00:02, 793.18it/s]warmup run: 1357it [00:02, 973.60it/s]warmup run: 1693it [00:03, 1014.08it/s]warmup run: 899it [00:02, 837.90it/s]warmup run: 1459it [00:02, 976.79it/s]warmup run: 1797it [00:03, 1021.18it/s]warmup run: 997it [00:02, 875.76it/s]warmup run: 1566it [00:02, 1001.46it/s]warmup run: 1903it [00:03, 1030.50it/s]warmup run: 1096it [00:02, 907.27it/s]warmup run: 1674it [00:03, 1021.62it/s]warmup run: 2010it [00:03, 1040.55it/s]warmup run: 1195it [00:02, 930.06it/s]warmup run: 1779it [00:03, 1027.16it/s]warmup run: 2141it [00:03, 1118.69it/s]warmup run: 1294it [00:02, 942.71it/s]warmup run: 1884it [00:03, 1032.72it/s]warmup run: 2272it [00:03, 1174.36it/s]warmup run: 1395it [00:02, 961.59it/s]warmup run: 1it [00:01,  1.49s/it]warmup run: 1989it [00:03, 1037.35it/s]warmup run: 2399it [00:03, 1202.19it/s]warmup run: 1495it [00:02, 972.18it/s]warmup run: 101it [00:01, 88.05it/s]warmup run: 2117it [00:03, 1109.29it/s]warmup run: 2528it [00:03, 1227.31it/s]warmup run: 1595it [00:03, 969.93it/s]warmup run: 204it [00:01, 192.57it/s]warmup run: 2251it [00:03, 1175.90it/s]warmup run: 2658it [00:03, 1246.20it/s]warmup run: 1694it [00:03, 975.41it/s]warmup run: 310it [00:01, 311.21it/s]warmup run: 2384it [00:03, 1220.93it/s]warmup run: 2786it [00:03, 1254.77it/s]warmup run: 1795it [00:03, 983.29it/s]warmup run: 417it [00:01, 434.96it/s]warmup run: 2517it [00:03, 1252.19it/s]warmup run: 2915it [00:04, 1263.42it/s]warmup run: 1896it [00:03, 989.37it/s]warmup run: 3000it [00:04, 724.28it/s] warmup run: 522it [00:01, 551.07it/s]warmup run: 2649it [00:03, 1271.70it/s]warmup run: 1997it [00:03, 995.08it/s]warmup run: 627it [00:02, 656.81it/s]warmup run: 2782it [00:03, 1286.73it/s]warmup run: 2130it [00:03, 1093.06it/s]warmup run: 734it [00:02, 752.11it/s]warmup run: 2916it [00:04, 1301.33it/s]warmup run: 2266it [00:03, 1170.36it/s]warmup run: 3000it [00:04, 726.42it/s] warmup run: 837it [00:02, 811.81it/s]warmup run: 2401it [00:03, 1223.85it/s]warmup run: 939it [00:02, 862.80it/s]warmup run: 2536it [00:03, 1261.46it/s]warmup run: 1043it [00:02, 910.02it/s]warmup run: 2671it [00:03, 1287.74it/s]warmup run: 1145it [00:02, 927.23it/s]warmup run: 2805it [00:04, 1302.46it/s]warmup run: 1246it [00:02, 947.60it/s]warmup run: 2940it [00:04, 1316.21it/s]warmup run: 3000it [00:04, 712.71it/s] warmup run: 1352it [00:02, 978.29it/s]warmup run: 1456it [00:02, 995.45it/s]warmup run: 1561it [00:03, 1008.77it/s]warmup run: 1665it [00:03, 1015.09it/s]warmup run: 1773it [00:03, 1032.20it/s]warmup run: 1880it [00:03, 1041.74it/s]warmup run: 1985it [00:03, 988.62it/s] warmup run: 2090it [00:03, 1005.74it/s]warmup run: 2226it [00:03, 1108.37it/s]warmup run: 2362it [00:03, 1181.76it/s]warmup run: 2497it [00:03, 1229.03it/s]warmup run: 2634it [00:03, 1268.27it/s]warmup run: 2763it [00:04, 1274.40it/s]warmup run: 2899it [00:04, 1298.75it/s]warmup run: 3000it [00:04, 712.12it/s] 

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1715.75it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1701.81it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1645.41it/s]warmup should be done:   5%|▌         | 158/3000 [00:00<00:01, 1564.06it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1752.23it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1737.45it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1713.98it/s]warmup should be done:  11%|█         | 322/3000 [00:00<00:01, 1605.82it/s]warmup should be done:  18%|█▊        | 529/3000 [00:00<00:01, 1766.82it/s]warmup should be done:  18%|█▊        | 525/3000 [00:00<00:01, 1750.23it/s]warmup should be done:  17%|█▋        | 517/3000 [00:00<00:01, 1728.97it/s]warmup should be done:  17%|█▋        | 501/3000 [00:00<00:01, 1686.25it/s]warmup should be done:  23%|██▎       | 701/3000 [00:00<00:01, 1752.48it/s]warmup should be done:  23%|██▎       | 694/3000 [00:00<00:01, 1742.33it/s]warmup should be done:  23%|██▎       | 680/3000 [00:00<00:01, 1725.09it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1734.21it/s]warmup should be done:  29%|██▉       | 878/3000 [00:00<00:01, 1757.99it/s]warmup should be done:  29%|██▊       | 859/3000 [00:00<00:01, 1745.28it/s]warmup should be done:  29%|██▉       | 869/3000 [00:00<00:01, 1733.98it/s]warmup should be done:  29%|██▉       | 880/3000 [00:00<00:01, 1709.88it/s]warmup should be done:  35%|███▌      | 1055/3000 [00:00<00:01, 1760.89it/s]warmup should be done:  35%|███▍      | 1045/3000 [00:00<00:01, 1740.22it/s]warmup should be done:  35%|███▌      | 1052/3000 [00:00<00:01, 1684.90it/s]warmup should be done:  34%|███▍      | 1034/3000 [00:00<00:01, 1668.90it/s]warmup should be done:  41%|████      | 1222/3000 [00:00<00:01, 1747.98it/s]warmup should be done:  41%|████      | 1232/3000 [00:00<00:01, 1701.97it/s]warmup should be done:  41%|████      | 1227/3000 [00:00<00:01, 1705.22it/s]warmup should be done:  40%|████      | 1209/3000 [00:00<00:01, 1694.01it/s]warmup should be done:  47%|████▋     | 1400/3000 [00:00<00:00, 1756.67it/s]warmup should be done:  47%|████▋     | 1409/3000 [00:00<00:00, 1720.65it/s]warmup should be done:  46%|████▌     | 1386/3000 [00:00<00:00, 1715.97it/s]warmup should be done:  47%|████▋     | 1398/3000 [00:00<00:00, 1700.05it/s]warmup should be done:  53%|█████▎    | 1578/3000 [00:00<00:00, 1763.17it/s]warmup should be done:  52%|█████▏    | 1562/3000 [00:00<00:00, 1729.13it/s]warmup should be done:  53%|█████▎    | 1582/3000 [00:00<00:00, 1672.37it/s]warmup should be done:  52%|█████▏    | 1569/3000 [00:00<00:00, 1663.05it/s]warmup should be done:  59%|█████▊    | 1756/3000 [00:01<00:00, 1766.21it/s]warmup should be done:  59%|█████▊    | 1759/3000 [00:01<00:00, 1700.33it/s]warmup should be done:  58%|█████▊    | 1741/3000 [00:01<00:00, 1677.59it/s]warmup should be done:  58%|█████▊    | 1736/3000 [00:01<00:00, 1646.88it/s]warmup should be done:  64%|██████▍   | 1934/3000 [00:01<00:00, 1767.80it/s]warmup should be done:  65%|██████▍   | 1937/3000 [00:01<00:00, 1721.64it/s]warmup should be done:  64%|██████▍   | 1915/3000 [00:01<00:00, 1693.54it/s]warmup should be done:  64%|██████▎   | 1909/3000 [00:01<00:00, 1669.23it/s]warmup should be done:  70%|███████   | 2111/3000 [00:01<00:00, 1767.44it/s]warmup should be done:  70%|███████   | 2114/3000 [00:01<00:00, 1735.01it/s]warmup should be done:  70%|██████▉   | 2085/3000 [00:01<00:00, 1691.04it/s]warmup should be done:  70%|██████▉   | 2088/3000 [00:01<00:00, 1704.32it/s]warmup should be done:  76%|███████▋  | 2288/3000 [00:01<00:00, 1767.57it/s]warmup should be done:  76%|███████▋  | 2288/3000 [00:01<00:00, 1736.36it/s]warmup should be done:  75%|███████▌  | 2258/3000 [00:01<00:00, 1699.84it/s]warmup should be done:  76%|███████▌  | 2265/3000 [00:01<00:00, 1723.09it/s]warmup should be done:  82%|████████▏ | 2466/3000 [00:01<00:00, 1769.39it/s]warmup should be done:  82%|████████▏ | 2462/3000 [00:01<00:00, 1736.65it/s]warmup should be done:  81%|████████  | 2429/3000 [00:01<00:00, 1687.28it/s]warmup should be done:  82%|████████▏ | 2445/3000 [00:01<00:00, 1743.41it/s]warmup should be done:  88%|████████▊ | 2644/3000 [00:01<00:00, 1769.40it/s]warmup should be done:  88%|████████▊ | 2636/3000 [00:01<00:00, 1737.15it/s]warmup should be done:  87%|████████▋ | 2602/3000 [00:01<00:00, 1698.64it/s]warmup should be done:  87%|████████▋ | 2620/3000 [00:01<00:00, 1742.41it/s]warmup should be done:  94%|█████████▍| 2823/3000 [00:01<00:00, 1772.83it/s]warmup should be done:  94%|█████████▎| 2810/3000 [00:01<00:00, 1687.71it/s]warmup should be done:  93%|█████████▎| 2800/3000 [00:01<00:00, 1758.53it/s]warmup should be done:  92%|█████████▏| 2772/3000 [00:01<00:00, 1620.68it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1758.29it/s]warmup should be done:  99%|█████████▉| 2980/3000 [00:01<00:00, 1768.55it/s]warmup should be done:  99%|█████████▉| 2980/3000 [00:01<00:00, 1678.83it/s]warmup should be done:  98%|█████████▊| 2949/3000 [00:01<00:00, 1661.49it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1716.59it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1711.04it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1689.12it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1744.13it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1765.43it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1774.13it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1685.29it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1783.89it/s]warmup should be done:  12%|█▏        | 363/3000 [00:00<00:01, 1814.82it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1760.31it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1780.73it/s]warmup should be done:  18%|█▊        | 550/3000 [00:00<00:01, 1837.26it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1792.45it/s]warmup should be done:  18%|█▊        | 542/3000 [00:00<00:01, 1808.58it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1703.43it/s]warmup should be done:  25%|██▍       | 739/3000 [00:00<00:01, 1855.32it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1799.92it/s]warmup should be done:  24%|██▍       | 723/3000 [00:00<00:01, 1790.56it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1758.57it/s]warmup should be done:  31%|███       | 929/3000 [00:00<00:01, 1868.53it/s]warmup should be done:  30%|███       | 902/3000 [00:00<00:01, 1804.91it/s]warmup should be done:  30%|███       | 906/3000 [00:00<00:01, 1803.78it/s]warmup should be done:  30%|██▉       | 899/3000 [00:00<00:01, 1791.50it/s]warmup should be done:  37%|███▋      | 1118/3000 [00:00<00:01, 1875.27it/s]warmup should be done:  36%|███▌      | 1083/3000 [00:00<00:01, 1803.62it/s]warmup should be done:  36%|███▋      | 1089/3000 [00:00<00:01, 1809.55it/s]warmup should be done:  36%|███▌      | 1084/3000 [00:00<00:01, 1808.83it/s]warmup should be done:  44%|████▎     | 1306/3000 [00:00<00:00, 1865.07it/s]warmup should be done:  42%|████▏     | 1270/3000 [00:00<00:00, 1803.34it/s]warmup should be done:  42%|████▏     | 1264/3000 [00:00<00:00, 1786.70it/s]warmup should be done:  42%|████▏     | 1266/3000 [00:00<00:00, 1800.51it/s]warmup should be done:  50%|████▉     | 1493/3000 [00:00<00:00, 1858.56it/s]warmup should be done:  48%|████▊     | 1452/3000 [00:00<00:00, 1808.55it/s]warmup should be done:  48%|████▊     | 1443/3000 [00:00<00:00, 1782.58it/s]warmup should be done:  48%|████▊     | 1447/3000 [00:00<00:00, 1801.46it/s]warmup should be done:  56%|█████▌    | 1679/3000 [00:00<00:00, 1853.03it/s]warmup should be done:  54%|█████▍    | 1622/3000 [00:00<00:00, 1768.29it/s]warmup should be done:  54%|█████▍    | 1628/3000 [00:00<00:00, 1800.27it/s]warmup should be done:  54%|█████▍    | 1633/3000 [00:00<00:00, 1731.63it/s]warmup should be done:  62%|██████▏   | 1865/3000 [00:01<00:00, 1848.72it/s]warmup should be done:  60%|██████    | 1800/3000 [00:01<00:00, 1768.92it/s]warmup should be done:  60%|██████    | 1809/3000 [00:01<00:00, 1798.75it/s]warmup should be done:  61%|██████    | 1816/3000 [00:01<00:00, 1760.45it/s]warmup should be done:  68%|██████▊   | 2050/3000 [00:01<00:00, 1845.80it/s]warmup should be done:  66%|██████▌   | 1977/3000 [00:01<00:00, 1768.40it/s]warmup should be done:  66%|██████▋   | 1993/3000 [00:01<00:00, 1808.44it/s]warmup should be done:  67%|██████▋   | 2000/3000 [00:01<00:00, 1781.69it/s]warmup should be done:  74%|███████▍  | 2235/3000 [00:01<00:00, 1846.44it/s]warmup should be done:  72%|███████▏  | 2155/3000 [00:01<00:00, 1769.77it/s]warmup should be done:  73%|███████▎  | 2178/3000 [00:01<00:00, 1820.09it/s]warmup should be done:  73%|███████▎  | 2184/3000 [00:01<00:00, 1796.88it/s]warmup should be done:  81%|████████  | 2420/3000 [00:01<00:00, 1844.64it/s]warmup should be done:  78%|███████▊  | 2333/3000 [00:01<00:00, 1771.37it/s]warmup should be done:  79%|███████▊  | 2361/3000 [00:01<00:00, 1805.68it/s]warmup should be done:  79%|███████▉  | 2368/3000 [00:01<00:00, 1808.34it/s]warmup should be done:  87%|████████▋ | 2605/3000 [00:01<00:00, 1841.64it/s]warmup should be done:  84%|████████▎ | 2511/3000 [00:01<00:00, 1771.41it/s]warmup should be done:  85%|████████▍ | 2542/3000 [00:01<00:00, 1802.63it/s]warmup should be done:  85%|████████▌ | 2552/3000 [00:01<00:00, 1815.89it/s]warmup should be done:  93%|█████████▎| 2790/3000 [00:01<00:00, 1841.96it/s]warmup should be done:  90%|████████▉ | 2689/3000 [00:01<00:00, 1770.33it/s]warmup should be done:  91%|█████████ | 2728/3000 [00:01<00:00, 1816.90it/s]warmup should be done:  91%|█████████ | 2736/3000 [00:01<00:00, 1820.83it/s]warmup should be done:  99%|█████████▉| 2975/3000 [00:01<00:00, 1842.28it/s]warmup should be done:  96%|█████████▌| 2867/3000 [00:01<00:00, 1769.98it/s]warmup should be done:  97%|█████████▋| 2911/3000 [00:01<00:00, 1818.32it/s]warmup should be done:  97%|█████████▋| 2920/3000 [00:01<00:00, 1825.00it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1847.00it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1799.18it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1789.34it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1774.31it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f116411c190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f116411d040>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f116411d160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f116411c280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-12 01:32:20.457800: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0d39a64e60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:32:20.457882: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:32:20.463529: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0d31267ac0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:32:20.463576: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:32:20.464251: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0d31267660 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:32:20.464300: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:32:20.466265: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f0d3126b170 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:32:20.466302: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:32:20.468194: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:32:20.473113: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:32:20.474453: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:32:20.478178: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:32:21.135144: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:32:21.148152: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:32:21.149572: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:32:21.170190: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:32:27.209893: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:32:27.279578: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:32:27.386685: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:32:27.460041: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][01:33:20.682][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][01:33:20.683][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:33:20.687][ERROR][RK0][main]: coll ps creation done
[HCTR][01:33:20.687][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][01:33:20.853][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][01:33:20.854][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:33:20.858][ERROR][RK0][main]: coll ps creation done
[HCTR][01:33:20.858][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][01:33:21.037][ERROR][RK0][tid #139694943758080]: replica 1 reaches 1000, calling init pre replica
[HCTR][01:33:21.037][ERROR][RK0][tid #139694943758080]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:33:21.040][ERROR][RK0][tid #139694943758080]: coll ps creation done
[HCTR][01:33:21.040][ERROR][RK0][tid #139694943758080]: replica 1 waits for coll ps creation barrier
[HCTR][01:33:21.081][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][01:33:21.081][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:33:21.085][ERROR][RK0][main]: coll ps creation done
[HCTR][01:33:21.085][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][01:33:21.085][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][01:33:22.475][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][01:33:22.516][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][01:33:22.516][ERROR][RK0][tid #139694943758080]: replica 1 calling init per replica
[HCTR][01:33:22.516][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][01:33:22.516][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][01:33:22.516][ERROR][RK0][main]: Calling build_v2
[HCTR][01:33:22.516][ERROR][RK0][tid #139694943758080]: Calling build_v2
[HCTR][01:33:22.516][ERROR][RK0][main]: Calling build_v2
[HCTR][01:33:22.516][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:33:22.516][ERROR][RK0][tid #139694943758080]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:33:22.516][ERROR][RK0][main]: Calling build_v2
[HCTR][01:33:22.516][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:33:22.516][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-12 01:33:22.2022-12-12 01:33:22516379.2022-12-12 01:33:22: 516379.[E: 516391 E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc E2022-12-12 01:33:22:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc .136:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc516406] 136:: using concurrent impl MPSPhase] 136E
using concurrent impl MPSPhase]  
using concurrent impl MPSPhase/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc
:136] using concurrent impl MPSPhase
[2022-12-12 01:33:22.517566: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-12 01:33:22.517589: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-12 01:33:22.[5176152022-12-12 01:33:22: .E517620 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE[: 2022-12-12 01:33:22196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[.] :2022-12-12 01:33:22517641assigning 8 to cpu212.: 
] 517654Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4:  
E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc196:] [212assigning 8 to cpu2022-12-12 01:33:22] 
.build symm link desc with 4X Tesla V100-SXM2-16GB out of 4517729
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2132022-12-12 01:33:22[] .2022-12-12 01:33:22remote time is 8.68421517759.
: 517767E: [[ E2022-12-12 01:33:222022-12-12 01:33:22/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc ..:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc517774517792212:: : ] 213EEbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4]   
remote time is 8.68421/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
::[212214[2022-12-12 01:33:22] ] 2022-12-12 01:33:22.build symm link desc with 4X Tesla V100-SXM2-16GB out of 4cpu time is 30.517862

517866: : EE  [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-12 01:33:22::.213214517905] ] : remote time is 8.68421cpu time is 30E

 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-12 01:33:22213.] 517955remote time is 8.68421: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214[] 2022-12-12 01:33:22cpu time is 30.
517987: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 01:33:48.527490: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 01:33:48.590075: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 01:33:48.590173: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 01:33:48.591247: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 01:33:48.686825: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 01:33:49. 64369: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 01:33:49. 64456: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 01:33:56.631739: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 01:33:56.631871: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 01:33:58.439972: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 01:33:58.440084: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 01:33:58.449030: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 01:33:58.449086: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 01:33:58.478281: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 01:33:58.491483: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 01:33:58.492503: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 01:33:58.503285: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 01:33:58.599241: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 01:33:58.602034: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-12 01:33:58.604533: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-12 01:33:58.606958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-12 01:33:58.609365: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-12 01:34:01.377682: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 01:34:01.383341: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 01:34:01.383897: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 01:34:01.394169: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 01:34:01.394240: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 01:34:01.394272: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 01:34:01.394302: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 01:34:01.395990: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:34:01.396038: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:34:01.396934: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:34:01.397475: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[[2022-12-12 01:34:012022-12-12 01:34:01.2022-12-12 01:34:01.425944.425945: 425962: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202:202] 2021 solved] ] 
2 solved3 solved

[2022-12-12 01:34:01.426086[: [2022-12-12 01:34:01E2022-12-12 01:34:01. .426093/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc426093: :: E205E ]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccworker 0 thread 1 initing device 1/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:
:205205] ] worker 0 thread 2 initing device 2worker 0 thread 3 initing device 3

[[2022-12-12 01:34:012022-12-12 01:34:01..426789426789: : EE [ /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-12 01:34:01/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:.:18154268161815] : ] Building Coll Cache with ... num gpu device is 4EBuilding Coll Cache with ... num gpu device is 4
 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[[2022-12-12 01:34:012022-12-12 01:34:01.[.4268812022-12-12 01:34:01426883: .: E426889E :  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980] :] eager alloc mem 381.47 MB1980eager alloc mem 381.47 MB
] 
eager alloc mem 381.47 MB
[2022-12-12 01:34:01.428711: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:34:01.428742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:34:01.428795: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:34:01.430194: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:34:01.430221: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:34:01.430251: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:34:01.485873: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 01:34:01.487737: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 01:34:01.487791: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:34:01.488592: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:34:01.489052: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:34:01.489996: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:34:01.490039: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.32 MB
[2022-12-12 01:34:01.516352: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:34:01.516938: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:34:01.516982: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.67 GB
[[[2022-12-12 01:34:012022-12-12 01:34:012022-12-12 01:34:01...523403523403523403: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes


[[[2022-12-12 01:34:012022-12-12 01:34:012022-12-12 01:34:01...525313525315525315: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:::638638638] ] ] eager release cuda mem 1021eager release cuda mem 1021eager release cuda mem 1021


[[[2022-12-12 01:34:012022-12-12 01:34:012022-12-12 01:34:01...525409525411525411: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:::638638638] ] ] eager release cuda mem 400000000eager release cuda mem 400000000eager release cuda mem 400000000


[2022-12-12 01:34:01.535885: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:34:01.537032: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:34:01.538289: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:34:01.539711: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:34:01.539803[: 2022-12-12 01:34:01E. 539831/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1980 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB:
1980] eager alloc mem 611.00 KB
[2022-12-12 01:34:01.540803: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:34:01.540907: W[ 2022-12-12 01:34:01/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc.[:5409342022-12-12 01:34:0143: .] E540964WORKER[0] alloc host memory 53.40 MB : 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 625663638
] eager release cuda mem 625663
[2022-12-12 01:34:01.541133: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:[432022-12-12 01:34:01] .WORKER[0] alloc host memory 53.39 MB541160
: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.34 MB
[2022-12-12 01:34:01.567501: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:34:01.567682: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:34:01.568091: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:34:01.568136: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.67 GB
[2022-12-12 01:34:01.568285: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:34:01.568330: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[2022-12-12 01:34:01.568381: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:34:01.568956: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:34:01.568996: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[[[[2022-12-12 01:34:022022-12-12 01:34:022022-12-12 01:34:022022-12-12 01:34:02....206099206098206101206116: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 0 init p2p of link 1Device 3 init p2p of link 0Device 1 init p2p of link 2Device 2 init p2p of link 3



[2022-12-12 01:34:02.206459: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-12 01:34:021980.] [206489eager alloc mem 611.00 KB2022-12-12 01:34:02: 
.E206508 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 611.00 KB1980
] eager alloc mem 611.00 KB
[2022-12-12 01:34:02.206926: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:34:02.207336: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:34:02.207372: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:34:02.207407: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:34:02.207748: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:34:02.221286: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 01:34:02.221428: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:34:02.221576: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 01:34:02[.2022-12-12 01:34:02221691.: 221708E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1926:] 1926Device 1 init p2p of link 3] [
Device 0 init p2p of link 22022-12-12 01:34:02
.221766: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:34:02.221882: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 611.00 KB2022-12-12 01:34:02
.221909: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:34:02.222267: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:34:02.222677: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:2022-12-12 01:34:02638.] 222710eager release cuda mem 625663: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:34:02.222763: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:34:02.229792: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 01:34:02.229901: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:34:02.230272: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 01:34:02.230303: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 01:34:02.230364: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:34:02.230389: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:34:02.230541: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 01:34:02.230644: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:34:02.230714: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:34:02.231171: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-12 01:34:02eager release cuda mem 625663.
231189: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:34:02.231455: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:34:02.237046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:34:02.237356: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13998309 / 100000000 nodes ( 14.00 %~14.00 %) | remote 34925523 / 100000000 nodes ( 34.93 %) | cpu 51076168 / 100000000 nodes ( 51.08 %) | 6.68 GB | 0.810488 secs 
[2022-12-12 01:34:02.237526: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:34:02.237763: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:34:02.237814: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13977213 / 100000000 nodes ( 13.98 %~14.00 %) | remote 34946619 / 100000000 nodes ( 34.95 %) | cpu 51076168 / 100000000 nodes ( 51.08 %) | 6.67 GB | 0.841783 secs 
[2022-12-12 01:34:02.237920: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:34:02.238066: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13982971 / 100000000 nodes ( 13.98 %~14.00 %) | remote 34940861 / 100000000 nodes ( 34.94 %) | cpu 51076168 / 100000000 nodes ( 51.08 %) | 6.67 GB | 0.811203 secs 
[2022-12-12 01:34:02.238312: E[ /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-12 01:34:02:.1955] 238280Asymm Coll cache (policy: coll_cache_asymm_link) | local 13996420 / 100000000 nodes ( 14.00 %~14.00 %) | remote 34927412 / 100000000 nodes ( 34.93 %) | cpu 51076168 / 100000000 nodes ( 51.08 %) | 6.68 GB | 0.811434 secs : 
W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 13.37 GB
[2022-12-12 01:34:03.187670: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 13.61 GB
[2022-12-12 01:34:03.187803: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 13.61 GB
[2022-12-12 01:34:03.188356: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 13.61 GB
[2022-12-12 01:34:03.952860: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 13.86 GB
[2022-12-12 01:34:03.952983: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 13.86 GB
[2022-12-12 01:34:03.953281: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 13.86 GB
[2022-12-12 01:34:04.756355: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.11 GB
[2022-12-12 01:34:04.756480: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.11 GB
[2022-12-12 01:34:04.756786: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 14.11 GB
[2022-12-12 01:34:04.757018: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 14.11 GB
[2022-12-12 01:34:04.757211: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 14.11 GB
[2022-12-12 01:34:05.519428: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.30 GB
[2022-12-12 01:34:05.519552: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.30 GB
[HCTR][01:34:05.771][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][01:34:05.771][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][01:34:05.771][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][01:34:05.771][ERROR][RK0][tid #139694943758080]: replica 1 calling init per replica done, doing barrier
[HCTR][01:34:05.771][ERROR][RK0][tid #139694943758080]: replica 1 calling init per replica done, doing barrier done
[HCTR][01:34:05.771][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][01:34:05.771][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][01:34:05.771][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][01:34:05.771][ERROR][RK0][tid #139694943758080]: init per replica done
[HCTR][01:34:05.771][ERROR][RK0][main]: init per replica done
[HCTR][01:34:05.771][ERROR][RK0][main]: init per replica done
[HCTR][01:34:05.806][ERROR][RK0][tid #139694943758080]: 2 allocated 3276800 at 0x7ef1b8238400
[HCTR][01:34:05.806][ERROR][RK0][tid #139694943758080]: 2 allocated 6553600 at 0x7ef1b8558400
[HCTR][01:34:05.806][ERROR][RK0][tid #139694943758080]: 2 allocated 3276800 at 0x7ef1b8b98400
[HCTR][01:34:05.806][ERROR][RK0][tid #139694943758080]: 2 allocated 6553600 at 0x7ef1b8eb8400
[HCTR][01:34:05.807][ERROR][RK0][main]: 3 allocated 3276800 at 0x7ef1c8238400
[HCTR][01:34:05.807][ERROR][RK0][main]: 3 allocated 6553600 at 0x7ef1c8558400
[HCTR][01:34:05.807][ERROR][RK0][main]: 1 allocated 3276800 at 0x7ef1d8238400
[HCTR][01:34:05.807][ERROR][RK0][main]: 3 allocated 3276800 at 0x7ef1c8b98400
[HCTR][01:34:05.807][ERROR][RK0][main]: 3 allocated 6553600 at 0x7ef1c8eb8400
[HCTR][01:34:05.807][ERROR][RK0][main]: 1 allocated 6553600 at 0x7ef1d8558400
[HCTR][01:34:05.807][ERROR][RK0][main]: 1 allocated 3276800 at 0x7ef1d8b98400
[HCTR][01:34:05.807][ERROR][RK0][main]: 1 allocated 6553600 at 0x7ef1d8eb8400
[HCTR][01:34:05.812][ERROR][RK0][main]: init per replica done
[HCTR][01:34:05.849][ERROR][RK0][main]: 0 allocated 3276800 at 0x7ef1e4320000
[HCTR][01:34:05.849][ERROR][RK0][main]: 0 allocated 6553600 at 0x7ef1e4640000
[HCTR][01:34:05.849][ERROR][RK0][main]: 0 allocated 3276800 at 0x7ef1e4c80000
[HCTR][01:34:05.849][ERROR][RK0][main]: 0 allocated 6553600 at 0x7ef1e4fa0000
