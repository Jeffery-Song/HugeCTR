2022-12-11 20:35:42.014127: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:35:42.085616: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:35:42.089104: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:35:42.090334: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:35:42.856808: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:35:42.856895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 20:35:42.869732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 20:35:42.903235: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:35:42.903400: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:35:42.905288: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 20:35:42.932361: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:35:42.932440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 20:35:42.934795: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:35:42.934860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 20:35:42.937655: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:35:42.937712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 20:35:42.945096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 20:35:42.948130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 20:35:42.950193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 20:35:42.975083: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:35:42.975246: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:35:42.977171: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 20:35:42.977714: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:35:42.977819: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:35:42.979304: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 20:35:42.981148: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:35:42.981255: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:35:42.982053: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][20:35:44.205][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:35:44.219][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:35:44.251][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:35:44.251][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 100it [00:01, 90.07it/s]warmup run: 1it [00:01,  1.46s/it]warmup run: 206it [00:01, 200.80it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 102it [00:01, 90.51it/s]warmup run: 313it [00:01, 322.40it/s]warmup run: 106it [00:01, 95.87it/s]warmup run: 195it [00:01, 185.11it/s]warmup run: 418it [00:01, 443.76it/s]warmup run: 211it [00:01, 205.27it/s]warmup run: 306it [00:01, 313.22it/s]warmup run: 525it [00:01, 563.73it/s]warmup run: 318it [00:01, 326.57it/s]warmup run: 411it [00:01, 434.68it/s]warmup run: 632it [00:02, 672.27it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 424it [00:01, 448.64it/s]warmup run: 517it [00:01, 553.36it/s]warmup run: 739it [00:02, 765.16it/s]warmup run: 109it [00:01, 97.82it/s]warmup run: 530it [00:01, 566.20it/s]warmup run: 620it [00:02, 655.15it/s]warmup run: 843it [00:02, 833.40it/s]warmup run: 216it [00:01, 208.37it/s]warmup run: 636it [00:02, 671.94it/s]warmup run: 720it [00:02, 733.07it/s]warmup run: 952it [00:02, 900.94it/s]warmup run: 323it [00:01, 328.55it/s]warmup run: 744it [00:02, 767.59it/s]warmup run: 820it [00:02, 797.03it/s]warmup run: 1061it [00:02, 952.10it/s]warmup run: 430it [00:01, 451.34it/s]warmup run: 851it [00:02, 842.86it/s]warmup run: 921it [00:02, 851.51it/s]warmup run: 1170it [00:02, 988.72it/s]warmup run: 538it [00:01, 571.30it/s]warmup run: 957it [00:02, 898.49it/s]warmup run: 1026it [00:02, 904.02it/s]warmup run: 1278it [00:02, 1012.85it/s]warmup run: 646it [00:02, 679.93it/s]warmup run: 1063it [00:02, 941.59it/s]warmup run: 1137it [00:02, 959.95it/s]warmup run: 1386it [00:02, 1030.87it/s]warmup run: 754it [00:02, 773.42it/s]warmup run: 1171it [00:02, 979.67it/s]warmup run: 1241it [00:02, 968.17it/s]warmup run: 1495it [00:02, 1046.26it/s]warmup run: 863it [00:02, 851.01it/s]warmup run: 1279it [00:02, 1007.17it/s]warmup run: 1347it [00:02, 993.42it/s]warmup run: 1603it [00:02, 1048.81it/s]warmup run: 971it [00:02, 909.96it/s]warmup run: 1386it [00:02, 1023.28it/s]warmup run: 1451it [00:02, 1006.32it/s]warmup run: 1710it [00:03, 1052.08it/s]warmup run: 1080it [00:02, 957.94it/s]warmup run: 1496it [00:02, 1043.18it/s]warmup run: 1560it [00:02, 1028.66it/s]warmup run: 1819it [00:03, 1062.81it/s]warmup run: 1187it [00:02, 987.86it/s]warmup run: 1606it [00:02, 1059.25it/s]warmup run: 1665it [00:03, 1030.04it/s]warmup run: 1928it [00:03, 1070.07it/s]warmup run: 1297it [00:02, 1018.81it/s]warmup run: 1714it [00:03, 1056.97it/s]warmup run: 1773it [00:03, 1044.16it/s]warmup run: 2047it [00:03, 1104.19it/s]warmup run: 1408it [00:02, 1043.54it/s]warmup run: 1822it [00:03, 1058.81it/s]warmup run: 1880it [00:03, 1051.66it/s]warmup run: 2181it [00:03, 1172.64it/s]warmup run: 1518it [00:02, 1059.73it/s]warmup run: 1929it [00:03, 1040.58it/s]warmup run: 1986it [00:03, 1042.81it/s]warmup run: 2315it [00:03, 1222.06it/s]warmup run: 1629it [00:02, 1072.33it/s]warmup run: 2046it [00:03, 1076.86it/s]warmup run: 2115it [00:03, 1114.25it/s]warmup run: 2449it [00:03, 1257.07it/s]warmup run: 1740it [00:03, 1082.60it/s]warmup run: 2181it [00:03, 1156.70it/s]warmup run: 2250it [00:03, 1182.96it/s]warmup run: 2583it [00:03, 1281.11it/s]warmup run: 1851it [00:03, 1089.35it/s]warmup run: 2316it [00:03, 1212.94it/s]warmup run: 2384it [00:03, 1227.75it/s]warmup run: 2717it [00:03, 1298.10it/s]warmup run: 1962it [00:03, 1093.09it/s]warmup run: 2451it [00:03, 1251.73it/s]warmup run: 2514it [00:03, 1248.13it/s]warmup run: 2850it [00:03, 1306.55it/s]warmup run: 2091it [00:03, 1151.29it/s]warmup run: 2585it [00:03, 1276.90it/s]warmup run: 2649it [00:03, 1277.47it/s]warmup run: 2984it [00:04, 1316.12it/s]warmup run: 2231it [00:03, 1225.35it/s]warmup run: 3000it [00:04, 737.53it/s] warmup run: 2720it [00:03, 1296.02it/s]warmup run: 2782it [00:03, 1290.66it/s]warmup run: 2369it [00:03, 1271.16it/s]warmup run: 2853it [00:03, 1305.09it/s]warmup run: 2915it [00:04, 1300.73it/s]warmup run: 2505it [00:03, 1296.46it/s]warmup run: 2988it [00:04, 1315.75it/s]warmup run: 3000it [00:04, 721.76it/s] warmup run: 3000it [00:04, 737.22it/s] warmup run: 2635it [00:03, 1285.27it/s]warmup run: 2770it [00:03, 1304.06it/s]warmup run: 2906it [00:03, 1318.62it/s]warmup run: 3000it [00:04, 743.25it/s] 



warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1707.71it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1669.33it/s]warmup should be done:   6%|▌         | 179/3000 [00:00<00:01, 1780.28it/s]warmup should be done:   5%|▌         | 154/3000 [00:00<00:01, 1531.88it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1726.68it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1760.03it/s]warmup should be done:  12%|█▏        | 361/3000 [00:00<00:01, 1803.40it/s]warmup should be done:  11%|█         | 323/3000 [00:00<00:01, 1620.98it/s]warmup should be done:  17%|█▋        | 519/3000 [00:00<00:01, 1733.35it/s]warmup should be done:  18%|█▊        | 542/3000 [00:00<00:01, 1800.21it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1756.29it/s]warmup should be done:  16%|█▋        | 490/3000 [00:00<00:01, 1639.79it/s]warmup should be done:  23%|██▎       | 694/3000 [00:00<00:01, 1737.19it/s]warmup should be done:  24%|██▎       | 705/3000 [00:00<00:01, 1761.49it/s]warmup should be done:  24%|██▍       | 723/3000 [00:00<00:01, 1802.60it/s]warmup should be done:  22%|██▏       | 657/3000 [00:00<00:01, 1648.91it/s]warmup should be done:  29%|██▉       | 868/3000 [00:00<00:01, 1735.76it/s]warmup should be done:  27%|██▋       | 823/3000 [00:00<00:01, 1652.52it/s]warmup should be done:  30%|███       | 904/3000 [00:00<00:01, 1796.86it/s]warmup should be done:  29%|██▉       | 882/3000 [00:00<00:01, 1754.41it/s]warmup should be done:  35%|███▍      | 1042/3000 [00:00<00:01, 1735.78it/s]warmup should be done:  33%|███▎      | 989/3000 [00:00<00:01, 1653.11it/s]warmup should be done:  36%|███▌      | 1084/3000 [00:00<00:01, 1794.93it/s]warmup should be done:  35%|███▌      | 1058/3000 [00:00<00:01, 1752.95it/s]warmup should be done:  41%|████      | 1217/3000 [00:00<00:01, 1739.34it/s]warmup should be done:  41%|████      | 1234/3000 [00:00<00:01, 1750.43it/s]warmup should be done:  42%|████▏     | 1264/3000 [00:00<00:00, 1784.58it/s]warmup should be done:  38%|███▊      | 1155/3000 [00:00<00:01, 1512.18it/s]warmup should be done:  46%|████▋     | 1392/3000 [00:00<00:00, 1742.19it/s]warmup should be done:  47%|████▋     | 1410/3000 [00:00<00:00, 1750.34it/s]warmup should be done:  48%|████▊     | 1444/3000 [00:00<00:00, 1788.66it/s]warmup should be done:  44%|████▎     | 1309/3000 [00:00<00:01, 1439.23it/s]warmup should be done:  52%|█████▏    | 1568/3000 [00:00<00:00, 1745.30it/s]warmup should be done:  53%|█████▎    | 1586/3000 [00:00<00:00, 1750.37it/s]warmup should be done:  54%|█████▍    | 1623/3000 [00:00<00:00, 1777.43it/s]warmup should be done:  49%|████▉     | 1475/3000 [00:00<00:01, 1501.04it/s]warmup should be done:  58%|█████▊    | 1744/3000 [00:01<00:00, 1747.76it/s]warmup should be done:  59%|█████▊    | 1762/3000 [00:01<00:00, 1751.47it/s]warmup should be done:  60%|██████    | 1801/3000 [00:01<00:00, 1770.36it/s]warmup should be done:  55%|█████▍    | 1641/3000 [00:01<00:00, 1546.60it/s]warmup should be done:  64%|██████▍   | 1920/3000 [00:01<00:00, 1748.63it/s]warmup should be done:  65%|██████▍   | 1938/3000 [00:01<00:00, 1750.57it/s]warmup should be done:  66%|██████▌   | 1982/3000 [00:01<00:00, 1779.78it/s]warmup should be done:  60%|██████    | 1807/3000 [00:01<00:00, 1577.32it/s]warmup should be done:  70%|██████▉   | 2096/3000 [00:01<00:00, 1750.46it/s]warmup should be done:  70%|███████   | 2114/3000 [00:01<00:00, 1749.71it/s]warmup should be done:  72%|███████▏  | 2163/3000 [00:01<00:00, 1787.86it/s]warmup should be done:  66%|██████▌   | 1969/3000 [00:01<00:00, 1587.66it/s]warmup should be done:  76%|███████▌  | 2272/3000 [00:01<00:00, 1750.61it/s]warmup should be done:  76%|███████▋  | 2290/3000 [00:01<00:00, 1750.52it/s]warmup should be done:  78%|███████▊  | 2343/3000 [00:01<00:00, 1790.26it/s]warmup should be done:  72%|███████▏  | 2150/3000 [00:01<00:00, 1651.67it/s]warmup should be done:  82%|████████▏ | 2449/3000 [00:01<00:00, 1755.67it/s]warmup should be done:  82%|████████▏ | 2467/3000 [00:01<00:00, 1755.10it/s]warmup should be done:  84%|████████▍ | 2524/3000 [00:01<00:00, 1796.04it/s]warmup should be done:  78%|███████▊  | 2330/3000 [00:01<00:00, 1695.52it/s]warmup should be done:  88%|████████▊ | 2625/3000 [00:01<00:00, 1756.10it/s]warmup should be done:  88%|████████▊ | 2643/3000 [00:01<00:00, 1754.35it/s]warmup should be done:  90%|█████████ | 2705/3000 [00:01<00:00, 1797.65it/s]warmup should be done:  84%|████████▍ | 2513/3000 [00:01<00:00, 1733.12it/s]warmup should be done:  93%|█████████▎| 2801/3000 [00:01<00:00, 1757.05it/s]warmup should be done:  94%|█████████▍| 2819/3000 [00:01<00:00, 1753.92it/s]warmup should be done:  96%|█████████▌| 2885/3000 [00:01<00:00, 1790.91it/s]warmup should be done:  90%|████████▉ | 2695/3000 [00:01<00:00, 1757.28it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1789.88it/s]warmup should be done:  99%|█████████▉| 2978/3000 [00:01<00:00, 1758.90it/s]warmup should be done: 100%|█████████▉| 2995/3000 [00:01<00:00, 1755.61it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1752.49it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1746.40it/s]warmup should be done:  96%|█████████▌| 2877/3000 [00:01<00:00, 1774.60it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1647.42it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 186/3000 [00:00<00:01, 1857.89it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1687.11it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1724.83it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1700.89it/s]warmup should be done:  12%|█▏        | 372/3000 [00:00<00:01, 1857.97it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1776.67it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1773.81it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1769.32it/s]warmup should be done:  19%|█▊        | 558/3000 [00:00<00:01, 1856.95it/s]warmup should be done:  18%|█▊        | 536/3000 [00:00<00:01, 1793.03it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1787.25it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1716.17it/s]warmup should be done:  25%|██▍       | 744/3000 [00:00<00:01, 1833.37it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1749.71it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1754.75it/s]warmup should be done:  24%|██▍       | 716/3000 [00:00<00:01, 1706.27it/s]warmup should be done:  31%|███       | 930/3000 [00:00<00:01, 1842.66it/s]warmup should be done:  30%|██▉       | 893/3000 [00:00<00:01, 1766.86it/s]warmup should be done:  30%|██▉       | 898/3000 [00:00<00:01, 1785.87it/s]warmup should be done:  30%|██▉       | 888/3000 [00:00<00:01, 1677.24it/s]warmup should be done:  37%|███▋      | 1117/3000 [00:00<00:01, 1849.76it/s]warmup should be done:  36%|███▌      | 1074/3000 [00:00<00:01, 1779.44it/s]warmup should be done:  36%|███▌      | 1084/3000 [00:00<00:01, 1809.23it/s]warmup should be done:  36%|███▌      | 1070/3000 [00:00<00:01, 1723.19it/s]warmup should be done:  43%|████▎     | 1303/3000 [00:00<00:00, 1850.53it/s]warmup should be done:  42%|████▏     | 1253/3000 [00:00<00:00, 1782.14it/s]warmup should be done:  42%|████▏     | 1269/3000 [00:00<00:00, 1821.60it/s]warmup should be done:  42%|████▏     | 1250/3000 [00:00<00:01, 1745.61it/s]warmup should be done:  50%|████▉     | 1490/3000 [00:00<00:00, 1854.87it/s]warmup should be done:  48%|████▊     | 1435/3000 [00:00<00:00, 1791.62it/s]warmup should be done:  49%|████▊     | 1456/3000 [00:00<00:00, 1833.93it/s]warmup should be done:  48%|████▊     | 1432/3000 [00:00<00:00, 1768.07it/s]warmup should be done:  56%|█████▌    | 1677/3000 [00:00<00:00, 1858.42it/s]warmup should be done:  54%|█████▍    | 1617/3000 [00:00<00:00, 1797.68it/s]warmup should be done:  55%|█████▍    | 1642/3000 [00:00<00:00, 1840.88it/s]warmup should be done:  54%|█████▍    | 1614/3000 [00:00<00:00, 1784.03it/s]warmup should be done:  62%|██████▏   | 1864/3000 [00:01<00:00, 1860.38it/s]warmup should be done:  60%|█████▉    | 1798/3000 [00:01<00:00, 1799.80it/s]warmup should be done:  61%|██████    | 1829/3000 [00:01<00:00, 1847.08it/s]warmup should be done:  60%|█████▉    | 1796/3000 [00:01<00:00, 1792.98it/s]warmup should be done:  68%|██████▊   | 2052/3000 [00:01<00:00, 1864.34it/s]warmup should be done:  66%|██████▌   | 1979/3000 [00:01<00:00, 1801.17it/s]warmup should be done:  67%|██████▋   | 2015/3000 [00:01<00:00, 1849.16it/s]warmup should be done:  66%|██████▌   | 1977/3000 [00:01<00:00, 1796.46it/s]warmup should be done:  75%|███████▍  | 2239/3000 [00:01<00:00, 1865.55it/s]warmup should be done:  72%|███████▏  | 2160/3000 [00:01<00:00, 1802.83it/s]warmup should be done:  73%|███████▎  | 2201/3000 [00:01<00:00, 1851.18it/s]warmup should be done:  72%|███████▏  | 2158/3000 [00:01<00:00, 1798.57it/s]warmup should be done:  81%|████████  | 2427/3000 [00:01<00:00, 1867.20it/s]warmup should be done:  78%|███████▊  | 2341/3000 [00:01<00:00, 1804.94it/s]warmup should be done:  80%|███████▉  | 2387/3000 [00:01<00:00, 1814.08it/s]warmup should be done:  78%|███████▊  | 2340/3000 [00:01<00:00, 1802.79it/s]warmup should be done:  87%|████████▋ | 2615/3000 [00:01<00:00, 1869.15it/s]warmup should be done:  84%|████████▍ | 2524/3000 [00:01<00:00, 1809.69it/s]warmup should be done:  86%|████████▌ | 2574/3000 [00:01<00:00, 1827.78it/s]warmup should be done:  84%|████████▍ | 2522/3000 [00:01<00:00, 1807.20it/s]warmup should be done:  93%|█████████▎| 2803/3000 [00:01<00:00, 1870.20it/s]warmup should be done:  90%|█████████ | 2706/3000 [00:01<00:00, 1812.14it/s]warmup should be done:  92%|█████████▏| 2761/3000 [00:01<00:00, 1837.66it/s]warmup should be done:  90%|█████████ | 2704/3000 [00:01<00:00, 1809.78it/s]warmup should be done: 100%|█████████▉| 2991/3000 [00:01<00:00, 1872.34it/s]warmup should be done:  96%|█████████▋| 2888/3000 [00:01<00:00, 1812.12it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1860.66it/s]warmup should be done:  96%|█████████▌| 2886/3000 [00:01<00:00, 1811.12it/s]warmup should be done:  98%|█████████▊| 2945/3000 [00:01<00:00, 1818.80it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1807.02it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1794.67it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1779.90it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f5409a6b280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f5409a6b160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f5409a6b0a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f5409d62eb0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 20:36:54.566919: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f4fdd265100 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:36:54.566979: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:36:54.574155: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:36:55.648415: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:36:56.394142: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f4fe12673e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:36:56.394206: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:36:56.396181: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f4fdd26bea0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:36:56.396228: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:36:56.401270: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:36:56.405114: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:36:56.434984: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f4fe126af30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:36:56.435035: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:36:56.441749: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:36:57.254616: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:36:57.263316: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:36:57.312205: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:37:01.850861: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:37:02.539623: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:37:03.454001: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:37:03.584567: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][20:38:05.439][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][20:38:05.439][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:38:05.445][ERROR][RK0][main]: coll ps creation done
[HCTR][20:38:05.445][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][20:38:05.616][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][20:38:05.616][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:38:05.621][ERROR][RK0][main]: coll ps creation done
[HCTR][20:38:05.621][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][20:38:05.775][ERROR][RK0][tid #139981473429248]: replica 2 reaches 1000, calling init pre replica
[HCTR][20:38:05.776][ERROR][RK0][tid #139981473429248]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:38:05.780][ERROR][RK0][tid #139981473429248]: coll ps creation done
[HCTR][20:38:05.781][ERROR][RK0][tid #139981473429248]: replica 2 waits for coll ps creation barrier
[HCTR][20:38:05.857][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][20:38:05.857][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:38:05.862][ERROR][RK0][main]: coll ps creation done
[HCTR][20:38:05.862][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][20:38:05.862][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][20:38:06.797][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][20:38:06.830][ERROR][RK0][tid #139981473429248]: replica 2 calling init per replica
[HCTR][20:38:06.830][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][20:38:06.830][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][20:38:06.830][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][20:38:06.830][ERROR][RK0][tid #139981473429248]: Calling build_v2
[HCTR][20:38:06.830][ERROR][RK0][main]: Calling build_v2
[HCTR][20:38:06.830][ERROR][RK0][main]: Calling build_v2
[HCTR][20:38:06.830][ERROR][RK0][tid #139981473429248]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:38:06.830][ERROR][RK0][main]: Calling build_v2
[HCTR][20:38:06.830][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:38:06.830][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:38:06.830][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 20:38:06[[.830370: 2022-12-11 20:38:06E2022-12-11 20:38:06. .830376/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc830377: :: [E136E ]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccusing concurrent impl MPS/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:
2022-12-11 20:38:06:136] using concurrent impl MPS.
136830414] : using concurrent impl MPSE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 20:38:06.831610: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 20:38:06.831665: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 20:38:06.831692: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[
2022-12-11 20:38:06[.2022-12-11 20:38:06831717.: 831720[E: 2022-12-11 20:38:06 E./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 831739:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 212[:2022-12-11 20:38:06E] 196. build symm link desc with 4X Tesla V100-SXM2-16GB out of 4] 831753/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
assigning 8 to cpu: :
E213[ ] 2022-12-11 20:38:06/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421.:
831829196: [[] E2022-12-11 20:38:062022-12-11 20:38:06assigning 8 to cpu ..
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc831862831855:: : 213EE]   remote time is 8.68421/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
::214212] [] cpu time is 302022-12-11 20:38:06build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
.
831927[: 2022-12-11 20:38:06E[. 2022-12-11 20:38:06831920/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.: :831957E214:  ] E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30 :
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc212:] 213build symm link desc with 4X Tesla V100-SXM2-16GB out of 4] 
remote time is 8.68421
[2022-12-11 20:38:06.832046: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 20:38:06:.214832052] : cpu time is 30E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 20:38:06.832131: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 20:38:32.584739: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 20:38:32.651374: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 20:38:32.651476: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 20:38:32.652559: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 20:38:32.742494: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 20:38:33.114406: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 20:38:33.114514: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 20:38:40.781169: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 20:38:40.781405: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 20:38:42.543224: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 20:38:42.543390: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 20:38:42.549457: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 20:38:42.549520: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 20:38:43.614047: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 20:38:43.633546: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 20:38:43.635033: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 20:38:43.644884: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 20:38:43.737537: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 20:38:44.915128: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 20:38:44.919317: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 20:38:44.919448: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 20:38:44.929760: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 20:38:44.929842: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 20:38:44.929876: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 20:38:44.929906: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 20:38:44.933993: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:38:44.934049: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:38:44.935951: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:38:44.936535: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:38:44.952224: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 20:38:44.952319: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 20:38:44.953673: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 20:38:44.953749: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1[
2022-12-11 20:38:44.953735: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 20:38:44.953824: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 20:38:44.954362: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:38:44.954438: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:38:44.955427: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:38:44.956018: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:38:44.957528: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:38:44.957611: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:38:44.957842: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:38:44.957936: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:38:44.959051: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:38:44.959132: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:38:44.960087: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:38:44.960136: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:38:45. 30004: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 20:38:45. 31901: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 20:38:45. 31962: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 20:38:45. 32815: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:38:45. 33412: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:38:45. 34353: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:38:45. 37364: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:38:45. 38042: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:38:45. 38088: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.36 MB
[2022-12-11 20:38:45. 49340: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[[2022-12-11 20:38:452022-12-11 20:38:45..[ 51143 511452022-12-11 20:38:45: : .EE 51180  : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE:: 19801980/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] ] :eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes638

] eager release cuda mem 1021
[2022-12-11 20:38:45. 51276: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 20:38:45. 52045: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:38:45. 52436: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:38:45. 53055: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 20:38:45. 53075: E[ 2022-12-11 20:38:45/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.: 53101638: ] Eeager release cuda mem 1021 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 20:38:45. 53161: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 20:38:45. 53336: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:38:45. 53936: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:38:45. 54563: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:38:45. 54948: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:38:45. 55059: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:38:45. 55877: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:38:45. 56004: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:38:45. 58026: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:38:45. 58691: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:38:45. 58735: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.06 MB
[2022-12-11 20:38:45. 60398: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:38:45. 60985: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:38:45. 61066: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:38:45. 61110: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.37 MB
[2022-12-11 20:38:45. 61671: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:38:45. 61728: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.14 MB
[[[[2022-12-11 20:38:452022-12-11 20:38:452022-12-11 20:38:452022-12-11 20:38:45....147788147791147795147796: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 1 init p2p of link 2Device 0 init p2p of link 1Device 2 init p2p of link 3



[2022-12-11 20:38:45[.[2022-12-11 20:38:451479872022-12-11 20:38:45.: .147989E147991: [ : E2022-12-11 20:38:45/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE .: /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1480131980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:: ] :1980Eeager alloc mem 611.00 KB1980]  
] eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB
:
1980] eager alloc mem 611.00 KB
[2022-12-11 20:38:45.148825: E[ 2022-12-11 20:38:45/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:148836638: ] Eeager release cuda mem 625663 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-11 20:38:45
[.2022-12-11 20:38:45148870.: 148878E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[[2022-12-11 20:38:452022-12-11 20:38:45..151125151127: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261926] ] Device 2 init p2p of link 0Device 0 init p2p of link 2

[2022-12-11 20:38:45.151243: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB[
2022-12-11 20:38:45.151267: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:38:45.151289: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 20:38:45.151328: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 20:38:45.151373: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:38:45.151418: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:38:45.152007: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:38:45.152040: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:38:45.152183: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:38:45.152232: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:38:45.154186: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 20:38:45.154269: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:38:45.154391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 20:38:45.154458: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 20:38:45:.1926154488[] : 2022-12-11 20:38:45Device 2 init p2p of link 1E.
 154495/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1980 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB:
1926] Device 1 init p2p of link 0
[2022-12-11 20:38:45.154606: [E2022-12-11 20:38:45 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu154613:: 1980E]  eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-11 20:38:45.155033: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:38:45.155343: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:38:45.155396: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:38:45.155441: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:38:45.156521: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:38:45.157429: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1999818 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5998438 / 100000000 nodes ( 6.00 %) | cpu 92001744 / 100000000 nodes ( 92.00 %) | 981.36 MB | 0.223387 secs 
[2022-12-11 20:38:45.157526: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:38:45.157571: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:38:45.157719: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:38:45.158118: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1999843 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5998413 / 100000000 nodes ( 6.00 %) | cpu 92001744 / 100000000 nodes ( 92.00 %) | 981.37 MB | 0.20023 secs 
[2022-12-11 20:38:45.158332: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.66 GB
[2022-12-11 20:38:45.158645: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1999211 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5999045 / 100000000 nodes ( 6.00 %) | cpu 92001744 / 100000000 nodes ( 92.00 %) | 981.06 MB | 0.20423 secs 
[2022-12-11 20:38:45.159131: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1999384 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5998872 / 100000000 nodes ( 6.00 %) | cpu 92001744 / 100000000 nodes ( 92.00 %) | 981.14 MB | 0.201549 secs 
[2022-12-11 20:38:46. 45291: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.90 GB
[2022-12-11 20:38:46. 45430: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.90 GB
[2022-12-11 20:38:46. 45699: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.90 GB
[2022-12-11 20:38:46.847676: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.15 GB
[2022-12-11 20:38:46.847819: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.15 GB
[2022-12-11 20:38:46.848203: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.15 GB
[2022-12-11 20:38:47.692964: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.39 GB
[2022-12-11 20:38:47.693118: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.39 GB
[2022-12-11 20:38:47.693499: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.39 GB
[2022-12-11 20:38:48.704121: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.80 GB
[2022-12-11 20:38:48.704265: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.80 GB
[2022-12-11 20:38:48.704634: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.80 GB
[2022-12-11 20:38:49.726607: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.99 GB
[2022-12-11 20:38:49.726755: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.99 GB
[HCTR][20:38:49.936][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][20:38:49.936][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][20:38:49.936][ERROR][RK0][tid #139981473429248]: replica 2 calling init per replica done, doing barrier
[HCTR][20:38:49.936][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][20:38:49.936][ERROR][RK0][tid #139981473429248]: replica 2 calling init per replica done, doing barrier done
[HCTR][20:38:49.936][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][20:38:49.936][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][20:38:49.936][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][20:38:49.936][ERROR][RK0][tid #139981473429248]: init per replica done
[HCTR][20:38:49.936][ERROR][RK0][main]: init per replica done
[HCTR][20:38:49.936][ERROR][RK0][main]: init per replica done
[HCTR][20:38:49.939][ERROR][RK0][main]: init per replica done
[HCTR][20:38:49.973][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f3620238400
[HCTR][20:38:49.973][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f3620558400
[HCTR][20:38:49.973][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f3620b98400
[HCTR][20:38:49.973][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f3620eb8400
[HCTR][20:38:49.974][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f36a8238400
[HCTR][20:38:49.974][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f36a8558400
[HCTR][20:38:49.974][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f36a8b98400
[HCTR][20:38:49.974][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f36a8eb8400
[HCTR][20:38:49.974][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f3638238400
[HCTR][20:38:49.974][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f3638558400
[HCTR][20:38:49.974][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f3638b98400
[HCTR][20:38:49.974][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f3638eb8400
[HCTR][20:38:49.981][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f364c320000
[HCTR][20:38:49.981][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f364c640000
[HCTR][20:38:49.981][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f364cc80000
[HCTR][20:38:49.981][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f364cfa0000
