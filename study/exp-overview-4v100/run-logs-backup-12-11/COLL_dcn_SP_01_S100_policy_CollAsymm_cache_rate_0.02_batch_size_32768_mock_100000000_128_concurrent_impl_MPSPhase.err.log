2022-12-11 20:40:36.986070: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:40:37.062912: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:40:37.062929: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:40:37.063128: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:40:37.838178: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:40:37.838260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 20:40:37.850821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 20:40:37.883805: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:40:37.884070: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:40:37.886947: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 20:40:37.913830: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:40:37.913910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 20:40:37.915310: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:40:37.915369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 20:40:37.916635: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:40:37.916687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 20:40:37.925759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 20:40:37.928553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 20:40:37.929033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 20:40:37.958245: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:40:37.958404: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:40:37.958697: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:40:37.958766: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:40:37.958820: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:40:37.958869: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:40:37.959857: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 20:40:37.960320: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 20:40:37.960618: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][20:40:39.199][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:40:39.206][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:40:39.232][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:40:39.245][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 99it [00:01, 90.79it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 200it [00:01, 197.40it/s]warmup run: 105it [00:01, 95.90it/s]warmup run: 308it [00:01, 322.51it/s]warmup run: 1it [00:01,  1.40s/it]warmup run: 0it [00:00, ?it/s]warmup run: 209it [00:01, 204.95it/s]warmup run: 409it [00:01, 437.94it/s]warmup run: 102it [00:01, 94.30it/s]warmup run: 314it [00:01, 324.55it/s]warmup run: 514it [00:01, 556.24it/s]warmup run: 211it [00:01, 210.60it/s]warmup run: 416it [00:01, 441.23it/s]warmup run: 612it [00:02, 646.21it/s]warmup run: 323it [00:01, 340.43it/s]warmup run: 528it [00:01, 572.16it/s]warmup run: 709it [00:02, 706.84it/s]warmup run: 431it [00:01, 465.61it/s]warmup run: 628it [00:02, 661.33it/s]warmup run: 815it [00:02, 793.38it/s]warmup run: 532it [00:01, 570.78it/s]warmup run: 740it [00:02, 768.08it/s]warmup run: 913it [00:02, 840.35it/s]warmup run: 632it [00:02, 661.23it/s]warmup run: 848it [00:02, 844.80it/s]warmup run: 1019it [00:02, 898.36it/s]warmup run: 738it [00:02, 754.59it/s]warmup run: 960it [00:02, 915.92it/s]warmup run: 1125it [00:02, 941.62it/s]warmup run: 843it [00:02, 828.51it/s]warmup run: 1073it [00:02, 972.46it/s]warmup run: 1232it [00:02, 975.98it/s]warmup run: 946it [00:02, 875.12it/s]warmup run: 1182it [00:02, 976.09it/s]warmup run: 1341it [00:02, 1007.39it/s]warmup run: 1048it [00:02, 914.20it/s]warmup run: 1288it [00:02, 982.55it/s]warmup run: 1450it [00:02, 1031.19it/s]warmup run: 1155it [00:02, 955.69it/s]warmup run: 1392it [00:02, 988.83it/s]warmup run: 1558it [00:02, 1045.18it/s]warmup run: 1260it [00:02, 980.48it/s]warmup run: 1495it [00:02, 992.48it/s]warmup run: 1666it [00:03, 1053.29it/s]warmup run: 1365it [00:02, 999.15it/s]warmup run: 1598it [00:02, 1002.91it/s]warmup run: 1773it [00:03, 1038.94it/s]warmup run: 1472it [00:02, 1018.91it/s]warmup run: 1701it [00:03, 1003.27it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 1878it [00:03, 1036.88it/s]warmup run: 1581it [00:02, 1039.17it/s]warmup run: 1808it [00:03, 1021.58it/s]warmup run: 105it [00:01, 93.97it/s]warmup run: 1983it [00:03, 1039.45it/s]warmup run: 1691it [00:03, 1055.33it/s]warmup run: 1916it [00:03, 1037.23it/s]warmup run: 206it [00:01, 197.89it/s]warmup run: 2111it [00:03, 1110.41it/s]warmup run: 1801it [00:03, 1067.71it/s]warmup run: 2027it [00:03, 1057.84it/s]warmup run: 313it [00:01, 319.41it/s]warmup run: 2245it [00:03, 1177.22it/s]warmup run: 1911it [00:03, 1077.20it/s]warmup run: 2159it [00:03, 1135.54it/s]warmup run: 420it [00:01, 443.82it/s]warmup run: 2376it [00:03, 1214.26it/s]warmup run: 2025it [00:03, 1094.75it/s]warmup run: 2292it [00:03, 1191.64it/s]warmup run: 528it [00:01, 564.73it/s]warmup run: 2507it [00:03, 1241.00it/s]warmup run: 2162it [00:03, 1176.80it/s]warmup run: 2429it [00:03, 1244.16it/s]warmup run: 636it [00:02, 675.32it/s]warmup run: 2643it [00:03, 1275.07it/s]warmup run: 2300it [00:03, 1236.08it/s]warmup run: 2566it [00:03, 1281.08it/s]warmup run: 744it [00:02, 770.28it/s]warmup run: 2778it [00:03, 1295.40it/s]warmup run: 2437it [00:03, 1275.92it/s]warmup run: 2703it [00:03, 1307.27it/s]warmup run: 852it [00:02, 846.54it/s]warmup run: 2914it [00:04, 1312.97it/s]warmup run: 2574it [00:03, 1303.86it/s]warmup run: 3000it [00:04, 729.82it/s] warmup run: 2834it [00:03, 1298.70it/s]warmup run: 959it [00:02, 904.14it/s]warmup run: 2710it [00:03, 1320.34it/s]warmup run: 2968it [00:04, 1309.87it/s]warmup run: 1067it [00:02, 950.79it/s]warmup run: 3000it [00:04, 734.36it/s] warmup run: 2845it [00:03, 1327.00it/s]warmup run: 1175it [00:02, 986.76it/s]warmup run: 2981it [00:04, 1335.87it/s]warmup run: 3000it [00:04, 743.90it/s] warmup run: 1283it [00:02, 1010.83it/s]warmup run: 1392it [00:02, 1031.70it/s]warmup run: 1500it [00:02, 1045.42it/s]warmup run: 1608it [00:02, 1054.67it/s]warmup run: 1716it [00:03, 1060.76it/s]warmup run: 1824it [00:03, 1053.41it/s]warmup run: 1931it [00:03, 1056.22it/s]warmup run: 2045it [00:03, 1080.60it/s]warmup run: 2177it [00:03, 1150.53it/s]warmup run: 2311it [00:03, 1204.62it/s]warmup run: 2441it [00:03, 1231.97it/s]warmup run: 2569it [00:03, 1245.43it/s]warmup run: 2703it [00:03, 1271.46it/s]warmup run: 2835it [00:03, 1285.23it/s]warmup run: 2969it [00:04, 1299.14it/s]warmup run: 3000it [00:04, 732.60it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1717.58it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1687.54it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1770.37it/s]warmup should be done:   5%|▌         | 152/3000 [00:00<00:01, 1515.42it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1776.90it/s]warmup should be done:  11%|█         | 326/3000 [00:00<00:01, 1646.21it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1750.60it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1782.08it/s]warmup should be done:  17%|█▋        | 496/3000 [00:00<00:01, 1669.61it/s]warmup should be done:  18%|█▊        | 535/3000 [00:00<00:01, 1788.25it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1764.45it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1772.01it/s]warmup should be done:  22%|██▏       | 674/3000 [00:00<00:01, 1712.12it/s]warmup should be done:  24%|██▍       | 717/3000 [00:00<00:01, 1798.00it/s]warmup should be done:  24%|██▎       | 707/3000 [00:00<00:01, 1771.90it/s]warmup should be done:  24%|██▍       | 716/3000 [00:00<00:01, 1776.44it/s]warmup should be done:  30%|███       | 902/3000 [00:00<00:01, 1813.86it/s]warmup should be done:  30%|██▉       | 885/3000 [00:00<00:01, 1767.98it/s]warmup should be done:  30%|██▉       | 894/3000 [00:00<00:01, 1770.48it/s]warmup should be done:  28%|██▊       | 846/3000 [00:00<00:01, 1670.72it/s]warmup should be done:  36%|███▌      | 1084/3000 [00:00<00:01, 1811.03it/s]warmup should be done:  35%|███▌      | 1062/3000 [00:00<00:01, 1767.30it/s]warmup should be done:  36%|███▌      | 1072/3000 [00:00<00:01, 1763.64it/s]warmup should be done:  34%|███▍      | 1021/3000 [00:00<00:01, 1696.39it/s]warmup should be done:  42%|████▏     | 1266/3000 [00:00<00:00, 1810.83it/s]warmup should be done:  42%|████▏     | 1249/3000 [00:00<00:00, 1751.78it/s]warmup should be done:  40%|███▉      | 1191/3000 [00:00<00:01, 1695.04it/s]warmup should be done:  41%|████▏     | 1239/3000 [00:00<00:01, 1727.81it/s]warmup should be done:  48%|████▊     | 1448/3000 [00:00<00:00, 1810.23it/s]warmup should be done:  48%|████▊     | 1428/3000 [00:00<00:00, 1762.49it/s]warmup should be done:  46%|████▌     | 1370/3000 [00:00<00:00, 1724.60it/s]warmup should be done:  47%|████▋     | 1412/3000 [00:00<00:00, 1727.80it/s]warmup should be done:  54%|█████▍    | 1630/3000 [00:00<00:00, 1809.22it/s]warmup should be done:  52%|█████▏    | 1549/3000 [00:00<00:00, 1744.45it/s]warmup should be done:  54%|█████▎    | 1605/3000 [00:00<00:00, 1757.84it/s]warmup should be done:  53%|█████▎    | 1585/3000 [00:00<00:00, 1698.71it/s]warmup should be done:  60%|██████    | 1812/3000 [00:01<00:00, 1809.68it/s]warmup should be done:  58%|█████▊    | 1728/3000 [00:01<00:00, 1756.69it/s]warmup should be done:  60%|█████▉    | 1788/3000 [00:01<00:00, 1777.32it/s]warmup should be done:  59%|█████▊    | 1756/3000 [00:01<00:00, 1697.34it/s]warmup should be done:  66%|██████▋   | 1993/3000 [00:01<00:00, 1808.43it/s]warmup should be done:  64%|██████▎   | 1907/3000 [00:01<00:00, 1763.84it/s]warmup should be done:  66%|██████▌   | 1972/3000 [00:01<00:00, 1793.53it/s]warmup should be done:  64%|██████▍   | 1929/3000 [00:01<00:00, 1707.04it/s]warmup should be done:  72%|███████▎  | 2175/3000 [00:01<00:00, 1810.80it/s]warmup should be done:  70%|██████▉   | 2086/3000 [00:01<00:00, 1770.74it/s]warmup should be done:  72%|███████▏  | 2156/3000 [00:01<00:00, 1804.91it/s]warmup should be done:  70%|███████   | 2100/3000 [00:01<00:00, 1624.39it/s]warmup should be done:  79%|███████▊  | 2358/3000 [00:01<00:00, 1813.69it/s]warmup should be done:  76%|███████▌  | 2265/3000 [00:01<00:00, 1776.45it/s]warmup should be done:  78%|███████▊  | 2339/3000 [00:01<00:00, 1811.44it/s]warmup should be done:  76%|███████▌  | 2268/3000 [00:01<00:00, 1640.31it/s]warmup should be done:  85%|████████▍ | 2542/3000 [00:01<00:00, 1820.19it/s]warmup should be done:  82%|████████▏ | 2446/3000 [00:01<00:00, 1783.90it/s]warmup should be done:  84%|████████▍ | 2524/3000 [00:01<00:00, 1821.60it/s]warmup should be done:  81%|████████▏ | 2440/3000 [00:01<00:00, 1663.53it/s]warmup should be done:  91%|█████████ | 2725/3000 [00:01<00:00, 1821.17it/s]warmup should be done:  88%|████████▊ | 2626/3000 [00:01<00:00, 1788.67it/s]warmup should be done:  90%|█████████ | 2709/3000 [00:01<00:00, 1827.39it/s]warmup should be done:  87%|████████▋ | 2608/3000 [00:01<00:00, 1667.25it/s]warmup should be done:  97%|█████████▋| 2908/3000 [00:01<00:00, 1821.45it/s]warmup should be done:  94%|█████████▎| 2805/3000 [00:01<00:00, 1788.12it/s]warmup should be done:  96%|█████████▋| 2893/3000 [00:01<00:00, 1831.10it/s]warmup should be done:  93%|█████████▎| 2776/3000 [00:01<00:00, 1629.40it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1809.72it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1795.23it/s]warmup should be done:  99%|█████████▉| 2984/3000 [00:01<00:00, 1782.54it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1743.32it/s]warmup should be done:  98%|█████████▊| 2948/3000 [00:01<00:00, 1655.64it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1676.18it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 183/3000 [00:00<00:01, 1826.47it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1833.44it/s]warmup should be done:   5%|▍         | 140/3000 [00:00<00:02, 1394.83it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1641.54it/s]warmup should be done:  11%|█         | 324/3000 [00:00<00:01, 1654.18it/s]warmup should be done:  12%|█▏        | 374/3000 [00:00<00:01, 1867.87it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1758.38it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1782.70it/s]warmup should be done:  17%|█▋        | 509/3000 [00:00<00:01, 1742.99it/s]warmup should be done:  19%|█▊        | 562/3000 [00:00<00:01, 1869.75it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1795.07it/s]warmup should be done:  18%|█▊        | 548/3000 [00:00<00:01, 1798.99it/s]warmup should be done:  23%|██▎       | 693/3000 [00:00<00:01, 1778.71it/s]warmup should be done:  24%|██▍       | 719/3000 [00:00<00:01, 1813.94it/s]warmup should be done:  25%|██▍       | 749/3000 [00:00<00:01, 1864.85it/s]warmup should be done:  24%|██▍       | 731/3000 [00:00<00:01, 1807.53it/s]warmup should be done:  30%|███       | 901/3000 [00:00<00:01, 1814.08it/s]warmup should be done:  30%|███       | 914/3000 [00:00<00:01, 1812.31it/s]warmup should be done:  31%|███       | 936/3000 [00:00<00:01, 1817.16it/s]warmup should be done:  29%|██▉       | 871/3000 [00:00<00:01, 1725.93it/s]warmup should be done:  36%|███▌      | 1086/3000 [00:00<00:01, 1824.13it/s]warmup should be done:  37%|███▋      | 1096/3000 [00:00<00:01, 1813.32it/s]warmup should be done:  37%|███▋      | 1122/3000 [00:00<00:01, 1829.94it/s]warmup should be done:  35%|███▌      | 1053/3000 [00:00<00:01, 1756.56it/s]warmup should be done:  42%|████▏     | 1269/3000 [00:00<00:00, 1819.75it/s]warmup should be done:  43%|████▎     | 1281/3000 [00:00<00:00, 1823.75it/s]warmup should be done:  44%|████▎     | 1309/3000 [00:00<00:00, 1840.47it/s]warmup should be done:  41%|████      | 1236/3000 [00:00<00:00, 1778.27it/s]warmup should be done:  48%|████▊     | 1453/3000 [00:00<00:00, 1825.62it/s]warmup should be done:  49%|████▉     | 1468/3000 [00:00<00:00, 1835.84it/s]warmup should be done:  47%|████▋     | 1419/3000 [00:00<00:00, 1794.42it/s]warmup should be done:  50%|████▉     | 1495/3000 [00:00<00:00, 1843.55it/s]warmup should be done:  55%|█████▌    | 1655/3000 [00:00<00:00, 1844.67it/s]warmup should be done:  55%|█████▍    | 1636/3000 [00:00<00:00, 1800.06it/s]warmup should be done:  53%|█████▎    | 1602/3000 [00:00<00:00, 1804.03it/s]warmup should be done:  56%|█████▌    | 1680/3000 [00:00<00:00, 1845.34it/s]warmup should be done:  61%|██████▏   | 1842/3000 [00:01<00:00, 1849.61it/s]warmup should be done:  60%|█████▉    | 1786/3000 [00:01<00:00, 1812.05it/s]warmup should be done:  62%|██████▏   | 1866/3000 [00:01<00:00, 1847.56it/s]warmup should be done:  61%|██████    | 1817/3000 [00:01<00:00, 1731.87it/s]warmup should be done:  68%|██████▊   | 2029/3000 [00:01<00:00, 1852.91it/s]warmup should be done:  66%|██████▌   | 1970/3000 [00:01<00:00, 1819.56it/s]warmup should be done:  68%|██████▊   | 2052/3000 [00:01<00:00, 1850.63it/s]warmup should be done:  67%|██████▋   | 2001/3000 [00:01<00:00, 1762.35it/s]warmup should be done:  74%|███████▍  | 2215/3000 [00:01<00:00, 1853.36it/s]warmup should be done:  75%|███████▍  | 2239/3000 [00:01<00:00, 1854.16it/s]warmup should be done:  72%|███████▏  | 2154/3000 [00:01<00:00, 1823.04it/s]warmup should be done:  73%|███████▎  | 2180/3000 [00:01<00:00, 1770.48it/s]warmup should be done:  80%|████████  | 2401/3000 [00:01<00:00, 1853.80it/s]warmup should be done:  81%|████████  | 2426/3000 [00:01<00:00, 1858.71it/s]warmup should be done:  78%|███████▊  | 2338/3000 [00:01<00:00, 1826.66it/s]warmup should be done:  79%|███████▉  | 2363/3000 [00:01<00:00, 1786.67it/s]warmup should be done:  86%|████████▌ | 2587/3000 [00:01<00:00, 1854.09it/s]warmup should be done:  87%|████████▋ | 2613/3000 [00:01<00:00, 1861.90it/s]warmup should be done:  84%|████████▍ | 2522/3000 [00:01<00:00, 1829.31it/s]warmup should be done:  85%|████████▍ | 2547/3000 [00:01<00:00, 1799.55it/s]warmup should be done:  92%|█████████▏| 2773/3000 [00:01<00:00, 1853.42it/s]warmup should be done:  93%|█████████▎| 2801/3000 [00:01<00:00, 1864.50it/s]warmup should be done:  90%|█████████ | 2705/3000 [00:01<00:00, 1829.40it/s]warmup should be done:  91%|█████████ | 2730/3000 [00:01<00:00, 1808.27it/s]warmup should be done:  99%|█████████▊| 2959/3000 [00:01<00:00, 1850.43it/s]warmup should be done: 100%|█████████▉| 2988/3000 [00:01<00:00, 1865.43it/s]warmup should be done:  96%|█████████▋| 2888/3000 [00:01<00:00, 1827.02it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1852.79it/s]warmup should be done:  97%|█████████▋| 2914/3000 [00:01<00:00, 1816.46it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1837.61it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1792.49it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1785.01it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f2568e8f250>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f2568e90160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f2568e900a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f2568e8f190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 20:41:53.696257: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f21352683d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:41:53.696317: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:41:53.703361: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:41:54.651051: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:41:55.621809: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f2139268120 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:41:55.621903: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:41:55.635461: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:41:55.653553: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f2145a64d50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:41:55.653625: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:41:55.663137: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:41:55.664439: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f213926a3d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:41:55.664495: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:41:55.672280: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:41:56.367463: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:41:56.477471: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:41:56.488547: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:42:00.977738: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:42:01.570230: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:42:02.086041: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:42:02.736280: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][20:43:04.609][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][20:43:04.609][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:43:04.612][ERROR][RK0][main]: coll ps creation done
[HCTR][20:43:04.612][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][20:43:04.622][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][20:43:04.622][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:43:04.626][ERROR][RK0][main]: coll ps creation done
[HCTR][20:43:04.626][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][20:43:04.705][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][20:43:04.705][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:43:04.709][ERROR][RK0][main]: coll ps creation done
[HCTR][20:43:04.709][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][20:43:04.782][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][20:43:04.782][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:43:04.786][ERROR][RK0][main]: coll ps creation done
[HCTR][20:43:04.786][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][20:43:04.786][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][20:43:05.731][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][20:43:05.760][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][20:43:05.760][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][20:43:05.760][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][20:43:05.760][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][20:43:05.760][ERROR][RK0][main]: Calling build_v2
[HCTR][20:43:05.760][ERROR][RK0][main]: Calling build_v2
[HCTR][20:43:05.760][ERROR][RK0][main]: Calling build_v2
[HCTR][20:43:05.760][ERROR][RK0][main]: Calling build_v2
[HCTR][20:43:05.760][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:43:05.760][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:43:05.760][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:43:05.760][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-11 20:43:052022-12-11 20:43:05[2022-12-11 20:43:05...7606647606762022-12-11 20:43:05760664: : .: EE760685E  :  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:: :136136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136] ] :] using concurrent impl MPSPhaseusing concurrent impl MPSPhase136using concurrent impl MPSPhase

] 
using concurrent impl MPSPhase
[2022-12-11 20:43:05.761975: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 20:43:05.762003: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[1962022-12-11 20:43:05] .assigning 8 to cpu762019
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 20:43:05.[7620542022-12-11 20:43:05: [.E2022-12-11 20:43:05762061 .: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc762078E[::  2022-12-11 20:43:05196E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.]  :762111assigning 8 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc212: 
:] E212build symm link desc with 4X Tesla V100-SXM2-16GB out of 4 ] 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4:
212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[
[2022-12-11 20:43:05[[2022-12-11 20:43:05.2022-12-11 20:43:052022-12-11 20:43:05.762227..762211: 762235762244: E: : E EE /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213::212] 213213] remote time is 8.68421] ] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
remote time is 8.68421remote time is 8.68421


[2022-12-11 20:43:05[.[2022-12-11 20:43:057623902022-12-11 20:43:05[.: .2022-12-11 20:43:05762400E762403.:  : 762405E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE:  : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: 214214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] ] ::cpu time is 30cpu time is 30213214

] ] remote time is 8.68421cpu time is 30

[2022-12-11 20:43:05.762585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 20:43:31.236168: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 20:43:31.302117: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 20:43:31.302234: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 20:43:31.303734: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 20:43:31.395978: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 20:43:31.769431: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 20:43:31.769510: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 20:43:39.212753: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 20:43:39.212948: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 20:43:41. 18199: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 20:43:41. 18355: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 20:43:41. 42268: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 20:43:41. 42346: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 20:43:41. 69091: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 20:43:41. 81469: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 20:43:41. 82372: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 20:43:41. 93279: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 20:43:41.187423: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 20:43:41.189623: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 20:43:41.192106: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 20:43:41.194499: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 20:43:41.196877: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 20:43:43.327416: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 20:43:43.331331: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 20:43:43.331467: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 20:43:44.167782: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 20:43:44.167956: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 20:43:44.168030: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 20:43:44.168094: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 20:43:44.169773: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:43:44.169867: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:43:44.171529: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:43:44.172682: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[[2022-12-11 20:43:442022-12-11 20:43:44..2022-12-11 20:43:44190284190284.: : 190284EE:   E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc202202:] ] 2022 solved1 solved] 

3 solved
[[2022-12-11 20:43:44[2022-12-11 20:43:44.2022-12-11 20:43:44.190433.190434: 190436: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc::205205] ] worker 0 thread 1 initing device 1worker 0 thread 2 initing device 2

[2022-12-11 20:43:44.191310: E[ 2022-12-11 20:43:44/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:1913211815: ] [Building Coll Cache with ... num gpu device is 4E2022-12-11 20:43:44
 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu191342:: 1815E]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuBuilding Coll Cache with ... num gpu device is 4:
1815[] 2022-12-11 20:43:44.Building Coll Cache with ... num gpu device is 4191386
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-11 20:43:44] .191410eager alloc mem 381.47 MB: 
[E2022-12-11 20:43:44 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu191425:: 1980E]  eager alloc mem 381.47 MB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 381.47 MB
[2022-12-11 20:43:44.193206: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:43:44.193234: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:43:44.193281: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:43:44.194705: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:43:44.194735: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:43:44.194767: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:43:44.247783: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 20:43:44.249618: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 20:43:44.249670: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 20:43:44.250500: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:43:44.251053: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:43:44.251943: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:43:44.254056: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:43:44.254705: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:43:44.254749: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 980.85 MB
[[[2022-12-11 20:43:442022-12-11 20:43:442022-12-11 20:43:44...295210295211295211: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes


[2022-12-11 20:43:44[.2022-12-11 20:43:44297080[.: 2022-12-11 20:43:44297083E.:  297091E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:  :E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638 :] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638eager release cuda mem 1021:] 
638eager release cuda mem 1021] 
eager release cuda mem 1021
[2022-12-11 20:43:44.[2971702022-12-11 20:43:44[: .2022-12-11 20:43:44E297175. : 297179/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: : E638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc ] :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 400000000638:
] 638eager release cuda mem 400000000] 
eager release cuda mem 400000000
[2022-12-11 20:43:44.298134: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:43:44.298636: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:43:44.299112: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:43:44.299578: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:43:44.299625: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:43:44.299659: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:43:44.300471: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:43:44.300515: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:43:44.300552: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:43:44.305597: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:43:44.305781: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:43:44.306256: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:43:44.306300: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 974.80 MB
[2022-12-11 20:43:44.306444: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:43:44.306493: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.35 MB
[2022-12-11 20:43:44.307131: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:43:44.307783: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:43:44.307824: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 980.40 MB
[[[[2022-12-11 20:43:442022-12-11 20:43:442022-12-11 20:43:442022-12-11 20:43:44....393803393801393802393801: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 2 init p2p of link 3Device 1 init p2p of link 2Device 3 init p2p of link 0Device 0 init p2p of link 1



[2022-12-11 20:43:44.[3940612022-12-11 20:43:44: .E394068 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[E:2022-12-11 20:43:44 1980[./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] 2022-12-11 20:43:44394086:eager alloc mem 611.00 KB.: 1980
394101E] :  eager alloc mem 611.00 KBE/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
 :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KB
[2022-12-11 20:43:44.394872: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:43:44[.2022-12-11 20:43:44394968.: 394973E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638[eager release cuda mem 625663] 2022-12-11 20:43:44
eager release cuda mem 625663.
395005: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:43:44.397100: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 20:43:44.397182: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:43:44.397380: [E2022-12-11 20:43:44 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu397394:: 1926E]  Device 3 init p2p of link 1/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1926] Device 1 init p2p of link 3
[2022-12-11 20:43:44.397469: [E2022-12-11 20:43:44 [./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 20:43:44397491:.: 1926397504E] :  Device 0 init p2p of link 2E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
 :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KB
[2022-12-11 20:43:44.397625: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:43:44.397924: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:43:44.398336: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:43:44.398373: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:43:44.398436: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:43:44.399231: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 20:43:44.399309: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:43:44.400052: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:43:44.400451: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 20:43:44[.2022-12-11 20:43:44400543[.: 2022-12-11 20:43:44400538E.:  400557E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:  :E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980 :] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1926eager alloc mem 611.00 KB:] 
1926Device 0 init p2p of link 3] 
Device 1 init p2p of link 0
[2022-12-11 20:43:44[.2022-12-11 20:43:44400727.: 400728E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KB
[2022-12-11 20:43:44.401258: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:43:44.401419: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:43:44[.2022-12-11 20:43:44401599.: 401605E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-11 20:43:44.401826: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1986388 / 100000000 nodes ( 1.99 %~2.00 %) | remote 5993652 / 100000000 nodes ( 5.99 %) | cpu 92019960 / 100000000 nodes ( 92.02 %) | 974.80 MB | 0.210462 secs 
[2022-12-11 20:43:44.403836: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:43:44.403903: E[ 2022-12-11 20:43:44/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:403921638: ] Eeager release cuda mem 8399996 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:43:44.404406: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1997865 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5982175 / 100000000 nodes ( 5.98 %) | cpu 92019960 / 100000000 nodes ( 92.02 %) | 980.40 MB | 0.212998 secs 
[2022-12-11 20:43:44.405001: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1998779 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5981261 / 100000000 nodes ( 5.98 %) | cpu 92019960 / 100000000 nodes ( 92.02 %) | 980.85 MB | 0.235152 secs 
[2022-12-11 20:43:44.405409: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1999803 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5980237 / 100000000 nodes ( 5.98 %) | cpu 92019960 / 100000000 nodes ( 92.02 %) | 981.35 MB | 0.214018 secs 
[2022-12-11 20:43:44.405566: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 7.66 GB
[2022-12-11 20:43:45.385260: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 7.90 GB
[2022-12-11 20:43:45.385588: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 7.90 GB
[2022-12-11 20:43:45.386142: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 7.90 GB
[2022-12-11 20:43:46.387444: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 8.15 GB
[2022-12-11 20:43:46.387733: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 8.15 GB
[2022-12-11 20:43:46.388283: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 8.15 GB
[2022-12-11 20:43:47. 66262: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 8.39 GB
[2022-12-11 20:43:47. 66384: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 8.39 GB
[2022-12-11 20:43:47. 66620: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 8.39 GB
[2022-12-11 20:43:47. 66779: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 8.39 GB
[2022-12-11 20:43:47. 67037: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 8.39 GB
[2022-12-11 20:43:48. 55453: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 8.58 GB
[2022-12-11 20:43:48. 55600: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 8.58 GB
[HCTR][20:43:48.055][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][20:43:48.055][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][20:43:48.055][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][20:43:48.055][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][20:43:48.055][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][20:43:48.055][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][20:43:48.055][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][20:43:48.055][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][20:43:48.055][ERROR][RK0][main]: init per replica done
[HCTR][20:43:48.055][ERROR][RK0][main]: init per replica done
[HCTR][20:43:48.055][ERROR][RK0][main]: init per replica done
[HCTR][20:43:48.059][ERROR][RK0][main]: init per replica done
[HCTR][20:43:48.090][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f0738238400
[HCTR][20:43:48.090][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f0738558400
[HCTR][20:43:48.090][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f0738b98400
[HCTR][20:43:48.090][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f0738eb8400
[HCTR][20:43:48.091][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f0744238400
[HCTR][20:43:48.091][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f0744558400
[HCTR][20:43:48.091][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f0744b98400
[HCTR][20:43:48.091][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f0744eb8400
[HCTR][20:43:48.093][ERROR][RK0][tid #139781270902528]: 3 allocated 3276800 at 0x7f07dc238400
[HCTR][20:43:48.093][ERROR][RK0][tid #139781270902528]: 3 allocated 6553600 at 0x7f07dc558400
[HCTR][20:43:48.093][ERROR][RK0][tid #139781270902528]: 3 allocated 3276800 at 0x7f07dcb98400
[HCTR][20:43:48.093][ERROR][RK0][tid #139781270902528]: 3 allocated 6553600 at 0x7f07dceb8400
[HCTR][20:43:48.096][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f0738320000
[HCTR][20:43:48.097][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f0738640000
[HCTR][20:43:48.097][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f0738c80000
[HCTR][20:43:48.097][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f0738fa0000
