2022-12-11 23:33:00.943513: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:33:01.023529: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:33:01.024188: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:33:01.024341: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:33:01.820107: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:33:01.820188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:33:01.832750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:33:01.861668: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:33:01.861838: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:33:01.863437: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 23:33:01.924723: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:33:01.924798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:33:01.928066: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:33:01.928130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:33:01.934469: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:33:01.934560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:33:01.936999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:33:01.940061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:33:01.949350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:33:01.967582: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:33:01.967740: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:33:01.968566: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 23:33:01.968996: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:33:01.969109: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:33:01.969903: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 23:33:01.976980: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:33:01.977096: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:33:01.977817: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][23:33:03.203][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:33:03.208][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:33:03.255][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:33:03.261][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.58s/it]warmup run: 0it [00:00, ?it/s]warmup run: 110it [00:01, 91.14it/s]warmup run: 221it [00:01, 199.07it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 307it [00:01, 283.47it/s]warmup run: 96it [00:01, 85.98it/s]warmup run: 413it [00:01, 405.05it/s]warmup run: 203it [00:01, 197.75it/s]warmup run: 517it [00:02, 521.07it/s]warmup run: 310it [00:01, 319.43it/s]warmup run: 628it [00:02, 642.77it/s]warmup run: 418it [00:01, 445.67it/s]warmup run: 736it [00:02, 741.80it/s]warmup run: 529it [00:01, 571.98it/s]warmup run: 842it [00:02, 819.92it/s]warmup run: 637it [00:02, 680.53it/s]warmup run: 948it [00:02, 881.98it/s]warmup run: 744it [00:02, 771.48it/s]warmup run: 1054it [00:02, 928.08it/s]warmup run: 852it [00:02, 848.67it/s]warmup run: 1161it [00:02, 965.05it/s]warmup run: 960it [00:02, 908.17it/s]warmup run: 1267it [00:02, 970.79it/s]warmup run: 1068it [00:02, 954.34it/s]warmup run: 1371it [00:02, 989.48it/s]warmup run: 1177it [00:02, 990.64it/s]warmup run: 1479it [00:02, 1013.18it/s]warmup run: 1285it [00:02, 1011.61it/s]warmup run: 1it [00:01,  1.51s/it]warmup run: 1587it [00:03, 1032.13it/s]warmup run: 1392it [00:02, 1012.08it/s]warmup run: 0it [00:00, ?it/s]warmup run: 101it [00:01, 87.14it/s]warmup run: 1693it [00:03, 1020.09it/s]warmup run: 1498it [00:02, 988.00it/s] warmup run: 210it [00:01, 197.42it/s]warmup run: 1805it [00:03, 1048.89it/s]warmup run: 1601it [00:02, 999.28it/s]warmup run: 318it [00:01, 317.14it/s]warmup run: 1918it [00:03, 1071.68it/s]warmup run: 1703it [00:03, 985.51it/s]warmup run: 425it [00:01, 438.89it/s]warmup run: 2036it [00:03, 1103.08it/s]warmup run: 1806it [00:03, 997.30it/s]warmup run: 535it [00:02, 562.60it/s]warmup run: 2171it [00:03, 1174.88it/s]warmup run: 644it [00:02, 674.01it/s]warmup run: 1907it [00:03, 988.10it/s]warmup run: 2306it [00:03, 1226.65it/s]warmup run: 2023it [00:03, 1036.55it/s]warmup run: 749it [00:02, 759.59it/s]warmup run: 2440it [00:03, 1258.19it/s]warmup run: 2158it [00:03, 1126.49it/s]warmup run: 853it [00:02, 826.03it/s]warmup run: 2573it [00:03, 1278.78it/s]warmup run: 2292it [00:03, 1189.09it/s]warmup run: 957it [00:02, 876.75it/s]warmup run: 2706it [00:04, 1292.76it/s]warmup run: 2429it [00:03, 1240.64it/s]warmup run: 1060it [00:02, 891.85it/s]warmup run: 2836it [00:04, 1251.44it/s]warmup run: 2566it [00:03, 1279.05it/s]warmup run: 1173it [00:02, 955.69it/s]warmup run: 2962it [00:04, 1248.54it/s]warmup run: 3000it [00:04, 704.92it/s] warmup run: 2702it [00:03, 1302.92it/s]warmup run: 1282it [00:02, 991.57it/s]warmup run: 2837it [00:03, 1314.62it/s]warmup run: 1392it [00:02, 1020.12it/s]warmup run: 2973it [00:04, 1326.78it/s]warmup run: 1500it [00:02, 1036.69it/s]warmup run: 3000it [00:04, 729.01it/s] warmup run: 1609it [00:03, 1051.12it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1719it [00:03, 1062.79it/s]warmup run: 104it [00:01, 94.45it/s]warmup run: 1829it [00:03, 1071.42it/s]warmup run: 210it [00:01, 205.35it/s]warmup run: 1939it [00:03, 1077.01it/s]warmup run: 315it [00:01, 324.24it/s]warmup run: 2059it [00:03, 1111.67it/s]warmup run: 421it [00:01, 447.26it/s]warmup run: 2195it [00:03, 1184.80it/s]warmup run: 528it [00:01, 566.69it/s]warmup run: 2331it [00:03, 1236.58it/s]warmup run: 630it [00:02, 662.77it/s]warmup run: 2468it [00:03, 1274.88it/s]warmup run: 736it [00:02, 756.20it/s]warmup run: 2604it [00:03, 1299.08it/s]warmup run: 845it [00:02, 839.08it/s]warmup run: 2740it [00:03, 1316.47it/s]warmup run: 954it [00:02, 903.59it/s]warmup run: 2874it [00:04, 1322.54it/s]warmup run: 1063it [00:02, 952.69it/s]warmup run: 3000it [00:04, 725.77it/s] warmup run: 1170it [00:02, 983.57it/s]warmup run: 1277it [00:02, 1008.06it/s]warmup run: 1387it [00:02, 1032.16it/s]warmup run: 1495it [00:02, 1032.87it/s]warmup run: 1604it [00:02, 1046.91it/s]warmup run: 1712it [00:03, 1056.45it/s]warmup run: 1821it [00:03, 1066.04it/s]warmup run: 1931it [00:03, 1073.61it/s]warmup run: 2048it [00:03, 1100.23it/s]warmup run: 2184it [00:03, 1177.01it/s]warmup run: 2319it [00:03, 1227.44it/s]warmup run: 2455it [00:03, 1266.39it/s]warmup run: 2588it [00:03, 1284.57it/s]warmup run: 2724it [00:03, 1307.08it/s]warmup run: 2855it [00:03, 1286.34it/s]warmup run: 2989it [00:04, 1300.28it/s]warmup run: 3000it [00:04, 738.39it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1708.82it/s]warmup should be done:   5%|▌         | 164/3000 [00:00<00:01, 1639.53it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1654.23it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1617.50it/s]warmup should be done:  11%|█▏        | 343/3000 [00:00<00:01, 1727.82it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1758.00it/s]warmup should be done:  12%|█▏        | 346/3000 [00:00<00:01, 1735.24it/s]warmup should be done:  11%|█         | 336/3000 [00:00<00:01, 1684.22it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1763.09it/s]warmup should be done:  17%|█▋        | 518/3000 [00:00<00:01, 1734.88it/s]warmup should be done:  17%|█▋        | 523/3000 [00:00<00:01, 1746.70it/s]warmup should be done:  17%|█▋        | 506/3000 [00:00<00:01, 1687.53it/s]warmup should be done:  24%|██▎       | 707/3000 [00:00<00:01, 1772.77it/s]warmup should be done:  23%|██▎       | 692/3000 [00:00<00:01, 1729.33it/s]warmup should be done:  23%|██▎       | 699/3000 [00:00<00:01, 1748.56it/s]warmup should be done:  23%|██▎       | 679/3000 [00:00<00:01, 1701.21it/s]warmup should be done:  30%|██▉       | 885/3000 [00:00<00:01, 1769.82it/s]warmup should be done:  29%|██▉       | 866/3000 [00:00<00:01, 1731.76it/s]warmup should be done:  29%|██▉       | 874/3000 [00:00<00:01, 1741.76it/s]warmup should be done:  28%|██▊       | 850/3000 [00:00<00:01, 1702.39it/s]warmup should be done:  35%|███▌      | 1063/3000 [00:00<00:01, 1771.59it/s]warmup should be done:  35%|███▍      | 1049/3000 [00:00<00:01, 1741.31it/s]warmup should be done:  34%|███▍      | 1021/3000 [00:00<00:01, 1702.21it/s]warmup should be done:  35%|███▍      | 1040/3000 [00:00<00:01, 1718.20it/s]warmup should be done:  41%|████▏     | 1242/3000 [00:00<00:00, 1776.38it/s]warmup should be done:  41%|████      | 1224/3000 [00:00<00:01, 1738.58it/s]warmup should be done:  40%|███▉      | 1192/3000 [00:00<00:01, 1703.88it/s]warmup should be done:  40%|████      | 1212/3000 [00:00<00:01, 1709.67it/s]warmup should be done:  47%|████▋     | 1420/3000 [00:00<00:00, 1777.06it/s]warmup should be done:  47%|████▋     | 1398/3000 [00:00<00:00, 1737.68it/s]warmup should be done:  46%|████▌     | 1367/3000 [00:00<00:00, 1717.55it/s]warmup should be done:  46%|████▌     | 1383/3000 [00:00<00:00, 1699.10it/s]warmup should be done:  53%|█████▎    | 1598/3000 [00:00<00:00, 1777.69it/s]warmup should be done:  53%|█████▎    | 1576/3000 [00:00<00:00, 1748.70it/s]warmup should be done:  51%|█████▏    | 1539/3000 [00:00<00:00, 1706.50it/s]warmup should be done:  52%|█████▏    | 1555/3000 [00:00<00:00, 1704.07it/s]warmup should be done:  59%|█████▉    | 1776/3000 [00:01<00:00, 1775.50it/s]warmup should be done:  59%|█████▊    | 1756/3000 [00:01<00:00, 1761.57it/s]warmup should be done:  57%|█████▋    | 1716/3000 [00:01<00:00, 1725.14it/s]warmup should be done:  58%|█████▊    | 1726/3000 [00:01<00:00, 1699.16it/s]warmup should be done:  65%|██████▌   | 1954/3000 [00:01<00:00, 1776.02it/s]warmup should be done:  64%|██████▍   | 1935/3000 [00:01<00:00, 1769.05it/s]warmup should be done:  63%|██████▎   | 1894/3000 [00:01<00:00, 1740.12it/s]warmup should be done:  63%|██████▎   | 1900/3000 [00:01<00:00, 1708.69it/s]warmup should be done:  71%|███████   | 2132/3000 [00:01<00:00, 1767.06it/s]warmup should be done:  70%|███████   | 2114/3000 [00:01<00:00, 1773.51it/s]warmup should be done:  69%|██████▉   | 2071/3000 [00:01<00:00, 1746.65it/s]warmup should be done:  69%|██████▉   | 2071/3000 [00:01<00:00, 1652.12it/s]warmup should be done:  76%|███████▋  | 2294/3000 [00:01<00:00, 1778.67it/s]warmup should be done:  75%|███████▍  | 2247/3000 [00:01<00:00, 1747.86it/s]warmup should be done:  77%|███████▋  | 2309/3000 [00:01<00:00, 1695.01it/s]warmup should be done:  75%|███████▍  | 2245/3000 [00:01<00:00, 1677.34it/s]warmup should be done:  82%|████████▏ | 2474/3000 [00:01<00:00, 1784.85it/s]warmup should be done:  81%|████████  | 2423/3000 [00:01<00:00, 1751.14it/s]warmup should be done:  81%|████████  | 2420/3000 [00:01<00:00, 1696.24it/s]warmup should be done:  83%|████████▎ | 2480/3000 [00:01<00:00, 1664.58it/s]warmup should be done:  88%|████████▊ | 2654/3000 [00:01<00:00, 1788.29it/s]warmup should be done:  87%|████████▋ | 2600/3000 [00:01<00:00, 1756.06it/s]warmup should be done:  86%|████████▋ | 2593/3000 [00:01<00:00, 1705.08it/s]warmup should be done:  89%|████████▊ | 2658/3000 [00:01<00:00, 1697.73it/s]warmup should be done:  93%|█████████▎| 2777/3000 [00:01<00:00, 1758.99it/s]warmup should be done:  92%|█████████▎| 2775/3000 [00:01<00:00, 1738.18it/s]warmup should be done:  94%|█████████▍| 2835/3000 [00:01<00:00, 1718.11it/s]warmup should be done:  94%|█████████▍| 2833/3000 [00:01<00:00, 1691.01it/s]warmup should be done:  98%|█████████▊| 2953/3000 [00:01<00:00, 1756.34it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1744.85it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1742.66it/s]warmup should be done:  98%|█████████▊| 2950/3000 [00:01<00:00, 1739.10it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1729.49it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1713.26it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 187/3000 [00:00<00:01, 1861.64it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1724.41it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1731.50it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1721.59it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1766.80it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1800.23it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1803.82it/s]warmup should be done:  12%|█▏        | 374/3000 [00:00<00:01, 1812.93it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1785.84it/s]warmup should be done:  18%|█▊        | 545/3000 [00:00<00:01, 1823.41it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1813.92it/s]warmup should be done:  19%|█▊        | 560/3000 [00:00<00:01, 1830.27it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1811.35it/s]warmup should be done:  24%|██▍       | 731/3000 [00:00<00:01, 1833.95it/s]warmup should be done:  24%|██▍       | 729/3000 [00:00<00:01, 1828.58it/s]warmup should be done:  25%|██▍       | 746/3000 [00:00<00:01, 1838.53it/s]warmup should be done:  30%|███       | 906/3000 [00:00<00:01, 1827.20it/s]warmup should be done:  30%|███       | 913/3000 [00:00<00:01, 1831.39it/s]warmup should be done:  31%|███       | 916/3000 [00:00<00:01, 1837.34it/s]warmup should be done:  31%|███       | 932/3000 [00:00<00:01, 1845.43it/s]warmup should be done:  36%|███▋      | 1092/3000 [00:00<00:01, 1836.72it/s]warmup should be done:  37%|███▋      | 1099/3000 [00:00<00:01, 1840.79it/s]warmup should be done:  37%|███▋      | 1101/3000 [00:00<00:01, 1840.52it/s]warmup should be done:  37%|███▋      | 1118/3000 [00:00<00:01, 1848.90it/s]warmup should be done:  43%|████▎     | 1277/3000 [00:00<00:00, 1839.36it/s]warmup should be done:  43%|████▎     | 1284/3000 [00:00<00:00, 1843.69it/s]warmup should be done:  43%|████▎     | 1286/3000 [00:00<00:00, 1838.54it/s]warmup should be done:  43%|████▎     | 1303/3000 [00:00<00:00, 1847.51it/s]warmup should be done:  49%|████▉     | 1469/3000 [00:00<00:00, 1841.64it/s]warmup should be done:  49%|████▉     | 1471/3000 [00:00<00:00, 1841.57it/s]warmup should be done:  49%|████▊     | 1461/3000 [00:00<00:00, 1831.27it/s]warmup should be done:  50%|████▉     | 1488/3000 [00:00<00:00, 1824.94it/s]warmup should be done:  55%|█████▌    | 1655/3000 [00:00<00:00, 1844.77it/s]warmup should be done:  55%|█████▌    | 1656/3000 [00:00<00:00, 1840.54it/s]warmup should be done:  55%|█████▍    | 1645/3000 [00:00<00:00, 1820.06it/s]warmup should be done:  56%|█████▌    | 1671/3000 [00:00<00:00, 1822.52it/s]warmup should be done:  61%|██████▏   | 1840/3000 [00:01<00:00, 1845.73it/s]warmup should be done:  61%|██████▏   | 1841/3000 [00:01<00:00, 1837.72it/s]warmup should be done:  61%|██████    | 1828/3000 [00:01<00:00, 1815.33it/s]warmup should be done:  62%|██████▏   | 1854/3000 [00:01<00:00, 1818.46it/s]warmup should be done:  68%|██████▊   | 2027/3000 [00:01<00:00, 1851.32it/s]warmup should be done:  68%|██████▊   | 2026/3000 [00:01<00:00, 1838.60it/s]warmup should be done:  67%|██████▋   | 2010/3000 [00:01<00:00, 1808.22it/s]warmup should be done:  68%|██████▊   | 2036/3000 [00:01<00:00, 1816.89it/s]warmup should be done:  74%|███████▍  | 2213/3000 [00:01<00:00, 1844.17it/s]warmup should be done:  74%|███████▎  | 2210/3000 [00:01<00:00, 1836.88it/s]warmup should be done:  73%|███████▎  | 2191/3000 [00:01<00:00, 1805.59it/s]warmup should be done:  74%|███████▍  | 2218/3000 [00:01<00:00, 1814.88it/s]warmup should be done:  80%|████████  | 2400/3000 [00:01<00:00, 1850.04it/s]warmup should be done:  80%|███████▉  | 2394/3000 [00:01<00:00, 1837.57it/s]warmup should be done:  79%|███████▉  | 2375/3000 [00:01<00:00, 1813.03it/s]warmup should be done:  80%|████████  | 2400/3000 [00:01<00:00, 1813.30it/s]warmup should be done:  86%|████████▌ | 2587/3000 [00:01<00:00, 1854.70it/s]warmup should be done:  86%|████████▌ | 2579/3000 [00:01<00:00, 1838.93it/s]warmup should be done:  85%|████████▌ | 2559/3000 [00:01<00:00, 1818.54it/s]warmup should be done:  86%|████████▌ | 2582/3000 [00:01<00:00, 1736.67it/s]warmup should be done:  92%|█████████▎| 2775/3000 [00:01<00:00, 1861.44it/s]warmup should be done:  92%|█████████▏| 2764/3000 [00:01<00:00, 1841.30it/s]warmup should be done:  91%|█████████▏| 2744/3000 [00:01<00:00, 1826.24it/s]warmup should be done:  92%|█████████▏| 2768/3000 [00:01<00:00, 1769.96it/s]warmup should be done:  98%|█████████▊| 2949/3000 [00:01<00:00, 1842.12it/s]warmup should be done:  99%|█████████▊| 2962/3000 [00:01<00:00, 1851.64it/s]warmup should be done:  98%|█████████▊| 2927/3000 [00:01<00:00, 1806.98it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1841.87it/s]warmup should be done:  98%|█████████▊| 2953/3000 [00:01<00:00, 1791.21it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1835.41it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1811.73it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1811.52it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f385415e0a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f385415e280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f385415e160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f385415d190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 23:34:17.380095: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f3421a67cb0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:34:17.380164: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:34:17.389210: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:34:17.440318: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f34212648a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:34:17.440384: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:34:17.449811: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:34:17.469687: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f342926b070 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:34:17.469769: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:34:17.476786: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f3429a6aac0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:34:17.476839: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:34:17.478533: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:34:17.484339: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:34:18.095479: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:34:18.186456: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:34:18.230552: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:34:18.242851: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:34:23.500312: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:34:23.500522: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:34:24.027030: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:34:24.444389: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][23:35:18.093][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][23:35:18.093][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][23:35:18.099][ERROR][RK0][main]: coll ps creation done
[HCTR][23:35:18.099][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][23:35:18.254][ERROR][RK0][tid #139862179047168]: replica 0 reaches 1000, calling init pre replica
[HCTR][23:35:18.254][ERROR][RK0][tid #139862179047168]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][23:35:18.260][ERROR][RK0][tid #139862179047168]: coll ps creation done
[HCTR][23:35:18.260][ERROR][RK0][tid #139862179047168]: replica 0 waits for coll ps creation barrier
[HCTR][23:35:18.366][ERROR][RK0][tid #139862187439872]: replica 1 reaches 1000, calling init pre replica
[HCTR][23:35:18.366][ERROR][RK0][tid #139862187439872]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][23:35:18.371][ERROR][RK0][tid #139862187439872]: coll ps creation done
[HCTR][23:35:18.371][ERROR][RK0][tid #139862187439872]: replica 1 waits for coll ps creation barrier
[HCTR][23:35:18.415][ERROR][RK0][tid #139863118571264]: replica 2 reaches 1000, calling init pre replica
[HCTR][23:35:18.416][ERROR][RK0][tid #139863118571264]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][23:35:18.419][ERROR][RK0][tid #139863118571264]: coll ps creation done
[HCTR][23:35:18.419][ERROR][RK0][tid #139863118571264]: replica 2 waits for coll ps creation barrier
[HCTR][23:35:18.419][ERROR][RK0][tid #139862179047168]: replica 0 preparing frequency
[HCTR][23:35:19.381][ERROR][RK0][tid #139862179047168]: replica 0 preparing frequency done
[HCTR][23:35:19.421][ERROR][RK0][tid #139862179047168]: replica 0 calling init per replica
[HCTR][23:35:19.421][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][23:35:19.421][ERROR][RK0][tid #139862187439872]: replica 1 calling init per replica
[HCTR][23:35:19.421][ERROR][RK0][tid #139863118571264]: replica 2 calling init per replica
[HCTR][23:35:19.421][ERROR][RK0][tid #139862179047168]: Calling build_v2
[HCTR][23:35:19.421][ERROR][RK0][main]: Calling build_v2
[HCTR][23:35:19.421][ERROR][RK0][tid #139862187439872]: Calling build_v2
[HCTR][23:35:19.421][ERROR][RK0][tid #139862179047168]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:35:19.421][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:35:19.421][ERROR][RK0][tid #139863118571264]: Calling build_v2
[HCTR][23:35:19.421][ERROR][RK0][tid #139862187439872]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:35:19.421][ERROR][RK0][tid #139863118571264]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 23:35:19.422253[: E 2022-12-11 23:35:19/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.[:422280196: 2022-12-11 23:35:19] E.assigning 0 to cpu 422297
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: [:E196 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 0 to cpu:2022-12-11 23:35:19
196.[] 4223252022-12-11 23:35:19assigning 0 to cpu: .
E[422360 2022-12-11 23:35:19: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.E:422382[ 196: 2022-12-11 23:35:19/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] E.:assigning 0 to cpu 422406212
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: ] :Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4212 
] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4:
212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[[[
2022-12-11 23:35:192022-12-11 23:35:192022-12-11 23:35:19[...2022-12-11 23:35:19422494422469422478.: : : 422515EEE:    E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :::/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc213212213:] ] ] 213remote time is 8.68421build symm link desc with 4X Tesla V100-SXM2-16GB out of 4remote time is 8.68421] 


remote time is 8.68421
[2022-12-11 23:35:19[.2022-12-11 23:35:19[422618[.2022-12-11 23:35:19: 2022-12-11 23:35:19422622.E.: 422625 422624E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:  E:E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 214 :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214:cpu time is 30:] 214
213cpu time is 30] ] 
cpu time is 30remote time is 8.68421

[2022-12-11 23:35:19.422730: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 23:35:45.635554: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 23:35:45.689787: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 23:35:45.826063: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 23:35:45.826141: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 23:35:45.826184: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 23:35:45.826225: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 23:35:45.827588: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:35:45.827653: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:35:45.828768: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:35:45.829457: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:35:45.847260: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 23:35:45.847325: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 23:35:45.847603: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[[[2022-12-11 23:35:452022-12-11 23:35:45.2022-12-11 23:35:45.847612.847648: 847620: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202:1980] 202] 3 solved] eager alloc mem 381.47 MB
2 solved

[2022-12-11 23:35:45[.2022-12-11 23:35:45847737.: 847740E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc205:] 205worker 0 thread 3 initing device 3] 
worker 0 thread 2 initing device 2
[2022-12-11 23:35:45.848320: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:35:45.848371: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB[
2022-12-11 23:35:45.848391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:35:45.[8484492022-12-11 23:35:45: .E848451 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :1980eager alloc mem 381.47 MB] 
eager alloc mem 381.47 MB
[2022-12-11 23:35:45.850019: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:35:45.850157: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:35:45.850631: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:35:45.851927: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:35:45.851975: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:35:45.882973: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 23:35:45.885075: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 23:35:45.885131: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:35:45.885969: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:35:45.886510: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:35:45.887493: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:35:45.887539: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.15 MB
[2022-12-11 23:35:45.906839: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:35:45.907471: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:35:45.907517: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[2022-12-11 23:35:45.909228: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 23:35:45.911401: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 23:35:45.911453: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:35:45.917969: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:35:45.918471: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:35:45.919463: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:35:45.919511: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.15 MB
[2022-12-11 23:35:45.939710: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:35:45.940356: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:35:45.940401: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[[2022-12-11 23:35:452022-12-11 23:35:45..942095942095: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes

[2022-12-11 23:35:45.943860: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 23:35:45.943896: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 23:35:45eager release cuda mem 5.
943918: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:35:45.943949: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:35:45.950873: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:35:45.951347: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:35:45.951909: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 611.00 KB2022-12-11 23:35:45
.951933: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:35:45.952871: [E2022-12-11 23:35:45 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc952880:: 638E]  eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-11 23:35:45.952932[: 2022-12-11 23:35:45W. 952940/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc: :W43 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.ccWORKER[0] alloc host memory 38.15 MB:
43] WORKER[0] alloc host memory 38.15 MB
[2022-12-11 23:35:45.972141: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:35:45.972740: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:35:45.972782: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[2022-12-11 23:35:45.978159: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:35:45.978755: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:35:45.978801: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[[[[2022-12-11 23:35:462022-12-11 23:35:462022-12-11 23:35:462022-12-11 23:35:46....415779415777415786415783: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 0 init p2p of link 1Device 1 init p2p of link 2Device 3 init p2p of link 0Device 2 init p2p of link 3



[2022-12-11 23:35:46.416065: E[ 2022-12-11 23:35:46/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:[41607619802022-12-11 23:35:46: ] .Eeager alloc mem 611.00 KB416089 
: /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[E:2022-12-11 23:35:46 1980./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] 416113:eager alloc mem 611.00 KB: 1980
E]  eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-11 23:35:46.416903: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:35:46.416937: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:35:46.416966: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:35:46.416992: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:35:46.424311: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 23:35:46.424398: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2[[
2022-12-11 23:35:462022-12-11 23:35:46..424436424447: : E[E 2022-12-11 23:35:46 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:424475:1926: 1980] E] Device 2 init p2p of link 0 eager alloc mem 611.00 KB
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1926] Device 3 init p2p of link 1
[2022-12-11 23:35:46.424549: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:35:46[.2022-12-11 23:35:46424611.: 424615E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KB
[2022-12-11 23:35:46.425347: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:2022-12-11 23:35:46638.] 425370eager release cuda mem 625663: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:35:46[.2022-12-11 23:35:46425438.: 425442E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-11 23:35:46.432968: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 23:35:46.433085: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:35:46.433253: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 23:35:46.433298: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 23:35:46.433351: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:35:46.433396: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:35:46.433925: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:35:46.434172[: [2022-12-11 23:35:46E2022-12-11 23:35:46. .434184/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc434196: :: E638E ]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:
:1926638] ] Device 3 init p2p of link 2eager release cuda mem 625663

[2022-12-11 23:35:46.434321: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:35:46.435119: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:35:46.440748: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:35:46.441118: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 10000000 / 100000000 nodes ( 10.00 %~10.00 %) | remote 30000000 / 100000000 nodes ( 30.00 %) | cpu 60000000 / 100000000 nodes ( 60.00 %) | 4.77 GB | 0.593479 secs 
[2022-12-11 23:35:46.441357: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:35:46.441445: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:35:46.441653: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:35:46.441722: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 10000000 / 100000000 nodes ( 10.00 %~10.00 %) | remote 30000000 / 100000000 nodes ( 30.00 %) | cpu 60000000 / 100000000 nodes ( 60.00 %) | 4.77 GB | 0.614082 secs 
[2022-12-11 23:35:46.441894: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 10000000 / 100000000 nodes ( 10.00 %~10.00 %) | remote 30000000 / 100000000 nodes ( 30.00 %) | cpu 60000000 / 100000000 nodes ( 60.00 %) | 4.77 GB | 0.593453 secs 
[2022-12-11 23:35:46.442046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 10000000 / 100000000 nodes ( 10.00 %~10.00 %) | remote 30000000 / 100000000 nodes ( 30.00 %) | cpu 60000000 / 100000000 nodes ( 60.00 %) | 4.77 GB | 0.593688 secs 
[HCTR][23:35:46.442][ERROR][RK0][tid #139862187439872]: replica 1 calling init per replica done, doing barrier
[HCTR][23:35:46.442][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][23:35:46.442][ERROR][RK0][tid #139863118571264]: replica 2 calling init per replica done, doing barrier
[HCTR][23:35:46.442][ERROR][RK0][tid #139862179047168]: replica 0 calling init per replica done, doing barrier
[HCTR][23:35:46.442][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][23:35:46.442][ERROR][RK0][tid #139863118571264]: replica 2 calling init per replica done, doing barrier done
[HCTR][23:35:46.442][ERROR][RK0][tid #139862179047168]: replica 0 calling init per replica done, doing barrier done
[HCTR][23:35:46.442][ERROR][RK0][tid #139862187439872]: replica 1 calling init per replica done, doing barrier done
[HCTR][23:35:46.442][ERROR][RK0][tid #139862187439872]: init per replica done
[HCTR][23:35:46.442][ERROR][RK0][tid #139863118571264]: init per replica done
[HCTR][23:35:46.442][ERROR][RK0][main]: init per replica done
[HCTR][23:35:46.445][ERROR][RK0][tid #139862179047168]: init per replica done
