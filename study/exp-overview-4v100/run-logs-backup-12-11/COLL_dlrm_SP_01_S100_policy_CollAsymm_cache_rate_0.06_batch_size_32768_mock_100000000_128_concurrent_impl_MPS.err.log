2022-12-11 21:48:35.678756: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:48:35.755061: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:48:35.755078: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:48:35.755469: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:48:36.510228: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:48:36.510311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:48:36.526162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:48:36.561810: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:48:36.561976: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:48:36.563380: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 21:48:36.601877: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:48:36.601958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:48:36.602578: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:48:36.602639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:48:36.602757: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:48:36.602812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:48:36.617338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:48:36.617640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:48:36.618406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:48:36.649124: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:48:36.649289: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:48:36.649650: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:48:36.649778: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:48:36.649941: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:48:36.650045: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:48:36.650692: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 21:48:36.651112: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 21:48:36.651373: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][21:48:37.881][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:48:37.892][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:48:37.907][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:48:37.930][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 113it [00:01, 101.14it/s]warmup run: 225it [00:01, 216.85it/s]warmup run: 338it [00:01, 344.20it/s]warmup run: 451it [00:01, 474.51it/s]warmup run: 566it [00:01, 603.59it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 679it [00:02, 716.32it/s]warmup run: 105it [00:01, 91.91it/s]warmup run: 788it [00:02, 803.87it/s]warmup run: 0it [00:00, ?it/s]warmup run: 207it [00:01, 195.27it/s]warmup run: 897it [00:02, 856.03it/s]warmup run: 319it [00:01, 322.01it/s]warmup run: 1003it [00:02, 905.27it/s]warmup run: 433it [00:01, 455.65it/s]warmup run: 1109it [00:02, 946.05it/s]warmup run: 546it [00:01, 582.61it/s]warmup run: 1215it [00:02, 976.42it/s]warmup run: 659it [00:02, 698.64it/s]warmup run: 1323it [00:02, 1003.27it/s]warmup run: 1it [00:01,  1.55s/it]warmup run: 772it [00:02, 797.55it/s]warmup run: 1429it [00:02, 1017.88it/s]warmup run: 89it [00:01, 74.84it/s]warmup run: 884it [00:02, 877.31it/s]warmup run: 1535it [00:02, 1018.52it/s]warmup run: 198it [00:01, 184.01it/s]warmup run: 995it [00:02, 937.05it/s]warmup run: 1641it [00:02, 1028.66it/s]warmup run: 308it [00:01, 305.86it/s]warmup run: 1107it [00:02, 984.82it/s]warmup run: 1746it [00:03, 1005.22it/s]warmup run: 418it [00:01, 432.34it/s]warmup run: 1218it [00:02, 1018.97it/s]warmup run: 1849it [00:03, 1002.78it/s]warmup run: 528it [00:02, 556.25it/s]warmup run: 1329it [00:02, 1038.96it/s]warmup run: 1953it [00:03, 1011.53it/s]warmup run: 630it [00:02, 637.94it/s]warmup run: 1441it [00:02, 1061.50it/s]warmup run: 2073it [00:03, 1066.64it/s]warmup run: 733it [00:02, 726.44it/s]warmup run: 1556it [00:02, 1085.03it/s]warmup run: 2202it [00:03, 1131.02it/s]warmup run: 840it [00:02, 810.15it/s]warmup run: 1671it [00:02, 1102.97it/s]warmup run: 2339it [00:03, 1199.43it/s]warmup run: 943it [00:02, 864.87it/s]warmup run: 1784it [00:03, 1104.92it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 2476it [00:03, 1248.77it/s]warmup run: 1045it [00:02, 877.76it/s]warmup run: 1897it [00:03, 1108.05it/s]warmup run: 104it [00:01, 93.93it/s]warmup run: 2612it [00:03, 1281.80it/s]warmup run: 1152it [00:02, 929.88it/s]warmup run: 2012it [00:03, 1118.67it/s]warmup run: 202it [00:01, 195.26it/s]warmup run: 2747it [00:03, 1300.88it/s]warmup run: 1254it [00:02, 950.89it/s]warmup run: 2147it [00:03, 1186.50it/s]warmup run: 309it [00:01, 317.81it/s]warmup run: 2882it [00:03, 1313.22it/s]warmup run: 1360it [00:02, 981.81it/s]warmup run: 2282it [00:03, 1233.94it/s]warmup run: 415it [00:01, 441.49it/s]warmup run: 3000it [00:04, 735.34it/s] warmup run: 1465it [00:02, 1001.33it/s]warmup run: 2418it [00:03, 1269.91it/s]warmup run: 522it [00:01, 562.19it/s]warmup run: 1572it [00:03, 1020.73it/s]warmup run: 2554it [00:03, 1296.11it/s]warmup run: 630it [00:02, 673.43it/s]warmup run: 1688it [00:03, 1059.14it/s]warmup run: 2689it [00:03, 1311.33it/s]warmup run: 738it [00:02, 768.44it/s]warmup run: 1804it [00:03, 1086.92it/s]warmup run: 2825it [00:03, 1325.18it/s]warmup run: 846it [00:02, 846.27it/s]warmup run: 1920it [00:03, 1108.25it/s]warmup run: 2961it [00:03, 1334.45it/s]warmup run: 954it [00:02, 906.32it/s]warmup run: 3000it [00:04, 743.70it/s] warmup run: 2038it [00:03, 1129.18it/s]warmup run: 1061it [00:02, 948.89it/s]warmup run: 2175it [00:03, 1200.76it/s]warmup run: 1167it [00:02, 978.80it/s]warmup run: 1273it [00:02, 994.68it/s]warmup run: 2296it [00:03, 1105.33it/s]warmup run: 1379it [00:02, 1011.51it/s]warmup run: 2431it [00:03, 1173.69it/s]warmup run: 1486it [00:02, 1026.15it/s]warmup run: 2566it [00:03, 1222.86it/s]warmup run: 1594it [00:02, 1040.93it/s]warmup run: 2702it [00:04, 1260.40it/s]warmup run: 1702it [00:03, 1050.47it/s]warmup run: 2837it [00:04, 1283.96it/s]warmup run: 1809it [00:03, 1054.22it/s]warmup run: 2973it [00:04, 1304.28it/s]warmup run: 3000it [00:04, 707.40it/s] warmup run: 1916it [00:03, 1040.61it/s]warmup run: 2029it [00:03, 1064.55it/s]warmup run: 2158it [00:03, 1129.90it/s]warmup run: 2291it [00:03, 1187.22it/s]warmup run: 2423it [00:03, 1225.60it/s]warmup run: 2558it [00:03, 1261.45it/s]warmup run: 2693it [00:03, 1285.16it/s]warmup run: 2825it [00:03, 1294.29it/s]warmup run: 2960it [00:04, 1310.20it/s]warmup run: 3000it [00:04, 732.61it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1765.84it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1729.67it/s]warmup should be done:   5%|▌         | 161/3000 [00:00<00:01, 1604.23it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1687.06it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1778.59it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1773.90it/s]warmup should be done:  11%|█         | 322/3000 [00:00<00:01, 1577.59it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1733.09it/s]warmup should be done:  18%|█▊        | 535/3000 [00:00<00:01, 1780.48it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1779.10it/s]warmup should be done:  17%|█▋        | 500/3000 [00:00<00:01, 1667.57it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1755.38it/s]warmup should be done:  24%|██▎       | 711/3000 [00:00<00:01, 1779.10it/s]warmup should be done:  23%|██▎       | 679/3000 [00:00<00:01, 1712.17it/s]warmup should be done:  24%|██▎       | 708/3000 [00:00<00:01, 1774.86it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1730.36it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1782.55it/s]warmup should be done:  29%|██▊       | 857/3000 [00:00<00:01, 1735.75it/s]warmup should be done:  30%|██▉       | 889/3000 [00:00<00:01, 1734.56it/s]warmup should be done:  30%|██▉       | 886/3000 [00:00<00:01, 1744.16it/s]warmup should be done:  36%|███▌      | 1069/3000 [00:00<00:01, 1781.17it/s]warmup should be done:  34%|███▍      | 1035/3000 [00:00<00:01, 1748.23it/s]warmup should be done:  36%|███▌      | 1066/3000 [00:00<00:01, 1743.81it/s]warmup should be done:  35%|███▌      | 1061/3000 [00:00<00:01, 1745.14it/s]warmup should be done:  42%|████▏     | 1248/3000 [00:00<00:00, 1783.99it/s]warmup should be done:  40%|████      | 1213/3000 [00:00<00:01, 1757.95it/s]warmup should be done:  41%|████▏     | 1241/3000 [00:00<00:01, 1741.50it/s]warmup should be done:  41%|████      | 1236/3000 [00:00<00:01, 1743.17it/s]warmup should be done:  48%|████▊     | 1428/3000 [00:00<00:00, 1788.82it/s]warmup should be done:  46%|████▋     | 1391/3000 [00:00<00:00, 1763.05it/s]warmup should be done:  47%|████▋     | 1419/3000 [00:00<00:00, 1750.77it/s]warmup should be done:  47%|████▋     | 1412/3000 [00:00<00:00, 1745.30it/s]warmup should be done:  54%|█████▎    | 1609/3000 [00:00<00:00, 1792.78it/s]warmup should be done:  52%|█████▏    | 1570/3000 [00:00<00:00, 1768.84it/s]warmup should be done:  53%|█████▎    | 1587/3000 [00:00<00:00, 1746.51it/s]warmup should be done:  53%|█████▎    | 1595/3000 [00:00<00:00, 1741.89it/s]warmup should be done:  60%|█████▉    | 1790/3000 [00:01<00:00, 1796.44it/s]warmup should be done:  58%|█████▊    | 1749/3000 [00:01<00:00, 1773.36it/s]warmup should be done:  59%|█████▉    | 1766/3000 [00:01<00:00, 1758.30it/s]warmup should be done:  59%|█████▉    | 1772/3000 [00:01<00:00, 1750.43it/s]warmup should be done:  66%|██████▌   | 1970/3000 [00:01<00:00, 1796.53it/s]warmup should be done:  64%|██████▍   | 1929/3000 [00:01<00:00, 1780.25it/s]warmup should be done:  65%|██████▍   | 1946/3000 [00:01<00:00, 1770.77it/s]warmup should be done:  65%|██████▍   | 1948/3000 [00:01<00:00, 1741.32it/s]warmup should be done:  72%|███████▏  | 2151/3000 [00:01<00:00, 1798.53it/s]warmup should be done:  70%|███████   | 2109/3000 [00:01<00:00, 1785.07it/s]warmup should be done:  71%|███████   | 2126/3000 [00:01<00:00, 1750.11it/s]warmup should be done:  71%|███████   | 2124/3000 [00:01<00:00, 1756.94it/s]warmup should be done:  78%|███████▊  | 2331/3000 [00:01<00:00, 1798.95it/s]warmup should be done:  76%|███████▋  | 2288/3000 [00:01<00:00, 1785.90it/s]warmup should be done:  77%|███████▋  | 2301/3000 [00:01<00:00, 1760.73it/s]warmup should be done:  77%|███████▋  | 2302/3000 [00:01<00:00, 1749.02it/s]warmup should be done:  84%|████████▍ | 2513/3000 [00:01<00:00, 1803.71it/s]warmup should be done:  82%|████████▏ | 2470/3000 [00:01<00:00, 1794.09it/s]warmup should be done:  83%|████████▎ | 2481/3000 [00:01<00:00, 1770.62it/s]warmup should be done:  83%|████████▎ | 2481/3000 [00:01<00:00, 1759.54it/s]warmup should be done:  90%|████████▉ | 2694/3000 [00:01<00:00, 1803.94it/s]warmup should be done:  88%|████████▊ | 2650/3000 [00:01<00:00, 1794.60it/s]warmup should be done:  89%|████████▊ | 2660/3000 [00:01<00:00, 1775.73it/s]warmup should be done:  89%|████████▊ | 2657/3000 [00:01<00:00, 1751.10it/s]warmup should be done:  96%|█████████▌| 2875/3000 [00:01<00:00, 1805.07it/s]warmup should be done:  94%|█████████▍| 2830/3000 [00:01<00:00, 1794.65it/s]warmup should be done:  95%|█████████▍| 2840/3000 [00:01<00:00, 1780.69it/s]warmup should be done:  94%|█████████▍| 2834/3000 [00:01<00:00, 1756.24it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1793.66it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1761.85it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1762.11it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1750.07it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 183/3000 [00:00<00:01, 1827.66it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1778.61it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1794.17it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1643.27it/s]warmup should be done:  12%|█▏        | 363/3000 [00:00<00:01, 1818.68it/s]warmup should be done:  12%|█▏        | 367/3000 [00:00<00:01, 1830.51it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1773.47it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1789.13it/s]warmup should be done:  18%|█▊        | 548/3000 [00:00<00:01, 1831.12it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1787.31it/s]warmup should be done:  18%|█▊        | 546/3000 [00:00<00:01, 1818.03it/s]warmup should be done:  18%|█▊        | 551/3000 [00:00<00:01, 1795.68it/s]warmup should be done:  24%|██▍       | 734/3000 [00:00<00:01, 1839.65it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1818.82it/s]warmup should be done:  24%|██▍       | 732/3000 [00:00<00:01, 1831.49it/s]warmup should be done:  25%|██▍       | 736/3000 [00:00<00:01, 1814.40it/s]warmup should be done:  31%|███       | 920/3000 [00:00<00:01, 1844.38it/s]warmup should be done:  30%|███       | 907/3000 [00:00<00:01, 1833.78it/s]warmup should be done:  31%|███       | 918/3000 [00:00<00:01, 1840.88it/s]warmup should be done:  31%|███       | 918/3000 [00:00<00:01, 1815.26it/s]warmup should be done:  37%|███▋      | 1107/3000 [00:00<00:01, 1850.72it/s]warmup should be done:  36%|███▋      | 1094/3000 [00:00<00:01, 1845.71it/s]warmup should be done:  37%|███▋      | 1105/3000 [00:00<00:01, 1847.85it/s]warmup should be done:  37%|███▋      | 1104/3000 [00:00<00:01, 1827.63it/s]warmup should be done:  43%|████▎     | 1280/3000 [00:00<00:00, 1848.52it/s]warmup should be done:  43%|████▎     | 1293/3000 [00:00<00:00, 1849.63it/s]warmup should be done:  43%|████▎     | 1291/3000 [00:00<00:00, 1849.72it/s]warmup should be done:  43%|████▎     | 1287/3000 [00:00<00:00, 1823.47it/s]warmup should be done:  49%|████▉     | 1468/3000 [00:00<00:00, 1857.14it/s]warmup should be done:  49%|████▉     | 1480/3000 [00:00<00:00, 1854.50it/s]warmup should be done:  49%|████▉     | 1478/3000 [00:00<00:00, 1853.88it/s]warmup should be done:  49%|████▉     | 1473/3000 [00:00<00:00, 1833.66it/s]warmup should be done:  55%|█████▌    | 1656/3000 [00:00<00:00, 1861.21it/s]warmup should be done:  56%|█████▌    | 1667/3000 [00:00<00:00, 1856.77it/s]warmup should be done:  56%|█████▌    | 1665/3000 [00:00<00:00, 1858.78it/s]warmup should be done:  55%|█████▌    | 1657/3000 [00:00<00:00, 1827.50it/s]warmup should be done:  61%|██████▏   | 1844/3000 [00:01<00:00, 1865.09it/s]warmup should be done:  62%|██████▏   | 1854/3000 [00:01<00:00, 1858.55it/s]warmup should be done:  61%|██████▏   | 1843/3000 [00:01<00:00, 1835.81it/s]warmup should be done:  62%|██████▏   | 1851/3000 [00:01<00:00, 1816.26it/s]warmup should be done:  68%|██████▊   | 2031/3000 [00:01<00:00, 1866.06it/s]warmup should be done:  68%|██████▊   | 2041/3000 [00:01<00:00, 1861.06it/s]warmup should be done:  68%|██████▊   | 2027/3000 [00:01<00:00, 1835.05it/s]warmup should be done:  68%|██████▊   | 2039/3000 [00:01<00:00, 1835.36it/s]warmup should be done:  74%|███████▍  | 2218/3000 [00:01<00:00, 1865.23it/s]warmup should be done:  74%|███████▍  | 2229/3000 [00:01<00:00, 1864.74it/s]warmup should be done:  74%|███████▎  | 2212/3000 [00:01<00:00, 1838.91it/s]warmup should be done:  74%|███████▍  | 2227/3000 [00:01<00:00, 1846.50it/s]warmup should be done:  80%|████████  | 2405/3000 [00:01<00:00, 1865.43it/s]warmup should be done:  81%|████████  | 2417/3000 [00:01<00:00, 1867.16it/s]warmup should be done:  80%|███████▉  | 2396/3000 [00:01<00:00, 1831.73it/s]warmup should be done:  80%|████████  | 2415/3000 [00:01<00:00, 1854.67it/s]warmup should be done:  86%|████████▋ | 2592/3000 [00:01<00:00, 1866.60it/s]warmup should be done:  87%|████████▋ | 2604/3000 [00:01<00:00, 1867.84it/s]warmup should be done:  86%|████████▌ | 2582/3000 [00:01<00:00, 1838.35it/s]warmup should be done:  87%|████████▋ | 2603/3000 [00:01<00:00, 1859.68it/s]warmup should be done:  93%|█████████▎| 2792/3000 [00:01<00:00, 1871.33it/s]warmup should be done:  93%|█████████▎| 2780/3000 [00:01<00:00, 1867.91it/s]warmup should be done:  92%|█████████▏| 2766/3000 [00:01<00:00, 1837.47it/s]warmup should be done:  93%|█████████▎| 2791/3000 [00:01<00:00, 1863.72it/s]warmup should be done:  99%|█████████▉| 2980/3000 [00:01<00:00, 1872.96it/s]warmup should be done:  99%|█████████▉| 2967/3000 [00:01<00:00, 1867.55it/s]warmup should be done:  98%|█████████▊| 2952/3000 [00:01<00:00, 1842.62it/s]warmup should be done:  99%|█████████▉| 2979/3000 [00:01<00:00, 1866.61it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1857.04it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1849.08it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1846.76it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1831.49it/s]2022-12-11 21:49:54.573284: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fa8ca267b60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:49:54.573345: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:49:54.625786: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fa8c6a6ac00 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:49:54.625865: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:49:54.625945: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fa8ca265b40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:49:54.626002: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:49:56.623083: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:49:57.050038: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:49:57.715707: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:49:58.147089: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:49:58.677217: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:49:58.987645: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:49:59.423414: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:50:00.429579: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:50:01.882416: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:50:03.645450: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fa8c6267db0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:50:03.645509: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:50:05.451673: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:50:06.527676: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:50:07.786332: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][21:50:38.417][ERROR][RK0][tid #140363197040384]: replica 0 reaches 1000, calling init pre replica
[HCTR][21:50:38.418][ERROR][RK0][tid #140363197040384]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:50:38.425][ERROR][RK0][tid #140363197040384]: coll ps creation done
[HCTR][21:50:38.425][ERROR][RK0][tid #140363197040384]: replica 0 waits for coll ps creation barrier
[HCTR][21:50:38.467][ERROR][RK0][tid #140363205433088]: replica 3 reaches 1000, calling init pre replica
[HCTR][21:50:38.468][ERROR][RK0][tid #140363205433088]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:50:38.471][ERROR][RK0][tid #140363205433088]: coll ps creation done
[HCTR][21:50:38.471][ERROR][RK0][tid #140363205433088]: replica 3 waits for coll ps creation barrier
[HCTR][21:50:38.671][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][21:50:38.671][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:50:38.676][ERROR][RK0][main]: coll ps creation done
[HCTR][21:50:38.676][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][21:50:38.710][ERROR][RK0][tid #140363205433088]: replica 1 reaches 1000, calling init pre replica
[HCTR][21:50:38.710][ERROR][RK0][tid #140363205433088]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:50:38.714][ERROR][RK0][tid #140363205433088]: coll ps creation done
[HCTR][21:50:38.714][ERROR][RK0][tid #140363205433088]: replica 1 waits for coll ps creation barrier
[HCTR][21:50:38.714][ERROR][RK0][tid #140363197040384]: replica 0 preparing frequency
[HCTR][21:50:39.628][ERROR][RK0][tid #140363197040384]: replica 0 preparing frequency done
[HCTR][21:50:39.659][ERROR][RK0][tid #140363197040384]: replica 0 calling init per replica
[HCTR][21:50:39.659][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][21:50:39.659][ERROR][RK0][tid #140363205433088]: replica 1 calling init per replica
[HCTR][21:50:39.659][ERROR][RK0][tid #140363205433088]: replica 3 calling init per replica
[HCTR][21:50:39.659][ERROR][RK0][tid #140363197040384]: Calling build_v2
[HCTR][21:50:39.659][ERROR][RK0][main]: Calling build_v2
[HCTR][21:50:39.659][ERROR][RK0][tid #140363205433088]: Calling build_v2
[HCTR][21:50:39.659][ERROR][RK0][tid #140363197040384]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:50:39.659][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:50:39.659][ERROR][RK0][tid #140363205433088]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:50:39.659][ERROR][RK0][tid #140363205433088]: Calling build_v2
[HCTR][21:50:39.659][ERROR][RK0][tid #140363205433088]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 21:50:39.659675[[: [E2022-12-11 21:50:392022-12-11 21:50:39 .2022-12-11 21:50:39./hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc659699.659697:: 659696: 136E: E]  E using concurrent impl MPS/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc
:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136:136] 136] using concurrent impl MPS] using concurrent impl MPS
using concurrent impl MPS

[2022-12-11 21:50:39.660907: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 21:50:39.660963: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2122022-12-11 21:50:39] .build symm link desc with 4X Tesla V100-SXM2-16GB out of 4660981
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196[] 2022-12-11 21:50:39[assigning 8 to cpu.2022-12-11 21:50:39[
661009.2022-12-11 21:50:39: 661018.E[: 661029 2022-12-11 21:50:39E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc. E:661066/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 196: :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] E213:assigning 8 to cpu ] 196
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421] :
assigning 8 to cpu212
[[] 2022-12-11 21:50:392022-12-11 21:50:39build symm link desc with 4X Tesla V100-SXM2-16GB out of 4..
661177661184: : E[E[ 2022-12-11 21:50:39 2022-12-11 21:50:39/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:661230:661219212: 214: ] E] Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4 cpu time is 30 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::213[212] 2022-12-11 21:50:39] remote time is 8.68421.build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
661340
: E[ 2022-12-11 21:50:39/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[.:2022-12-11 21:50:39661384213.: ] 661395Eremote time is 8.68421:  
E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[ :2022-12-11 21:50:39/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214.:] 661457213cpu time is 30: ] 
Eremote time is 8.68421 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] [cpu time is 302022-12-11 21:50:39
.661528: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 21:51:02.858938: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 21:51:02.921037: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 21:51:02.921133: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 21:51:02.922384: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 21:51:03. 12440: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 21:51:03.371806: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 21:51:03.371914: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 21:51:10.489691: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 21:51:10.489803: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 21:51:12.337687: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 21:51:12.337779: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 21:51:12.341681: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 21:51:12.341737: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 21:51:13.345078: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 21:51:13.362611: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 21:51:13.363371: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 21:51:13.373165: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 21:51:13.468977: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 21:51:16.869570: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 21:51:16.873501: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 21:51:16.873629: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 21:51:16.883402: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 21:51:16.883472: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 21:51:16.883506: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 21:51:16.883536: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 21:51:16.884635: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:51:16.884683: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:51:16.885597: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:51:16.886139: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:51:16.907983: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 21:51:16.908081: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 21:51:16.908735: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:51:16.908797: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:51:16.909619: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:51:16.909977: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 21:51:16.910109: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 21:51:16.910167: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:51:16.911164: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 21:51:16.911243: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 21:51:16.912120: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:51:16.912176: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:51:16.913021: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:51:16.913594: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:51:16.914178: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:51:16.914288: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:51:16.915601: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:51:16.916237: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:51:16.975327: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 21:51:16.977263: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:51:16.977314: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:51:16.978193: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 21:51:16.978735: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:51:16.979674: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:51:16.979719: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.76 MB
[2022-12-11 21:51:16.989303: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:51:16.989950: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:51:16.989994: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.85 GB
[[2022-12-11 21:51:172022-12-11 21:51:17..   989   989: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-11 21:51:17.  2963: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:51:17.  3000: [E2022-12-11 21:51:17 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc  3015:: 638E]  eager release cuda mem 1021/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 400000000
[2022-12-11 21:51:17.  3069: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:51:17.  4677: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 21:51:17.  5561: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 21:51:17.  6302: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:51:17.  6377: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:51:17.[  74902022-12-11 21:51:17: .E  7501 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 625663638
] eager release cuda mem 625663
[2022-12-11 21:51:17.  7605[: 2022-12-11 21:51:17W.   7617/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc: :W43 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.ccWORKER[0] alloc host memory 22.87 MB:
43] WORKER[0] alloc host memory 22.83 MB
[2022-12-11 21:51:17. 21547: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 21:51:17. 22305: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:51:17. 22882: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:51:17. 22924: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.86 GB
[2022-12-11 21:51:17. 23577: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:51:17. 23629: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:51:17. 27016: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 21:51:17. 27531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:51:17. 28465: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:51:17. 28507: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.81 MB
[2022-12-11 21:51:17. 40484: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:51:17. 41075: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:51:17. 41118: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.86 GB
[2022-12-11 21:51:17. 42571: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:51:17. 43170: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:51:17. 43211: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.86 GB
[[[2022-12-11 21:51:17[2022-12-11 21:51:172022-12-11 21:51:17.2022-12-11 21:51:17..298260.298255298256: 298276: : E: EE E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::1926:19261926] 1926] ] Device 2 init p2p of link 3] Device 3 init p2p of link 0Device 0 init p2p of link 1
Device 1 init p2p of link 2


[[2022-12-11 21:51:172022-12-11 21:51:17..[2985702985752022-12-11 21:51:17: : .EE298583  : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[E::2022-12-11 21:51:17 19801980./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] ] 298609:eager alloc mem 611.00 KBeager alloc mem 611.00 KB: 1980

E]  eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-11 21:51:17.299436: E[ 2022-12-11 21:51:17/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[.:2022-12-11 21:51:17299449638.: ] 299456Eeager release cuda mem 625663:  
E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[638:2022-12-11 21:51:17] 638.eager release cuda mem 625663] 299497
eager release cuda mem 625663: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:51:17.307026: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 21:51:17.307117: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:51:17.307260: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 21:51:17.307285: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 21:51:17.307360[[: 2022-12-11 21:51:172022-12-11 21:51:17E.. 307415307421/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: : :EE1926  ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuDevice 0 init p2p of link 2::
19801980] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[2022-12-11 21:51:17.307665: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:51:17.307890: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:51:17.308342: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 21:51:17eager release cuda mem 625663.
308360: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:51:17.308548: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:51:17.310765: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 21:51:17.310854: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:51:17.311651: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:51:17.312565: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 21:51:17.312731: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] [2022-12-11 21:51:17Device 1 init p2p of link 0.
312755: [E2022-12-11 21:51:17 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu312779:: 1980E]  eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1926[] 2022-12-11 21:51:17Device 3 init p2p of link 2.
312876: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:51:17.313031: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:51:17.313664: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 21:51:17:.638313708] : eager release cuda mem 625663E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:51:17.313928: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:51:17.314577: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 21:51:17.315384: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5984912 / 100000000 nodes ( 5.98 %~6.00 %) | remote 17339485 / 100000000 nodes ( 17.34 %) | cpu 76675603 / 100000000 nodes ( 76.68 %) | 2.86 GB | 0.406611 secs 
[2022-12-11 21:51:17.318351: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 21:51:17.318451: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 21:51:17:.638318478] : eager release cuda mem 24399996E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 21:51:17.318902: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5978831 / 100000000 nodes ( 5.98 %~6.00 %) | remote 17345566 / 100000000 nodes ( 17.35 %) | cpu 76675603 / 100000000 nodes ( 76.68 %) | 2.86 GB | 0.404667 secs 
[2022-12-11 21:51:17.319187: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5965759 / 100000000 nodes ( 5.97 %~6.00 %) | remote 17358638 / 100000000 nodes ( 17.36 %) | cpu 76675603 / 100000000 nodes ( 76.68 %) | 2.85 GB | 0.434509 secs 
[2022-12-11 21:51:17.319250: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5994895 / 100000000 nodes ( 5.99 %~6.00 %) | remote 17329502 / 100000000 nodes ( 17.33 %) | cpu 76675603 / 100000000 nodes ( 76.68 %) | 2.86 GB | 0.407095 secs 
[2022-12-11 21:51:17.320323: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.88 GB
[2022-12-11 21:51:18.194928: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.12 GB
[2022-12-11 21:51:18.195102: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.12 GB
[2022-12-11 21:51:18.195462: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.12 GB
[2022-12-11 21:51:19.195669: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.37 GB
[2022-12-11 21:51:19.196946: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.37 GB
[2022-12-11 21:51:19.197524: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.37 GB
[2022-12-11 21:51:19.940322: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.61 GB
[2022-12-11 21:51:19.940436: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.61 GB
[2022-12-11 21:51:19.940858: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.61 GB
[2022-12-11 21:51:20.709889: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.02 GB
[2022-12-11 21:51:20.710009: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.02 GB
[2022-12-11 21:51:20.710293: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.02 GB
[2022-12-11 21:51:21.478604: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.21 GB
[2022-12-11 21:51:21.478731: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.21 GB
[HCTR][21:51:21.665][ERROR][RK0][tid #140363205433088]: replica 1 calling init per replica done, doing barrier
[HCTR][21:51:21.665][ERROR][RK0][tid #140363205433088]: replica 3 calling init per replica done, doing barrier
[HCTR][21:51:21.665][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][21:51:21.665][ERROR][RK0][tid #140363197040384]: replica 0 calling init per replica done, doing barrier
[HCTR][21:51:21.665][ERROR][RK0][tid #140363197040384]: replica 0 calling init per replica done, doing barrier done
[HCTR][21:51:21.665][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][21:51:21.665][ERROR][RK0][tid #140363205433088]: replica 3 calling init per replica done, doing barrier done
[HCTR][21:51:21.665][ERROR][RK0][tid #140363205433088]: replica 1 calling init per replica done, doing barrier done
[HCTR][21:51:21.665][ERROR][RK0][tid #140363205433088]: init per replica done
[HCTR][21:51:21.665][ERROR][RK0][main]: init per replica done
[HCTR][21:51:21.665][ERROR][RK0][tid #140363205433088]: init per replica done
[HCTR][21:51:21.668][ERROR][RK0][tid #140363197040384]: init per replica done
[HCTR][21:51:21.672][ERROR][RK0][tid #140363205433088]: 3 allocated 3276800 at 0x7f96c3520000
[HCTR][21:51:21.672][ERROR][RK0][tid #140363205433088]: 3 allocated 6553600 at 0x7f922a000000
[HCTR][21:51:21.672][ERROR][RK0][tid #140363205433088]: 3 allocated 3276800 at 0x7f922a640000
[HCTR][21:51:21.672][ERROR][RK0][tid #140363205433088]: 3 allocated 6553600 at 0x7f922a960000
[HCTR][21:51:21.673][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f96bf520000
[HCTR][21:51:21.673][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f91da000000
[HCTR][21:51:21.673][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f91da640000
[HCTR][21:51:21.673][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f91da960000
[HCTR][21:51:21.673][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f96c3520000
[HCTR][21:51:21.673][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f90e6000000
[HCTR][21:51:21.673][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f90e6640000
[HCTR][21:51:21.673][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f90e6960000
[HCTR][21:51:21.677][ERROR][RK0][tid #140363197040384]: 0 allocated 3276800 at 0x7f9182320000
[HCTR][21:51:21.677][ERROR][RK0][tid #140363197040384]: 0 allocated 6553600 at 0x7f9182800000
[HCTR][21:51:21.677][ERROR][RK0][tid #140363197040384]: 0 allocated 3276800 at 0x7f918350e800
[HCTR][21:51:21.677][ERROR][RK0][tid #140363197040384]: 0 allocated 6553600 at 0x7f918382e800




