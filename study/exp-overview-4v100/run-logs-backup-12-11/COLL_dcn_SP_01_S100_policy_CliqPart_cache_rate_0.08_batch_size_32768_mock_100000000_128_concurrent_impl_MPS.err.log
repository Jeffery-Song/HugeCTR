2022-12-11 22:48:57.364537: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:48:57.379679: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:48:57.476800: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:48:57.477420: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:48:58.297900: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:48:58.297982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:48:58.303110: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:48:58.303258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:48:58.310874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:48:58.321338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:48:58.333025: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:48:58.333102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:48:58.333754: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:48:58.333848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:48:58.342890: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:48:58.343128: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:48:58.344323: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 22:48:58.346766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:48:58.350818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:48:58.354108: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:48:58.354238: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:48:58.355829: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 22:48:58.378217: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:48:58.378410: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:48:58.379377: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 22:48:58.386002: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:48:58.386188: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:48:58.387249: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][22:48:59.601][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:48:59.610][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:48:59.646][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:48:59.670][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.50s/it]warmup run: 0it [00:00, ?it/s]warmup run: 100it [00:01, 86.56it/s]warmup run: 1it [00:01,  1.56s/it]warmup run: 212it [00:01, 200.49it/s]warmup run: 105it [00:01, 87.76it/s]warmup run: 326it [00:01, 328.29it/s]warmup run: 209it [00:01, 189.45it/s]warmup run: 437it [00:01, 454.88it/s]warmup run: 315it [00:01, 304.50it/s]warmup run: 545it [00:02, 572.18it/s]warmup run: 422it [00:01, 425.69it/s]warmup run: 658it [00:02, 689.66it/s]warmup run: 527it [00:02, 541.08it/s]warmup run: 771it [00:02, 790.62it/s]warmup run: 634it [00:02, 650.50it/s]warmup run: 883it [00:02, 870.64it/s]warmup run: 740it [00:02, 744.29it/s]warmup run: 996it [00:02, 936.52it/s]warmup run: 846it [00:02, 820.55it/s]warmup run: 1109it [00:02, 987.29it/s]warmup run: 952it [00:02, 880.90it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 1222it [00:02, 1025.47it/s]warmup run: 1058it [00:02, 927.28it/s]warmup run: 111it [00:01, 99.64it/s]warmup run: 1334it [00:02, 1045.98it/s]warmup run: 1163it [00:02, 955.59it/s]warmup run: 223it [00:01, 215.86it/s]warmup run: 1445it [00:02, 1041.18it/s]warmup run: 1269it [00:02, 980.84it/s]warmup run: 336it [00:01, 343.56it/s]warmup run: 1554it [00:02, 1047.55it/s]warmup run: 1378it [00:02, 1010.52it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 449it [00:01, 474.17it/s]warmup run: 1662it [00:03, 1054.25it/s]warmup run: 1484it [00:02, 1012.89it/s]warmup run: 105it [00:01, 95.27it/s]warmup run: 563it [00:01, 601.58it/s]warmup run: 1770it [00:03, 1058.80it/s]warmup run: 1593it [00:03, 1033.41it/s]warmup run: 210it [00:01, 204.98it/s]warmup run: 677it [00:02, 717.38it/s]warmup run: 1878it [00:03, 1061.77it/s]warmup run: 1701it [00:03, 1046.03it/s]warmup run: 317it [00:01, 326.62it/s]warmup run: 791it [00:02, 815.69it/s]warmup run: 1986it [00:03, 1064.01it/s]warmup run: 1809it [00:03, 1055.95it/s]warmup run: 423it [00:01, 449.36it/s]warmup run: 904it [00:02, 894.59it/s]warmup run: 2115it [00:03, 1128.88it/s]warmup run: 1916it [00:03, 1058.77it/s]warmup run: 525it [00:01, 558.78it/s]warmup run: 1016it [00:02, 951.15it/s]warmup run: 2245it [00:03, 1178.36it/s]warmup run: 2034it [00:03, 1094.53it/s]warmup run: 633it [00:02, 670.21it/s]warmup run: 1127it [00:02, 985.33it/s]warmup run: 2378it [00:03, 1222.63it/s]warmup run: 2164it [00:03, 1155.27it/s]warmup run: 736it [00:02, 754.68it/s]warmup run: 1237it [00:02, 1015.25it/s]warmup run: 2510it [00:03, 1242.67it/s]warmup run: 2296it [00:03, 1204.08it/s]warmup run: 838it [00:02, 814.08it/s]warmup run: 1347it [00:02, 1035.22it/s]warmup run: 2642it [00:03, 1264.38it/s]warmup run: 2429it [00:03, 1239.32it/s]warmup run: 940it [00:02, 867.22it/s]warmup run: 1457it [00:02, 1050.69it/s]warmup run: 2773it [00:03, 1275.90it/s]warmup run: 2562it [00:03, 1264.32it/s]warmup run: 1042it [00:02, 907.37it/s]warmup run: 1572it [00:02, 1079.12it/s]warmup run: 2906it [00:04, 1289.93it/s]warmup run: 2695it [00:03, 1281.86it/s]warmup run: 1146it [00:02, 942.13it/s]warmup run: 3000it [00:04, 730.32it/s] warmup run: 1683it [00:02, 1068.80it/s]warmup run: 2826it [00:04, 1288.24it/s]warmup run: 1249it [00:02, 966.76it/s]warmup run: 1792it [00:03, 1069.61it/s]warmup run: 2959it [00:04, 1298.71it/s]warmup run: 3000it [00:04, 711.29it/s] warmup run: 1354it [00:02, 989.15it/s]warmup run: 1901it [00:03, 1069.62it/s]warmup run: 1461it [00:02, 1010.99it/s]warmup run: 2009it [00:03, 1072.64it/s]warmup run: 1569it [00:02, 1030.04it/s]warmup run: 2141it [00:03, 1145.10it/s]warmup run: 1677it [00:03, 1044.16it/s]warmup run: 2274it [00:03, 1197.68it/s]warmup run: 1786it [00:03, 1054.88it/s]warmup run: 2407it [00:03, 1235.13it/s]warmup run: 1893it [00:03, 1051.17it/s]warmup run: 2540it [00:03, 1263.02it/s]warmup run: 2001it [00:03, 1058.12it/s]warmup run: 2674it [00:03, 1285.20it/s]warmup run: 2137it [00:03, 1146.62it/s]warmup run: 2807it [00:03, 1297.09it/s]warmup run: 2274it [00:03, 1212.13it/s]warmup run: 2941it [00:03, 1307.98it/s]warmup run: 3000it [00:04, 746.58it/s] warmup run: 2411it [00:03, 1258.17it/s]warmup run: 2547it [00:03, 1287.96it/s]warmup run: 2682it [00:03, 1305.35it/s]warmup run: 2814it [00:03, 1309.47it/s]warmup run: 2948it [00:04, 1317.16it/s]warmup run: 3000it [00:04, 733.60it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1718.61it/s]warmup should be done:   5%|▌         | 163/3000 [00:00<00:01, 1628.81it/s]warmup should be done:   5%|▌         | 160/3000 [00:00<00:01, 1597.49it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1687.06it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1745.38it/s]warmup should be done:  11%|█         | 331/3000 [00:00<00:01, 1657.80it/s]warmup should be done:  12%|█▏        | 345/3000 [00:00<00:01, 1728.76it/s]warmup should be done:  11%|█▏        | 340/3000 [00:00<00:01, 1715.12it/s]warmup should be done:  17%|█▋        | 522/3000 [00:00<00:01, 1747.43it/s]warmup should be done:  17%|█▋        | 518/3000 [00:00<00:01, 1744.45it/s]warmup should be done:  17%|█▋        | 498/3000 [00:00<00:01, 1661.25it/s]warmup should be done:  17%|█▋        | 524/3000 [00:00<00:01, 1740.65it/s]warmup should be done:  23%|██▎       | 700/3000 [00:00<00:01, 1760.15it/s]warmup should be done:  23%|██▎       | 698/3000 [00:00<00:01, 1764.96it/s]warmup should be done:  22%|██▏       | 665/3000 [00:00<00:01, 1664.48it/s]warmup should be done:  23%|██▎       | 702/3000 [00:00<00:01, 1752.30it/s]warmup should be done:  29%|██▉       | 877/3000 [00:00<00:01, 1773.13it/s]warmup should be done:  29%|██▉       | 880/3000 [00:00<00:01, 1760.26it/s]warmup should be done:  29%|██▉       | 877/3000 [00:00<00:01, 1751.66it/s]warmup should be done:  28%|██▊       | 832/3000 [00:00<00:01, 1656.13it/s]warmup should be done:  35%|███▌      | 1056/3000 [00:00<00:01, 1776.50it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1772.69it/s]warmup should be done:  33%|███▎      | 999/3000 [00:00<00:01, 1659.14it/s]warmup should be done:  35%|███▌      | 1055/3000 [00:00<00:01, 1758.85it/s]warmup should be done:  41%|████      | 1234/3000 [00:00<00:00, 1774.78it/s]warmup should be done:  39%|███▉      | 1169/3000 [00:00<00:01, 1670.72it/s]warmup should be done:  41%|████▏     | 1238/3000 [00:00<00:00, 1767.11it/s]warmup should be done:  41%|████      | 1231/3000 [00:00<00:01, 1749.89it/s]warmup should be done:  45%|████▍     | 1339/3000 [00:00<00:00, 1678.89it/s]warmup should be done:  47%|████▋     | 1416/3000 [00:00<00:00, 1768.43it/s]warmup should be done:  47%|████▋     | 1408/3000 [00:00<00:00, 1755.92it/s]warmup should be done:  47%|████▋     | 1412/3000 [00:00<00:00, 1727.74it/s]warmup should be done:  50%|█████     | 1512/3000 [00:00<00:00, 1692.57it/s]warmup should be done:  53%|█████▎    | 1593/3000 [00:00<00:00, 1766.67it/s]warmup should be done:  53%|█████▎    | 1586/3000 [00:00<00:00, 1760.63it/s]warmup should be done:  53%|█████▎    | 1586/3000 [00:00<00:00, 1731.40it/s]warmup should be done:  56%|█████▌    | 1686/3000 [00:01<00:00, 1705.13it/s]warmup should be done:  59%|█████▉    | 1764/3000 [00:01<00:00, 1764.01it/s]warmup should be done:  59%|█████▉    | 1770/3000 [00:01<00:00, 1748.25it/s]warmup should be done:  59%|█████▉    | 1765/3000 [00:01<00:00, 1747.72it/s]warmup should be done:  62%|██████▏   | 1860/3000 [00:01<00:00, 1714.06it/s]warmup should be done:  65%|██████▍   | 1941/3000 [00:01<00:00, 1753.98it/s]warmup should be done:  65%|██████▍   | 1943/3000 [00:01<00:00, 1756.74it/s]warmup should be done:  65%|██████▍   | 1945/3000 [00:01<00:00, 1722.82it/s]warmup should be done:  68%|██████▊   | 2034/3000 [00:01<00:00, 1719.11it/s]warmup should be done:  71%|███████   | 2118/3000 [00:01<00:00, 1758.56it/s]warmup should be done:  71%|███████   | 2122/3000 [00:01<00:00, 1765.00it/s]warmup should be done:  71%|███████   | 2118/3000 [00:01<00:00, 1680.59it/s]warmup should be done:  74%|███████▎  | 2209/3000 [00:01<00:00, 1727.21it/s]warmup should be done:  76%|███████▋  | 2294/3000 [00:01<00:00, 1757.74it/s]warmup should be done:  77%|███████▋  | 2300/3000 [00:01<00:00, 1766.73it/s]warmup should be done:  76%|███████▌  | 2287/3000 [00:01<00:00, 1660.31it/s]warmup should be done:  79%|███████▉  | 2384/3000 [00:01<00:00, 1733.17it/s]warmup should be done:  82%|████████▏ | 2472/3000 [00:01<00:00, 1762.21it/s]warmup should be done:  83%|████████▎ | 2479/3000 [00:01<00:00, 1772.30it/s]warmup should be done:  82%|████████▏ | 2466/3000 [00:01<00:00, 1695.92it/s]warmup should be done:  85%|████████▌ | 2560/3000 [00:01<00:00, 1741.02it/s]warmup should be done:  88%|████████▊ | 2649/3000 [00:01<00:00, 1752.89it/s]warmup should be done:  89%|████████▊ | 2658/3000 [00:01<00:00, 1777.18it/s]warmup should be done:  88%|████████▊ | 2646/3000 [00:01<00:00, 1723.83it/s]warmup should be done:  91%|█████████ | 2737/3000 [00:01<00:00, 1746.89it/s]warmup should be done:  94%|█████████▍| 2827/3000 [00:01<00:00, 1759.93it/s]warmup should be done:  95%|█████████▍| 2838/3000 [00:01<00:00, 1781.31it/s]warmup should be done:  94%|█████████▍| 2826/3000 [00:01<00:00, 1744.56it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1761.59it/s]warmup should be done:  97%|█████████▋| 2914/3000 [00:01<00:00, 1751.83it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1755.26it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1738.18it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1709.23it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1809.42it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1618.54it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1733.83it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1615.56it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1736.37it/s]warmup should be done:  12%|█▏        | 363/3000 [00:00<00:01, 1810.14it/s]warmup should be done:  11%|█▏        | 341/3000 [00:00<00:01, 1713.56it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1767.92it/s]warmup should be done:  18%|█▊        | 526/3000 [00:00<00:01, 1773.95it/s]warmup should be done:  18%|█▊        | 545/3000 [00:00<00:01, 1807.74it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1798.05it/s]warmup should be done:  17%|█▋        | 522/3000 [00:00<00:01, 1754.56it/s]warmup should be done:  24%|██▎       | 710/3000 [00:00<00:01, 1796.79it/s]warmup should be done:  24%|██▍       | 722/3000 [00:00<00:01, 1814.47it/s]warmup should be done:  23%|██▎       | 702/3000 [00:00<00:01, 1770.34it/s]warmup should be done:  24%|██▍       | 727/3000 [00:00<00:01, 1809.07it/s]warmup should be done:  30%|██▉       | 892/3000 [00:00<00:01, 1803.71it/s]warmup should be done:  30%|███       | 908/3000 [00:00<00:01, 1808.94it/s]warmup should be done:  29%|██▉       | 881/3000 [00:00<00:01, 1775.89it/s]warmup should be done:  30%|███       | 904/3000 [00:00<00:01, 1809.48it/s]warmup should be done:  36%|███▌      | 1075/3000 [00:00<00:01, 1809.34it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1778.62it/s]warmup should be done:  36%|███▋      | 1090/3000 [00:00<00:01, 1809.26it/s]warmup should be done:  36%|███▋      | 1089/3000 [00:00<00:01, 1820.23it/s]warmup should be done:  41%|████▏     | 1238/3000 [00:00<00:00, 1778.26it/s]warmup should be done:  42%|████▏     | 1271/3000 [00:00<00:00, 1806.88it/s]warmup should be done:  42%|████▏     | 1272/3000 [00:00<00:00, 1806.94it/s]warmup should be done:  42%|████▏     | 1256/3000 [00:00<00:00, 1779.36it/s]warmup should be done:  47%|████▋     | 1418/3000 [00:00<00:00, 1782.98it/s]warmup should be done:  48%|████▊     | 1453/3000 [00:00<00:00, 1808.83it/s]warmup should be done:  49%|████▊     | 1457/3000 [00:00<00:00, 1818.59it/s]warmup should be done:  48%|████▊     | 1438/3000 [00:00<00:00, 1789.74it/s]warmup should be done:  55%|█████▍    | 1636/3000 [00:00<00:00, 1813.23it/s]warmup should be done:  53%|█████▎    | 1597/3000 [00:00<00:00, 1769.25it/s]warmup should be done:  54%|█████▍    | 1621/3000 [00:00<00:00, 1799.91it/s]warmup should be done:  55%|█████▍    | 1639/3000 [00:00<00:00, 1780.63it/s]warmup should be done:  61%|██████    | 1819/3000 [00:01<00:00, 1816.30it/s]warmup should be done:  59%|█████▉    | 1781/3000 [00:01<00:00, 1789.91it/s]warmup should be done:  60%|██████    | 1803/3000 [00:01<00:00, 1803.96it/s]warmup should be done:  61%|██████    | 1825/3000 [00:01<00:00, 1804.04it/s]warmup should be done:  67%|██████▋   | 2002/3000 [00:01<00:00, 1817.42it/s]warmup should be done:  66%|██████▌   | 1966/3000 [00:01<00:00, 1805.27it/s]warmup should be done:  66%|██████▌   | 1984/3000 [00:01<00:00, 1804.00it/s]warmup should be done:  67%|██████▋   | 2008/3000 [00:01<00:00, 1809.29it/s]warmup should be done:  73%|███████▎  | 2185/3000 [00:01<00:00, 1818.32it/s]warmup should be done:  72%|███████▏  | 2151/3000 [00:01<00:00, 1816.91it/s]warmup should be done:  73%|███████▎  | 2194/3000 [00:01<00:00, 1821.89it/s]warmup should be done:  72%|███████▏  | 2165/3000 [00:01<00:00, 1665.35it/s]warmup should be done:  78%|███████▊  | 2336/3000 [00:01<00:00, 1826.70it/s]warmup should be done:  79%|███████▉  | 2377/3000 [00:01<00:00, 1823.43it/s]warmup should be done:  79%|███████▉  | 2367/3000 [00:01<00:00, 1767.41it/s]warmup should be done:  78%|███████▊  | 2347/3000 [00:01<00:00, 1708.09it/s]warmup should be done:  84%|████████▍ | 2522/3000 [00:01<00:00, 1833.94it/s]warmup should be done:  85%|████████▌ | 2563/3000 [00:01<00:00, 1833.38it/s]warmup should be done:  85%|████████▍ | 2545/3000 [00:01<00:00, 1762.47it/s]warmup should be done:  84%|████████▍ | 2530/3000 [00:01<00:00, 1741.02it/s]warmup should be done:  90%|█████████ | 2708/3000 [00:01<00:00, 1839.85it/s]warmup should be done:  92%|█████████▏| 2747/3000 [00:01<00:00, 1833.31it/s]warmup should be done:  91%|█████████ | 2731/3000 [00:01<00:00, 1788.89it/s]warmup should be done:  90%|█████████ | 2712/3000 [00:01<00:00, 1763.63it/s]warmup should be done:  96%|█████████▋| 2893/3000 [00:01<00:00, 1841.46it/s]warmup should be done:  98%|█████████▊| 2933/3000 [00:01<00:00, 1841.25it/s]warmup should be done:  97%|█████████▋| 2917/3000 [00:01<00:00, 1807.56it/s]warmup should be done:  96%|█████████▋| 2890/3000 [00:01<00:00, 1762.03it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1817.09it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1804.41it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1800.98it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1765.57it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fb3cf228250>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fb3cf228130>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fb3cf4eadf0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fb3cf228070>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 22:50:11.900712: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7faf9d267a20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:50:11.900781: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:50:11.900919: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7faf9da641b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:50:11.900962: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:50:11.902553: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fafa526b530 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:50:11.902608: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:50:11.908721: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:50:11.909051: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:50:11.911499: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:50:12.337458: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fafa526b080 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:50:12.337523: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:50:12.344635: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:50:12.718284: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:50:12.721582: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:50:12.813832: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:50:13.098381: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:50:17.835254: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:50:18.531365: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:50:18.910389: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:50:18.999850: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][22:51:14.233][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][22:51:14.233][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][22:51:14.238][ERROR][RK0][main]: coll ps creation done
[HCTR][22:51:14.238][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][22:51:14.310][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][22:51:14.311][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][22:51:14.315][ERROR][RK0][main]: coll ps creation done
[HCTR][22:51:14.315][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][22:51:14.398][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][22:51:14.398][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][22:51:14.402][ERROR][RK0][main]: coll ps creation done
[HCTR][22:51:14.402][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][22:51:14.730][ERROR][RK0][tid #140392548792064]: replica 2 reaches 1000, calling init pre replica
[HCTR][22:51:14.730][ERROR][RK0][tid #140392548792064]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][22:51:14.733][ERROR][RK0][tid #140392548792064]: coll ps creation done
[HCTR][22:51:14.733][ERROR][RK0][tid #140392548792064]: replica 2 waits for coll ps creation barrier
[HCTR][22:51:14.733][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][22:51:15.684][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][22:51:15.725][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][22:51:15.725][ERROR][RK0][tid #140392548792064]: replica 2 calling init per replica
[HCTR][22:51:15.725][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][22:51:15.725][ERROR][RK0][main]: Calling build_v2
[HCTR][22:51:15.725][ERROR][RK0][tid #140392548792064]: Calling build_v2
[HCTR][22:51:15.725][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:51:15.725][ERROR][RK0][tid #140392548792064]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:51:15.725][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][22:51:15.725][ERROR][RK0][main]: Calling build_v2
[HCTR][22:51:15.725][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[2022-12-11 22:51:15[HCTR][22:51:15.725][ERROR][RK0][main]: Calling build_v2
2022-12-11 22:51:15..[725272725291: : E2022-12-11 22:51:15E [HCTR][22:51:15.725][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
. /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc725316/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:: :136E136]  ] using concurrent impl MPS/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccusing concurrent impl MPS
:
136] using concurrent impl MPS
[2022-12-11 22:51:15.725422: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 22:51:15.726503: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[[2022-12-11 22:51:152022-12-11 22:51:15..726563726562: : EE [ /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 22:51:15/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:.:196726586212] : ] assigning 8 to cpuEbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4
 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[[[2022-12-11 22:51:152022-12-11 22:51:152022-12-11 22:51:15...726647726641726645: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:2022-12-11 22:51:15::213.196212] 726726] ] remote time is 8.68421: assigning 8 to cpubuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4
E

 [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 22:51:15:.[2127268262022-12-11 22:51:15] : .build symm link desc with 4X Tesla V100-SXM2-16GB out of 4E726842
 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE:[ 2142022-12-11 22:51:15/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] .:cpu time is 30726875213
: ] Eremote time is 8.68421 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] [remote time is 8.684212022-12-11 22:51:15
.726915: [E2022-12-11 22:51:15 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[726931:2022-12-11 22:51:15: 214.E] 726915 cpu time is 30: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
E: 214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :cpu time is 30212
] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 22:51:15.727069: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 22:51:15.727111: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 22:51:40.702310: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 22:51:40.773850: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 22:51:40.964082: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 22:51:40.964159: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 22:51:40.964210: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 22:51:40.964250: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 22:51:40.967061: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:51:40.967142: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:51:40.969034: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:51:40.969746: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-11 22:51:40.2022-12-11 22:51:40992794.: 992802E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc[2022022-12-11 22:51:40:] .2023 solved992833] 
: 1 solvedE
[ 2022-12-11 22:51:40[/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc.2022-12-11 22:51:40:992920.202: 992934] E: 2 solved E
/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc[205:2022-12-11 22:51:40] 205.worker 0 thread 3 initing device 3] 993014
worker 0 thread 1 initing device 1: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 22:51:40.993290: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:51:40.993338: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:51:40.993418: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] [Building Coll Cache with ... num gpu device is 42022-12-11 22:51:40
.993455: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4[
2022-12-11 22:51:40.993497: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 22:51:40eager alloc mem 381.47 MB.
993517: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:51:40.995086: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:51:40.995121: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:51:40.995172: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:51:40.996579: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:51:40.996609: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB[
2022-12-11 22:51:40.996634: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:51:41. 67745: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 22:51:41. 69722: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 22:51:41. 69778: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:51:41. 70617: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:51:41. 71146: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:51:41. 72127: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:51:41. 72174: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.52 MB
[2022-12-11 22:51:41. 91047: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:51:41. 91742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:51:41. 91789: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[[[2022-12-11 22:51:412022-12-11 22:51:412022-12-11 22:51:41... 99186 99186 99186: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes


[2022-12-11 22:51:41.100988: [E2022-12-11 22:51:41 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc100998:: 638E]  eager release cuda mem 5/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] [eager release cuda mem 52022-12-11 22:51:41
.101034[: 2022-12-11 22:51:41E. 101049/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[: :2022-12-11 22:51:41E638. ] 101062/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 5: :
E638 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 400000000:
638] [eager release cuda mem 4000000002022-12-11 22:51:41
.101113: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:51:41.101945: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:51:41.102435: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:51:41.102951: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:51:41.103480: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 22:51:41eager alloc mem 611.00 KB.
103512: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:51:41.103643: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:51:41.104428: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 22:51:41:.638104441] : eager release cuda mem 625663E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:51:41.104483: W [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc2022-12-11 22:51:41:.43104496] : WORKER[0] alloc host memory 30.52 MBW
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.52 MB
[2022-12-11 22:51:41.104599: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:51:41.104641: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.52 MB
[2022-12-11 22:51:41.120726: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:51:41.120922: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:51:41.121127: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:51:41.121323: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:51:41.121366: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[2022-12-11 22:51:41.121494: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:51:41.121536: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[2022-12-11 22:51:41.121698: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:51:41.121739: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[[[[2022-12-11 22:51:412022-12-11 22:51:412022-12-11 22:51:412022-12-11 22:51:41....469237469239469235469242: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 1 init p2p of link 2Device 2 init p2p of link 3Device 0 init p2p of link 1Device 3 init p2p of link 0



[[2022-12-11 22:51:412022-12-11 22:51:41..469505469505: : EE [ /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 22:51:41/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:.:19804695281980] : ] eager alloc mem 611.00 KBEeager alloc mem 611.00 KB
 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:51:41.469764: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:51:41.470337: [E2022-12-11 22:51:41 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc470347:: 638E]  eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663[
2022-12-11 22:51:41.470386: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:51:41.470562: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:51:41.476142: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 22:51:41.476193: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[[2022-12-11 22:51:412022-12-11 22:51:41..476257476249: : [EE2022-12-11 22:51:41  ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu476285::: 19801926E] ]  eager alloc mem 611.00 KBDevice 3 init p2p of link 1/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu

:1980] [eager alloc mem 611.00 KB2022-12-11 22:51:41
.476342: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 22:51:41.476425: E[ 2022-12-11 22:51:41/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:4764441980: ] Eeager alloc mem 611.00 KB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:51:41.477091: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:51:41.477120: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:51:41.[4772542022-12-11 22:51:41: .E477258 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 625663638
] eager release cuda mem 625663
[2022-12-11 22:51:41.483267: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 22:51:41.483316: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 22:51:41.483360: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:51:41.483396: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:51:41.483554: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 22:51:41.483638: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 22:51:41:.1980483644] : eager alloc mem 611.00 KBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 22:51:41.483743: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:51:41.484141: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:51:41.484181: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:51:41.484436: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:51:41.484524: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:51:41.489562: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:51:41.489653: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:51:41.489859: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 7999999 / 100000000 nodes ( 8.00 %~8.00 %) | remote 23999997 / 100000000 nodes ( 24.00 %) | cpu 68000004 / 100000000 nodes ( 68.00 %) | 3.82 GB | 0.52273 secs 
[2022-12-11 22:51:41.489983: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 22:51:41:.638490003] : eager release cuda mem 32399996E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 7999999 / 100000000 nodes ( 8.00 %~8.00 %) | remote 23999997 / 100000000 nodes ( 24.00 %) | cpu 68000004 / 100000000 nodes ( 68.00 %) | 3.82 GB | 0.496493 secs 
[2022-12-11 22:51:41.490044: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:51:41.490350: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 7999999 / 100000000 nodes ( 8.00 %~8.00 %) | remote 23999997 / 100000000 nodes ( 24.00 %) | cpu 68000004 / 100000000 nodes ( 68.00 %) | 3.82 GB | 0.496863 secs 
[2022-12-11 22:51:41.490437: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 7999999 / 100000000 nodes ( 8.00 %~8.00 %) | remote 23999997 / 100000000 nodes ( 24.00 %) | cpu 68000004 / 100000000 nodes ( 68.00 %) | 3.82 GB | 0.497109 secs 
[2022-12-11 22:51:41.490600: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.52 GB
[2022-12-11 22:51:42.388159: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.76 GB
[2022-12-11 22:51:42.388328: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.76 GB
[2022-12-11 22:51:42.422183: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.76 GB
[2022-12-11 22:51:43.221767: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.01 GB
[2022-12-11 22:51:43.221887: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.01 GB
[2022-12-11 22:51:43.222777: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.01 GB
[2022-12-11 22:51:44.176083: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.26 GB
[2022-12-11 22:51:44.177001: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.26 GB
[2022-12-11 22:51:44.177397: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.26 GB
[2022-12-11 22:51:44.891925: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.66 GB
[2022-12-11 22:51:44.892101: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.66 GB
[2022-12-11 22:51:44.892438: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.66 GB
[2022-12-11 22:51:45.560880: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.86 GB
[2022-12-11 22:51:45.560997: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.86 GB
[HCTR][22:51:45.829][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][22:51:45.829][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][22:51:45.829][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][22:51:45.829][ERROR][RK0][tid #140392548792064]: replica 2 calling init per replica done, doing barrier
[HCTR][22:51:45.829][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][22:51:45.829][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][22:51:45.829][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][22:51:45.829][ERROR][RK0][tid #140392548792064]: replica 2 calling init per replica done, doing barrier done
[HCTR][22:51:45.829][ERROR][RK0][main]: init per replica done
[HCTR][22:51:45.829][ERROR][RK0][main]: init per replica done
[HCTR][22:51:45.829][ERROR][RK0][tid #140392548792064]: init per replica done
[HCTR][22:51:45.831][ERROR][RK0][main]: init per replica done
[HCTR][22:51:45.864][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f9504238400
[HCTR][22:51:45.864][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f9504558400
[HCTR][22:51:45.864][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f9504b98400
[HCTR][22:51:45.865][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f9504eb8400
[HCTR][22:51:45.865][ERROR][RK0][tid #140392548792064]: 3 allocated 3276800 at 0x7f9564238400
[HCTR][22:51:45.865][ERROR][RK0][tid #140392548792064]: 3 allocated 6553600 at 0x7f9564558400
[HCTR][22:51:45.865][ERROR][RK0][tid #140392548792064]: 3 allocated 3276800 at 0x7f9564b98400
[HCTR][22:51:45.865][ERROR][RK0][tid #140392548792064]: 3 allocated 6553600 at 0x7f9564eb8400
[HCTR][22:51:45.865][ERROR][RK0][tid #140392540399360]: 1 allocated 3276800 at 0x7f95ea238400
[HCTR][22:51:45.866][ERROR][RK0][tid #140392540399360]: 1 allocated 6553600 at 0x7f95ea558400
[HCTR][22:51:45.866][ERROR][RK0][tid #140392540399360]: 1 allocated 3276800 at 0x7f95eab98400
[HCTR][22:51:45.866][ERROR][RK0][tid #140392540399360]: 1 allocated 6553600 at 0x7f95eaeb8400
[HCTR][22:51:45.867][ERROR][RK0][tid #140392548792064]: 0 allocated 3276800 at 0x7f9574320000
[HCTR][22:51:45.867][ERROR][RK0][tid #140392548792064]: 0 allocated 6553600 at 0x7f9574640000
[HCTR][22:51:45.867][ERROR][RK0][tid #140392548792064]: 0 allocated 3276800 at 0x7f9574c80000
[HCTR][22:51:45.867][ERROR][RK0][tid #140392548792064]: 0 allocated 6553600 at 0x7f9574fa0000
