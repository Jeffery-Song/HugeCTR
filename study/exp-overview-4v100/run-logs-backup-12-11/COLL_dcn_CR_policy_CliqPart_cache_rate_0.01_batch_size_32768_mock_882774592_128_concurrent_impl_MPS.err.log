2022-12-11 18:40:22.458176: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:40:22.465579: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:40:22.606557: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:40:22.606556: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:40:23.359369: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:40:23.359454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 18:40:23.372625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 18:40:23.386661: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:40:23.386742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 18:40:23.399834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 18:40:23.407101: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:40:23.407252: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:40:23.409145: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 18:40:23.421507: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:40:23.421579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 18:40:23.425180: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:40:23.425264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 18:40:23.432881: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:40:23.433038: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:40:23.434380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 18:40:23.434673: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 18:40:23.438176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 18:40:23.466584: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:40:23.466745: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:40:23.468176: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 18:40:23.468618: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:40:23.468730: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:40:23.470081: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][18:40:24.661][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:40:24.679][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:40:24.721][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:40:24.742][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:00,  3.61it/s]warmup run: 1it [00:00,  3.59it/s]warmup run: 1it [00:00,  3.50it/s]warmup run: 1it [00:00,  3.51it/s]warmup run: 90it [00:00, 304.52it/s]warmup run: 87it [00:00, 293.54it/s]warmup run: 84it [00:00, 278.13it/s]warmup run: 80it [00:00, 265.48it/s]warmup run: 160it [00:00, 432.98it/s]warmup run: 158it [00:00, 428.50it/s]warmup run: 155it [00:00, 415.96it/s]warmup run: 147it [00:00, 394.23it/s]warmup run: 230it [00:00, 516.05it/s]warmup run: 230it [00:00, 520.84it/s]warmup run: 224it [00:00, 501.32it/s]warmup run: 211it [00:00, 471.11it/s]warmup run: 299it [00:00, 568.39it/s]warmup run: 300it [00:00, 576.01it/s]warmup run: 294it [00:00, 561.39it/s]warmup run: 276it [00:00, 524.23it/s]warmup run: 368it [00:00, 605.73it/s]warmup run: 370it [00:00, 611.64it/s]warmup run: 361it [00:00, 593.90it/s]warmup run: 343it [00:00, 566.49it/s]warmup run: 436it [00:00, 626.56it/s]warmup run: 442it [00:00, 643.93it/s]warmup run: 432it [00:00, 627.02it/s]warmup run: 411it [00:00, 599.40it/s]warmup run: 505it [00:00, 644.25it/s]warmup run: 512it [00:00, 658.35it/s]warmup run: 506it [00:00, 661.02it/s]warmup run: 476it [00:00, 608.26it/s]warmup run: 574it [00:01, 655.43it/s]warmup run: 587it [00:01, 684.96it/s]warmup run: 579it [00:01, 680.72it/s]warmup run: 543it [00:01, 625.31it/s]warmup run: 645it [00:01, 671.71it/s]warmup run: 658it [00:01, 691.46it/s]warmup run: 653it [00:01, 695.66it/s]warmup run: 619it [00:01, 664.63it/s]warmup run: 714it [00:01, 676.08it/s]warmup run: 737it [00:01, 719.63it/s]warmup run: 725it [00:01, 691.04it/s]warmup run: 699it [00:01, 704.69it/s]warmup run: 783it [00:01, 679.68it/s]warmup run: 816it [00:01, 740.58it/s]warmup run: 796it [00:01, 693.88it/s]warmup run: 776it [00:01, 723.48it/s]warmup run: 857it [00:01, 697.40it/s]warmup run: 891it [00:01, 738.33it/s]warmup run: 867it [00:01, 694.70it/s]warmup run: 851it [00:01, 730.23it/s]warmup run: 928it [00:01, 695.58it/s]warmup run: 966it [00:01, 738.36it/s]warmup run: 938it [00:01, 696.78it/s]warmup run: 928it [00:01, 740.42it/s]warmup run: 1002it [00:01, 708.25it/s]warmup run: 1041it [00:01, 737.75it/s]warmup run: 1009it [00:01, 693.18it/s]warmup run: 1004it [00:01, 744.75it/s]warmup run: 1074it [00:01, 711.45it/s]warmup run: 1117it [00:01, 744.13it/s]warmup run: 1083it [00:01, 706.16it/s]warmup run: 1080it [00:01, 749.04it/s]warmup run: 1148it [00:01, 717.64it/s]warmup run: 1193it [00:01, 748.13it/s]warmup run: 1158it [00:01, 716.87it/s]warmup run: 1156it [00:01, 741.29it/s]warmup run: 1268it [00:01, 743.01it/s]warmup run: 1220it [00:01, 702.33it/s]warmup run: 1233it [00:02, 726.59it/s]warmup run: 1231it [00:02, 727.13it/s]warmup run: 1291it [00:02, 694.90it/s]warmup run: 1343it [00:02, 723.54it/s]warmup run: 1306it [00:02, 721.31it/s]warmup run: 1304it [00:02, 721.92it/s]warmup run: 1417it [00:02, 726.72it/s]warmup run: 1361it [00:02, 675.59it/s]warmup run: 1379it [00:02, 706.67it/s]warmup run: 1377it [00:02, 721.07it/s]warmup run: 1429it [00:02, 660.25it/s]warmup run: 1450it [00:02, 723.46it/s]warmup run: 1450it [00:02, 693.24it/s]warmup run: 1490it [00:02, 687.85it/s]warmup run: 1523it [00:02, 725.23it/s]warmup run: 1496it [00:02, 649.45it/s]warmup run: 1569it [00:02, 714.74it/s]warmup run: 1520it [00:02, 685.80it/s]warmup run: 1598it [00:02, 730.69it/s]warmup run: 1568it [00:02, 669.29it/s]warmup run: 1650it [00:02, 740.69it/s]warmup run: 1591it [00:02, 691.89it/s]warmup run: 1678it [00:02, 750.92it/s]warmup run: 1640it [00:02, 681.47it/s]warmup run: 1732it [00:02, 761.10it/s]warmup run: 1665it [00:02, 703.91it/s]warmup run: 1755it [00:02, 754.95it/s]warmup run: 1711it [00:02, 688.20it/s]warmup run: 1740it [00:02, 717.17it/s]warmup run: 1809it [00:02, 761.74it/s]warmup run: 1835it [00:02, 767.53it/s]warmup run: 1782it [00:02, 693.16it/s]warmup run: 1815it [00:02, 724.38it/s]warmup run: 1886it [00:02, 745.63it/s]warmup run: 1900it [00:02, 760.04it/s]warmup run: 1912it [00:02, 744.66it/s]warmup run: 1852it [00:02, 683.75it/s]warmup run: 1961it [00:02, 744.69it/s]warmup run: 1977it [00:03, 746.63it/s]warmup run: 2036it [00:03, 745.83it/s]warmup run: 1987it [00:03, 729.02it/s]warmup run: 1921it [00:03, 665.54it/s]warmup run: 2052it [00:03, 739.33it/s]warmup run: 2111it [00:03, 739.38it/s]warmup run: 2061it [00:03, 715.14it/s]warmup run: 1988it [00:03, 656.39it/s]warmup run: 2186it [00:03, 738.33it/s]warmup run: 2127it [00:03, 729.73it/s]warmup run: 2055it [00:03, 658.67it/s]warmup run: 2133it [00:03, 710.26it/s]warmup run: 2260it [00:03, 732.56it/s]warmup run: 2126it [00:03, 672.54it/s]warmup run: 2201it [00:03, 713.46it/s]warmup run: 2205it [00:03, 701.64it/s]warmup run: 2334it [00:03, 734.36it/s]warmup run: 2194it [00:03, 664.93it/s]warmup run: 2276it [00:03, 696.54it/s]warmup run: 2273it [00:03, 694.26it/s]warmup run: 2411it [00:03, 742.29it/s]warmup run: 2262it [00:03, 668.29it/s]warmup run: 2346it [00:03, 694.58it/s]warmup run: 2343it [00:03, 685.42it/s]warmup run: 2487it [00:03, 747.41it/s]warmup run: 2329it [00:03, 666.85it/s]warmup run: 2417it [00:03, 696.54it/s]warmup run: 2414it [00:03, 689.60it/s]warmup run: 2562it [00:03, 730.08it/s]warmup run: 2396it [00:03, 667.03it/s]warmup run: 2487it [00:03, 692.45it/s]warmup run: 2484it [00:03, 691.25it/s]warmup run: 2463it [00:03, 667.84it/s]warmup run: 2636it [00:03, 717.38it/s]warmup run: 2557it [00:03, 687.25it/s]warmup run: 2554it [00:03, 693.30it/s]warmup run: 2530it [00:03, 666.03it/s]warmup run: 2624it [00:03, 694.86it/s]warmup run: 2626it [00:03, 666.85it/s]warmup run: 2597it [00:04, 665.77it/s]warmup run: 2708it [00:04, 462.54it/s]warmup run: 2694it [00:04, 475.83it/s]warmup run: 2781it [00:04, 517.88it/s]warmup run: 2693it [00:04, 444.29it/s]warmup run: 2664it [00:04, 450.13it/s]warmup run: 2766it [00:04, 529.29it/s]warmup run: 2853it [00:04, 563.16it/s]warmup run: 2762it [00:04, 496.71it/s]warmup run: 2732it [00:04, 500.07it/s]warmup run: 2839it [00:04, 577.18it/s]warmup run: 2929it [00:04, 611.86it/s]warmup run: 2833it [00:04, 546.08it/s]warmup run: 2798it [00:04, 537.23it/s]warmup run: 2911it [00:04, 612.49it/s]warmup run: 2906it [00:04, 590.62it/s]warmup run: 3000it [00:04, 658.27it/s]warmup run: 2861it [00:04, 560.36it/s]warmup run: 2982it [00:04, 637.29it/s]warmup run: 2977it [00:04, 620.95it/s]warmup run: 3000it [00:04, 642.21it/s]warmup run: 3000it [00:04, 639.11it/s]warmup run: 2934it [00:04, 605.59it/s]warmup run: 3000it [00:04, 622.55it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1712.47it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1691.69it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1694.68it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1702.19it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1748.43it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1732.51it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1746.73it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1745.67it/s]warmup should be done:  18%|█▊        | 529/3000 [00:00<00:01, 1770.11it/s]warmup should be done:  17%|█▋        | 524/3000 [00:00<00:01, 1747.70it/s]warmup should be done:  17%|█▋        | 524/3000 [00:00<00:01, 1745.18it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1759.40it/s]warmup should be done:  24%|██▎       | 709/3000 [00:00<00:01, 1781.73it/s]warmup should be done:  23%|██▎       | 703/3000 [00:00<00:01, 1762.56it/s]warmup should be done:  24%|██▎       | 705/3000 [00:00<00:01, 1767.32it/s]warmup should be done:  23%|██▎       | 701/3000 [00:00<00:01, 1753.81it/s]warmup should be done:  29%|██▉       | 883/3000 [00:00<00:01, 1768.96it/s]warmup should be done:  29%|██▉       | 880/3000 [00:00<00:01, 1761.13it/s]warmup should be done:  30%|██▉       | 888/3000 [00:00<00:01, 1775.54it/s]warmup should be done:  29%|██▉       | 877/3000 [00:00<00:01, 1747.26it/s]warmup should be done:  36%|███▌      | 1068/3000 [00:00<00:01, 1781.09it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1764.06it/s]warmup should be done:  35%|███▌      | 1055/3000 [00:00<00:01, 1757.11it/s]warmup should be done:  35%|███▌      | 1057/3000 [00:00<00:01, 1743.11it/s]warmup should be done:  41%|████      | 1237/3000 [00:00<00:00, 1763.55it/s]warmup should be done:  41%|████      | 1236/3000 [00:00<00:00, 1772.09it/s]warmup should be done:  42%|████▏     | 1247/3000 [00:00<00:00, 1772.40it/s]warmup should be done:  41%|████      | 1232/3000 [00:00<00:01, 1740.76it/s]warmup should be done:  47%|████▋     | 1415/3000 [00:00<00:00, 1767.46it/s]warmup should be done:  47%|████▋     | 1417/3000 [00:00<00:00, 1783.90it/s]warmup should be done:  48%|████▊     | 1425/3000 [00:00<00:00, 1772.03it/s]warmup should be done:  47%|████▋     | 1407/3000 [00:00<00:00, 1742.01it/s]warmup should be done:  53%|█████▎    | 1593/3000 [00:00<00:00, 1770.08it/s]warmup should be done:  53%|█████▎    | 1598/3000 [00:00<00:00, 1790.30it/s]warmup should be done:  53%|█████▎    | 1603/3000 [00:00<00:00, 1772.11it/s]warmup should be done:  53%|█████▎    | 1582/3000 [00:00<00:00, 1737.73it/s]warmup should be done:  59%|█████▉    | 1779/3000 [00:01<00:00, 1796.17it/s]warmup should be done:  59%|█████▉    | 1771/3000 [00:01<00:00, 1769.27it/s]warmup should be done:  59%|█████▉    | 1781/3000 [00:01<00:00, 1772.78it/s]warmup should be done:  59%|█████▊    | 1756/3000 [00:01<00:00, 1736.27it/s]warmup should be done:  65%|██████▌   | 1959/3000 [00:01<00:00, 1795.08it/s]warmup should be done:  65%|██████▍   | 1948/3000 [00:01<00:00, 1766.10it/s]warmup should be done:  65%|██████▌   | 1959/3000 [00:01<00:00, 1772.57it/s]warmup should be done:  64%|██████▍   | 1930/3000 [00:01<00:00, 1737.22it/s]warmup should be done:  71%|███████▏  | 2141/3000 [00:01<00:00, 1799.88it/s]warmup should be done:  71%|███████   | 2125/3000 [00:01<00:00, 1764.71it/s]warmup should be done:  71%|███████   | 2137/3000 [00:01<00:00, 1772.62it/s]warmup should be done:  70%|███████   | 2105/3000 [00:01<00:00, 1740.51it/s]warmup should be done:  77%|███████▋  | 2321/3000 [00:01<00:00, 1795.79it/s]warmup should be done:  77%|███████▋  | 2302/3000 [00:01<00:00, 1765.68it/s]warmup should be done:  77%|███████▋  | 2316/3000 [00:01<00:00, 1776.80it/s]warmup should be done:  76%|███████▌  | 2283/3000 [00:01<00:00, 1750.12it/s]warmup should be done:  83%|████████▎ | 2480/3000 [00:01<00:00, 1768.75it/s]warmup should be done:  83%|████████▎ | 2504/3000 [00:01<00:00, 1803.45it/s]warmup should be done:  83%|████████▎ | 2497/3000 [00:01<00:00, 1783.88it/s]warmup should be done:  82%|████████▏ | 2459/3000 [00:01<00:00, 1742.62it/s]warmup should be done:  89%|████████▊ | 2657/3000 [00:01<00:00, 1768.96it/s]warmup should be done:  90%|████████▉ | 2686/3000 [00:01<00:00, 1806.12it/s]warmup should be done:  89%|████████▉ | 2677/3000 [00:01<00:00, 1787.58it/s]warmup should be done:  88%|████████▊ | 2636/3000 [00:01<00:00, 1748.68it/s]warmup should be done:  94%|█████████▍| 2834/3000 [00:01<00:00, 1767.92it/s]warmup should be done:  95%|█████████▌| 2856/3000 [00:01<00:00, 1788.09it/s]warmup should be done:  96%|█████████▌| 2867/3000 [00:01<00:00, 1787.78it/s]warmup should be done:  94%|█████████▍| 2813/3000 [00:01<00:00, 1753.83it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1782.21it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1777.05it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1757.57it/s]warmup should be done: 100%|█████████▉| 2989/3000 [00:01<00:00, 1753.60it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1745.93it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   5%|▌         | 159/3000 [00:00<00:01, 1588.75it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1834.55it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1777.93it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1668.39it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1758.91it/s]warmup should be done:  11%|█▏        | 341/3000 [00:00<00:01, 1715.94it/s]warmup should be done:  12%|█▏        | 365/3000 [00:00<00:01, 1827.33it/s]warmup should be done:  12%|█▏        | 368/3000 [00:00<00:01, 1828.80it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1791.96it/s]warmup should be done:  18%|█▊        | 548/3000 [00:00<00:01, 1825.81it/s]warmup should be done:  18%|█▊        | 551/3000 [00:00<00:01, 1827.73it/s]warmup should be done:  17%|█▋        | 513/3000 [00:00<00:01, 1669.50it/s]warmup should be done:  24%|██▍       | 733/3000 [00:00<00:01, 1835.03it/s]warmup should be done:  24%|██▍       | 724/3000 [00:00<00:01, 1833.07it/s]warmup should be done:  24%|██▍       | 734/3000 [00:00<00:01, 1820.51it/s]warmup should be done:  23%|██▎       | 698/3000 [00:00<00:01, 1736.30it/s]warmup should be done:  31%|███       | 917/3000 [00:00<00:01, 1834.81it/s]warmup should be done:  30%|███       | 908/3000 [00:00<00:01, 1833.46it/s]warmup should be done:  31%|███       | 918/3000 [00:00<00:01, 1826.05it/s]warmup should be done:  29%|██▉       | 883/3000 [00:00<00:01, 1773.71it/s]warmup should be done:  37%|███▋      | 1097/3000 [00:00<00:01, 1850.82it/s]warmup should be done:  37%|███▋      | 1103/3000 [00:00<00:01, 1840.60it/s]warmup should be done:  37%|███▋      | 1103/3000 [00:00<00:01, 1832.79it/s]warmup should be done:  36%|███▌      | 1068/3000 [00:00<00:01, 1796.45it/s]warmup should be done:  43%|████▎     | 1285/3000 [00:00<00:00, 1859.67it/s]warmup should be done:  43%|████▎     | 1287/3000 [00:00<00:00, 1822.96it/s]warmup should be done:  43%|████▎     | 1288/3000 [00:00<00:00, 1820.99it/s]warmup should be done:  42%|████▏     | 1249/3000 [00:00<00:00, 1799.73it/s]warmup should be done:  49%|████▉     | 1475/3000 [00:00<00:00, 1870.07it/s]warmup should be done:  49%|████▉     | 1471/3000 [00:00<00:00, 1826.48it/s]warmup should be done:  49%|████▉     | 1475/3000 [00:00<00:00, 1833.61it/s]warmup should be done:  48%|████▊     | 1433/3000 [00:00<00:00, 1811.05it/s]warmup should be done:  55%|█████▌    | 1663/3000 [00:00<00:00, 1867.47it/s]warmup should be done:  55%|█████▌    | 1654/3000 [00:00<00:00, 1822.28it/s]warmup should be done:  55%|█████▌    | 1662/3000 [00:00<00:00, 1843.89it/s]warmup should be done:  54%|█████▍    | 1618/3000 [00:00<00:00, 1820.38it/s]warmup should be done:  62%|██████▏   | 1850/3000 [00:01<00:00, 1854.79it/s]warmup should be done:  61%|██████▏   | 1839/3000 [00:01<00:00, 1829.22it/s]warmup should be done:  62%|██████▏   | 1849/3000 [00:01<00:00, 1851.03it/s]warmup should be done:  60%|██████    | 1801/3000 [00:01<00:00, 1790.47it/s]warmup should be done:  67%|██████▋   | 2024/3000 [00:01<00:00, 1834.48it/s]warmup should be done:  68%|██████▊   | 2036/3000 [00:01<00:00, 1855.86it/s]warmup should be done:  68%|██████▊   | 2036/3000 [00:01<00:00, 1846.73it/s]warmup should be done:  66%|██████▌   | 1985/3000 [00:01<00:00, 1804.81it/s]warmup should be done:  74%|███████▍  | 2222/3000 [00:01<00:00, 1849.31it/s]warmup should be done:  74%|███████▍  | 2221/3000 [00:01<00:00, 1840.84it/s]warmup should be done:  72%|███████▏  | 2167/3000 [00:01<00:00, 1807.36it/s]warmup should be done:  74%|███████▎  | 2208/3000 [00:01<00:00, 1769.08it/s]warmup should be done:  80%|████████  | 2408/3000 [00:01<00:00, 1851.52it/s]warmup should be done:  80%|████████  | 2406/3000 [00:01<00:00, 1839.10it/s]warmup should be done:  80%|███████▉  | 2386/3000 [00:01<00:00, 1768.17it/s]warmup should be done:  78%|███████▊  | 2348/3000 [00:01<00:00, 1779.32it/s]warmup should be done:  86%|████████▋ | 2595/3000 [00:01<00:00, 1855.56it/s]warmup should be done:  86%|████████▋ | 2591/3000 [00:01<00:00, 1839.36it/s]warmup should be done:  85%|████████▌ | 2564/3000 [00:01<00:00, 1716.80it/s]warmup should be done:  84%|████████▍ | 2527/3000 [00:01<00:00, 1725.99it/s]warmup should be done:  93%|█████████▎| 2782/3000 [00:01<00:00, 1856.91it/s]warmup should be done:  92%|█████████▎| 2775/3000 [00:01<00:00, 1833.13it/s]warmup should be done:  91%|█████████▏| 2738/3000 [00:01<00:00, 1721.75it/s]warmup should be done:  90%|█████████ | 2703/3000 [00:01<00:00, 1734.54it/s]warmup should be done:  99%|█████████▉| 2968/3000 [00:01<00:00, 1848.78it/s]warmup should be done:  99%|█████████▊| 2959/3000 [00:01<00:00, 1830.26it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1842.52it/s]warmup should be done:  97%|█████████▋| 2913/3000 [00:01<00:00, 1727.31it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1834.73it/s]warmup should be done:  96%|█████████▌| 2877/3000 [00:01<00:00, 1680.88it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1783.76it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1751.88it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fc34d3d9160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fc34d3d90a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fc34d3d9280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fc34d478e80>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 18:41:02.858111: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fbf25264670 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:41:02.858170: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:41:02.868713: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:41:02.954499: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fbf25a68630 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:41:02.954553: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:41:02.964304: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:41:03.005354: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fbf21261070 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:41:03.005408: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:41:03.014128: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:41:03.391772: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fbf215c2a30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:41:03.391834: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:41:03.399150: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:41:03.733955: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:41:03.806441: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:41:03.824598: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:41:04.160914: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:41:05.261322: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:41:05.295119: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:41:05.509928: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:41:05.861151: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][18:42:13.633][ERROR][RK0][tid #140459347257088]: replica 2 reaches 1000, calling init pre replica
[HCTR][18:42:13.633][ERROR][RK0][tid #140459347257088]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][18:42:13.638][ERROR][RK0][tid #140459347257088]: coll ps creation done
[HCTR][18:42:13.638][ERROR][RK0][tid #140459347257088]: replica 2 waits for coll ps creation barrier
[HCTR][18:42:15.282][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][18:42:15.282][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][18:42:15.287][ERROR][RK0][main]: coll ps creation done
[HCTR][18:42:15.287][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][18:42:15.711][ERROR][RK0][tid #140459355649792]: replica 3 reaches 1000, calling init pre replica
[HCTR][18:42:15.712][ERROR][RK0][tid #140459355649792]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][18:42:15.715][ERROR][RK0][tid #140459355649792]: coll ps creation done
[HCTR][18:42:15.715][ERROR][RK0][tid #140459355649792]: replica 3 waits for coll ps creation barrier
[HCTR][18:42:15.735][ERROR][RK0][tid #140459347257088]: replica 0 reaches 1000, calling init pre replica
[HCTR][18:42:15.735][ERROR][RK0][tid #140459347257088]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][18:42:15.739][ERROR][RK0][tid #140459347257088]: coll ps creation done
[HCTR][18:42:15.739][ERROR][RK0][tid #140459347257088]: replica 0 waits for coll ps creation barrier
[HCTR][18:42:15.739][ERROR][RK0][tid #140459347257088]: replica 0 preparing frequency
[HCTR][18:42:27.618][ERROR][RK0][tid #140459347257088]: replica 0 preparing frequency done
[HCTR][18:42:27.663][ERROR][RK0][tid #140459347257088]: replica 0 calling init per replica
[HCTR][18:42:27.663][ERROR][RK0][tid #140459347257088]: Calling build_v2
[HCTR][18:42:27.663][ERROR][RK0][tid #140459355649792]: replica 3 calling init per replica
[HCTR][18:42:27.663][ERROR][RK0][tid #140459347257088]: replica 2 calling init per replica
[HCTR][18:42:27.663][ERROR][RK0][tid #140459347257088]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:42:27.663][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][18:42:27.663][ERROR][RK0][tid #140459355649792]: Calling build_v2
[HCTR][18:42:27.663][ERROR][RK0][tid #140459347257088]: Calling build_v2
[HCTR][18:42:27.663][ERROR][RK0][main]: Calling build_v2
[HCTR][18:42:27.663][ERROR][RK0][tid #140459355649792]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:42:27.663][ERROR][RK0][tid #140459347257088]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:42:27.664][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 18:42:27.664045[: E 2022-12-11 18:42:27/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc.:664068136: ] Eusing concurrent impl MPS 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:[[1362022-12-11 18:42:27] 2022-12-11 18:42:27.using concurrent impl MPS.664095
664094: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc::136136] ] using concurrent impl MPSusing concurrent impl MPS

[2022-12-11 18:42:27.665056: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 18:42:27.665115: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 18:42:27.665164: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 18:42:27.665196: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 18:42:27.665276: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 18:42:27.665305: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 18:42:27196.] 665324assigning 8 to cpu: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 18:42:27.665362: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 18:42:27212.] 665376build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[
2022-12-11 18:42:27.665432[: 2022-12-11 18:42:27[E.2022-12-11 18:42:27 665444./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 665458:E: 213 E] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc remote time is 8.68421:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
212:] 213build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[] 
2022-12-11 18:42:27remote time is 8.68421.
665550[: [2022-12-11 18:42:27E2022-12-11 18:42:27. .665578/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc665588: :: E214E ]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:
:213214] ] remote time is 8.68421cpu time is 30

[2022-12-11 18:42:27.665699: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 18:43:02.161109: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 18:43:02.647698: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 18:43:04.239545: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 18:43:04.239630: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 18:43:04.239670: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 18:43:04.239706: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 18:43:04.240343: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:43:04.240402: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:43:04.245103: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:43:04.249802: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:43:04.413946: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 18:43:04.414047: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 18:43:04.416902: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 18:43:04.416974: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[[2022-12-11 18:43:042022-12-11 18:43:04..442583442593: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::18151815] ] Building Coll Cache with ... num gpu device is 4Building Coll Cache with ... num gpu device is 4

[2022-12-11 18:43:04.442743: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 18:43:04eager alloc mem 3.29 GB.
442755: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:43:04.454487: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 18:43:04.454561: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 18:43:04.455284: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 18:43:04.455335: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:43:04.459462: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 18:43:04.459585: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 18:43:04:.1980459643] : E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 3.29 GB:
1980] eager alloc mem 3.29 GB
[2022-12-11 18:43:04.476582: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[[2022-12-11 18:43:042022-12-11 18:43:04..476747476750: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 3.29 GBeager alloc mem 3.29 GB

[2022-12-11 18:43:05. 75472: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 18:43:05. 75755: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:43:05. 89523: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 18:43:05. 89590: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:43:05. 93803: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:43:05. 94378: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:43:05.101397: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.101596: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.68 MB
[2022-12-11 18:43:05.144126: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:43:05.149083: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:43:05.149129: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.25 GB
[2022-12-11 18:43:05.198719: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 18:43:05.199060: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:43:05.212993: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 18:43:05.213039: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:43:05.227020: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:43:05.227878: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:43:05.234438: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.235299: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.68 MB
[2022-12-11 18:43:05.253802: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:43:05.259605: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:43:05.259676: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.25 GB
[2022-12-11 18:43:05.318676: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 18:43:05.318953: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:43:05.324941: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 18:43:05.325275: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 18:43:05.332785: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 18:43:05.332837: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:43:05.339104: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 18:43:05.339155: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 18:43:05.346350: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:43:05.350232: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 18:43:05.350884: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:43:05.351224: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:43:05.357936: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.358122: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.68 MB
[2022-12-11 18:43:05.358356: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.358581: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.68 MB
[2022-12-11 18:43:05.399907: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:43:05.400171: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 18:43:05.404872: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:43:05.404917: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.25 GB
[2022-12-11 18:43:05.405122: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 18:43:05.405165: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.25 GB
[[[[2022-12-11 18:43:052022-12-11 18:43:052022-12-11 18:43:052022-12-11 18:43:05....855866855865855870855867: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 2 init p2p of link 3Device 1 init p2p of link 2Device 0 init p2p of link 1Device 3 init p2p of link 0



[2022-12-11 18:43:05.856227: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB[
[2022-12-11 18:43:052022-12-11 18:43:05..856255856255: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 5.26 MBeager alloc mem 5.26 MB
[
2022-12-11 18:43:05.856304: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:43:05.862864: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05[.2022-12-11 18:43:05862976.: 862984E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 5518079] 
eager release cuda mem 5518079
[2022-12-11 18:43:05.863111: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.871111: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 18:43:05.871218: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:43:05.871420: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[[2022-12-11 18:43:052022-12-11 18:43:05..871499871510: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261980] ] Device 2 init p2p of link 0eager alloc mem 5.26 MB

[2022-12-11 18:43:05.871616: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:43:05.871677: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 18:43:05.871792: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:43:05.877214: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.877665: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.877802: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.877889: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.885108: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 18:43:05.885202: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:43:05.886421: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 18:43:05.886514: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:43:05.887195: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 18:43:05.887294: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:43:05.887416: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 18:43:05.887509: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 18:43:05.891232: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.892555: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.893361: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.893556: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 18:43:05.898079: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 18:43:05.898346: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 8827745 / 882774585 nodes ( 1.00 %~1.00 %) | remote 26483235 / 882774585 nodes ( 3.00 %) | cpu 847463605 / 882774585 nodes ( 96.00 %) | 4.25 GB | 1.65796 secs 
[2022-12-11 18:43:05.899113: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.90 GB
[2022-12-11 18:43:05.899304: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 18:43:05.899566: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 8827745 / 882774585 nodes ( 1.00 %~1.00 %) | remote 26483235 / 882774585 nodes ( 3.00 %) | cpu 847463605 / 882774585 nodes ( 96.00 %) | 4.25 GB | 1.45685 secs 
[2022-12-11 18:43:05.900698: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 18:43:05.901045: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 18:43:05.901627: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 8827745 / 882774585 nodes ( 1.00 %~1.00 %) | remote 26483235 / 882774585 nodes ( 3.00 %) | cpu 847463605 / 882774585 nodes ( 96.00 %) | 4.25 GB | 1.45891 secs 
[2022-12-11 18:43:05.902062: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 8827745 / 882774585 nodes ( 1.00 %~1.00 %) | remote 26483235 / 882774585 nodes ( 3.00 %) | cpu 847463605 / 882774585 nodes ( 96.00 %) | 4.25 GB | 1.44674 secs 
[2022-12-11 18:43:06.905728: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.15 GB
[2022-12-11 18:43:06.906088: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.15 GB
[2022-12-11 18:43:06.907363: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.15 GB
[2022-12-11 18:43:07.767420: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.39 GB
[2022-12-11 18:43:07.768030: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.39 GB
[2022-12-11 18:43:07.768370: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.39 GB
[2022-12-11 18:43:08.569104: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.64 GB
[2022-12-11 18:43:08.569257: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.64 GB
[2022-12-11 18:43:08.569599: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.64 GB
[2022-12-11 18:43:09.501350: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 15.05 GB
[2022-12-11 18:43:09.501508: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 15.05 GB
[2022-12-11 18:43:09.502163: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 15.05 GB
[2022-12-11 18:43:10.427368: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 15.24 GB
[2022-12-11 18:43:10.427499: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 15.24 GB
[HCTR][18:43:10.544][ERROR][RK0][tid #140459347257088]: replica 2 calling init per replica done, doing barrier
[HCTR][18:43:10.544][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][18:43:10.544][ERROR][RK0][tid #140459355649792]: replica 3 calling init per replica done, doing barrier
[HCTR][18:43:10.544][ERROR][RK0][tid #140459347257088]: replica 0 calling init per replica done, doing barrier
[HCTR][18:43:10.545][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][18:43:10.545][ERROR][RK0][tid #140459347257088]: replica 2 calling init per replica done, doing barrier done
[HCTR][18:43:10.545][ERROR][RK0][tid #140459347257088]: replica 0 calling init per replica done, doing barrier done
[HCTR][18:43:10.545][ERROR][RK0][tid #140459355649792]: replica 3 calling init per replica done, doing barrier done
[HCTR][18:43:10.545][ERROR][RK0][main]: init per replica done
[HCTR][18:43:10.545][ERROR][RK0][tid #140459347257088]: init per replica done
[HCTR][18:43:10.545][ERROR][RK0][tid #140459355649792]: init per replica done
[HCTR][18:43:11.065][ERROR][RK0][tid #140459347257088]: init per replica done
