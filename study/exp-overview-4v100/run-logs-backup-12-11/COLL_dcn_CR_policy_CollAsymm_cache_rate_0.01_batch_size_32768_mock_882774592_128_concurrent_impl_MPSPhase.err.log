2022-12-11 18:56:55.049550: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:56:55.134098: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:56:55.134350: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:56:55.136971: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 18:56:56.003317: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:56:56.003395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 18:56:56.016277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 18:56:56.047486: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:56:56.047640: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:56:56.049035: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 18:56:56.067153: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:56:56.067224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 18:56:56.074102: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:56:56.074170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 18:56:56.075607: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 18:56:56.075658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 18:56:56.082855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 18:56:56.088022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 18:56:56.089482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 18:56:56.110291: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:56:56.110448: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:56:56.111752: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 18:56:56.116802: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:56:56.116934: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:56:56.117346: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:56:56.117460: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 18:56:56.118141: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 18:56:56.118725: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][18:56:57.324][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:56:57.340][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:56:57.382][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
[HCTR][18:56:57.392][ERROR][RK0][main]: using mock embedding with 882774585 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:00,  3.48it/s]warmup run: 1it [00:00,  3.40it/s]warmup run: 81it [00:00, 267.63it/s]warmup run: 78it [00:00, 253.17it/s]warmup run: 151it [00:00, 406.35it/s]warmup run: 140it [00:00, 369.60it/s]warmup run: 218it [00:00, 489.15it/s]warmup run: 201it [00:00, 443.67it/s]warmup run: 291it [00:00, 562.52it/s]warmup run: 266it [00:00, 505.72it/s]warmup run: 357it [00:00, 588.51it/s]warmup run: 332it [00:00, 551.85it/s]warmup run: 425it [00:00, 615.41it/s]warmup run: 399it [00:00, 587.27it/s]warmup run: 495it [00:00, 638.54it/s]warmup run: 464it [00:00, 604.90it/s]warmup run: 568it [00:01, 664.33it/s]warmup run: 528it [00:01, 613.36it/s]warmup run: 642it [00:01, 686.86it/s]warmup run: 596it [00:01, 632.40it/s]warmup run: 1it [00:01,  1.28s/it]warmup run: 1it [00:01,  1.28s/it]warmup run: 717it [00:01, 703.75it/s]warmup run: 667it [00:01, 654.86it/s]warmup run: 82it [00:01, 81.79it/s]warmup run: 92it [00:01, 91.74it/s]warmup run: 789it [00:01, 702.31it/s]warmup run: 734it [00:01, 648.82it/s]warmup run: 167it [00:01, 177.68it/s]warmup run: 191it [00:01, 203.99it/s]warmup run: 863it [00:01, 713.00it/s]warmup run: 800it [00:01, 643.27it/s]warmup run: 252it [00:01, 279.29it/s]warmup run: 279it [00:01, 306.10it/s]warmup run: 935it [00:01, 708.88it/s]warmup run: 865it [00:01, 638.75it/s]warmup run: 333it [00:01, 373.51it/s]warmup run: 375it [00:01, 421.67it/s]warmup run: 1008it [00:01, 713.63it/s]warmup run: 930it [00:01, 634.34it/s]warmup run: 431it [00:01, 496.05it/s]warmup run: 462it [00:01, 512.17it/s]warmup run: 1082it [00:01, 720.01it/s]warmup run: 997it [00:01, 642.30it/s]warmup run: 521it [00:01, 585.32it/s]warmup run: 550it [00:01, 594.13it/s]warmup run: 1155it [00:01, 702.18it/s]warmup run: 1067it [00:01, 657.63it/s]warmup run: 608it [00:01, 652.89it/s]warmup run: 652it [00:01, 697.20it/s]warmup run: 1226it [00:02, 688.16it/s]warmup run: 1147it [00:02, 698.80it/s]warmup run: 696it [00:02, 709.55it/s]warmup run: 755it [00:02, 781.55it/s]warmup run: 1296it [00:02, 689.08it/s]warmup run: 1227it [00:02, 726.78it/s]warmup run: 795it [00:02, 784.07it/s]warmup run: 851it [00:02, 829.40it/s]warmup run: 1376it [00:02, 721.02it/s]warmup run: 1310it [00:02, 755.42it/s]warmup run: 891it [00:02, 831.30it/s]warmup run: 947it [00:02, 835.74it/s]warmup run: 1454it [00:02, 738.27it/s]warmup run: 1386it [00:02, 753.01it/s]warmup run: 993it [00:02, 883.78it/s]warmup run: 1040it [00:02, 833.02it/s]warmup run: 1528it [00:02, 732.70it/s]warmup run: 1462it [00:02, 744.00it/s]warmup run: 1098it [00:02, 930.06it/s]warmup run: 1130it [00:02, 850.04it/s]warmup run: 1602it [00:02, 719.95it/s]warmup run: 1537it [00:02, 734.62it/s]warmup run: 1196it [00:02, 874.41it/s]warmup run: 1220it [00:02, 842.16it/s]warmup run: 1677it [00:02, 728.14it/s]warmup run: 1611it [00:02, 732.14it/s]warmup run: 1295it [00:02, 905.67it/s]warmup run: 1312it [00:02, 861.81it/s]warmup run: 1685it [00:02, 726.53it/s]warmup run: 1750it [00:02, 699.49it/s]warmup run: 1389it [00:02, 915.35it/s]warmup run: 1408it [00:02, 889.80it/s]warmup run: 1758it [00:02, 726.44it/s]warmup run: 1821it [00:02, 676.11it/s]warmup run: 1483it [00:02, 879.44it/s]warmup run: 1499it [00:02, 877.79it/s]warmup run: 1831it [00:02, 722.30it/s]warmup run: 1892it [00:02, 684.29it/s]warmup run: 1574it [00:03, 885.85it/s]warmup run: 1588it [00:03, 872.98it/s]warmup run: 1904it [00:03, 724.00it/s]warmup run: 1963it [00:03, 691.17it/s]warmup run: 1664it [00:03, 884.25it/s]warmup run: 1677it [00:03, 874.21it/s]warmup run: 1978it [00:03, 726.15it/s]warmup run: 2036it [00:03, 700.63it/s]warmup run: 1776it [00:03, 906.40it/s]warmup run: 1754it [00:03, 879.04it/s]warmup run: 2051it [00:03, 721.71it/s]warmup run: 2107it [00:03, 690.63it/s]warmup run: 1880it [00:03, 944.28it/s]warmup run: 1845it [00:03, 886.78it/s]warmup run: 2124it [00:03, 723.17it/s]warmup run: 2179it [00:03, 697.49it/s]warmup run: 1945it [00:03, 919.03it/s]warmup run: 1975it [00:03, 941.34it/s]warmup run: 2197it [00:03, 723.91it/s]warmup run: 2249it [00:03, 685.63it/s]warmup run: 2049it [00:03, 952.53it/s]warmup run: 2270it [00:03, 720.66it/s]warmup run: 2070it [00:03, 893.87it/s]warmup run: 2319it [00:03, 687.10it/s]warmup run: 2155it [00:03, 981.22it/s]warmup run: 2343it [00:03, 713.32it/s]warmup run: 2161it [00:03, 879.23it/s]warmup run: 2392it [00:03, 698.03it/s]warmup run: 2256it [00:03, 988.33it/s]warmup run: 2415it [00:03, 704.62it/s]warmup run: 2472it [00:03, 727.40it/s]warmup run: 2250it [00:03, 858.87it/s]warmup run: 2356it [00:03, 976.36it/s]warmup run: 2486it [00:03, 687.75it/s]warmup run: 2545it [00:03, 724.59it/s]warmup run: 2337it [00:03, 843.31it/s]warmup run: 2454it [00:03, 951.89it/s]warmup run: 2555it [00:03, 679.97it/s]warmup run: 2618it [00:03, 725.02it/s]warmup run: 2423it [00:03, 844.91it/s]warmup run: 2550it [00:04, 936.50it/s]warmup run: 2624it [00:04, 676.14it/s]warmup run: 2508it [00:04, 796.05it/s]warmup run: 2644it [00:04, 917.34it/s]warmup run: 2589it [00:04, 776.33it/s]warmup run: 2691it [00:04, 496.94it/s]warmup run: 2668it [00:04, 756.51it/s]warmup run: 2764it [00:04, 548.04it/s]warmup run: 2692it [00:04, 439.22it/s]warmup run: 2840it [00:04, 597.94it/s]warmup run: 2736it [00:04, 603.17it/s]warmup run: 2764it [00:04, 497.52it/s]warmup run: 2913it [00:04, 631.48it/s]warmup run: 2811it [00:04, 621.94it/s]warmup run: 2832it [00:04, 538.62it/s]warmup run: 2744it [00:04, 500.02it/s]warmup run: 2982it [00:04, 640.16it/s]warmup run: 2898it [00:04, 568.70it/s]warmup run: 2884it [00:04, 639.35it/s]warmup run: 3000it [00:04, 641.79it/s]warmup run: 2816it [00:04, 544.86it/s]warmup run: 2965it [00:04, 594.61it/s]warmup run: 2956it [00:04, 648.40it/s]warmup run: 2888it [00:04, 583.58it/s]warmup run: 3000it [00:04, 621.68it/s]warmup run: 3000it [00:04, 618.85it/s]warmup run: 2955it [00:04, 602.26it/s]warmup run: 3000it [00:04, 601.44it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1734.38it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1667.35it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1771.17it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1743.64it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1745.80it/s]warmup should be done:  12%|█▏        | 346/3000 [00:00<00:01, 1736.89it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1791.03it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1759.54it/s]warmup should be done:  18%|█▊        | 526/3000 [00:00<00:01, 1763.39it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1791.81it/s]warmup should be done:  18%|█▊        | 525/3000 [00:00<00:01, 1740.52it/s]warmup should be done:  18%|█▊        | 532/3000 [00:00<00:01, 1769.11it/s]warmup should be done:  23%|██▎       | 704/3000 [00:00<00:01, 1767.57it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1797.19it/s]warmup should be done:  23%|██▎       | 700/3000 [00:00<00:01, 1741.52it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1785.66it/s]warmup should be done:  29%|██▉       | 883/3000 [00:00<00:01, 1772.77it/s]warmup should be done:  30%|███       | 900/3000 [00:00<00:01, 1796.05it/s]warmup should be done:  30%|██▉       | 895/3000 [00:00<00:01, 1792.91it/s]warmup should be done:  29%|██▉       | 875/3000 [00:00<00:01, 1739.73it/s]warmup should be done:  36%|███▌      | 1080/3000 [00:00<00:01, 1791.29it/s]warmup should be done:  36%|███▌      | 1075/3000 [00:00<00:01, 1792.05it/s]warmup should be done:  35%|███▍      | 1049/3000 [00:00<00:01, 1734.52it/s]warmup should be done:  35%|███▌      | 1061/3000 [00:00<00:01, 1731.66it/s]warmup should be done:  42%|████▏     | 1260/3000 [00:00<00:00, 1792.05it/s]warmup should be done:  42%|████▏     | 1259/3000 [00:00<00:00, 1805.69it/s]warmup should be done:  41%|████      | 1223/3000 [00:00<00:01, 1735.29it/s]warmup should be done:  41%|████      | 1235/3000 [00:00<00:01, 1728.04it/s]warmup should be done:  48%|████▊     | 1440/3000 [00:00<00:00, 1805.18it/s]warmup should be done:  47%|████▋     | 1398/3000 [00:00<00:00, 1739.02it/s]warmup should be done:  48%|████▊     | 1440/3000 [00:00<00:00, 1789.37it/s]warmup should be done:  47%|████▋     | 1413/3000 [00:00<00:00, 1741.95it/s]warmup should be done:  53%|█████▎    | 1576/3000 [00:00<00:00, 1750.71it/s]warmup should be done:  54%|█████▍    | 1619/3000 [00:00<00:00, 1785.19it/s]warmup should be done:  54%|█████▍    | 1621/3000 [00:00<00:00, 1790.21it/s]warmup should be done:  53%|█████▎    | 1591/3000 [00:00<00:00, 1752.64it/s]warmup should be done:  58%|█████▊    | 1753/3000 [00:01<00:00, 1756.20it/s]warmup should be done:  60%|█████▉    | 1798/3000 [00:01<00:00, 1782.89it/s]warmup should be done:  59%|█████▉    | 1769/3000 [00:01<00:00, 1758.56it/s]warmup should be done:  60%|██████    | 1801/3000 [00:01<00:00, 1766.00it/s]warmup should be done:  64%|██████▍   | 1931/3000 [00:01<00:00, 1760.97it/s]warmup should be done:  66%|██████▌   | 1977/3000 [00:01<00:00, 1782.69it/s]warmup should be done:  66%|██████▌   | 1981/3000 [00:01<00:00, 1775.32it/s]warmup should be done:  65%|██████▍   | 1948/3000 [00:01<00:00, 1765.53it/s]warmup should be done:  70%|███████   | 2110/3000 [00:01<00:00, 1768.22it/s]warmup should be done:  72%|███████▏  | 2156/3000 [00:01<00:00, 1783.20it/s]warmup should be done:  71%|███████   | 2126/3000 [00:01<00:00, 1769.55it/s]warmup should be done:  72%|███████▏  | 2162/3000 [00:01<00:00, 1782.79it/s]warmup should be done:  76%|███████▌  | 2287/3000 [00:01<00:00, 1768.26it/s]warmup should be done:  78%|███████▊  | 2335/3000 [00:01<00:00, 1777.41it/s]warmup should be done:  77%|███████▋  | 2305/3000 [00:01<00:00, 1775.26it/s]warmup should be done:  78%|███████▊  | 2343/3000 [00:01<00:00, 1790.65it/s]warmup should be done:  82%|████████▏ | 2468/3000 [00:01<00:00, 1778.88it/s]warmup should be done:  84%|████████▍ | 2514/3000 [00:01<00:00, 1780.23it/s]warmup should be done:  83%|████████▎ | 2486/3000 [00:01<00:00, 1783.01it/s]warmup should be done:  84%|████████▍ | 2523/3000 [00:01<00:00, 1762.14it/s]warmup should be done:  88%|████████▊ | 2646/3000 [00:01<00:00, 1773.25it/s]warmup should be done:  90%|████████▉ | 2693/3000 [00:01<00:00, 1780.66it/s]warmup should be done:  89%|████████▉ | 2666/3000 [00:01<00:00, 1787.22it/s]warmup should be done:  90%|█████████ | 2700/3000 [00:01<00:00, 1741.47it/s]warmup should be done:  96%|█████████▌| 2872/3000 [00:01<00:00, 1776.32it/s]warmup should be done:  94%|█████████▍| 2824/3000 [00:01<00:00, 1744.01it/s]warmup should be done:  95%|█████████▍| 2845/3000 [00:01<00:00, 1774.72it/s]warmup should be done:  96%|█████████▌| 2875/3000 [00:01<00:00, 1713.21it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1784.35it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1758.98it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1752.91it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1751.89it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1835.65it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1735.40it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1705.03it/s]warmup should be done:   5%|▌         | 155/3000 [00:00<00:01, 1546.00it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1748.60it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1786.05it/s]warmup should be done:  11%|█         | 327/3000 [00:00<00:01, 1643.69it/s]warmup should be done:  12%|█▏        | 368/3000 [00:00<00:01, 1787.50it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1759.30it/s]warmup should be done:  17%|█▋        | 503/3000 [00:00<00:01, 1695.59it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1819.91it/s]warmup should be done:  18%|█▊        | 552/3000 [00:00<00:01, 1808.27it/s]warmup should be done:  24%|██▎       | 710/3000 [00:00<00:01, 1782.01it/s]warmup should be done:  24%|██▍       | 726/3000 [00:00<00:01, 1822.43it/s]warmup should be done:  23%|██▎       | 679/3000 [00:00<00:01, 1719.28it/s]warmup should be done:  25%|██▍       | 737/3000 [00:00<00:01, 1821.70it/s]warmup should be done:  30%|██▉       | 896/3000 [00:00<00:01, 1808.18it/s]warmup should be done:  28%|██▊       | 855/3000 [00:00<00:01, 1733.29it/s]warmup should be done:  30%|███       | 913/3000 [00:00<00:01, 1836.97it/s]warmup should be done:  31%|███       | 923/3000 [00:00<00:01, 1832.33it/s]warmup should be done:  36%|███▌      | 1077/3000 [00:00<00:01, 1805.48it/s]warmup should be done:  37%|███▋      | 1099/3000 [00:00<00:01, 1843.33it/s]warmup should be done:  34%|███▍      | 1029/3000 [00:00<00:01, 1726.70it/s]warmup should be done:  37%|███▋      | 1109/3000 [00:00<00:01, 1839.91it/s]warmup should be done:  42%|████▏     | 1261/3000 [00:00<00:00, 1814.83it/s]warmup should be done:  43%|████▎     | 1285/3000 [00:00<00:00, 1845.90it/s]warmup should be done:  40%|████      | 1202/3000 [00:00<00:01, 1725.56it/s]warmup should be done:  43%|████▎     | 1294/3000 [00:00<00:00, 1840.68it/s]warmup should be done:  48%|████▊     | 1447/3000 [00:00<00:00, 1827.90it/s]warmup should be done:  49%|████▉     | 1471/3000 [00:00<00:00, 1849.15it/s]warmup should be done:  46%|████▌     | 1376/3000 [00:00<00:00, 1729.61it/s]warmup should be done:  49%|████▉     | 1480/3000 [00:00<00:00, 1846.63it/s]warmup should be done:  54%|█████▍    | 1633/3000 [00:00<00:00, 1835.11it/s]warmup should be done:  52%|█████▏    | 1551/3000 [00:00<00:00, 1734.62it/s]warmup should be done:  55%|█████▌    | 1656/3000 [00:00<00:00, 1831.43it/s]warmup should be done:  56%|█████▌    | 1666/3000 [00:00<00:00, 1850.01it/s]warmup should be done:  61%|██████    | 1817/3000 [00:01<00:00, 1834.79it/s]warmup should be done:  58%|█████▊    | 1726/3000 [00:01<00:00, 1736.69it/s]warmup should be done:  61%|██████▏   | 1841/3000 [00:01<00:00, 1835.87it/s]warmup should be done:  62%|██████▏   | 1852/3000 [00:01<00:00, 1852.80it/s]warmup should be done:  67%|██████▋   | 2002/3000 [00:01<00:00, 1838.68it/s]warmup should be done:  63%|██████▎   | 1901/3000 [00:01<00:00, 1738.30it/s]warmup should be done:  68%|██████▊   | 2026/3000 [00:01<00:00, 1838.64it/s]warmup should be done:  68%|██████▊   | 2038/3000 [00:01<00:00, 1847.55it/s]warmup should be done:  73%|███████▎  | 2187/3000 [00:01<00:00, 1841.23it/s]warmup should be done:  69%|██████▉   | 2076/3000 [00:01<00:00, 1739.50it/s]warmup should be done:  74%|███████▎  | 2211/3000 [00:01<00:00, 1841.25it/s]warmup should be done:  74%|███████▍  | 2224/3000 [00:01<00:00, 1849.38it/s]warmup should be done:  79%|███████▉  | 2373/3000 [00:01<00:00, 1844.02it/s]warmup should be done:  75%|███████▌  | 2250/3000 [00:01<00:00, 1736.02it/s]warmup should be done:  80%|███████▉  | 2396/3000 [00:01<00:00, 1836.48it/s]warmup should be done:  80%|████████  | 2410/3000 [00:01<00:00, 1850.23it/s]warmup should be done:  85%|████████▌ | 2558/3000 [00:01<00:00, 1838.34it/s]warmup should be done:  81%|████████  | 2424/3000 [00:01<00:00, 1735.61it/s]warmup should be done:  86%|████████▌ | 2581/3000 [00:01<00:00, 1839.72it/s]warmup should be done:  87%|████████▋ | 2596/3000 [00:01<00:00, 1851.24it/s]warmup should be done:  87%|████████▋ | 2598/3000 [00:01<00:00, 1733.55it/s]warmup should be done:  92%|█████████▏| 2767/3000 [00:01<00:00, 1843.24it/s]warmup should be done:  91%|█████████▏| 2742/3000 [00:01<00:00, 1803.27it/s]warmup should be done:  93%|█████████▎| 2782/3000 [00:01<00:00, 1840.32it/s]warmup should be done:  92%|█████████▏| 2772/3000 [00:01<00:00, 1734.38it/s]warmup should be done:  98%|█████████▊| 2952/3000 [00:01<00:00, 1845.07it/s]warmup should be done:  98%|█████████▊| 2928/3000 [00:01<00:00, 1818.34it/s]warmup should be done:  99%|█████████▉| 2967/3000 [00:01<00:00, 1841.34it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1839.73it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1835.10it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1816.64it/s]warmup should be done:  98%|█████████▊| 2948/3000 [00:01<00:00, 1741.20it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1723.06it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f8881adceb0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f8881a3d280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f8881a3d0a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f8881a3d160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 18:57:36.816441: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f8459265280 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:57:36.816499: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:57:36.824824: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:57:37.552424: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:57:38.530073: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f84595c3130 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:57:38.530135: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:57:38.530246: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f8459268560 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:57:38.530308: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:57:38.537574: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:57:38.539189: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:57:38.540214: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f8455dc7e60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 18:57:38.540263: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 18:57:38.549911: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 18:57:38.899352: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:57:39.182732: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:57:39.182746: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:57:39.285986: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 18:57:40.608336: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:57:40.615578: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 18:57:41.086392: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][18:58:49.859][ERROR][RK0][tid #140206707562240]: replica 1 reaches 1000, calling init pre replica
[HCTR][18:58:49.859][ERROR][RK0][tid #140206707562240]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:58:49.864][ERROR][RK0][tid #140206707562240]: coll ps creation done
[HCTR][18:58:49.864][ERROR][RK0][tid #140206707562240]: replica 1 waits for coll ps creation barrier
[HCTR][18:58:50.026][ERROR][RK0][tid #140206699169536]: replica 0 reaches 1000, calling init pre replica
[HCTR][18:58:50.026][ERROR][RK0][tid #140206699169536]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:58:50.031][ERROR][RK0][tid #140206699169536]: coll ps creation done
[HCTR][18:58:50.031][ERROR][RK0][tid #140206699169536]: replica 0 waits for coll ps creation barrier
[HCTR][18:58:50.346][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][18:58:50.346][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:58:50.350][ERROR][RK0][main]: coll ps creation done
[HCTR][18:58:50.350][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][18:58:50.635][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][18:58:50.635][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][18:58:50.639][ERROR][RK0][main]: coll ps creation done
[HCTR][18:58:50.639][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][18:58:50.639][ERROR][RK0][tid #140206699169536]: replica 0 preparing frequency
[HCTR][18:59:02.834][ERROR][RK0][tid #140206699169536]: replica 0 preparing frequency done
[HCTR][18:59:02.876][ERROR][RK0][tid #140206699169536]: replica 0 calling init per replica
[HCTR][18:59:02.876][ERROR][RK0][tid #140206699169536]: Calling build_v2
[HCTR][18:59:02.876][ERROR][RK0][tid #140206699169536]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:59:02.876][ERROR][RK0][tid #140206707562240]: replica 1 calling init per replica
[HCTR][18:59:02.876][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][18:59:02.876][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][18:59:02.876][ERROR][RK0][tid #140206707562240]: Calling build_v2
[HCTR][18:59:02.876][ERROR][RK0][main]: Calling build_v2
[HCTR][18:59:02.876][ERROR][RK0][main]: Calling build_v2
[HCTR][18:59:02.876][ERROR][RK0][tid #140206707562240]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[HCTR][18:59:02.876][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][18:59:02.876][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
2022-12-11 18:59:02.876520: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[[2022-12-11 18:59:02.2022-12-11 18:59:02876608.: 876616E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136:] 136using concurrent impl MPSPhase] 
using concurrent impl MPSPhase
[2022-12-11 18:59:02.876612: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[2022-12-11 18:59:02.877162: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 18:59:02.877212: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 18:59:02.877257: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 18:59:02.877289: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 18:59:02.877556: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-11 18:59:02.877578: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 18:59:02.877616: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 18:59:02.[8776552022-12-11 18:59:02: .E877655 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: 213[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] 2022-12-11 18:59:02:remote time is 8.68421.196
877681] : assigning 8 to cpuE[
 2022-12-11 18:59:02/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:877712212: ] Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 18:59:02.877753: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 18:59:02.877785: E[ 2022-12-11 18:59:02/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:877791214: ] Ecpu time is 30 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 18:59:02.877842: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 18:59:02.877871: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 18:59:37.972110: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 18:59:38.495932: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 3.29 GB
[2022-12-11 18:59:38.496032: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 3.29 GB
[2022-12-11 18:59:38.497064: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 18:59:39.468646: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 18:59:41.346353: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 2
[2022-12-11 18:59:41.346517: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 19:01:02.102650: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1001
[2022-12-11 19:01:02.102857: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 19:01:16.304043: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 19:01:16.304204: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1001
[2022-12-11 19:01:16.626495: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 19:01:16.626598: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1001 blocks, 4 devices
[2022-12-11 19:01:17.747061: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 19:01:17.764692: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 19:01:17.765729: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 19:01:17.776156: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 19:01:17.874970: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 19:01:17.877095: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 19:01:17.881255: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 19:01:17.883735: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 19:01:17.886170: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 19:01:19.409075: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 19:01:19.412709: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 19:01:19.412871: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 19:01:19.423167: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 19:01:19.423242: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 19:01:19.423277: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 19:01:19.423309: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 19:01:19.424064: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:01:19.424112: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 19:01:19.428006: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 19:01:19.431812: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 19:01:19.602263: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 19:01:19.602383: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 19:01:19.604558: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 19:01:19.604651: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 19:01:19.605090: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 19:01:19.605172: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 19:01:19.605457: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:01:19.605508: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 19:01:19.609564: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 19:01:19.613479: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[[2022-12-11 19:01:192022-12-11 19:01:19..642664642664: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::18151815] ] Building Coll Cache with ... num gpu device is 4
Building Coll Cache with ... num gpu device is 4
[[2022-12-11 19:01:192022-12-11 19:01:19..642888642892: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 3.29 GBeager alloc mem 3.29 GB

[2022-12-11 19:01:19.660497: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 19:01:19.660584: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 19:01:19.668599: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 19:01:19.668901: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.29 GB
[2022-12-11 19:01:20.256843: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 19:01:20.257183: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 19:01:20.270947: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1001
[2022-12-11 19:01:20.271018: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 19:01:20.275353: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 19:01:20.275973: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:20.283034: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:20.283295: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.50 MB
[2022-12-11 19:01:20.325824: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:01:20.330840: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:01:20.330900: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.23 GB
[2022-12-11 19:01:20.460540: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 19:01:20.460840: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 19:01:20.474705: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1001
[2022-12-11 19:01:20.474876: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 3531098340
[2022-12-11 19:01:20.479149: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 19:01:20.479880: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:20.487044: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:20.487291: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.68 MB
[2022-12-11 19:01:20.505945: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 19:01:20eager alloc mem 1001.00 Bytes.
505974: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1001.00 Bytes
[2022-12-11 19:01:20.506262: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855[] 2022-12-11 19:01:20using empty feat=27.
506281: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1855] using empty feat=27
[2022-12-11 19:01:20[.2022-12-11 19:01:20520103.: 520112E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 1001] 
eager release cuda mem 1001
[[2022-12-11 19:01:202022-12-11 19:01:20..520183520184: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 3531098340eager release cuda mem 3531098340

[2022-12-11 19:01:20.529489: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:01:20.530814: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 19:01:20.534445: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:01:20.534492: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.25 GB
[2022-12-11 19:01:20.537297: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 37.04 MB
[2022-12-11 19:01:20.608498: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:20.608702: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:20.615382: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:20.615623: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.68 MB
[2022-12-11 19:01:20.615832: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:20.616092: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 33.68 MB
[2022-12-11 19:01:20.658567: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:01:20.661268: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:01:20.662670: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:01:20.662713: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.25 GB
[2022-12-11 19:01:20.665407: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:01:20.665450: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.25 GB
[[[[2022-12-11 19:01:212022-12-11 19:01:212022-12-11 19:01:212022-12-11 19:01:21.... 66932 66932 66932 66931: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 2 init p2p of link 3Device 3 init p2p of link 0Device 0 init p2p of link 1Device 1 init p2p of link 2



[2022-12-11 19:01:21.[ 672252022-12-11 19:01:21: .E 67228 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 5.26 MB1980
] eager alloc mem 5.26 MB
[2022-12-11 19:01:21. 67280: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:21. 67326: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:21. 73773: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:21. 73824: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:21. 73898: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:21. 73936: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:21. 77012: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 19:01:21. 77113: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:21. 78058: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 19:01:21. 78161: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:21. 78747: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 19:01:21. 78853: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:21. 79721: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 19:01:21. 79815: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:21. 83123: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:21. 84158: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:21. 84883: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:21. 85721: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 19:01:21. 85788: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:2022-12-11 19:01:21638.]  85807eager release cuda mem 5518079: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:21. 87547: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 19:01:21. 87635: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:21. 87781: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 19:01:21. 87869: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:21. 87983: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 19:01:21. 88070: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.26 MB
[2022-12-11 19:01:21. 92030: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:21. 93621: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:21. 93860: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:21. 94066: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5518079
[2022-12-11 19:01:21. 96222: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 19:01:21. 96484: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8780960 / 882774585 nodes ( 0.99 %~1.00 %) | remote 6179418 / 882774585 nodes ( 0.70 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.23 GB | 1.67238 secs 
[2022-12-11 19:01:21. 96575: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 19:01:21. 96820: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8827740 / 882774585 nodes ( 1.00 %~1.00 %) | remote 6132638 / 882774585 nodes ( 0.69 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.25 GB | 1.49133 secs 
[2022-12-11 19:01:21. 96957: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 13.88 GB
[2022-12-11 19:01:21. 97220: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 19:01:21. 97423: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 38842080
[2022-12-11 19:01:21. 97479: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8827740 / 882774585 nodes ( 1.00 %~1.00 %) | remote 6132638 / 882774585 nodes ( 0.69 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.25 GB | 1.45462 secs 
[2022-12-11 19:01:21. 97681: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8827740 / 882774585 nodes ( 1.00 %~1.00 %) | remote 6132638 / 882774585 nodes ( 0.69 %) | cpu 867814207 / 882774585 nodes ( 98.31 %) | 4.25 GB | 1.45483 secs 
[2022-12-11 19:01:22. 38669: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.12 GB
[2022-12-11 19:01:22. 38807: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.12 GB
[2022-12-11 19:01:22. 39082: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 14.12 GB
[2022-12-11 19:01:22.920383: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.37 GB
[2022-12-11 19:01:22.920516: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.37 GB
[2022-12-11 19:01:22.920855: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 14.37 GB
[2022-12-11 19:01:23.791821: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.62 GB
[2022-12-11 19:01:23.791954: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.62 GB
[2022-12-11 19:01:23.792246: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 14.62 GB
[2022-12-11 19:01:23.792386: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 14.62 GB
[2022-12-11 19:01:23.792679: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 14.62 GB
[2022-12-11 19:01:24.701934: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.81 GB
[2022-12-11 19:01:24.702083: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.81 GB
[HCTR][19:01:24.891][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][19:01:24.891][ERROR][RK0][tid #140206699169536]: replica 0 calling init per replica done, doing barrier
[HCTR][19:01:24.891][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][19:01:24.891][ERROR][RK0][tid #140206707562240]: replica 1 calling init per replica done, doing barrier
[HCTR][19:01:24.891][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][19:01:24.891][ERROR][RK0][tid #140206699169536]: replica 0 calling init per replica done, doing barrier done
[HCTR][19:01:24.891][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][19:01:24.891][ERROR][RK0][tid #140206707562240]: replica 1 calling init per replica done, doing barrier done
[HCTR][19:01:24.891][ERROR][RK0][tid #140206707562240]: init per replica done
[HCTR][19:01:24.891][ERROR][RK0][main]: init per replica done
[HCTR][19:01:24.891][ERROR][RK0][main]: init per replica done
[HCTR][19:01:25.193][ERROR][RK0][tid #140206699169536]: init per replica done
