2022-12-11 23:25:44.967079: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:25:45.027381: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:25:45.028115: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:25:45.028711: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:25:45.831409: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:25:45.831507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:25:45.844349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:25:45.874647: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:25:45.874825: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:25:45.876982: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 23:25:45.899176: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:25:45.899263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:25:45.900394: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:25:45.900459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:25:45.901493: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:25:45.901550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:25:45.911682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:25:45.915598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:25:45.916226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:25:45.942175: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:25:45.942363: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:25:45.944030: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 23:25:45.945957: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:25:45.946084: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:25:45.947596: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 23:25:45.948195: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:25:45.948320: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:25:45.949763: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][23:25:46.193][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:25:46.240][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:25:47.194][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:25:47.252][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.47s/it]warmup run: 105it [00:01, 92.98it/s]warmup run: 212it [00:01, 202.89it/s]warmup run: 318it [00:01, 321.58it/s]warmup run: 1it [00:01,  1.53s/it]warmup run: 422it [00:01, 439.82it/s]warmup run: 1it [00:01,  1.49s/it]warmup run: 106it [00:01, 90.02it/s]warmup run: 527it [00:01, 556.20it/s]warmup run: 99it [00:01, 86.50it/s]warmup run: 213it [00:01, 196.26it/s]warmup run: 633it [00:02, 664.06it/s]warmup run: 205it [00:01, 194.70it/s]warmup run: 317it [00:01, 308.98it/s]warmup run: 739it [00:02, 756.61it/s]warmup run: 311it [00:01, 313.29it/s]warmup run: 420it [00:01, 424.40it/s]warmup run: 842it [00:02, 820.63it/s]warmup run: 416it [00:01, 433.29it/s]warmup run: 527it [00:02, 543.88it/s]warmup run: 945it [00:02, 872.38it/s]warmup run: 522it [00:01, 551.30it/s]warmup run: 635it [00:02, 656.10it/s]warmup run: 1048it [00:02, 915.10it/s]warmup run: 630it [00:02, 662.59it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 743it [00:02, 752.63it/s]warmup run: 1151it [00:02, 940.04it/s]warmup run: 738it [00:02, 759.17it/s]warmup run: 111it [00:01, 100.94it/s]warmup run: 854it [00:02, 839.71it/s]warmup run: 1258it [00:02, 974.55it/s]warmup run: 844it [00:02, 832.93it/s]warmup run: 222it [00:01, 217.07it/s]warmup run: 961it [00:02, 898.62it/s]warmup run: 1363it [00:02, 995.08it/s]warmup run: 949it [00:02, 889.83it/s]warmup run: 332it [00:01, 341.60it/s]warmup run: 1067it [00:02, 937.77it/s]warmup run: 1467it [00:02, 1006.72it/s]warmup run: 1054it [00:02, 931.45it/s]warmup run: 441it [00:01, 466.72it/s]warmup run: 1173it [00:02, 968.38it/s]warmup run: 1572it [00:02, 1018.93it/s]warmup run: 1159it [00:02, 964.47it/s]warmup run: 548it [00:01, 582.38it/s]warmup run: 1279it [00:02, 975.13it/s]warmup run: 1676it [00:03, 1024.91it/s]warmup run: 1268it [00:02, 997.72it/s]warmup run: 656it [00:02, 689.77it/s]warmup run: 1384it [00:02, 996.41it/s]warmup run: 1782it [00:03, 1035.27it/s]warmup run: 1374it [00:02, 1000.22it/s]warmup run: 763it [00:02, 779.17it/s]warmup run: 1490it [00:02, 1012.48it/s]warmup run: 1887it [00:03, 1026.57it/s]warmup run: 1479it [00:02, 1010.06it/s]warmup run: 870it [00:02, 851.10it/s]warmup run: 1595it [00:03, 1022.40it/s]warmup run: 1994it [00:03, 1037.58it/s]warmup run: 977it [00:02, 908.32it/s]warmup run: 1584it [00:03, 1019.75it/s]warmup run: 1701it [00:03, 1031.82it/s]warmup run: 2128it [00:03, 1126.10it/s]warmup run: 1086it [00:02, 956.47it/s]warmup run: 1692it [00:03, 1035.25it/s]warmup run: 1806it [00:03, 1037.03it/s]warmup run: 2265it [00:03, 1196.33it/s]warmup run: 1800it [00:03, 1047.79it/s]warmup run: 1193it [00:02, 986.29it/s]warmup run: 1911it [00:03, 1039.20it/s]warmup run: 2401it [00:03, 1244.44it/s]warmup run: 1301it [00:02, 1010.89it/s]warmup run: 1906it [00:03, 1044.36it/s]warmup run: 2020it [00:03, 1053.91it/s]warmup run: 2538it [00:03, 1281.22it/s]warmup run: 1410it [00:02, 1031.29it/s]warmup run: 2013it [00:03, 1050.15it/s]warmup run: 2152it [00:03, 1132.77it/s]warmup run: 2674it [00:03, 1304.02it/s]warmup run: 2146it [00:03, 1131.56it/s]warmup run: 1518it [00:02, 1040.75it/s]warmup run: 2284it [00:03, 1186.23it/s]warmup run: 2811it [00:03, 1321.63it/s]warmup run: 2278it [00:03, 1187.59it/s]warmup run: 1626it [00:02, 1050.06it/s]warmup run: 2416it [00:03, 1223.52it/s]warmup run: 2946it [00:04, 1330.01it/s]warmup run: 2410it [00:03, 1226.26it/s]warmup run: 1734it [00:03, 1057.59it/s]warmup run: 2549it [00:03, 1254.18it/s]warmup run: 3000it [00:04, 726.53it/s] warmup run: 2542it [00:03, 1251.67it/s]warmup run: 1842it [00:03, 1060.04it/s]warmup run: 2679it [00:03, 1265.80it/s]warmup run: 2673it [00:03, 1268.41it/s]warmup run: 1950it [00:03, 1064.82it/s]warmup run: 2811it [00:04, 1279.64it/s]warmup run: 2805it [00:04, 1283.42it/s]warmup run: 2071it [00:03, 1106.27it/s]warmup run: 2944it [00:04, 1292.30it/s]warmup run: 3000it [00:04, 713.32it/s] warmup run: 2936it [00:04, 1290.83it/s]warmup run: 2204it [00:03, 1172.19it/s]warmup run: 3000it [00:04, 720.56it/s] warmup run: 2339it [00:03, 1222.66it/s]warmup run: 2475it [00:03, 1262.01it/s]warmup run: 2611it [00:03, 1290.43it/s]warmup run: 2746it [00:03, 1307.37it/s]warmup run: 2882it [00:03, 1321.97it/s]warmup run: 3000it [00:04, 744.12it/s] 

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1737.84it/s]warmup should be done:   5%|▌         | 157/3000 [00:00<00:01, 1568.83it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1641.46it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1674.02it/s]warmup should be done:  11%|█▏        | 338/3000 [00:00<00:01, 1710.52it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1764.54it/s]warmup should be done:  12%|█▏        | 345/3000 [00:00<00:01, 1733.01it/s]warmup should be done:  11%|█         | 336/3000 [00:00<00:01, 1665.05it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1777.89it/s]warmup should be done:  17%|█▋        | 524/3000 [00:00<00:01, 1755.24it/s]warmup should be done:  17%|█▋        | 513/3000 [00:00<00:01, 1710.51it/s]warmup should be done:  17%|█▋        | 510/3000 [00:00<00:01, 1673.73it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1785.20it/s]warmup should be done:  23%|██▎       | 703/3000 [00:00<00:01, 1768.32it/s]warmup should be done:  23%|██▎       | 692/3000 [00:00<00:01, 1738.00it/s]warmup should be done:  23%|██▎       | 688/3000 [00:00<00:01, 1713.62it/s]warmup should be done:  30%|██▉       | 893/3000 [00:00<00:01, 1788.34it/s]warmup should be done:  29%|██▉       | 881/3000 [00:00<00:01, 1771.14it/s]warmup should be done:  29%|██▉       | 869/3000 [00:00<00:01, 1748.42it/s]warmup should be done:  29%|██▉       | 868/3000 [00:00<00:01, 1741.15it/s]warmup should be done:  36%|███▌      | 1072/3000 [00:00<00:01, 1787.66it/s]warmup should be done:  35%|███▌      | 1059/3000 [00:00<00:01, 1771.05it/s]warmup should be done:  35%|███▍      | 1046/3000 [00:00<00:01, 1755.63it/s]warmup should be done:  35%|███▍      | 1045/3000 [00:00<00:01, 1748.13it/s]warmup should be done:  42%|████▏     | 1252/3000 [00:00<00:00, 1791.51it/s]warmup should be done:  41%|████▏     | 1238/3000 [00:00<00:00, 1774.76it/s]warmup should be done:  41%|████      | 1224/3000 [00:00<00:01, 1761.35it/s]warmup should be done:  41%|████      | 1222/3000 [00:00<00:01, 1753.32it/s]warmup should be done:  48%|████▊     | 1433/3000 [00:00<00:00, 1794.25it/s]warmup should be done:  47%|████▋     | 1416/3000 [00:00<00:00, 1774.58it/s]warmup should be done:  47%|████▋     | 1398/3000 [00:00<00:00, 1755.00it/s]warmup should be done:  47%|████▋     | 1401/3000 [00:00<00:00, 1745.91it/s]warmup should be done:  54%|█████▍    | 1613/3000 [00:00<00:00, 1794.61it/s]warmup should be done:  53%|█████▎    | 1595/3000 [00:00<00:00, 1779.28it/s]warmup should be done:  52%|█████▎    | 1575/3000 [00:00<00:00, 1757.01it/s]warmup should be done:  53%|█████▎    | 1580/3000 [00:00<00:00, 1759.34it/s]warmup should be done:  60%|█████▉    | 1794/3000 [00:01<00:00, 1796.43it/s]warmup should be done:  59%|█████▉    | 1774/3000 [00:01<00:00, 1781.47it/s]warmup should be done:  58%|█████▊    | 1752/3000 [00:01<00:00, 1758.89it/s]warmup should be done:  59%|█████▊    | 1760/3000 [00:01<00:00, 1768.89it/s]warmup should be done:  66%|██████▌   | 1974/3000 [00:01<00:00, 1796.29it/s]warmup should be done:  65%|██████▌   | 1953/3000 [00:01<00:00, 1780.81it/s]warmup should be done:  65%|██████▍   | 1938/3000 [00:01<00:00, 1769.91it/s]warmup should be done:  64%|██████▍   | 1928/3000 [00:01<00:00, 1742.17it/s]warmup should be done:  72%|███████▏  | 2154/3000 [00:01<00:00, 1796.94it/s]warmup should be done:  71%|███████   | 2132/3000 [00:01<00:00, 1778.43it/s]warmup should be done:  70%|███████   | 2103/3000 [00:01<00:00, 1740.14it/s]warmup should be done:  71%|███████   | 2116/3000 [00:01<00:00, 1713.07it/s]warmup should be done:  78%|███████▊  | 2335/3000 [00:01<00:00, 1798.41it/s]warmup should be done:  77%|███████▋  | 2310/3000 [00:01<00:00, 1776.73it/s]warmup should be done:  76%|███████▌  | 2280/3000 [00:01<00:00, 1747.29it/s]warmup should be done:  76%|███████▋  | 2291/3000 [00:01<00:00, 1721.63it/s]warmup should be done:  84%|████████▍ | 2517/3000 [00:01<00:00, 1804.00it/s]warmup should be done:  83%|████████▎ | 2490/3000 [00:01<00:00, 1781.06it/s]warmup should be done:  82%|████████▏ | 2458/3000 [00:01<00:00, 1756.38it/s]warmup should be done:  82%|████████▏ | 2466/3000 [00:01<00:00, 1729.60it/s]warmup should be done:  90%|████████▉ | 2698/3000 [00:01<00:00, 1805.64it/s]warmup should be done:  89%|████████▉ | 2670/3000 [00:01<00:00, 1785.09it/s]warmup should be done:  88%|████████▊ | 2634/3000 [00:01<00:00, 1757.37it/s]warmup should be done:  88%|████████▊ | 2642/3000 [00:01<00:00, 1736.26it/s]warmup should be done:  96%|█████████▌| 2879/3000 [00:01<00:00, 1805.07it/s]warmup should be done:  95%|█████████▍| 2849/3000 [00:01<00:00, 1783.52it/s]warmup should be done:  94%|█████████▎| 2812/3000 [00:01<00:00, 1761.39it/s]warmup should be done:  94%|█████████▍| 2818/3000 [00:01<00:00, 1742.09it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1794.83it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1768.95it/s]warmup should be done: 100%|█████████▉| 2989/3000 [00:01<00:00, 1763.44it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1744.56it/s]warmup should be done: 100%|█████████▉| 2994/3000 [00:01<00:00, 1747.18it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1740.29it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 179/3000 [00:00<00:01, 1789.80it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1798.23it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1642.25it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1760.87it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1810.18it/s]warmup should be done:  12%|█▏        | 361/3000 [00:00<00:01, 1801.90it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1766.13it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1782.20it/s]warmup should be done:  18%|█▊        | 545/3000 [00:00<00:01, 1817.91it/s]warmup should be done:  18%|█▊        | 536/3000 [00:00<00:01, 1804.00it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1792.43it/s]warmup should be done:  18%|█▊        | 542/3000 [00:00<00:01, 1758.92it/s]warmup should be done:  24%|██▍       | 728/3000 [00:00<00:01, 1819.80it/s]warmup should be done:  24%|██▍       | 722/3000 [00:00<00:01, 1822.87it/s]warmup should be done:  24%|██▍       | 719/3000 [00:00<00:01, 1795.85it/s]warmup should be done:  24%|██▍       | 726/3000 [00:00<00:01, 1788.37it/s]warmup should be done:  30%|███       | 910/3000 [00:00<00:01, 1818.03it/s]warmup should be done:  30%|███       | 908/3000 [00:00<00:01, 1833.43it/s]warmup should be done:  30%|███       | 902/3000 [00:00<00:01, 1804.97it/s]warmup should be done:  30%|███       | 910/3000 [00:00<00:01, 1805.87it/s]warmup should be done:  36%|███▋      | 1093/3000 [00:00<00:01, 1821.04it/s]warmup should be done:  36%|███▋      | 1094/3000 [00:00<00:01, 1841.82it/s]warmup should be done:  36%|███▌      | 1086/3000 [00:00<00:01, 1813.71it/s]warmup should be done:  36%|███▋      | 1091/3000 [00:00<00:01, 1757.27it/s]warmup should be done:  43%|████▎     | 1276/3000 [00:00<00:00, 1823.33it/s]warmup should be done:  43%|████▎     | 1279/3000 [00:00<00:00, 1842.83it/s]warmup should be done:  42%|████▏     | 1268/3000 [00:00<00:00, 1813.60it/s]warmup should be done:  42%|████▏     | 1269/3000 [00:00<00:00, 1763.51it/s]warmup should be done:  49%|████▊     | 1461/3000 [00:00<00:00, 1828.94it/s]warmup should be done:  49%|████▉     | 1467/3000 [00:00<00:00, 1851.89it/s]warmup should be done:  48%|████▊     | 1452/3000 [00:00<00:00, 1819.08it/s]warmup should be done:  49%|████▊     | 1457/3000 [00:00<00:00, 1798.13it/s]warmup should be done:  55%|█████▍    | 1644/3000 [00:00<00:00, 1826.23it/s]warmup should be done:  55%|█████▌    | 1655/3000 [00:00<00:00, 1857.52it/s]warmup should be done:  55%|█████▍    | 1636/3000 [00:00<00:00, 1823.54it/s]warmup should be done:  55%|█████▍    | 1645/3000 [00:00<00:00, 1820.57it/s]warmup should be done:  61%|██████    | 1827/3000 [00:01<00:00, 1823.97it/s]warmup should be done:  61%|██████▏   | 1843/3000 [00:01<00:00, 1861.97it/s]warmup should be done:  61%|██████    | 1820/3000 [00:01<00:00, 1826.96it/s]warmup should be done:  61%|██████    | 1832/3000 [00:01<00:00, 1834.53it/s]warmup should be done:  67%|██████▋   | 2010/3000 [00:01<00:00, 1818.29it/s]warmup should be done:  68%|██████▊   | 2030/3000 [00:01<00:00, 1859.91it/s]warmup should be done:  67%|██████▋   | 2003/3000 [00:01<00:00, 1813.16it/s]warmup should be done:  67%|██████▋   | 2018/3000 [00:01<00:00, 1839.27it/s]warmup should be done:  74%|███████▍  | 2216/3000 [00:01<00:00, 1859.22it/s]warmup should be done:  73%|███████▎  | 2185/3000 [00:01<00:00, 1813.27it/s]warmup should be done:  73%|███████▎  | 2192/3000 [00:01<00:00, 1788.77it/s]warmup should be done:  73%|███████▎  | 2203/3000 [00:01<00:00, 1838.41it/s]warmup should be done:  80%|████████  | 2402/3000 [00:01<00:00, 1854.58it/s]warmup should be done:  79%|███████▉  | 2367/3000 [00:01<00:00, 1812.41it/s]warmup should be done:  79%|███████▉  | 2373/3000 [00:01<00:00, 1794.84it/s]warmup should be done:  80%|███████▉  | 2387/3000 [00:01<00:00, 1831.25it/s]warmup should be done:  86%|████████▋ | 2589/3000 [00:01<00:00, 1856.27it/s]warmup should be done:  85%|████████▍ | 2549/3000 [00:01<00:00, 1812.87it/s]warmup should be done:  85%|████████▌ | 2553/3000 [00:01<00:00, 1791.81it/s]warmup should be done:  86%|████████▌ | 2571/3000 [00:01<00:00, 1827.44it/s]warmup should be done:  93%|█████████▎| 2776/3000 [00:01<00:00, 1857.58it/s]warmup should be done:  91%|█████████ | 2731/3000 [00:01<00:00, 1814.10it/s]warmup should be done:  91%|█████████ | 2735/3000 [00:01<00:00, 1799.69it/s]warmup should be done:  92%|█████████▏| 2758/3000 [00:01<00:00, 1838.13it/s]warmup should be done:  99%|█████████▊| 2962/3000 [00:01<00:00, 1857.79it/s]warmup should be done:  97%|█████████▋| 2913/3000 [00:01<00:00, 1801.44it/s]warmup should be done:  97%|█████████▋| 2916/3000 [00:01<00:00, 1791.60it/s]warmup should be done:  98%|█████████▊| 2945/3000 [00:01<00:00, 1846.44it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1843.68it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1817.24it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1808.62it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1807.32it/s]2022-12-11 23:27:01.856475: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f310a264f80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:27:01.856541: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:27:01.965006: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f3106a67a60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:27:01.965063: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:27:02.002530: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f310a26ac40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:27:02.002596: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:27:03.464387: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:27:03.559324: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:27:03.808361: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:27:04.592852: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:27:04.667575: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:27:04.936745: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:27:06.032475: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:27:06.092655: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:27:06.351142: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:27:11.540200: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f310a267550 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:27:11.540258: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:27:13.144091: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:27:14.222610: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:27:15.619368: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][23:27:46.780][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][23:27:46.780][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:27:46.786][ERROR][RK0][main]: coll ps creation done
[HCTR][23:27:46.786][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][23:27:46.937][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][23:27:46.938][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:27:46.942][ERROR][RK0][main]: coll ps creation done
[HCTR][23:27:46.942][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][23:27:47.098][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][23:27:47.098][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:27:47.102][ERROR][RK0][main]: coll ps creation done
[HCTR][23:27:47.102][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][23:27:47.183][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][23:27:47.183][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:27:47.186][ERROR][RK0][main]: coll ps creation done
[HCTR][23:27:47.187][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][23:27:47.187][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][23:27:48.146][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][23:27:48.183][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][23:27:48.183][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][23:27:48.183][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][23:27:48.183][ERROR][RK0][main]: Calling build_v2
[HCTR][23:27:48.183][ERROR][RK0][main]: Calling build_v2
[HCTR][23:27:48.183][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:27:48.183][ERROR][RK0][main]: Calling build_v2
[HCTR][23:27:48.183][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:27:48.183][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][23:27:48.183][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[2022-12-11 23:27:48.183830: 2022-12-11 23:27:48E[HCTR][23:27:48.183][ERROR][RK0][main]: Calling build_v2
. 183834/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: [:E136 2022-12-11 23:27:48] /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc.[HCTR][23:27:48.183][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
using concurrent impl MPS:183877
136: ] Eusing concurrent impl MPS 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 23:27:48.184029: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 23:27:48.185320[: 2022-12-11 23:27:48E. 185342/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E196 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpu:
196] assigning 8 to cpu
[[2022-12-11 23:27:48[2022-12-11 23:27:48.[2022-12-11 23:27:48.1854362022-12-11 23:27:48.185425: .185454: E185463: E : E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] :196] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4212] assigning 8 to cpu
] assigning 8 to cpu
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[
2022-12-11 23:27:48.185679: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213[] 2022-12-11 23:27:48remote time is 8.68421.
185707[[: 2022-12-11 23:27:482022-12-11 23:27:48E.. 185715185737/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: : :EE213  ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421::
212214] [] build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 23:27:48cpu time is 30[
.
2022-12-11 23:27:48185853.: 185848E[:  2022-12-11 23:27:48E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc. :185905/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214: :] E212cpu time is 30 ] 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4:
213] remote time is 8.68421[
2022-12-11 23:27:48.186037: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 23:27:48213.] 186058remote time is 8.68421: 
E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 23:27:48:.214186113] : cpu time is 30E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 23:28:12.632928: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 23:28:12.692982: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 23:28:12.693078: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 23:28:12.694138: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 23:28:12.826630: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 23:28:13.204240: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 23:28:13.204355: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 23:28:20.787856: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 23:28:20.787995: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 23:28:22.534708: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 23:28:22.534908: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 23:28:22.571726: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 23:28:22.571817: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 23:28:23.602422: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 23:28:23.620152: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 23:28:23.621576: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 23:28:23.632316: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 23:28:23.733724: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 23:28:32.453123: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 23:28:32.458458: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 23:28:32.461663: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 23:28:32.472330: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 23:28:32.472393: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 23:28:32.472427: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 23:28:32.472457: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 23:28:32.473605: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:28:32.473652: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:28:32.474896: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:28:32.475474: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-11 23:28:32.4942302022-12-11 23:28:32: .E494238 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 202/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :1 solved202
] 3 solved
[2022-12-11 23:28:32.[4943462022-12-11 23:28:32: .E494353 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 205/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :worker 0 thread 1 initing device 1205
] worker 0 thread 3 initing device 3
[2022-12-11 23:28:32.495090: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:28:32.495146: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:28:32.495237: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:28:32.495294: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:28:32.496003: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 23:28:32.496118: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 23:28:32.496475: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:28:32.496517: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:28:32.496974: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:28:32.497029: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:28:32.497997: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB[
2022-12-11 23:28:32.498023: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:28:32.498981: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:28:32.499649: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-11 23:28:322022-12-11 23:28:32..569734569734: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[[2022-12-11 23:28:322022-12-11 23:28:32..571638571639: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 1021eager release cuda mem 1021

[[2022-12-11 23:28:322022-12-11 23:28:32..571715571716: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 400000000eager release cuda mem 400000000

[2022-12-11 23:28:32.572586: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:28:32.573077: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:28:32.573565: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-11 23:28:32] .eager alloc mem 611.00 KB573584
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:28:32.574548: [E2022-12-11 23:28:32 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc574560:: 638E]  eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-11 23:28:32.574624: [W2022-12-11 23:28:32 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc574632:: 43W]  WORKER[0] alloc host memory 38.08 MB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc
:43] WORKER[0] alloc host memory 38.06 MB
[2022-12-11 23:28:32.575565: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:28:32.577417: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:28:32.577469: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:28:32.578242: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:28:32.578731: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:28:32.579676: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:28:32.579720: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.10 MB
[2022-12-11 23:28:32.597267: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:28:32.597877: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:28:32.597919: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[2022-12-11 23:28:32.605316: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 23:28:32.607181: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 23:28:32.607235: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:28:32.607950: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 38.53 MB
[2022-12-11 23:28:32.608331: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:28:32.609308: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:28:32.609353: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 38.13 MB
[2022-12-11 23:28:32.620700: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:28:32.621187: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:28:32.621293: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:28:32.621337: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.76 GB
[2022-12-11 23:28:32.621760: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:28:32.621801: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.76 GB
[2022-12-11 23:28:32.628157: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:28:32.628744: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:28:32.628785: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.77 GB
[[[[2022-12-11 23:28:332022-12-11 23:28:332022-12-11 23:28:332022-12-11 23:28:33.... 54220 54220 54221 54221: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 0 init p2p of link 1Device 2 init p2p of link 3Device 3 init p2p of link 0Device 1 init p2p of link 2



[[2022-12-11 23:28:33[2022-12-11 23:28:33.2022-12-11 23:28:33[. 54589.2022-12-11 23:28:33 54595:  54597.: E:  54608E E:  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :1980:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980] 1980:] eager alloc mem 611.00 KB] 1980eager alloc mem 611.00 KB
eager alloc mem 611.00 KB] 

eager alloc mem 611.00 KB
[2022-12-11 23:28:33. 55570: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 23:28:33:[.[6382022-12-11 23:28:33 555832022-12-11 23:28:33] .: .eager release cuda mem 625663 55594E 55604
:  : E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:] :638eager release cuda mem 625663638] 
] eager release cuda mem 625663eager release cuda mem 625663

[2022-12-11 23:28:33. 60770: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 23:28:33. 60876: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:28:33. 61691: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:28:33. 61741: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 23:28:33. 61911: [E2022-12-11 23:28:33[ .2022-12-11 23:28:33/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu 61907.::  619381980E: ]  Eeager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu 
:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1926:] 1926Device 3 init p2p of link 1] 
Device 0 init p2p of link 2
[2022-12-11 23:28:33.[ 621802022-12-11 23:28:33: .E 62196 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 611.00 KB1980
] eager alloc mem 611.00 KB
[2022-12-11 23:28:33. 62848: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:28:33. 63090: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-11 23:28:33
. 63120: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:28:33. 66327: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 23:28:33. 66410: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:28:33. 67216: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:28:33. 67794: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 23:28:33. 67911: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:28:33. 68322: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 23:28:33. 68443: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:28:33. 68614: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 23:28:33. 68705: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:28:33. 68750: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:28:33. 69265: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:28:33. 69493: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:28:33. 71402: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:28:33. 71689: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9976472 / 100000000 nodes ( 9.98 %~10.00 %) | remote 26352358 / 100000000 nodes ( 26.35 %) | cpu 63671170 / 100000000 nodes ( 63.67 %) | 4.76 GB | 0.576561 secs 
[2022-12-11 23:28:33. 73404: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:28:33. 73680: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9982121 / 100000000 nodes ( 9.98 %~10.00 %) | remote 26346709 / 100000000 nodes ( 26.35 %) | cpu 63671170 / 100000000 nodes ( 63.67 %) | 4.76 GB | 0.578404 secs 
[2022-12-11 23:28:33. 73931: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:28:33. 74278: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 40400000
[2022-12-11 23:28:33. 75218: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9994994 / 100000000 nodes ( 9.99 %~10.00 %) | remote 26333836 / 100000000 nodes ( 26.33 %) | cpu 63671170 / 100000000 nodes ( 63.67 %) | 4.77 GB | 0.578202 secs 
[2022-12-11 23:28:33. 76313: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 9987872 / 100000000 nodes ( 9.99 %~10.00 %) | remote 26340958 / 100000000 nodes ( 26.34 %) | cpu 63671170 / 100000000 nodes ( 63.67 %) | 4.77 GB | 0.602668 secs 
[2022-12-11 23:28:33. 77306: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.80 GB
[2022-12-11 23:28:34. 79083: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.04 GB
[2022-12-11 23:28:34. 79721: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.04 GB
[2022-12-11 23:28:34. 80168: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.04 GB
[2022-12-11 23:28:34.827982: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.29 GB
[2022-12-11 23:28:34.828100: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.29 GB
[2022-12-11 23:28:34.828521: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.29 GB
[2022-12-11 23:28:35.744757: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.53 GB
[2022-12-11 23:28:35.744896: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.53 GB
[2022-12-11 23:28:35.746187: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.53 GB
[2022-12-11 23:28:36.448843: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.94 GB
[2022-12-11 23:28:36.448974: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.94 GB
[2022-12-11 23:28:36.449770: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.94 GB
[2022-12-11 23:28:37.104877: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.13 GB
[2022-12-11 23:28:37.105004: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.13 GB
[HCTR][23:28:37.351][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][23:28:37.351][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][23:28:37.351][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][23:28:37.351][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][23:28:37.351][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][23:28:37.351][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][23:28:37.351][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][23:28:37.351][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][23:28:37.351][ERROR][RK0][main]: init per replica done
[HCTR][23:28:37.351][ERROR][RK0][main]: init per replica done
[HCTR][23:28:37.351][ERROR][RK0][main]: init per replica done
[HCTR][23:28:37.354][ERROR][RK0][main]: init per replica done
[HCTR][23:28:37.359][ERROR][RK0][tid #139848832775936]: 3 allocated 3276800 at 0x7f1f07720000
[HCTR][23:28:37.359][ERROR][RK0][tid #139848832775936]: 3 allocated 6553600 at 0x7f1f0a800000
[HCTR][23:28:37.359][ERROR][RK0][tid #139848832775936]: 3 allocated 3276800 at 0x7f1f0ae40000
[HCTR][23:28:37.359][ERROR][RK0][tid #139848832775936]: 3 allocated 6553600 at 0x7f1f0b160000
[HCTR][23:28:37.360][ERROR][RK0][tid #139849319290624]: 2 allocated 3276800 at 0x7f1f07720000
[HCTR][23:28:37.360][ERROR][RK0][tid #139849319290624]: 2 allocated 6553600 at 0x7f1f0a800000
[HCTR][23:28:37.360][ERROR][RK0][tid #139849319290624]: 2 allocated 3276800 at 0x7f1f0ae40000
[HCTR][23:28:37.360][ERROR][RK0][tid #139849319290624]: 2 allocated 6553600 at 0x7f1f0b160000
[HCTR][23:28:37.362][ERROR][RK0][tid #139848832775936]: 0 allocated 3276800 at 0x7f329b120000
[HCTR][23:28:37.362][ERROR][RK0][tid #139848832775936]: 0 allocated 6553600 at 0x7f329b600000
[HCTR][23:28:37.362][ERROR][RK0][tid #139848832775936]: 0 allocated 3276800 at 0x7f19aa50e800
[HCTR][23:28:37.362][ERROR][RK0][tid #139848832775936]: 0 allocated 6553600 at 0x7f19aa82e800
[HCTR][23:28:37.363][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f1f07720000
[HCTR][23:28:37.364][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f1f0a800000
[HCTR][23:28:37.364][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f1f0ae40000
[HCTR][23:28:37.364][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f1f0b160000




