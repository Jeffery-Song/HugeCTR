2022-12-11 21:06:30.836369: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:06:30.846163: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:06:30.918982: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:06:30.919467: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:06:31.730184: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:06:31.730269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:06:31.743105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:06:31.753310: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:06:31.753454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:06:31.766226: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:06:31.766311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:06:31.766418: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:06:31.766488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:06:31.769811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:06:31.775369: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:06:31.775527: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:06:31.776353: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 21:06:31.778997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:06:31.780699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:06:31.804636: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:06:31.804823: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:06:31.806557: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 21:06:31.812518: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:06:31.812533: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:06:31.812658: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:06:31.812661: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:06:31.813449: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 21:06:31.813456: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][21:06:33.981][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:06:33.991][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:06:34.022][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:06:34.024][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.60s/it]warmup run: 93it [00:01, 75.90it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 188it [00:01, 167.31it/s]warmup run: 103it [00:01, 94.27it/s]warmup run: 286it [00:01, 272.87it/s]warmup run: 212it [00:01, 209.66it/s]warmup run: 391it [00:02, 394.41it/s]warmup run: 322it [00:01, 336.10it/s]warmup run: 494it [00:02, 509.97it/s]warmup run: 433it [00:01, 466.36it/s]warmup run: 602it [00:02, 627.41it/s]warmup run: 540it [00:01, 582.95it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 711it [00:02, 732.10it/s]warmup run: 101it [00:01, 92.09it/s]warmup run: 642it [00:02, 656.01it/s]warmup run: 0it [00:00, ?it/s]warmup run: 813it [00:02, 792.06it/s]warmup run: 748it [00:02, 749.01it/s]warmup run: 212it [00:01, 209.51it/s]warmup run: 917it [00:02, 855.51it/s]warmup run: 854it [00:02, 825.94it/s]warmup run: 317it [00:01, 328.16it/s]warmup run: 1026it [00:02, 916.93it/s]warmup run: 962it [00:02, 890.59it/s]warmup run: 427it [00:01, 457.59it/s]warmup run: 1136it [00:02, 965.15it/s]warmup run: 1071it [00:02, 942.75it/s]warmup run: 536it [00:01, 579.34it/s]warmup run: 1245it [00:02, 997.40it/s]warmup run: 1181it [00:02, 985.28it/s]warmup run: 638it [00:02, 673.47it/s]warmup run: 1359it [00:02, 1035.98it/s]warmup run: 1289it [00:02, 1012.20it/s]warmup run: 751it [00:02, 780.18it/s]warmup run: 1469it [00:03, 1052.68it/s]warmup run: 1398it [00:02, 1034.37it/s]warmup run: 859it [00:02, 854.48it/s]warmup run: 1578it [00:03, 1040.04it/s]warmup run: 1506it [00:02, 1047.27it/s]warmup run: 969it [00:02, 916.63it/s]warmup run: 1685it [00:03, 1032.47it/s]warmup run: 1614it [00:02, 1052.79it/s]warmup run: 1076it [00:02, 950.71it/s]warmup run: 1790it [00:03, 1029.26it/s]warmup run: 1725it [00:03, 1067.30it/s]warmup run: 1182it [00:02, 979.85it/s]warmup run: 1901it [00:03, 1050.11it/s]warmup run: 1834it [00:03, 1073.97it/s]warmup run: 1288it [00:02, 941.96it/s]warmup run: 2013it [00:03, 1070.47it/s]warmup run: 1944it [00:03, 1079.66it/s]warmup run: 1391it [00:02, 964.07it/s]warmup run: 2147it [00:03, 1148.91it/s]warmup run: 2058it [00:03, 1096.60it/s]warmup run: 1501it [00:02, 1001.48it/s]warmup run: 2281it [00:03, 1204.85it/s]warmup run: 2190it [00:03, 1161.07it/s]warmup run: 1607it [00:02, 1017.22it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 2416it [00:03, 1246.01it/s]warmup run: 2321it [00:03, 1204.31it/s]warmup run: 1719it [00:03, 1044.62it/s]warmup run: 106it [00:01, 95.25it/s]warmup run: 2551it [00:03, 1275.23it/s]warmup run: 2453it [00:03, 1238.69it/s]warmup run: 1831it [00:03, 1064.82it/s]warmup run: 210it [00:01, 202.97it/s]warmup run: 2685it [00:04, 1294.18it/s]warmup run: 2586it [00:03, 1265.61it/s]warmup run: 1940it [00:03, 1071.15it/s]warmup run: 316it [00:01, 322.82it/s]warmup run: 2818it [00:04, 1302.37it/s]warmup run: 2718it [00:03, 1279.27it/s]warmup run: 2059it [00:03, 1105.57it/s]warmup run: 422it [00:01, 445.48it/s]warmup run: 2952it [00:04, 1311.85it/s]warmup run: 2852it [00:03, 1297.04it/s]warmup run: 3000it [00:04, 701.20it/s] warmup run: 2190it [00:03, 1166.04it/s]warmup run: 525it [00:01, 556.95it/s]warmup run: 2986it [00:04, 1309.64it/s]warmup run: 3000it [00:04, 739.40it/s] warmup run: 2323it [00:03, 1214.73it/s]warmup run: 632it [00:02, 667.04it/s]warmup run: 2457it [00:03, 1250.54it/s]warmup run: 740it [00:02, 762.18it/s]warmup run: 2592it [00:03, 1277.60it/s]warmup run: 847it [00:02, 838.76it/s]warmup run: 2726it [00:03, 1295.53it/s]warmup run: 954it [00:02, 898.34it/s]warmup run: 2859it [00:03, 1305.55it/s]warmup run: 1060it [00:02, 942.26it/s]warmup run: 2993it [00:04, 1313.80it/s]warmup run: 3000it [00:04, 737.27it/s] warmup run: 1167it [00:02, 977.20it/s]warmup run: 1273it [00:02, 999.02it/s]warmup run: 1379it [00:02, 1015.93it/s]warmup run: 1485it [00:02, 1027.81it/s]warmup run: 1592it [00:02, 1039.06it/s]warmup run: 1698it [00:03, 1037.86it/s]warmup run: 1804it [00:03, 1042.29it/s]warmup run: 1910it [00:03, 1045.37it/s]warmup run: 2021it [00:03, 1063.82it/s]warmup run: 2146it [00:03, 1118.72it/s]warmup run: 2278it [00:03, 1178.04it/s]warmup run: 2411it [00:03, 1221.24it/s]warmup run: 2543it [00:03, 1249.42it/s]warmup run: 2675it [00:03, 1270.02it/s]warmup run: 2807it [00:03, 1284.27it/s]warmup run: 2936it [00:04, 1239.56it/s]warmup run: 3000it [00:04, 727.88it/s] 


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1763.56it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1760.59it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1721.64it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1678.50it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1794.24it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1761.25it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1781.71it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1723.46it/s]warmup should be done:  18%|█▊        | 530/3000 [00:00<00:01, 1768.58it/s]warmup should be done:  18%|█▊        | 536/3000 [00:00<00:01, 1777.35it/s]warmup should be done:  17%|█▋        | 517/3000 [00:00<00:01, 1719.81it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1674.61it/s]warmup should be done:  24%|██▎       | 707/3000 [00:00<00:01, 1764.96it/s]warmup should be done:  24%|██▍       | 715/3000 [00:00<00:01, 1781.20it/s]warmup should be done:  23%|██▎       | 691/3000 [00:00<00:01, 1725.45it/s]warmup should be done:  24%|██▍       | 719/3000 [00:00<00:01, 1719.91it/s]warmup should be done:  29%|██▉       | 884/3000 [00:00<00:01, 1763.49it/s]warmup should be done:  29%|██▉       | 864/3000 [00:00<00:01, 1726.58it/s]warmup should be done:  30%|██▉       | 894/3000 [00:00<00:01, 1765.98it/s]warmup should be done:  30%|██▉       | 899/3000 [00:00<00:01, 1744.67it/s]warmup should be done:  35%|███▌      | 1061/3000 [00:00<00:01, 1761.71it/s]warmup should be done:  35%|███▍      | 1038/3000 [00:00<00:01, 1728.33it/s]warmup should be done:  36%|███▌      | 1071/3000 [00:00<00:01, 1764.86it/s]warmup should be done:  36%|███▌      | 1078/3000 [00:00<00:01, 1757.43it/s]warmup should be done:  41%|████▏     | 1238/3000 [00:00<00:01, 1755.08it/s]warmup should be done:  42%|████▏     | 1248/3000 [00:00<00:00, 1765.88it/s]warmup should be done:  40%|████      | 1211/3000 [00:00<00:01, 1723.24it/s]warmup should be done:  42%|████▏     | 1258/3000 [00:00<00:00, 1768.45it/s]warmup should be done:  48%|████▊     | 1426/3000 [00:00<00:00, 1768.93it/s]warmup should be done:  46%|████▌     | 1387/3000 [00:00<00:00, 1734.51it/s]warmup should be done:  47%|████▋     | 1414/3000 [00:00<00:00, 1741.05it/s]warmup should be done:  48%|████▊     | 1437/3000 [00:00<00:00, 1774.72it/s]warmup should be done:  52%|█████▏    | 1566/3000 [00:00<00:00, 1749.82it/s]warmup should be done:  53%|█████▎    | 1591/3000 [00:00<00:00, 1749.81it/s]warmup should be done:  53%|█████▎    | 1603/3000 [00:00<00:00, 1746.00it/s]warmup should be done:  54%|█████▍    | 1617/3000 [00:00<00:00, 1779.92it/s]warmup should be done:  58%|█████▊    | 1745/3000 [00:01<00:00, 1761.64it/s]warmup should be done:  59%|█████▉    | 1768/3000 [00:01<00:00, 1755.13it/s]warmup should be done:  59%|█████▉    | 1783/3000 [00:01<00:00, 1759.67it/s]warmup should be done:  60%|█████▉    | 1796/3000 [00:01<00:00, 1769.77it/s]warmup should be done:  64%|██████▍   | 1924/3000 [00:01<00:00, 1767.60it/s]warmup should be done:  65%|██████▍   | 1945/3000 [00:01<00:00, 1758.47it/s]warmup should be done:  65%|██████▌   | 1962/3000 [00:01<00:00, 1767.01it/s]warmup should be done:  66%|██████▌   | 1975/3000 [00:01<00:00, 1775.20it/s]warmup should be done:  70%|███████   | 2103/3000 [00:01<00:00, 1773.92it/s]warmup should be done:  71%|███████   | 2123/3000 [00:01<00:00, 1763.63it/s]warmup should be done:  71%|███████▏  | 2142/3000 [00:01<00:00, 1774.63it/s]warmup should be done:  72%|███████▏  | 2153/3000 [00:01<00:00, 1751.36it/s]warmup should be done:  77%|███████▋  | 2302/3000 [00:01<00:00, 1770.09it/s]warmup should be done:  76%|███████▌  | 2281/3000 [00:01<00:00, 1756.50it/s]warmup should be done:  77%|███████▋  | 2324/3000 [00:01<00:00, 1785.85it/s]warmup should be done:  78%|███████▊  | 2329/3000 [00:01<00:00, 1748.25it/s]warmup should be done:  83%|████████▎ | 2483/3000 [00:01<00:00, 1781.32it/s]warmup should be done:  82%|████████▏ | 2457/3000 [00:01<00:00, 1752.80it/s]warmup should be done:  84%|████████▎ | 2506/3000 [00:01<00:00, 1794.51it/s]warmup should be done:  83%|████████▎ | 2504/3000 [00:01<00:00, 1740.79it/s]warmup should be done:  90%|████████▉ | 2687/3000 [00:01<00:00, 1797.66it/s]warmup should be done:  88%|████████▊ | 2633/3000 [00:01<00:00, 1747.53it/s]warmup should be done:  89%|████████▊ | 2662/3000 [00:01<00:00, 1721.26it/s]warmup should be done:  89%|████████▉ | 2679/3000 [00:01<00:00, 1670.62it/s]warmup should be done:  96%|█████████▌| 2868/3000 [00:01<00:00, 1800.46it/s]warmup should be done:  94%|█████████▎| 2808/3000 [00:01<00:00, 1704.22it/s]warmup should be done:  94%|█████████▍| 2835/3000 [00:01<00:00, 1699.84it/s]warmup should be done:  95%|█████████▌| 2855/3000 [00:01<00:00, 1696.05it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1780.50it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1747.40it/s]warmup should be done:  99%|█████████▉| 2983/3000 [00:01<00:00, 1715.81it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1739.08it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1734.98it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1806.23it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1748.26it/s]warmup should be done:   6%|▌         | 182/3000 [00:00<00:01, 1814.11it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1791.31it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1807.88it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1815.00it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1830.67it/s]warmup should be done:  12%|█▏        | 365/3000 [00:00<00:01, 1818.78it/s]warmup should be done:  18%|█▊        | 544/3000 [00:00<00:01, 1809.87it/s]warmup should be done:  18%|█▊        | 547/3000 [00:00<00:01, 1830.34it/s]warmup should be done:  18%|█▊        | 550/3000 [00:00<00:01, 1816.30it/s]warmup should be done:  18%|█▊        | 547/3000 [00:00<00:01, 1747.12it/s]warmup should be done:  24%|██▍       | 727/3000 [00:00<00:01, 1816.05it/s]warmup should be done:  24%|██▍       | 733/3000 [00:00<00:01, 1839.51it/s]warmup should be done:  24%|██▍       | 734/3000 [00:00<00:01, 1820.22it/s]warmup should be done:  24%|██▍       | 729/3000 [00:00<00:01, 1772.02it/s]warmup should be done:  30%|███       | 910/3000 [00:00<00:01, 1819.12it/s]warmup should be done:  31%|███       | 920/3000 [00:00<00:01, 1848.28it/s]warmup should be done:  30%|███       | 911/3000 [00:00<00:01, 1787.56it/s]warmup should be done:  31%|███       | 917/3000 [00:00<00:01, 1761.16it/s]warmup should be done:  36%|███▋      | 1093/3000 [00:00<00:01, 1820.39it/s]warmup should be done:  37%|███▋      | 1108/3000 [00:00<00:01, 1857.96it/s]warmup should be done:  36%|███▋      | 1092/3000 [00:00<00:01, 1795.07it/s]warmup should be done:  37%|███▋      | 1105/3000 [00:00<00:01, 1797.93it/s]warmup should be done:  43%|████▎     | 1294/3000 [00:00<00:00, 1858.14it/s]warmup should be done:  43%|████▎     | 1276/3000 [00:00<00:00, 1810.69it/s]warmup should be done:  42%|████▏     | 1272/3000 [00:00<00:00, 1793.29it/s]warmup should be done:  43%|████▎     | 1287/3000 [00:00<00:00, 1802.21it/s]warmup should be done:  49%|████▉     | 1482/3000 [00:00<00:00, 1862.61it/s]warmup should be done:  49%|████▊     | 1458/3000 [00:00<00:00, 1811.08it/s]warmup should be done:  48%|████▊     | 1452/3000 [00:00<00:00, 1787.56it/s]warmup should be done:  49%|████▉     | 1472/3000 [00:00<00:00, 1814.38it/s]warmup should be done:  56%|█████▌    | 1669/3000 [00:00<00:00, 1864.16it/s]warmup should be done:  55%|█████▍    | 1640/3000 [00:00<00:00, 1810.95it/s]warmup should be done:  54%|█████▍    | 1633/3000 [00:00<00:00, 1792.07it/s]warmup should be done:  55%|█████▌    | 1660/3000 [00:00<00:00, 1833.44it/s]warmup should be done:  62%|██████▏   | 1856/3000 [00:01<00:00, 1865.37it/s]warmup should be done:  61%|██████    | 1825/3000 [00:01<00:00, 1822.79it/s]warmup should be done:  61%|██████    | 1818/3000 [00:01<00:00, 1807.66it/s]warmup should be done:  62%|██████▏   | 1848/3000 [00:01<00:00, 1846.43it/s]warmup should be done:  68%|██████▊   | 2043/3000 [00:01<00:00, 1866.74it/s]warmup should be done:  67%|██████▋   | 2011/3000 [00:01<00:00, 1832.86it/s]warmup should be done:  67%|██████▋   | 2003/3000 [00:01<00:00, 1817.56it/s]warmup should be done:  68%|██████▊   | 2035/3000 [00:01<00:00, 1852.84it/s]warmup should be done:  74%|███████▍  | 2230/3000 [00:01<00:00, 1866.20it/s]warmup should be done:  73%|███████▎  | 2198/3000 [00:01<00:00, 1843.20it/s]warmup should be done:  73%|███████▎  | 2187/3000 [00:01<00:00, 1823.31it/s]warmup should be done:  74%|███████▍  | 2223/3000 [00:01<00:00, 1859.83it/s]warmup should be done:  81%|████████  | 2417/3000 [00:01<00:00, 1866.27it/s]warmup should be done:  80%|███████▉  | 2385/3000 [00:01<00:00, 1850.06it/s]warmup should be done:  80%|████████  | 2411/3000 [00:01<00:00, 1864.00it/s]warmup should be done:  79%|███████▉  | 2370/3000 [00:01<00:00, 1806.90it/s]warmup should be done:  87%|████████▋ | 2604/3000 [00:01<00:00, 1864.90it/s]warmup should be done:  86%|████████▌ | 2572/3000 [00:01<00:00, 1855.77it/s]warmup should be done:  87%|████████▋ | 2599/3000 [00:01<00:00, 1867.79it/s]warmup should be done:  85%|████████▌ | 2551/3000 [00:01<00:00, 1798.75it/s]warmup should be done:  93%|█████████▎| 2792/3000 [00:01<00:00, 1866.78it/s]warmup should be done:  92%|█████████▏| 2760/3000 [00:01<00:00, 1861.16it/s]warmup should be done:  93%|█████████▎| 2787/3000 [00:01<00:00, 1869.99it/s]warmup should be done:  91%|█████████ | 2731/3000 [00:01<00:00, 1797.85it/s]warmup should be done:  99%|█████████▉| 2980/3000 [00:01<00:00, 1868.29it/s]warmup should be done:  98%|█████████▊| 2948/3000 [00:01<00:00, 1865.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1857.57it/s]warmup should be done:  99%|█████████▉| 2976/3000 [00:01<00:00, 1874.79it/s]warmup should be done:  97%|█████████▋| 2913/3000 [00:01<00:00, 1802.45it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1840.82it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1835.91it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1799.52it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fe6c3fa1160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fe6c3fa1280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fe6c3fa1040>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fe6c3fa0190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 21:07:45.286777: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe291267e50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:07:45.286852: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:07:45.299070: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:07:46.154768: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:07:47.198655: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe2992679f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:07:47.198735: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:07:47.200208: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe291a6b980 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:07:47.200268: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:07:47.208383: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:07:47.208630: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:07:47.229401: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe299a6b030 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:07:47.229456: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:07:47.237065: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:07:47.882154: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:07:48.020115: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:07:48.052846: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:07:51.435422: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:07:53.199706: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:07:54.410351: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:07:54.522047: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][21:08:53.096][ERROR][RK0][tid #140611382404864]: replica 3 reaches 1000, calling init pre replica
[HCTR][21:08:53.096][ERROR][RK0][tid #140611382404864]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][21:08:53.101][ERROR][RK0][tid #140611382404864]: coll ps creation done
[HCTR][21:08:53.101][ERROR][RK0][tid #140611382404864]: replica 3 waits for coll ps creation barrier
[HCTR][21:08:53.129][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][21:08:53.129][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][21:08:53.132][ERROR][RK0][main]: coll ps creation done
[HCTR][21:08:53.132][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][21:08:53.412][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][21:08:53.412][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][21:08:53.415][ERROR][RK0][main]: coll ps creation done
[HCTR][21:08:53.415][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][21:08:53.632][ERROR][RK0][tid #140611650840320]: replica 2 reaches 1000, calling init pre replica
[HCTR][21:08:53.632][ERROR][RK0][tid #140611650840320]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][21:08:53.635][ERROR][RK0][tid #140611650840320]: coll ps creation done
[HCTR][21:08:53.635][ERROR][RK0][tid #140611650840320]: replica 2 waits for coll ps creation barrier
[HCTR][21:08:53.635][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][21:08:54.582][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][21:08:54.608][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][21:08:54.608][ERROR][RK0][tid #140611382404864]: replica 3 calling init per replica
[HCTR][21:08:54.608][ERROR][RK0][main]: Calling build_v2
[HCTR][21:08:54.608][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:08:54.608][ERROR][RK0][tid #140611382404864]: Calling build_v2
[HCTR][21:08:54.608][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][21:08:54.608][ERROR][RK0][tid #140611382404864]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:08:54.609][ERROR][RK0][main]: Calling build_v2
[HCTR][21:08:54.608][ERROR][RK0][tid #140611650840320]: replica 2 calling init per replica
[HCTR][21:08:54.609][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:08:54.609][ERROR][RK0][tid #140611650840320]: Calling build_v2
[HCTR][21:08:54.609][ERROR][RK0][tid #140611650840320]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 21:08:54.[609980: E2022-12-11 21:08:54 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc609994:: 196E]  assigning 0 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
:196] assigning 0 to cpu
[[[2022-12-11 21:08:542022-12-11 21:08:542022-12-11 21:08:54...610102610089610101: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:::[212196212] ] 2022-12-11 21:08:54] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4assigning 0 to cpu.build symm link desc with 4X Tesla V100-SXM2-16GB out of 4

610144
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 21:08:54[196.2022-12-11 21:08:54] 610205.assigning 0 to cpu: 610209
E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc213:] 213remote time is 8.68421] 
remote time is 8.68421
[2022-12-11 21:08:54.[610272[2022-12-11 21:08:54: 2022-12-11 21:08:54.E.610276 610275: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[: E:2022-12-11 21:08:54E 214. /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] 610286/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:cpu time is 30: :214
E212]  ] cpu time is 30/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4
:
212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 21:08:54.[6103902022-12-11 21:08:54: .E610397 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: 213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :remote time is 8.68421213
] remote time is 8.68421
[2022-12-11 21:08:54.[6104422022-12-11 21:08:54: .E610448 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: 214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :cpu time is 30214
] cpu time is 30
[2022-12-11 21:09:20.424442: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 21:09:20.491360: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 21:09:20.667881: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 21:09:20.667942: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 21:09:20.667976: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 21:09:20.668007: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 21:09:20.668783: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:09:20.668831: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:09:20.669718: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:09:20.670279: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-11 21:09:20[2022-12-11 21:09:20.2022-12-11 21:09:20.689824.689829: 689862: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202:202] 202] 3 solved] 2 solved
1 solved

[2022-12-11 21:09:20.[[6899612022-12-11 21:09:202022-12-11 21:09:20: ..E689965689966 : : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccEE:  205/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] ::worker 0 thread 3 initing device 3205205
] ] worker 0 thread 2 initing device 2
worker 0 thread 1 initing device 1
[2022-12-11 21:09:20.690278: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:09:20.690324: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-11 21:09:202022-12-11 21:09:20..690385690389: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::18151815] ] Building Coll Cache with ... num gpu device is 4Building Coll Cache with ... num gpu device is 4

[2022-12-11 21:09:20[.2022-12-11 21:09:20690455.: 690460E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980eager alloc mem 381.47 MB] 
eager alloc mem 381.47 MB
[2022-12-11 21:09:20.692068: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:09:20.692142: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-11 21:09:20
.692167: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:09:20.693558: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:09:20.693586: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB[
2022-12-11 21:09:20.693611: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:09:20.767409: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 21:09:20.769265: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 21:09:20.769320: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:09:20.770110: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:09:20.770566: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:09:20.771484: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:09:20.771530: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.26 MB
[2022-12-11 21:09:20.778815: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:09:20.779521: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:09:20.779567: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[[2022-12-11 21:09:202022-12-11 21:09:202022-12-11 21:09:20...788254788254788254: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes

eager alloc mem 5.00 Bytes
[2022-12-11 21:09:20.790078: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[[2022-12-11 21:09:202022-12-11 21:09:20..790105790105[: : 2022-12-11 21:09:20EE.  790124/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: ::E638638 ] ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 5eager release cuda mem 5:

638] eager release cuda mem 400000000
[[2022-12-11 21:09:202022-12-11 21:09:20..790198790199: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 400000000eager release cuda mem 400000000

[2022-12-11 21:09:20.791068: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:09:20.791554: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:09:20.792049: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:09:20.792582: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:09:20.792711: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:09:20.792744: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:09:20.793496: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:09:20.793538: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.26 MB
[2022-12-11 21:09:20.793617: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:09:20.793664: [W2022-12-11 21:09:20 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc793670:: 43E]  WORKER[0] alloc host memory 15.26 MB/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-11 21:09:20.793735: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.26 MB
[2022-12-11 21:09:20.801593: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:09:20.802267: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:09:20.802309: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 21:09:20:.1980802309] : eager alloc mem 1.91 GBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:09:20.802881: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:09:20.802981: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:09:20.803025: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[2022-12-11 21:09:20.803537: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:09:20.803581: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[[[2022-12-11 21:09:202022-12-11 21:09:202022-12-11 21:09:202022-12-11 21:09:20....976569976569976569976570: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 1 init p2p of link 2Device 2 init p2p of link 3Device 3 init p2p of link 0Device 0 init p2p of link 1



[[2022-12-11 21:09:20[2022-12-11 21:09:20.2022-12-11 21:09:20.976798.976800: 976802: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980:1980] 1980] eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[2022-12-11 21:09:20.977147: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:09:20.977632: [E2022-12-11 21:09:20 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[977642:2022-12-11 21:09:20: 638.E] 977653 eager release cuda mem 625663: /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
E: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 625663638
] eager release cuda mem 625663
[2022-12-11 21:09:20.977950: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:09:20.981035: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 21:09:20.981129: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:09:20.981171: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 21:09:20.981218: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] [Device 1 init p2p of link 32022-12-11 21:09:20
.981258: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-11 21:09:202022-12-11 21:09:20..981325981337: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261980] ] Device 0 init p2p of link 2eager alloc mem 611.00 KB

[2022-12-11 21:09:20.981459: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:09:20.981910: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:09:20.982045: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:09:20.982148: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:09:20.982242: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:09:20.985219: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 21:09:20.985310: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:09:20.985567: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 21:09:20.985650: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-11 21:09:202022-12-11 21:09:20..985707985712: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261926] ] Device 1 init p2p of link 0Device 0 init p2p of link 3

[2022-12-11 21:09:20[.2022-12-11 21:09:20985831.: 985835E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[2022-12-11 21:09:20.986095: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:09:20.986438: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:09:20.986631: [E2022-12-11 21:09:20 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc986642:: 638E]  eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-11 21:09:20.988582: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:09:20.988822: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 3999999 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11999997 / 100000000 nodes ( 12.00 %) | cpu 84000004 / 100000000 nodes ( 84.00 %) | 1.91 GB | 0.298374 secs 
[2022-12-11 21:09:20.989589: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:09:20.989778: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:09:20.989842: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:09:20.990168: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 3999999 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11999997 / 100000000 nodes ( 12.00 %) | cpu 84000004 / 100000000 nodes ( 84.00 %) | 1.91 GB | 0.299854 secs 
[2022-12-11 21:09:20.990749: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 3999999 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11999997 / 100000000 nodes ( 12.00 %) | cpu 84000004 / 100000000 nodes ( 84.00 %) | 1.91 GB | 0.321928 secs 
[2022-12-11 21:09:20.990804: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 3999999 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11999997 / 100000000 nodes ( 12.00 %) | cpu 84000004 / 100000000 nodes ( 84.00 %) | 1.91 GB | 0.300355 secs 
[HCTR][21:09:20.990][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][21:09:20.990][ERROR][RK0][tid #140611382404864]: replica 3 calling init per replica done, doing barrier
[HCTR][21:09:20.990][ERROR][RK0][tid #140611650840320]: replica 2 calling init per replica done, doing barrier
[HCTR][21:09:20.990][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][21:09:20.990][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][21:09:20.990][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][21:09:20.990][ERROR][RK0][tid #140611382404864]: replica 3 calling init per replica done, doing barrier done
[HCTR][21:09:20.990][ERROR][RK0][tid #140611650840320]: replica 2 calling init per replica done, doing barrier done
[HCTR][21:09:20.990][ERROR][RK0][tid #140611650840320]: init per replica done
[HCTR][21:09:20.990][ERROR][RK0][tid #140611382404864]: init per replica done
[HCTR][21:09:20.990][ERROR][RK0][main]: init per replica done
[HCTR][21:09:20.994][ERROR][RK0][main]: init per replica done
