2022-12-11 19:17:49.100616: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:17:49.119064: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:17:49.199217: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:17:49.201795: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:17:49.978376: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:17:49.978460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 19:17:49.991223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 19:17:50.000537: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:17:50.000617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 19:17:50.015443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 19:17:50.024412: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:17:50.024630: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:17:50.026393: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 19:17:50.037782: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:17:50.037862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 19:17:50.040525: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:17:50.040606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 19:17:50.048902: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:17:50.049123: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:17:50.050525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 19:17:50.051386: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 19:17:50.055349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 19:17:50.082729: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:17:50.082917: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:17:50.084355: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 19:17:50.086751: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:17:50.086897: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:17:50.088298: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][19:17:51.290][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:17:52.237][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:17:52.249][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:17:52.293][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 107it [00:01, 96.60it/s]warmup run: 212it [00:01, 205.67it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 1it [00:01,  1.44s/it]warmup run: 318it [00:01, 325.65it/s]warmup run: 112it [00:01, 101.45it/s]warmup run: 104it [00:01, 93.75it/s]warmup run: 424it [00:01, 448.23it/s]warmup run: 225it [00:01, 219.50it/s]warmup run: 210it [00:01, 204.19it/s]warmup run: 530it [00:01, 565.67it/s]warmup run: 332it [00:01, 339.30it/s]warmup run: 316it [00:01, 324.04it/s]warmup run: 638it [00:02, 676.22it/s]warmup run: 445it [00:01, 471.47it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 423it [00:01, 448.47it/s]warmup run: 746it [00:02, 770.56it/s]warmup run: 557it [00:01, 596.43it/s]warmup run: 97it [00:01, 86.47it/s]warmup run: 529it [00:01, 565.95it/s]warmup run: 854it [00:02, 847.50it/s]warmup run: 665it [00:02, 700.16it/s]warmup run: 202it [00:01, 195.58it/s]warmup run: 636it [00:02, 673.74it/s]warmup run: 961it [00:02, 904.67it/s]warmup run: 771it [00:02, 780.09it/s]warmup run: 308it [00:01, 315.90it/s]warmup run: 744it [00:02, 768.86it/s]warmup run: 1067it [00:02, 945.81it/s]warmup run: 876it [00:02, 845.39it/s]warmup run: 414it [00:01, 439.21it/s]warmup run: 851it [00:02, 843.76it/s]warmup run: 1173it [00:02, 921.31it/s]warmup run: 981it [00:02, 896.46it/s]warmup run: 520it [00:01, 557.75it/s]warmup run: 957it [00:02, 899.93it/s]warmup run: 1282it [00:02, 966.20it/s]warmup run: 1087it [00:02, 939.32it/s]warmup run: 628it [00:02, 669.18it/s]warmup run: 1063it [00:02, 943.47it/s]warmup run: 1389it [00:02, 993.71it/s]warmup run: 1192it [00:02, 957.95it/s]warmup run: 733it [00:02, 757.52it/s]warmup run: 1170it [00:02, 977.71it/s]warmup run: 1496it [00:02, 1012.99it/s]warmup run: 1299it [00:02, 988.30it/s]warmup run: 840it [00:02, 834.77it/s]warmup run: 1276it [00:02, 988.15it/s]warmup run: 1604it [00:02, 1029.94it/s]warmup run: 1404it [00:02, 1005.57it/s]warmup run: 947it [00:02, 894.84it/s]warmup run: 1384it [00:02, 1012.12it/s]warmup run: 1710it [00:03, 1037.07it/s]warmup run: 1510it [00:02, 1018.98it/s]warmup run: 1052it [00:02, 937.15it/s]warmup run: 1491it [00:02, 1028.02it/s]warmup run: 1816it [00:03, 1041.20it/s]warmup run: 1616it [00:02, 1028.16it/s]warmup run: 1159it [00:02, 973.94it/s]warmup run: 1599it [00:02, 1041.89it/s]warmup run: 1922it [00:03, 1043.58it/s]warmup run: 1723it [00:03, 1038.54it/s]warmup run: 1266it [00:02, 999.19it/s]warmup run: 1706it [00:03, 1048.40it/s]warmup run: 2035it [00:03, 1068.31it/s]warmup run: 1831it [00:03, 1047.72it/s]warmup run: 1372it [00:02, 1006.18it/s]warmup run: 1814it [00:03, 1057.43it/s]warmup run: 2172it [00:03, 1155.60it/s]warmup run: 1939it [00:03, 1054.93it/s]warmup run: 1481it [00:02, 1028.72it/s]warmup run: 1922it [00:03, 1063.63it/s]warmup run: 2309it [00:03, 1217.00it/s]warmup run: 2056it [00:03, 1088.68it/s]warmup run: 1589it [00:02, 1042.02it/s]warmup run: 2034it [00:03, 1080.37it/s]warmup run: 2442it [00:03, 1250.63it/s]warmup run: 2190it [00:03, 1162.53it/s]warmup run: 1698it [00:03, 1053.84it/s]warmup run: 2168it [00:03, 1157.01it/s]warmup run: 2579it [00:03, 1284.62it/s]warmup run: 2321it [00:03, 1205.14it/s]warmup run: 1806it [00:03, 1060.87it/s]warmup run: 2300it [00:03, 1204.22it/s]warmup run: 2715it [00:03, 1306.61it/s]warmup run: 2454it [00:03, 1241.61it/s]warmup run: 1914it [00:03, 1065.48it/s]warmup run: 2434it [00:03, 1244.26it/s]warmup run: 2852it [00:03, 1323.51it/s]warmup run: 2587it [00:03, 1266.69it/s]warmup run: 2025it [00:03, 1078.03it/s]warmup run: 2565it [00:03, 1261.34it/s]warmup run: 2989it [00:04, 1334.75it/s]warmup run: 2719it [00:03, 1279.65it/s]warmup run: 3000it [00:04, 734.45it/s] warmup run: 2158it [00:03, 1153.14it/s]warmup run: 2696it [00:03, 1275.81it/s]warmup run: 2852it [00:03, 1292.71it/s]warmup run: 2292it [00:03, 1206.48it/s]warmup run: 2826it [00:03, 1282.14it/s]warmup run: 2985it [00:04, 1303.61it/s]warmup run: 3000it [00:04, 737.08it/s] warmup run: 2426it [00:03, 1243.68it/s]warmup run: 2960it [00:04, 1297.57it/s]warmup run: 3000it [00:04, 734.10it/s] warmup run: 2558it [00:03, 1265.91it/s]warmup run: 2692it [00:03, 1286.02it/s]warmup run: 2824it [00:03, 1295.74it/s]warmup run: 2958it [00:04, 1307.64it/s]warmup run: 3000it [00:04, 730.63it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1766.29it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1719.30it/s]warmup should be done:   5%|▌         | 156/3000 [00:00<00:01, 1554.15it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1698.51it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1787.30it/s]warmup should be done:  11%|█         | 337/3000 [00:00<00:01, 1701.99it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1761.77it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1742.70it/s]warmup should be done:  17%|█▋        | 516/3000 [00:00<00:01, 1740.95it/s]warmup should be done:  17%|█▋        | 523/3000 [00:00<00:01, 1745.50it/s]warmup should be done:  18%|█▊        | 529/3000 [00:00<00:01, 1762.52it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1767.00it/s]warmup should be done:  23%|██▎       | 702/3000 [00:00<00:01, 1761.19it/s]warmup should be done:  23%|██▎       | 697/3000 [00:00<00:01, 1765.39it/s]warmup should be done:  24%|██▎       | 708/3000 [00:00<00:01, 1771.26it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1767.53it/s]warmup should be done:  29%|██▉       | 878/3000 [00:00<00:01, 1780.26it/s]warmup should be done:  29%|██▉       | 881/3000 [00:00<00:01, 1769.64it/s]warmup should be done:  30%|██▉       | 886/3000 [00:00<00:01, 1771.81it/s]warmup should be done:  30%|██▉       | 891/3000 [00:00<00:01, 1760.07it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1775.98it/s]warmup should be done:  35%|███▌      | 1058/3000 [00:00<00:01, 1783.77it/s]warmup should be done:  35%|███▌      | 1064/3000 [00:00<00:01, 1770.14it/s]warmup should be done:  36%|███▌      | 1068/3000 [00:00<00:01, 1755.75it/s]warmup should be done:  41%|████▏     | 1239/3000 [00:00<00:00, 1779.28it/s]warmup should be done:  41%|████▏     | 1238/3000 [00:00<00:00, 1786.58it/s]warmup should be done:  41%|████▏     | 1242/3000 [00:00<00:00, 1771.15it/s]warmup should be done:  41%|████▏     | 1244/3000 [00:00<00:01, 1753.26it/s]warmup should be done:  47%|████▋     | 1417/3000 [00:00<00:00, 1775.30it/s]warmup should be done:  47%|████▋     | 1419/3000 [00:00<00:00, 1790.95it/s]warmup should be done:  47%|████▋     | 1420/3000 [00:00<00:00, 1771.38it/s]warmup should be done:  47%|████▋     | 1420/3000 [00:00<00:00, 1751.18it/s]warmup should be done:  53%|█████▎    | 1598/3000 [00:00<00:00, 1785.61it/s]warmup should be done:  53%|█████▎    | 1600/3000 [00:00<00:00, 1794.70it/s]warmup should be done:  53%|█████▎    | 1598/3000 [00:00<00:00, 1772.31it/s]warmup should be done:  53%|█████▎    | 1596/3000 [00:00<00:00, 1751.54it/s]warmup should be done:  59%|█████▉    | 1781/3000 [00:01<00:00, 1796.51it/s]warmup should be done:  59%|█████▉    | 1776/3000 [00:01<00:00, 1771.91it/s]warmup should be done:  59%|█████▉    | 1777/3000 [00:01<00:00, 1777.39it/s]warmup should be done:  59%|█████▉    | 1772/3000 [00:01<00:00, 1751.30it/s]warmup should be done:  65%|██████▌   | 1961/3000 [00:01<00:00, 1796.02it/s]warmup should be done:  65%|██████▌   | 1958/3000 [00:01<00:00, 1785.88it/s]warmup should be done:  65%|██████▌   | 1954/3000 [00:01<00:00, 1772.27it/s]warmup should be done:  65%|██████▌   | 1950/3000 [00:01<00:00, 1760.00it/s]warmup should be done:  71%|███████▏  | 2142/3000 [00:01<00:00, 1797.44it/s]warmup should be done:  71%|███████▏  | 2139/3000 [00:01<00:00, 1790.68it/s]warmup should be done:  71%|███████   | 2132/3000 [00:01<00:00, 1771.88it/s]warmup should be done:  71%|███████   | 2128/3000 [00:01<00:00, 1764.44it/s]warmup should be done:  77%|███████▋  | 2322/3000 [00:01<00:00, 1797.96it/s]warmup should be done:  77%|███████▋  | 2319/3000 [00:01<00:00, 1792.88it/s]warmup should be done:  77%|███████▋  | 2310/3000 [00:01<00:00, 1772.15it/s]warmup should be done:  77%|███████▋  | 2308/3000 [00:01<00:00, 1772.28it/s]warmup should be done:  83%|████████▎ | 2504/3000 [00:01<00:00, 1802.93it/s]warmup should be done:  83%|████████▎ | 2491/3000 [00:01<00:00, 1782.42it/s]warmup should be done:  83%|████████▎ | 2499/3000 [00:01<00:00, 1785.80it/s]warmup should be done:  83%|████████▎ | 2489/3000 [00:01<00:00, 1781.47it/s]warmup should be done:  90%|████████▉ | 2685/3000 [00:01<00:00, 1804.79it/s]warmup should be done:  89%|████████▉ | 2671/3000 [00:01<00:00, 1786.83it/s]warmup should be done:  89%|████████▉ | 2679/3000 [00:01<00:00, 1789.25it/s]warmup should be done:  89%|████████▉ | 2670/3000 [00:01<00:00, 1788.66it/s]warmup should be done:  96%|█████████▌| 2866/3000 [00:01<00:00, 1805.51it/s]warmup should be done:  95%|█████████▌| 2852/3000 [00:01<00:00, 1790.79it/s]warmup should be done:  95%|█████████▌| 2859/3000 [00:01<00:00, 1790.90it/s]warmup should be done:  95%|█████████▌| 2851/3000 [00:01<00:00, 1793.69it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1786.22it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1779.57it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1776.76it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1772.37it/s]



warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 186/3000 [00:00<00:01, 1859.16it/s]warmup should be done:   6%|▌         | 185/3000 [00:00<00:01, 1844.15it/s]warmup should be done:   6%|▌         | 186/3000 [00:00<00:01, 1853.19it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1762.63it/s]warmup should be done:  12%|█▏        | 372/3000 [00:00<00:01, 1858.65it/s]warmup should be done:  12%|█▏        | 372/3000 [00:00<00:01, 1856.02it/s]warmup should be done:  12%|█▏        | 365/3000 [00:00<00:01, 1829.78it/s]warmup should be done:  12%|█▏        | 371/3000 [00:00<00:01, 1848.95it/s]warmup should be done:  19%|█▊        | 559/3000 [00:00<00:01, 1860.46it/s]warmup should be done:  19%|█▊        | 558/3000 [00:00<00:01, 1856.82it/s]warmup should be done:  18%|█▊        | 553/3000 [00:00<00:01, 1852.29it/s]warmup should be done:  19%|█▊        | 557/3000 [00:00<00:01, 1851.33it/s]warmup should be done:  25%|██▍       | 744/3000 [00:00<00:01, 1856.94it/s]warmup should be done:  25%|██▍       | 741/3000 [00:00<00:01, 1862.11it/s]warmup should be done:  25%|██▍       | 746/3000 [00:00<00:01, 1859.49it/s]warmup should be done:  25%|██▍       | 743/3000 [00:00<00:01, 1849.63it/s]warmup should be done:  31%|███       | 929/3000 [00:00<00:01, 1868.11it/s]warmup should be done:  31%|███       | 930/3000 [00:00<00:01, 1855.95it/s]warmup should be done:  31%|███       | 932/3000 [00:00<00:01, 1858.33it/s]warmup should be done:  31%|███       | 929/3000 [00:00<00:01, 1850.45it/s]warmup should be done:  37%|███▋      | 1117/3000 [00:00<00:01, 1870.81it/s]warmup should be done:  37%|███▋      | 1117/3000 [00:00<00:01, 1857.67it/s]warmup should be done:  37%|███▋      | 1119/3000 [00:00<00:01, 1859.02it/s]warmup should be done:  37%|███▋      | 1115/3000 [00:00<00:01, 1796.61it/s]warmup should be done:  44%|████▎     | 1305/3000 [00:00<00:00, 1870.59it/s]warmup should be done:  43%|████▎     | 1303/3000 [00:00<00:00, 1853.43it/s]warmup should be done:  44%|████▎     | 1305/3000 [00:00<00:00, 1852.67it/s]warmup should be done:  43%|████▎     | 1299/3000 [00:00<00:00, 1808.92it/s]warmup should be done:  50%|████▉     | 1493/3000 [00:00<00:00, 1873.31it/s]warmup should be done:  50%|████▉     | 1490/3000 [00:00<00:00, 1856.17it/s]warmup should be done:  50%|████▉     | 1492/3000 [00:00<00:00, 1855.47it/s]warmup should be done:  49%|████▉     | 1484/3000 [00:00<00:00, 1820.41it/s]warmup should be done:  56%|█████▌    | 1681/3000 [00:00<00:00, 1874.79it/s]warmup should be done:  56%|█████▌    | 1676/3000 [00:00<00:00, 1855.30it/s]warmup should be done:  56%|█████▌    | 1679/3000 [00:00<00:00, 1857.09it/s]warmup should be done:  56%|█████▌    | 1669/3000 [00:00<00:00, 1828.94it/s]warmup should be done:  62%|██████▏   | 1869/3000 [00:01<00:00, 1874.50it/s]warmup should be done:  62%|██████▏   | 1862/3000 [00:01<00:00, 1856.42it/s]warmup should be done:  62%|██████▏   | 1865/3000 [00:01<00:00, 1856.95it/s]warmup should be done:  62%|██████▏   | 1854/3000 [00:01<00:00, 1833.20it/s]warmup should be done:  69%|██████▊   | 2057/3000 [00:01<00:00, 1875.46it/s]warmup should be done:  68%|██████▊   | 2049/3000 [00:01<00:00, 1857.93it/s]warmup should be done:  68%|██████▊   | 2052/3000 [00:01<00:00, 1860.04it/s]warmup should be done:  68%|██████▊   | 2039/3000 [00:01<00:00, 1837.68it/s]warmup should be done:  75%|███████▍  | 2246/3000 [00:01<00:00, 1877.42it/s]warmup should be done:  75%|███████▍  | 2239/3000 [00:01<00:00, 1853.87it/s]warmup should be done:  74%|███████▍  | 2235/3000 [00:01<00:00, 1839.86it/s]warmup should be done:  74%|███████▍  | 2223/3000 [00:01<00:00, 1837.48it/s]warmup should be done:  81%|████████  | 2435/3000 [00:01<00:00, 1879.05it/s]warmup should be done:  81%|████████  | 2426/3000 [00:01<00:00, 1857.10it/s]warmup should be done:  81%|████████  | 2421/3000 [00:01<00:00, 1845.43it/s]warmup should be done:  80%|████████  | 2407/3000 [00:01<00:00, 1773.18it/s]warmup should be done:  87%|████████▋ | 2624/3000 [00:01<00:00, 1880.10it/s]warmup should be done:  87%|████████▋ | 2608/3000 [00:01<00:00, 1849.91it/s]warmup should be done:  87%|████████▋ | 2612/3000 [00:01<00:00, 1831.67it/s]warmup should be done:  86%|████████▋ | 2593/3000 [00:01<00:00, 1797.50it/s]warmup should be done:  94%|█████████▍| 2813/3000 [00:01<00:00, 1882.12it/s]warmup should be done:  93%|█████████▎| 2795/3000 [00:01<00:00, 1853.24it/s]warmup should be done:  93%|█████████▎| 2800/3000 [00:01<00:00, 1845.13it/s]warmup should be done:  93%|█████████▎| 2777/3000 [00:01<00:00, 1807.70it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1871.86it/s]warmup should be done:  99%|█████████▉| 2982/3000 [00:01<00:00, 1857.71it/s]warmup should be done: 100%|█████████▉| 2989/3000 [00:01<00:00, 1855.67it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1854.30it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1853.20it/s]warmup should be done:  99%|█████████▉| 2964/3000 [00:01<00:00, 1824.76it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1823.09it/s]2022-12-11 19:19:02.629054: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fab2aa6b1b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:19:02.629132: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:19:03.408687: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fab362641f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:19:03.408748: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:19:04.364964: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fab2a267600 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:19:04.365029: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:19:05.696075: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:19:05.781218: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:19:05.939482: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:19:06.953698: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:19:07.030252: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:19:07.249822: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:19:08.377423: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:19:08.456676: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:19:08.983536: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:19:15.160603: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fab26a67cc0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:19:15.160664: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:19:18.935893: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:19:20.716813: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:19:22.440019: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][19:20:08.010][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][19:20:08.011][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:20:08.016][ERROR][RK0][main]: coll ps creation done
[HCTR][19:20:08.016][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][19:20:08.321][ERROR][RK0][tid #140373716346624]: replica 0 reaches 1000, calling init pre replica
[HCTR][19:20:08.321][ERROR][RK0][tid #140373716346624]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:20:08.325][ERROR][RK0][tid #140373716346624]: coll ps creation done
[HCTR][19:20:08.325][ERROR][RK0][tid #140373716346624]: replica 0 waits for coll ps creation barrier
[HCTR][19:20:08.565][ERROR][RK0][tid #140373707953920]: replica 2 reaches 1000, calling init pre replica
[HCTR][19:20:08.565][ERROR][RK0][tid #140373707953920]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:20:08.568][ERROR][RK0][tid #140373707953920]: coll ps creation done
[HCTR][19:20:08.568][ERROR][RK0][tid #140373707953920]: replica 2 waits for coll ps creation barrier
[HCTR][19:20:08.582][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][19:20:08.582][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:20:08.586][ERROR][RK0][main]: coll ps creation done
[HCTR][19:20:08.586][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][19:20:08.586][ERROR][RK0][tid #140373716346624]: replica 0 preparing frequency
[HCTR][19:20:09.573][ERROR][RK0][tid #140373716346624]: replica 0 preparing frequency done
[HCTR][19:20:09.599][ERROR][RK0][tid #140373716346624]: replica 0 calling init per replica
[HCTR][19:20:09.599][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][19:20:09.599][ERROR][RK0][tid #140373707953920]: replica 2 calling init per replica
[HCTR][19:20:09.599][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][19:20:09.599][ERROR][RK0][tid #140373716346624]: Calling build_v2
[HCTR][19:20:09.599][ERROR][RK0][main]: Calling build_v2
[HCTR][19:20:09.599][ERROR][RK0][tid #140373707953920]: Calling build_v2
[HCTR][19:20:09.599][ERROR][RK0][main]: Calling build_v2
[HCTR][19:20:09.599][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:20:09.599][ERROR][RK0][tid #140373716346624]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:20:09.599][ERROR][RK0][tid #140373707953920]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:20:09.599][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-11 19:20:09.599262: 2022-12-11 19:20:092022-12-11 19:20:09E.. 599251599254/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: : :EE[136  ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccusing concurrent impl MPS:2022-12-11 19:20:09:
136.136] 599307] using concurrent impl MPS: using concurrent impl MPS
E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 19:20:09.600497: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 19:20:09.600548: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 19:20:09[.2022-12-11 19:20:09600583.[: 6005912022-12-11 19:20:09E: [. E2022-12-11 19:20:09600604/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc .: :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc600612E196::  ] 212E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpu]  :
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc212
:] 196build symm link desc with 4X Tesla V100-SXM2-16GB out of 4] 
assigning 8 to cpu[
2022-12-11 19:20:09.[[6007202022-12-11 19:20:092022-12-11 19:20:09: ..E600728600722 : : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccEE:  213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :[:remote time is 8.684212132022-12-11 19:20:09212
] .] remote time is 8.68421600758[build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
: 2022-12-11 19:20:09
E[. 2022-12-11 19:20:09600809/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[.: :2022-12-11 19:20:09600826E212.:  ] 600838E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4:  :
E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214 :] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214cpu time is 30:] [
213cpu time is 302022-12-11 19:20:09] 
.remote time is 8.68421600901
: E[ 2022-12-11 19:20:09/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:600941213: ] Eremote time is 8.68421 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 19:20:09214.] 600984cpu time is 30: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 19:20:32.857731: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 19:20:32.923679: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 19:20:32.923784: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 19:20:32.924922: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 19:20:33. 56994: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 19:20:33.447168: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 19:20:33.447257: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 19:20:41.529947: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 19:20:41.530144: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 19:20:43.466735: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 19:20:43.466831: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 19:20:43.496506: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 19:20:43.496609: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 19:20:44.573579: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 19:20:44.589325: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 19:20:44.590077: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 19:20:44.599886: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 19:20:44.696845: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 19:20:46.221081: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 19:20:46.224814: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 19:20:46.224949: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 19:20:46.234054: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 19:20:46.234131: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 19:20:46.234172: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 19:20:46.234205: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 19:20:46.235439: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:20:46.235492: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:20:46.236531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:20:46.238003: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:20:46.259290: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 19:20:46.259386: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 19:20:46.260571: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:20:46.260632: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:20:46.260751: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 19:20:46.260823: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 19:20:46.261438: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:20:46.261495: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:20:46.261521: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:20:46.262621: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:20:46.263290: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:20:46.263934: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:20:46.266415: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 19:20:46.266537: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 19:20:46.267997: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:20:46.268072: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:20:46.269181: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:20:46.269999: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:20:46.332955: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 19:20:46.334910: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 19:20:46.334968: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:20:46.335834: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:20:46.336465: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:20:46.337046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 19:20:46.337381: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.338620: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:20:46.339281: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:20:46.[3393272022-12-11 19:20:46: .E339329 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager alloc mem 492.89 MB638
] eager release cuda mem 1021
[2022-12-11 19:20:46.339445: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:20:46.341395: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:20:46.341945: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:20:46.342851: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.345516: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:20:46.346163: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:20:46.346204: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 492.93 MB
[[2022-12-11 19:20:462022-12-11 19:20:46..356882356882: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-11 19:20:46.358717: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 19:20:46.358742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 10212022-12-11 19:20:46
.358766: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:20:46.358796: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:20:46.359600: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:20:46.360093: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:20:46.360553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:20:46.360747: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:20:46.361438: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.361660: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.363750: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:20:46.364391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:20:46.364433: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 493.16 MB
[2022-12-11 19:20:46.364965: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:20:46.365610: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:20:46.365651: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 491.11 MB
[[[2022-12-11 19:20:46[2022-12-11 19:20:462022-12-11 19:20:46.2022-12-11 19:20:46..407962.407963407964: 407964: : E: EE E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::1926:19261926] 1926] ] Device 3 init p2p of link 0] Device 2 init p2p of link 3Device 1 init p2p of link 2
Device 0 init p2p of link 1


[2022-12-11 19:20:46.408237: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 611.00 KB2022-12-11 19:20:46
[.2022-12-11 19:20:46408261.: 408266E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980[:] 2022-12-11 19:20:461980eager alloc mem 611.00 KB.] 
408329eager alloc mem 611.00 KB: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:20:46.409055: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.409105: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.409157: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.409189: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.410955: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 19:20:46.411036: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:20:46.411167: [E2022-12-11 19:20:46 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu411185:: 1926E]  Device 0 init p2p of link 2/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1926] [Device 1 init p2p of link 32022-12-11 19:20:46
.411227: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 19:20:46.411291: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-11 19:20:46] .eager alloc mem 611.00 KB411312
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 19:20:46eager alloc mem 611.00 KB.
411339: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:20:46.411840: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.412078: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.412107: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.412163: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.413387: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 19:20:46.413464: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:20:46.413958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 19:20:46.414041: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:20:46.414129: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 19:20:46.414181: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 19:20:46.414214: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-11 19:20:462022-12-11 19:20:46..414264414269: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::1980638] ] eager alloc mem 611.00 KBeager release cuda mem 625663

[2022-12-11 19:20:46.414779: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.415019: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.415097: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:20:46.415187: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:20:46.416181: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1000000 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2994744 / 100000000 nodes ( 2.99 %) | cpu 96005256 / 100000000 nodes ( 96.01 %) | 493.16 MB | 0.155569 secs 
[2022-12-11 19:20:46.416650: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:20:46.417041: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:20:46.417083: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:20:46.417397: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 999522 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2995222 / 100000000 nodes ( 3.00 %) | cpu 96005256 / 100000000 nodes ( 96.01 %) | 492.93 MB | 0.149348 secs 
[2022-12-11 19:20:46.417983: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 999437 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2995307 / 100000000 nodes ( 3.00 %) | cpu 96005256 / 100000000 nodes ( 96.01 %) | 492.89 MB | 0.182499 secs 
[2022-12-11 19:20:46.418380: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 995785 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2998959 / 100000000 nodes ( 3.00 %) | cpu 96005256 / 100000000 nodes ( 96.01 %) | 491.11 MB | 0.156907 secs 
[2022-12-11 19:20:46.418786: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 5.51 GB
[2022-12-11 19:20:47.367874: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 5.76 GB
[2022-12-11 19:20:47.368006: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 5.76 GB
[2022-12-11 19:20:47.370702: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 5.76 GB
[2022-12-11 19:20:48.156853: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 6.00 GB
[2022-12-11 19:20:48.157101: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 6.00 GB
[2022-12-11 19:20:48.157624: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 6.00 GB
[2022-12-11 19:20:48.976226: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 6.25 GB
[2022-12-11 19:20:48.976440: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 6.25 GB
[2022-12-11 19:20:48.976887: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 6.25 GB
[2022-12-11 19:20:49.844969: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 6.66 GB
[2022-12-11 19:20:49.845100: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 6.66 GB
[2022-12-11 19:20:49.845536: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 6.66 GB
[2022-12-11 19:20:50.509899: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 6.85 GB
[2022-12-11 19:20:50.510017: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 6.85 GB
[HCTR][19:20:50.574][ERROR][RK0][tid #140373716346624]: replica 0 calling init per replica done, doing barrier
[HCTR][19:20:50.574][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][19:20:50.574][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][19:20:50.574][ERROR][RK0][tid #140373707953920]: replica 2 calling init per replica done, doing barrier
[HCTR][19:20:50.575][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][19:20:50.575][ERROR][RK0][tid #140373707953920]: replica 2 calling init per replica done, doing barrier done
[HCTR][19:20:50.575][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][19:20:50.575][ERROR][RK0][tid #140373716346624]: replica 0 calling init per replica done, doing barrier done
[HCTR][19:20:50.575][ERROR][RK0][tid #140373707953920]: init per replica done
[HCTR][19:20:50.575][ERROR][RK0][main]: init per replica done
[HCTR][19:20:50.575][ERROR][RK0][main]: init per replica done
[HCTR][19:20:50.578][ERROR][RK0][tid #140373716346624]: init per replica done
[HCTR][19:20:50.583][ERROR][RK0][tid #140373707953920]: 2 allocated 3276800 at 0x7facb9520000
[HCTR][19:20:50.583][ERROR][RK0][tid #140373707953920]: 2 allocated 6553600 at 0x7f9526000000
[HCTR][19:20:50.583][ERROR][RK0][tid #140373707953920]: 2 allocated 3276800 at 0x7f9526640000
[HCTR][19:20:50.583][ERROR][RK0][tid #140373707953920]: 2 allocated 6553600 at 0x7f9526960000
[HCTR][19:20:50.584][ERROR][RK0][main]: 1 allocated 3276800 at 0x7facb7520000
[HCTR][19:20:50.584][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f942e000000
[HCTR][19:20:50.584][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f942e640000
[HCTR][19:20:50.584][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f942e960000
[HCTR][19:20:50.585][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f9506320000
[HCTR][19:20:50.585][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f9506800000
[HCTR][19:20:50.585][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f950750e800
[HCTR][19:20:50.585][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f950782e800
[HCTR][19:20:50.585][ERROR][RK0][main]: 3 allocated 3276800 at 0x7facb9520000
[HCTR][19:20:50.585][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f9526000000
[HCTR][19:20:50.585][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f9526640000
[HCTR][19:20:50.585][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f9526960000




