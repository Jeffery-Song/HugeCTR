2022-12-11 20:13:10.814122: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:13:10.880891: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:13:10.882532: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:13:10.882849: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:13:11.668836: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:13:11.668915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 20:13:11.681574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 20:13:11.716252: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:13:11.716424: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:13:11.718604: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 20:13:11.742152: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:13:11.742225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 20:13:11.742896: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:13:11.742950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 20:13:11.749487: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:13:11.749560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 20:13:11.755691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 20:13:11.758103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 20:13:11.763265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 20:13:11.786810: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:13:11.787026: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:13:11.788306: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:13:11.788426: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:13:11.788910: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 20:13:11.789800: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 20:13:11.793483: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:13:11.793602: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:13:11.795180: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][20:13:13.018][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:13:13.032][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:13:13.060][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:13:13.074][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.58s/it]warmup run: 100it [00:01, 82.42it/s]warmup run: 202it [00:01, 181.36it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1it [00:01,  1.51s/it]warmup run: 306it [00:01, 293.72it/s]warmup run: 104it [00:01, 94.91it/s]warmup run: 106it [00:01, 91.29it/s]warmup run: 410it [00:01, 411.08it/s]warmup run: 208it [00:01, 204.17it/s]warmup run: 212it [00:01, 197.56it/s]warmup run: 514it [00:02, 526.27it/s]warmup run: 313it [00:01, 323.84it/s]warmup run: 320it [00:01, 317.09it/s]warmup run: 620it [00:02, 636.80it/s]warmup run: 419it [00:01, 447.34it/s]warmup run: 428it [00:01, 440.54it/s]warmup run: 727it [00:02, 734.24it/s]warmup run: 526it [00:01, 567.51it/s]warmup run: 1it [00:01,  1.47s/it]warmup run: 536it [00:02, 560.17it/s]warmup run: 831it [00:02, 808.39it/s]warmup run: 632it [00:02, 672.73it/s]warmup run: 100it [00:01, 88.45it/s]warmup run: 645it [00:02, 672.10it/s]warmup run: 937it [00:02, 873.04it/s]warmup run: 739it [00:02, 765.14it/s]warmup run: 206it [00:01, 197.52it/s]warmup run: 752it [00:02, 764.00it/s]warmup run: 1041it [00:02, 915.36it/s]warmup run: 845it [00:02, 838.67it/s]warmup run: 311it [00:01, 315.37it/s]warmup run: 860it [00:02, 841.47it/s]warmup run: 1145it [00:02, 947.11it/s]warmup run: 953it [00:02, 901.75it/s]warmup run: 416it [00:01, 436.25it/s]warmup run: 968it [00:02, 901.77it/s]warmup run: 1249it [00:02, 972.39it/s]warmup run: 1060it [00:02, 946.03it/s]warmup run: 523it [00:01, 556.78it/s]warmup run: 1076it [00:02, 948.10it/s]warmup run: 1354it [00:02, 993.60it/s]warmup run: 1166it [00:02, 973.04it/s]warmup run: 631it [00:02, 668.12it/s]warmup run: 1185it [00:02, 986.23it/s]warmup run: 1459it [00:02, 1009.47it/s]warmup run: 1274it [00:02, 1002.83it/s]warmup run: 739it [00:02, 763.52it/s]warmup run: 1292it [00:02, 1002.37it/s]warmup run: 1564it [00:03, 1019.04it/s]warmup run: 1382it [00:02, 1022.84it/s]warmup run: 847it [00:02, 841.51it/s]warmup run: 1399it [00:02, 970.51it/s] warmup run: 1671it [00:03, 1032.12it/s]warmup run: 1489it [00:02, 1032.23it/s]warmup run: 954it [00:02, 901.07it/s]warmup run: 1504it [00:02, 991.66it/s]warmup run: 1778it [00:03, 1040.51it/s]warmup run: 1598it [00:02, 1046.79it/s]warmup run: 1060it [00:02, 943.00it/s]warmup run: 1616it [00:03, 1025.88it/s]warmup run: 1884it [00:03, 1043.26it/s]warmup run: 1705it [00:03, 1035.02it/s]warmup run: 1166it [00:02, 969.71it/s]warmup run: 1731it [00:03, 1061.69it/s]warmup run: 1990it [00:03, 1038.48it/s]warmup run: 1810it [00:03, 1036.91it/s]warmup run: 1272it [00:02, 994.37it/s]warmup run: 2117it [00:03, 1106.03it/s]warmup run: 1839it [00:03, 1031.20it/s]warmup run: 1917it [00:03, 1045.50it/s]warmup run: 1379it [00:02, 1014.49it/s]warmup run: 2247it [00:03, 1162.84it/s]warmup run: 1944it [00:03, 1031.78it/s]warmup run: 2029it [00:03, 1065.97it/s]warmup run: 1485it [00:02, 1024.84it/s]warmup run: 2380it [00:03, 1211.89it/s]warmup run: 2061it [00:03, 1069.60it/s]warmup run: 2160it [00:03, 1137.73it/s]warmup run: 1595it [00:02, 1045.08it/s]warmup run: 2514it [00:03, 1247.96it/s]warmup run: 2193it [00:03, 1142.20it/s]warmup run: 2287it [00:03, 1176.04it/s]warmup run: 1705it [00:03, 1058.45it/s]warmup run: 2648it [00:04, 1273.69it/s]warmup run: 2325it [00:03, 1194.09it/s]warmup run: 2421it [00:03, 1222.38it/s]warmup run: 1813it [00:03, 1063.50it/s]warmup run: 2783it [00:04, 1293.46it/s]warmup run: 2458it [00:03, 1231.59it/s]warmup run: 2555it [00:03, 1255.14it/s]warmup run: 1922it [00:03, 1069.95it/s]warmup run: 2918it [00:04, 1307.58it/s]warmup run: 2590it [00:03, 1257.10it/s]warmup run: 2687it [00:03, 1273.78it/s]warmup run: 3000it [00:04, 702.59it/s] warmup run: 2030it [00:03, 1065.21it/s]warmup run: 2820it [00:03, 1289.89it/s]warmup run: 2717it [00:03, 1242.26it/s]warmup run: 2160it [00:03, 1133.85it/s]warmup run: 2953it [00:04, 1300.97it/s]warmup run: 2850it [00:04, 1267.33it/s]warmup run: 3000it [00:04, 734.91it/s] warmup run: 2290it [00:03, 1181.79it/s]warmup run: 2984it [00:04, 1288.73it/s]warmup run: 3000it [00:04, 717.87it/s] warmup run: 2420it [00:03, 1215.77it/s]warmup run: 2551it [00:03, 1243.53it/s]warmup run: 2678it [00:03, 1249.61it/s]warmup run: 2807it [00:03, 1260.54it/s]warmup run: 2936it [00:04, 1268.96it/s]warmup run: 3000it [00:04, 724.58it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1710.97it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1717.32it/s]warmup should be done:   5%|▍         | 148/3000 [00:00<00:01, 1475.81it/s]warmup should be done:   5%|▌         | 156/3000 [00:00<00:01, 1553.55it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1741.79it/s]warmup should be done:  11%|█         | 321/3000 [00:00<00:01, 1625.00it/s]warmup should be done:  11%|█         | 330/3000 [00:00<00:01, 1661.89it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1735.02it/s]warmup should be done:  17%|█▋        | 524/3000 [00:00<00:01, 1749.10it/s]warmup should be done:  16%|█▋        | 493/3000 [00:00<00:01, 1666.42it/s]warmup should be done:  17%|█▋        | 503/3000 [00:00<00:01, 1689.22it/s]warmup should be done:  17%|█▋        | 522/3000 [00:00<00:01, 1730.22it/s]warmup should be done:  23%|██▎       | 701/3000 [00:00<00:01, 1757.19it/s]warmup should be done:  22%|██▏       | 667/3000 [00:00<00:01, 1693.23it/s]warmup should be done:  23%|██▎       | 677/3000 [00:00<00:01, 1705.53it/s]warmup should be done:  23%|██▎       | 696/3000 [00:00<00:01, 1731.06it/s]warmup should be done:  29%|██▉       | 877/3000 [00:00<00:01, 1756.89it/s]warmup should be done:  28%|██▊       | 839/3000 [00:00<00:01, 1701.88it/s]warmup should be done:  28%|██▊       | 850/3000 [00:00<00:01, 1713.23it/s]warmup should be done:  29%|██▉       | 870/3000 [00:00<00:01, 1725.10it/s]warmup should be done:  34%|███▍      | 1014/3000 [00:00<00:01, 1715.08it/s]warmup should be done:  34%|███▍      | 1022/3000 [00:00<00:01, 1714.52it/s]warmup should be done:  35%|███▌      | 1053/3000 [00:00<00:01, 1744.50it/s]warmup should be done:  35%|███▍      | 1043/3000 [00:00<00:01, 1714.78it/s]warmup should be done:  40%|███▉      | 1192/3000 [00:00<00:01, 1735.51it/s]warmup should be done:  40%|███▉      | 1196/3000 [00:00<00:01, 1722.30it/s]warmup should be done:  41%|████      | 1228/3000 [00:00<00:01, 1738.83it/s]warmup should be done:  40%|████      | 1215/3000 [00:00<00:01, 1715.26it/s]warmup should be done:  46%|████▌     | 1374/3000 [00:00<00:00, 1740.52it/s]warmup should be done:  46%|████▌     | 1372/3000 [00:00<00:00, 1752.64it/s]warmup should be done:  47%|████▋     | 1404/3000 [00:00<00:00, 1743.25it/s]warmup should be done:  46%|████▋     | 1388/3000 [00:00<00:00, 1718.12it/s]warmup should be done:  52%|█████▏    | 1554/3000 [00:00<00:00, 1756.74it/s]warmup should be done:  52%|█████▏    | 1549/3000 [00:00<00:00, 1757.02it/s]warmup should be done:  52%|█████▏    | 1560/3000 [00:00<00:00, 1717.04it/s]warmup should be done:  53%|█████▎    | 1579/3000 [00:00<00:00, 1726.07it/s]warmup should be done:  58%|█████▊    | 1733/3000 [00:01<00:00, 1765.43it/s]warmup should be done:  58%|█████▊    | 1733/3000 [00:01<00:00, 1720.23it/s]warmup should be done:  59%|█████▊    | 1756/3000 [00:01<00:00, 1739.21it/s]warmup should be done:  57%|█████▊    | 1725/3000 [00:01<00:00, 1723.82it/s]warmup should be done:  64%|██████▎   | 1912/3000 [00:01<00:00, 1772.84it/s]warmup should be done:  64%|██████▍   | 1933/3000 [00:01<00:00, 1748.26it/s]warmup should be done:  63%|██████▎   | 1901/3000 [00:01<00:00, 1732.12it/s]warmup should be done:  64%|██████▎   | 1906/3000 [00:01<00:00, 1706.98it/s]warmup should be done:  70%|██████▉   | 2092/3000 [00:01<00:00, 1778.89it/s]warmup should be done:  70%|███████   | 2110/3000 [00:01<00:00, 1752.58it/s]warmup should be done:  69%|██████▉   | 2078/3000 [00:01<00:00, 1742.41it/s]warmup should be done:  69%|██████▉   | 2079/3000 [00:01<00:00, 1712.03it/s]warmup should be done:  76%|███████▌  | 2270/3000 [00:01<00:00, 1759.00it/s]warmup should be done:  76%|███████▌  | 2287/3000 [00:01<00:00, 1756.57it/s]warmup should be done:  75%|███████▌  | 2255/3000 [00:01<00:00, 1747.92it/s]warmup should be done:  75%|███████▌  | 2251/3000 [00:01<00:00, 1712.37it/s]warmup should be done:  82%|████████▏ | 2449/3000 [00:01<00:00, 1766.20it/s]warmup should be done:  82%|████████▏ | 2467/3000 [00:01<00:00, 1766.62it/s]warmup should be done:  81%|████████  | 2432/3000 [00:01<00:00, 1753.63it/s]warmup should be done:  81%|████████  | 2425/3000 [00:01<00:00, 1719.96it/s]warmup should be done:  88%|████████▊ | 2627/3000 [00:01<00:00, 1767.67it/s]warmup should be done:  88%|████████▊ | 2645/3000 [00:01<00:00, 1770.55it/s]warmup should be done:  87%|████████▋ | 2609/3000 [00:01<00:00, 1758.43it/s]warmup should be done:  87%|████████▋ | 2598/3000 [00:01<00:00, 1713.46it/s]warmup should be done:  93%|█████████▎| 2804/3000 [00:01<00:00, 1768.30it/s]warmup should be done:  94%|█████████▍| 2823/3000 [00:01<00:00, 1773.23it/s]warmup should be done:  93%|█████████▎| 2786/3000 [00:01<00:00, 1761.87it/s]warmup should be done:  92%|█████████▏| 2770/3000 [00:01<00:00, 1680.66it/s]warmup should be done:  99%|█████████▉| 2982/3000 [00:01<00:00, 1770.79it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1755.08it/s]warmup should be done:  99%|█████████▉| 2964/3000 [00:01<00:00, 1765.22it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1745.74it/s]warmup should be done:  98%|█████████▊| 2941/3000 [00:01<00:00, 1688.54it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1732.75it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1710.19it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1757.70it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1678.50it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1753.13it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1771.12it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1779.57it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1759.71it/s]warmup should be done:  12%|█▏        | 363/3000 [00:00<00:01, 1815.11it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1787.42it/s]warmup should be done:  18%|█▊        | 548/3000 [00:00<00:01, 1829.38it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1795.77it/s]warmup should be done:  18%|█▊        | 526/3000 [00:00<00:01, 1737.54it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1743.47it/s]warmup should be done:  24%|██▍       | 733/3000 [00:00<00:01, 1834.96it/s]warmup should be done:  24%|██▍       | 719/3000 [00:00<00:01, 1783.72it/s]warmup should be done:  23%|██▎       | 704/3000 [00:00<00:01, 1751.83it/s]warmup should be done:  24%|██▎       | 710/3000 [00:00<00:01, 1746.19it/s]warmup should be done:  31%|███       | 918/3000 [00:00<00:01, 1838.93it/s]warmup should be done:  29%|██▉       | 883/3000 [00:00<00:01, 1763.73it/s]warmup should be done:  30%|██▉       | 898/3000 [00:00<00:01, 1780.42it/s]warmup should be done:  30%|██▉       | 885/3000 [00:00<00:01, 1731.95it/s]warmup should be done:  37%|███▋      | 1103/3000 [00:00<00:01, 1842.50it/s]warmup should be done:  36%|███▌      | 1077/3000 [00:00<00:01, 1783.34it/s]warmup should be done:  35%|███▌      | 1062/3000 [00:00<00:01, 1770.80it/s]warmup should be done:  35%|███▌      | 1060/3000 [00:00<00:01, 1737.83it/s]warmup should be done:  43%|████▎     | 1288/3000 [00:00<00:00, 1839.74it/s]warmup should be done:  42%|████▏     | 1258/3000 [00:00<00:00, 1791.60it/s]warmup should be done:  41%|████▏     | 1240/3000 [00:00<00:00, 1769.78it/s]warmup should be done:  41%|████      | 1234/3000 [00:00<00:01, 1737.43it/s]warmup should be done:  49%|████▉     | 1473/3000 [00:00<00:00, 1842.95it/s]warmup should be done:  48%|████▊     | 1440/3000 [00:00<00:00, 1800.16it/s]warmup should be done:  47%|████▋     | 1421/3000 [00:00<00:00, 1782.45it/s]warmup should be done:  47%|████▋     | 1410/3000 [00:00<00:00, 1743.82it/s]warmup should be done:  55%|█████▌    | 1658/3000 [00:00<00:00, 1844.19it/s]warmup should be done:  53%|█████▎    | 1604/3000 [00:00<00:00, 1796.84it/s]warmup should be done:  54%|█████▍    | 1621/3000 [00:00<00:00, 1790.10it/s]warmup should be done:  53%|█████▎    | 1586/3000 [00:00<00:00, 1748.29it/s]warmup should be done:  61%|██████▏   | 1843/3000 [00:01<00:00, 1844.28it/s]warmup should be done:  60%|█████▉    | 1787/3000 [00:01<00:00, 1805.88it/s]warmup should be done:  59%|█████▊    | 1762/3000 [00:01<00:00, 1750.19it/s]warmup should be done:  60%|██████    | 1801/3000 [00:01<00:00, 1706.19it/s]warmup should be done:  68%|██████▊   | 2031/3000 [00:01<00:00, 1852.58it/s]warmup should be done:  66%|██████▌   | 1970/3000 [00:01<00:00, 1812.44it/s]warmup should be done:  65%|██████▍   | 1938/3000 [00:01<00:00, 1753.06it/s]warmup should be done:  66%|██████▌   | 1983/3000 [00:01<00:00, 1738.90it/s]warmup should be done:  74%|███████▍  | 2220/3000 [00:01<00:00, 1861.42it/s]warmup should be done:  72%|███████▏  | 2153/3000 [00:01<00:00, 1817.51it/s]warmup should be done:  70%|███████   | 2115/3000 [00:01<00:00, 1755.28it/s]warmup should be done:  72%|███████▏  | 2165/3000 [00:01<00:00, 1762.40it/s]warmup should be done:  80%|████████  | 2409/3000 [00:01<00:00, 1867.87it/s]warmup should be done:  78%|███████▊  | 2337/3000 [00:01<00:00, 1821.99it/s]warmup should be done:  76%|███████▋  | 2292/3000 [00:01<00:00, 1758.20it/s]warmup should be done:  78%|███████▊  | 2345/3000 [00:01<00:00, 1773.04it/s]warmup should be done:  87%|████████▋ | 2598/3000 [00:01<00:00, 1874.05it/s]warmup should be done:  84%|████████▍ | 2521/3000 [00:01<00:00, 1825.18it/s]warmup should be done:  82%|████████▏ | 2468/3000 [00:01<00:00, 1747.12it/s]warmup should be done:  84%|████████▍ | 2526/3000 [00:01<00:00, 1781.32it/s]warmup should be done:  93%|█████████▎| 2787/3000 [00:01<00:00, 1878.29it/s]warmup should be done:  90%|█████████ | 2704/3000 [00:01<00:00, 1818.35it/s]warmup should be done:  88%|████████▊ | 2646/3000 [00:01<00:00, 1756.32it/s]warmup should be done:  90%|█████████ | 2705/3000 [00:01<00:00, 1773.44it/s]warmup should be done:  99%|█████████▉| 2975/3000 [00:01<00:00, 1870.50it/s]warmup should be done:  96%|█████████▌| 2887/3000 [00:01<00:00, 1820.12it/s]warmup should be done:  94%|█████████▍| 2823/3000 [00:01<00:00, 1757.70it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1852.19it/s]warmup should be done:  96%|█████████▌| 2883/3000 [00:01<00:00, 1763.92it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1796.69it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1770.26it/s]warmup should be done: 100%|█████████▉| 2999/3000 [00:01<00:00, 1757.27it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1750.72it/s]2022-12-11 20:14:26.838909: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f464ea6b7a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:14:26.838986: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:14:28.928080: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f465aa64ac0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:14:28.928141: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:14:28.988109: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x1c25b080 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:14:28.988173: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:14:31.033911: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:14:32.169819: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:14:32.516668: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:14:33.393927: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:14:33.446516: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:14:33.638205: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:14:34.900875: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:14:35.319561: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:14:37.095086: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f465a267890 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:14:37.095178: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:14:37.190077: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:14:39.707397: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:14:41.635218: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:14:43.493120: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][20:15:20.781][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][20:15:20.781][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:15:20.786][ERROR][RK0][main]: coll ps creation done
[HCTR][20:15:20.786][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][20:15:20.820][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][20:15:20.820][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:15:20.824][ERROR][RK0][main]: coll ps creation done
[HCTR][20:15:20.824][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][20:15:20.837][ERROR][RK0][tid #139940662847232]: replica 1 reaches 1000, calling init pre replica
[HCTR][20:15:20.837][ERROR][RK0][tid #139940662847232]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:15:20.837][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][20:15:20.837][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:15:20.840][ERROR][RK0][tid #139940662847232]: coll ps creation done
[HCTR][20:15:20.840][ERROR][RK0][tid #139940662847232]: replica 1 waits for coll ps creation barrier
[HCTR][20:15:20.840][ERROR][RK0][main]: coll ps creation done
[HCTR][20:15:20.840][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][20:15:20.840][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][20:15:21.795][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][20:15:21.823][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][20:15:21.823][ERROR][RK0][tid #139940662847232]: replica 1 calling init per replica
[HCTR][20:15:21.823][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][20:15:21.823][ERROR][RK0][tid #139940662847232]: Calling build_v2
[HCTR][20:15:21.823][ERROR][RK0][main]: Calling build_v2
[HCTR][20:15:21.823][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:15:21.823][ERROR][RK0][tid #139940662847232]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:15:21.823][ERROR][RK0][main]: Calling build_v2
[HCTR][20:15:21.823][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][20:15:21.823][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:15:21.823][ERROR][RK0][main]: Calling build_v2
[[[HCTR][20:15:21.823][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
2022-12-11 20:15:21.823132: 2022-12-11 20:15:21E.[ 823148/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: :2022-12-11 20:15:21E136. ] 823164/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccusing concurrent impl MPSPhase: :
E136 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccusing concurrent impl MPSPhase:
136] using concurrent impl MPSPhase
[2022-12-11 20:15:21.823285: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[2022-12-11 20:15:21.824355: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 20:15:21.824400: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 20:15:21.[8244332022-12-11 20:15:21: .E824443 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: 196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :assigning 8 to cpu213
] remote time is 8.68421
[2022-12-11 20:15:21[.2022-12-11 20:15:21824487.: 824495E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc [:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[2022-12-11 20:15:21196:2022-12-11 20:15:21.] 214.824534assigning 8 to cpu] 824540: 
cpu time is 30: E
E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::212196] ] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4assigning 8 to cpu[

2022-12-11 20:15:21.824634: E[ 2022-12-11 20:15:21/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:824665212: ] Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 20:15:21[.2022-12-11 20:15:21824732.: 824737E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[ :2022-12-11 20:15:21/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc213.:] 824757214remote time is 8.68421: ] 
Ecpu time is 30 
[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 20:15:21:.212824841] : build symm link desc with 4X Tesla V100-SXM2-16GB out of 4E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 20:15:21.824915: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 20:15:21.824958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 20:15:47.611883: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 20:15:47.680233: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 20:15:47.680361: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 20:15:47.681518: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 20:15:47.785879: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 20:15:48.155656: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 20:15:48.155742: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 20:15:55.845054: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 20:15:55.845183: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 20:15:57.706732: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 20:15:57.706829: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 20:15:57.723975: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 20:15:57.724052: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 20:15:57.754641: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 20:15:57.768609: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 20:15:57.769362: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 20:15:57.780309: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 20:15:57.880348: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 20:15:57.883831: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 20:15:57.886421: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 20:15:57.888926: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 20:15:57.891411: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 20:15:59.371035: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 20:15:59.375043: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 20:15:59.375195: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 20:15:59.384230: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 20:15:59.384301: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 20:15:59.384340: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 20:15:59.384375: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 20:15:59.385669: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:15:59.385715: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:15:59.386669: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:15:59.387231: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:15:59.406998: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved[
2022-12-11 20:15:59.[4070512022-12-11 20:15:59: .E407104 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 202/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :1 solved205
] worker 0 thread 3 initing device 3
[2022-12-11 20:15:59.407149: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 20:15:59.407995: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:15:59.408051: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:15:59.408377: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:15:59.408426: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:15:59.408649: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 20:15:59.408759: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 20:15:59.409424: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:15:59.409465: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:15:59.410466: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 20:15:59eager alloc mem 381.47 MB.
410505: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:15:59.411117: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:15:59.411188: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:15:59.412331: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:15:59.412903: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:15:59.485269: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 20:15:59.487129: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 20:15:59.487185: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 20:15:59.488042: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:15:59.488633: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:15:59.489557: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:15:59.490701: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 20:15:59.491730: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:15:59.492391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:15:59.492435: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 975.65 MB
[2022-12-11 20:15:59.492611: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 20:15:59.492667: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 20:15:59.494342: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:15:59.494875: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:15:59.495774: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:15:59.500933: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:15:59.501578: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:15:59.501619: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.28 MB
[[2022-12-11 20:15:592022-12-11 20:15:59..508700508706: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[[2022-12-11 20:15:592022-12-11 20:15:59..510546510547: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 1021eager release cuda mem 1021

[[2022-12-11 20:15:592022-12-11 20:15:59..510619510619: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 400000000eager release cuda mem 400000000

[2022-12-11 20:15:59.511446: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:15:59.511933: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:15:59.512436: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:15:59.512509: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:15:59.513341: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:15:59.513421: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:15:59.518697: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:15:59.518844: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:15:59.519350: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:15:59.519392: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 979.51 MB
[2022-12-11 20:15:59.519501: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:15:59.519544: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 976.05 MB
[[[[2022-12-11 20:15:592022-12-11 20:15:592022-12-11 20:15:592022-12-11 20:15:59....605034605039605037605045: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 1 init p2p of link 2Device 0 init p2p of link 1Device 2 init p2p of link 3



[2022-12-11 20:15:59.605299: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:[[2022-12-11 20:15:5919802022-12-11 20:15:592022-12-11 20:15:59.] ..605312eager alloc mem 611.00 KB605317605318: 
: : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KBeager alloc mem 611.00 KB


[2022-12-11 20:15:59.606172: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[[[2022-12-11 20:15:592022-12-11 20:15:592022-12-11 20:15:59...606223606222606222: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:::638638638] ] ] eager release cuda mem 625663eager release cuda mem 625663eager release cuda mem 625663


[2022-12-11 20:15:59.608361: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 20:15:59.608455: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:15:59.609270: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:15:59.613016: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[[2022-12-11 20:15:592022-12-11 20:15:59..613107613121: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261980] ] Device 3 init p2p of link 1eager alloc mem 611.00 KB

[2022-12-11 20:15:59.613239: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:15:59.613415: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 20:15:59.613527: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:15:59.613609: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 20:15:59.613691: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:15:59.613961: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:15:59.614058: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:15:59.614346: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:15:59.614457: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:15:59.615790: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 20:15:59.615895: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:15:59.616159: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 20:15:59.616261: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:15:59.616557: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:[6382022-12-11 20:15:59] .eager release cuda mem 8399996616579
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 20:15:59.616698: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB[
2022-12-11 20:15:59.616718: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:15:59.617094: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:15:59.617162: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1999671 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5973136 / 100000000 nodes ( 5.97 %) | cpu 92027193 / 100000000 nodes ( 92.03 %) | 981.28 MB | 0.205991 secs 
[2022-12-11 20:15:59.617516: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:15:59.618989: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:15:59.619031: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:15:59.619216: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:15:59.619757: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1988131 / 100000000 nodes ( 1.99 %~2.00 %) | remote 5984676 / 100000000 nodes ( 5.98 %) | cpu 92027193 / 100000000 nodes ( 92.03 %) | 975.65 MB | 0.234047 secs 
[2022-12-11 20:15:59.620170: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1996045 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5976762 / 100000000 nodes ( 5.98 %) | cpu 92027193 / 100000000 nodes ( 92.03 %) | 979.51 MB | 0.211755 secs 
[2022-12-11 20:15:59.620273: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 5.98 GB
[2022-12-11 20:15:59.620673: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1988960 / 100000000 nodes ( 1.99 %~2.00 %) | remote 5983847 / 100000000 nodes ( 5.98 %) | cpu 92027193 / 100000000 nodes ( 92.03 %) | 976.05 MB | 0.212643 secs 
[2022-12-11 20:16:00.551650: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 6.23 GB
[2022-12-11 20:16:00.551791: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 6.23 GB
[2022-12-11 20:16:00.552084: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 6.23 GB
[2022-12-11 20:16:01.364764: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 6.47 GB
[2022-12-11 20:16:01.364883: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 6.47 GB
[2022-12-11 20:16:01.365790: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 6.47 GB
[2022-12-11 20:16:02.151714: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 6.72 GB
[2022-12-11 20:16:02.151856: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 6.72 GB
[2022-12-11 20:16:02.152176: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 6.72 GB
[2022-12-11 20:16:02.152410: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 6.72 GB
[2022-12-11 20:16:02.152693: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 6.72 GB
[2022-12-11 20:16:02.921015: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 6.91 GB
[2022-12-11 20:16:02.921203: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 6.91 GB
[HCTR][20:16:03.228][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][20:16:03.228][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][20:16:03.228][ERROR][RK0][tid #139940662847232]: replica 1 calling init per replica done, doing barrier
[HCTR][20:16:03.228][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][20:16:03.228][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][20:16:03.228][ERROR][RK0][tid #139940662847232]: replica 1 calling init per replica done, doing barrier done
[HCTR][20:16:03.228][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][20:16:03.228][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][20:16:03.228][ERROR][RK0][tid #139940662847232]: init per replica done
[HCTR][20:16:03.228][ERROR][RK0][main]: init per replica done
[HCTR][20:16:03.228][ERROR][RK0][main]: init per replica done
[HCTR][20:16:03.231][ERROR][RK0][main]: init per replica done
[HCTR][20:16:03.237][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f2f36b20000
[HCTR][20:16:03.237][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f2f37000000
[HCTR][20:16:03.237][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f2f37640000
[HCTR][20:16:03.237][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f2f37960000
[HCTR][20:16:03.238][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f2feab20000
[HCTR][20:16:03.238][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f2feb000000
[HCTR][20:16:03.238][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f2feb640000
[HCTR][20:16:03.238][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f2feb960000
[HCTR][20:16:03.243][ERROR][RK0][tid #139940520236800]: 3 allocated 3276800 at 0x7f2f4ab20000
[HCTR][20:16:03.243][ERROR][RK0][tid #139940520236800]: 3 allocated 6553600 at 0x7f2f4b000000
[HCTR][20:16:03.243][ERROR][RK0][tid #139940520236800]: 3 allocated 3276800 at 0x7f2f4b640000
[HCTR][20:16:03.243][ERROR][RK0][tid #139940520236800]: 3 allocated 6553600 at 0x7f2f4b960000
[HCTR][20:16:03.248][ERROR][RK0][tid #139940528629504]: 0 allocated 3276800 at 0x7f329b120000
[HCTR][20:16:03.248][ERROR][RK0][tid #139940528629504]: 0 allocated 6553600 at 0x7f329b600000
[HCTR][20:16:03.248][ERROR][RK0][tid #139940528629504]: 0 allocated 3276800 at 0x7f2ffa50e800
[HCTR][20:16:03.248][ERROR][RK0][tid #139940528629504]: 0 allocated 6553600 at 0x7f2ffa82e800




