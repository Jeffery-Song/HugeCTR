2022-12-12 01:26:24.569224: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:26:24.639005: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:26:24.639075: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:26:24.639511: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:26:25.407345: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:26:25.407430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:26:25.420649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:26:25.451837: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:26:25.452012: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:26:25.453607: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 01:26:25.502839: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:26:25.502919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:26:25.516112: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:26:25.516197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:26:25.519284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:26:25.519904: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:26:25.519980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:26:25.530294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:26:25.535942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:26:25.553270: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:26:25.553415: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:26:25.554865: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 01:26:25.562886: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:26:25.563044: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:26:25.564506: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 01:26:25.570736: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:26:25.570879: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:26:25.572241: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][01:26:26.800][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:26:26.803][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:26:26.842][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:26:26.849][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 105it [00:01, 92.18it/s]warmup run: 1it [00:01,  1.51s/it]warmup run: 0it [00:00, ?it/s]warmup run: 201it [00:01, 189.03it/s]warmup run: 109it [00:01, 93.99it/s]warmup run: 309it [00:01, 311.57it/s]warmup run: 219it [00:01, 204.44it/s]warmup run: 418it [00:01, 439.29it/s]warmup run: 329it [00:01, 325.67it/s]warmup run: 527it [00:01, 562.65it/s]warmup run: 440it [00:01, 452.76it/s]warmup run: 638it [00:02, 678.95it/s]warmup run: 552it [00:02, 577.53it/s]warmup run: 749it [00:02, 778.42it/s]warmup run: 666it [00:02, 695.32it/s]warmup run: 860it [00:02, 860.26it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 780it [00:02, 798.06it/s]warmup run: 969it [00:02, 919.56it/s]warmup run: 113it [00:01, 103.60it/s]warmup run: 891it [00:02, 874.38it/s]warmup run: 1077it [00:02, 954.77it/s]warmup run: 227it [00:01, 223.81it/s]warmup run: 1002it [00:02, 935.94it/s]warmup run: 1187it [00:02, 992.76it/s]warmup run: 341it [00:01, 353.86it/s]warmup run: 1115it [00:02, 986.60it/s]warmup run: 1297it [00:02, 1020.85it/s]warmup run: 455it [00:01, 486.27it/s]warmup run: 1226it [00:02, 1014.97it/s]warmup run: 1408it [00:02, 1043.92it/s]warmup run: 568it [00:01, 610.26it/s]warmup run: 1337it [00:02, 1028.97it/s]warmup run: 1518it [00:02, 1058.55it/s]warmup run: 677it [00:02, 713.73it/s]warmup run: 1446it [00:02, 1043.81it/s]warmup run: 1627it [00:02, 1062.40it/s]warmup run: 792it [00:02, 816.20it/s]warmup run: 1555it [00:02, 1054.41it/s]warmup run: 1736it [00:03, 1069.00it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 907it [00:02, 900.06it/s]warmup run: 1664it [00:03, 1063.80it/s]warmup run: 1845it [00:03, 1071.34it/s]warmup run: 107it [00:01, 96.06it/s]warmup run: 1773it [00:03, 1066.14it/s]warmup run: 1019it [00:02, 929.13it/s]warmup run: 1954it [00:03, 1074.08it/s]warmup run: 215it [00:01, 207.95it/s]warmup run: 1882it [00:03, 1066.93it/s]warmup run: 1128it [00:02, 972.13it/s]warmup run: 2076it [00:03, 1115.49it/s]warmup run: 321it [00:01, 327.10it/s]warmup run: 1990it [00:03, 1069.95it/s]warmup run: 1237it [00:02, 968.24it/s]warmup run: 2211it [00:03, 1183.28it/s]warmup run: 430it [00:01, 453.90it/s]warmup run: 2122it [00:03, 1143.40it/s]warmup run: 1344it [00:02, 993.40it/s]warmup run: 2347it [00:03, 1233.79it/s]warmup run: 539it [00:01, 575.73it/s]warmup run: 2258it [00:03, 1206.55it/s]warmup run: 1450it [00:02, 1011.73it/s]warmup run: 2480it [00:03, 1261.25it/s]warmup run: 649it [00:02, 687.25it/s]warmup run: 2394it [00:03, 1250.92it/s]warmup run: 1558it [00:02, 1030.84it/s]warmup run: 2615it [00:03, 1287.53it/s]warmup run: 758it [00:02, 781.78it/s]warmup run: 2530it [00:03, 1281.98it/s]warmup run: 1666it [00:02, 1044.53it/s]warmup run: 2749it [00:03, 1302.73it/s]warmup run: 867it [00:02, 858.98it/s]warmup run: 2666it [00:03, 1304.46it/s]warmup run: 1774it [00:03, 1052.26it/s]warmup run: 2883it [00:03, 1313.39it/s]warmup run: 976it [00:02, 919.36it/s]warmup run: 2801it [00:03, 1315.96it/s]warmup run: 1881it [00:03, 1056.68it/s]warmup run: 3000it [00:04, 733.67it/s] warmup run: 1084it [00:02, 956.63it/s]warmup run: 2936it [00:04, 1325.05it/s]warmup run: 1990it [00:03, 1063.66it/s]warmup run: 3000it [00:04, 734.66it/s] warmup run: 1192it [00:02, 990.25it/s]warmup run: 2112it [00:03, 1108.03it/s]warmup run: 1300it [00:02, 1015.37it/s]warmup run: 2251it [00:03, 1190.29it/s]warmup run: 1408it [00:02, 1011.89it/s]warmup run: 2390it [00:03, 1248.11it/s]warmup run: 1514it [00:02, 1015.17it/s]warmup run: 2529it [00:03, 1289.36it/s]warmup run: 1619it [00:02, 1022.86it/s]warmup run: 2669it [00:03, 1319.83it/s]warmup run: 1724it [00:03, 1021.18it/s]warmup run: 2807it [00:03, 1335.87it/s]warmup run: 1828it [00:03, 1020.97it/s]warmup run: 2946it [00:03, 1349.20it/s]warmup run: 3000it [00:03, 751.05it/s] warmup run: 1935it [00:03, 1033.98it/s]warmup run: 2050it [00:03, 1068.16it/s]warmup run: 2184it [00:03, 1147.63it/s]warmup run: 2317it [00:03, 1199.60it/s]warmup run: 2449it [00:03, 1234.74it/s]warmup run: 2584it [00:03, 1267.49it/s]warmup run: 2718it [00:03, 1287.45it/s]warmup run: 2852it [00:03, 1300.47it/s]warmup run: 2986it [00:04, 1310.45it/s]warmup run: 3000it [00:04, 733.87it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1739.91it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1744.36it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1692.93it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1751.78it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1754.38it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1767.13it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1796.03it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1788.89it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1788.98it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1794.47it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1741.22it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1628.03it/s]warmup should be done:  24%|██▍       | 716/3000 [00:00<00:01, 1799.87it/s]warmup should be done:  24%|██▍       | 721/3000 [00:00<00:01, 1801.24it/s]warmup should be done:  23%|██▎       | 702/3000 [00:00<00:01, 1738.77it/s]warmup should be done:  23%|██▎       | 704/3000 [00:00<00:01, 1591.01it/s]warmup should be done:  30%|██▉       | 896/3000 [00:00<00:01, 1798.12it/s]warmup should be done:  30%|███       | 902/3000 [00:00<00:01, 1799.66it/s]warmup should be done:  29%|██▉       | 877/3000 [00:00<00:01, 1740.28it/s]warmup should be done:  29%|██▉       | 879/3000 [00:00<00:01, 1644.05it/s]warmup should be done:  36%|███▌      | 1082/3000 [00:00<00:01, 1796.17it/s]warmup should be done:  35%|███▌      | 1052/3000 [00:00<00:01, 1735.08it/s]warmup should be done:  36%|███▌      | 1076/3000 [00:00<00:01, 1744.16it/s]warmup should be done:  35%|███▌      | 1054/3000 [00:00<00:01, 1676.18it/s]warmup should be done:  42%|████▏     | 1264/3000 [00:00<00:00, 1800.93it/s]warmup should be done:  41%|████      | 1226/3000 [00:00<00:01, 1736.52it/s]warmup should be done:  42%|████▏     | 1257/3000 [00:00<00:00, 1762.88it/s]warmup should be done:  41%|████      | 1235/3000 [00:00<00:01, 1716.09it/s]warmup should be done:  48%|████▊     | 1445/3000 [00:00<00:00, 1802.25it/s]warmup should be done:  47%|████▋     | 1403/3000 [00:00<00:00, 1745.13it/s]warmup should be done:  48%|████▊     | 1437/3000 [00:00<00:00, 1771.69it/s]warmup should be done:  47%|████▋     | 1416/3000 [00:00<00:00, 1744.19it/s]warmup should be done:  54%|█████▍    | 1626/3000 [00:00<00:00, 1802.81it/s]warmup should be done:  53%|█████▎    | 1578/3000 [00:00<00:00, 1740.80it/s]warmup should be done:  54%|█████▍    | 1618/3000 [00:00<00:00, 1781.47it/s]warmup should be done:  53%|█████▎    | 1597/3000 [00:00<00:00, 1762.31it/s]warmup should be done:  60%|██████    | 1807/3000 [00:01<00:00, 1804.01it/s]warmup should be done:  58%|█████▊    | 1753/3000 [00:01<00:00, 1740.09it/s]warmup should be done:  60%|██████    | 1800/3000 [00:01<00:00, 1790.46it/s]warmup should be done:  59%|█████▉    | 1778/3000 [00:01<00:00, 1776.66it/s]warmup should be done:  66%|██████▋   | 1988/3000 [00:01<00:00, 1805.16it/s]warmup should be done:  64%|██████▍   | 1928/3000 [00:01<00:00, 1731.31it/s]warmup should be done:  66%|██████▌   | 1980/3000 [00:01<00:00, 1782.45it/s]warmup should be done:  65%|██████▌   | 1959/3000 [00:01<00:00, 1785.18it/s]warmup should be done:  70%|███████   | 2103/3000 [00:01<00:00, 1735.32it/s]warmup should be done:  72%|███████▏  | 2159/3000 [00:01<00:00, 1783.60it/s]warmup should be done:  72%|███████▏  | 2169/3000 [00:01<00:00, 1739.90it/s]warmup should be done:  71%|███████▏  | 2140/3000 [00:01<00:00, 1791.24it/s]warmup should be done:  76%|███████▌  | 2279/3000 [00:01<00:00, 1740.88it/s]warmup should be done:  78%|███████▊  | 2339/3000 [00:01<00:00, 1785.39it/s]warmup should be done:  78%|███████▊  | 2348/3000 [00:01<00:00, 1754.36it/s]warmup should be done:  77%|███████▋  | 2321/3000 [00:01<00:00, 1796.32it/s]warmup should be done:  82%|████████▏ | 2456/3000 [00:01<00:00, 1748.46it/s]warmup should be done:  84%|████████▍ | 2521/3000 [00:01<00:00, 1795.20it/s]warmup should be done:  84%|████████▍ | 2529/3000 [00:01<00:00, 1769.36it/s]warmup should be done:  83%|████████▎ | 2503/3000 [00:01<00:00, 1801.37it/s]warmup should be done:  88%|████████▊ | 2634/3000 [00:01<00:00, 1756.70it/s]warmup should be done:  90%|█████████ | 2709/3000 [00:01<00:00, 1777.54it/s]warmup should be done:  90%|█████████ | 2701/3000 [00:01<00:00, 1708.84it/s]warmup should be done:  89%|████████▉ | 2684/3000 [00:01<00:00, 1803.02it/s]warmup should be done:  94%|█████████▍| 2814/3000 [00:01<00:00, 1767.06it/s]warmup should be done:  96%|█████████▋| 2890/3000 [00:01<00:00, 1784.44it/s]warmup should be done:  96%|█████████▌| 2887/3000 [00:01<00:00, 1750.50it/s]warmup should be done:  96%|█████████▌| 2866/3000 [00:01<00:00, 1805.50it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1786.21it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1772.11it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1756.07it/s]warmup should be done: 100%|█████████▉| 2996/3000 [00:01<00:00, 1781.02it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1750.53it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 185/3000 [00:00<00:01, 1847.10it/s]warmup should be done:   6%|▌         | 185/3000 [00:00<00:01, 1843.92it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1665.58it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1791.76it/s]warmup should be done:  12%|█▏        | 370/3000 [00:00<00:01, 1846.71it/s]warmup should be done:  12%|█▏        | 372/3000 [00:00<00:01, 1854.09it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1752.01it/s]warmup should be done:  12%|█▏        | 365/3000 [00:00<00:01, 1824.34it/s]warmup should be done:  18%|█▊        | 550/3000 [00:00<00:01, 1834.54it/s]warmup should be done:  18%|█▊        | 555/3000 [00:00<00:01, 1840.64it/s]warmup should be done:  19%|█▊        | 559/3000 [00:00<00:01, 1857.52it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1806.26it/s]warmup should be done:  25%|██▍       | 736/3000 [00:00<00:01, 1841.87it/s]warmup should be done:  25%|██▍       | 746/3000 [00:00<00:01, 1860.77it/s]warmup should be done:  25%|██▍       | 740/3000 [00:00<00:01, 1833.65it/s]warmup should be done:  24%|██▍       | 718/3000 [00:00<00:01, 1659.33it/s]warmup should be done:  31%|███       | 922/3000 [00:00<00:01, 1846.09it/s]warmup should be done:  31%|███       | 934/3000 [00:00<00:01, 1864.30it/s]warmup should be done:  31%|███       | 924/3000 [00:00<00:01, 1834.90it/s]warmup should be done:  30%|███       | 904/3000 [00:00<00:01, 1725.30it/s]warmup should be done:  37%|███▋      | 1122/3000 [00:00<00:01, 1866.32it/s]warmup should be done:  37%|███▋      | 1108/3000 [00:00<00:01, 1832.38it/s]warmup should be done:  37%|███▋      | 1107/3000 [00:00<00:01, 1814.12it/s]warmup should be done:  36%|███▋      | 1088/3000 [00:00<00:01, 1760.08it/s]warmup should be done:  44%|████▎     | 1309/3000 [00:00<00:00, 1860.58it/s]warmup should be done:  43%|████▎     | 1292/3000 [00:00<00:00, 1829.54it/s]warmup should be done:  43%|████▎     | 1295/3000 [00:00<00:00, 1832.69it/s]warmup should be done:  43%|████▎     | 1277/3000 [00:00<00:00, 1800.34it/s]warmup should be done:  50%|████▉     | 1497/3000 [00:00<00:00, 1863.92it/s]warmup should be done:  49%|████▉     | 1475/3000 [00:00<00:00, 1829.35it/s]warmup should be done:  49%|████▉     | 1484/3000 [00:00<00:00, 1847.96it/s]warmup should be done:  49%|████▉     | 1468/3000 [00:00<00:00, 1834.51it/s]warmup should be done:  56%|█████▌    | 1685/3000 [00:00<00:00, 1867.19it/s]warmup should be done:  55%|█████▌    | 1659/3000 [00:00<00:00, 1831.31it/s]warmup should be done:  56%|█████▌    | 1672/3000 [00:00<00:00, 1857.78it/s]warmup should be done:  55%|█████▌    | 1659/3000 [00:00<00:00, 1857.35it/s]warmup should be done:  62%|██████▏   | 1873/3000 [00:01<00:00, 1868.23it/s]warmup should be done:  61%|██████▏   | 1843/3000 [00:01<00:00, 1830.86it/s]warmup should be done:  62%|██████▏   | 1858/3000 [00:01<00:00, 1827.07it/s]warmup should be done:  62%|██████▏   | 1850/3000 [00:01<00:00, 1873.37it/s]warmup should be done:  69%|██████▊   | 2061/3000 [00:01<00:00, 1869.58it/s]warmup should be done:  68%|██████▊   | 2027/3000 [00:01<00:00, 1830.53it/s]warmup should be done:  68%|██████▊   | 2047/3000 [00:01<00:00, 1843.85it/s]warmup should be done:  68%|██████▊   | 2041/3000 [00:01<00:00, 1881.91it/s]warmup should be done:  75%|███████▍  | 2249/3000 [00:01<00:00, 1869.91it/s]warmup should be done:  74%|███████▎  | 2211/3000 [00:01<00:00, 1829.71it/s]warmup should be done:  75%|███████▍  | 2236/3000 [00:01<00:00, 1856.64it/s]warmup should be done:  74%|███████▍  | 2232/3000 [00:01<00:00, 1888.12it/s]warmup should be done:  81%|████████  | 2436/3000 [00:01<00:00, 1869.69it/s]warmup should be done:  80%|███████▉  | 2394/3000 [00:01<00:00, 1825.06it/s]warmup should be done:  81%|████████  | 2424/3000 [00:01<00:00, 1861.39it/s]warmup should be done:  81%|████████  | 2423/3000 [00:01<00:00, 1891.96it/s]warmup should be done:  87%|████████▋ | 2623/3000 [00:01<00:00, 1866.56it/s]warmup should be done:  86%|████████▌ | 2577/3000 [00:01<00:00, 1823.10it/s]warmup should be done:  87%|████████▋ | 2611/3000 [00:01<00:00, 1861.59it/s]warmup should be done:  87%|████████▋ | 2614/3000 [00:01<00:00, 1895.88it/s]warmup should be done:  94%|█████████▎| 2810/3000 [00:01<00:00, 1867.28it/s]warmup should be done:  92%|█████████▏| 2760/3000 [00:01<00:00, 1817.88it/s]warmup should be done:  93%|█████████▎| 2798/3000 [00:01<00:00, 1860.50it/s]warmup should be done:  94%|█████████▎| 2805/3000 [00:01<00:00, 1898.18it/s]warmup should be done: 100%|█████████▉| 2998/3000 [00:01<00:00, 1868.92it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1865.47it/s]warmup should be done:  98%|█████████▊| 2942/3000 [00:01<00:00, 1799.27it/s]warmup should be done: 100%|█████████▉| 2985/3000 [00:01<00:00, 1862.32it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1847.28it/s]warmup should be done: 100%|█████████▉| 2997/3000 [00:01<00:00, 1902.17it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1841.29it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1823.16it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f954224b280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f954224c160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f954224b070>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f954224a190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-12 01:27:36.918995: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f9111a6b8c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:27:36.919051: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:27:36.919155: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f911da63c60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:27:36.919194: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:27:36.926018: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:27:36.926018: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:27:38.021486: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f911da67350 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:27:38.021596: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:27:38.026771: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f911da6ac80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:27:38.026815: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:27:38.032143: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:27:38.033936: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:27:38.123596: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:27:38.178366: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:27:38.835609: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:27:38.862508: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:27:43.527533: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:27:44.177748: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:27:44.188595: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:27:44.223508: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][01:28:37.054][ERROR][RK0][tid #140261401286400]: replica 3 reaches 1000, calling init pre replica
[HCTR][01:28:37.054][ERROR][RK0][tid #140261401286400]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:28:37.058][ERROR][RK0][tid #140261401286400]: coll ps creation done
[HCTR][01:28:37.058][ERROR][RK0][tid #140261401286400]: replica 3 waits for coll ps creation barrier
[HCTR][01:28:37.140][ERROR][RK0][tid #140261409679104]: replica 1 reaches 1000, calling init pre replica
[HCTR][01:28:37.141][ERROR][RK0][tid #140261409679104]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:28:37.145][ERROR][RK0][tid #140261409679104]: coll ps creation done
[HCTR][01:28:37.145][ERROR][RK0][tid #140261409679104]: replica 1 waits for coll ps creation barrier
[HCTR][01:28:37.391][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][01:28:37.391][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:28:37.395][ERROR][RK0][main]: coll ps creation done
[HCTR][01:28:37.395][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][01:28:37.648][ERROR][RK0][tid #140261401286400]: replica 2 reaches 1000, calling init pre replica
[HCTR][01:28:37.649][ERROR][RK0][tid #140261401286400]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:28:37.653][ERROR][RK0][tid #140261401286400]: coll ps creation done
[HCTR][01:28:37.653][ERROR][RK0][tid #140261401286400]: replica 2 waits for coll ps creation barrier
[HCTR][01:28:37.653][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][01:28:38.645][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][01:28:38.677][ERROR][RK0][tid #140261401286400]: replica 3 calling init per replica
[HCTR][01:28:38.677][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][01:28:38.677][ERROR][RK0][tid #140261409679104]: replica 1 calling init per replica
[HCTR][01:28:38.677][ERROR][RK0][tid #140261401286400]: Calling build_v2
[HCTR][01:28:38.677][ERROR][RK0][tid #140261401286400]: replica 2 calling init per replica
[HCTR][01:28:38.677][ERROR][RK0][tid #140261409679104]: Calling build_v2
[HCTR][01:28:38.677][ERROR][RK0][tid #140261401286400]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:28:38.677][ERROR][RK0][main]: Calling build_v2
[HCTR][01:28:38.677][ERROR][RK0][tid #140261401286400]: Calling build_v2
[HCTR][01:28:38.677][ERROR][RK0][tid #140261409679104]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:28:38.677][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:28:38.677][ERROR][RK0][tid #140261401286400]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-12 01:28:38.677640: E[[ [2022-12-12 01:28:38/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc.:2022-12-12 01:28:386776722022-12-12 01:28:38136] .: .using concurrent impl MPS677666E677670: 
 : E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE : /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136::] 136136using concurrent impl MPS] ] 
using concurrent impl MPSusing concurrent impl MPS

[2022-12-12 01:28:38.678850: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-12 01:28:38.678897: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 01:28:38.678939: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 01:28:38.678968: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 01:28:38.678991: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-12 01:28:38.679014: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[[2022-12-12 01:28:382022-12-12 01:28:38..[6790496790532022-12-12 01:28:38: : .EE679074  : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE:: 196212] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4:assigning 8 to cpu
212
] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 01:28:38.679197: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 01:28:38.[6792292022-12-12 01:28:38: .E679223[ : 2022-12-12 01:28:38/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE.: 679225214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: ] :Ecpu time is 30213 
] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421:
212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 01:28:38.679350: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-12 01:28:38214.] 679367: cpu time is 30E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 01:28:38.679433: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 01:29:05. 53734: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 01:29:05.108286: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 01:29:05.108382: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 01:29:05.109433: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 01:29:05.235918: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 01:29:05.607402: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 01:29:05.607502: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 01:29:13.153885: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 01:29:13.154029: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 01:29:14.891390: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 01:29:14.891498: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 01:29:14.913966: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 01:29:14.914054: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 01:29:16.159403: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 01:29:16.176394: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 01:29:16.177268: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 01:29:16.187572: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 01:29:16.284167: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 01:29:20.917905: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 01:29:20.922672: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 01:29:20.923062: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 01:29:20.934725: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 01:29:20.934793: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 01:29:20.934826: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 01:29:20.934857: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 01:29:20.935729: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:29:20.935777: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:29:20.936729: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:29:20.937279: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:29:20.956530: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 01:29:20.956628: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 01:29:20.957269: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:29:20.957322: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:29:20.958167: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:29:20.958202: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-12 01:29:20.958276: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1[
2022-12-12 01:29:20.958258: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-12 01:29:20.958343: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-12 01:29:20.958745: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:29:20.959091: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:29:20.959142: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:29:20.959164: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:29:20.959215: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:29:20.960425: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:29:20.960462: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:29:20.961439: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:29:20.961464: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:29:20.996131: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 01:29:20.998187: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 01:29:20.998252: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:29:20.999230: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:29:20.999909: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:29:21.   938: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21.   988: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.39 MB
[[2022-12-12 01:29:212022-12-12 01:29:21.. 26503 26508: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[[2022-12-12 01:29:212022-12-12 01:29:21.. 28409 28410: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 1021eager release cuda mem 1021

[[2022-12-12 01:29:212022-12-12 01:29:21.. 28483 28484: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 400000000eager release cuda mem 400000000

[2022-12-12 01:29:21. 29352: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:29:21. 29843: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:29:21. 30375: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-12 01:29:21:.1980 30392] : eager alloc mem 611.00 KBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:29:21. 31358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21. 31384: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:[6382022-12-12 01:29:21] .eager release cuda mem 625663 31405
: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.35 MB
[2022-12-12 01:29:21. 31438: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.39 MB
[2022-12-12 01:29:21. 36240: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:29:21. 36857: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:29:21. 36905: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[2022-12-12 01:29:21. 55116: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 01:29:21. 56952: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 01:29:21. 57004: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:29:21. 57729: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:29:21. 58175: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:29:21. 59134: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21. 59179: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.33 MB
[2022-12-12 01:29:21. 96397: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:29:21. 96597: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:29:21. 97038: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:29:21. 97081: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.67 GB
[2022-12-12 01:29:21. 97191: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:29:21. 97236: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[2022-12-12 01:29:21.124213: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:29:21.124847: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:29:21.124889: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.67 GB
[[[[2022-12-12 01:29:212022-12-12 01:29:212022-12-12 01:29:212022-12-12 01:29:21....732532732534732531732531: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 1 init p2p of link 2Device 2 init p2p of link 3Device 3 init p2p of link 0Device 0 init p2p of link 1



[2022-12-12 01:29:21.732812: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:29:21.732866: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:29:21[.2022-12-12 01:29:21732966.: 732971E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KB
[2022-12-12 01:29:21.733635: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21.733717: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21.733841: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-12 01:29:21
.733865: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21.740665: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 01:29:21.740730: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19262022-12-12 01:29:21] .[Device 1 init p2p of link 37407512022-12-12 01:29:21
: .E740772 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1926/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :Device 2 init p2p of link 01980
] eager alloc mem 611.00 KB
[2022-12-12 01:29:21.740854: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:29:21.740882: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:29:21.740964: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-12 01:29:21.741086: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:29:21.741606: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21.741665: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21.741692: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21.741895: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21.749191: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 01:29:21.749255: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19262022-12-12 01:29:21] .Device 1 init p2p of link 0749281
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:29:21.749349: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:29:21.749542: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 01:29:21.749593: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 01:29:21.749633: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:29:21.749701: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:29:21.750095: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21.750155: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21.750442: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21.750521: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:29:21.757293: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:29:21.757585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13981040 / 100000000 nodes ( 13.98 %~14.00 %) | remote 34847681 / 100000000 nodes ( 34.85 %) | cpu 51171279 / 100000000 nodes ( 51.17 %) | 6.67 GB | 0.800278 secs 
[2022-12-12 01:29:21.757748: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:29:21.757845: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-12 01:29:21.eager release cuda mem 56400000757921
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:29:21.758074: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13996671 / 100000000 nodes ( 14.00 %~14.00 %) | remote 34832050 / 100000000 nodes ( 34.83 %) | cpu 51171279 / 100000000 nodes ( 51.17 %) | 6.68 GB | 0.822305 secs 
[2022-12-12 01:29:21.758397: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13985130 / 100000000 nodes ( 13.99 %~14.00 %) | remote 34843591 / 100000000 nodes ( 34.84 %) | cpu 51171279 / 100000000 nodes ( 51.17 %) | 6.67 GB | 0.799195 secs 
[2022-12-12 01:29:21.758696: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13994879 / 100000000 nodes ( 13.99 %~14.00 %) | remote 34833842 / 100000000 nodes ( 34.83 %) | cpu 51171279 / 100000000 nodes ( 51.17 %) | 6.68 GB | 0.799564 secs 
[2022-12-12 01:29:21.759019: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.38 GB
[2022-12-12 01:29:22.756327: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.62 GB
[2022-12-12 01:29:22.756454: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.62 GB
[2022-12-12 01:29:22.756727: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.62 GB
[2022-12-12 01:29:23.571558: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.87 GB
[2022-12-12 01:29:23.572138: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.87 GB
[2022-12-12 01:29:23.572687: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.87 GB
[2022-12-12 01:29:24.379493: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.11 GB
[2022-12-12 01:29:24.379680: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.11 GB
[2022-12-12 01:29:24.380179: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.11 GB
[2022-12-12 01:29:25.158075: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.52 GB
[2022-12-12 01:29:25.158194: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.52 GB
[2022-12-12 01:29:25.158460: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 14.52 GB
[2022-12-12 01:29:26. 37306: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.71 GB
[2022-12-12 01:29:26. 37438: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.71 GB
[HCTR][01:29:26.265][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][01:29:26.265][ERROR][RK0][tid #140261401286400]: replica 3 calling init per replica done, doing barrier
[HCTR][01:29:26.265][ERROR][RK0][tid #140261401286400]: replica 2 calling init per replica done, doing barrier
[HCTR][01:29:26.265][ERROR][RK0][tid #140261409679104]: replica 1 calling init per replica done, doing barrier
[HCTR][01:29:26.265][ERROR][RK0][tid #140261409679104]: replica 1 calling init per replica done, doing barrier done
[HCTR][01:29:26.265][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][01:29:26.265][ERROR][RK0][tid #140261401286400]: replica 2 calling init per replica done, doing barrier done
[HCTR][01:29:26.265][ERROR][RK0][tid #140261401286400]: replica 3 calling init per replica done, doing barrier done
[HCTR][01:29:26.266][ERROR][RK0][tid #140261409679104]: init per replica done
[HCTR][01:29:26.266][ERROR][RK0][tid #140261401286400]: init per replica done
[HCTR][01:29:26.266][ERROR][RK0][tid #140261401286400]: init per replica done
[HCTR][01:29:26.269][ERROR][RK0][main]: init per replica done
[HCTR][01:29:26.301][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f769e238400
[HCTR][01:29:26.301][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f769e558400
[HCTR][01:29:26.301][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f769eb98400
[HCTR][01:29:26.301][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f769eeb8400
[HCTR][01:29:26.301][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f75d8238400
[HCTR][01:29:26.301][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f75d8558400
[HCTR][01:29:26.301][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f75d8b98400
[HCTR][01:29:26.301][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f75d8eb8400
[HCTR][01:29:26.302][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f75c8238400
[HCTR][01:29:26.302][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f75c8558400
[HCTR][01:29:26.302][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f75c8b98400
[HCTR][01:29:26.302][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f75c8eb8400
[HCTR][01:29:26.304][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f7644320000
[HCTR][01:29:26.304][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f7644640000
[HCTR][01:29:26.304][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f7644c80000
[HCTR][01:29:26.304][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f7644fa0000
