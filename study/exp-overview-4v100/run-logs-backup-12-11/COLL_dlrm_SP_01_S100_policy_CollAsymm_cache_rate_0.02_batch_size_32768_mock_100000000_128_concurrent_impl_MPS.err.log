2022-12-11 20:09:21.339122: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:09:21.343015: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:09:21.347951: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:09:21.351763: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 20:09:22.247401: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:09:22.247482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 20:09:22.253557: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:09:22.253635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 20:09:22.257060: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:09:22.257131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 20:09:22.260147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 20:09:22.263864: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 20:09:22.263930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 20:09:22.267480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 20:09:22.274862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 20:09:22.276417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 20:09:22.294863: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:09:22.295074: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:09:22.296073: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 20:09:22.302050: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:09:22.302215: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:09:22.303904: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 20:09:22.309335: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:09:22.309482: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:09:22.310198: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 20:09:22.310231: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:09:22.310393: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 20:09:22.311398: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][20:09:23.573][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:09:23.574][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:09:23.630][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][20:09:23.631][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.46s/it]warmup run: 1it [00:01,  1.45s/it]warmup run: 106it [00:01, 94.00it/s]warmup run: 108it [00:01, 96.45it/s]warmup run: 212it [00:01, 202.73it/s]warmup run: 215it [00:01, 206.67it/s]warmup run: 319it [00:01, 322.51it/s]warmup run: 321it [00:01, 325.47it/s]warmup run: 426it [00:01, 445.82it/s]warmup run: 428it [00:01, 448.47it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 1it [00:01,  1.45s/it]warmup run: 533it [00:01, 564.21it/s]warmup run: 535it [00:01, 566.91it/s]warmup run: 104it [00:01, 91.44it/s]warmup run: 105it [00:01, 93.93it/s]warmup run: 640it [00:02, 671.10it/s]warmup run: 638it [00:02, 665.58it/s]warmup run: 209it [00:01, 198.59it/s]warmup run: 209it [00:01, 201.35it/s]warmup run: 745it [00:02, 759.37it/s]warmup run: 742it [00:02, 753.34it/s]warmup run: 316it [00:01, 318.44it/s]warmup run: 314it [00:01, 319.44it/s]warmup run: 850it [00:02, 831.97it/s]warmup run: 845it [00:02, 822.65it/s]warmup run: 424it [00:01, 443.26it/s]warmup run: 419it [00:01, 440.63it/s]warmup run: 956it [00:02, 890.12it/s]warmup run: 949it [00:02, 878.93it/s]warmup run: 532it [00:01, 563.65it/s]warmup run: 525it [00:01, 558.52it/s]warmup run: 1061it [00:02, 930.12it/s]warmup run: 1053it [00:02, 921.68it/s]warmup run: 641it [00:02, 674.76it/s]warmup run: 624it [00:02, 649.69it/s]warmup run: 1165it [00:02, 947.70it/s]warmup run: 1156it [00:02, 942.97it/s]warmup run: 750it [00:02, 771.24it/s]warmup run: 734it [00:02, 755.04it/s]warmup run: 1272it [00:02, 981.74it/s]warmup run: 1258it [00:02, 958.15it/s]warmup run: 857it [00:02, 845.72it/s]warmup run: 843it [00:02, 837.46it/s]warmup run: 1379it [00:02, 1005.29it/s]warmup run: 1360it [00:02, 974.99it/s]warmup run: 965it [00:02, 906.92it/s]warmup run: 948it [00:02, 893.34it/s]warmup run: 1490it [00:02, 1034.06it/s]warmup run: 1462it [00:02, 951.20it/s]warmup run: 1074it [00:02, 956.15it/s]warmup run: 1053it [00:02, 925.59it/s]warmup run: 1599it [00:02, 1049.42it/s]warmup run: 1576it [00:02, 1004.06it/s]warmup run: 1188it [00:02, 1007.37it/s]warmup run: 1157it [00:02, 894.34it/s]warmup run: 1707it [00:03, 1056.56it/s]warmup run: 1687it [00:03, 1032.81it/s]warmup run: 1298it [00:02, 1020.88it/s]warmup run: 1263it [00:02, 939.12it/s]warmup run: 1815it [00:03, 1060.65it/s]warmup run: 1410it [00:02, 1048.28it/s]warmup run: 1792it [00:03, 1016.22it/s]warmup run: 1366it [00:02, 962.87it/s]warmup run: 1923it [00:03, 1061.96it/s]warmup run: 1524it [00:02, 1072.34it/s]warmup run: 1897it [00:03, 1025.45it/s]warmup run: 1472it [00:02, 988.21it/s]warmup run: 2030it [00:03, 1049.23it/s]warmup run: 2006it [00:03, 1042.74it/s]warmup run: 1635it [00:02, 1080.28it/s]warmup run: 1577it [00:02, 1004.93it/s]warmup run: 2165it [00:03, 1135.61it/s]warmup run: 2136it [00:03, 1118.24it/s]warmup run: 1746it [00:03, 1082.15it/s]warmup run: 1681it [00:03, 1013.42it/s]warmup run: 2300it [00:03, 1197.01it/s]warmup run: 2266it [00:03, 1170.91it/s]warmup run: 1856it [00:03, 1084.96it/s]warmup run: 1785it [00:03, 1020.25it/s]warmup run: 2435it [00:03, 1240.74it/s]warmup run: 2396it [00:03, 1209.09it/s]warmup run: 1966it [00:03, 1084.15it/s]warmup run: 1889it [00:03, 1013.34it/s]warmup run: 2570it [00:03, 1271.76it/s]warmup run: 2527it [00:03, 1237.10it/s]warmup run: 2092it [00:03, 1135.05it/s]warmup run: 1995it [00:03, 1025.41it/s]warmup run: 2704it [00:03, 1291.59it/s]warmup run: 2657it [00:03, 1255.14it/s]warmup run: 2228it [00:03, 1200.20it/s]warmup run: 2123it [00:03, 1098.59it/s]warmup run: 2839it [00:03, 1308.64it/s]warmup run: 2788it [00:03, 1269.40it/s]warmup run: 2364it [00:03, 1246.75it/s]warmup run: 2256it [00:03, 1165.27it/s]warmup run: 2975it [00:04, 1322.83it/s]warmup run: 3000it [00:04, 729.37it/s] warmup run: 2920it [00:04, 1281.82it/s]warmup run: 2493it [00:03, 1258.99it/s]warmup run: 2386it [00:03, 1204.12it/s]warmup run: 3000it [00:04, 721.89it/s] warmup run: 2623it [00:03, 1269.29it/s]warmup run: 2518it [00:03, 1236.73it/s]warmup run: 2758it [00:03, 1292.23it/s]warmup run: 2654it [00:03, 1273.32it/s]warmup run: 2894it [00:03, 1311.19it/s]warmup run: 2782it [00:04, 1214.37it/s]warmup run: 3000it [00:04, 735.12it/s] warmup run: 2911it [00:04, 1233.84it/s]warmup run: 3000it [00:04, 716.54it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1731.07it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1646.87it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1676.83it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1701.61it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1747.80it/s]warmup should be done:  11%|█▏        | 339/3000 [00:00<00:01, 1698.63it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1769.61it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1665.36it/s]warmup should be done:  17%|█▋        | 511/3000 [00:00<00:01, 1704.32it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1790.31it/s]warmup should be done:  18%|█▊        | 525/3000 [00:00<00:01, 1738.92it/s]warmup should be done:  17%|█▋        | 520/3000 [00:00<00:01, 1715.35it/s]warmup should be done:  24%|██▍       | 717/3000 [00:00<00:01, 1805.60it/s]warmup should be done:  23%|██▎       | 685/3000 [00:00<00:01, 1716.82it/s]warmup should be done:  23%|██▎       | 700/3000 [00:00<00:01, 1743.01it/s]warmup should be done:  23%|██▎       | 699/3000 [00:00<00:01, 1743.90it/s]warmup should be done:  29%|██▉       | 864/3000 [00:00<00:01, 1741.22it/s]warmup should be done:  30%|███       | 900/3000 [00:00<00:01, 1811.11it/s]warmup should be done:  29%|██▉       | 875/3000 [00:00<00:01, 1739.17it/s]warmup should be done:  29%|██▉       | 879/3000 [00:00<00:01, 1761.27it/s]warmup should be done:  36%|███▌      | 1082/3000 [00:00<00:01, 1813.32it/s]warmup should be done:  35%|███▍      | 1043/3000 [00:00<00:01, 1755.11it/s]warmup should be done:  35%|███▍      | 1049/3000 [00:00<00:01, 1728.34it/s]warmup should be done:  35%|███▌      | 1058/3000 [00:00<00:01, 1770.28it/s]warmup should be done:  42%|████▏     | 1265/3000 [00:00<00:00, 1817.23it/s]warmup should be done:  41%|████      | 1223/3000 [00:00<00:01, 1729.61it/s]warmup should be done:  41%|████▏     | 1238/3000 [00:00<00:00, 1776.83it/s]warmup should be done:  41%|████      | 1219/3000 [00:00<00:01, 1724.85it/s]warmup should be done:  48%|████▊     | 1447/3000 [00:00<00:00, 1816.49it/s]warmup should be done:  47%|████▋     | 1397/3000 [00:00<00:00, 1729.89it/s]warmup should be done:  47%|████▋     | 1416/3000 [00:00<00:00, 1777.35it/s]warmup should be done:  46%|████▋     | 1395/3000 [00:00<00:00, 1733.99it/s]warmup should be done:  54%|█████▍    | 1629/3000 [00:00<00:00, 1816.51it/s]warmup should be done:  52%|█████▏    | 1570/3000 [00:00<00:00, 1729.72it/s]warmup should be done:  53%|█████▎    | 1595/3000 [00:00<00:00, 1780.10it/s]warmup should be done:  52%|█████▎    | 1575/3000 [00:00<00:00, 1752.20it/s]warmup should be done:  60%|██████    | 1811/3000 [00:01<00:00, 1811.70it/s]warmup should be done:  58%|█████▊    | 1744/3000 [00:01<00:00, 1730.58it/s]warmup should be done:  59%|█████▉    | 1775/3000 [00:01<00:00, 1783.66it/s]warmup should be done:  59%|█████▊    | 1756/3000 [00:01<00:00, 1767.31it/s]warmup should be done:  66%|██████▋   | 1993/3000 [00:01<00:00, 1810.05it/s]warmup should be done:  64%|██████▍   | 1918/3000 [00:01<00:00, 1730.90it/s]warmup should be done:  65%|██████▍   | 1938/3000 [00:01<00:00, 1782.38it/s]warmup should be done:  65%|██████▌   | 1954/3000 [00:01<00:00, 1758.61it/s]warmup should be done:  72%|███████▎  | 2175/3000 [00:01<00:00, 1809.87it/s]warmup should be done:  70%|██████▉   | 2092/3000 [00:01<00:00, 1730.49it/s]warmup should be done:  71%|███████   | 2121/3000 [00:01<00:00, 1795.23it/s]warmup should be done:  71%|███████   | 2136/3000 [00:01<00:00, 1774.85it/s]warmup should be done:  79%|███████▊  | 2356/3000 [00:01<00:00, 1807.54it/s]warmup should be done:  76%|███████▌  | 2266/3000 [00:01<00:00, 1728.09it/s]warmup should be done:  77%|███████▋  | 2303/3000 [00:01<00:00, 1800.80it/s]warmup should be done:  77%|███████▋  | 2317/3000 [00:01<00:00, 1785.38it/s]warmup should be done:  85%|████████▍ | 2538/3000 [00:01<00:00, 1809.68it/s]warmup should be done:  81%|████████▏ | 2442/3000 [00:01<00:00, 1735.90it/s]warmup should be done:  83%|████████▎ | 2487/3000 [00:01<00:00, 1812.09it/s]warmup should be done:  83%|████████▎ | 2500/3000 [00:01<00:00, 1797.82it/s]warmup should be done:  91%|█████████ | 2719/3000 [00:01<00:00, 1808.37it/s]warmup should be done:  87%|████████▋ | 2616/3000 [00:01<00:00, 1736.69it/s]warmup should be done:  89%|████████▉ | 2670/3000 [00:01<00:00, 1815.15it/s]warmup should be done:  89%|████████▉ | 2682/3000 [00:01<00:00, 1802.74it/s]warmup should be done:  97%|█████████▋| 2900/3000 [00:01<00:00, 1808.16it/s]warmup should be done:  93%|█████████▎| 2794/3000 [00:01<00:00, 1748.63it/s]warmup should be done:  95%|█████████▌| 2853/3000 [00:01<00:00, 1819.10it/s]warmup should be done:  95%|█████████▌| 2863/3000 [00:01<00:00, 1750.62it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1805.73it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1774.27it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1765.69it/s]warmup should be done:  99%|█████████▉| 2974/3000 [00:01<00:00, 1762.19it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1740.02it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1839.69it/s]warmup should be done:   5%|▌         | 158/3000 [00:00<00:01, 1578.68it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1796.90it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1792.99it/s]warmup should be done:  12%|█▏        | 369/3000 [00:00<00:01, 1841.70it/s]warmup should be done:  11%|█▏        | 341/3000 [00:00<00:01, 1724.77it/s]warmup should be done:  12%|█▏        | 368/3000 [00:00<00:01, 1844.16it/s]warmup should be done:  12%|█▏        | 367/3000 [00:00<00:01, 1834.53it/s]warmup should be done:  19%|█▊        | 556/3000 [00:00<00:01, 1860.19it/s]warmup should be done:  17%|█▋        | 523/3000 [00:00<00:01, 1766.99it/s]warmup should be done:  18%|█▊        | 553/3000 [00:00<00:01, 1845.77it/s]warmup should be done:  18%|█▊        | 554/3000 [00:00<00:01, 1839.60it/s]warmup should be done:  25%|██▍       | 744/3000 [00:00<00:01, 1867.70it/s]warmup should be done:  24%|██▎       | 706/3000 [00:00<00:01, 1790.05it/s]warmup should be done:  25%|██▍       | 740/3000 [00:00<00:01, 1853.09it/s]warmup should be done:  25%|██▍       | 738/3000 [00:00<00:01, 1825.55it/s]warmup should be done:  31%|███       | 933/3000 [00:00<00:01, 1872.29it/s]warmup should be done:  30%|██▉       | 889/3000 [00:00<00:01, 1801.75it/s]warmup should be done:  31%|███       | 927/3000 [00:00<00:01, 1857.38it/s]warmup should be done:  31%|███       | 921/3000 [00:00<00:01, 1801.77it/s]warmup should be done:  37%|███▋      | 1122/3000 [00:00<00:01, 1876.53it/s]warmup should be done:  36%|███▌      | 1072/3000 [00:00<00:01, 1810.02it/s]warmup should be done:  37%|███▋      | 1113/3000 [00:00<00:01, 1857.22it/s]warmup should be done:  37%|███▋      | 1109/3000 [00:00<00:01, 1825.64it/s]warmup should be done:  43%|████▎     | 1299/3000 [00:00<00:00, 1857.94it/s]warmup should be done:  44%|████▎     | 1310/3000 [00:00<00:00, 1875.52it/s]warmup should be done:  42%|████▏     | 1253/3000 [00:00<00:00, 1791.95it/s]warmup should be done:  43%|████▎     | 1292/3000 [00:00<00:00, 1817.36it/s]warmup should be done:  50%|████▉     | 1499/3000 [00:00<00:00, 1878.88it/s]warmup should be done:  50%|████▉     | 1487/3000 [00:00<00:00, 1862.53it/s]warmup should be done:  48%|████▊     | 1438/3000 [00:00<00:00, 1808.44it/s]warmup should be done:  49%|████▉     | 1482/3000 [00:00<00:00, 1842.29it/s]warmup should be done:  56%|█████▋    | 1688/3000 [00:00<00:00, 1880.40it/s]warmup should be done:  54%|█████▍    | 1622/3000 [00:00<00:00, 1817.02it/s]warmup should be done:  56%|█████▌    | 1672/3000 [00:00<00:00, 1859.14it/s]warmup should be done:  56%|█████▌    | 1674/3000 [00:00<00:00, 1797.52it/s]warmup should be done:  63%|██████▎   | 1877/3000 [00:01<00:00, 1878.58it/s]warmup should be done:  60%|██████    | 1806/3000 [00:01<00:00, 1822.63it/s]warmup should be done:  62%|██████▏   | 1860/3000 [00:01<00:00, 1814.46it/s]warmup should be done:  62%|██████▏   | 1858/3000 [00:01<00:00, 1829.34it/s]warmup should be done:  69%|██████▉   | 2066/3000 [00:01<00:00, 1881.56it/s]warmup should be done:  66%|██████▋   | 1989/3000 [00:01<00:00, 1811.42it/s]warmup should be done:  68%|██████▊   | 2045/3000 [00:01<00:00, 1824.69it/s]warmup should be done:  68%|██████▊   | 2042/3000 [00:01<00:00, 1781.67it/s]warmup should be done:  75%|███████▌  | 2255/3000 [00:01<00:00, 1878.70it/s]warmup should be done:  73%|███████▎  | 2177/3000 [00:01<00:00, 1831.25it/s]warmup should be done:  74%|███████▍  | 2229/3000 [00:01<00:00, 1828.76it/s]warmup should be done:  74%|███████▍  | 2221/3000 [00:01<00:00, 1761.01it/s]warmup should be done:  79%|███████▉  | 2366/3000 [00:01<00:00, 1846.11it/s]warmup should be done:  81%|████████▏ | 2443/3000 [00:01<00:00, 1850.21it/s]warmup should be done:  80%|████████  | 2415/3000 [00:01<00:00, 1835.53it/s]warmup should be done:  80%|███████▉  | 2398/3000 [00:01<00:00, 1723.63it/s]warmup should be done:  85%|████████▌ | 2554/3000 [00:01<00:00, 1855.97it/s]warmup should be done:  88%|████████▊ | 2629/3000 [00:01<00:00, 1848.00it/s]warmup should be done:  87%|████████▋ | 2599/3000 [00:01<00:00, 1812.59it/s]warmup should be done:  86%|████████▌ | 2571/3000 [00:01<00:00, 1721.55it/s]warmup should be done:  91%|█████████▏| 2743/3000 [00:01<00:00, 1863.36it/s]warmup should be done:  94%|█████████▍| 2817/3000 [00:01<00:00, 1857.08it/s]warmup should be done:  93%|█████████▎| 2781/3000 [00:01<00:00, 1814.01it/s]warmup should be done:  92%|█████████▏| 2751/3000 [00:01<00:00, 1744.14it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1863.36it/s]warmup should be done:  98%|█████████▊| 2930/3000 [00:01<00:00, 1848.77it/s]warmup should be done:  99%|█████████▉| 2966/3000 [00:01<00:00, 1823.87it/s]warmup should be done:  98%|█████████▊| 2933/3000 [00:01<00:00, 1764.81it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1831.04it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1818.88it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1790.92it/s]2022-12-11 20:10:36.684304: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7ef9fe2640a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:10:36.684375: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:10:39.607191: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:10:41.175489: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:10:42.752086: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:10:43.610572: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7efa0626aea0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:10:43.610638: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:10:44.322245: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7efa062672b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:10:44.322306: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:10:44.370956: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7ef9fe2678e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 20:10:44.371020: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 20:10:46.695429: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:10:47.901436: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:10:48.422024: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:10:48.459981: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 20:10:49.667723: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:10:50.262620: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:10:50.322571: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 20:10:52.153464: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 20:10:52.158401: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][20:11:37.342][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][20:11:37.343][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:11:37.343][ERROR][RK0][tid #139612466964224]: replica 3 reaches 1000, calling init pre replica
[HCTR][20:11:37.344][ERROR][RK0][tid #139612466964224]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:11:37.346][ERROR][RK0][tid #139612466964224]: coll ps creation done
[HCTR][20:11:37.346][ERROR][RK0][tid #139612466964224]: replica 3 waits for coll ps creation barrier
[HCTR][20:11:37.347][ERROR][RK0][main]: coll ps creation done
[HCTR][20:11:37.347][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][20:11:37.360][ERROR][RK0][tid #139612735399680]: replica 0 reaches 1000, calling init pre replica
[HCTR][20:11:37.360][ERROR][RK0][tid #139612735399680]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:11:37.363][ERROR][RK0][tid #139612735399680]: coll ps creation done
[HCTR][20:11:37.363][ERROR][RK0][tid #139612735399680]: replica 0 waits for coll ps creation barrier
[HCTR][20:11:37.391][ERROR][RK0][tid #139612475356928]: replica 2 reaches 1000, calling init pre replica
[HCTR][20:11:37.392][ERROR][RK0][tid #139612475356928]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][20:11:37.395][ERROR][RK0][tid #139612475356928]: coll ps creation done
[HCTR][20:11:37.395][ERROR][RK0][tid #139612475356928]: replica 2 waits for coll ps creation barrier
[HCTR][20:11:37.395][ERROR][RK0][tid #139612735399680]: replica 0 preparing frequency
[HCTR][20:11:38.813][ERROR][RK0][tid #139612735399680]: replica 0 preparing frequency done
[HCTR][20:11:38.842][ERROR][RK0][tid #139612466964224]: replica 3 calling init per replica
[HCTR][20:11:38.842][ERROR][RK0][tid #139612735399680]: replica 0 calling init per replica
[HCTR][20:11:38.842][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][20:11:38.842][ERROR][RK0][tid #139612466964224]: Calling build_v2
[HCTR][20:11:38.842][ERROR][RK0][tid #139612475356928]: replica 2 calling init per replica
[HCTR][20:11:38.842][ERROR][RK0][tid #139612466964224]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:11:38.842][ERROR][RK0][main]: Calling build_v2
[HCTR][20:11:38.842][ERROR][RK0][tid #139612475356928]: Calling build_v2
[HCTR][20:11:38.842][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:11:38.842][ERROR][RK0][tid #139612475356928]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][20:11:38.842][ERROR][RK0][tid #139612735399680]: Calling build_v2
[HCTR][20:11:38.842][ERROR][RK0][tid #139612735399680]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-11 20:11:382022-12-11 20:11:38.2022-12-11 20:11:38.842634.842634: 842634: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136:136] 136] using concurrent impl MPS] using concurrent impl MPS
using concurrent impl MPS

[2022-12-11 20:11:38.842758: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPS
[2022-12-11 20:11:38.843960: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 20:11:38.843992: [E2022-12-11 20:11:38 [./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 20:11:38844007:.: 196844014E] :  assigning 8 to cpuE/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
[ :2022-12-11 20:11:38/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc212.:] [844057196build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 20:11:38: ] 
.Eassigning 8 to cpu844081 
[: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 20:11:38E:. 196844139/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[] : :2022-12-11 20:11:38assigning 8 to cpuE212.
 ] 844176/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4: :
E213 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421:
[[2122022-12-11 20:11:38[2022-12-11 20:11:38] .2022-12-11 20:11:38.build symm link desc with 4X Tesla V100-SXM2-16GB out of 4844254.844239
: 844268: E: E[ E 2022-12-11 20:11:38/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:844321213:212: ] 214] Eremote time is 8.68421] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4 
cpu time is 30
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
[:2022-12-11 20:11:38213.] [844422remote time is 8.684212022-12-11 20:11:38: 
.E844435 [: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 20:11:38E:. 214844471/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] : :cpu time is 30E213
 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421:
214] cpu time is 30[
2022-12-11 20:11:38.844601: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 20:12:04.982325: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 20:12:05. 42041: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 20:12:05. 42161: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 20:12:05. 43224: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 20:12:05.185595: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 20:12:05.575932: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 20:12:05.576088: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 20:12:13.153648: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 20:12:13.153845: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 20:12:14.931049: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 20:12:14.931154: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 20:12:14.961662: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 20:12:14.961750: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 20:12:16. 33864: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 20:12:16. 54240: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 20:12:16. 55097: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 20:12:16. 65719: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 20:12:16.162723: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 20:12:18.358543: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 20:12:18.362790: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 20:12:18.362934: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 20:12:18.374295: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 20:12:18.374369: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 20:12:18.374404: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 20:12:18.374435: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 20:12:18.375316: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:12:18.375365: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:12:18.376293: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:12:18.376848: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:12:18.395446: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 20:12:18.395549: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 20:12:18.396403: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:12:18.396458: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:12:18.397041: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 20:12:18.397118: [E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc2022-12-11 20:12:18:.205397095] : worker 0 thread 1 initing device 1E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 20:12:18.397184: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 20:12:18.397359: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:12:18.397907: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:12:18.397938: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:12:18.397989[: 2022-12-11 20:12:18E. 397994/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1980 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 381.47 MB:
1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 20:12:18.398060: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:12:18.399664: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:12:18.399704: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:12:18.400703: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:12:18.400730: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 20:12:18.440874: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 20:12:18.443131: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 20:12:18.443213: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 20:12:18.444559: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:12:18.445657: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:12:18.446690: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:12:18.453690: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:12:18.454642: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:12:18.454710: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.04 MB
[[[2022-12-11 20:12:182022-12-11 20:12:182022-12-11 20:12:18...494962494962494968: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

eager alloc mem 1021.00 Bytes
[2022-12-11 20:12:18.[[4968342022-12-11 20:12:182022-12-11 20:12:18: ..E496839496839 : : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccEE:  638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] ::eager release cuda mem 1021638638
] ] eager release cuda mem 1021eager release cuda mem 1021

[2022-12-11 20:12:18.496923: [E2022-12-11 20:12:18[ .2022-12-11 20:12:18/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc496933.:: 496936638E: ]  Eeager release cuda mem 400000000/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc 
:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 400000000] 
eager release cuda mem 400000000
[2022-12-11 20:12:18.497842: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:12:18.498328: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:12:18.498839: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.01 MB
[2022-12-11 20:12:18.499344: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:12:18.499449: E[ 2022-12-11 20:12:18/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:4994631980: ] Eeager alloc mem 611.00 KB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:12:18.500251: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:12:18.500356: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-11 20:12:18
.500377: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:12:18.510343: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:12:18.510399: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:12:18.510443: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 20:12:18.510932: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 20:12:18.510975: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.36 MB
[2022-12-11 20:12:18.511001: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 20:12:18eager release cuda mem 25855.
511021: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855[
2022-12-11 20:12:18.511052: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 20:12:18eager alloc mem 981.17 MB.
511073: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 981.34 MB
[[[[2022-12-11 20:12:182022-12-11 20:12:182022-12-11 20:12:182022-12-11 20:12:18....604593604593604594604593: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 2 init p2p of link 3Device 1 init p2p of link 2Device 0 init p2p of link 1



[[2022-12-11 20:12:182022-12-11 20:12:18..[6048176048182022-12-11 20:12:18: : .[EE6048282022-12-11 20:12:18  : ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE604838:: : 19801980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE] ] : eager alloc mem 611.00 KB1980eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
] 
:eager alloc mem 611.00 KB1980
] eager alloc mem 611.00 KB
[2022-12-11 20:12:18.605654: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 20:12:18eager release cuda mem 625663.
605673: [E2022-12-11 20:12:18 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc605689:: 638E]  eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] [eager release cuda mem 6256632022-12-11 20:12:18
.605727: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[[2022-12-11 20:12:182022-12-11 20:12:18..607983607988: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261926] ] Device 1 init p2p of link 3Device 3 init p2p of link 1

[2022-12-11 20:12:18.608062: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[1926[2022-12-11 20:12:18] [2022-12-11 20:12:18.Device 0 init p2p of link 22022-12-11 20:12:18.608087
.608102: 608105: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926:1980] 1980] Device 2 init p2p of link 0] eager alloc mem 611.00 KB
eager alloc mem 611.00 KB

[2022-12-11 20:12:18.608180: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:12:18.608243: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:12:18.608910: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-11 20:12:18
.608929: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 20:12:18eager release cuda mem 625663.
608952: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:12:18.609062: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:12:18.611043: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 20:12:18.611131: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:12:18.611210: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 20:12:18.611292: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:12:18.611323: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 20:12:18.611409: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:12:18.611488: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 20:12:18.611581: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 20:12:18.611882: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:12:18.612063: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:12:18.612175: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:12:18.612395: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 20:12:18.613558: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:12:18.613913: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1999828 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5997769 / 100000000 nodes ( 6.00 %) | cpu 92002403 / 100000000 nodes ( 92.00 %) | 981.36 MB | 0.217475 secs 
[2022-12-11 20:12:18.614096: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:12:18.614269: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:12:18.614315: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1999781 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5997816 / 100000000 nodes ( 6.00 %) | cpu 92002403 / 100000000 nodes ( 92.00 %) | 981.34 MB | 0.21634 secs 
[2022-12-11 20:12:18.614390: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 8399996
[2022-12-11 20:12:18.614868: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1999162 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5998435 / 100000000 nodes ( 6.00 %) | cpu 92002403 / 100000000 nodes ( 92.00 %) | 981.04 MB | 0.239511 secs 
[2022-12-11 20:12:18.615013: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1999437 / 100000000 nodes ( 2.00 %~2.00 %) | remote 5998160 / 100000000 nodes ( 6.00 %) | cpu 92002403 / 100000000 nodes ( 92.00 %) | 981.17 MB | 0.216966 secs 
[2022-12-11 20:12:18.615729: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 5.99 GB
[2022-12-11 20:12:19.620961: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 6.23 GB
[2022-12-11 20:12:19.621111: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 6.23 GB
[2022-12-11 20:12:19.621399: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 6.23 GB
[2022-12-11 20:12:20.488829: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 6.48 GB
[2022-12-11 20:12:20.488964: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 6.48 GB
[2022-12-11 20:12:20.489393: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 6.48 GB
[2022-12-11 20:12:21.378983: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 6.72 GB
[2022-12-11 20:12:21.379908: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 6.72 GB
[2022-12-11 20:12:21.380245: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 6.72 GB
[2022-12-11 20:12:22.157146: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.13 GB
[2022-12-11 20:12:22.158509: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.13 GB
[2022-12-11 20:12:22.159543: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.13 GB
[2022-12-11 20:12:22.928225: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.32 GB
[2022-12-11 20:12:22.928344: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.32 GB
[HCTR][20:12:23.120][ERROR][RK0][tid #139612466964224]: replica 3 calling init per replica done, doing barrier
[HCTR][20:12:23.120][ERROR][RK0][tid #139612475356928]: replica 2 calling init per replica done, doing barrier
[HCTR][20:12:23.120][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][20:12:23.120][ERROR][RK0][tid #139612735399680]: replica 0 calling init per replica done, doing barrier
[HCTR][20:12:23.120][ERROR][RK0][tid #139612735399680]: replica 0 calling init per replica done, doing barrier done
[HCTR][20:12:23.120][ERROR][RK0][tid #139612475356928]: replica 2 calling init per replica done, doing barrier done
[HCTR][20:12:23.120][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][20:12:23.120][ERROR][RK0][tid #139612466964224]: replica 3 calling init per replica done, doing barrier done
[HCTR][20:12:23.120][ERROR][RK0][tid #139612466964224]: init per replica done
[HCTR][20:12:23.120][ERROR][RK0][tid #139612475356928]: init per replica done
[HCTR][20:12:23.120][ERROR][RK0][main]: init per replica done
[HCTR][20:12:23.127][ERROR][RK0][tid #139612466964224]: 3 allocated 3276800 at 0x7ee3deb20000
[HCTR][20:12:23.127][ERROR][RK0][tid #139612466964224]: 3 allocated 6553600 at 0x7ee3df000000
[HCTR][20:12:23.127][ERROR][RK0][tid #139612466964224]: 3 allocated 3276800 at 0x7ee3df640000
[HCTR][20:12:23.127][ERROR][RK0][tid #139612466964224]: 3 allocated 6553600 at 0x7ee3df960000
[HCTR][20:12:23.127][ERROR][RK0][tid #139612466964224]: 1 allocated 3276800 at 0x7ee2aeb20000
[HCTR][20:12:23.127][ERROR][RK0][tid #139612466964224]: 1 allocated 6553600 at 0x7ee2af000000
[HCTR][20:12:23.127][ERROR][RK0][tid #139612466964224]: 1 allocated 3276800 at 0x7ee2af640000
[HCTR][20:12:23.127][ERROR][RK0][tid #139612466964224]: 1 allocated 6553600 at 0x7ee2af960000
[HCTR][20:12:23.131][ERROR][RK0][tid #139612475356928]: 2 allocated 3276800 at 0x7ee3a6b20000
[HCTR][20:12:23.131][ERROR][RK0][tid #139612475356928]: 2 allocated 6553600 at 0x7ee3a7000000
[HCTR][20:12:23.131][ERROR][RK0][tid #139612475356928]: 2 allocated 3276800 at 0x7ee3a7640000
[HCTR][20:12:23.131][ERROR][RK0][tid #139612475356928]: 2 allocated 6553600 at 0x7ee3a7960000
[HCTR][20:12:23.166][ERROR][RK0][tid #139612735399680]: init per replica done
[HCTR][20:12:23.174][ERROR][RK0][main]: 0 allocated 3276800 at 0x7ee64f120000
[HCTR][20:12:23.174][ERROR][RK0][main]: 0 allocated 6553600 at 0x7ee64f600000
[HCTR][20:12:23.174][ERROR][RK0][main]: 0 allocated 3276800 at 0x7ee3a650e800
[HCTR][20:12:23.174][ERROR][RK0][main]: 0 allocated 6553600 at 0x7ee3a682e800




