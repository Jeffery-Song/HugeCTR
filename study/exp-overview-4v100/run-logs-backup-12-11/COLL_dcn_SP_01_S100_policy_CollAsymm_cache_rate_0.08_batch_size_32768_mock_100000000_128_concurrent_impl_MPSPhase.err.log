2022-12-11 23:07:30.536870: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:07:30.611712: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:07:30.612083: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:07:30.612155: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 23:07:31.421469: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:07:31.421556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:07:31.434593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 23:07:31.465097: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:07:31.465271: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:07:31.467396: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 23:07:31.505141: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:07:31.505225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:07:31.506099: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:07:31.506157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:07:31.509635: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 23:07:31.509698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:07:31.517264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 23:07:31.521640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 23:07:31.522058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 23:07:31.552189: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:07:31.552370: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:07:31.552878: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:07:31.553082: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:07:31.553168: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:07:31.553278: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 23:07:31.554661: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 23:07:31.554877: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 23:07:31.555152: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][23:07:32.794][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:07:32.800][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:07:32.830][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][23:07:32.848][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 102it [00:01, 89.24it/s]warmup run: 210it [00:01, 199.46it/s]warmup run: 318it [00:01, 319.93it/s]warmup run: 1it [00:01,  1.48s/it]warmup run: 423it [00:01, 439.32it/s]warmup run: 104it [00:01, 91.26it/s]warmup run: 529it [00:01, 556.85it/s]warmup run: 214it [00:01, 203.74it/s]warmup run: 636it [00:02, 665.69it/s]warmup run: 324it [00:01, 326.75it/s]warmup run: 742it [00:02, 757.60it/s]warmup run: 434it [00:01, 453.13it/s]warmup run: 1it [00:01,  1.51s/it]warmup run: 851it [00:02, 840.48it/s]warmup run: 543it [00:01, 573.24it/s]warmup run: 103it [00:01, 88.94it/s]warmup run: 956it [00:02, 864.18it/s]warmup run: 646it [00:02, 667.50it/s]warmup run: 210it [00:01, 196.74it/s]warmup run: 1068it [00:02, 929.81it/s]warmup run: 1it [00:01,  1.46s/it]warmup run: 753it [00:02, 759.35it/s]warmup run: 317it [00:01, 315.13it/s]warmup run: 1182it [00:02, 986.20it/s]warmup run: 105it [00:01, 93.54it/s]warmup run: 861it [00:02, 837.33it/s]warmup run: 423it [00:01, 435.82it/s]warmup run: 1294it [00:02, 1023.29it/s]warmup run: 210it [00:01, 201.69it/s]warmup run: 966it [00:02, 872.37it/s]warmup run: 527it [00:02, 548.99it/s]warmup run: 1404it [00:02, 1044.82it/s]warmup run: 314it [00:01, 318.04it/s]warmup run: 1068it [00:02, 894.22it/s]warmup run: 636it [00:02, 663.02it/s]warmup run: 1513it [00:02, 1044.54it/s]warmup run: 419it [00:01, 438.82it/s]warmup run: 1168it [00:02, 912.45it/s]warmup run: 743it [00:02, 757.41it/s]warmup run: 518it [00:01, 543.54it/s]warmup run: 1621it [00:03, 1046.22it/s]warmup run: 1267it [00:02, 925.40it/s]warmup run: 849it [00:02, 832.48it/s]warmup run: 622it [00:02, 648.64it/s]warmup run: 1728it [00:03, 1047.64it/s]warmup run: 1370it [00:02, 952.67it/s]warmup run: 954it [00:02, 889.13it/s]warmup run: 727it [00:02, 741.59it/s]warmup run: 1838it [00:03, 1060.65it/s]warmup run: 1475it [00:02, 978.14it/s]warmup run: 1059it [00:02, 927.00it/s]warmup run: 830it [00:02, 812.87it/s]warmup run: 1946it [00:03, 1064.91it/s]warmup run: 1578it [00:03, 990.76it/s]warmup run: 1164it [00:02, 959.69it/s]warmup run: 934it [00:02, 871.22it/s]warmup run: 2069it [00:03, 1111.57it/s]warmup run: 1681it [00:03, 1001.10it/s]warmup run: 1269it [00:02, 980.51it/s]warmup run: 1037it [00:02, 913.66it/s]warmup run: 2201it [00:03, 1172.21it/s]warmup run: 1783it [00:03, 1004.98it/s]warmup run: 1373it [00:02, 997.41it/s]warmup run: 1145it [00:02, 959.38it/s]warmup run: 2336it [00:03, 1222.45it/s]warmup run: 1885it [00:03, 1004.95it/s]warmup run: 1477it [00:02, 1007.53it/s]warmup run: 1250it [00:02, 984.05it/s]warmup run: 2471it [00:03, 1257.91it/s]warmup run: 1991it [00:03, 1018.92it/s]warmup run: 1581it [00:03, 1012.15it/s]warmup run: 1357it [00:02, 1007.76it/s]warmup run: 2600it [00:03, 1265.04it/s]warmup run: 2119it [00:03, 1096.26it/s]warmup run: 1685it [00:03, 1014.90it/s]warmup run: 1462it [00:02, 1014.80it/s]warmup run: 2733it [00:03, 1284.04it/s]warmup run: 2250it [00:03, 1158.78it/s]warmup run: 1790it [00:03, 1022.18it/s]warmup run: 2867it [00:04, 1299.96it/s]warmup run: 1567it [00:02, 1012.10it/s]warmup run: 2382it [00:03, 1205.07it/s]warmup run: 1897it [00:03, 1034.66it/s]warmup run: 1673it [00:03, 1024.59it/s]warmup run: 3000it [00:04, 727.53it/s] warmup run: 2514it [00:03, 1239.24it/s]warmup run: 2002it [00:03, 1023.14it/s]warmup run: 1777it [00:03, 1001.15it/s]warmup run: 2648it [00:03, 1266.77it/s]warmup run: 2136it [00:03, 1114.44it/s]warmup run: 1879it [00:03, 1001.57it/s]warmup run: 2780it [00:04, 1281.31it/s]warmup run: 2270it [00:03, 1180.97it/s]warmup run: 1982it [00:03, 1009.82it/s]warmup run: 2911it [00:04, 1283.35it/s]warmup run: 2405it [00:03, 1229.42it/s]warmup run: 3000it [00:04, 714.61it/s] warmup run: 2108it [00:03, 1081.75it/s]warmup run: 2537it [00:03, 1256.00it/s]warmup run: 2217it [00:03, 1055.24it/s]warmup run: 2671it [00:03, 1280.79it/s]warmup run: 2342it [00:03, 1110.51it/s]warmup run: 2806it [00:04, 1298.91it/s]warmup run: 2473it [00:03, 1168.36it/s]warmup run: 2942it [00:04, 1314.80it/s]warmup run: 3000it [00:04, 717.98it/s] warmup run: 2600it [00:03, 1197.02it/s]warmup run: 2729it [00:03, 1222.51it/s]warmup run: 2858it [00:04, 1240.70it/s]warmup run: 2987it [00:04, 1255.11it/s]warmup run: 3000it [00:04, 712.36it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1737.02it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1727.64it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1684.51it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1722.75it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1739.14it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1766.92it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1759.88it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1727.02it/s]warmup should be done:  17%|█▋        | 523/3000 [00:00<00:01, 1748.57it/s]warmup should be done:  18%|█▊        | 530/3000 [00:00<00:01, 1765.60it/s]warmup should be done:  17%|█▋        | 521/3000 [00:00<00:01, 1724.50it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1667.20it/s]warmup should be done:  23%|██▎       | 701/3000 [00:00<00:01, 1758.03it/s]warmup should be done:  23%|██▎       | 697/3000 [00:00<00:01, 1736.09it/s]warmup should be done:  24%|██▎       | 707/3000 [00:00<00:01, 1753.99it/s]warmup should be done:  24%|██▎       | 705/3000 [00:00<00:01, 1703.72it/s]warmup should be done:  29%|██▉       | 878/3000 [00:00<00:01, 1759.79it/s]warmup should be done:  29%|██▉       | 883/3000 [00:00<00:01, 1754.45it/s]warmup should be done:  29%|██▉       | 871/3000 [00:00<00:01, 1729.96it/s]warmup should be done:  29%|██▉       | 880/3000 [00:00<00:01, 1717.02it/s]warmup should be done:  35%|███▌      | 1054/3000 [00:00<00:01, 1758.21it/s]warmup should be done:  35%|███▌      | 1061/3000 [00:00<00:01, 1761.99it/s]warmup should be done:  35%|███▍      | 1045/3000 [00:00<00:01, 1723.01it/s]warmup should be done:  35%|███▌      | 1055/3000 [00:00<00:01, 1725.30it/s]warmup should be done:  41%|████      | 1231/3000 [00:00<00:01, 1760.06it/s]warmup should be done:  41%|████▏     | 1241/3000 [00:00<00:00, 1771.16it/s]warmup should be done:  41%|████      | 1218/3000 [00:00<00:01, 1715.09it/s]warmup should be done:  41%|████      | 1230/3000 [00:00<00:01, 1733.20it/s]warmup should be done:  47%|████▋     | 1409/3000 [00:00<00:00, 1764.23it/s]warmup should be done:  47%|████▋     | 1421/3000 [00:00<00:00, 1779.13it/s]warmup should be done:  46%|████▋     | 1390/3000 [00:00<00:00, 1713.23it/s]warmup should be done:  47%|████▋     | 1404/3000 [00:00<00:00, 1697.76it/s]warmup should be done:  53%|█████▎    | 1601/3000 [00:00<00:00, 1785.29it/s]warmup should be done:  52%|█████▏    | 1562/3000 [00:00<00:00, 1711.13it/s]warmup should be done:  53%|█████▎    | 1586/3000 [00:00<00:00, 1720.31it/s]warmup should be done:  53%|█████▎    | 1581/3000 [00:00<00:00, 1718.91it/s]warmup should be done:  59%|█████▉    | 1781/3000 [00:01<00:00, 1789.77it/s]warmup should be done:  59%|█████▊    | 1759/3000 [00:01<00:00, 1706.81it/s]warmup should be done:  59%|█████▊    | 1759/3000 [00:01<00:00, 1735.02it/s]warmup should be done:  58%|█████▊    | 1734/3000 [00:01<00:00, 1619.00it/s]warmup should be done:  65%|██████▌   | 1961/3000 [00:01<00:00, 1791.55it/s]warmup should be done:  64%|██████▍   | 1930/3000 [00:01<00:00, 1698.43it/s]warmup should be done:  65%|██████▍   | 1936/3000 [00:01<00:00, 1745.18it/s]warmup should be done:  64%|██████▍   | 1913/3000 [00:01<00:00, 1667.36it/s]warmup should be done:  71%|███████▏  | 2141/3000 [00:01<00:00, 1773.36it/s]warmup should be done:  70%|███████   | 2101/3000 [00:01<00:00, 1701.36it/s]warmup should be done:  70%|███████   | 2114/3000 [00:01<00:00, 1754.79it/s]warmup should be done:  70%|██████▉   | 2092/3000 [00:01<00:00, 1703.15it/s]warmup should be done:  77%|███████▋  | 2321/3000 [00:01<00:00, 1779.37it/s]warmup should be done:  76%|███████▌  | 2273/3000 [00:01<00:00, 1704.18it/s]warmup should be done:  76%|███████▋  | 2293/3000 [00:01<00:00, 1764.25it/s]warmup should be done:  76%|███████▌  | 2271/3000 [00:01<00:00, 1728.05it/s]warmup should be done:  83%|████████▎ | 2501/3000 [00:01<00:00, 1784.79it/s]warmup should be done:  82%|████████▏ | 2445/3000 [00:01<00:00, 1707.59it/s]warmup should be done:  82%|████████▏ | 2472/3000 [00:01<00:00, 1771.10it/s]warmup should be done:  82%|████████▏ | 2451/3000 [00:01<00:00, 1747.17it/s]warmup should be done:  89%|████████▉ | 2681/3000 [00:01<00:00, 1787.75it/s]warmup should be done:  87%|████████▋ | 2617/3000 [00:01<00:00, 1709.69it/s]warmup should be done:  88%|████████▊ | 2652/3000 [00:01<00:00, 1777.49it/s]warmup should be done:  88%|████████▊ | 2629/3000 [00:01<00:00, 1755.15it/s]warmup should be done:  95%|█████████▌| 2862/3000 [00:01<00:00, 1792.36it/s]warmup should be done:  93%|█████████▎| 2792/3000 [00:01<00:00, 1720.15it/s]warmup should be done:  94%|█████████▍| 2832/3000 [00:01<00:00, 1782.29it/s]warmup should be done:  94%|█████████▎| 2808/3000 [00:01<00:00, 1763.32it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1778.87it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1747.11it/s]warmup should be done:  99%|█████████▉| 2969/3000 [00:01<00:00, 1732.79it/s]warmup should be done: 100%|█████████▉| 2988/3000 [00:01<00:00, 1771.90it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1728.37it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1727.35it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1805.80it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1834.08it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1757.85it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1776.27it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1805.75it/s]warmup should be done:  12%|█▏        | 361/3000 [00:00<00:01, 1810.04it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1811.21it/s]warmup should be done:  12%|█▏        | 368/3000 [00:00<00:01, 1824.81it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1807.37it/s]warmup should be done:  18%|█▊        | 546/3000 [00:00<00:01, 1823.57it/s]warmup should be done:  18%|█▊        | 546/3000 [00:00<00:01, 1825.79it/s]warmup should be done:  18%|█▊        | 551/3000 [00:00<00:01, 1762.18it/s]warmup should be done:  24%|██▍       | 730/3000 [00:00<00:01, 1830.69it/s]warmup should be done:  24%|██▍       | 731/3000 [00:00<00:01, 1830.30it/s]warmup should be done:  24%|██▍       | 724/3000 [00:00<00:01, 1799.83it/s]warmup should be done:  24%|██▍       | 733/3000 [00:00<00:01, 1782.72it/s]warmup should be done:  30%|███       | 915/3000 [00:00<00:01, 1836.44it/s]warmup should be done:  30%|███       | 915/3000 [00:00<00:01, 1832.14it/s]warmup should be done:  30%|███       | 904/3000 [00:00<00:01, 1798.88it/s]warmup should be done:  31%|███       | 916/3000 [00:00<00:01, 1796.31it/s]warmup should be done:  37%|███▋      | 1101/3000 [00:00<00:01, 1842.02it/s]warmup should be done:  37%|███▋      | 1100/3000 [00:00<00:01, 1836.48it/s]warmup should be done:  36%|███▌      | 1084/3000 [00:00<00:01, 1793.82it/s]warmup should be done:  37%|███▋      | 1099/3000 [00:00<00:01, 1804.31it/s]warmup should be done:  43%|████▎     | 1286/3000 [00:00<00:00, 1841.48it/s]warmup should be done:  43%|████▎     | 1284/3000 [00:00<00:00, 1833.30it/s]warmup should be done:  42%|████▏     | 1264/3000 [00:00<00:00, 1792.91it/s]warmup should be done:  43%|████▎     | 1280/3000 [00:00<00:00, 1803.45it/s]warmup should be done:  49%|████▉     | 1472/3000 [00:00<00:00, 1844.26it/s]warmup should be done:  49%|████▉     | 1470/3000 [00:00<00:00, 1840.48it/s]warmup should be done:  48%|████▊     | 1445/3000 [00:00<00:00, 1796.14it/s]warmup should be done:  49%|████▊     | 1462/3000 [00:00<00:00, 1808.16it/s]warmup should be done:  55%|█████▌    | 1658/3000 [00:00<00:00, 1847.52it/s]warmup should be done:  55%|█████▌    | 1656/3000 [00:00<00:00, 1844.48it/s]warmup should be done:  54%|█████▍    | 1625/3000 [00:00<00:00, 1773.13it/s]warmup should be done:  55%|█████▍    | 1645/3000 [00:00<00:00, 1812.73it/s]warmup should be done:  61%|██████▏   | 1843/3000 [00:01<00:00, 1845.18it/s]warmup should be done:  61%|██████▏   | 1841/3000 [00:01<00:00, 1844.34it/s]warmup should be done:  60%|██████    | 1803/3000 [00:01<00:00, 1772.00it/s]warmup should be done:  61%|██████    | 1829/3000 [00:01<00:00, 1819.23it/s]warmup should be done:  68%|██████▊   | 2026/3000 [00:01<00:00, 1839.24it/s]warmup should be done:  68%|██████▊   | 2028/3000 [00:01<00:00, 1833.76it/s]warmup should be done:  66%|██████▌   | 1984/3000 [00:01<00:00, 1781.63it/s]warmup should be done:  67%|██████▋   | 2011/3000 [00:01<00:00, 1787.28it/s]warmup should be done:  74%|███████▎  | 2210/3000 [00:01<00:00, 1836.81it/s]warmup should be done:  74%|███████▎  | 2212/3000 [00:01<00:00, 1814.15it/s]warmup should be done:  72%|███████▏  | 2163/3000 [00:01<00:00, 1776.49it/s]warmup should be done:  73%|███████▎  | 2190/3000 [00:01<00:00, 1717.42it/s]warmup should be done:  80%|███████▉  | 2394/3000 [00:01<00:00, 1813.21it/s]warmup should be done:  80%|███████▉  | 2397/3000 [00:01<00:00, 1822.71it/s]warmup should be done:  78%|███████▊  | 2343/3000 [00:01<00:00, 1782.92it/s]warmup should be done:  79%|███████▉  | 2370/3000 [00:01<00:00, 1739.46it/s]warmup should be done:  86%|████████▌ | 2579/3000 [00:01<00:00, 1822.33it/s]warmup should be done:  84%|████████▍ | 2524/3000 [00:01<00:00, 1788.74it/s]warmup should be done:  86%|████████▌ | 2580/3000 [00:01<00:00, 1803.82it/s]warmup should be done:  85%|████████▍ | 2549/3000 [00:01<00:00, 1753.92it/s]warmup should be done:  90%|█████████ | 2704/3000 [00:01<00:00, 1791.93it/s]warmup should be done:  92%|█████████▏| 2762/3000 [00:01<00:00, 1818.38it/s]warmup should be done:  92%|█████████▏| 2761/3000 [00:01<00:00, 1794.29it/s]warmup should be done:  91%|█████████ | 2725/3000 [00:01<00:00, 1753.50it/s]warmup should be done:  98%|█████████▊| 2947/3000 [00:01<00:00, 1826.95it/s]warmup should be done:  96%|█████████▌| 2885/3000 [00:01<00:00, 1795.02it/s]warmup should be done:  98%|█████████▊| 2943/3000 [00:01<00:00, 1799.20it/s]warmup should be done:  97%|█████████▋| 2903/3000 [00:01<00:00, 1758.86it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1827.00it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1818.59it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1790.70it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1776.62it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f7ba02fe190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f7ba02ff040>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f7ba02fe220>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f7ba02ff160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 23:08:37.571203: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f777da67950 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:08:37.571267: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:08:37.579060: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:08:38.366558: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:08:39.267943: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f7771a64be0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:08:39.267993: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:08:39.274794: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:08:39.312943: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f777d266780 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:08:39.313000: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:08:39.322196: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:08:39.383665: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f7771a6ec10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 23:08:39.383727: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 23:08:39.390944: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 23:08:40.032761: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:08:40.071410: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:08:40.095135: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 23:08:43.891160: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:08:45.371700: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:08:45.472205: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 23:08:46.181819: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][23:09:42.585][ERROR][RK0][tid #140151586006784]: replica 3 reaches 1000, calling init pre replica
[HCTR][23:09:42.585][ERROR][RK0][tid #140151586006784]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:09:42.590][ERROR][RK0][tid #140151586006784]: coll ps creation done
[HCTR][23:09:42.590][ERROR][RK0][tid #140151586006784]: replica 3 waits for coll ps creation barrier
[HCTR][23:09:42.823][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][23:09:42.823][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:09:42.826][ERROR][RK0][main]: coll ps creation done
[HCTR][23:09:42.826][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][23:09:42.985][ERROR][RK0][tid #140151577614080]: replica 2 reaches 1000, calling init pre replica
[HCTR][23:09:42.985][ERROR][RK0][tid #140151577614080]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:09:42.989][ERROR][RK0][tid #140151577614080]: coll ps creation done
[HCTR][23:09:42.989][ERROR][RK0][tid #140151577614080]: replica 2 waits for coll ps creation barrier
[HCTR][23:09:43.101][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][23:09:43.101][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][23:09:43.105][ERROR][RK0][main]: coll ps creation done
[HCTR][23:09:43.105][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][23:09:43.105][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][23:09:44.526][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][23:09:44.564][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][23:09:44.564][ERROR][RK0][tid #140151577614080]: replica 2 calling init per replica
[HCTR][23:09:44.564][ERROR][RK0][tid #140151586006784]: replica 3 calling init per replica
[HCTR][23:09:44.564][ERROR][RK0][main]: Calling build_v2
[HCTR][23:09:44.564][ERROR][RK0][tid #140151577614080]: Calling build_v2
[HCTR][23:09:44.564][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:09:44.564][ERROR][RK0][tid #140151577614080]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:09:44.564][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][23:09:44.564][ERROR][RK0][tid #140151586006784]: Calling build_v2
[HCTR][23:09:44.564][ERROR][RK0][tid #140151586006784]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][23:09:44.564][ERROR][RK0][main]: Calling build_v2
[HCTR][23:09:44.564][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[2022-12-11 23:09:44.564955: [2022-12-11 23:09:44E. 564955/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc2022-12-11 23:09:44: :.E136564993 ] : /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccusing concurrent impl MPSPhaseE:
 [136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] :using concurrent impl MPSPhase2022-12-11 23:09:44136
.] 565037using concurrent impl MPSPhase: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[2022-12-11 23:09:44.566112: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[[2022-12-11 23:09:442022-12-11 23:09:44..566163566163: [: E2022-12-11 23:09:44E . /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc566186/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:: :2022-12-11 23:09:44212E196.]  ] 566208build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpu: 
:
E196 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpu[:
2022-12-11 23:09:44196.] 566269assigning 8 to cpu: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[[2022-12-11 23:09:442022-12-11 23:09:44..566329566326[: : 2022-12-11 23:09:44EE.  566334/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: ::E214212 ] ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30build symm link desc with 4X Tesla V100-SXM2-16GB out of 4:

[2122022-12-11 23:09:44] .[566389build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 23:09:44: 
.E566416 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE[: 2022-12-11 23:09:44212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.] :566444build symm link desc with 4X Tesla V100-SXM2-16GB out of 4213: 
] remote time is 8.68421E
[ 2022-12-11 23:09:44/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.[:5665032022-12-11 23:09:44213: .] E566515remote time is 8.68421 : 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: 213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] [:remote time is 8.684212022-12-11 23:09:44214
.] 566560cpu time is 30[: 
2022-12-11 23:09:44E. 566586/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E214 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30:
214] cpu time is 30
[2022-12-11 23:10:10.648544: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 23:10:10.703819: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 23:10:10.703916: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 23:10:10.704986: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 23:10:10.844294: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 23:10:11.236642: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 23:10:11.236737: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 23:10:19.216363: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1022
[2022-12-11 23:10:19.216479: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 23:10:20.936572: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 23:10:20.936671: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1022
[2022-12-11 23:10:20.963941: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 23:10:20.964026: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1022 blocks, 4 devices
[2022-12-11 23:10:20.989808: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 23:10:21.  2277: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 23:10:21.  3100: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 23:10:21. 13301: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 23:10:21.110816: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 23:10:21.113460: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 23:10:21.115974: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 23:10:21.118391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 23:10:21.120810: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 23:10:24.613125: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 23:10:24.617298: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 23:10:24.617455: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 23:10:24.626270: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 23:10:24.626338: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 23:10:24.626372: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 23:10:24.626403: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 23:10:24.627095: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:10:24.627140: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:10:24.627989: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:10:24.628538: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:10:24.648257: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 23:10:24.648370: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 23:10:24.648396: E[ /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:2022-12-11 23:10:24202.] 6484313 solved: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:[2022022-12-11 23:10:24] .2 solved648498
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc[:2022-12-11 23:10:24205.] 648521worker 0 thread 3 initing device 3: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 23:10:24.649052: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:10:24.649106: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:10:24.649274: E[ 2022-12-11 23:10:24/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:6492871815: ] EBuilding Coll Cache with ... num gpu device is 4 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 23:10:24.649334: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-11 23:10:241980.] 649348eager alloc mem 381.47 MB: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:10:24.650907: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-11 23:10:24
.650934: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 23:10:24eager alloc mem 381.47 MB.
650971: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:10:24.652418: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:10:24.652446: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-11 23:10:24
.652469: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 23:10:24.727140: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1022.00 Bytes
[2022-12-11 23:10:24.729286: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1022
[2022-12-11 23:10:24.729350: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 23:10:24.730474: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 23:10:24.731370: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:10:24.732390: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:10:24.732446: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.49 MB
[[[2022-12-11 23:10:242022-12-11 23:10:242022-12-11 23:10:24...742573742573742572: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 1022.00 Byteseager alloc mem 1022.00 Byteseager alloc mem 1022.00 Bytes


[[[2022-12-11 23:10:242022-12-11 23:10:242022-12-11 23:10:24...744464744464744467: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:::638638638] ] ] eager release cuda mem 1022eager release cuda mem 1022eager release cuda mem 1022


[[[2022-12-11 23:10:242022-12-11 23:10:242022-12-11 23:10:24...744560744561744561: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:::638638638] ] ] eager release cuda mem 400000000eager release cuda mem 400000000eager release cuda mem 400000000


[2022-12-11 23:10:24.745499: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 23:10:24.745980: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 23:10:24.746477: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 23:10:24.747023: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:10:24.747078: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:10:24.747107: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:10:24.747949: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:10:24.747992: W [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc2022-12-11 23:10:24:.43748002] : WORKER[0] alloc host memory 30.51 MBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-11 23:10:24
.748035: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638[] 2022-12-11 23:10:24eager release cuda mem 625663.
748061: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.51 MB[
2022-12-11 23:10:24.748100: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.50 MB
[2022-12-11 23:10:24.751698: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:10:24.752281: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:10:24.752324: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[2022-12-11 23:10:24.785586[: 2022-12-11 23:10:24E. 785606/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1980 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 25.25 KB:
1980] eager alloc mem 25.25 KB
[2022-12-11 23:10:24.786050: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 23:10:24.786184: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:[6382022-12-11 23:10:24] .eager release cuda mem 25855786202
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855[
2022-12-11 23:10:24.786236: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-11 23:10:24] .eager alloc mem 3.82 GB786255
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[2022-12-11 23:10:24.786627: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 23:10:24.786672: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[[[[2022-12-11 23:10:252022-12-11 23:10:252022-12-11 23:10:252022-12-11 23:10:25....134459134462134454134453: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 1 init p2p of link 2Device 2 init p2p of link 3Device 0 init p2p of link 1



[[2022-12-11 23:10:252022-12-11 23:10:25[..2022-12-11 23:10:25134788134788.: : 134797EE:   E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu19801980:] ] 1980eager alloc mem 611.00 KBeager alloc mem 611.00 KB] 

eager alloc mem 611.00 KB
[2022-12-11 23:10:25.134997: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:10:25[.2022-12-11 23:10:25[135635.2022-12-11 23:10:25: 135641.E: 135645 E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc E:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc 638:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] 638:eager release cuda mem 625663] 638
eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-11 23:10:25.135802: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:10:25.140335: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] [Device 1 init p2p of link 32022-12-11 23:10:25
.140364: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 23:10:25.140453: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[2022-12-11 23:10:25:2022-12-11 23:10:25.1980.140459] 140467: eager alloc mem 611.00 KB: E
E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261980] ] Device 0 init p2p of link 2eager alloc mem 611.00 KB

[2022-12-11 23:10:25.140664: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:10:25.140842: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 23:10:25.140961: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:10:25.141287: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:10:25.141342: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:10:25.141456: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:10:25.141760: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:10:25.146048: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 23:10:25.146130: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:10:25.146324: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 23:10:25.146424: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 23:10:25.146538: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 23:10:25:.1926146573] : Device 2 init p2p of link 1E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 23:10:25.146658: [E2022-12-11 23:10:25 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu146667:: 1980E]  eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-11 23:10:25.146915: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:10:25.147200: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 23:10:25.147459[: 2022-12-11 23:10:25E. 147469/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :E638 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 625663:
638] eager release cuda mem 625663
[2022-12-11 23:10:25.150728: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 23:10:25.151006: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7997275 / 100000000 nodes ( 8.00 %~8.00 %) | remote 22433747 / 100000000 nodes ( 22.43 %) | cpu 69568978 / 100000000 nodes ( 69.57 %) | 3.82 GB | 0.50168 secs 
[2022-12-11 23:10:25.151566: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 23:10:25.151783: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 23:10:25.151830: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7997522 / 100000000 nodes ( 8.00 %~8.00 %) | remote 22433500 / 100000000 nodes ( 22.43 %) | cpu 69568978 / 100000000 nodes ( 69.57 %) | 3.82 GB | 0.502493 secs 
[2022-12-11 23:10:25.151901: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 23:10:25.152071: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7996013 / 100000000 nodes ( 8.00 %~8.00 %) | remote 22435009 / 100000000 nodes ( 22.44 %) | cpu 69568978 / 100000000 nodes ( 69.57 %) | 3.82 GB | 0.502982 secs 
[2022-12-11 23:10:25.152302: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 7992185 / 100000000 nodes ( 7.99 %~8.00 %) | remote 22438837 / 100000000 nodes ( 22.44 %) | cpu 69568978 / 100000000 nodes ( 69.57 %) | 3.82 GB | 0.525167 secs 
[2022-12-11 23:10:25.152849: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 10.51 GB
[2022-12-11 23:10:26. 47365: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 10.76 GB
[2022-12-11 23:10:26. 47495: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 10.76 GB
[2022-12-11 23:10:26. 47753: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 10.76 GB
[2022-12-11 23:10:26.736399: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 11.01 GB
[2022-12-11 23:10:26.736532: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 11.01 GB
[2022-12-11 23:10:26.736947: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 11.01 GB
[2022-12-11 23:10:27.462880: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 11.25 GB
[2022-12-11 23:10:27.463035: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 11.25 GB
[2022-12-11 23:10:27.463485: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 11.25 GB
[2022-12-11 23:10:27.463757: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 11.25 GB
[2022-12-11 23:10:27.464049: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 11.25 GB
[2022-12-11 23:10:28.221851: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 11.44 GB
[2022-12-11 23:10:28.221997: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 11.44 GB
[HCTR][23:10:28.708][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][23:10:28.708][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][23:10:28.708][ERROR][RK0][tid #140151577614080]: replica 2 calling init per replica done, doing barrier
[HCTR][23:10:28.708][ERROR][RK0][tid #140151586006784]: replica 3 calling init per replica done, doing barrier
[HCTR][23:10:28.708][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][23:10:28.708][ERROR][RK0][tid #140151577614080]: replica 2 calling init per replica done, doing barrier done
[HCTR][23:10:28.708][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][23:10:28.708][ERROR][RK0][tid #140151586006784]: replica 3 calling init per replica done, doing barrier done
[HCTR][23:10:28.708][ERROR][RK0][tid #140151577614080]: init per replica done
[HCTR][23:10:28.708][ERROR][RK0][main]: init per replica done
[HCTR][23:10:28.708][ERROR][RK0][tid #140151586006784]: init per replica done
[HCTR][23:10:28.743][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f5d44238400
[HCTR][23:10:28.743][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f5d44558400
[HCTR][23:10:28.743][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f5d44b98400
[HCTR][23:10:28.743][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f5d44eb8400
[HCTR][23:10:28.743][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f5dba238400
[HCTR][23:10:28.743][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f5dba558400
[HCTR][23:10:28.743][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f5dbab98400
[HCTR][23:10:28.743][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f5dbaeb8400
[HCTR][23:10:28.745][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f5d8c238400
[HCTR][23:10:28.745][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f5d8c558400
[HCTR][23:10:28.745][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f5d8cb98400
[HCTR][23:10:28.745][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f5d8ceb8400
[HCTR][23:10:28.750][ERROR][RK0][main]: init per replica done
[HCTR][23:10:28.785][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f5d78320000
[HCTR][23:10:28.785][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f5d78640000
[HCTR][23:10:28.785][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f5d78c80000
[HCTR][23:10:28.785][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f5d78fa0000
