2022-12-11 22:19:09.475839: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:19:09.479567: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:19:09.498898: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:19:09.539318: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:19:10.436760: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:19:10.436840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:19:10.446592: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:19:10.446683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:19:10.447166: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:19:10.447193: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:19:10.447290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:19:10.447299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:19:10.449947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:19:10.460364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:19:10.464083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:19:10.464592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:19:10.486902: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:19:10.487140: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:19:10.489647: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 22:19:10.491895: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:19:10.492042: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:19:10.493586: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 22:19:10.495957: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:19:10.496076: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:19:10.497870: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 22:19:10.498385: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:19:10.498503: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:19:10.499412: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][22:19:11.749][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:19:11.754][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:19:11.786][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:19:11.794][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.49s/it]warmup run: 104it [00:01, 90.86it/s]warmup run: 1it [00:01,  1.70s/it]warmup run: 207it [00:01, 195.15it/s]warmup run: 108it [00:01, 83.31it/s]warmup run: 311it [00:01, 310.72it/s]warmup run: 216it [00:01, 182.34it/s]warmup run: 415it [00:01, 429.86it/s]warmup run: 323it [00:02, 292.72it/s]warmup run: 521it [00:01, 548.59it/s]warmup run: 424it [00:02, 400.61it/s]warmup run: 629it [00:02, 661.00it/s]warmup run: 525it [00:02, 508.43it/s]warmup run: 736it [00:02, 755.14it/s]warmup run: 627it [00:02, 610.97it/s]warmup run: 844it [00:02, 834.76it/s]warmup run: 730it [00:02, 703.19it/s]warmup run: 951it [00:02, 896.38it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 835it [00:02, 786.06it/s]warmup run: 1it [00:01,  1.46s/it]warmup run: 1057it [00:02, 940.85it/s]warmup run: 99it [00:01, 88.63it/s]warmup run: 938it [00:02, 846.95it/s]warmup run: 106it [00:01, 94.39it/s]warmup run: 1163it [00:02, 970.38it/s]warmup run: 204it [00:01, 197.80it/s]warmup run: 1041it [00:02, 894.98it/s]warmup run: 203it [00:01, 193.24it/s]warmup run: 1269it [00:02, 994.77it/s]warmup run: 311it [00:01, 319.35it/s]warmup run: 1146it [00:02, 937.12it/s]warmup run: 306it [00:01, 309.32it/s]warmup run: 1375it [00:02, 1011.52it/s]warmup run: 418it [00:01, 443.68it/s]warmup run: 1250it [00:02, 964.16it/s]warmup run: 408it [00:01, 426.91it/s]warmup run: 1483it [00:02, 1030.72it/s]warmup run: 525it [00:01, 563.60it/s]warmup run: 1353it [00:03, 981.65it/s]warmup run: 512it [00:01, 543.77it/s]warmup run: 1592it [00:02, 1045.65it/s]warmup run: 1456it [00:03, 992.09it/s]warmup run: 625it [00:02, 650.30it/s]warmup run: 615it [00:02, 647.40it/s]warmup run: 1701it [00:03, 1056.57it/s]warmup run: 1560it [00:03, 1005.57it/s]warmup run: 727it [00:02, 756.96it/s]warmup run: 724it [00:02, 723.44it/s]warmup run: 1811it [00:03, 1067.00it/s]warmup run: 1664it [00:03, 1015.31it/s]warmup run: 835it [00:02, 837.16it/s]warmup run: 824it [00:02, 791.31it/s]warmup run: 1919it [00:03, 1066.96it/s]warmup run: 1768it [00:03, 1016.81it/s]warmup run: 926it [00:02, 850.56it/s]warmup run: 940it [00:02, 858.55it/s]warmup run: 2029it [00:03, 1076.54it/s]warmup run: 1871it [00:03, 998.92it/s] warmup run: 1026it [00:02, 870.71it/s]warmup run: 1042it [00:02, 900.00it/s]warmup run: 2164it [00:03, 1157.51it/s]warmup run: 1972it [00:03, 998.96it/s]warmup run: 1123it [00:02, 888.99it/s]warmup run: 1145it [00:02, 935.23it/s]warmup run: 2299it [00:03, 1214.69it/s]warmup run: 2095it [00:03, 1065.99it/s]warmup run: 1219it [00:02, 906.68it/s]warmup run: 1255it [00:02, 979.02it/s]warmup run: 2435it [00:03, 1256.06it/s]warmup run: 2226it [00:03, 1136.71it/s]warmup run: 1320it [00:02, 934.62it/s]warmup run: 1367it [00:02, 1018.38it/s]warmup run: 2561it [00:03, 1253.50it/s]warmup run: 2348it [00:03, 1159.48it/s]warmup run: 1428it [00:02, 974.92it/s]warmup run: 1476it [00:02, 1038.91it/s]warmup run: 2697it [00:03, 1282.99it/s]warmup run: 2470it [00:04, 1176.46it/s]warmup run: 1529it [00:02, 984.94it/s]warmup run: 1583it [00:02, 1016.30it/s]warmup run: 2830it [00:04, 1296.01it/s]warmup run: 2597it [00:04, 1202.26it/s]warmup run: 1644it [00:03, 1033.27it/s]warmup run: 1689it [00:03, 1027.38it/s]warmup run: 2966it [00:04, 1313.01it/s]warmup run: 2735it [00:04, 1253.56it/s]warmup run: 1758it [00:03, 1063.78it/s]warmup run: 3000it [00:04, 725.40it/s] warmup run: 1803it [00:03, 1058.15it/s]warmup run: 2871it [00:04, 1283.20it/s]warmup run: 1869it [00:03, 1075.61it/s]warmup run: 1915it [00:03, 1073.83it/s]warmup run: 3000it [00:04, 677.74it/s] warmup run: 1980it [00:03, 1083.26it/s]warmup run: 2024it [00:03, 1075.96it/s]warmup run: 2096it [00:03, 1104.01it/s]warmup run: 2157it [00:03, 1150.70it/s]warmup run: 2231it [00:03, 1176.68it/s]warmup run: 2291it [00:03, 1204.49it/s]warmup run: 2367it [00:03, 1230.64it/s]warmup run: 2424it [00:03, 1241.66it/s]warmup run: 2498it [00:03, 1252.64it/s]warmup run: 2558it [00:03, 1268.32it/s]warmup run: 2629it [00:03, 1267.85it/s]warmup run: 2686it [00:03, 1227.15it/s]warmup run: 2760it [00:03, 1278.77it/s]warmup run: 2810it [00:04, 1185.06it/s]warmup run: 2893it [00:04, 1292.51it/s]warmup run: 2945it [00:04, 1231.57it/s]warmup run: 3000it [00:04, 719.71it/s] warmup run: 3000it [00:04, 719.91it/s] 

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1757.08it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1764.90it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1775.93it/s]warmup should be done:   6%|▌         | 173/3000 [00:00<00:01, 1728.86it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1784.44it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1799.83it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1779.47it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1798.25it/s]warmup should be done:  18%|█▊        | 541/3000 [00:00<00:01, 1801.41it/s]warmup should be done:  18%|█▊        | 535/3000 [00:00<00:01, 1786.66it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1786.99it/s]warmup should be done:  18%|█▊        | 540/3000 [00:00<00:01, 1796.95it/s]warmup should be done:  24%|██▍       | 723/3000 [00:00<00:01, 1808.26it/s]warmup should be done:  24%|██▍       | 723/3000 [00:00<00:01, 1806.87it/s]warmup should be done:  24%|██▍       | 718/3000 [00:00<00:01, 1792.41it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1776.00it/s]warmup should be done:  30%|███       | 905/3000 [00:00<00:01, 1808.42it/s]warmup should be done:  30%|███       | 904/3000 [00:00<00:01, 1802.07it/s]warmup should be done:  30%|██▉       | 898/3000 [00:00<00:01, 1791.35it/s]warmup should be done:  30%|██▉       | 892/3000 [00:00<00:01, 1745.26it/s]warmup should be done:  36%|███▌      | 1086/3000 [00:00<00:01, 1806.58it/s]warmup should be done:  36%|███▌      | 1085/3000 [00:00<00:01, 1796.58it/s]warmup should be done:  36%|███▌      | 1078/3000 [00:00<00:01, 1786.29it/s]warmup should be done:  36%|███▌      | 1067/3000 [00:00<00:01, 1645.51it/s]warmup should be done:  42%|████▏     | 1267/3000 [00:00<00:00, 1805.56it/s]warmup should be done:  42%|████▏     | 1257/3000 [00:00<00:00, 1785.55it/s]warmup should be done:  42%|████▏     | 1265/3000 [00:00<00:00, 1790.05it/s]warmup should be done:  42%|████▏     | 1246/3000 [00:00<00:01, 1687.50it/s]warmup should be done:  48%|████▊     | 1449/3000 [00:00<00:00, 1807.06it/s]warmup should be done:  48%|████▊     | 1436/3000 [00:00<00:00, 1785.21it/s]warmup should be done:  48%|████▊     | 1446/3000 [00:00<00:00, 1793.81it/s]warmup should be done:  48%|████▊     | 1425/3000 [00:00<00:00, 1716.96it/s]warmup should be done:  54%|█████▍    | 1631/3000 [00:00<00:00, 1809.50it/s]warmup should be done:  54%|█████▍    | 1616/3000 [00:00<00:00, 1786.76it/s]warmup should be done:  54%|█████▍    | 1627/3000 [00:00<00:00, 1798.61it/s]warmup should be done:  54%|█████▎    | 1605/3000 [00:00<00:00, 1740.85it/s]warmup should be done:  60%|██████    | 1813/3000 [00:01<00:00, 1809.83it/s]warmup should be done:  60%|█████▉    | 1796/3000 [00:01<00:00, 1788.64it/s]warmup should be done:  60%|██████    | 1807/3000 [00:01<00:00, 1797.88it/s]warmup should be done:  60%|█████▉    | 1785/3000 [00:01<00:00, 1757.86it/s]warmup should be done:  66%|██████▌   | 1975/3000 [00:01<00:00, 1788.90it/s]warmup should be done:  66%|██████▋   | 1988/3000 [00:01<00:00, 1801.30it/s]warmup should be done:  66%|██████▋   | 1994/3000 [00:01<00:00, 1796.56it/s]warmup should be done:  65%|██████▌   | 1964/3000 [00:01<00:00, 1765.78it/s]warmup should be done:  72%|███████▏  | 2169/3000 [00:01<00:00, 1803.10it/s]warmup should be done:  72%|███████▏  | 2174/3000 [00:01<00:00, 1797.36it/s]warmup should be done:  72%|███████▏  | 2154/3000 [00:01<00:00, 1779.58it/s]warmup should be done:  71%|███████▏  | 2142/3000 [00:01<00:00, 1770.04it/s]warmup should be done:  78%|███████▊  | 2350/3000 [00:01<00:00, 1802.96it/s]warmup should be done:  78%|███████▊  | 2354/3000 [00:01<00:00, 1795.38it/s]warmup should be done:  78%|███████▊  | 2333/3000 [00:01<00:00, 1780.99it/s]warmup should be done:  77%|███████▋  | 2321/3000 [00:01<00:00, 1775.60it/s]warmup should be done:  84%|████████▍ | 2532/3000 [00:01<00:00, 1808.06it/s]warmup should be done:  84%|████████▍ | 2535/3000 [00:01<00:00, 1799.58it/s]warmup should be done:  84%|████████▎ | 2512/3000 [00:01<00:00, 1782.58it/s]warmup should be done:  83%|████████▎ | 2500/3000 [00:01<00:00, 1779.67it/s]warmup should be done:  90%|█████████ | 2713/3000 [00:01<00:00, 1805.04it/s]warmup should be done:  90%|████████▉ | 2691/3000 [00:01<00:00, 1780.13it/s]warmup should be done:  90%|█████████ | 2715/3000 [00:01<00:00, 1788.55it/s]warmup should be done:  89%|████████▉ | 2679/3000 [00:01<00:00, 1782.23it/s]warmup should be done:  97%|█████████▋| 2896/3000 [00:01<00:00, 1793.08it/s]warmup should be done:  96%|█████████▌| 2870/3000 [00:01<00:00, 1774.00it/s]warmup should be done:  96%|█████████▋| 2894/3000 [00:01<00:00, 1781.40it/s]warmup should be done:  95%|█████████▌| 2859/3000 [00:01<00:00, 1785.41it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1798.68it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1793.83it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1781.19it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1757.85it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 185/3000 [00:00<00:01, 1846.61it/s]warmup should be done:   6%|▌         | 185/3000 [00:00<00:01, 1845.85it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1736.78it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1676.29it/s]warmup should be done:  12%|█▏        | 370/3000 [00:00<00:01, 1846.43it/s]warmup should be done:  12%|█▏        | 370/3000 [00:00<00:01, 1844.95it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1806.39it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1753.17it/s]warmup should be done:  18%|█▊        | 555/3000 [00:00<00:01, 1846.64it/s]warmup should be done:  18%|█▊        | 555/3000 [00:00<00:01, 1846.35it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1765.30it/s]warmup should be done:  18%|█▊        | 546/3000 [00:00<00:01, 1829.06it/s]warmup should be done:  25%|██▍       | 740/3000 [00:00<00:01, 1846.18it/s]warmup should be done:  25%|██▍       | 740/3000 [00:00<00:01, 1846.11it/s]warmup should be done:  24%|██▎       | 708/3000 [00:00<00:01, 1780.94it/s]warmup should be done:  24%|██▍       | 732/3000 [00:00<00:01, 1838.10it/s]warmup should be done:  31%|███       | 925/3000 [00:00<00:01, 1847.19it/s]warmup should be done:  31%|███       | 926/3000 [00:00<00:01, 1847.98it/s]warmup should be done:  30%|██▉       | 890/3000 [00:00<00:01, 1791.40it/s]warmup should be done:  31%|███       | 919/3000 [00:00<00:01, 1846.49it/s]warmup should be done:  37%|███▋      | 1111/3000 [00:00<00:01, 1848.48it/s]warmup should be done:  37%|███▋      | 1111/3000 [00:00<00:01, 1847.64it/s]warmup should be done:  36%|███▌      | 1071/3000 [00:00<00:01, 1797.36it/s]warmup should be done:  37%|███▋      | 1105/3000 [00:00<00:01, 1849.80it/s]warmup should be done:  43%|████▎     | 1296/3000 [00:00<00:00, 1845.86it/s]warmup should be done:  43%|████▎     | 1296/3000 [00:00<00:00, 1844.83it/s]warmup should be done:  42%|████▏     | 1251/3000 [00:00<00:00, 1794.92it/s]warmup should be done:  43%|████▎     | 1290/3000 [00:00<00:00, 1846.68it/s]warmup should be done:  49%|████▉     | 1483/3000 [00:00<00:00, 1852.45it/s]warmup should be done:  48%|████▊     | 1433/3000 [00:00<00:00, 1801.20it/s]warmup should be done:  49%|████▉     | 1481/3000 [00:00<00:00, 1842.61it/s]warmup should be done:  49%|████▉     | 1476/3000 [00:00<00:00, 1849.57it/s]warmup should be done:  56%|█████▌    | 1670/3000 [00:00<00:00, 1855.72it/s]warmup should be done:  54%|█████▍    | 1615/3000 [00:00<00:00, 1806.32it/s]warmup should be done:  55%|█████▌    | 1662/3000 [00:00<00:00, 1851.57it/s]warmup should be done:  56%|█████▌    | 1666/3000 [00:00<00:00, 1839.59it/s]warmup should be done:  62%|██████▏   | 1856/3000 [00:01<00:00, 1855.42it/s]warmup should be done:  60%|█████▉    | 1797/3000 [00:01<00:00, 1808.25it/s]warmup should be done:  62%|██████▏   | 1849/3000 [00:01<00:00, 1855.08it/s]warmup should be done:  62%|██████▏   | 1850/3000 [00:01<00:00, 1823.94it/s]warmup should be done:  68%|██████▊   | 2042/3000 [00:01<00:00, 1853.52it/s]warmup should be done:  68%|██████▊   | 2036/3000 [00:01<00:00, 1856.84it/s]warmup should be done:  68%|██████▊   | 2034/3000 [00:01<00:00, 1826.63it/s]warmup should be done:  66%|██████▌   | 1978/3000 [00:01<00:00, 1783.01it/s]warmup should be done:  74%|███████▍  | 2224/3000 [00:01<00:00, 1863.03it/s]warmup should be done:  74%|███████▍  | 2228/3000 [00:01<00:00, 1850.49it/s]warmup should be done:  74%|███████▍  | 2218/3000 [00:01<00:00, 1829.87it/s]warmup should be done:  72%|███████▏  | 2157/3000 [00:01<00:00, 1778.33it/s]warmup should be done:  80%|████████  | 2411/3000 [00:01<00:00, 1861.18it/s]warmup should be done:  80%|████████  | 2414/3000 [00:01<00:00, 1849.53it/s]warmup should be done:  80%|████████  | 2402/3000 [00:01<00:00, 1830.45it/s]warmup should be done:  78%|███████▊  | 2335/3000 [00:01<00:00, 1774.13it/s]warmup should be done:  87%|████████▋ | 2599/3000 [00:01<00:00, 1865.65it/s]warmup should be done:  87%|████████▋ | 2599/3000 [00:01<00:00, 1849.27it/s]warmup should be done:  86%|████████▌ | 2586/3000 [00:01<00:00, 1819.23it/s]warmup should be done:  84%|████████▍ | 2513/3000 [00:01<00:00, 1767.56it/s]warmup should be done:  93%|█████████▎| 2786/3000 [00:01<00:00, 1865.05it/s]warmup should be done:  93%|█████████▎| 2785/3000 [00:01<00:00, 1849.91it/s]warmup should be done:  92%|█████████▏| 2768/3000 [00:01<00:00, 1806.90it/s]warmup should be done:  90%|████████▉ | 2690/3000 [00:01<00:00, 1763.85it/s]warmup should be done:  99%|█████████▉| 2974/3000 [00:01<00:00, 1868.42it/s]warmup should be done:  99%|█████████▉| 2970/3000 [00:01<00:00, 1812.82it/s]warmup should be done:  98%|█████████▊| 2949/3000 [00:01<00:00, 1807.70it/s]warmup should be done:  96%|█████████▌| 2867/3000 [00:01<00:00, 1755.30it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1852.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1841.93it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1828.14it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1775.29it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7febf96b2160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7febf96b2040>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7febf96b1190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7febf96b1280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 22:20:21.858478: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe7cda67770 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:20:21.858549: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:20:21.865694: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:20:22.871673: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:20:23.744221: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe7d126bd10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:20:23.744295: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:20:23.744510: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe7cd268740 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:20:23.744576: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:20:23.753427: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:20:23.755462: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fe7cda6a7c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:20:23.755507: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:20:23.757217: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:20:23.764142: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:20:24.491219: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:20:24.503436: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:20:24.515525: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:20:29.174239: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:20:30.000067: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:20:30.120776: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:20:30.125021: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][22:21:26.739][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][22:21:26.739][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:21:26.744][ERROR][RK0][main]: coll ps creation done
[HCTR][22:21:26.744][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][22:21:27.030][ERROR][RK0][tid #140634165847808]: replica 1 reaches 1000, calling init pre replica
[HCTR][22:21:27.030][ERROR][RK0][tid #140634165847808]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:21:27.034][ERROR][RK0][tid #140634165847808]: coll ps creation done
[HCTR][22:21:27.034][ERROR][RK0][tid #140634165847808]: replica 1 waits for coll ps creation barrier
[HCTR][22:21:27.040][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][22:21:27.040][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:21:27.043][ERROR][RK0][main]: coll ps creation done
[HCTR][22:21:27.043][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][22:21:27.066][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][22:21:27.066][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][22:21:27.069][ERROR][RK0][main]: coll ps creation done
[HCTR][22:21:27.069][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][22:21:27.069][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][22:21:28.003][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][22:21:28.033][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][22:21:28.033][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][22:21:28.033][ERROR][RK0][main]: Calling build_v2
[HCTR][22:21:28.033][ERROR][RK0][tid #140634165847808]: replica 1 calling init per replica
[HCTR][22:21:28.033][ERROR][RK0][main]: Calling build_v2
[HCTR][22:21:28.033][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:21:28.033][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][22:21:28.033][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:21:28.033][ERROR][RK0][tid #140634165847808]: Calling build_v2
[HCTR][22:21:28.033][ERROR][RK0][tid #140634165847808]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:21:28.033][ERROR][RK0][main]: Calling build_v2
[HCTR][22:21:28.033][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 22:21:28. 33923: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[2022-12-11 22:21:28. 33963: [[E2022-12-11 22:21:28 2022-12-11 22:21:28./hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc. 33997: 33997: 136: E] E using concurrent impl MPSPhase /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc
/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc::136136] ] using concurrent impl MPSPhaseusing concurrent impl MPSPhase

[2022-12-11 22:21:28. 34874: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 22:21:28. 34931: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 22:21:28. 34973: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 22:21:28. 35003: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 22:21:28. 35161: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-11 22:21:28. 35188: E[ 2022-12-11 22:21:28/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.: 35208196: ] Eassigning 8 to cpu 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 22:21:28196.]  35234assigning 8 to cpu: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 22:21:28. 35327: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 22:21:28:.213 35335] : remote time is 8.68421E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212[] 2022-12-11 22:21:28build symm link desc with 4X Tesla V100-SXM2-16GB out of 4.
 35391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214[] 2022-12-11 22:21:28cpu time is 30.
 35426[: 2022-12-11 22:21:28E.  35440/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E213 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421:
212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 22:21:28. 35498: E[ 2022-12-11 22:21:28/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.: 35510214: ] Ecpu time is 30 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 22:21:28. 35554: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 22:21:53.530923: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 22:21:53.597396: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 22:21:53.597506: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 22:21:53.598807: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 22:21:53.698687: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 22:21:54. 98336: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 22:21:54. 98425: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 22:22:01.199094: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 22:22:01.199207: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 22:22:03. 44112: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 22:22:03. 44208: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 22:22:03. 58287: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 22:22:03. 58355: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 22:22:03. 95125: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 22:22:03.107591: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 22:22:03.108429: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 22:22:03.118439: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 22:22:03.213062: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 22:22:03.215270: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 22:22:03.217722: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 22:22:03.220103: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 22:22:03.222457: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 22:22:06.238569: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 22:22:06.243314: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 22:22:06.243770: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 22:22:06.253730: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 22:22:06.253797: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 22:22:06.253830: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 22:22:06.253860: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 22:22:06.255496: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:22:06.255553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:22:06.256570: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:22:06.257129: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-11 22:22:06.2785052022-12-11 22:22:06: .E278515 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 202/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :1 solved202
] 3 solved
[2022-12-11 22:22:06.278618: E[ 2022-12-11 22:22:06/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc.:278628205: ] Eworker 0 thread 1 initing device 1 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 22:22:06.279799: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:22:06.279858: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:22:06.280514: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:22:06.280576: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:22:06.280703: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:22:06.281737: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:22:06.281809: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:22:06.282025: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 22:22:06.282111: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 22:22:06.282814: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:22:06.282975: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:22:06.283037: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:22:06.284046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:22:06.284622: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:22:06.340251: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 22:22:06.342143: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 22:22:06.342192: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:22:06.343019: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 22:22:06.343495: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:22:06.344431: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.344475: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.89 MB
[2022-12-11 22:22:06.356108: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:22:06.356728: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:22:06.356771: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.87 GB
[2022-12-11 22:22:06.365354: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 22:22:06.367182: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 22:22:06.367231: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:22:06.367962: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 22:22:06.368360: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:22:06.369289: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.369332: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.89 MB
[2022-12-11 22:22:06.382330: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:22:06.382903: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:22:06.382945: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.87 GB
[[2022-12-11 22:22:062022-12-11 22:22:06..383323383323: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-11 22:22:06.385168: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 22:22:06.385213: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:22:06.385584: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 22:22:06.385632: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:22:06.387134: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 22:22:06.387617: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 22:22:06.388394: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:22:06.388570: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:22:06.389352: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.389395: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.89 MB
[2022-12-11 22:22:06.389499: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.389541: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.89 MB
[2022-12-11 22:22:06.401347: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:22:06.401914: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:22:06.401956: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.87 GB
[2022-12-11 22:22:06.403590: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:22:06.404165: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:22:06.404205: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.87 GB
[[[[2022-12-11 22:22:062022-12-11 22:22:062022-12-11 22:22:062022-12-11 22:22:06....659446659445659449659449: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 1 init p2p of link 2Device 0 init p2p of link 1Device 2 init p2p of link 3



[2022-12-11 22:22:06.659762[: [2022-12-11 22:22:06[E2022-12-11 22:22:06.2022-12-11 22:22:06 .659771./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu659773: 659773:: E: 1980E E]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980:1980] 1980] eager alloc mem 611.00 KB] eager alloc mem 611.00 KB
eager alloc mem 611.00 KB

[2022-12-11 22:22:06.660681: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.660724: E[ 2022-12-11 22:22:06[/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.2022-12-11 22:22:06:660734.638: 660741] E: eager release cuda mem 625663 E
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-11 22:22:06.664511: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 22:22:06.664605: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:22:06.664731: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 22:22:06.664829: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:22:06.664918: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 22:22:06.665021: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:22:06.665149: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 22:22:06.665257: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:22:06.665403: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.665620: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.665816: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.666069: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.668648: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 22:22:06.668727: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:22:06.669531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.669636: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 22:22:06.669722: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:22:06.669793: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 22:22:06.669881: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:22:06.669931: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 22:22:06.670031: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:22:06.670519: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.670694: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.670824: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:22:06.672374: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 22:22:06.672619: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5999527 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17398943 / 100000000 nodes ( 17.40 %) | cpu 76601530 / 100000000 nodes ( 76.60 %) | 2.87 GB | 0.39206 secs 
[2022-12-11 22:22:06.673997: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 22:22:06.674161: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 22:22:06.674193: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 22:22:06.674292: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5999606 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17398864 / 100000000 nodes ( 17.40 %) | cpu 76601530 / 100000000 nodes ( 76.60 %) | 2.87 GB | 0.391275 secs 
[2022-12-11 22:22:06.674584: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5999713 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17398757 / 100000000 nodes ( 17.40 %) | cpu 76601530 / 100000000 nodes ( 76.60 %) | 2.87 GB | 0.394745 secs 
[2022-12-11 22:22:06.674638: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 5999624 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17398846 / 100000000 nodes ( 17.40 %) | cpu 76601530 / 100000000 nodes ( 76.60 %) | 2.87 GB | 0.419094 secs 
[2022-12-11 22:22:06.674998: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 9.57 GB
[2022-12-11 22:22:07.615748: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 9.81 GB
[2022-12-11 22:22:07.615919: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 9.81 GB
[2022-12-11 22:22:07.616323: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 9.81 GB
[2022-12-11 22:22:08.404423: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 10.06 GB
[2022-12-11 22:22:08.404552: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 10.06 GB
[2022-12-11 22:22:08.405058: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 10.06 GB
[2022-12-11 22:22:09.426250: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 10.30 GB
[2022-12-11 22:22:09.427225: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 10.30 GB
[2022-12-11 22:22:09.427742: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 10.30 GB
[2022-12-11 22:22:09.429757: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 10.30 GB
[2022-12-11 22:22:09.430670: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 10.30 GB
[2022-12-11 22:22:10. 94045: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 10.49 GB
[2022-12-11 22:22:10. 94166: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 10.49 GB
[HCTR][22:22:10.227][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][22:22:10.227][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][22:22:10.227][ERROR][RK0][tid #140634165847808]: replica 1 calling init per replica done, doing barrier
[HCTR][22:22:10.227][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][22:22:10.228][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][22:22:10.228][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][22:22:10.228][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][22:22:10.228][ERROR][RK0][tid #140634165847808]: replica 1 calling init per replica done, doing barrier done
[HCTR][22:22:10.228][ERROR][RK0][main]: init per replica done
[HCTR][22:22:10.228][ERROR][RK0][main]: init per replica done
[HCTR][22:22:10.228][ERROR][RK0][tid #140634165847808]: init per replica done
[HCTR][22:22:10.231][ERROR][RK0][main]: init per replica done
[HCTR][22:22:10.263][ERROR][RK0][main]: 2 allocated 3276800 at 0x7fcd50238400
[HCTR][22:22:10.263][ERROR][RK0][main]: 2 allocated 6553600 at 0x7fcd50558400
[HCTR][22:22:10.263][ERROR][RK0][main]: 2 allocated 3276800 at 0x7fcd50b98400
[HCTR][22:22:10.263][ERROR][RK0][main]: 2 allocated 6553600 at 0x7fcd50eb8400
[HCTR][22:22:10.263][ERROR][RK0][tid #140634040022784]: 3 allocated 3276800 at 0x7fcd9c238400
[HCTR][22:22:10.263][ERROR][RK0][tid #140634040022784]: 3 allocated 6553600 at 0x7fcd9c558400
[HCTR][22:22:10.263][ERROR][RK0][tid #140634040022784]: 3 allocated 3276800 at 0x7fcd9cb98400
[HCTR][22:22:10.263][ERROR][RK0][tid #140634040022784]: 3 allocated 6553600 at 0x7fcd9ceb8400
[HCTR][22:22:10.263][ERROR][RK0][main]: 1 allocated 3276800 at 0x7fcdf0238400
[HCTR][22:22:10.263][ERROR][RK0][main]: 1 allocated 6553600 at 0x7fcdf0558400
[HCTR][22:22:10.263][ERROR][RK0][main]: 1 allocated 3276800 at 0x7fcdf0b98400
[HCTR][22:22:10.263][ERROR][RK0][main]: 1 allocated 6553600 at 0x7fcdf0eb8400
[HCTR][22:22:10.268][ERROR][RK0][tid #140634031630080]: 0 allocated 3276800 at 0x7fcdc0320000
[HCTR][22:22:10.268][ERROR][RK0][tid #140634031630080]: 0 allocated 6553600 at 0x7fcdc0640000
[HCTR][22:22:10.268][ERROR][RK0][tid #140634031630080]: 0 allocated 3276800 at 0x7fcdc0c80000
[HCTR][22:22:10.268][ERROR][RK0][tid #140634031630080]: 0 allocated 6553600 at 0x7fcdc0fa0000
