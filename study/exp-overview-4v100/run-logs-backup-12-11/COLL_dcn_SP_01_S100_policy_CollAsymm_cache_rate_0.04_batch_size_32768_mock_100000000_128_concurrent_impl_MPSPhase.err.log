2022-12-11 21:30:06.969804: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:30:07.043082: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:30:07.053288: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:30:07.053707: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:30:07.861822: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:30:07.861901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:30:07.875305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:30:07.909807: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:30:07.909982: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:30:07.911386: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 21:30:07.925994: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:30:07.926057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:30:07.939180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:30:07.943547: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:30:07.943615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:30:07.949325: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:30:07.949405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:30:07.957705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:30:07.964054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:30:07.969956: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:30:07.970097: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:30:07.971446: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 21:30:07.987597: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:30:07.987757: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:30:07.989119: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 21:30:07.995710: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:30:07.995852: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:30:07.997091: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][21:30:09.201][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:30:09.215][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:30:09.257][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:30:09.257][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 1it [00:01,  1.51s/it]warmup run: 108it [00:01, 96.56it/s]warmup run: 98it [00:01, 84.24it/s]warmup run: 210it [00:01, 201.33it/s]warmup run: 193it [00:01, 179.05it/s]warmup run: 310it [00:01, 312.38it/s]warmup run: 279it [00:01, 271.12it/s]warmup run: 419it [00:01, 441.37it/s]warmup run: 380it [00:01, 390.31it/s]warmup run: 529it [00:01, 566.77it/s]warmup run: 487it [00:02, 517.17it/s]warmup run: 633it [00:02, 667.90it/s]warmup run: 590it [00:02, 624.99it/s]warmup run: 736it [00:02, 749.97it/s]warmup run: 0it [00:00, ?it/s]warmup run: 691it [00:02, 713.61it/s]warmup run: 845it [00:02, 834.38it/s]warmup run: 801it [00:02, 808.79it/s]warmup run: 951it [00:02, 892.00it/s]warmup run: 909it [00:02, 877.82it/s]warmup run: 1056it [00:02, 934.32it/s]warmup run: 1021it [00:02, 942.05it/s]warmup run: 1162it [00:02, 967.82it/s]warmup run: 1129it [00:02, 978.74it/s]warmup run: 1269it [00:02, 994.67it/s]warmup run: 1it [00:01,  1.49s/it]warmup run: 1240it [00:02, 1014.55it/s]warmup run: 1378it [00:02, 1022.10it/s]warmup run: 109it [00:01, 95.15it/s]warmup run: 1350it [00:02, 1037.44it/s]warmup run: 1485it [00:02, 1035.38it/s]warmup run: 218it [00:01, 205.64it/s]warmup run: 1459it [00:02, 1044.64it/s]warmup run: 1592it [00:02, 1044.74it/s]warmup run: 326it [00:01, 325.26it/s]warmup run: 1569it [00:03, 1058.78it/s]warmup run: 1700it [00:03, 1053.53it/s]warmup run: 425it [00:01, 433.62it/s]warmup run: 1677it [00:03, 1056.02it/s]warmup run: 1807it [00:03, 1046.82it/s]warmup run: 528it [00:01, 545.70it/s]warmup run: 1785it [00:03, 1056.80it/s]warmup run: 1916it [00:03, 1057.16it/s]warmup run: 634it [00:02, 654.50it/s]warmup run: 1892it [00:03, 1060.32it/s]warmup run: 2029it [00:03, 1077.06it/s]warmup run: 747it [00:02, 764.27it/s]warmup run: 1999it [00:03, 1060.01it/s]warmup run: 2152it [00:03, 1122.21it/s]warmup run: 858it [00:02, 849.28it/s]warmup run: 2134it [00:03, 1144.94it/s]warmup run: 2281it [00:03, 1171.21it/s]warmup run: 967it [00:02, 912.04it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 2271it [00:03, 1210.76it/s]warmup run: 2406it [00:03, 1192.90it/s]warmup run: 1074it [00:02, 951.13it/s]warmup run: 97it [00:01, 88.97it/s]warmup run: 2408it [00:03, 1256.94it/s]warmup run: 2540it [00:03, 1234.90it/s]warmup run: 1181it [00:02, 982.72it/s]warmup run: 196it [00:01, 193.52it/s]warmup run: 2546it [00:03, 1291.57it/s]warmup run: 2666it [00:03, 1241.59it/s]warmup run: 1288it [00:02, 1004.50it/s]warmup run: 295it [00:01, 306.69it/s]warmup run: 2680it [00:03, 1304.39it/s]warmup run: 2791it [00:03, 1232.20it/s]warmup run: 1395it [00:02, 1011.61it/s]warmup run: 395it [00:01, 423.19it/s]warmup run: 2811it [00:04, 1303.92it/s]warmup run: 2915it [00:04, 1207.33it/s]warmup run: 1503it [00:02, 1030.43it/s]warmup run: 496it [00:01, 536.67it/s]warmup run: 2944it [00:04, 1309.35it/s]warmup run: 3000it [00:04, 723.25it/s] warmup run: 3000it [00:04, 717.18it/s] warmup run: 595it [00:02, 634.96it/s]warmup run: 1609it [00:03, 1020.76it/s]warmup run: 695it [00:02, 721.30it/s]warmup run: 1718it [00:03, 1039.97it/s]warmup run: 795it [00:02, 791.58it/s]warmup run: 1827it [00:03, 1052.46it/s]warmup run: 896it [00:02, 848.93it/s]warmup run: 1937it [00:03, 1065.93it/s]warmup run: 996it [00:02, 888.84it/s]warmup run: 2045it [00:03, 1057.55it/s]warmup run: 1098it [00:02, 923.85it/s]warmup run: 2160it [00:03, 1083.44it/s]warmup run: 1198it [00:02, 929.19it/s]warmup run: 2297it [00:03, 1166.12it/s]warmup run: 1296it [00:02, 941.25it/s]warmup run: 2433it [00:03, 1223.28it/s]warmup run: 1394it [00:02, 947.68it/s]warmup run: 2570it [00:03, 1265.93it/s]warmup run: 1495it [00:02, 964.86it/s]warmup run: 2707it [00:03, 1295.58it/s]warmup run: 1597it [00:03, 979.74it/s]warmup run: 2844it [00:04, 1315.73it/s]warmup run: 1699it [00:03, 990.16it/s]warmup run: 2980it [00:04, 1328.42it/s]warmup run: 3000it [00:04, 725.12it/s] warmup run: 1799it [00:03, 992.68it/s]warmup run: 1899it [00:03, 957.14it/s]warmup run: 1996it [00:03, 936.63it/s]warmup run: 2129it [00:03, 1049.00it/s]warmup run: 2264it [00:03, 1135.01it/s]warmup run: 2400it [00:03, 1200.08it/s]warmup run: 2535it [00:03, 1243.41it/s]warmup run: 2671it [00:03, 1276.18it/s]warmup run: 2806it [00:04, 1296.09it/s]warmup run: 2939it [00:04, 1305.56it/s]warmup run: 3000it [00:04, 713.90it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1762.77it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1693.34it/s]warmup should be done:   5%|▌         | 155/3000 [00:00<00:01, 1547.67it/s]warmup should be done:   5%|▌         | 164/3000 [00:00<00:01, 1635.05it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1777.38it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1772.70it/s]warmup should be done:  11%|█         | 332/3000 [00:00<00:01, 1675.12it/s]warmup should be done:  11%|█▏        | 343/3000 [00:00<00:01, 1722.54it/s]warmup should be done:  18%|█▊        | 535/3000 [00:00<00:01, 1778.81it/s]warmup should be done:  18%|█▊        | 535/3000 [00:00<00:01, 1790.96it/s]warmup should be done:  17%|█▋        | 509/3000 [00:00<00:01, 1717.61it/s]warmup should be done:  17%|█▋        | 517/3000 [00:00<00:01, 1709.46it/s]warmup should be done:  23%|██▎       | 687/3000 [00:00<00:01, 1741.51it/s]warmup should be done:  24%|██▍       | 718/3000 [00:00<00:01, 1803.75it/s]warmup should be done:  23%|██▎       | 688/3000 [00:00<00:01, 1699.01it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1663.58it/s]warmup should be done:  29%|██▉       | 866/3000 [00:00<00:01, 1755.67it/s]warmup should be done:  30%|███       | 900/3000 [00:00<00:01, 1806.65it/s]warmup should be done:  29%|██▉       | 868/3000 [00:00<00:01, 1734.82it/s]warmup should be done:  29%|██▉       | 882/3000 [00:00<00:01, 1670.76it/s]warmup should be done:  36%|███▌      | 1081/3000 [00:00<00:01, 1807.73it/s]warmup should be done:  35%|███▍      | 1045/3000 [00:00<00:01, 1764.25it/s]warmup should be done:  35%|███▍      | 1044/3000 [00:00<00:01, 1741.31it/s]warmup should be done:  35%|███▌      | 1050/3000 [00:00<00:01, 1670.83it/s]warmup should be done:  42%|████▏     | 1263/3000 [00:00<00:00, 1810.28it/s]warmup should be done:  41%|████      | 1222/3000 [00:00<00:01, 1766.08it/s]warmup should be done:  41%|████      | 1219/3000 [00:00<00:01, 1698.58it/s]warmup should be done:  41%|████      | 1218/3000 [00:00<00:01, 1658.74it/s]warmup should be done:  47%|████▋     | 1399/3000 [00:00<00:00, 1756.37it/s]warmup should be done:  48%|████▊     | 1445/3000 [00:00<00:00, 1792.72it/s]warmup should be done:  46%|████▌     | 1385/3000 [00:00<00:00, 1644.15it/s]warmup should be done:  46%|████▋     | 1390/3000 [00:00<00:00, 1633.39it/s]warmup should be done:  52%|█████▎    | 1575/3000 [00:00<00:00, 1755.92it/s]warmup should be done:  54%|█████▍    | 1625/3000 [00:00<00:00, 1779.44it/s]warmup should be done:  52%|█████▏    | 1550/3000 [00:00<00:00, 1637.31it/s]warmup should be done:  52%|█████▏    | 1568/3000 [00:00<00:00, 1675.71it/s]warmup should be done:  58%|█████▊    | 1751/3000 [00:01<00:00, 1755.40it/s]warmup should be done:  60%|██████    | 1803/3000 [00:01<00:00, 1769.07it/s]warmup should be done:  58%|█████▊    | 1738/3000 [00:01<00:00, 1682.20it/s]warmup should be done:  57%|█████▋    | 1715/3000 [00:01<00:00, 1638.90it/s]warmup should be done:  64%|██████▍   | 1927/3000 [00:01<00:00, 1751.97it/s]warmup should be done:  66%|██████▌   | 1980/3000 [00:01<00:00, 1762.32it/s]warmup should be done:  64%|██████▍   | 1913/3000 [00:01<00:00, 1702.28it/s]warmup should be done:  63%|██████▎   | 1884/3000 [00:01<00:00, 1651.71it/s]warmup should be done:  70%|███████   | 2103/3000 [00:01<00:00, 1753.01it/s]warmup should be done:  72%|███████▏  | 2157/3000 [00:01<00:00, 1755.93it/s]warmup should be done:  70%|██████▉   | 2088/3000 [00:01<00:00, 1716.03it/s]warmup should be done:  68%|██████▊   | 2050/3000 [00:01<00:00, 1538.36it/s]warmup should be done:  76%|███████▌  | 2279/3000 [00:01<00:00, 1751.36it/s]warmup should be done:  78%|███████▊  | 2333/3000 [00:01<00:00, 1745.25it/s]warmup should be done:  75%|███████▌  | 2264/3000 [00:01<00:00, 1726.93it/s]warmup should be done:  74%|███████▍  | 2216/3000 [00:01<00:00, 1572.22it/s]warmup should be done:  82%|████████▏ | 2455/3000 [00:01<00:00, 1728.53it/s]warmup should be done:  84%|████████▎ | 2511/3000 [00:01<00:00, 1755.09it/s]warmup should be done:  81%|████████▏ | 2440/3000 [00:01<00:00, 1734.42it/s]warmup should be done:  79%|███████▉  | 2384/3000 [00:01<00:00, 1601.15it/s]warmup should be done:  88%|████████▊ | 2632/3000 [00:01<00:00, 1739.53it/s]warmup should be done:  90%|████████▉ | 2693/3000 [00:01<00:00, 1773.56it/s]warmup should be done:  87%|████████▋ | 2619/3000 [00:01<00:00, 1748.72it/s]warmup should be done:  85%|████████▍ | 2546/3000 [00:01<00:00, 1594.71it/s]warmup should be done:  94%|█████████▎| 2811/3000 [00:01<00:00, 1752.30it/s]warmup should be done:  96%|█████████▌| 2875/3000 [00:01<00:00, 1786.48it/s]warmup should be done:  93%|█████████▎| 2798/3000 [00:01<00:00, 1760.49it/s]warmup should be done:  91%|█████████ | 2720/3000 [00:01<00:00, 1635.60it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1780.34it/s]warmup should be done: 100%|█████████▉| 2989/3000 [00:01<00:00, 1759.16it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1745.72it/s]warmup should be done:  99%|█████████▉| 2981/3000 [00:01<00:00, 1778.77it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1723.72it/s]warmup should be done:  96%|█████████▋| 2895/3000 [00:01<00:00, 1667.43it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1650.77it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1798.96it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1749.83it/s]warmup should be done:   5%|▌         | 163/3000 [00:00<00:01, 1627.38it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1731.88it/s]warmup should be done:  11%|█▏        | 343/3000 [00:00<00:01, 1726.32it/s]warmup should be done:  12%|█▏        | 361/3000 [00:00<00:01, 1800.03it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1815.86it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1796.37it/s]warmup should be done:  18%|█▊        | 548/3000 [00:00<00:01, 1834.41it/s]warmup should be done:  18%|█▊        | 529/3000 [00:00<00:01, 1783.45it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1815.97it/s]warmup should be done:  18%|█▊        | 542/3000 [00:00<00:01, 1789.61it/s]warmup should be done:  24%|██▍       | 734/3000 [00:00<00:01, 1844.02it/s]warmup should be done:  24%|██▍       | 715/3000 [00:00<00:01, 1811.58it/s]warmup should be done:  24%|██▍       | 728/3000 [00:00<00:01, 1825.78it/s]warmup should be done:  24%|██▍       | 721/3000 [00:00<00:01, 1675.16it/s]warmup should be done:  31%|███       | 920/3000 [00:00<00:01, 1849.71it/s]warmup should be done:  30%|███       | 901/3000 [00:00<00:01, 1827.40it/s]warmup should be done:  30%|███       | 913/3000 [00:00<00:01, 1831.52it/s]warmup should be done:  30%|██▉       | 899/3000 [00:00<00:01, 1708.80it/s]warmup should be done:  37%|███▋      | 1106/3000 [00:00<00:01, 1850.73it/s]warmup should be done:  36%|███▌      | 1087/3000 [00:00<00:01, 1835.85it/s]warmup should be done:  37%|███▋      | 1098/3000 [00:00<00:01, 1836.43it/s]warmup should be done:  36%|███▌      | 1083/3000 [00:00<00:01, 1748.91it/s]warmup should be done:  42%|████▏     | 1272/3000 [00:00<00:00, 1838.95it/s]warmup should be done:  43%|████▎     | 1292/3000 [00:00<00:00, 1847.64it/s]warmup should be done:  43%|████▎     | 1282/3000 [00:00<00:00, 1835.81it/s]warmup should be done:  42%|████▏     | 1265/3000 [00:00<00:00, 1769.84it/s]warmup should be done:  49%|████▊     | 1458/3000 [00:00<00:00, 1844.01it/s]warmup should be done:  49%|████▉     | 1478/3000 [00:00<00:00, 1851.04it/s]warmup should be done:  49%|████▉     | 1468/3000 [00:00<00:00, 1840.47it/s]warmup should be done:  48%|████▊     | 1449/3000 [00:00<00:00, 1789.08it/s]warmup should be done:  55%|█████▍    | 1644/3000 [00:00<00:00, 1848.60it/s]warmup should be done:  56%|█████▌    | 1665/3000 [00:00<00:00, 1854.72it/s]warmup should be done:  55%|█████▌    | 1654/3000 [00:00<00:00, 1845.09it/s]warmup should be done:  54%|█████▍    | 1633/3000 [00:00<00:00, 1801.91it/s]warmup should be done:  61%|██████    | 1830/3000 [00:01<00:00, 1850.62it/s]warmup should be done:  62%|██████▏   | 1853/3000 [00:01<00:00, 1859.51it/s]warmup should be done:  61%|██████▏   | 1841/3000 [00:01<00:00, 1852.51it/s]warmup should be done:  61%|██████    | 1816/3000 [00:01<00:00, 1809.18it/s]warmup should be done:  67%|██████▋   | 2016/3000 [00:01<00:00, 1850.29it/s]warmup should be done:  68%|██████▊   | 2040/3000 [00:01<00:00, 1862.55it/s]warmup should be done:  68%|██████▊   | 2027/3000 [00:01<00:00, 1853.51it/s]warmup should be done:  67%|██████▋   | 1999/3000 [00:01<00:00, 1813.24it/s]warmup should be done:  73%|███████▎  | 2202/3000 [00:01<00:00, 1851.62it/s]warmup should be done:  74%|███████▍  | 2227/3000 [00:01<00:00, 1862.90it/s]warmup should be done:  74%|███████▍  | 2213/3000 [00:01<00:00, 1853.75it/s]warmup should be done:  73%|███████▎  | 2181/3000 [00:01<00:00, 1812.86it/s]warmup should be done:  80%|████████  | 2414/3000 [00:01<00:00, 1863.49it/s]warmup should be done:  80%|███████▉  | 2388/3000 [00:01<00:00, 1851.65it/s]warmup should be done:  80%|███████▉  | 2399/3000 [00:01<00:00, 1853.67it/s]warmup should be done:  79%|███████▉  | 2366/3000 [00:01<00:00, 1821.35it/s]warmup should be done:  87%|████████▋ | 2601/3000 [00:01<00:00, 1864.64it/s]warmup should be done:  86%|████████▌ | 2585/3000 [00:01<00:00, 1854.77it/s]warmup should be done:  85%|████████▍ | 2549/3000 [00:01<00:00, 1773.30it/s]warmup should be done:  86%|████████▌ | 2574/3000 [00:01<00:00, 1701.95it/s]warmup should be done:  93%|█████████▎| 2788/3000 [00:01<00:00, 1865.97it/s]warmup should be done:  92%|█████████▏| 2771/3000 [00:01<00:00, 1846.11it/s]warmup should be done:  91%|█████████ | 2732/3000 [00:01<00:00, 1789.22it/s]warmup should be done:  92%|█████████▏| 2747/3000 [00:01<00:00, 1597.26it/s]warmup should be done:  99%|█████████▉| 2976/3000 [00:01<00:00, 1867.38it/s]warmup should be done:  99%|█████████▊| 2956/3000 [00:01<00:00, 1816.28it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1854.62it/s]warmup should be done:  97%|█████████▋| 2915/3000 [00:01<00:00, 1800.79it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1833.37it/s]warmup should be done:  98%|█████████▊| 2932/3000 [00:01<00:00, 1665.70it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1785.50it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1769.08it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7ff43a342190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7ff43a342280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7ff43a343160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7ff43a3430a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 21:31:21.340630: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7ff011a64120 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:31:21.340712: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:31:21.341642: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7ff005a67d10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:31:21.341679: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:31:21.348432: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:31:21.348432: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:31:22.355145: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7ff01126b4f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:31:22.355202: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:31:22.362384: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:31:22.422914: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7ff00d26a200 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:31:22.422976: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:31:22.431409: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:31:22.527782: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:31:22.571062: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:31:23.123512: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:31:23.138811: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:31:28.140415: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:31:28.662706: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:31:28.692504: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:31:29.397650: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][21:32:28.151][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][21:32:28.152][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:32:28.157][ERROR][RK0][main]: coll ps creation done
[HCTR][21:32:28.157][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][21:32:28.169][ERROR][RK0][tid #140669347677952]: replica 1 reaches 1000, calling init pre replica
[HCTR][21:32:28.169][ERROR][RK0][tid #140669347677952]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:32:28.172][ERROR][RK0][tid #140669347677952]: coll ps creation done
[HCTR][21:32:28.172][ERROR][RK0][tid #140669347677952]: replica 1 waits for coll ps creation barrier
[HCTR][21:32:28.304][ERROR][RK0][tid #140669356070656]: replica 0 reaches 1000, calling init pre replica
[HCTR][21:32:28.304][ERROR][RK0][tid #140669356070656]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:32:28.308][ERROR][RK0][tid #140669356070656]: coll ps creation done
[HCTR][21:32:28.308][ERROR][RK0][tid #140669356070656]: replica 0 waits for coll ps creation barrier
[HCTR][21:32:28.392][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][21:32:28.392][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][21:32:28.396][ERROR][RK0][main]: coll ps creation done
[HCTR][21:32:28.396][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][21:32:28.396][ERROR][RK0][tid #140669356070656]: replica 0 preparing frequency
[HCTR][21:32:29.342][ERROR][RK0][tid #140669356070656]: replica 0 preparing frequency done
[HCTR][21:32:29.370][ERROR][RK0][tid #140669356070656]: replica 0 calling init per replica
[HCTR][21:32:29.370][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][21:32:29.370][ERROR][RK0][tid #140669347677952]: replica 1 calling init per replica
[HCTR][21:32:29.370][ERROR][RK0][main]: Calling build_v2
[HCTR][21:32:29.370][ERROR][RK0][tid #140669347677952]: Calling build_v2
[HCTR][21:32:29.370][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:32:29.370][ERROR][RK0][tid #140669347677952]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:32:29.370][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][21:32:29.370][ERROR][RK0][tid #140669356070656]: Calling build_v2
[HCTR][21:32:29.370][ERROR][RK0][tid #140669356070656]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:32:29.370][ERROR][RK0][main]: Calling build_v2
[HCTR][21:32:29.370][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[2022-12-11 21:32:292022-12-11 21:32:29..370366370366: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc::136136] ] using concurrent impl MPSPhaseusing concurrent impl MPSPhase

[2022-12-11 21:32:29.370449: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc[:136] using concurrent impl MPSPhase
2022-12-11 21:32:29.370476: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[2022-12-11 21:32:29.371454: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 21:32:29.371500: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 21:32:29.371524: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] [build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 21:32:29
[.2022-12-11 21:32:29371547.: 371562E[:  2022-12-11 21:32:29E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc. :371584/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc196: :] E196assigning 8 to cpu ] 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpu:
213] remote time is 8.68421
[[2022-12-11 21:32:292022-12-11 21:32:29..371650371648: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::214212] [] cpu time is 302022-12-11 21:32:29build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
.
371684: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2122022-12-11 21:32:29] .build symm link desc with 4X Tesla V100-SXM2-16GB out of 4371716
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213[] 2022-12-11 21:32:29remote time is 8.68421.
371742: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 21:32:29:.213371761] : remote time is 8.68421E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214[] 2022-12-11 21:32:29cpu time is 30.
371791[: 2022-12-11 21:32:29E. 371794/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E214 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30:
212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-11 21:32:29.371859: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-11 21:32:29.371888: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 21:32:55.300771: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 21:32:55.356855: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 21:32:55.356971: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 21:32:55.358048: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 21:32:55.445693: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 21:32:55.833094: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 21:32:55.833187: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 21:33:02.539557: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 21:33:02.539671: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 21:33:04.356403: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 21:33:04.356509: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 21:33:04.372824: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 21:33:04.372903: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 21:33:04.397106: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 21:33:04.409742: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 21:33:04.410680: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 21:33:04.420945: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 21:33:04.513945: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 21:33:04.516518: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 21:33:04.518903: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 21:33:04.521223: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 21:33:04.523553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 21:33:06.241622: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 21:33:06.246230: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 21:33:06.246403: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 21:33:06.256463: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 21:33:06.256525: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 21:33:06.256559: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 21:33:06.256588: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 21:33:06.257870: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:33:06.257915: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:33:06.258882: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:33:06.259436: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:33:06.278179: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 21:33:06.278292: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 21:33:06.278277: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 21:33:06.278372: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 21:33:06.279127: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:33:06.279184: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:33:06.279594: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:33:06.279646: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:33:06.280153: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 21:33:06.280263: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 21:33:06.280544: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:33:06.280585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:33:06.281078: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 21:33:06.281145: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:33:06.282100: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-11 21:33:06
.282125: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:33:06.283071: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:33:06.283726: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:33:06.359241: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 21:33:06.361085: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:33:06.361137: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:33:06.361930: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:33:06.362079: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 21:33:06.362353: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:33:06.363265: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:33:06.363318: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.26 MB
[2022-12-11 21:33:06.363904: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:33:06.363952: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:33:06.364728: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:33:06.365207: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:33:06.366110: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:33:06.366151: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.26 MB
[2022-12-11 21:33:06.370126: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:33:06.370808: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:33:06.370855: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[2022-12-11 21:33:06.374564: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:33:06.375240: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:33:06.375282: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[2022-12-11 21:33:062022-12-11 21:33:06..386395386399: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-11 21:33:06.388226: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 21:33:06.388260[: 2022-12-11 21:33:06E. 388271/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :E638 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 1021:
638] eager release cuda mem 400000000
[2022-12-11 21:33:06.388323: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:33:06.389081: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:33:06.389568: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:33:06.390029: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:33:06.390102: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:33:06.390936: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:33:06.390982: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.25 MB
[2022-12-11 21:33:06.391008: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:33:06.391051: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 15.23 MB
[2022-12-11 21:33:06.398958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:33:06.399626: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:33:06.399667: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[2022-12-11 21:33:06.400654: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:33:06.401295: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:33:06.401337: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[[[2022-12-11 21:33:062022-12-11 21:33:062022-12-11 21:33:062022-12-11 21:33:06....571144571141571140571148: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 3 init p2p of link 0Device 2 init p2p of link 3Device 0 init p2p of link 1Device 1 init p2p of link 2



[[2022-12-11 21:33:062022-12-11 21:33:06..571424571427: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[:19802022-12-11 21:33:061980] .] eager alloc mem 611.00 KB571456eager alloc mem 611.00 KB
: 
E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 21:33:06:.1980571512] : eager alloc mem 611.00 KBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:33:06.572266[: 2022-12-11 21:33:06E. 572274/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :E638 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 625663:
638] eager release cuda mem 625663
[2022-12-11 21:33:06.572327: E[ 2022-12-11 21:33:06/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:572341638: ] Eeager release cuda mem 625663 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:33:06.575320: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 21:33:06.575418: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:33:06.575497: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 21:33:06.575543: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 21:33:06.575595: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:33:06.575691: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 21:33:06.575788: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:33:06.575838: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:33:06.576203: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:33:06.576385: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:33:06.576571: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:33:06.576621: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:33:06.578897: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 21:33:06.578983: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:33:06.579639: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 21:33:06.579665: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 21:33:06.579706: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926[] 2022-12-11 21:33:06Device 0 init p2p of link 3.
579737: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 21:33:06eager alloc mem 611.00 KB.
579759[: 2022-12-11 21:33:06E. 579782[/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: 2022-12-11 21:33:06:E.1980 579806] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: eager alloc mem 611.00 KB:E
638 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager release cuda mem 625663:
1980] eager alloc mem 611.00 KB
[2022-12-11 21:33:06.580535: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:33:06.580622: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663[
2022-12-11 21:33:06.580645: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:33:06.581801: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:33:06.582737: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3998527 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11972544 / 100000000 nodes ( 11.97 %) | cpu 84028929 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.30357 secs 
[2022-12-11 21:33:06.583243: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:33:06.584117: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:33:06.584640: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:33:06.588013: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3993574 / 100000000 nodes ( 3.99 %~4.00 %) | remote 11977497 / 100000000 nodes ( 11.98 %) | cpu 84028929 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.308381 secs 
[2022-12-11 21:33:06.588718: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3999605 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11971466 / 100000000 nodes ( 11.97 %) | cpu 84028929 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.30759 secs 
[2022-12-11 21:33:06.589682: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 3999586 / 100000000 nodes ( 4.00 %~4.00 %) | remote 11971485 / 100000000 nodes ( 11.97 %) | cpu 84028929 / 100000000 nodes ( 84.03 %) | 1.91 GB | 0.331771 secs 
[2022-12-11 21:33:06.590246: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 8.61 GB
[2022-12-11 21:33:07.592611: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 8.86 GB
[2022-12-11 21:33:07.592744: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 8.86 GB
[2022-12-11 21:33:07.593239: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 8.86 GB
[2022-12-11 21:33:08.409060: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 9.10 GB
[2022-12-11 21:33:08.409286: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 9.10 GB
[2022-12-11 21:33:08.409691: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 9.10 GB
[2022-12-11 21:33:09.223512: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 9.35 GB
[2022-12-11 21:33:09.223635: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 9.35 GB
[2022-12-11 21:33:09.223980: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 9.35 GB
[2022-12-11 21:33:09.224215: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 9.35 GB
[2022-12-11 21:33:09.224478: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 9.35 GB
[2022-12-11 21:33:10.192788: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 9.54 GB
[2022-12-11 21:33:10.192923: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 9.54 GB
[HCTR][21:33:10.331][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][21:33:10.331][ERROR][RK0][tid #140669356070656]: replica 0 calling init per replica done, doing barrier
[HCTR][21:33:10.331][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][21:33:10.331][ERROR][RK0][tid #140669347677952]: replica 1 calling init per replica done, doing barrier
[HCTR][21:33:10.331][ERROR][RK0][tid #140669356070656]: replica 0 calling init per replica done, doing barrier done
[HCTR][21:33:10.331][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][21:33:10.331][ERROR][RK0][tid #140669347677952]: replica 1 calling init per replica done, doing barrier done
[HCTR][21:33:10.331][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][21:33:10.331][ERROR][RK0][main]: init per replica done
[HCTR][21:33:10.331][ERROR][RK0][main]: init per replica done
[HCTR][21:33:10.331][ERROR][RK0][tid #140669347677952]: init per replica done
[HCTR][21:33:10.335][ERROR][RK0][tid #140669356070656]: init per replica done
[HCTR][21:33:10.366][ERROR][RK0][tid #140669347677952]: 1 allocated 3276800 at 0x7fd6c8238400
[HCTR][21:33:10.366][ERROR][RK0][tid #140669347677952]: 1 allocated 6553600 at 0x7fd6c8558400
[HCTR][21:33:10.366][ERROR][RK0][tid #140669347677952]: 1 allocated 3276800 at 0x7fd6c8b98400
[HCTR][21:33:10.366][ERROR][RK0][tid #140669347677952]: 1 allocated 6553600 at 0x7fd6c8eb8400
[HCTR][21:33:10.369][ERROR][RK0][main]: 3 allocated 3276800 at 0x7fd5c4238400
[HCTR][21:33:10.369][ERROR][RK0][main]: 3 allocated 6553600 at 0x7fd5c4558400
[HCTR][21:33:10.369][ERROR][RK0][main]: 3 allocated 3276800 at 0x7fd5c4b98400
[HCTR][21:33:10.369][ERROR][RK0][main]: 3 allocated 6553600 at 0x7fd5c4eb8400
[HCTR][21:33:10.370][ERROR][RK0][main]: 2 allocated 3276800 at 0x7fd5c8238400
[HCTR][21:33:10.370][ERROR][RK0][main]: 2 allocated 6553600 at 0x7fd5c8558400
[HCTR][21:33:10.370][ERROR][RK0][main]: 2 allocated 3276800 at 0x7fd5c8b98400
[HCTR][21:33:10.370][ERROR][RK0][main]: 2 allocated 6553600 at 0x7fd5c8eb8400
[HCTR][21:33:10.376][ERROR][RK0][tid #140669356070656]: 0 allocated 3276800 at 0x7fd694320000
[HCTR][21:33:10.376][ERROR][RK0][tid #140669356070656]: 0 allocated 6553600 at 0x7fd694640000
[HCTR][21:33:10.376][ERROR][RK0][tid #140669356070656]: 0 allocated 3276800 at 0x7fd694c80000
[HCTR][21:33:10.376][ERROR][RK0][tid #140669356070656]: 0 allocated 6553600 at 0x7fd694fa0000
