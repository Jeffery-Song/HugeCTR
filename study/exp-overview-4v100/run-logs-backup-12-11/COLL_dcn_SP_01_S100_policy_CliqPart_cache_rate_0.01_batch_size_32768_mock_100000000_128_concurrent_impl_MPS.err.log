2022-12-11 19:30:26.361662: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:30:26.432936: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:30:26.434809: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:30:26.436324: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:30:27.226085: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:30:27.226169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 19:30:27.238703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 19:30:27.271312: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:30:27.271471: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:30:27.273559: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 19:30:27.293828: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:30:27.293912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 19:30:27.295641: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:30:27.295699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 19:30:27.300282: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:30:27.300350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 19:30:27.307101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 19:30:27.309278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 19:30:27.311965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 19:30:27.336617: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:30:27.336780: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:30:27.338222: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 19:30:27.340313: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:30:27.340435: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:30:27.341850: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 19:30:27.343108: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:30:27.343217: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:30:27.344617: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][19:30:28.573][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:30:28.587][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:30:28.612][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:30:28.626][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.68s/it]warmup run: 0it [00:00, ?it/s]warmup run: 98it [00:01, 76.60it/s]warmup run: 205it [00:01, 176.57it/s]warmup run: 1it [00:01,  1.58s/it]warmup run: 313it [00:01, 290.11it/s]warmup run: 107it [00:01, 88.21it/s]warmup run: 423it [00:02, 412.83it/s]warmup run: 216it [00:01, 193.83it/s]warmup run: 524it [00:02, 519.23it/s]warmup run: 324it [00:01, 309.69it/s]warmup run: 629it [00:02, 625.86it/s]warmup run: 433it [00:01, 432.22it/s]warmup run: 738it [00:02, 729.07it/s]warmup run: 543it [00:02, 554.21it/s]warmup run: 849it [00:02, 820.65it/s]warmup run: 654it [00:02, 669.05it/s]warmup run: 957it [00:02, 885.70it/s]warmup run: 764it [00:02, 767.33it/s]warmup run: 1063it [00:02, 931.06it/s]warmup run: 874it [00:02, 847.67it/s]warmup run: 1171it [00:02, 971.05it/s]warmup run: 983it [00:02, 910.43it/s]warmup run: 1278it [00:02, 997.84it/s]warmup run: 1093it [00:02, 959.76it/s]warmup run: 1385it [00:02, 1008.24it/s]warmup run: 1203it [00:02, 997.21it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1491it [00:03, 1020.06it/s]warmup run: 1312it [00:02, 1022.08it/s]warmup run: 92it [00:01, 83.81it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 1597it [00:03, 1029.55it/s]warmup run: 1421it [00:02, 1035.41it/s]warmup run: 195it [00:01, 192.99it/s]warmup run: 101it [00:01, 91.18it/s]warmup run: 1705it [00:03, 1041.65it/s]warmup run: 1529it [00:02, 1044.60it/s]warmup run: 304it [00:01, 319.83it/s]warmup run: 207it [00:01, 201.93it/s]warmup run: 1812it [00:03, 1048.19it/s]warmup run: 1637it [00:03, 1050.00it/s]warmup run: 407it [00:01, 439.11it/s]warmup run: 306it [00:01, 312.41it/s]warmup run: 1918it [00:03, 1042.51it/s]warmup run: 1745it [00:03, 1053.86it/s]warmup run: 512it [00:01, 556.82it/s]warmup run: 412it [00:01, 437.05it/s]warmup run: 2024it [00:03, 1023.97it/s]warmup run: 1852it [00:03, 1055.80it/s]warmup run: 619it [00:02, 666.83it/s]warmup run: 518it [00:01, 556.11it/s]warmup run: 2160it [00:03, 1120.34it/s]warmup run: 1959it [00:03, 1058.57it/s]warmup run: 725it [00:02, 758.33it/s]warmup run: 626it [00:02, 667.70it/s]warmup run: 2296it [00:03, 1189.35it/s]warmup run: 2081it [00:03, 1105.67it/s]warmup run: 827it [00:02, 810.56it/s]warmup run: 734it [00:02, 763.03it/s]warmup run: 2432it [00:03, 1238.14it/s]warmup run: 2215it [00:03, 1172.93it/s]warmup run: 935it [00:02, 880.19it/s]warmup run: 841it [00:02, 839.97it/s]warmup run: 2568it [00:04, 1272.57it/s]warmup run: 2348it [00:03, 1218.15it/s]warmup run: 1038it [00:02, 896.46it/s]warmup run: 946it [00:02, 887.79it/s]warmup run: 2704it [00:04, 1297.01it/s]warmup run: 2481it [00:03, 1250.30it/s]warmup run: 1144it [00:02, 940.68it/s]warmup run: 1054it [00:02, 937.79it/s]warmup run: 2840it [00:04, 1314.16it/s]warmup run: 2615it [00:03, 1275.45it/s]warmup run: 1249it [00:02, 969.47it/s]warmup run: 1159it [00:02, 960.36it/s]warmup run: 2974it [00:04, 1320.94it/s]warmup run: 3000it [00:04, 692.45it/s] warmup run: 2748it [00:04, 1290.70it/s]warmup run: 1353it [00:02, 987.03it/s]warmup run: 1264it [00:02, 983.76it/s]warmup run: 2878it [00:04, 1281.59it/s]warmup run: 1456it [00:02, 986.28it/s]warmup run: 1368it [00:02, 990.28it/s]warmup run: 3000it [00:04, 713.61it/s] warmup run: 1561it [00:02, 1003.67it/s]warmup run: 1474it [00:02, 1009.44it/s]warmup run: 1667it [00:03, 1018.11it/s]warmup run: 1578it [00:02, 1017.64it/s]warmup run: 1775it [00:03, 1033.74it/s]warmup run: 1684it [00:03, 1029.05it/s]warmup run: 1881it [00:03, 1040.09it/s]warmup run: 1789it [00:03, 1035.08it/s]warmup run: 1989it [00:03, 1050.35it/s]warmup run: 1896it [00:03, 1044.03it/s]warmup run: 2120it [00:03, 1126.71it/s]warmup run: 2002it [00:03, 1044.39it/s]warmup run: 2255it [00:03, 1190.91it/s]warmup run: 2133it [00:03, 1122.61it/s]warmup run: 2389it [00:03, 1233.61it/s]warmup run: 2267it [00:03, 1186.72it/s]warmup run: 2524it [00:03, 1266.96it/s]warmup run: 2402it [00:03, 1233.56it/s]warmup run: 2659it [00:03, 1290.87it/s]warmup run: 2537it [00:03, 1266.41it/s]warmup run: 2794it [00:03, 1306.89it/s]warmup run: 2672it [00:03, 1289.38it/s]warmup run: 2929it [00:04, 1319.40it/s]warmup run: 2806it [00:03, 1303.05it/s]warmup run: 3000it [00:04, 729.87it/s] warmup run: 2941it [00:04, 1315.15it/s]warmup run: 3000it [00:04, 730.07it/s] 


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1739.91it/s]warmup should be done:   5%|▌         | 164/3000 [00:00<00:01, 1639.09it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1641.47it/s]warmup should be done:   5%|▌         | 159/3000 [00:00<00:01, 1583.07it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1768.84it/s]warmup should be done:  11%|█▏        | 343/3000 [00:00<00:01, 1726.34it/s]warmup should be done:  11%|█▏        | 340/3000 [00:00<00:01, 1704.21it/s]warmup should be done:  11%|█         | 336/3000 [00:00<00:01, 1687.86it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1770.00it/s]warmup should be done:  17%|█▋        | 513/3000 [00:00<00:01, 1715.35it/s]warmup should be done:  17%|█▋        | 507/3000 [00:00<00:01, 1696.37it/s]warmup should be done:  17%|█▋        | 516/3000 [00:00<00:01, 1684.06it/s]warmup should be done:  24%|██▎       | 709/3000 [00:00<00:01, 1773.22it/s]warmup should be done:  23%|██▎       | 688/3000 [00:00<00:01, 1728.64it/s]warmup should be done:  23%|██▎       | 683/3000 [00:00<00:01, 1718.22it/s]warmup should be done:  23%|██▎       | 685/3000 [00:00<00:01, 1667.65it/s]warmup should be done:  30%|██▉       | 887/3000 [00:00<00:01, 1773.58it/s]warmup should be done:  29%|██▊       | 861/3000 [00:00<00:01, 1724.96it/s]warmup should be done:  29%|██▊       | 858/3000 [00:00<00:01, 1727.59it/s]warmup should be done:  29%|██▊       | 859/3000 [00:00<00:01, 1692.79it/s]warmup should be done:  36%|███▌      | 1065/3000 [00:00<00:01, 1773.14it/s]warmup should be done:  35%|███▍      | 1038/3000 [00:00<00:01, 1739.18it/s]warmup should be done:  34%|███▍      | 1035/3000 [00:00<00:01, 1740.56it/s]warmup should be done:  34%|███▍      | 1029/3000 [00:00<00:01, 1680.93it/s]warmup should be done:  41%|████▏     | 1243/3000 [00:00<00:00, 1773.87it/s]warmup should be done:  40%|████      | 1212/3000 [00:00<00:01, 1720.37it/s]warmup should be done:  40%|████      | 1212/3000 [00:00<00:01, 1748.29it/s]warmup should be done:  40%|████      | 1201/3000 [00:00<00:01, 1692.15it/s]warmup should be done:  47%|████▋     | 1421/3000 [00:00<00:00, 1772.86it/s]warmup should be done:  46%|████▌     | 1385/3000 [00:00<00:00, 1714.67it/s]warmup should be done:  46%|████▌     | 1387/3000 [00:00<00:00, 1741.87it/s]warmup should be done:  46%|████▌     | 1371/3000 [00:00<00:00, 1685.93it/s]warmup should be done:  53%|█████▎    | 1600/3000 [00:00<00:00, 1777.49it/s]warmup should be done:  52%|█████▏    | 1564/3000 [00:00<00:00, 1747.72it/s]warmup should be done:  52%|█████▏    | 1557/3000 [00:00<00:00, 1709.20it/s]warmup should be done:  52%|█████▏    | 1550/3000 [00:00<00:00, 1717.72it/s]warmup should be done:  59%|█████▉    | 1778/3000 [00:01<00:00, 1769.74it/s]warmup should be done:  58%|█████▊    | 1739/3000 [00:01<00:00, 1743.51it/s]warmup should be done:  58%|█████▊    | 1728/3000 [00:01<00:00, 1707.52it/s]warmup should be done:  57%|█████▋    | 1722/3000 [00:01<00:00, 1707.20it/s]warmup should be done:  65%|██████▌   | 1955/3000 [00:01<00:00, 1764.62it/s]warmup should be done:  63%|██████▎   | 1899/3000 [00:01<00:00, 1705.24it/s]warmup should be done:  64%|██████▍   | 1914/3000 [00:01<00:00, 1740.15it/s]warmup should be done:  63%|██████▎   | 1893/3000 [00:01<00:00, 1703.61it/s]warmup should be done:  71%|███████   | 2132/3000 [00:01<00:00, 1748.27it/s]warmup should be done:  69%|██████▉   | 2070/3000 [00:01<00:00, 1704.39it/s]warmup should be done:  70%|██████▉   | 2089/3000 [00:01<00:00, 1734.97it/s]warmup should be done:  69%|██████▉   | 2065/3000 [00:01<00:00, 1708.37it/s]warmup should be done:  75%|███████▍  | 2242/3000 [00:01<00:00, 1706.73it/s]warmup should be done:  77%|███████▋  | 2307/3000 [00:01<00:00, 1733.79it/s]warmup should be done:  75%|███████▌  | 2263/3000 [00:01<00:00, 1731.57it/s]warmup should be done:  75%|███████▍  | 2236/3000 [00:01<00:00, 1707.03it/s]warmup should be done:  81%|████████  | 2416/3000 [00:01<00:00, 1714.82it/s]warmup should be done:  83%|████████▎ | 2481/3000 [00:01<00:00, 1725.96it/s]warmup should be done:  81%|████████  | 2437/3000 [00:01<00:00, 1704.90it/s]warmup should be done:  80%|████████  | 2412/3000 [00:01<00:00, 1720.39it/s]warmup should be done:  86%|████████▋ | 2588/3000 [00:01<00:00, 1714.76it/s]warmup should be done:  88%|████████▊ | 2654/3000 [00:01<00:00, 1722.78it/s]warmup should be done:  87%|████████▋ | 2612/3000 [00:01<00:00, 1715.68it/s]warmup should be done:  86%|████████▌ | 2585/3000 [00:01<00:00, 1716.28it/s]warmup should be done:  92%|█████████▏| 2761/3000 [00:01<00:00, 1719.19it/s]warmup should be done:  94%|█████████▍| 2827/3000 [00:01<00:00, 1723.24it/s]warmup should be done:  92%|█████████▏| 2761/3000 [00:01<00:00, 1727.07it/s]warmup should be done:  93%|█████████▎| 2784/3000 [00:01<00:00, 1690.37it/s]warmup should be done:  98%|█████████▊| 2937/3000 [00:01<00:00, 1728.48it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1715.44it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1747.93it/s]warmup should be done:  98%|█████████▊| 2934/3000 [00:01<00:00, 1726.02it/s]warmup should be done:  99%|█████████▉| 2963/3000 [00:01<00:00, 1717.33it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1722.48it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1714.41it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1707.07it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1798.87it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1708.97it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1699.75it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1761.90it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1754.67it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1794.51it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1717.61it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1777.52it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1775.96it/s]warmup should be done:  17%|█▋        | 520/3000 [00:00<00:01, 1735.02it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1791.62it/s]warmup should be done:  18%|█▊        | 541/3000 [00:00<00:01, 1790.35it/s]warmup should be done:  24%|██▎       | 712/3000 [00:00<00:01, 1787.89it/s]warmup should be done:  23%|██▎       | 694/3000 [00:00<00:01, 1736.68it/s]warmup should be done:  24%|██▍       | 719/3000 [00:00<00:01, 1791.53it/s]warmup should be done:  24%|██▍       | 721/3000 [00:00<00:01, 1770.39it/s]warmup should be done:  30%|██▉       | 893/3000 [00:00<00:01, 1794.65it/s]warmup should be done:  29%|██▉       | 874/3000 [00:00<00:01, 1756.58it/s]warmup should be done:  30%|██▉       | 899/3000 [00:00<00:01, 1793.41it/s]warmup should be done:  30%|███       | 901/3000 [00:00<00:01, 1778.68it/s]warmup should be done:  36%|███▌      | 1075/3000 [00:00<00:01, 1801.11it/s]warmup should be done:  35%|███▌      | 1050/3000 [00:00<00:01, 1755.91it/s]warmup should be done:  36%|███▌      | 1079/3000 [00:00<00:01, 1794.15it/s]warmup should be done:  36%|███▌      | 1081/3000 [00:00<00:01, 1784.04it/s]warmup should be done:  42%|████▏     | 1256/3000 [00:00<00:00, 1799.57it/s]warmup should be done:  41%|████      | 1226/3000 [00:00<00:01, 1751.45it/s]warmup should be done:  42%|████▏     | 1259/3000 [00:00<00:00, 1791.28it/s]warmup should be done:  42%|████▏     | 1260/3000 [00:00<00:00, 1785.83it/s]warmup should be done:  48%|████▊     | 1438/3000 [00:00<00:00, 1804.59it/s]warmup should be done:  48%|████▊     | 1440/3000 [00:00<00:00, 1794.85it/s]warmup should be done:  47%|████▋     | 1403/3000 [00:00<00:00, 1754.38it/s]warmup should be done:  48%|████▊     | 1441/3000 [00:00<00:00, 1790.91it/s]warmup should be done:  54%|█████▍    | 1620/3000 [00:00<00:00, 1807.38it/s]warmup should be done:  54%|█████▍    | 1621/3000 [00:00<00:00, 1798.68it/s]warmup should be done:  53%|█████▎    | 1580/3000 [00:00<00:00, 1756.54it/s]warmup should be done:  54%|█████▍    | 1622/3000 [00:00<00:00, 1794.38it/s]warmup should be done:  60%|██████    | 1802/3000 [00:01<00:00, 1808.51it/s]warmup should be done:  60%|██████    | 1802/3000 [00:01<00:00, 1801.27it/s]warmup should be done:  59%|█████▊    | 1757/3000 [00:01<00:00, 1757.57it/s]warmup should be done:  60%|██████    | 1802/3000 [00:01<00:00, 1767.61it/s]warmup should be done:  66%|██████▌   | 1983/3000 [00:01<00:00, 1803.58it/s]warmup should be done:  66%|██████▌   | 1984/3000 [00:01<00:00, 1809.49it/s]warmup should be done:  64%|██████▍   | 1934/3000 [00:01<00:00, 1758.67it/s]warmup should be done:  66%|██████▌   | 1985/3000 [00:01<00:00, 1784.55it/s]warmup should be done:  72%|███████▏  | 2164/3000 [00:01<00:00, 1804.50it/s]warmup should be done:  72%|███████▏  | 2165/3000 [00:01<00:00, 1807.89it/s]warmup should be done:  70%|███████   | 2110/3000 [00:01<00:00, 1733.28it/s]warmup should be done:  72%|███████▏  | 2168/3000 [00:01<00:00, 1795.70it/s]warmup should be done:  78%|███████▊  | 2345/3000 [00:01<00:00, 1806.03it/s]warmup should be done:  78%|███████▊  | 2347/3000 [00:01<00:00, 1809.84it/s]warmup should be done:  76%|███████▌  | 2284/3000 [00:01<00:00, 1730.61it/s]warmup should be done:  78%|███████▊  | 2352/3000 [00:01<00:00, 1806.91it/s]warmup should be done:  84%|████████▍ | 2530/3000 [00:01<00:00, 1816.84it/s]warmup should be done:  84%|████████▍ | 2529/3000 [00:01<00:00, 1811.22it/s]warmup should be done:  82%|████████▏ | 2461/3000 [00:01<00:00, 1740.65it/s]warmup should be done:  84%|████████▍ | 2533/3000 [00:01<00:00, 1760.64it/s]warmup should be done:  90%|█████████ | 2715/3000 [00:01<00:00, 1824.69it/s]warmup should be done:  90%|█████████ | 2711/3000 [00:01<00:00, 1812.22it/s]warmup should be done:  88%|████████▊ | 2636/3000 [00:01<00:00, 1740.92it/s]warmup should be done:  90%|█████████ | 2712/3000 [00:01<00:00, 1767.44it/s]warmup should be done:  97%|█████████▋| 2900/3000 [00:01<00:00, 1831.68it/s]warmup should be done:  96%|█████████▋| 2893/3000 [00:01<00:00, 1812.75it/s]warmup should be done:  94%|█████████▍| 2818/3000 [00:01<00:00, 1762.38it/s]warmup should be done:  96%|█████████▋| 2891/3000 [00:01<00:00, 1771.64it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1808.28it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1802.48it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1780.29it/s]warmup should be done: 100%|█████████▉| 2998/3000 [00:01<00:00, 1773.59it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1751.19it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f71bfcf0250>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f71bfcf0160>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f71bfcf00a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f71bffb2e80>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 19:31:37.986201: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f6d8da67c50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:31:37.986268: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:31:37.993666: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:31:39.071366: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:31:39.774804: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f6d9526b1b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:31:39.774883: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:31:39.786100: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:31:39.865572: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f6d8d263ca0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:31:39.865669: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:31:39.869569: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f6d95a6a5e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:31:39.869625: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:31:39.876425: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:31:39.877029: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:31:40.568818: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:31:40.617677: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:31:40.705073: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:31:45.441501: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:31:46.103999: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:31:46.191456: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:31:46.214448: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][19:32:52.414][ERROR][RK0][tid #140108745406208]: replica 3 reaches 1000, calling init pre replica
[HCTR][19:32:52.414][ERROR][RK0][tid #140108745406208]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][19:32:52.418][ERROR][RK0][tid #140108745406208]: coll ps creation done
[HCTR][19:32:52.418][ERROR][RK0][tid #140108745406208]: replica 3 waits for coll ps creation barrier
[HCTR][19:32:52.648][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][19:32:52.648][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][19:32:52.652][ERROR][RK0][main]: coll ps creation done
[HCTR][19:32:52.652][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][19:32:52.938][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][19:32:52.939][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][19:32:52.944][ERROR][RK0][main]: coll ps creation done
[HCTR][19:32:52.944][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][19:32:53.232][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][19:32:53.232][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][19:32:53.237][ERROR][RK0][main]: coll ps creation done
[HCTR][19:32:53.237][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][19:32:53.237][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][19:32:54.167][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][19:32:54.193][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][19:32:54.193][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][19:32:54.193][ERROR][RK0][tid #140108745406208]: replica 3 calling init per replica
[HCTR][19:32:54.193][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][19:32:54.193][ERROR][RK0][main]: Calling build_v2
[HCTR][19:32:54.193][ERROR][RK0][main]: Calling build_v2
[HCTR][19:32:54.193][ERROR][RK0][tid #140108745406208]: Calling build_v2
[HCTR][19:32:54.193][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:32:54.193][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:32:54.193][ERROR][RK0][tid #140108745406208]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:32:54.193][ERROR][RK0][main]: Calling build_v2
[HCTR][19:32:54.193][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-11 19:32:542022-12-11 19:32:542022-12-11 19:32:54...193630[193631193635: : 2022-12-11 19:32:54: EE.E  193655 /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc::E:136136 136] ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] using concurrent impl MPSusing concurrent impl MPS:using concurrent impl MPS

136
] using concurrent impl MPS
[2022-12-11 19:32:54.194939: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] [assigning 8 to cpu2022-12-11 19:32:54
.194964: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 19:32:54196.] [194985assigning 8 to cpu2022-12-11 19:32:54: 
.E194992 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[E:2022-12-11 19:32:54 196./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] 195021:assigning 8 to cpu: 212
E]  [build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 19:32:54
:.196195083] [: [assigning 8 to cpu2022-12-11 19:32:54E2022-12-11 19:32:54
. .195134/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc195141: :: E212E ]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:
:212213] ] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4remote time is 8.68421[
[
2022-12-11 19:32:542022-12-11 19:32:54.[[.1952012022-12-11 19:32:542022-12-11 19:32:54195222: ..: E195245195247E : :  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccEE/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:  :212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc213] ::] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4213214remote time is 8.68421
] ] 
remote time is 8.68421cpu time is 30

[[2022-12-11 19:32:54[2022-12-11 19:32:54.2022-12-11 19:32:54.195391.195392: 195396: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214:213] 214] cpu time is 30] remote time is 8.68421
cpu time is 30

[2022-12-11 19:32:54.195532: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 19:33:18.  8027: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 19:33:18. 66771: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 19:33:18.221697: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 19:33:18.221759: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 19:33:18.221793: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 19:33:18.221824: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 19:33:18.222703: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:33:18.222751: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:33:18.223712: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:33:18.224352: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:33:18.246703: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved[
[2022-12-11 19:33:182022-12-11 19:33:18[..2022-12-11 19:33:18246749246751.: : 246785EE:   E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc202202:] ] 2053 solved2 solved] 

worker 0 thread 1 initing device 1
[[2022-12-11 19:33:182022-12-11 19:33:18..246862246864: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc::205205] ] worker 0 thread 3 initing device 3worker 0 thread 2 initing device 2

[2022-12-11 19:33:18.247086: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[[2022-12-11 19:33:182022-12-11 19:33:18..[2471302471332022-12-11 19:33:18: : .EE247143  : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE:: 18151815/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] ] :Building Coll Cache with ... num gpu device is 4Building Coll Cache with ... num gpu device is 41980

] eager alloc mem 381.47 MB
[[2022-12-11 19:33:182022-12-11 19:33:18..247219247219: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 381.47 MBeager alloc mem 381.47 MB

[2022-12-11 19:33:18.248947: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:33:18.248978: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] [eager alloc mem 381.47 MB2022-12-11 19:33:18
.249001: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:33:18.250496: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:33:18.250532[: 2022-12-11 19:33:18E. 250543/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1980 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 381.47 MB:
1980] eager alloc mem 381.47 MB
[2022-12-11 19:33:18.319887: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 19:33:18.321732: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 19:33:18.321790: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:33:18.322674: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:33:18.323181: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:33:18.324088: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:33:18.326957: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:33:18.327639: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:33:18.327683: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 493.16 MB
[[[2022-12-11 19:33:182022-12-11 19:33:182022-12-11 19:33:18...355253355253355253: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 5.00 Byteseager alloc mem 5.00 Byteseager alloc mem 5.00 Bytes


[2022-12-11 19:33:18.357057[: 2022-12-11 19:33:18E. 357066/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: [:E2022-12-11 19:33:18638 .] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc357081eager release cuda mem 5:: 
638E]  eager release cuda mem 5/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 5
[2022-12-11 19:33:18.357133: [E2022-12-11 19:33:18 .[/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc3571442022-12-11 19:33:18:: .638E357152]  : eager release cuda mem 400000000/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE
: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 400000000638
] eager release cuda mem 400000000
[2022-12-11 19:33:18.358057: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:33:18.358559: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:33:18.359046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:33:18.359566: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:33:18.[3596022022-12-11 19:33:18: .E359609 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 611.00 KB1980
] eager alloc mem 611.00 KB
[2022-12-11 19:33:18.360460: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:33:18.360510: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:33:18.360553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:33:18.361463: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:33:18.362101: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[[2022-12-11 19:33:182022-12-11 19:33:18..362132362143: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 25.25 KBeager alloc mem 493.16 MB

[2022-12-11 19:33:18.362805: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:33:18.362849: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 493.16 MB
[2022-12-11 19:33:18.363964: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:33:18.364608: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:33:18.364651: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 493.16 MB
[[[[2022-12-11 19:33:182022-12-11 19:33:182022-12-11 19:33:182022-12-11 19:33:18....407244407243407243407246: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 2 init p2p of link 3Device 3 init p2p of link 0Device 1 init p2p of link 2Device 0 init p2p of link 1



[2022-12-11 19:33:18.407416: E[[ 2022-12-11 19:33:182022-12-11 19:33:18/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu..:4074274074261980: : ] EEeager alloc mem 611.00 KB [ 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-11 19:33:18/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:.:19804074581980] : ] eager alloc mem 611.00 KBEeager alloc mem 611.00 KB
 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:33:18.408254: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[[2022-12-11 19:33:182022-12-11 19:33:18..408288408289: [: E2022-12-11 19:33:18E . /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc408303/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:: :638E638]  ] eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 625663
:
638] eager release cuda mem 625663
[2022-12-11 19:33:18.410149: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 19:33:18.410231: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:33:18.410260: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[[2022-12-11 19:33:182022-12-11 19:33:18..410345410354: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[::2022-12-11 19:33:1819261980.] ] 410377Device 1 init p2p of link 3eager alloc mem 611.00 KB: 

E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-11 19:33:18.410466: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:33:18.410514: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:33:18.411035: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:33:18.411203: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:33:18.411283: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:33:18.411323: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:33:18.412525: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 19:33:18.412601: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:33:18.413003: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 19:33:18.413085: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:33:18.413135: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19262022-12-11 19:33:18] .Device 1 init p2p of link 0413155
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 19:33:18.413228: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB[
2022-12-11 19:33:18.413250: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:33:18.413409: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:33:18.413888: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:33:18.414031: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663[
2022-12-11 19:33:18.414053: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:33:18.414412: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:33:18.415370: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 999999 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2999997 / 100000000 nodes ( 3.00 %) | cpu 96000004 / 100000000 nodes ( 96.00 %) | 493.16 MB | 0.168159 secs 
[2022-12-11 19:33:18.415980: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:33:18.416153: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:33:18.416212: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:33:18.416541: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 999999 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2999997 / 100000000 nodes ( 3.00 %) | cpu 96000004 / 100000000 nodes ( 96.00 %) | 493.16 MB | 0.169333 secs 
[2022-12-11 19:33:18.417079: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 999999 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2999997 / 100000000 nodes ( 3.00 %) | cpu 96000004 / 100000000 nodes ( 96.00 %) | 493.16 MB | 0.169949 secs 
[2022-12-11 19:33:18.417481: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 999999 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2999997 / 100000000 nodes ( 3.00 %) | cpu 96000004 / 100000000 nodes ( 96.00 %) | 493.16 MB | 0.19474 secs 
[2022-12-11 19:33:18.418345: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.18 GB
[2022-12-11 19:33:19.385635: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.43 GB
[2022-12-11 19:33:19.385840: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.43 GB
[2022-12-11 19:33:19.386221: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.43 GB
[2022-12-11 19:33:20.257092: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.67 GB
[2022-12-11 19:33:20.258257: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.67 GB
[2022-12-11 19:33:20.258584: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.67 GB
[2022-12-11 19:33:21.216786: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 7.92 GB
[2022-12-11 19:33:21.216908: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 7.92 GB
[2022-12-11 19:33:21.217265: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 7.92 GB
[2022-12-11 19:33:21.983940: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.33 GB
[2022-12-11 19:33:21.984090: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.33 GB
[2022-12-11 19:33:21.984919: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.33 GB
[2022-12-11 19:33:22.723409: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.52 GB
[2022-12-11 19:33:22.723541: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.52 GB
[HCTR][19:33:22.858][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][19:33:22.858][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][19:33:22.858][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][19:33:22.858][ERROR][RK0][tid #140108745406208]: replica 3 calling init per replica done, doing barrier
[HCTR][19:33:22.858][ERROR][RK0][tid #140108745406208]: replica 3 calling init per replica done, doing barrier done
[HCTR][19:33:22.858][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][19:33:22.858][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][19:33:22.858][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][19:33:22.858][ERROR][RK0][main]: init per replica done
[HCTR][19:33:22.858][ERROR][RK0][main]: init per replica done
[HCTR][19:33:22.858][ERROR][RK0][tid #140108745406208]: init per replica done
[HCTR][19:33:22.861][ERROR][RK0][main]: init per replica done
[HCTR][19:33:22.893][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f5470238400
[HCTR][19:33:22.893][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f5470558400
[HCTR][19:33:22.893][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f5470b98400
[HCTR][19:33:22.893][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f5470eb8400
[HCTR][19:33:22.893][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f546c238400
[HCTR][19:33:22.893][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f546c558400
[HCTR][19:33:22.893][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f546cb98400
[HCTR][19:33:22.893][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f546ceb8400
[HCTR][19:33:22.895][ERROR][RK0][tid #140109231920896]: 2 allocated 3276800 at 0x7f54a4238400
[HCTR][19:33:22.895][ERROR][RK0][tid #140109231920896]: 2 allocated 6553600 at 0x7f54a4558400
[HCTR][19:33:22.895][ERROR][RK0][tid #140109231920896]: 2 allocated 3276800 at 0x7f54a4b98400
[HCTR][19:33:22.895][ERROR][RK0][tid #140109231920896]: 2 allocated 6553600 at 0x7f54a4eb8400
[HCTR][19:33:22.901][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f5384320000
[HCTR][19:33:22.901][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f5384640000
[HCTR][19:33:22.901][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f5384c80000
[HCTR][19:33:22.901][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f5384fa0000
