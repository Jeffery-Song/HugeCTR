2022-12-11 22:44:28.769948: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:44:28.778503: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:44:28.811085: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:44:28.811873: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:44:29.697529: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:44:29.697621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:44:29.711900: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:44:29.711992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:44:29.712002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:44:29.726644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:44:29.726625: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:44:29.726780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:44:29.731468: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:44:29.731549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:44:29.744092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:44:29.744176: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:44:29.744325: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:44:29.745174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:44:29.745760: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 22:44:29.764158: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:44:29.764326: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:44:29.766268: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 22:44:29.775325: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:44:29.775464: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:44:29.776837: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:44:29.776894: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 22:44:29.776993: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:44:29.778447: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][22:44:31.008][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:44:31.016][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:44:31.041][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:44:31.049][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.55s/it]warmup run: 100it [00:01, 84.14it/s]warmup run: 0it [00:00, ?it/s]warmup run: 188it [00:01, 169.58it/s]warmup run: 277it [00:01, 265.44it/s]warmup run: 380it [00:01, 387.53it/s]warmup run: 1it [00:01,  1.51s/it]warmup run: 491it [00:02, 521.39it/s]warmup run: 102it [00:01, 88.08it/s]warmup run: 593it [00:02, 624.54it/s]warmup run: 1it [00:01,  1.52s/it]warmup run: 212it [00:01, 199.31it/s]warmup run: 697it [00:02, 719.94it/s]warmup run: 108it [00:01, 92.64it/s]warmup run: 317it [00:01, 314.59it/s]warmup run: 798it [00:02, 790.73it/s]warmup run: 216it [00:01, 200.67it/s]warmup run: 427it [00:01, 441.56it/s]warmup run: 325it [00:01, 320.89it/s]warmup run: 905it [00:02, 861.88it/s]warmup run: 526it [00:02, 543.78it/s]warmup run: 1017it [00:02, 930.52it/s]warmup run: 437it [00:01, 449.69it/s]warmup run: 628it [00:02, 643.28it/s]warmup run: 1127it [00:02, 976.39it/s]warmup run: 548it [00:02, 572.77it/s]warmup run: 737it [00:02, 746.36it/s]warmup run: 652it [00:02, 670.64it/s]warmup run: 1237it [00:02, 1008.95it/s]warmup run: 847it [00:02, 832.89it/s]warmup run: 757it [00:02, 758.36it/s]warmup run: 1344it [00:02, 1012.01it/s]warmup run: 868it [00:02, 845.55it/s]warmup run: 956it [00:02, 898.42it/s]warmup run: 1450it [00:02, 1020.02it/s]warmup run: 976it [00:02, 906.80it/s]warmup run: 1062it [00:02, 935.33it/s]warmup run: 1562it [00:03, 1046.58it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 1083it [00:02, 947.06it/s]warmup run: 1171it [00:02, 977.23it/s]warmup run: 1675it [00:03, 1070.09it/s]warmup run: 103it [00:01, 92.84it/s]warmup run: 1192it [00:02, 984.85it/s]warmup run: 1277it [00:02, 992.84it/s]warmup run: 1784it [00:03, 1069.84it/s]warmup run: 207it [00:01, 200.98it/s]warmup run: 1299it [00:02, 1005.75it/s]warmup run: 1383it [00:02, 999.09it/s]warmup run: 1893it [00:03, 1064.08it/s]warmup run: 313it [00:01, 321.24it/s]warmup run: 1406it [00:02, 1023.81it/s]warmup run: 1487it [00:02, 1004.04it/s]warmup run: 2001it [00:03, 1049.99it/s]warmup run: 418it [00:01, 442.80it/s]warmup run: 1521it [00:02, 1059.88it/s]warmup run: 1592it [00:03, 1014.84it/s]warmup run: 2134it [00:03, 1130.24it/s]warmup run: 523it [00:01, 558.82it/s]warmup run: 1634it [00:03, 1079.39it/s]warmup run: 1700it [00:03, 1033.28it/s]warmup run: 2268it [00:03, 1189.88it/s]warmup run: 629it [00:02, 666.65it/s]warmup run: 1745it [00:03, 1083.33it/s]warmup run: 1809it [00:03, 1049.53it/s]warmup run: 2399it [00:03, 1223.34it/s]warmup run: 735it [00:02, 759.07it/s]warmup run: 1855it [00:03, 1076.38it/s]warmup run: 1918it [00:03, 1059.39it/s]warmup run: 2531it [00:03, 1251.38it/s]warmup run: 843it [00:02, 838.68it/s]warmup run: 1964it [00:03, 1077.25it/s]warmup run: 2031it [00:03, 1079.87it/s]warmup run: 2663it [00:03, 1270.80it/s]warmup run: 947it [00:02, 887.56it/s]warmup run: 2089it [00:03, 1126.99it/s]warmup run: 2167it [00:03, 1163.13it/s]warmup run: 2794it [00:04, 1282.40it/s]warmup run: 1052it [00:02, 931.71it/s]warmup run: 2224it [00:03, 1193.05it/s]warmup run: 2304it [00:03, 1222.66it/s]warmup run: 2927it [00:04, 1293.71it/s]warmup run: 1159it [00:02, 970.47it/s]warmup run: 3000it [00:04, 707.37it/s] warmup run: 2359it [00:03, 1238.84it/s]warmup run: 2438it [00:03, 1256.66it/s]warmup run: 1264it [00:02, 989.28it/s]warmup run: 2494it [00:03, 1270.80it/s]warmup run: 2574it [00:03, 1286.24it/s]warmup run: 1371it [00:02, 1011.69it/s]warmup run: 2629it [00:03, 1293.57it/s]warmup run: 2709it [00:03, 1304.15it/s]warmup run: 1479it [00:02, 1029.42it/s]warmup run: 2763it [00:03, 1305.18it/s]warmup run: 2842it [00:04, 1309.17it/s]warmup run: 1585it [00:02, 1034.02it/s]warmup run: 2898it [00:04, 1318.00it/s]warmup run: 2978it [00:04, 1322.15it/s]warmup run: 3000it [00:04, 722.24it/s] warmup run: 1691it [00:03, 1033.54it/s]warmup run: 3000it [00:04, 728.59it/s] warmup run: 1798it [00:03, 1043.51it/s]warmup run: 1906it [00:03, 1052.39it/s]warmup run: 2017it [00:03, 1068.09it/s]warmup run: 2153it [00:03, 1145.67it/s]warmup run: 2289it [00:03, 1207.18it/s]warmup run: 2425it [00:03, 1250.12it/s]warmup run: 2560it [00:03, 1278.47it/s]warmup run: 2696it [00:03, 1300.22it/s]warmup run: 2831it [00:03, 1313.70it/s]warmup run: 2964it [00:04, 1317.23it/s]warmup run: 3000it [00:04, 733.41it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1777.74it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1697.24it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1735.63it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1704.30it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1782.26it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1736.29it/s]warmup should be done:  12%|█▏        | 350/3000 [00:00<00:01, 1752.61it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1753.99it/s]warmup should be done:  17%|█▋        | 522/3000 [00:00<00:01, 1741.74it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1759.41it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1790.34it/s]warmup should be done:  18%|█▊        | 532/3000 [00:00<00:01, 1750.57it/s]warmup should be done:  23%|██▎       | 698/3000 [00:00<00:01, 1747.11it/s]warmup should be done:  24%|██▎       | 705/3000 [00:00<00:01, 1765.56it/s]warmup should be done:  24%|██▍       | 718/3000 [00:00<00:01, 1795.66it/s]warmup should be done:  24%|██▎       | 708/3000 [00:00<00:01, 1751.83it/s]warmup should be done:  29%|██▉       | 882/3000 [00:00<00:01, 1766.32it/s]warmup should be done:  29%|██▉       | 873/3000 [00:00<00:01, 1745.45it/s]warmup should be done:  30%|██▉       | 898/3000 [00:00<00:01, 1782.38it/s]warmup should be done:  29%|██▉       | 884/3000 [00:00<00:01, 1745.45it/s]warmup should be done:  35%|███▌      | 1059/3000 [00:00<00:01, 1764.59it/s]warmup should be done:  35%|███▍      | 1049/3000 [00:00<00:01, 1747.49it/s]warmup should be done:  36%|███▌      | 1077/3000 [00:00<00:01, 1771.10it/s]warmup should be done:  35%|███▌      | 1059/3000 [00:00<00:01, 1735.03it/s]warmup should be done:  41%|████      | 1236/3000 [00:00<00:01, 1763.49it/s]warmup should be done:  41%|████      | 1224/3000 [00:00<00:01, 1745.26it/s]warmup should be done:  42%|████▏     | 1257/3000 [00:00<00:00, 1779.72it/s]warmup should be done:  41%|████      | 1233/3000 [00:00<00:01, 1732.82it/s]warmup should be done:  47%|████▋     | 1399/3000 [00:00<00:00, 1746.45it/s]warmup should be done:  47%|████▋     | 1413/3000 [00:00<00:00, 1764.21it/s]warmup should be done:  48%|████▊     | 1437/3000 [00:00<00:00, 1784.21it/s]warmup should be done:  47%|████▋     | 1408/3000 [00:00<00:00, 1738.21it/s]warmup should be done:  52%|█████▎    | 1575/3000 [00:00<00:00, 1748.06it/s]warmup should be done:  53%|█████▎    | 1591/3000 [00:00<00:00, 1766.06it/s]warmup should be done:  54%|█████▍    | 1618/3000 [00:00<00:00, 1789.97it/s]warmup should be done:  53%|█████▎    | 1582/3000 [00:00<00:00, 1729.62it/s]warmup should be done:  58%|█████▊    | 1750/3000 [00:01<00:00, 1748.61it/s]warmup should be done:  59%|█████▉    | 1768/3000 [00:01<00:00, 1766.87it/s]warmup should be done:  60%|█████▉    | 1799/3000 [00:01<00:00, 1794.30it/s]warmup should be done:  59%|█████▊    | 1756/3000 [00:01<00:00, 1730.82it/s]warmup should be done:  65%|██████▍   | 1945/3000 [00:01<00:00, 1767.75it/s]warmup should be done:  64%|██████▍   | 1926/3000 [00:01<00:00, 1749.27it/s]warmup should be done:  66%|██████▌   | 1979/3000 [00:01<00:00, 1795.73it/s]warmup should be done:  64%|██████▍   | 1931/3000 [00:01<00:00, 1735.23it/s]warmup should be done:  71%|███████   | 2122/3000 [00:01<00:00, 1768.22it/s]warmup should be done:  70%|███████   | 2101/3000 [00:01<00:00, 1734.47it/s]warmup should be done:  72%|███████▏  | 2159/3000 [00:01<00:00, 1795.77it/s]warmup should be done:  70%|███████   | 2110/3000 [00:01<00:00, 1750.24it/s]warmup should be done:  77%|███████▋  | 2300/3000 [00:01<00:00, 1769.36it/s]warmup should be done:  76%|███████▌  | 2276/3000 [00:01<00:00, 1736.20it/s]warmup should be done:  78%|███████▊  | 2339/3000 [00:01<00:00, 1794.81it/s]warmup should be done:  76%|███████▋  | 2289/3000 [00:01<00:00, 1760.99it/s]warmup should be done:  83%|████████▎ | 2479/3000 [00:01<00:00, 1775.52it/s]warmup should be done:  82%|████████▏ | 2453/3000 [00:01<00:00, 1744.68it/s]warmup should be done:  84%|████████▍ | 2522/3000 [00:01<00:00, 1802.57it/s]warmup should be done:  82%|████████▏ | 2467/3000 [00:01<00:00, 1765.14it/s]warmup should be done:  89%|████████▊ | 2658/3000 [00:01<00:00, 1779.77it/s]warmup should be done:  88%|████████▊ | 2630/3000 [00:01<00:00, 1751.42it/s]warmup should be done:  90%|█████████ | 2703/3000 [00:01<00:00, 1800.36it/s]warmup should be done:  88%|████████▊ | 2646/3000 [00:01<00:00, 1771.71it/s]warmup should be done:  94%|█████████▎| 2810/3000 [00:01<00:00, 1763.36it/s]warmup should be done:  96%|█████████▌| 2884/3000 [00:01<00:00, 1799.08it/s]warmup should be done:  94%|█████████▍| 2826/3000 [00:01<00:00, 1777.52it/s]warmup should be done:  95%|█████████▍| 2836/3000 [00:01<00:00, 1707.60it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1791.86it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1756.77it/s]warmup should be done: 100%|█████████▉| 2988/3000 [00:01<00:00, 1766.11it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1755.63it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1748.98it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 182/3000 [00:00<00:01, 1813.17it/s]warmup should be done:   6%|▌         | 185/3000 [00:00<00:01, 1841.62it/s]warmup should be done:   6%|▌         | 183/3000 [00:00<00:01, 1820.93it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1742.23it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1799.02it/s]warmup should be done:  12%|█▏        | 372/3000 [00:00<00:01, 1854.01it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1823.39it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1820.52it/s]warmup should be done:  19%|█▊        | 559/3000 [00:00<00:01, 1859.35it/s]warmup should be done:  18%|█▊        | 551/3000 [00:00<00:01, 1833.14it/s]warmup should be done:  18%|█▊        | 549/3000 [00:00<00:01, 1821.49it/s]warmup should be done:  18%|█▊        | 539/3000 [00:00<00:01, 1730.95it/s]warmup should be done:  25%|██▍       | 746/3000 [00:00<00:01, 1861.03it/s]warmup should be done:  24%|██▍       | 732/3000 [00:00<00:01, 1780.14it/s]warmup should be done:  24%|██▍       | 735/3000 [00:00<00:01, 1788.26it/s]warmup should be done:  24%|██▍       | 722/3000 [00:00<00:01, 1766.48it/s]warmup should be done:  31%|███       | 933/3000 [00:00<00:01, 1862.89it/s]warmup should be done:  31%|███       | 917/3000 [00:00<00:01, 1798.46it/s]warmup should be done:  31%|███       | 916/3000 [00:00<00:01, 1799.04it/s]warmup should be done:  30%|███       | 902/3000 [00:00<00:01, 1777.90it/s]warmup should be done:  37%|███▋      | 1121/3000 [00:00<00:01, 1865.39it/s]warmup should be done:  37%|███▋      | 1102/3000 [00:00<00:01, 1813.13it/s]warmup should be done:  37%|███▋      | 1101/3000 [00:00<00:01, 1812.96it/s]warmup should be done:  36%|███▌      | 1084/3000 [00:00<00:01, 1789.05it/s]warmup should be done:  44%|████▎     | 1308/3000 [00:00<00:00, 1863.00it/s]warmup should be done:  43%|████▎     | 1284/3000 [00:00<00:00, 1816.79it/s]warmup should be done:  42%|████▏     | 1264/3000 [00:00<00:00, 1785.66it/s]warmup should be done:  43%|████▎     | 1284/3000 [00:00<00:00, 1774.46it/s]warmup should be done:  50%|████▉     | 1495/3000 [00:00<00:00, 1865.07it/s]warmup should be done:  49%|████▉     | 1470/3000 [00:00<00:00, 1827.53it/s]warmup should be done:  48%|████▊     | 1447/3000 [00:00<00:00, 1796.87it/s]warmup should be done:  49%|████▉     | 1463/3000 [00:00<00:00, 1779.19it/s]warmup should be done:  56%|█████▌    | 1683/3000 [00:00<00:00, 1867.04it/s]warmup should be done:  55%|█████▌    | 1655/3000 [00:00<00:00, 1833.63it/s]warmup should be done:  54%|█████▍    | 1630/3000 [00:00<00:00, 1805.25it/s]warmup should be done:  55%|█████▍    | 1643/3000 [00:00<00:00, 1782.50it/s]warmup should be done:  62%|██████▏   | 1870/3000 [00:01<00:00, 1867.55it/s]warmup should be done:  60%|██████    | 1812/3000 [00:01<00:00, 1809.67it/s]warmup should be done:  61%|██████    | 1822/3000 [00:01<00:00, 1784.74it/s]warmup should be done:  61%|██████▏   | 1839/3000 [00:01<00:00, 1796.52it/s]warmup should be done:  69%|██████▊   | 2057/3000 [00:01<00:00, 1867.28it/s]warmup should be done:  66%|██████▋   | 1994/3000 [00:01<00:00, 1812.79it/s]warmup should be done:  67%|██████▋   | 2001/3000 [00:01<00:00, 1785.26it/s]warmup should be done:  67%|██████▋   | 2024/3000 [00:01<00:00, 1809.65it/s]warmup should be done:  75%|███████▍  | 2244/3000 [00:01<00:00, 1866.25it/s]warmup should be done:  73%|███████▎  | 2176/3000 [00:01<00:00, 1813.93it/s]warmup should be done:  74%|███████▎  | 2209/3000 [00:01<00:00, 1820.75it/s]warmup should be done:  73%|███████▎  | 2180/3000 [00:01<00:00, 1756.83it/s]warmup should be done:  81%|████████  | 2431/3000 [00:01<00:00, 1865.33it/s]warmup should be done:  79%|███████▊  | 2358/3000 [00:01<00:00, 1814.59it/s]warmup should be done:  80%|███████▉  | 2394/3000 [00:01<00:00, 1827.81it/s]warmup should be done:  79%|███████▊  | 2360/3000 [00:01<00:00, 1768.62it/s]warmup should be done:  87%|████████▋ | 2618/3000 [00:01<00:00, 1865.70it/s]warmup should be done:  85%|████████▍ | 2540/3000 [00:01<00:00, 1805.02it/s]warmup should be done:  86%|████████▌ | 2579/3000 [00:01<00:00, 1833.97it/s]warmup should be done:  85%|████████▍ | 2540/3000 [00:01<00:00, 1775.54it/s]warmup should be done:  94%|█████████▎| 2805/3000 [00:01<00:00, 1866.47it/s]warmup should be done:  91%|█████████ | 2722/3000 [00:01<00:00, 1807.42it/s]warmup should be done:  92%|█████████▏| 2763/3000 [00:01<00:00, 1833.41it/s]warmup should be done:  91%|█████████ | 2718/3000 [00:01<00:00, 1754.29it/s]warmup should be done: 100%|█████████▉| 2992/3000 [00:01<00:00, 1867.42it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1864.48it/s]warmup should be done:  97%|█████████▋| 2903/3000 [00:01<00:00, 1805.80it/s]warmup should be done:  98%|█████████▊| 2947/3000 [00:01<00:00, 1832.48it/s]warmup should be done:  97%|█████████▋| 2898/3000 [00:01<00:00, 1765.02it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1820.65it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1797.14it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1781.31it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fa796741280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fa796741220>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fa796741130>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fa796a03df0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 22:45:39.819808: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fa369a67990 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:45:39.819904: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:45:39.827879: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:45:39.832762: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fa369a640c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:45:39.832803: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:45:39.839704: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fa369a682d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:45:39.839759: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:45:39.840873: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fa36d26ea50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:45:39.840907: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:45:39.841178: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:45:39.846695: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:45:39.847452: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:45:40.469929: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:45:40.500665: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:45:40.505707: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:45:40.523816: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:45:46.212966: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:45:46.526067: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:45:46.772412: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:45:46.791891: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][22:46:41.794][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][22:46:41.794][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][22:46:41.798][ERROR][RK0][main]: coll ps creation done
[HCTR][22:46:41.798][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][22:46:41.866][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][22:46:41.866][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][22:46:41.871][ERROR][RK0][main]: coll ps creation done
[HCTR][22:46:41.871][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][22:46:41.982][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][22:46:41.982][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][22:46:41.986][ERROR][RK0][main]: coll ps creation done
[HCTR][22:46:41.986][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][22:46:42.093][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][22:46:42.093][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][22:46:42.101][ERROR][RK0][main]: coll ps creation done
[HCTR][22:46:42.101][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][22:46:42.101][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][22:46:43.121][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][22:46:43.150][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][22:46:43.150][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][22:46:43.150][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][22:46:43.150][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][22:46:43.150][ERROR][RK0][main]: Calling build_v2
[HCTR][22:46:43.150][ERROR][RK0][main]: Calling build_v2
[HCTR][22:46:43.150][ERROR][RK0][main]: Calling build_v2
[HCTR][22:46:43.150][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:46:43.150][ERROR][RK0][main]: Calling build_v2
[HCTR][22:46:43.150][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:46:43.150][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:46:43.150][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2022-12-11 22:46:43.151458: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 0 to cpu
[[2022-12-11 22:46:43.2022-12-11 22:46:43151515.[: 1515292022-12-11 22:46:43[E: 2022-12-11 22:46:43. E.151550/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 151557: :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: E196:E ] 196 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 0 to cpu] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:
assigning 0 to cpu:212
196] ] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4assigning 0 to cpu

[2022-12-11 22:46:43.151722: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 22:46:43:.213[151730] 2022-12-11 22:46:43: remote time is 8.68421[.E
2022-12-11 22:46:43151747 .[: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc1517572022-12-11 22:46:43E:: . 212E151809/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc]  : :build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE212
: ] 212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4] :[
build symm link desc with 4X Tesla V100-SXM2-16GB out of 42142022-12-11 22:46:43
] .[cpu time is 301519062022-12-11 22:46:43[
: .2022-12-11 22:46:43E151940. : 151955/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: : E213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc ] :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421213:
] 213remote time is 8.68421[] 
2022-12-11 22:46:43remote time is 8.68421.
[1520752022-12-11 22:46:43[: .2022-12-11 22:46:43E152096. : 152105/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: : E214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc ] :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30214:
] 214cpu time is 30] 
cpu time is 30
[2022-12-11 22:47:09.109772: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 22:47:09.170415: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 22:47:09.302261: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 22:47:09.302325: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 22:47:09.302358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 22:47:09.302389: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 22:47:09.303096: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:47:09.303150: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:47:09.303980: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:47:09.304524: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:47:09.325710: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 22:47:09.325789: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 22:47:09.326174: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:47:09.326262: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:47:09.328396: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:47:09.328973: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:47:09.331838: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 22:47:09.331891: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 22:47:09.332353: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:47:09.332406: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:47:09.332713: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 22:47:09.332783: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 22:47:09.333199: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:47:09.333308: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:47:09.333378: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:47:09.334319: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:47:09.334425: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:47:09.335419: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:47:09.356619: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 22:47:09.358460: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 22:47:09.358523: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:47:09.359295: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:47:09.359773: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.360721: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.360768: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.52 MB
[2022-12-11 22:47:09.390667: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 22:47:09.392418: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 22:47:09.392463: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:47:09.393195: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:47:09.393564: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.394500: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.394543: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.52 MB
[2022-12-11 22:47:09.399727: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 22:47:09.401486: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 22:47:09.401531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:47:09.402256: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:47:09.402657: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.403600: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.403642: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.52 MB
[2022-12-11 22:47:09.412683: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:47:09.413269: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:47:09.413312: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[2022-12-11 22:47:09.433881: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 22:47:09.[4356112022-12-11 22:47:09: .E435631 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager alloc mem 25.25 KB638
] eager release cuda mem 5
[2022-12-11 22:47:09.435714: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:47:09.436228: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:47:09.436269: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[2022-12-11 22:47:09.436426: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 30.90 MB
[2022-12-11 22:47:09.441028: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.441948: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.441989: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 30.52 MB
[2022-12-11 22:47:09.444552: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:47:09.445147: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:47:09.445189: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[2022-12-11 22:47:09.479236: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:47:09.479804: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:47:09.479845: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 3.82 GB
[[[2022-12-11 22:47:09[2022-12-11 22:47:092022-12-11 22:47:09.2022-12-11 22:47:09..824603.824599824599: 824600: : E: EE E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::1926:19261926] 1926] ] Device 0 init p2p of link 1] Device 2 init p2p of link 3Device 1 init p2p of link 2
Device 3 init p2p of link 0


[2022-12-11 22:47:09.824914: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.824950: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.825086: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.825273: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.825707: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.825756: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.825901: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.826075: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.831818: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-11 22:47:091926.] 831877Device 2 init p2p of link 0: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-11 22:47:09.832002: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.832028: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.832370: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926[] 2022-12-11 22:47:09Device 0 init p2p of link 2.
832370: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] [Device 3 init p2p of link 12022-12-11 22:47:09
.832498: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.832646: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.832797: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.832902: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.833302: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.833553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.838293: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 22:47:09.838389: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.839191: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.839638: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 22:47:09.839724: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.839803: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 22:47:09.839892: [E2022-12-11 22:47:09 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu839912:: 1926E]  Device 0 init p2p of link 3/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.840014: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:47:09.840507: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.840741: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.840807: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:47:09.843770: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:47:09.844046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 7999999 / 100000000 nodes ( 8.00 %~8.00 %) | remote 23999997 / 100000000 nodes ( 24.00 %) | cpu 68000004 / 100000000 nodes ( 68.00 %) | 3.82 GB | 0.511656 secs 
[2022-12-11 22:47:09.845663: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:47:09.845912: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 7999999 / 100000000 nodes ( 8.00 %~8.00 %) | remote 23999997 / 100000000 nodes ( 24.00 %) | cpu 68000004 / 100000000 nodes ( 68.00 %) | 3.82 GB | 0.512547 secs 
[2022-12-11 22:47:09.846044: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:47:09.846110: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 32399996
[2022-12-11 22:47:09.846371: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 7999999 / 100000000 nodes ( 8.00 %~8.00 %) | remote 23999997 / 100000000 nodes ( 24.00 %) | cpu 68000004 / 100000000 nodes ( 68.00 %) | 3.82 GB | 0.520124 secs 
[2022-12-11 22:47:09.846522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 7999999 / 100000000 nodes ( 8.00 %~8.00 %) | remote 23999997 / 100000000 nodes ( 24.00 %) | cpu 68000004 / 100000000 nodes ( 68.00 %) | 3.82 GB | 0.543386 secs 
[HCTR][22:47:09.846][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][22:47:09.846][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][22:47:09.846][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][22:47:09.846][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][22:47:09.846][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][22:47:09.846][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][22:47:09.846][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][22:47:09.846][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][22:47:09.846][ERROR][RK0][main]: init per replica done
[HCTR][22:47:09.846][ERROR][RK0][main]: init per replica done
[HCTR][22:47:09.846][ERROR][RK0][main]: init per replica done
[HCTR][22:47:09.849][ERROR][RK0][main]: init per replica done
