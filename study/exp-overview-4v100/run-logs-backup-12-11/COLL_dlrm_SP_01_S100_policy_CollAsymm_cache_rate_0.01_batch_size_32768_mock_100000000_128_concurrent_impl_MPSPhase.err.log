2022-12-11 19:21:39.246306: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:21:39.320916: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:21:39.322174: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:21:39.322174: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 19:21:40.104763: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:21:40.104844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 19:21:40.117321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 19:21:40.149433: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:21:40.149751: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:21:40.152703: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 19:21:40.183215: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:21:40.183293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 19:21:40.184537: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:21:40.184585: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 19:21:40.184616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 19:21:40.184644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 19:21:40.195788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 19:21:40.197825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 19:21:40.198928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 19:21:40.226617: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:21:40.226809: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:21:40.228343: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 19:21:40.229458: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:21:40.229669: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:21:40.230579: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:21:40.230757: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 19:21:40.231849: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 19:21:40.232519: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
[HCTR][19:21:40.513][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:21:41.485][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:21:41.488][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][19:21:41.488][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 102it [00:01, 91.82it/s]warmup run: 204it [00:01, 197.84it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 307it [00:01, 314.14it/s]warmup run: 103it [00:01, 93.37it/s]warmup run: 409it [00:01, 431.70it/s]warmup run: 196it [00:01, 189.45it/s]warmup run: 511it [00:01, 544.68it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 300it [00:01, 309.32it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 614it [00:02, 649.21it/s]warmup run: 102it [00:01, 91.82it/s]warmup run: 408it [00:01, 437.93it/s]warmup run: 108it [00:01, 98.55it/s]warmup run: 717it [00:02, 738.50it/s]warmup run: 210it [00:01, 204.59it/s]warmup run: 517it [00:01, 562.94it/s]warmup run: 209it [00:01, 203.81it/s]warmup run: 821it [00:02, 813.09it/s]warmup run: 315it [00:01, 322.97it/s]warmup run: 628it [00:02, 680.69it/s]warmup run: 314it [00:01, 323.63it/s]warmup run: 924it [00:02, 869.67it/s]warmup run: 420it [00:01, 443.79it/s]warmup run: 738it [00:02, 778.65it/s]warmup run: 419it [00:01, 445.57it/s]warmup run: 1027it [00:02, 913.01it/s]warmup run: 526it [00:01, 561.16it/s]warmup run: 843it [00:02, 841.11it/s]warmup run: 526it [00:01, 566.51it/s]warmup run: 1131it [00:02, 947.52it/s]warmup run: 625it [00:02, 651.96it/s]warmup run: 952it [00:02, 906.43it/s]warmup run: 636it [00:02, 682.05it/s]warmup run: 1235it [00:02, 972.82it/s]warmup run: 735it [00:02, 755.36it/s]warmup run: 1062it [00:02, 958.16it/s]warmup run: 746it [00:02, 779.62it/s]warmup run: 1338it [00:02, 985.79it/s]warmup run: 839it [00:02, 826.31it/s]warmup run: 1169it [00:02, 988.58it/s]warmup run: 854it [00:02, 854.85it/s]warmup run: 1446it [00:02, 1011.55it/s]warmup run: 943it [00:02, 880.65it/s]warmup run: 1276it [00:02, 997.02it/s]warmup run: 962it [00:02, 913.35it/s]warmup run: 1550it [00:02, 1019.21it/s]warmup run: 1049it [00:02, 929.51it/s]warmup run: 1382it [00:02, 1012.36it/s]warmup run: 1070it [00:02, 957.71it/s]warmup run: 1656it [00:03, 1028.75it/s]warmup run: 1155it [00:02, 965.40it/s]warmup run: 1488it [00:02, 1025.33it/s]warmup run: 1177it [00:02, 989.15it/s]warmup run: 1761it [00:03, 1030.90it/s]warmup run: 1260it [00:02, 988.09it/s]warmup run: 1594it [00:02, 1030.11it/s]warmup run: 1286it [00:02, 1015.44it/s]warmup run: 1866it [00:03, 1034.44it/s]warmup run: 1367it [00:02, 1009.11it/s]warmup run: 1704it [00:03, 1048.66it/s]warmup run: 1394it [00:02, 1012.69it/s]warmup run: 1973it [00:03, 1044.00it/s]warmup run: 1474it [00:02, 1026.15it/s]warmup run: 1811it [00:03, 1051.40it/s]warmup run: 1507it [00:02, 1044.32it/s]warmup run: 2099it [00:03, 1107.69it/s]warmup run: 1580it [00:02, 1035.41it/s]warmup run: 1919it [00:03, 1058.86it/s]warmup run: 1615it [00:02, 1044.82it/s]warmup run: 2232it [00:03, 1172.20it/s]warmup run: 1690it [00:03, 1053.23it/s]warmup run: 2032it [00:03, 1079.44it/s]warmup run: 1724it [00:03, 1057.39it/s]warmup run: 2365it [00:03, 1217.91it/s]warmup run: 1799it [00:03, 1062.66it/s]warmup run: 2167it [00:03, 1159.97it/s]warmup run: 1832it [00:03, 1058.26it/s]warmup run: 2490it [00:03, 1226.97it/s]warmup run: 1907it [00:03, 1063.61it/s]warmup run: 2303it [00:03, 1217.67it/s]warmup run: 1939it [00:03, 1055.96it/s]warmup run: 2623it [00:03, 1257.69it/s]warmup run: 2018it [00:03, 1075.02it/s]warmup run: 2439it [00:03, 1259.16it/s]warmup run: 2049it [00:03, 1067.02it/s]warmup run: 2756it [00:03, 1277.47it/s]warmup run: 2151it [00:03, 1150.51it/s]warmup run: 2574it [00:03, 1285.03it/s]warmup run: 2182it [00:03, 1144.29it/s]warmup run: 2889it [00:04, 1291.83it/s]warmup run: 2285it [00:03, 1206.98it/s]warmup run: 2708it [00:03, 1300.27it/s]warmup run: 3000it [00:04, 724.40it/s] warmup run: 2317it [00:03, 1203.49it/s]warmup run: 2412it [00:03, 1224.38it/s]warmup run: 2845it [00:03, 1319.74it/s]warmup run: 2450it [00:03, 1240.57it/s]warmup run: 2548it [00:03, 1262.45it/s]warmup run: 2982it [00:04, 1333.29it/s]warmup run: 3000it [00:04, 737.74it/s] warmup run: 2579it [00:03, 1252.74it/s]warmup run: 2679it [00:03, 1275.72it/s]warmup run: 2714it [00:03, 1280.34it/s]warmup run: 2813it [00:03, 1293.60it/s]warmup run: 2850it [00:03, 1303.37it/s]warmup run: 2947it [00:04, 1305.80it/s]warmup run: 3000it [00:04, 731.90it/s] warmup run: 2986it [00:04, 1317.97it/s]warmup run: 3000it [00:04, 739.14it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1748.67it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1679.86it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1733.69it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1661.23it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1771.47it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1744.60it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1776.76it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1710.58it/s]warmup should be done:  18%|█▊        | 525/3000 [00:00<00:01, 1758.45it/s]warmup should be done:  18%|█▊        | 532/3000 [00:00<00:01, 1770.00it/s]warmup should be done:  18%|█▊        | 535/3000 [00:00<00:01, 1785.31it/s]warmup should be done:  17%|█▋        | 514/3000 [00:00<00:01, 1632.12it/s]warmup should be done:  23%|██▎       | 702/3000 [00:00<00:01, 1761.42it/s]warmup should be done:  24%|██▎       | 710/3000 [00:00<00:01, 1771.62it/s]warmup should be done:  24%|██▍       | 716/3000 [00:00<00:01, 1791.59it/s]warmup should be done:  23%|██▎       | 695/3000 [00:00<00:01, 1699.07it/s]warmup should be done:  29%|██▉       | 880/3000 [00:00<00:01, 1765.27it/s]warmup should be done:  30%|██▉       | 888/3000 [00:00<00:01, 1770.89it/s]warmup should be done:  30%|██▉       | 896/3000 [00:00<00:01, 1792.51it/s]warmup should be done:  29%|██▉       | 875/3000 [00:00<00:01, 1732.60it/s]warmup should be done:  35%|███▌      | 1057/3000 [00:00<00:01, 1764.96it/s]warmup should be done:  36%|███▌      | 1076/3000 [00:00<00:01, 1789.11it/s]warmup should be done:  36%|███▌      | 1066/3000 [00:00<00:01, 1767.39it/s]warmup should be done:  35%|███▌      | 1055/3000 [00:00<00:01, 1754.16it/s]warmup should be done:  41%|████      | 1235/3000 [00:00<00:00, 1768.60it/s]warmup should be done:  42%|████▏     | 1255/3000 [00:00<00:00, 1787.77it/s]warmup should be done:  41%|████▏     | 1244/3000 [00:00<00:00, 1768.28it/s]warmup should be done:  41%|████      | 1235/3000 [00:00<00:00, 1766.08it/s]warmup should be done:  47%|████▋     | 1413/3000 [00:00<00:00, 1770.80it/s]warmup should be done:  48%|████▊     | 1434/3000 [00:00<00:00, 1787.73it/s]warmup should be done:  47%|████▋     | 1421/3000 [00:00<00:00, 1766.04it/s]warmup should be done:  47%|████▋     | 1414/3000 [00:00<00:00, 1772.89it/s]warmup should be done:  53%|█████▎    | 1591/3000 [00:00<00:00, 1766.89it/s]warmup should be done:  54%|█████▍    | 1614/3000 [00:00<00:00, 1790.07it/s]warmup should be done:  53%|█████▎    | 1598/3000 [00:00<00:00, 1762.85it/s]warmup should be done:  53%|█████▎    | 1595/3000 [00:00<00:00, 1782.20it/s]warmup should be done:  59%|█████▉    | 1769/3000 [00:01<00:00, 1769.63it/s]warmup should be done:  60%|█████▉    | 1794/3000 [00:01<00:00, 1791.67it/s]warmup should be done:  59%|█████▉    | 1775/3000 [00:01<00:00, 1761.71it/s]warmup should be done:  59%|█████▉    | 1775/3000 [00:01<00:00, 1787.33it/s]warmup should be done:  65%|██████▍   | 1947/3000 [00:01<00:00, 1770.74it/s]warmup should be done:  66%|██████▌   | 1974/3000 [00:01<00:00, 1789.96it/s]warmup should be done:  65%|██████▌   | 1952/3000 [00:01<00:00, 1759.61it/s]warmup should be done:  65%|██████▌   | 1955/3000 [00:01<00:00, 1790.65it/s]warmup should be done:  71%|███████   | 2126/3000 [00:01<00:00, 1773.65it/s]warmup should be done:  72%|███████▏  | 2154/3000 [00:01<00:00, 1791.18it/s]warmup should be done:  71%|███████   | 2128/3000 [00:01<00:00, 1759.20it/s]warmup should be done:  71%|███████   | 2136/3000 [00:01<00:00, 1794.34it/s]warmup should be done:  78%|███████▊  | 2334/3000 [00:01<00:00, 1791.30it/s]warmup should be done:  77%|███████▋  | 2304/3000 [00:01<00:00, 1768.92it/s]warmup should be done:  77%|███████▋  | 2304/3000 [00:01<00:00, 1756.80it/s]warmup should be done:  77%|███████▋  | 2317/3000 [00:01<00:00, 1796.88it/s]warmup should be done:  84%|████████▍ | 2515/3000 [00:01<00:00, 1796.49it/s]warmup should be done:  83%|████████▎ | 2483/3000 [00:01<00:00, 1774.33it/s]warmup should be done:  83%|████████▎ | 2482/3000 [00:01<00:00, 1761.70it/s]warmup should be done:  83%|████████▎ | 2499/3000 [00:01<00:00, 1801.85it/s]warmup should be done:  90%|████████▉ | 2695/3000 [00:01<00:00, 1796.49it/s]warmup should be done:  89%|████████▊ | 2661/3000 [00:01<00:00, 1775.71it/s]warmup should be done:  89%|████████▊ | 2659/3000 [00:01<00:00, 1761.43it/s]warmup should be done:  89%|████████▉ | 2680/3000 [00:01<00:00, 1803.54it/s]warmup should be done:  96%|█████████▌| 2875/3000 [00:01<00:00, 1797.42it/s]warmup should be done:  95%|█████████▍| 2839/3000 [00:01<00:00, 1776.70it/s]warmup should be done:  95%|█████████▍| 2836/3000 [00:01<00:00, 1761.69it/s]warmup should be done:  95%|█████████▌| 2861/3000 [00:01<00:00, 1804.85it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1791.00it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1772.57it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1768.45it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1763.41it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1748.05it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1777.93it/s]warmup should be done:   6%|▌         | 182/3000 [00:00<00:01, 1812.99it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1831.26it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1789.57it/s]warmup should be done:  12%|█▏        | 364/3000 [00:00<00:01, 1823.13it/s]warmup should be done:  12%|█▏        | 364/3000 [00:00<00:01, 1809.34it/s]warmup should be done:  12%|█▏        | 368/3000 [00:00<00:01, 1678.98it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1817.99it/s]warmup should be done:  18%|█▊        | 550/3000 [00:00<00:01, 1836.88it/s]warmup should be done:  18%|█▊        | 547/3000 [00:00<00:01, 1815.26it/s]warmup should be done:  18%|█▊        | 550/3000 [00:00<00:01, 1739.05it/s]warmup should be done:  24%|██▍       | 726/3000 [00:00<00:01, 1820.85it/s]warmup should be done:  25%|██▍       | 736/3000 [00:00<00:01, 1842.70it/s]warmup should be done:  24%|██▍       | 730/3000 [00:00<00:01, 1817.80it/s]warmup should be done:  24%|██▍       | 734/3000 [00:00<00:01, 1775.92it/s]warmup should be done:  30%|███       | 910/3000 [00:00<00:01, 1826.39it/s]warmup should be done:  31%|███       | 921/3000 [00:00<00:01, 1843.50it/s]warmup should be done:  30%|███       | 912/3000 [00:00<00:01, 1817.83it/s]warmup should be done:  31%|███       | 919/3000 [00:00<00:01, 1800.76it/s]warmup should be done:  36%|███▋      | 1095/3000 [00:00<00:01, 1831.39it/s]warmup should be done:  37%|███▋      | 1107/3000 [00:00<00:01, 1847.57it/s]warmup should be done:  36%|███▋      | 1095/3000 [00:00<00:01, 1821.41it/s]warmup should be done:  37%|███▋      | 1105/3000 [00:00<00:01, 1819.69it/s]warmup should be done:  43%|████▎     | 1279/3000 [00:00<00:00, 1829.35it/s]warmup should be done:  43%|████▎     | 1292/3000 [00:00<00:00, 1845.21it/s]warmup should be done:  43%|████▎     | 1278/3000 [00:00<00:00, 1820.18it/s]warmup should be done:  43%|████▎     | 1290/3000 [00:00<00:00, 1827.03it/s]warmup should be done:  49%|████▉     | 1464/3000 [00:00<00:00, 1835.36it/s]warmup should be done:  49%|████▉     | 1478/3000 [00:00<00:00, 1847.79it/s]warmup should be done:  49%|████▊     | 1462/3000 [00:00<00:00, 1825.16it/s]warmup should be done:  49%|████▉     | 1477/3000 [00:00<00:00, 1837.62it/s]warmup should be done:  55%|█████▌    | 1650/3000 [00:00<00:00, 1841.08it/s]warmup should be done:  55%|█████▌    | 1663/3000 [00:00<00:00, 1846.25it/s]warmup should be done:  55%|█████▍    | 1646/3000 [00:00<00:00, 1826.82it/s]warmup should be done:  55%|█████▌    | 1663/3000 [00:00<00:00, 1843.69it/s]warmup should be done:  61%|██████    | 1835/3000 [00:01<00:00, 1839.71it/s]warmup should be done:  62%|██████▏   | 1848/3000 [00:01<00:00, 1844.93it/s]warmup should be done:  61%|██████    | 1830/3000 [00:01<00:00, 1828.74it/s]warmup should be done:  62%|██████▏   | 1848/3000 [00:01<00:00, 1807.32it/s]warmup should be done:  67%|██████▋   | 2019/3000 [00:01<00:00, 1838.34it/s]warmup should be done:  67%|██████▋   | 2013/3000 [00:01<00:00, 1827.74it/s]warmup should be done:  68%|██████▊   | 2033/3000 [00:01<00:00, 1842.70it/s]warmup should be done:  68%|██████▊   | 2032/3000 [00:01<00:00, 1816.48it/s]warmup should be done:  73%|███████▎  | 2196/3000 [00:01<00:00, 1827.44it/s]warmup should be done:  73%|███████▎  | 2203/3000 [00:01<00:00, 1834.36it/s]warmup should be done:  74%|███████▍  | 2218/3000 [00:01<00:00, 1823.21it/s]warmup should be done:  74%|███████▍  | 2216/3000 [00:01<00:00, 1823.10it/s]warmup should be done:  79%|███████▉  | 2379/3000 [00:01<00:00, 1827.39it/s]warmup should be done:  80%|███████▉  | 2387/3000 [00:01<00:00, 1833.90it/s]warmup should be done:  80%|████████  | 2402/3000 [00:01<00:00, 1826.34it/s]warmup should be done:  80%|████████  | 2400/3000 [00:01<00:00, 1827.31it/s]warmup should be done:  85%|████████▌ | 2563/3000 [00:01<00:00, 1828.20it/s]warmup should be done:  86%|████████▌ | 2572/3000 [00:01<00:00, 1835.70it/s]warmup should be done:  86%|████████▌ | 2586/3000 [00:01<00:00, 1829.53it/s]warmup should be done:  86%|████████▌ | 2586/3000 [00:01<00:00, 1835.63it/s]warmup should be done:  92%|█████████▏| 2747/3000 [00:01<00:00, 1828.74it/s]warmup should be done:  92%|█████████▏| 2757/3000 [00:01<00:00, 1838.03it/s]warmup should be done:  92%|█████████▏| 2771/3000 [00:01<00:00, 1835.55it/s]warmup should be done:  92%|█████████▏| 2773/3000 [00:01<00:00, 1843.30it/s]warmup should be done:  98%|█████████▊| 2941/3000 [00:01<00:00, 1838.31it/s]warmup should be done:  98%|█████████▊| 2931/3000 [00:01<00:00, 1829.71it/s]warmup should be done:  99%|█████████▊| 2957/3000 [00:01<00:00, 1840.11it/s]warmup should be done:  99%|█████████▊| 2960/3000 [00:01<00:00, 1849.55it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1837.52it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1831.02it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1824.62it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1819.94it/s]2022-12-11 19:22:56.521909: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7ff19626a750 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:22:56.521973: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:22:58.136915: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:22:59.264305: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:23:00.694932: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:23:16.798112: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7ff196267ce0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:23:16.798174: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:23:17.715585: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7ff196267860 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:23:17.715648: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:23:18.043997: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7ff1a2a64850 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 19:23:18.044058: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 19:23:19.405125: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:23:21.451161: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:23:22.221957: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:23:22.725779: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 19:23:23.368186: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:23:23.859026: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:23:24.587859: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 19:23:25.286731: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 19:23:25.874852: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][19:24:04.963][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][19:24:04.963][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:24:04.965][ERROR][RK0][tid #140676167603968]: replica 3 reaches 1000, calling init pre replica
[HCTR][19:24:04.966][ERROR][RK0][tid #140676167603968]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:24:04.968][ERROR][RK0][main]: coll ps creation done
[HCTR][19:24:04.968][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][19:24:04.970][ERROR][RK0][tid #140676167603968]: coll ps creation done
[HCTR][19:24:04.970][ERROR][RK0][tid #140676167603968]: replica 3 waits for coll ps creation barrier
[HCTR][19:24:05.078][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][19:24:05.078][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:24:05.083][ERROR][RK0][main]: coll ps creation done
[HCTR][19:24:05.083][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][19:24:05.167][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][19:24:05.167][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][19:24:05.172][ERROR][RK0][main]: coll ps creation done
[HCTR][19:24:05.172][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][19:24:05.172][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][19:24:06.125][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][19:24:06.153][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][19:24:06.153][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][19:24:06.153][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][19:24:06.153][ERROR][RK0][tid #140676167603968]: replica 3 calling init per replica
[HCTR][19:24:06.153][ERROR][RK0][main]: Calling build_v2
[HCTR][19:24:06.153][ERROR][RK0][main]: Calling build_v2
[HCTR][19:24:06.153][ERROR][RK0][main]: Calling build_v2
[HCTR][19:24:06.153][ERROR][RK0][tid #140676167603968]: Calling build_v2
[HCTR][19:24:06.153][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:24:06.153][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:24:06.153][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][19:24:06.153][ERROR][RK0][tid #140676167603968]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[[2022-12-11 19:24:06.2022-12-11 19:24:061535422022-12-11 19:24:062022-12-11 19:24:06.: ..153542E153542153552:  : : E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccEE :  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:] ::136using concurrent impl MPSPhase136136] 
] ] using concurrent impl MPSPhaseusing concurrent impl MPSPhaseusing concurrent impl MPSPhase


[2022-12-11 19:24:06.154707: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-11 19:24:06.154731: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[[
2022-12-11 19:24:062022-12-11 19:24:06..154757154756: [: E2022-12-11 19:24:06E .[ /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc1547782022-12-11 19:24:06/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:: .:196E154790212]  : ] assigning 8 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccEbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4
: 
196/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :assigning 8 to cpu212[
] 2022-12-11 19:24:06build symm link desc with 4X Tesla V100-SXM2-16GB out of 4[.
2022-12-11 19:24:06154864.: 154871E:  [E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 19:24:06 :./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[213154895:2022-12-11 19:24:06] : 212.remote time is 8.68421E] 154895
 build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
[E:2022-12-11 19:24:06 213./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[] 154949:2022-12-11 19:24:06remote time is 8.68421: 212.
E] 154963 build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
E2022-12-11 19:24:06: .214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc154994[] :: 2022-12-11 19:24:06cpu time is 30213E.
]  155015remote time is 8.68421/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 
:E214 ] [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 302022-12-11 19:24:06:
.213155060] : remote time is 8.68421E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 19:24:06214.] 155096cpu time is 30: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 19:24:32.280427: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 19:24:32.344113: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 19:24:32.344220: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-11 19:24:32.345319: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-11 19:24:32.438786: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-11 19:24:32.813617: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-11 19:24:32.813693: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-11 19:24:40.180428: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-11 19:24:40.180523: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-11 19:24:41.930207: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-11 19:24:41.930334: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-11 19:24:41.943546: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 19:24:41.943634: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-11 19:24:41.976367: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-11 19:24:41.989569: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-11 19:24:41.990333: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-11 19:24:42.   639: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-11 19:24:42. 97104: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-11 19:24:42. 99859: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-11 19:24:42.102297: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-11 19:24:42.104700: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-11 19:24:42.107086: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-11 19:24:44.311811: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-11 19:24:44.315815: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-11 19:24:44.315968: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-11 19:24:44.324166: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 19:24:44.324275: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 19:24:44.324316: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 19:24:44.324360: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 19:24:44.329096: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:24:44.329157: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:24:44.331081: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:24:44.331790: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:24:44.346259: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-11 19:24:44.346369: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-11 19:24:44.348146: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 19:24:44.348228: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] [worker 0 thread 2 initing device 2
2022-12-11 19:24:44.348144: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-11 19:24:44.348292: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-11 19:24:44.350218: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:24:44.350305: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:24:44.351026: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:24:44.351107: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:24:44.351392: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:24:44.352342: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:24:44.352576: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:24:44.353470: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:24:44.353534: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 19:24:44.353618: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:24:44.354805: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:24:44.355502: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 19:24:44.386689: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 19:24:44.389542: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 19:24:44.389652: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:24:44.390585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:24:44.391545: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:24:44.392498: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:24:44.394525: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:24:44.395202: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:24:44.395268: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 492.90 MB
[2022-12-11 19:24:44.410520: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-11 19:24:44.412535: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 19:24:44.412596: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:24:44.413419: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:24:44.414282: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:24:44.415252: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:24:44.417449: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 19:24:44.418119: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:24:44.418161: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 492.54 MB
[[2022-12-11 19:24:442022-12-11 19:24:44..442476442476: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-11 19:24:44.444356: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 19:24:44:.638444370] : eager release cuda mem 1021E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-11 19:24:44.444419: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:24:44.444442: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 19:24:44.445242: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:24:44.445721: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 4.20 MB
[2022-12-11 19:24:44.446533: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:24:44.447349: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:24:44.447443: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:24:44.448249: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:24:44.451086: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[[2022-12-11 19:24:442022-12-11 19:24:44..451741451735: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::6381980] ] eager release cuda mem 25855eager alloc mem 25.25 KB

[2022-12-11 19:24:44.451810: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 493.08 MB
[2022-12-11 19:24:44.452405: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 19:24:44.452446: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 493.16 MB
[[[2022-12-11 19:24:442022-12-11 19:24:44[2022-12-11 19:24:44..2022-12-11 19:24:44.496162496160.496161: : 496173: EE: E  E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:19261926:1926] ] 1926] Device 3 init p2p of link 0Device 1 init p2p of link 2] Device 2 init p2p of link 3

Device 0 init p2p of link 1

[2022-12-11 19:24:44.496365[: 2022-12-11 19:24:44E. 496373/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1980 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB:
1980] [eager alloc mem 611.00 KB[2022-12-11 19:24:44
2022-12-11 19:24:44..496410496414: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[2022-12-11 19:24:44.497196: E[ 2022-12-11 19:24:44/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:497207638: ] Eeager release cuda mem 625663 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:24:44.497256[: 2022-12-11 19:24:44E. 497264/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :E638 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 625663:
638] eager release cuda mem 625663
[2022-12-11 19:24:44.498945: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-11 19:24:44.499035: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-11 19:24:44[2022-12-11 19:24:44.2022-12-11 19:24:44.499210.499215: 499221: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926:1926] 1926] Device 2 init p2p of link 0] Device 0 init p2p of link 2
Device 1 init p2p of link 3

[2022-12-11 19:24:44[.2022-12-11 19:24:44[499358.2022-12-11 19:24:44: 499360.E: 499365 E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu E:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu 1980:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] 1980:eager alloc mem 611.00 KB] 1980
eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KB
[2022-12-11 19:24:44.499840: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[[2022-12-11 19:24:442022-12-11 19:24:44.[.5002082022-12-11 19:24:44500209: .: E500216E :  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638] :] eager release cuda mem 625663638eager release cuda mem 625663
] 
eager release cuda mem 625663
[2022-12-11 19:24:44.500780: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 19:24:44.500862: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:24:44.501663: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:24:44.501834: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-11 19:24:44.501912: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 19:24:44.[5019822022-12-11 19:24:44: .E501990 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1926/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :Device 2 init p2p of link 11926
] Device 0 init p2p of link 3
[2022-12-11 19:24:44.[5020902022-12-11 19:24:44: .E502094 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 611.00 KB1980
] eager alloc mem 611.00 KB
[2022-12-11 19:24:44.502561: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:24:44.502720: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:24:44.502908: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:[6382022-12-11 19:24:44] .eager release cuda mem 625663502927
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 19:24:44.503132: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 999819 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2998190 / 100000000 nodes ( 3.00 %) | cpu 96001991 / 100000000 nodes ( 96.00 %) | 493.08 MB | 0.152051 secs 
[2022-12-11 19:24:44.504618: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:24:44.504689: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:2022-12-11 19:24:44638.] 504710eager release cuda mem 4399996: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 4399996
[2022-12-11 19:24:44.505172: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 1000000 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2998009 / 100000000 nodes ( 3.00 %) | cpu 96001991 / 100000000 nodes ( 96.00 %) | 493.16 MB | 0.154899 secs 
[2022-12-11 19:24:44.505720: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 999469 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2998540 / 100000000 nodes ( 3.00 %) | cpu 96001991 / 100000000 nodes ( 96.00 %) | 492.90 MB | 0.176572 secs 
[2022-12-11 19:24:44.506115: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 998721 / 100000000 nodes ( 1.00 %~1.00 %) | remote 2999288 / 100000000 nodes ( 3.00 %) | cpu 96001991 / 100000000 nodes ( 96.00 %) | 492.54 MB | 0.152536 secs 
[2022-12-11 19:24:44.506231: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 5.51 GB
[2022-12-11 19:24:45.467198: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 5.76 GB
[2022-12-11 19:24:45.467370: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 5.76 GB
[2022-12-11 19:24:45.467708: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 5.76 GB
[2022-12-11 19:24:46.451591: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 6.00 GB
[2022-12-11 19:24:46.452166: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 6.00 GB
[2022-12-11 19:24:46.452551: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 6.00 GB
[2022-12-11 19:24:47.181349: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 6.25 GB
[2022-12-11 19:24:47.181477: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 6.25 GB
[2022-12-11 19:24:47.181765: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 6.25 GB
[2022-12-11 19:24:47.181910: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 6.25 GB
[2022-12-11 19:24:47.182295: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 6.25 GB
[2022-12-11 19:24:48.144350: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 6.44 GB
[2022-12-11 19:24:48.144503: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 6.44 GB
[HCTR][19:24:48.187][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][19:24:48.187][ERROR][RK0][tid #140676167603968]: replica 3 calling init per replica done, doing barrier
[HCTR][19:24:48.187][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][19:24:48.187][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][19:24:48.187][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][19:24:48.187][ERROR][RK0][tid #140676167603968]: replica 3 calling init per replica done, doing barrier done
[HCTR][19:24:48.187][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][19:24:48.187][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][19:24:48.188][ERROR][RK0][tid #140676167603968]: init per replica done
[HCTR][19:24:48.188][ERROR][RK0][main]: init per replica done
[HCTR][19:24:48.188][ERROR][RK0][main]: init per replica done
[HCTR][19:24:48.190][ERROR][RK0][main]: init per replica done
[HCTR][19:24:48.196][ERROR][RK0][main]: 2 allocated 3276800 at 0x7ff325520000
[HCTR][19:24:48.196][ERROR][RK0][main]: 2 allocated 6553600 at 0x7fdb52000000
[HCTR][19:24:48.196][ERROR][RK0][main]: 2 allocated 3276800 at 0x7fdb52640000
[HCTR][19:24:48.196][ERROR][RK0][main]: 2 allocated 6553600 at 0x7fdb52960000
[HCTR][19:24:48.199][ERROR][RK0][tid #140676167603968]: 3 allocated 3276800 at 0x7ff327520000
[HCTR][19:24:48.199][ERROR][RK0][tid #140676167603968]: 3 allocated 6553600 at 0x7fdb6e000000
[HCTR][19:24:48.199][ERROR][RK0][tid #140676167603968]: 3 allocated 3276800 at 0x7fdb6e640000
[HCTR][19:24:48.199][ERROR][RK0][tid #140676167603968]: 3 allocated 6553600 at 0x7fdb6e960000
[HCTR][19:24:48.200][ERROR][RK0][main]: 0 allocated 3276800 at 0x7fdb72320000
[HCTR][19:24:48.200][ERROR][RK0][main]: 0 allocated 6553600 at 0x7fdb72800000
[HCTR][19:24:48.200][ERROR][RK0][main]: 0 allocated 3276800 at 0x7fdb7350e800
[HCTR][19:24:48.200][ERROR][RK0][main]: 0 allocated 6553600 at 0x7fdb7382e800
[HCTR][19:24:48.204][ERROR][RK0][tid #140676167603968]: 1 allocated 3276800 at 0x7ff325520000
[HCTR][19:24:48.204][ERROR][RK0][tid #140676167603968]: 1 allocated 6553600 at 0x7fdb8a000000
[HCTR][19:24:48.204][ERROR][RK0][tid #140676167603968]: 1 allocated 3276800 at 0x7fdb8a640000
[HCTR][19:24:48.204][ERROR][RK0][tid #140676167603968]: 1 allocated 6553600 at 0x7fdb8a960000




