2022-12-12 00:43:46.470257: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:43:46.473381: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:43:46.483217: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:43:46.521753: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:43:47.453412: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:43:47.453495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 00:43:47.454220: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:43:47.454276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 00:43:47.454290: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:43:47.454341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 00:43:47.467719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 00:43:47.469930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 00:43:47.471271: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:43:47.471327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 00:43:47.471610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 00:43:47.484554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 00:43:47.498735: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:43:47.498933: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:43:47.500473: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 00:43:47.504758: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:43:47.504918: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:43:47.505792: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:43:47.505909: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:43:47.506321: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 00:43:47.507304: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 00:43:47.518758: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:43:47.518946: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:43:47.520632: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][00:43:48.762][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:43:48.762][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:43:48.791][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:43:48.806][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 99it [00:01, 89.50it/s]warmup run: 210it [00:01, 206.51it/s]warmup run: 1it [00:01,  1.45s/it]warmup run: 313it [00:01, 322.16it/s]warmup run: 110it [00:01, 98.61it/s]warmup run: 419it [00:01, 445.04it/s]warmup run: 220it [00:01, 212.54it/s]warmup run: 524it [00:01, 560.56it/s]warmup run: 332it [00:01, 339.15it/s]warmup run: 444it [00:01, 468.94it/s]warmup run: 632it [00:02, 671.63it/s]warmup run: 548it [00:01, 578.15it/s]warmup run: 741it [00:02, 768.50it/s]warmup run: 849it [00:02, 845.08it/s]warmup run: 651it [00:02, 668.81it/s]warmup run: 954it [00:02, 895.25it/s]warmup run: 756it [00:02, 756.23it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 858it [00:02, 820.04it/s]warmup run: 1059it [00:02, 904.62it/s]warmup run: 103it [00:01, 93.44it/s]warmup run: 960it [00:02, 871.54it/s]warmup run: 1166it [00:02, 949.75it/s]warmup run: 1it [00:01,  1.46s/it]warmup run: 197it [00:01, 190.69it/s]warmup run: 1063it [00:02, 913.09it/s]warmup run: 1274it [00:02, 985.48it/s]warmup run: 102it [00:01, 90.55it/s]warmup run: 302it [00:01, 311.75it/s]warmup run: 1165it [00:02, 941.16it/s]warmup run: 1381it [00:02, 1009.12it/s]warmup run: 205it [00:01, 196.46it/s]warmup run: 407it [00:01, 435.21it/s]warmup run: 1269it [00:02, 967.24it/s]warmup run: 1488it [00:02, 1025.78it/s]warmup run: 308it [00:01, 312.04it/s]warmup run: 513it [00:01, 555.17it/s]warmup run: 1377it [00:02, 997.77it/s]warmup run: 1594it [00:02, 1032.10it/s]warmup run: 413it [00:01, 433.48it/s]warmup run: 620it [00:02, 666.04it/s]warmup run: 1485it [00:02, 1020.01it/s]warmup run: 1701it [00:03, 1043.16it/s]warmup run: 517it [00:01, 549.11it/s]warmup run: 727it [00:02, 760.59it/s]warmup run: 1590it [00:02, 1023.56it/s]warmup run: 1813it [00:03, 1065.74it/s]warmup run: 623it [00:02, 658.12it/s]warmup run: 834it [00:02, 838.11it/s]warmup run: 1695it [00:03, 1027.36it/s]warmup run: 1921it [00:03, 1068.62it/s]warmup run: 728it [00:02, 749.17it/s]warmup run: 938it [00:02, 870.14it/s]warmup run: 2032it [00:03, 1080.60it/s]warmup run: 1800it [00:03, 1007.40it/s]warmup run: 832it [00:02, 820.68it/s]warmup run: 1043it [00:02, 918.20it/s]warmup run: 2165it [00:03, 1152.43it/s]warmup run: 1902it [00:03, 998.16it/s] warmup run: 937it [00:02, 880.75it/s]warmup run: 1149it [00:02, 956.88it/s]warmup run: 2298it [00:03, 1203.15it/s]warmup run: 2010it [00:03, 1020.81it/s]warmup run: 1043it [00:02, 927.49it/s]warmup run: 1253it [00:02, 979.63it/s]warmup run: 2431it [00:03, 1239.31it/s]warmup run: 2118it [00:03, 1038.08it/s]warmup run: 1147it [00:02, 944.56it/s]warmup run: 1362it [00:02, 1009.88it/s]warmup run: 2563it [00:03, 1262.09it/s]warmup run: 2254it [00:03, 1130.91it/s]warmup run: 1254it [00:02, 977.68it/s]warmup run: 1471it [00:02, 1032.37it/s]warmup run: 2696it [00:03, 1279.88it/s]warmup run: 2389it [00:03, 1195.26it/s]warmup run: 1360it [00:02, 999.89it/s]warmup run: 1580it [00:02, 1047.19it/s]warmup run: 2828it [00:03, 1289.74it/s]warmup run: 2525it [00:03, 1242.61it/s]warmup run: 1467it [00:02, 1019.07it/s]warmup run: 1687it [00:03, 1053.56it/s]warmup run: 2961it [00:04, 1300.78it/s]warmup run: 2660it [00:03, 1274.45it/s]warmup run: 3000it [00:04, 732.52it/s] warmup run: 1572it [00:02, 1028.12it/s]warmup run: 1794it [00:03, 1057.18it/s]warmup run: 2794it [00:03, 1291.66it/s]warmup run: 1677it [00:03, 1031.04it/s]warmup run: 1902it [00:03, 1062.71it/s]warmup run: 2930it [00:04, 1311.26it/s]warmup run: 1783it [00:03, 1038.75it/s]warmup run: 3000it [00:04, 725.08it/s] warmup run: 2010it [00:03, 1066.56it/s]warmup run: 1891it [00:03, 1048.37it/s]warmup run: 2144it [00:03, 1145.97it/s]warmup run: 2000it [00:03, 1059.88it/s]warmup run: 2277it [00:03, 1200.75it/s]warmup run: 2133it [00:03, 1139.88it/s]warmup run: 2411it [00:03, 1239.74it/s]warmup run: 2268it [00:03, 1200.06it/s]warmup run: 2545it [00:03, 1267.24it/s]warmup run: 2403it [00:03, 1242.46it/s]warmup run: 2672it [00:03, 1260.06it/s]warmup run: 2537it [00:03, 1270.00it/s]warmup run: 2806it [00:03, 1281.09it/s]warmup run: 2672it [00:03, 1293.09it/s]warmup run: 2940it [00:04, 1298.35it/s]warmup run: 3000it [00:04, 731.66it/s] warmup run: 2806it [00:03, 1305.14it/s]warmup run: 2941it [00:04, 1318.37it/s]warmup run: 3000it [00:04, 726.37it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1736.92it/s]warmup should be done:   5%|▌         | 164/3000 [00:00<00:01, 1634.25it/s]warmup should be done:   6%|▌         | 171/3000 [00:00<00:01, 1701.63it/s]warmup should be done:   5%|▌         | 152/3000 [00:00<00:01, 1513.43it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1764.54it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1747.60it/s]warmup should be done:  11%|█▏        | 342/3000 [00:00<00:01, 1716.10it/s]warmup should be done:  11%|█         | 329/3000 [00:00<00:01, 1662.42it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1768.73it/s]warmup should be done:  18%|█▊        | 525/3000 [00:00<00:01, 1752.27it/s]warmup should be done:  17%|█▋        | 505/3000 [00:00<00:01, 1704.42it/s]warmup should be done:  17%|█▋        | 518/3000 [00:00<00:01, 1731.99it/s]warmup should be done:  24%|██▎       | 710/3000 [00:00<00:01, 1776.41it/s]warmup should be done:  23%|██▎       | 703/3000 [00:00<00:01, 1759.57it/s]warmup should be done:  23%|██▎       | 682/3000 [00:00<00:01, 1727.11it/s]warmup should be done:  23%|██▎       | 695/3000 [00:00<00:01, 1743.82it/s]warmup should be done:  30%|██▉       | 888/3000 [00:00<00:01, 1775.79it/s]warmup should be done:  29%|██▉       | 881/3000 [00:00<00:01, 1764.09it/s]warmup should be done:  28%|██▊       | 855/3000 [00:00<00:01, 1724.34it/s]warmup should be done:  29%|██▉       | 870/3000 [00:00<00:01, 1742.25it/s]warmup should be done:  36%|███▌      | 1066/3000 [00:00<00:01, 1770.98it/s]warmup should be done:  34%|███▍      | 1030/3000 [00:00<00:01, 1732.88it/s]warmup should be done:  35%|███▍      | 1045/3000 [00:00<00:01, 1740.86it/s]warmup should be done:  35%|███▌      | 1058/3000 [00:00<00:01, 1694.08it/s]warmup should be done:  40%|████      | 1204/3000 [00:00<00:01, 1718.22it/s]warmup should be done:  41%|████▏     | 1244/3000 [00:00<00:01, 1752.86it/s]warmup should be done:  41%|████      | 1220/3000 [00:00<00:01, 1712.86it/s]warmup should be done:  41%|████      | 1235/3000 [00:00<00:01, 1717.88it/s]warmup should be done:  46%|████▌     | 1381/3000 [00:00<00:00, 1733.40it/s]warmup should be done:  47%|████▋     | 1422/3000 [00:00<00:00, 1758.55it/s]warmup should be done:  46%|████▋     | 1395/3000 [00:00<00:00, 1724.31it/s]warmup should be done:  47%|████▋     | 1408/3000 [00:00<00:00, 1706.62it/s]warmup should be done:  52%|█████▏    | 1556/3000 [00:00<00:00, 1737.57it/s]warmup should be done:  53%|█████▎    | 1600/3000 [00:00<00:00, 1762.60it/s]warmup should be done:  52%|█████▏    | 1568/3000 [00:00<00:00, 1721.76it/s]warmup should be done:  53%|█████▎    | 1581/3000 [00:00<00:00, 1713.19it/s]warmup should be done:  58%|█████▊    | 1731/3000 [00:01<00:00, 1741.30it/s]warmup should be done:  59%|█████▉    | 1780/3000 [00:01<00:00, 1771.06it/s]warmup should be done:  58%|█████▊    | 1741/3000 [00:01<00:00, 1719.08it/s]warmup should be done:  58%|█████▊    | 1755/3000 [00:01<00:00, 1719.01it/s]warmup should be done:  64%|██████▎   | 1908/3000 [00:01<00:00, 1748.05it/s]warmup should be done:  65%|██████▌   | 1959/3000 [00:01<00:00, 1775.46it/s]warmup should be done:  64%|██████▍   | 1914/3000 [00:01<00:00, 1721.06it/s]warmup should be done:  64%|██████▍   | 1930/3000 [00:01<00:00, 1727.04it/s]warmup should be done:  71%|███████▏  | 2138/3000 [00:01<00:00, 1777.90it/s]warmup should be done:  69%|██████▉   | 2083/3000 [00:01<00:00, 1736.51it/s]warmup should be done:  70%|██████▉   | 2087/3000 [00:01<00:00, 1721.67it/s]warmup should be done:  70%|███████   | 2107/3000 [00:01<00:00, 1737.48it/s]warmup should be done:  75%|███████▌  | 2261/3000 [00:01<00:00, 1748.58it/s]warmup should be done:  75%|███████▌  | 2260/3000 [00:01<00:00, 1723.73it/s]warmup should be done:  77%|███████▋  | 2316/3000 [00:01<00:00, 1727.85it/s]warmup should be done:  76%|███████▌  | 2285/3000 [00:01<00:00, 1748.50it/s]warmup should be done:  81%|████████  | 2435/3000 [00:01<00:00, 1729.39it/s]warmup should be done:  83%|████████▎ | 2494/3000 [00:01<00:00, 1740.91it/s]warmup should be done:  82%|████████▏ | 2463/3000 [00:01<00:00, 1757.93it/s]warmup should be done:  81%|████████  | 2436/3000 [00:01<00:00, 1685.30it/s]warmup should be done:  87%|████████▋ | 2610/3000 [00:01<00:00, 1734.91it/s]warmup should be done:  89%|████████▉ | 2671/3000 [00:01<00:00, 1747.25it/s]warmup should be done:  88%|████████▊ | 2641/3000 [00:01<00:00, 1763.50it/s]warmup should be done:  87%|████████▋ | 2617/3000 [00:01<00:00, 1719.17it/s]warmup should be done:  93%|█████████▎| 2786/3000 [00:01<00:00, 1742.10it/s]warmup should be done:  94%|█████████▍| 2820/3000 [00:01<00:00, 1770.36it/s]warmup should be done:  93%|█████████▎| 2790/3000 [00:01<00:00, 1707.73it/s]warmup should be done:  95%|█████████▍| 2846/3000 [00:01<00:00, 1695.04it/s]warmup should be done:  99%|█████████▊| 2962/3000 [00:01<00:00, 1745.74it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1748.28it/s]warmup should be done: 100%|█████████▉| 2999/3000 [00:01<00:00, 1775.04it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1744.14it/s]warmup should be done:  99%|█████████▉| 2971/3000 [00:01<00:00, 1736.91it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1729.98it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1722.83it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 185/3000 [00:00<00:01, 1849.77it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1718.01it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1710.77it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1770.66it/s]warmup should be done:  12%|█▏        | 370/3000 [00:00<00:01, 1849.06it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1768.24it/s]warmup should be done:  12%|█▏        | 361/3000 [00:00<00:01, 1804.54it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1753.92it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1797.49it/s]warmup should be done:  18%|█▊        | 530/3000 [00:00<00:01, 1768.99it/s]warmup should be done:  18%|█▊        | 545/3000 [00:00<00:01, 1816.31it/s]warmup should be done:  18%|█▊        | 555/3000 [00:00<00:01, 1830.56it/s]warmup should be done:  24%|██▎       | 709/3000 [00:00<00:01, 1777.08it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1808.74it/s]warmup should be done:  24%|██▍       | 728/3000 [00:00<00:01, 1821.46it/s]warmup should be done:  25%|██▍       | 739/3000 [00:00<00:01, 1791.13it/s]warmup should be done:  30%|███       | 912/3000 [00:00<00:01, 1826.83it/s]warmup should be done:  30%|███       | 904/3000 [00:00<00:01, 1816.83it/s]warmup should be done:  30%|██▉       | 887/3000 [00:00<00:01, 1740.66it/s]warmup should be done:  31%|███       | 924/3000 [00:00<00:01, 1811.22it/s]warmup should be done:  37%|███▋      | 1096/3000 [00:00<00:01, 1829.33it/s]warmup should be done:  36%|███▌      | 1087/3000 [00:00<00:01, 1818.81it/s]warmup should be done:  35%|███▌      | 1062/3000 [00:00<00:01, 1743.23it/s]warmup should be done:  37%|███▋      | 1106/3000 [00:00<00:01, 1814.06it/s]warmup should be done:  43%|████▎     | 1279/3000 [00:00<00:00, 1826.18it/s]warmup should be done:  42%|████▏     | 1269/3000 [00:00<00:00, 1806.91it/s]warmup should be done:  41%|████▏     | 1242/3000 [00:00<00:00, 1759.38it/s]warmup should be done:  43%|████▎     | 1288/3000 [00:00<00:00, 1806.49it/s]warmup should be done:  49%|████▉     | 1463/3000 [00:00<00:00, 1829.87it/s]warmup should be done:  48%|████▊     | 1452/3000 [00:00<00:00, 1813.19it/s]warmup should be done:  47%|████▋     | 1424/3000 [00:00<00:00, 1777.44it/s]warmup should be done:  49%|████▉     | 1469/3000 [00:00<00:00, 1806.95it/s]warmup should be done:  55%|█████▍    | 1635/3000 [00:00<00:00, 1816.40it/s]warmup should be done:  54%|█████▎    | 1605/3000 [00:00<00:00, 1785.92it/s]warmup should be done:  55%|█████▍    | 1646/3000 [00:00<00:00, 1793.65it/s]warmup should be done:  55%|█████▌    | 1650/3000 [00:00<00:00, 1805.20it/s]warmup should be done:  61%|██████    | 1818/3000 [00:01<00:00, 1818.96it/s]warmup should be done:  60%|█████▉    | 1787/3000 [00:01<00:00, 1793.52it/s]warmup should be done:  61%|██████    | 1830/3000 [00:01<00:00, 1804.87it/s]warmup should be done:  61%|██████    | 1831/3000 [00:01<00:00, 1806.16it/s]warmup should be done:  67%|██████▋   | 2002/3000 [00:01<00:00, 1823.10it/s]warmup should be done:  66%|██████▌   | 1968/3000 [00:01<00:00, 1797.57it/s]warmup should be done:  67%|██████▋   | 2016/3000 [00:01<00:00, 1818.93it/s]warmup should be done:  67%|██████▋   | 2012/3000 [00:01<00:00, 1803.73it/s]warmup should be done:  73%|███████▎  | 2186/3000 [00:01<00:00, 1826.03it/s]warmup should be done:  72%|███████▏  | 2149/3000 [00:01<00:00, 1801.29it/s]warmup should be done:  73%|███████▎  | 2202/3000 [00:01<00:00, 1828.43it/s]warmup should be done:  73%|███████▎  | 2193/3000 [00:01<00:00, 1768.43it/s]warmup should be done:  79%|███████▉  | 2369/3000 [00:01<00:00, 1827.09it/s]warmup should be done:  78%|███████▊  | 2331/3000 [00:01<00:00, 1804.97it/s]warmup should be done:  80%|███████▉  | 2387/3000 [00:01<00:00, 1834.75it/s]warmup should be done:  79%|███████▉  | 2378/3000 [00:01<00:00, 1791.29it/s]warmup should be done:  85%|████████▌ | 2553/3000 [00:01<00:00, 1828.61it/s]warmup should be done:  84%|████████▍ | 2513/3000 [00:01<00:00, 1807.33it/s]warmup should be done:  86%|████████▌ | 2573/3000 [00:01<00:00, 1839.66it/s]warmup should be done:  85%|████████▌ | 2563/3000 [00:01<00:00, 1806.05it/s]warmup should be done:  91%|█████████ | 2736/3000 [00:01<00:00, 1821.52it/s]warmup should be done:  90%|████████▉ | 2694/3000 [00:01<00:00, 1807.50it/s]warmup should be done:  92%|█████████▏| 2758/3000 [00:01<00:00, 1841.34it/s]warmup should be done:  92%|█████████▏| 2746/3000 [00:01<00:00, 1811.69it/s]warmup should be done:  97%|█████████▋| 2920/3000 [00:01<00:00, 1824.98it/s]warmup should be done:  96%|█████████▌| 2875/3000 [00:01<00:00, 1806.21it/s]warmup should be done:  98%|█████████▊| 2945/3000 [00:01<00:00, 1847.53it/s]warmup should be done:  98%|█████████▊| 2928/3000 [00:01<00:00, 1800.93it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1827.51it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1816.34it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1805.59it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1786.43it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fd54eef50a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fd54eef4280>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fd54eef5100>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fd54eef4190>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-12 00:44:57.143768: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fd129a6bad0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:44:57.143851: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:44:57.154927: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:44:57.160950: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fd129a671b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:44:57.161038: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:44:57.164733: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fd11d263300 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:44:57.164775: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:44:57.165276: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fd11d26b340 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:44:57.165321: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:44:57.171552: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:44:57.172248: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:44:57.174213: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:44:57.817166: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:44:57.828811: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:44:57.831009: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:44:57.840972: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:45:03.317131: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:45:03.403143: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:45:03.484190: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:45:04.226115: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][00:45:58.565][ERROR][RK0][tid #140536480519936]: replica 3 reaches 1000, calling init pre replica
[HCTR][00:45:58.566][ERROR][RK0][tid #140536480519936]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:45:58.571][ERROR][RK0][tid #140536480519936]: coll ps creation done
[HCTR][00:45:58.571][ERROR][RK0][tid #140536480519936]: replica 3 waits for coll ps creation barrier
[HCTR][00:45:58.777][ERROR][RK0][tid #140536480519936]: replica 0 reaches 1000, calling init pre replica
[HCTR][00:45:58.778][ERROR][RK0][tid #140536480519936]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:45:58.782][ERROR][RK0][tid #140536480519936]: coll ps creation done
[HCTR][00:45:58.782][ERROR][RK0][tid #140536480519936]: replica 0 waits for coll ps creation barrier
[HCTR][00:45:59.143][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][00:45:59.144][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:45:59.147][ERROR][RK0][main]: coll ps creation done
[HCTR][00:45:59.147][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][00:45:59.185][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][00:45:59.185][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:45:59.188][ERROR][RK0][main]: coll ps creation done
[HCTR][00:45:59.188][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][00:45:59.188][ERROR][RK0][tid #140536480519936]: replica 0 preparing frequency
[HCTR][00:46:00.650][ERROR][RK0][tid #140536480519936]: replica 0 preparing frequency done
[HCTR][00:46:00.684][ERROR][RK0][tid #140536480519936]: replica 0 calling init per replica
[HCTR][00:46:00.684][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][00:46:00.684][ERROR][RK0][tid #140536480519936]: replica 3 calling init per replica
[HCTR][00:46:00.684][ERROR][RK0][main]: Calling build_v2
[HCTR][00:46:00.684][ERROR][RK0][tid #140536480519936]: Calling build_v2
[HCTR][00:46:00.684][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][00:46:00.684][ERROR][RK0][tid #140536480519936]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:46:00.684][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:46:00.684][ERROR][RK0][tid #140536480519936]: Calling build_v2
[HCTR][00:46:00.684][ERROR][RK0][main]: Calling build_v2
[HCTR][00:46:00.684][ERROR][RK0][tid #140536480519936]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:46:00.684][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[2022-12-12 00:46:002022-12-12 00:46:00[..684344684338: : 2022-12-12 00:46:00E[E.  6843672022-12-12 00:46:00/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: .::E684381136136 : ] ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccEusing concurrent impl MPSPhaseusing concurrent impl MPSPhase: 

136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] :using concurrent impl MPSPhase136
] using concurrent impl MPSPhase
[2022-12-12 00:46:00.685496: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[1962022-12-12 00:46:00] .assigning 8 to cpu685514
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-12 00:46:00196.] 685539assigning 8 to cpu: 
[[E2022-12-12 00:46:002022-12-12 00:46:00 ../hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc685557685555:: : 196EE]   assigning 8 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
[::2022-12-12 00:46:00196212.] ] 685614assigning 8 to cpubuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4: [

E2022-12-12 00:46:00 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc685639:: 212[E] 2022-12-12 00:46:00 build symm link desc with 4X Tesla V100-SXM2-16GB out of 4./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
685668:: 212E]  [build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-12 00:46:00
:.213685701] [: remote time is 8.68421[2022-12-12 00:46:00E
2022-12-12 00:46:00. .685709[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc685722: 2022-12-12 00:46:00:: E.213E 685741]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: remote time is 8.68421/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:E
:212 213] [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-12 00:46:00:remote time is 8.68421
.214
685793] : cpu time is 30[E[
2022-12-12 00:46:00 2022-12-12 00:46:00./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.685821:685823: 214: E] E cpu time is 30 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::213214] ] remote time is 8.68421cpu time is 30

[2022-12-12 00:46:00.685895: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 00:46:26.794451: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 00:46:26.851451: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 00:46:26.851564: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 00:46:26.852597: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 00:46:26.987284: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 00:46:27.378207: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 00:46:27.378299: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 00:46:34.715444: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 00:46:34.715589: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 00:46:36.564536: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 00:46:36.564688: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 00:46:36.600104: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 00:46:36.600200: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 00:46:36.631540: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 00:46:36.644237: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 00:46:36.645142: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 00:46:36.655692: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 00:46:36.752438: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 00:46:36.755570: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-12 00:46:36.758039: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-12 00:46:36.760458: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-12 00:46:36.762865: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-12 00:46:38.319598: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 00:46:38.324261: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 00:46:38.324440: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 00:46:38.333644: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 00:46:38.333711: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 00:46:38.333743: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 00:46:38.333773: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 00:46:38.334465: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:46:38.334516: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:46:38.335421: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:46:38.335962: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:46:38.357117: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-12 00:46:38.357216: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-12 00:46:38.357796: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:46:38.357846: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:46:38.358702: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:46:38.359269: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-12 00:46:38.3633422022-12-12 00:46:38: .E363337 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 202/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :1 solved202
] 3 solved
[2022-12-12 00:46:38.363457[: 2022-12-12 00:46:38E. 363463/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc: :E205 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccworker 0 thread 1 initing device 1:
205] worker 0 thread 3 initing device 3
[2022-12-12 00:46:38.364173: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:46:38.364225: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:46:38.364309: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:46:38.364369: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:46:38.365611: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19802022-12-12 00:46:38] .eager alloc mem 381.47 MB365631
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:46:38.366685: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:46:38.366713: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:46:38.391018: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 00:46:38.392948: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 00:46:38.393011: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:46:38.393873: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:46:38.394408: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:46:38.395407: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:46:38.395456: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.75 MB
[2022-12-12 00:46:38.421864: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 00:46:38.423742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 00:46:38.423792: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:46:38.424568: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:46:38.425052: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:46:38.426001: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:46:38.426043: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.49 MB
[2022-12-12 00:46:38.456910: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:46:38.457502: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:46:38.457545: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.72 GB
[[2022-12-12 00:46:382022-12-12 00:46:38..466937466937: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-12 00:46:38.468790: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021[
2022-12-12 00:46:38.468812: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021[
2022-12-12 00:46:38.468840: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000[
2022-12-12 00:46:38.468865: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:46:38.475301: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:46:38.475768: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:46:38.476566: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:46:38.476606: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:46:38.477532: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 6256632022-12-12 00:46:38
.477553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663[
2022-12-12 00:46:38.477581: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] [WORKER[0] alloc host memory 45.74 MB2022-12-12 00:46:38
.477604: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.74 MB
[2022-12-12 00:46:38.481317: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:46:38.481915: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:46:38.481956: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.69 GB
[2022-12-12 00:46:38.501508: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:46:38.501847: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:46:38.502096: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:46:38.502137: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.72 GB
[2022-12-12 00:46:38.502417: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:46:38.502458: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.72 GB
[[[[2022-12-12 00:46:392022-12-12 00:46:392022-12-12 00:46:392022-12-12 00:46:39.... 36807 36813 36819 36810: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 0 init p2p of link 1Device 2 init p2p of link 3Device 3 init p2p of link 0Device 1 init p2p of link 2



[2022-12-12 00:46:39. 37139: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-12 00:46:392022-12-12 00:46:39.. 37162 37164: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KB

[2022-12-12 00:46:39. 37270: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:46:39. 37957: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:46:39.[ 380172022-12-12 00:46:39: .E 38026 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 625663638
] eager release cuda mem 625663
[2022-12-12 00:46:39. 38122: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:46:39. 43961: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 00:46:39. 44062: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:46:39. 44382: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-12 00:46:39. 44506: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:46:39. 44755: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 00:46:39. 44826: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-12 00:46:39.[ 448742022-12-12 00:46:39: .E 44880 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager alloc mem 611.00 KB638
] eager release cuda mem 625663
[2022-12-12 00:46:39. 44929: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:46:39. 45316: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:46:39. 45703: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:46:39. 45730: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:46:39. 50516: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 00:46:39. 50615: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:46:39. 51434: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:46:39. 51603: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 00:46:39. 51701: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:46:39. 51778: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 00:46:39. 51870: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:46:39. 52303: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 00:46:39. 52394: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:46:39. 52514: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:46:39. 52667: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:46:39. 53190: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:46:39. 56331: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:46:39. 56625: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11989359 / 100000000 nodes ( 11.99 %~12.00 %) | remote 33008973 / 100000000 nodes ( 33.01 %) | cpu 55001668 / 100000000 nodes ( 55.00 %) | 5.72 GB | 0.692269 secs 
[2022-12-12 00:46:39. 57649: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:46:39. 57948: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11991183 / 100000000 nodes ( 11.99 %~12.00 %) | remote 33007149 / 100000000 nodes ( 33.01 %) | cpu 55001668 / 100000000 nodes ( 55.00 %) | 5.72 GB | 0.693738 secs 
[2022-12-12 00:46:39. 58014: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:46:39. 58330: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11925432 / 100000000 nodes ( 11.93 %~12.00 %) | remote 33072900 / 100000000 nodes ( 33.07 %) | cpu 55001668 / 100000000 nodes ( 55.00 %) | 5.69 GB | 0.700499 secs 
[2022-12-12 00:46:39. 58585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:46:39. 58882: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11992358 / 100000000 nodes ( 11.99 %~12.00 %) | remote 33005974 / 100000000 nodes ( 33.01 %) | cpu 55001668 / 100000000 nodes ( 55.00 %) | 5.72 GB | 0.724372 secs 
[2022-12-12 00:46:39. 59243: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 12.42 GB
[2022-12-12 00:46:40. 71122: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 12.67 GB
[2022-12-12 00:46:40. 71828: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 12.67 GB
[2022-12-12 00:46:40. 72683: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 12.67 GB
[2022-12-12 00:46:40.964105: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 12.91 GB
[2022-12-12 00:46:40.965114: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 12.91 GB
[2022-12-12 00:46:40.965466: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 12.91 GB
[2022-12-12 00:46:41.899192: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 13.16 GB
[2022-12-12 00:46:41.899408: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 13.16 GB
[2022-12-12 00:46:41.899823: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 13.16 GB
[2022-12-12 00:46:41.900348: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 13.16 GB
[2022-12-12 00:46:41.900769: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 13.16 GB
[2022-12-12 00:46:42.737271: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 13.35 GB
[2022-12-12 00:46:42.737432: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 13.35 GB
[HCTR][00:46:42.823][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][00:46:42.823][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][00:46:42.823][ERROR][RK0][tid #140536480519936]: replica 3 calling init per replica done, doing barrier
[HCTR][00:46:42.823][ERROR][RK0][tid #140536480519936]: replica 0 calling init per replica done, doing barrier
[HCTR][00:46:42.823][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][00:46:42.823][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][00:46:42.823][ERROR][RK0][tid #140536480519936]: replica 3 calling init per replica done, doing barrier done
[HCTR][00:46:42.823][ERROR][RK0][tid #140536480519936]: replica 0 calling init per replica done, doing barrier done
[HCTR][00:46:42.823][ERROR][RK0][main]: init per replica done
[HCTR][00:46:42.823][ERROR][RK0][main]: init per replica done
[HCTR][00:46:42.823][ERROR][RK0][tid #140536480519936]: init per replica done
[HCTR][00:46:42.857][ERROR][RK0][tid #140536480519936]: 2 allocated 3276800 at 0x7fb5e8238400
[HCTR][00:46:42.857][ERROR][RK0][tid #140536480519936]: 2 allocated 6553600 at 0x7fb5e8558400
[HCTR][00:46:42.858][ERROR][RK0][tid #140536480519936]: 2 allocated 3276800 at 0x7fb5e8b98400
[HCTR][00:46:42.858][ERROR][RK0][tid #140536480519936]: 2 allocated 6553600 at 0x7fb5e8eb8400
[HCTR][00:46:42.858][ERROR][RK0][tid #140536480519936]: 3 allocated 3276800 at 0x7fb678238400
[HCTR][00:46:42.858][ERROR][RK0][tid #140536480519936]: 3 allocated 6553600 at 0x7fb678558400
[HCTR][00:46:42.858][ERROR][RK0][tid #140536480519936]: 3 allocated 3276800 at 0x7fb678b98400
[HCTR][00:46:42.858][ERROR][RK0][tid #140536480519936]: 3 allocated 6553600 at 0x7fb678eb8400
[HCTR][00:46:42.858][ERROR][RK0][tid #140536480519936]: 1 allocated 3276800 at 0x7fb6e8238400
[HCTR][00:46:42.859][ERROR][RK0][tid #140536480519936]: 1 allocated 6553600 at 0x7fb6e8558400
[HCTR][00:46:42.859][ERROR][RK0][tid #140536480519936]: 1 allocated 3276800 at 0x7fb6e8b98400
[HCTR][00:46:42.859][ERROR][RK0][tid #140536480519936]: 1 allocated 6553600 at 0x7fb6e8eb8400
[HCTR][00:46:42.871][ERROR][RK0][tid #140536480519936]: init per replica done
[HCTR][00:46:42.906][ERROR][RK0][tid #140536480519936]: 0 allocated 3276800 at 0x7fb5dc320000
[HCTR][00:46:42.906][ERROR][RK0][tid #140536480519936]: 0 allocated 6553600 at 0x7fb5dc640000
[HCTR][00:46:42.906][ERROR][RK0][tid #140536480519936]: 0 allocated 3276800 at 0x7fb5dcc80000
[HCTR][00:46:42.906][ERROR][RK0][tid #140536480519936]: 0 allocated 6553600 at 0x7fb5dcfa0000
