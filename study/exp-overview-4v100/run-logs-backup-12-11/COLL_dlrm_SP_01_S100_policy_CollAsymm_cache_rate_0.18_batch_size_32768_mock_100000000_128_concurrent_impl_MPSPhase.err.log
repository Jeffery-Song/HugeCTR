2022-12-12 02:40:56.026004: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:40:56.109959: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:40:56.109960: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:40:56.113731: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 02:40:56.920038: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:40:56.920119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:40:56.932955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 02:40:56.961198: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:40:56.961371: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:40:56.962918: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 02:40:57.033758: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:40:57.033840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:40:57.039149: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:40:57.039224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:40:57.040058: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 02:40:57.040111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:40:57.046864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 02:40:57.053394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 02:40:57.054924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 02:40:57.076819: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:40:57.077006: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:40:57.078490: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 02:40:57.083046: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:40:57.083192: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:40:57.083976: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 02:40:57.084617: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:40:57.084731: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 02:40:57.086282: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][02:40:58.322][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:40:58.322][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:40:58.357][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][02:40:58.364][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.58s/it]warmup run: 1it [00:01,  1.52s/it]warmup run: 1it [00:01,  1.51s/it]warmup run: 79it [00:01, 65.26it/s]warmup run: 61it [00:01, 51.98it/s]warmup run: 51it [00:01, 43.87it/s]warmup run: 168it [00:01, 152.57it/s]warmup run: 152it [00:01, 145.49it/s]warmup run: 148it [00:01, 145.61it/s]warmup run: 271it [00:01, 267.53it/s]warmup run: 244it [00:01, 249.70it/s]warmup run: 247it [00:01, 260.10it/s]warmup run: 374it [00:01, 387.84it/s]warmup run: 351it [00:01, 381.58it/s]warmup run: 342it [00:01, 372.00it/s]warmup run: 479it [00:02, 508.93it/s]warmup run: 454it [00:02, 502.28it/s]warmup run: 444it [00:02, 492.99it/s]warmup run: 583it [00:02, 619.09it/s]warmup run: 551it [00:02, 600.80it/s]warmup run: 543it [00:02, 597.48it/s]warmup run: 682it [00:02, 703.48it/s]warmup run: 656it [00:02, 703.13it/s]warmup run: 644it [00:02, 692.25it/s]warmup run: 783it [00:02, 777.58it/s]warmup run: 761it [00:02, 789.13it/s]warmup run: 750it [00:02, 783.49it/s]warmup run: 887it [00:02, 845.59it/s]warmup run: 864it [00:02, 846.71it/s]warmup run: 851it [00:02, 841.19it/s]warmup run: 0it [00:00, ?it/s]warmup run: 989it [00:02, 891.88it/s]warmup run: 964it [00:02, 881.96it/s]warmup run: 959it [00:02, 903.75it/s]warmup run: 1098it [00:02, 945.05it/s]warmup run: 1073it [00:02, 939.30it/s]warmup run: 1064it [00:02, 944.13it/s]warmup run: 1206it [00:02, 981.99it/s]warmup run: 1179it [00:02, 973.48it/s]warmup run: 1168it [00:02, 971.11it/s]warmup run: 1311it [00:02, 992.97it/s]warmup run: 1289it [00:02, 1008.09it/s]warmup run: 1275it [00:02, 999.10it/s]warmup run: 1416it [00:02, 1009.22it/s]warmup run: 1398it [00:02, 1030.14it/s]warmup run: 1381it [00:02, 1016.40it/s]warmup run: 1520it [00:03, 1007.76it/s]warmup run: 1505it [00:03, 999.46it/s] warmup run: 1486it [00:03, 992.64it/s] warmup run: 1627it [00:03, 1023.29it/s]warmup run: 1609it [00:03, 1008.88it/s]warmup run: 1588it [00:03, 975.29it/s]warmup run: 1734it [00:03, 1034.57it/s]warmup run: 1714it [00:03, 1018.59it/s]warmup run: 1692it [00:03, 992.29it/s]warmup run: 1843it [00:03, 1048.81it/s]warmup run: 1818it [00:03, 1004.97it/s]warmup run: 1801it [00:03, 1020.64it/s]warmup run: 1950it [00:03, 1054.15it/s]warmup run: 1924it [00:03, 1018.72it/s]warmup run: 1912it [00:03, 1045.84it/s]warmup run: 2067it [00:03, 1086.86it/s]warmup run: 2034it [00:03, 1040.50it/s]warmup run: 2026it [00:03, 1072.80it/s]warmup run: 2202it [00:03, 1163.20it/s]warmup run: 2167it [00:03, 1124.47it/s]warmup run: 2158it [00:03, 1146.01it/s]warmup run: 2337it [00:03, 1216.87it/s]warmup run: 2283it [00:03, 1133.51it/s]warmup run: 2291it [00:03, 1198.71it/s]warmup run: 2471it [00:03, 1251.97it/s]warmup run: 2412it [00:03, 1179.61it/s]warmup run: 2425it [00:03, 1238.00it/s]warmup run: 2602it [00:03, 1268.52it/s]warmup run: 1it [00:01,  1.49s/it]warmup run: 2541it [00:03, 1211.40it/s]warmup run: 2558it [00:03, 1263.68it/s]warmup run: 2734it [00:04, 1282.60it/s]warmup run: 81it [00:01, 70.69it/s]warmup run: 2671it [00:04, 1235.78it/s]warmup run: 2690it [00:04, 1279.50it/s]warmup run: 2865it [00:04, 1288.93it/s]warmup run: 153it [00:01, 142.66it/s]warmup run: 2805it [00:04, 1264.42it/s]warmup run: 2824it [00:04, 1296.15it/s]warmup run: 2997it [00:04, 1298.02it/s]warmup run: 3000it [00:04, 696.56it/s] warmup run: 229it [00:01, 226.93it/s]warmup run: 2939it [00:04, 1286.15it/s]warmup run: 2954it [00:04, 1277.20it/s]warmup run: 3000it [00:04, 695.35it/s] warmup run: 3000it [00:04, 700.04it/s] warmup run: 334it [00:01, 361.36it/s]warmup run: 439it [00:01, 491.57it/s]warmup run: 527it [00:02, 571.69it/s]warmup run: 628it [00:02, 672.57it/s]warmup run: 736it [00:02, 773.51it/s]warmup run: 833it [00:02, 795.29it/s]warmup run: 933it [00:02, 848.64it/s]warmup run: 1040it [00:02, 908.41it/s]warmup run: 1150it [00:02, 960.41it/s]warmup run: 1256it [00:02, 988.29it/s]warmup run: 1362it [00:02, 1008.31it/s]warmup run: 1468it [00:03, 1022.41it/s]warmup run: 1573it [00:03, 1027.78it/s]warmup run: 1682it [00:03, 1045.42it/s]warmup run: 1792it [00:03, 1060.74it/s]warmup run: 1899it [00:03, 1057.28it/s]warmup run: 2008it [00:03, 1066.27it/s]warmup run: 2143it [00:03, 1148.51it/s]warmup run: 2280it [00:03, 1213.04it/s]warmup run: 2413it [00:03, 1247.24it/s]warmup run: 2550it [00:03, 1281.96it/s]warmup run: 2687it [00:04, 1305.88it/s]warmup run: 2821it [00:04, 1315.80it/s]warmup run: 2953it [00:04, 1253.43it/s]warmup run: 3000it [00:04, 700.82it/s] 


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   4%|▎         | 106/3000 [00:00<00:02, 1057.03it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1651.41it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1743.55it/s]warmup should be done:   4%|▍         | 123/3000 [00:00<00:02, 1224.48it/s]warmup should be done:   9%|▉         | 280/3000 [00:00<00:01, 1456.57it/s]warmup should be done:  10%|█         | 303/3000 [00:00<00:01, 1561.12it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1773.23it/s]warmup should be done:  11%|█         | 333/3000 [00:00<00:01, 1658.11it/s]warmup should be done:  15%|█▌        | 457/3000 [00:00<00:01, 1596.05it/s]warmup should be done:  16%|█▌        | 482/3000 [00:00<00:01, 1662.33it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1769.76it/s]warmup should be done:  17%|█▋        | 499/3000 [00:00<00:01, 1652.15it/s]warmup should be done:  21%|██        | 633/3000 [00:00<00:01, 1660.07it/s]warmup should be done:  22%|██▏       | 661/3000 [00:00<00:01, 1709.33it/s]warmup should be done:  22%|██▏       | 665/3000 [00:00<00:01, 1652.70it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1777.81it/s]warmup should be done:  27%|██▋       | 810/3000 [00:00<00:01, 1696.87it/s]warmup should be done:  28%|██▊       | 840/3000 [00:00<00:01, 1737.25it/s]warmup should be done:  28%|██▊       | 831/3000 [00:00<00:01, 1649.84it/s]warmup should be done:  30%|██▉       | 891/3000 [00:00<00:01, 1761.62it/s]warmup should be done:  33%|███▎      | 985/3000 [00:00<00:01, 1711.94it/s]warmup should be done:  34%|███▍      | 1018/3000 [00:00<00:01, 1749.26it/s]warmup should be done:  33%|███▎      | 996/3000 [00:00<00:01, 1644.06it/s]warmup should be done:  36%|███▌      | 1068/3000 [00:00<00:01, 1602.15it/s]warmup should be done:  39%|███▊      | 1160/3000 [00:00<00:01, 1723.95it/s]warmup should be done:  40%|███▉      | 1196/3000 [00:00<00:01, 1758.93it/s]warmup should be done:  39%|███▊      | 1161/3000 [00:00<00:01, 1638.46it/s]warmup should be done:  42%|████▏     | 1247/3000 [00:00<00:01, 1658.24it/s]warmup should be done:  44%|████▍     | 1335/3000 [00:00<00:00, 1730.80it/s]warmup should be done:  44%|████▍     | 1325/3000 [00:00<00:01, 1636.01it/s]warmup should be done:  46%|████▌     | 1372/3000 [00:00<00:00, 1709.55it/s]warmup should be done:  48%|████▊     | 1426/3000 [00:00<00:00, 1695.92it/s]warmup should be done:  50%|█████     | 1510/3000 [00:00<00:00, 1736.22it/s]warmup should be done:  50%|████▉     | 1489/3000 [00:00<00:00, 1635.73it/s]warmup should be done:  52%|█████▏    | 1552/3000 [00:00<00:00, 1734.71it/s]warmup should be done:  54%|█████▎    | 1605/3000 [00:00<00:00, 1723.42it/s]warmup should be done:  56%|█████▌    | 1687/3000 [00:01<00:00, 1744.42it/s]warmup should be done:  55%|█████▌    | 1653/3000 [00:01<00:00, 1634.18it/s]warmup should be done:  58%|█████▊    | 1726/3000 [00:01<00:00, 1722.47it/s]warmup should be done:  59%|█████▉    | 1784/3000 [00:01<00:00, 1742.07it/s]warmup should be done:  62%|██████▏   | 1864/3000 [00:01<00:00, 1751.27it/s]warmup should be done:  61%|██████    | 1817/3000 [00:01<00:00, 1626.51it/s]warmup should be done:  64%|██████▎   | 1905/3000 [00:01<00:00, 1742.06it/s]warmup should be done:  65%|██████▌   | 1963/3000 [00:01<00:00, 1755.98it/s]warmup should be done:  68%|██████▊   | 2041/3000 [00:01<00:00, 1756.83it/s]warmup should be done:  66%|██████▌   | 1980/3000 [00:01<00:00, 1616.25it/s]warmup should be done:  69%|██████▉   | 2084/3000 [00:01<00:00, 1756.28it/s]warmup should be done:  71%|███████▏  | 2142/3000 [00:01<00:00, 1764.80it/s]warmup should be done:  74%|███████▍  | 2218/3000 [00:01<00:00, 1760.57it/s]warmup should be done:  72%|███████▏  | 2150/3000 [00:01<00:00, 1640.55it/s]warmup should be done:  75%|███████▌  | 2263/3000 [00:01<00:00, 1764.00it/s]warmup should be done:  77%|███████▋  | 2320/3000 [00:01<00:00, 1766.78it/s]warmup should be done:  80%|███████▉  | 2396/3000 [00:01<00:00, 1763.99it/s]warmup should be done:  77%|███████▋  | 2321/3000 [00:01<00:00, 1661.18it/s]warmup should be done:  81%|████████▏ | 2444/3000 [00:01<00:00, 1775.11it/s]warmup should be done:  83%|████████▎ | 2500/3000 [00:01<00:00, 1773.88it/s]warmup should be done:  86%|████████▌ | 2574/3000 [00:01<00:00, 1767.21it/s]warmup should be done:  83%|████████▎ | 2495/3000 [00:01<00:00, 1683.21it/s]warmup should be done:  87%|████████▋ | 2623/3000 [00:01<00:00, 1778.20it/s]warmup should be done:  89%|████████▉ | 2678/3000 [00:01<00:00, 1774.40it/s]warmup should be done:  92%|█████████▏| 2752/3000 [00:01<00:00, 1768.48it/s]warmup should be done:  89%|████████▉ | 2669/3000 [00:01<00:00, 1698.90it/s]warmup should be done:  93%|█████████▎| 2801/3000 [00:01<00:00, 1775.05it/s]warmup should be done:  95%|█████████▌| 2857/3000 [00:01<00:00, 1777.87it/s]warmup should be done:  98%|█████████▊| 2929/3000 [00:01<00:00, 1739.11it/s]warmup should be done:  95%|█████████▍| 2842/3000 [00:01<00:00, 1706.80it/s]warmup should be done:  99%|█████████▉| 2979/3000 [00:01<00:00, 1773.62it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1746.50it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1734.93it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1714.56it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1663.68it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1789.98it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1715.44it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1687.12it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1710.96it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1751.87it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1786.44it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1798.82it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1772.78it/s]warmup should be done:  18%|█▊        | 540/3000 [00:00<00:01, 1807.85it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1779.13it/s]warmup should be done:  18%|█▊        | 545/3000 [00:00<00:01, 1826.19it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1770.51it/s]warmup should be done:  24%|██▍       | 731/3000 [00:00<00:01, 1839.38it/s]warmup should be done:  24%|██▎       | 710/3000 [00:00<00:01, 1781.68it/s]warmup should be done:  24%|██▍       | 724/3000 [00:00<00:01, 1818.17it/s]warmup should be done:  24%|██▍       | 715/3000 [00:00<00:01, 1772.50it/s]warmup should be done:  31%|███       | 917/3000 [00:00<00:01, 1845.33it/s]warmup should be done:  30%|███       | 909/3000 [00:00<00:01, 1826.60it/s]warmup should be done:  30%|██▉       | 892/3000 [00:00<00:01, 1792.08it/s]warmup should be done:  30%|██▉       | 894/3000 [00:00<00:01, 1778.33it/s]warmup should be done:  37%|███▋      | 1104/3000 [00:00<00:01, 1851.75it/s]warmup should be done:  36%|███▌      | 1077/3000 [00:00<00:01, 1810.66it/s]warmup should be done:  36%|███▌      | 1073/3000 [00:00<00:01, 1781.30it/s]warmup should be done:  36%|███▋      | 1092/3000 [00:00<00:01, 1772.36it/s]warmup should be done:  42%|████▏     | 1261/3000 [00:00<00:00, 1819.34it/s]warmup should be done:  43%|████▎     | 1290/3000 [00:00<00:00, 1851.74it/s]warmup should be done:  42%|████▎     | 1275/3000 [00:00<00:00, 1787.90it/s]warmup should be done:  42%|████▏     | 1252/3000 [00:00<00:01, 1732.10it/s]warmup should be done:  48%|████▊     | 1445/3000 [00:00<00:00, 1824.87it/s]warmup should be done:  49%|████▉     | 1476/3000 [00:00<00:00, 1853.41it/s]warmup should be done:  49%|████▊     | 1459/3000 [00:00<00:00, 1803.49it/s]warmup should be done:  48%|████▊     | 1428/3000 [00:00<00:00, 1735.29it/s]warmup should be done:  54%|█████▍    | 1628/3000 [00:00<00:00, 1790.14it/s]warmup should be done:  54%|█████▎    | 1612/3000 [00:00<00:00, 1765.57it/s]warmup should be done:  55%|█████▌    | 1662/3000 [00:00<00:00, 1785.88it/s]warmup should be done:  55%|█████▍    | 1640/3000 [00:00<00:00, 1786.22it/s]warmup should be done:  60%|██████    | 1808/3000 [00:01<00:00, 1788.39it/s]warmup should be done:  60%|█████▉    | 1798/3000 [00:01<00:00, 1791.45it/s]warmup should be done:  61%|██████    | 1828/3000 [00:01<00:00, 1813.03it/s]warmup should be done:  61%|██████▏   | 1842/3000 [00:01<00:00, 1654.67it/s]warmup should be done:  66%|██████▋   | 1989/3000 [00:01<00:00, 1793.67it/s]warmup should be done:  66%|██████▌   | 1984/3000 [00:01<00:00, 1809.50it/s]warmup should be done:  67%|██████▋   | 2015/3000 [00:01<00:00, 1829.60it/s]warmup should be done:  67%|██████▋   | 2010/3000 [00:01<00:00, 1649.20it/s]warmup should be done:  72%|███████▏  | 2170/3000 [00:01<00:00, 1796.69it/s]warmup should be done:  73%|███████▎  | 2202/3000 [00:01<00:00, 1841.15it/s]warmup should be done:  72%|███████▏  | 2166/3000 [00:01<00:00, 1745.73it/s]warmup should be done:  73%|███████▎  | 2193/3000 [00:01<00:00, 1698.88it/s]warmup should be done:  78%|███████▊  | 2350/3000 [00:01<00:00, 1781.24it/s]warmup should be done:  80%|███████▉  | 2389/3000 [00:01<00:00, 1848.87it/s]warmup should be done:  78%|███████▊  | 2346/3000 [00:01<00:00, 1761.57it/s]warmup should be done:  79%|███████▉  | 2370/3000 [00:01<00:00, 1717.12it/s]warmup should be done:  84%|████████▍ | 2531/3000 [00:01<00:00, 1789.63it/s]warmup should be done:  86%|████████▌ | 2576/3000 [00:01<00:00, 1855.19it/s]warmup should be done:  84%|████████▍ | 2531/3000 [00:01<00:00, 1785.11it/s]warmup should be done:  85%|████████▌ | 2555/3000 [00:01<00:00, 1755.71it/s]warmup should be done:  90%|█████████ | 2713/3000 [00:01<00:00, 1797.62it/s]warmup should be done:  92%|█████████▏| 2763/3000 [00:01<00:00, 1858.78it/s]warmup should be done:  91%|█████████ | 2716/3000 [00:01<00:00, 1802.61it/s]warmup should be done:  91%|█████████ | 2732/3000 [00:01<00:00, 1751.38it/s]warmup should be done:  96%|█████████▋| 2895/3000 [00:01<00:00, 1801.71it/s]warmup should be done:  98%|█████████▊| 2951/3000 [00:01<00:00, 1864.08it/s]warmup should be done:  97%|█████████▋| 2897/3000 [00:01<00:00, 1771.81it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1825.98it/s]warmup should be done:  97%|█████████▋| 2911/3000 [00:01<00:00, 1760.30it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1794.75it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1774.12it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1762.87it/s]2022-12-12 02:42:12.447165: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f819a268540 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:42:12.447221: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:42:13.625726: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f819a267db0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:42:13.625784: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:42:13.798013: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f819aa645b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:42:13.798070: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:42:15.300067: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:42:16.414915: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:42:17.209946: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:42:17.430038: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:42:17.820001: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:42:18.750271: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:42:18.980893: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:42:20.358099: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:42:20.752048: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 02:42:26.226617: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f819aa6b1d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 02:42:26.226674: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 02:42:27.818711: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 02:42:28.907198: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 02:42:30.315005: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][02:42:57.600][ERROR][RK0][tid #140194770577152]: replica 1 reaches 1000, calling init pre replica
[HCTR][02:42:57.600][ERROR][RK0][tid #140194770577152]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:42:57.604][ERROR][RK0][tid #140194770577152]: coll ps creation done
[HCTR][02:42:57.604][ERROR][RK0][tid #140194770577152]: replica 1 waits for coll ps creation barrier
[HCTR][02:42:57.659][ERROR][RK0][tid #140194829293312]: replica 3 reaches 1000, calling init pre replica
[HCTR][02:42:57.660][ERROR][RK0][tid #140194829293312]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:42:57.664][ERROR][RK0][tid #140194829293312]: coll ps creation done
[HCTR][02:42:57.664][ERROR][RK0][tid #140194829293312]: replica 3 waits for coll ps creation barrier
[HCTR][02:42:57.927][ERROR][RK0][tid #140194770577152]: replica 2 reaches 1000, calling init pre replica
[HCTR][02:42:57.927][ERROR][RK0][tid #140194770577152]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:42:57.930][ERROR][RK0][tid #140194770577152]: coll ps creation done
[HCTR][02:42:57.930][ERROR][RK0][tid #140194770577152]: replica 2 waits for coll ps creation barrier
[HCTR][02:42:58.030][ERROR][RK0][tid #140194762184448]: replica 0 reaches 1000, calling init pre replica
[HCTR][02:42:58.030][ERROR][RK0][tid #140194762184448]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][02:42:58.036][ERROR][RK0][tid #140194762184448]: coll ps creation done
[HCTR][02:42:58.036][ERROR][RK0][tid #140194762184448]: replica 0 waits for coll ps creation barrier
[HCTR][02:42:58.036][ERROR][RK0][tid #140194762184448]: replica 0 preparing frequency
[HCTR][02:42:59.283][ERROR][RK0][tid #140194762184448]: replica 0 preparing frequency done
[HCTR][02:42:59.323][ERROR][RK0][tid #140194762184448]: replica 0 calling init per replica
[HCTR][02:42:59.323][ERROR][RK0][tid #140194829293312]: replica 3 calling init per replica
[HCTR][02:42:59.323][ERROR][RK0][tid #140194770577152]: replica 1 calling init per replica
[HCTR][02:42:59.323][ERROR][RK0][tid #140194829293312]: Calling build_v2
[HCTR][02:42:59.323][ERROR][RK0][tid #140194762184448]: Calling build_v2
[HCTR][02:42:59.323][ERROR][RK0][tid #140194770577152]: replica 2 calling init per replica
[HCTR][02:42:59.323][ERROR][RK0][tid #140194829293312]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:42:59.323][ERROR][RK0][tid #140194762184448]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:42:59.323][ERROR][RK0][tid #140194770577152]: Calling build_v2
[HCTR][02:42:59.323][ERROR][RK0][tid #140194770577152]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][02:42:59.323][ERROR][RK0][tid #140194770577152]: Calling build_v2
[HCTR][02:42:59.323][ERROR][RK0][tid #140194770577152]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-12 02:42:592022-12-12 02:42:592022-12-12 02:42:59...323466323468323475: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:::136136136] ] ] using concurrent impl MPSPhaseusing concurrent impl MPSPhaseusing concurrent impl MPSPhase

[
2022-12-12 02:42:59.323554: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[2022-12-12 02:42:59.324697: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196[] 2022-12-12 02:42:59assigning 8 to cpu.
324718: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[1962022-12-12 02:42:59] .assigning 8 to cpu324741
[: 2022-12-12 02:42:59E. 324754/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[: :[2022-12-12 02:42:59E1962022-12-12 02:42:59. ] .324770/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpu324777: :
: E212E ] [ /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-12 02:42:59/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:
.:196324853212] [: ] assigning 8 to cpu2022-12-12 02:42:59Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4
. 
324895/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E212 [] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-12 02:42:59build symm link desc with 4X Tesla V100-SXM2-16GB out of 4:.
213324947] : [remote time is 8.68421E[2022-12-12 02:42:59
 2022-12-12 02:42:59./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.[324955:3249762022-12-12 02:42:59: 213: .E] E325003 remote time is 8.68421 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE:: [212213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-12 02:42:59] ] :.build symm link desc with 4X Tesla V100-SXM2-16GB out of 4remote time is 8.68421214325086

] : cpu time is 30E
[ 2022-12-12 02:42:59[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.2022-12-12 02:42:59:325147.214: 325152] E: cpu time is 30 E
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214:] 213cpu time is 30] 
remote time is 8.68421
[2022-12-12 02:42:59.325267: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 02:43:25.641924: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 02:43:25.704106: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 02:43:25.704203: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 02:43:25.705188: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 02:43:25.843577: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 02:43:26.234686: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 02:43:26.234787: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 02:43:32.647366: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 02:43:32.647582: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 02:43:34.421934: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 02:43:34.422051: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 02:43:34.471904: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 02:43:34.471987: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 02:43:34.500109: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 02:43:34.513504: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 02:43:34.514363: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 02:43:34.524831: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 02:43:34.625186: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 02:43:34.628343: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-12 02:43:34.630799: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-12 02:43:34.633207: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-12 02:43:34.635610: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-12 02:43:35.834236: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 02:43:35.838402: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 02:43:35.838557: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 02:43:35.846782: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 02:43:35.846847: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 02:43:35.846884: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 02:43:35.846915: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 02:43:35.847596: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:43:35.847640: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:43:35.848537: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:43:35.849081: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:43:35.870240: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-12 02:43:35.870348: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-12 02:43:35.871055: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:43:35.871109: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:43:35.871951: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:43:35.872515: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:43:35.877608: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-12 02:43:35.877726: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-12 02:43:35.877747: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 02:43:35.877825: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 02:43:35.878398: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:43:35.878450: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:43:35.878601: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 02:43:35.878653: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 02:43:35.879848[: 2022-12-12 02:43:35E. 879864/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1980 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 381.47 MB:
1980] eager alloc mem 381.47 MB
[2022-12-12 02:43:35.[8809262022-12-12 02:43:35: .E880942 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 381.47 MB1980
] eager alloc mem 381.47 MB
[2022-12-12 02:43:35.903613: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 02:43:35.905506: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 02:43:35.905574: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:43:35.906472: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:43:35.907269: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:43:35.908302: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:43:35.908352: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 68.45 MB
[[2022-12-12 02:43:352022-12-12 02:43:35..953641953641: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-12 02:43:35.[9554622022-12-12 02:43:35: .E955468 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 1021638
] eager release cuda mem 1021
[2022-12-12 02:43:35.[9555302022-12-12 02:43:35: .E955535 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.ccE: 638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :638eager release cuda mem 400000000] 
eager release cuda mem 400000000
[2022-12-12 02:43:35.957030: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:43:35.957528: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:43:35.958104: [E2022-12-12 02:43:35 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu958115:: 1980E]  eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-12 02:43:35.959105: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:2022-12-12 02:43:35638.] 959121eager release cuda mem 625663: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:43:35.959160: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc[:2022-12-12 02:43:3543.] 959176WORKER[0] alloc host memory 68.45 MB: 
W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 68.62 MB
[2022-12-12 02:43:35.973011: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 02:43:35.974824: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 02:43:35.974873: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 02:43:35.975647: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 69.05 MB
[2022-12-12 02:43:35.976107: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:43:35.977081: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:43:35.977123: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 68.59 MB
[2022-12-12 02:43:35.991116: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:43:35.991702: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:43:35.991745: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.56 GB
[2022-12-12 02:43:36. 10742: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:43:36. 11360: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:43:36. 11400: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.58 GB
[2022-12-12 02:43:36. 45756: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:43:36. 46354: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:43:36. 46397: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.56 GB
[2022-12-12 02:43:36. 48306: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 02:43:36. 48893: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 02:43:36. 48936: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 8.58 GB
[[[[2022-12-12 02:43:362022-12-12 02:43:362022-12-12 02:43:362022-12-12 02:43:36....839265839270839263839267: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 0 init p2p of link 1Device 1 init p2p of link 2Device 3 init p2p of link 0Device 2 init p2p of link 3



[2022-12-12 02:43:36.839589: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:43:36.839698[: 2022-12-12 02:43:36E[. 2022-12-12 02:43:36839707/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.: :839722E1980:  ] E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB :
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980eager alloc mem 611.00 KB] 
eager alloc mem 611.00 KB
[2022-12-12 02:43:36.840415: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:43:36.840611: [E[2022-12-12 02:43:36 2022-12-12 02:43:36./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.840621:840628: 638: E] E eager release cuda mem 625663 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 625663eager release cuda mem 625663

[2022-12-12 02:43:36.847479: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 02:43:36.847582: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:43:36.847701: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 02:43:36.847812: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:43:36.848250: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-12 02:43:36.848324: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-12 02:43:36:.1926848346] : Device 1 init p2p of link 3E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:43:36.848389: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:43:36.848444: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:43:36.848624: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:43:36.849159: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:43:36.849247: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:43:36.855333: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 02:43:36.855420: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:43:36.856238: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:43:36.856426: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 02:43:36.856522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:43:36.856532: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 02:43:36.856722: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:43:36.856962: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 02:43:36.857046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 02:43:36.857322: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:43:36.857620: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:43:36.857839: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 02:43:36.861481: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:43:36.861801: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 17988927 / 100000000 nodes ( 17.99 %~18.00 %) | remote 33511189 / 100000000 nodes ( 33.51 %) | cpu 48499884 / 100000000 nodes ( 48.50 %) | 8.58 GB | 0.983367 secs 
[2022-12-12 02:43:36.863653: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:43:36.863962: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-12 02:43:36:.638863983] : eager release cuda mem 72400000E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 17944289 / 100000000 nodes ( 17.94 %~18.00 %) | remote 33555827 / 100000000 nodes ( 33.56 %) | cpu 48499884 / 100000000 nodes ( 48.50 %) | 8.56 GB | 0.985344 secs 
[2022-12-12 02:43:36.864298: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 17942690 / 100000000 nodes ( 17.94 %~18.00 %) | remote 33557426 / 100000000 nodes ( 33.56 %) | cpu 48499884 / 100000000 nodes ( 48.50 %) | 8.56 GB | 1.01666 secs 
[2022-12-12 02:43:36.864324: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 72400000
[2022-12-12 02:43:36.864697: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 17980836 / 100000000 nodes ( 17.98 %~18.00 %) | remote 33519280 / 100000000 nodes ( 33.52 %) | cpu 48499884 / 100000000 nodes ( 48.50 %) | 8.58 GB | 0.993606 secs 
[2022-12-12 02:43:36.864799: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 13.59 GB
[2022-12-12 02:43:37.829357: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 13.84 GB
[2022-12-12 02:43:37.829503: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 13.84 GB
[2022-12-12 02:43:37.829769: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 13.84 GB
[2022-12-12 02:43:38.595787: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.08 GB
[2022-12-12 02:43:38.595910: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.08 GB
[2022-12-12 02:43:38.596219: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 14.08 GB
[2022-12-12 02:43:39.412956: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.33 GB
[2022-12-12 02:43:39.413076: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.33 GB
[2022-12-12 02:43:39.413431: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 14.33 GB
[2022-12-12 02:43:39.413693: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 14.33 GB
[2022-12-12 02:43:39.414002: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 14.33 GB
[2022-12-12 02:43:40.131354: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 14.52 GB
[2022-12-12 02:43:40.131476: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 14.52 GB
[HCTR][02:43:40.551][ERROR][RK0][tid #140194762184448]: replica 0 calling init per replica done, doing barrier
[HCTR][02:43:40.551][ERROR][RK0][tid #140194829293312]: replica 3 calling init per replica done, doing barrier
[HCTR][02:43:40.551][ERROR][RK0][tid #140194770577152]: replica 1 calling init per replica done, doing barrier
[HCTR][02:43:40.551][ERROR][RK0][tid #140194770577152]: replica 2 calling init per replica done, doing barrier
[HCTR][02:43:40.551][ERROR][RK0][tid #140194770577152]: replica 2 calling init per replica done, doing barrier done
[HCTR][02:43:40.551][ERROR][RK0][tid #140194762184448]: replica 0 calling init per replica done, doing barrier done
[HCTR][02:43:40.551][ERROR][RK0][tid #140194829293312]: replica 3 calling init per replica done, doing barrier done
[HCTR][02:43:40.551][ERROR][RK0][tid #140194770577152]: replica 1 calling init per replica done, doing barrier done
[HCTR][02:43:40.551][ERROR][RK0][tid #140194770577152]: init per replica done
[HCTR][02:43:40.551][ERROR][RK0][tid #140194829293312]: init per replica done
[HCTR][02:43:40.551][ERROR][RK0][tid #140194770577152]: init per replica done
[HCTR][02:43:40.558][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f6f85920000
[HCTR][02:43:40.558][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f6f8a600000
[HCTR][02:43:40.558][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f6f8ac40000
[HCTR][02:43:40.558][ERROR][RK0][main]: 2 allocated 6553600 at 0x7f6f8af60000
[HCTR][02:43:40.559][ERROR][RK0][tid #140194770577152]: 1 allocated 3276800 at 0x7f6f85920000
[HCTR][02:43:40.559][ERROR][RK0][tid #140194770577152]: 1 allocated 6553600 at 0x7f6f8a600000
[HCTR][02:43:40.559][ERROR][RK0][tid #140194770577152]: 1 allocated 3276800 at 0x7f6f8ac40000
[HCTR][02:43:40.559][ERROR][RK0][tid #140194770577152]: 1 allocated 6553600 at 0x7f6f8af60000
[HCTR][02:43:40.561][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f6f85920000
[HCTR][02:43:40.561][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f6f8a600000
[HCTR][02:43:40.561][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f6f8ac40000
[HCTR][02:43:40.561][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f6f8af60000
[HCTR][02:43:40.604][ERROR][RK0][tid #140194762184448]: init per replica done
[HCTR][02:43:40.612][ERROR][RK0][tid #140194762184448]: 0 allocated 3276800 at 0x7f831cd20000
[HCTR][02:43:40.612][ERROR][RK0][tid #140194762184448]: 0 allocated 6553600 at 0x7f831d200000
[HCTR][02:43:40.612][ERROR][RK0][tid #140194762184448]: 0 allocated 3276800 at 0x7f68aa50e800
[HCTR][02:43:40.612][ERROR][RK0][tid #140194762184448]: 0 allocated 6553600 at 0x7f68aa82e800




