2022-12-11 21:20:33.252403: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:20:33.331506: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:20:33.331504: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:20:33.331514: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 21:20:34.101505: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:20:34.101583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:20:34.114824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 21:20:34.145833: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:20:34.145989: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:20:34.147437: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 21:20:34.188192: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:20:34.188268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:20:34.191071: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:20:34.191163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:20:34.191421: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 21:20:34.191473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:20:34.205521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 21:20:34.205913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 21:20:34.206374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 21:20:34.236593: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:20:34.236758: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:20:34.236923: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:20:34.237065: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:20:34.238070: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:20:34.238127: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-11 21:20:34.238173: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 21:20:34.238876: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 21:20:34.240008: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][21:20:35.487][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:20:35.487][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:20:35.507][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][21:20:35.523][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:00,  2.35it/s]warmup run: 0it [00:00, ?it/s]warmup run: 97it [00:00, 242.69it/s]warmup run: 0it [00:00, ?it/s]warmup run: 200it [00:00, 450.45it/s]warmup run: 302it [00:00, 606.23it/s]warmup run: 405it [00:00, 723.25it/s]warmup run: 509it [00:00, 811.48it/s]warmup run: 606it [00:01, 848.44it/s]warmup run: 702it [00:01, 842.60it/s]warmup run: 794it [00:01, 700.62it/s]warmup run: 897it [00:01, 780.31it/s]warmup run: 1000it [00:01, 843.65it/s]warmup run: 1100it [00:01, 884.38it/s]warmup run: 1202it [00:01, 921.11it/s]warmup run: 1302it [00:01, 941.69it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1399it [00:01, 947.74it/s]warmup run: 105it [00:01, 95.87it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1496it [00:02, 918.58it/s]warmup run: 205it [00:01, 200.45it/s]warmup run: 91it [00:01, 83.09it/s]warmup run: 1600it [00:02, 950.75it/s]warmup run: 304it [00:01, 312.33it/s]warmup run: 196it [00:01, 194.89it/s]warmup run: 1703it [00:02, 971.12it/s]warmup run: 405it [00:01, 429.18it/s]warmup run: 294it [00:01, 305.79it/s]warmup run: 1806it [00:02, 986.66it/s]warmup run: 508it [00:01, 545.25it/s]warmup run: 397it [00:01, 427.52it/s]warmup run: 1906it [00:02, 988.90it/s]warmup run: 612it [00:02, 650.15it/s]warmup run: 499it [00:01, 542.19it/s]warmup run: 2017it [00:02, 1023.70it/s]warmup run: 721it [00:02, 753.58it/s]warmup run: 599it [00:02, 638.35it/s]warmup run: 0it [00:00, ?it/s]warmup run: 2139it [00:02, 1079.74it/s]warmup run: 823it [00:02, 807.92it/s]warmup run: 705it [00:02, 736.44it/s]warmup run: 2274it [00:02, 1159.65it/s]warmup run: 933it [00:02, 883.91it/s]warmup run: 811it [00:02, 816.12it/s]warmup run: 2412it [00:02, 1224.83it/s]warmup run: 1043it [00:02, 941.23it/s]warmup run: 917it [00:02, 879.88it/s]warmup run: 2551it [00:02, 1272.93it/s]warmup run: 1154it [00:02, 986.95it/s]warmup run: 1021it [00:02, 923.56it/s]warmup run: 2690it [00:03, 1307.11it/s]warmup run: 1264it [00:02, 1017.56it/s]warmup run: 1124it [00:02, 952.79it/s]warmup run: 2828it [00:03, 1326.21it/s]warmup run: 1377it [00:02, 1047.29it/s]warmup run: 1229it [00:02, 980.61it/s]warmup run: 2967it [00:03, 1344.03it/s]warmup run: 1491it [00:02, 1073.03it/s]warmup run: 1333it [00:02, 996.31it/s]warmup run: 3000it [00:03, 913.17it/s] warmup run: 1602it [00:02, 1067.76it/s]warmup run: 1437it [00:02, 1005.91it/s]warmup run: 1711it [00:03, 1068.59it/s]warmup run: 1541it [00:02, 1015.76it/s]warmup run: 1820it [00:03, 1074.25it/s]warmup run: 1645it [00:03, 1019.96it/s]warmup run: 1929it [00:03, 1076.08it/s]warmup run: 1749it [00:03, 1025.11it/s]warmup run: 2047it [00:03, 1105.25it/s]warmup run: 1854it [00:03, 1030.98it/s]warmup run: 1959it [00:03, 1035.67it/s]warmup run: 2159it [00:03, 1100.10it/s]warmup run: 2079it [00:03, 1082.48it/s]warmup run: 2286it [00:03, 1148.60it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 2209it [00:03, 1145.03it/s]warmup run: 2410it [00:03, 1173.20it/s]warmup run: 109it [00:01, 100.03it/s]warmup run: 2343it [00:03, 1200.69it/s]warmup run: 2535it [00:03, 1193.32it/s]warmup run: 220it [00:01, 217.33it/s]warmup run: 2477it [00:03, 1240.78it/s]warmup run: 2662it [00:03, 1214.46it/s]warmup run: 328it [00:01, 339.70it/s]warmup run: 2612it [00:03, 1271.32it/s]warmup run: 2788it [00:03, 1227.17it/s]warmup run: 436it [00:01, 463.95it/s]warmup run: 2746it [00:03, 1288.60it/s]warmup run: 2916it [00:04, 1240.31it/s]warmup run: 535it [00:01, 565.56it/s]warmup run: 3000it [00:04, 728.66it/s] warmup run: 2880it [00:04, 1302.74it/s]warmup run: 642it [00:02, 674.54it/s]warmup run: 3000it [00:04, 726.87it/s] warmup run: 744it [00:02, 752.13it/s]warmup run: 850it [00:02, 829.38it/s]warmup run: 956it [00:02, 889.92it/s]warmup run: 1060it [00:02, 931.00it/s]warmup run: 1167it [00:02, 969.69it/s]warmup run: 1272it [00:02, 989.61it/s]warmup run: 1380it [00:02, 1013.88it/s]warmup run: 1487it [00:02, 1028.96it/s]warmup run: 1593it [00:02, 1034.02it/s]warmup run: 1701it [00:03, 1045.54it/s]warmup run: 1807it [00:03, 1043.86it/s]warmup run: 1914it [00:03, 1049.80it/s]warmup run: 2025it [00:03, 1067.40it/s]warmup run: 2158it [00:03, 1144.27it/s]warmup run: 2293it [00:03, 1204.17it/s]warmup run: 2427it [00:03, 1243.89it/s]warmup run: 2562it [00:03, 1274.71it/s]warmup run: 2697it [00:03, 1295.24it/s]warmup run: 2831it [00:03, 1306.35it/s]warmup run: 2966it [00:04, 1318.90it/s]warmup run: 3000it [00:04, 739.51it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1756.73it/s]warmup should be done:   5%|▌         | 151/3000 [00:00<00:01, 1504.75it/s]warmup should be done:   5%|▌         | 164/3000 [00:00<00:01, 1634.74it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1686.26it/s]warmup should be done:  12%|█▏        | 352/3000 [00:00<00:01, 1757.36it/s]warmup should be done:  11%|█         | 316/3000 [00:00<00:01, 1584.85it/s]warmup should be done:  11%|█         | 335/3000 [00:00<00:01, 1674.52it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1739.94it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1757.86it/s]warmup should be done:  16%|█▌        | 487/3000 [00:00<00:01, 1640.12it/s]warmup should be done:  17%|█▋        | 521/3000 [00:00<00:01, 1736.85it/s]warmup should be done:  17%|█▋        | 503/3000 [00:00<00:01, 1653.33it/s]warmup should be done:  23%|██▎       | 704/3000 [00:00<00:01, 1751.41it/s]warmup should be done:  22%|██▏       | 658/3000 [00:00<00:01, 1665.89it/s]warmup should be done:  23%|██▎       | 698/3000 [00:00<00:01, 1748.79it/s]warmup should be done:  22%|██▏       | 669/3000 [00:00<00:01, 1645.83it/s]warmup should be done:  29%|██▉       | 880/3000 [00:00<00:01, 1751.90it/s]warmup should be done:  28%|██▊       | 830/3000 [00:00<00:01, 1683.57it/s]warmup should be done:  29%|██▉       | 875/3000 [00:00<00:01, 1755.11it/s]warmup should be done:  28%|██▊       | 835/3000 [00:00<00:01, 1647.57it/s]warmup should be done:  33%|███▎      | 1004/3000 [00:00<00:01, 1701.20it/s]warmup should be done:  35%|███▌      | 1052/3000 [00:00<00:01, 1759.25it/s]warmup should be done:  35%|███▌      | 1056/3000 [00:00<00:01, 1730.33it/s]warmup should be done:  33%|███▎      | 1000/3000 [00:00<00:01, 1646.37it/s]warmup should be done:  39%|███▉      | 1177/3000 [00:00<00:01, 1707.89it/s]warmup should be done:  41%|████      | 1229/3000 [00:00<00:01, 1760.46it/s]warmup should be done:  41%|████      | 1232/3000 [00:00<00:01, 1738.66it/s]warmup should be done:  39%|███▉      | 1165/3000 [00:00<00:01, 1640.27it/s]warmup should be done:  45%|████▌     | 1350/3000 [00:00<00:00, 1711.99it/s]warmup should be done:  47%|████▋     | 1406/3000 [00:00<00:00, 1759.99it/s]warmup should be done:  47%|████▋     | 1406/3000 [00:00<00:00, 1732.82it/s]warmup should be done:  44%|████▍     | 1330/3000 [00:00<00:01, 1635.11it/s]warmup should be done:  51%|█████     | 1523/3000 [00:00<00:00, 1717.14it/s]warmup should be done:  53%|█████▎    | 1583/3000 [00:00<00:00, 1761.54it/s]warmup should be done:  53%|█████▎    | 1583/3000 [00:00<00:00, 1742.98it/s]warmup should be done:  50%|████▉     | 1498/3000 [00:00<00:00, 1646.70it/s]warmup should be done:  57%|█████▋    | 1697/3000 [00:01<00:00, 1723.02it/s]warmup should be done:  59%|█████▊    | 1761/3000 [00:01<00:00, 1766.37it/s]warmup should be done:  59%|█████▊    | 1758/3000 [00:01<00:00, 1738.72it/s]warmup should be done:  56%|█████▌    | 1666/3000 [00:01<00:00, 1655.37it/s]warmup should be done:  62%|██████▏   | 1870/3000 [00:01<00:00, 1724.92it/s]warmup should be done:  65%|██████▍   | 1942/3000 [00:01<00:00, 1778.75it/s]warmup should be done:  64%|██████▍   | 1935/3000 [00:01<00:00, 1747.81it/s]warmup should be done:  61%|██████    | 1832/3000 [00:01<00:00, 1653.84it/s]warmup should be done:  68%|██████▊   | 2044/3000 [00:01<00:00, 1727.85it/s]warmup should be done:  71%|███████   | 2122/3000 [00:01<00:00, 1784.35it/s]warmup should be done:  70%|███████   | 2110/3000 [00:01<00:00, 1745.42it/s]warmup should be done:  67%|██████▋   | 2000/3000 [00:01<00:00, 1660.79it/s]warmup should be done:  74%|███████▍  | 2224/3000 [00:01<00:00, 1748.64it/s]warmup should be done:  77%|███████▋  | 2301/3000 [00:01<00:00, 1785.20it/s]warmup should be done:  76%|███████▋  | 2288/3000 [00:01<00:00, 1753.68it/s]warmup should be done:  72%|███████▏  | 2169/3000 [00:01<00:00, 1668.01it/s]warmup should be done:  80%|████████  | 2406/3000 [00:01<00:00, 1768.33it/s]warmup should be done:  83%|████████▎ | 2481/3000 [00:01<00:00, 1788.91it/s]warmup should be done:  82%|████████▏ | 2467/3000 [00:01<00:00, 1762.10it/s]warmup should be done:  78%|███████▊  | 2338/3000 [00:01<00:00, 1672.70it/s]warmup should be done:  86%|████████▌ | 2587/3000 [00:01<00:00, 1780.09it/s]warmup should be done:  89%|████████▊ | 2662/3000 [00:01<00:00, 1793.03it/s]warmup should be done:  88%|████████▊ | 2644/3000 [00:01<00:00, 1756.93it/s]warmup should be done:  84%|████████▎ | 2508/3000 [00:01<00:00, 1678.70it/s]warmup should be done:  92%|█████████▏| 2769/3000 [00:01<00:00, 1792.02it/s]warmup should be done:  95%|█████████▍| 2842/3000 [00:01<00:00, 1792.17it/s]warmup should be done:  94%|█████████▍| 2823/3000 [00:01<00:00, 1765.39it/s]warmup should be done:  89%|████████▉ | 2677/3000 [00:01<00:00, 1680.56it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1772.34it/s]warmup should be done:  98%|█████████▊| 2951/3000 [00:01<00:00, 1798.74it/s]warmup should be done:  95%|█████████▍| 2847/3000 [00:01<00:00, 1684.41it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1754.06it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1749.59it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1732.18it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1664.21it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1738.45it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1753.16it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1733.58it/s]warmup should be done:   6%|▌         | 177/3000 [00:00<00:01, 1762.48it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1741.10it/s]warmup should be done:  12%|█▏        | 363/3000 [00:00<00:01, 1819.36it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1769.29it/s]warmup should be done:  12%|█▏        | 365/3000 [00:00<00:01, 1826.10it/s]warmup should be done:  17%|█▋        | 524/3000 [00:00<00:01, 1744.58it/s]warmup should be done:  18%|█▊        | 550/3000 [00:00<00:01, 1839.93it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1797.78it/s]warmup should be done:  18%|█▊        | 553/3000 [00:00<00:01, 1848.10it/s]warmup should be done:  23%|██▎       | 700/3000 [00:00<00:01, 1746.93it/s]warmup should be done:  25%|██▍       | 737/3000 [00:00<00:01, 1851.41it/s]warmup should be done:  25%|██▍       | 740/3000 [00:00<00:01, 1855.36it/s]warmup should be done:  24%|██▍       | 720/3000 [00:00<00:01, 1803.33it/s]warmup should be done:  31%|███       | 925/3000 [00:00<00:01, 1859.82it/s]warmup should be done:  29%|██▉       | 876/3000 [00:00<00:01, 1748.19it/s]warmup should be done:  30%|███       | 904/3000 [00:00<00:01, 1815.98it/s]warmup should be done:  31%|███       | 927/3000 [00:00<00:01, 1858.98it/s]warmup should be done:  37%|███▋      | 1112/3000 [00:00<00:01, 1861.95it/s]warmup should be done:  35%|███▌      | 1051/3000 [00:00<00:01, 1746.96it/s]warmup should be done:  37%|███▋      | 1113/3000 [00:00<00:01, 1859.08it/s]warmup should be done:  36%|███▌      | 1086/3000 [00:00<00:01, 1803.01it/s]warmup should be done:  43%|████▎     | 1299/3000 [00:00<00:00, 1858.33it/s]warmup should be done:  41%|████      | 1226/3000 [00:00<00:01, 1743.60it/s]warmup should be done:  42%|████▏     | 1268/3000 [00:00<00:00, 1806.42it/s]warmup should be done:  43%|████▎     | 1299/3000 [00:00<00:00, 1818.16it/s]warmup should be done:  50%|████▉     | 1486/3000 [00:00<00:00, 1860.31it/s]warmup should be done:  47%|████▋     | 1403/3000 [00:00<00:00, 1751.04it/s]warmup should be done:  48%|████▊     | 1451/3000 [00:00<00:00, 1811.06it/s]warmup should be done:  50%|████▉     | 1485/3000 [00:00<00:00, 1829.73it/s]warmup should be done:  56%|█████▌    | 1673/3000 [00:00<00:00, 1863.15it/s]warmup should be done:  53%|█████▎    | 1579/3000 [00:00<00:00, 1753.80it/s]warmup should be done:  54%|█████▍    | 1634/3000 [00:00<00:00, 1815.96it/s]warmup should be done:  56%|█████▌    | 1672/3000 [00:00<00:00, 1841.05it/s]warmup should be done:  62%|██████▏   | 1860/3000 [00:01<00:00, 1864.98it/s]warmup should be done:  59%|█████▊    | 1759/3000 [00:01<00:00, 1766.74it/s]warmup should be done:  61%|██████    | 1816/3000 [00:01<00:00, 1812.41it/s]warmup should be done:  62%|██████▏   | 1859/3000 [00:01<00:00, 1848.99it/s]warmup should be done:  68%|██████▊   | 2048/3000 [00:01<00:00, 1866.90it/s]warmup should be done:  65%|██████▍   | 1948/3000 [00:01<00:00, 1801.82it/s]warmup should be done:  67%|██████▋   | 1999/3000 [00:01<00:00, 1816.67it/s]warmup should be done:  68%|██████▊   | 2046/3000 [00:01<00:00, 1853.88it/s]warmup should be done:  74%|███████▍  | 2235/3000 [00:01<00:00, 1866.67it/s]warmup should be done:  71%|███████   | 2137/3000 [00:01<00:00, 1827.38it/s]warmup should be done:  73%|███████▎  | 2182/3000 [00:01<00:00, 1820.03it/s]warmup should be done:  74%|███████▍  | 2233/3000 [00:01<00:00, 1857.30it/s]warmup should be done:  78%|███████▊  | 2325/3000 [00:01<00:00, 1842.84it/s]warmup should be done:  81%|████████  | 2422/3000 [00:01<00:00, 1863.89it/s]warmup should be done:  79%|███████▉  | 2365/3000 [00:01<00:00, 1814.97it/s]warmup should be done:  81%|████████  | 2419/3000 [00:01<00:00, 1827.77it/s]warmup should be done:  87%|████████▋ | 2609/3000 [00:01<00:00, 1864.49it/s]warmup should be done:  84%|████████▍ | 2514/3000 [00:01<00:00, 1854.19it/s]warmup should be done:  85%|████████▍ | 2548/3000 [00:01<00:00, 1818.70it/s]warmup should be done:  87%|████████▋ | 2606/3000 [00:01<00:00, 1839.72it/s]warmup should be done:  93%|█████████▎| 2797/3000 [00:01<00:00, 1866.60it/s]warmup should be done:  90%|█████████ | 2703/3000 [00:01<00:00, 1862.33it/s]warmup should be done:  91%|█████████ | 2732/3000 [00:01<00:00, 1822.15it/s]warmup should be done:  93%|█████████▎| 2791/3000 [00:01<00:00, 1815.16it/s]warmup should be done:  99%|█████████▉| 2984/3000 [00:01<00:00, 1866.23it/s]warmup should be done:  96%|█████████▋| 2891/3000 [00:01<00:00, 1865.95it/s]warmup should be done:  97%|█████████▋| 2915/3000 [00:01<00:00, 1823.70it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1859.39it/s]warmup should be done:  99%|█████████▉| 2977/3000 [00:01<00:00, 1826.06it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1835.67it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1812.33it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1803.11it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f0dd1b35070>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f0dd1b35130>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f0dd1b35220>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f0dd1df7df0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 21:21:49.050863: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f09a5a670a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:21:49.050930: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:21:49.051534: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f09a926a900 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:21:49.051572: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:21:49.058188: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:21:49.058389: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:21:50.050448: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f09a926b0b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:21:50.050537: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:21:50.050913: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f09a92637b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 21:21:50.050955: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 21:21:50.057742: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:21:50.057743: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 21:21:50.190431: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:21:50.204802: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:21:50.707206: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:21:50.814349: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 21:21:56.197646: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:21:56.265468: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:21:56.448588: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 21:21:56.557293: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][21:22:55.041][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][21:22:55.041][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy rep_cache
[HCTR][21:22:55.046][ERROR][RK0][main]: coll ps creation done
[HCTR][21:22:55.046][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][21:22:55.164][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][21:22:55.164][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy rep_cache
[HCTR][21:22:55.167][ERROR][RK0][main]: coll ps creation done
[HCTR][21:22:55.167][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][21:22:55.438][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][21:22:55.438][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy rep_cache
[HCTR][21:22:55.443][ERROR][RK0][main]: coll ps creation done
[HCTR][21:22:55.443][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][21:22:55.837][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][21:22:55.837][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy rep_cache
[HCTR][21:22:55.841][ERROR][RK0][main]: coll ps creation done
[HCTR][21:22:55.841][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][21:22:55.841][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][21:22:56.769][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][21:22:56.800][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][21:22:56.800][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][21:22:56.800][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][21:22:56.800][ERROR][RK0][main]: Calling build_v2
[HCTR][21:22:56.800][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][21:22:56.800][ERROR][RK0][main]: Calling build_v2
[HCTR][21:22:56.800][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:22:56.800][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:22:56.800][ERROR][RK0][main]: Calling build_v2
[HCTR][21:22:56.801][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][21:22:56.801][ERROR][RK0][main]: Calling build_v2
[HCTR][21:22:56.801][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[2022-12-11 21:22:562022-12-11 21:22:56..801036801036: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:[:136136] ] using concurrent impl MPSusing concurrent impl MPS2022-12-11 21:22:56[

2022-12-11 21:22:56..801075801099: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc::136136] ] using concurrent impl MPSusing concurrent impl MPS

[2022-12-11 21:22:56.802227: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-11 21:22:56.802286: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 21:22:56212.] 802302build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 
E[ 2022-12-11 21:22:56/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:[8023241962022-12-11 21:22:56: ] .Eassigning 8 to cpu802339 
[: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 21:22:56E:. 196802356/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[] : :2022-12-11 21:22:56assigning 8 to cpuE213.
 ] 802393/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421: :
E[ 1962022-12-11 21:22:56/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] .:assigning 8 to cpu802491212
: ] Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 21:22:56.802565: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213[] 2022-12-11 21:22:56remote time is 8.68421.
802582: E[ 2022-12-11 21:22:56/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[.:2022-12-11 21:22:56802622212.: ] 802614Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4:  
E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214:] [212cpu time is 302022-12-11 21:22:56] 
.build symm link desc with 4X Tesla V100-SXM2-16GB out of 4802707
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2132022-12-11 21:22:56] .remote time is 8.68421802754
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-11 21:22:56213.] 802792remote time is 8.68421: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2142022-12-11 21:22:56] .cpu time is 30802839
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 21:23:22.375391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 21:23:22.434836: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-11 21:23:22.434923: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:919] num_cached_nodes = 3999999
[2022-12-11 21:23:22.593695: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 21:23:22.593788: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 21:23:22.593838: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 21:23:22.593868: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 21:23:22.595517: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:23:22.596562: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:23:22.597110: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:23:22.615919: [E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc2022-12-11 21:23:22:2022-12-11 21:23:22.202.615934] 615964: 3 solved: E
E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc[::2022-12-11 21:23:22202202.] ] 6160251 solved2 solved: 

E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:[205[2022-12-11 21:23:22] 2022-12-11 21:23:22.worker 0 thread 3 initing device 3.616064
616065: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc::205205] ] worker 0 thread 1 initing device 1
worker 0 thread 2 initing device 2
[2022-12-11 21:23:22.616332: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:23:22.616578: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:23:22.616611: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:23:22.618086: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:23:22[.2022-12-11 21:23:22618165.: 618171E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1980:] 1980eager alloc mem 381.47 MB] 
eager alloc mem 381.47 MB
[2022-12-11 21:23:22.619591: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:23:22.619622: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:23:22.619656: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 21:23:22.668358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.00 Bytes
[2022-12-11 21:23:22.668733: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 64.00 Bytes
[2022-12-11 21:23:22.670448: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64
[2022-12-11 21:23:22.670498: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 2
[2022-12-11 21:23:22.670538: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:23:22.671323: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:23:22.671654: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:23:22.672553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:23:22.672642: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:23:22.673266: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:23:22.673307: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[[2022-12-11 21:23:222022-12-11 21:23:222022-12-11 21:23:22...725247725247725246: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 2.00 Byteseager alloc mem 2.00 Byteseager alloc mem 2.00 Bytes


[2022-12-11 21:23:22.725588: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 64.00 Bytes
[2022-12-11 21:23:22.725663: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 64.00 Bytes
[2022-12-11 21:23:22.726072: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 64.00 Bytes
[2022-12-11 21:23:22.727262: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64
[2022-12-11 21:23:22.727306: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 2
[2022-12-11 21:23:22.727342: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 4000000002022-12-11 21:23:22
.727358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64
[2022-12-11 21:23:22.727407: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 2
[2022-12-11 21:23:22.727445: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:23:22.727752: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64
[2022-12-11 21:23:22.727794: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 2
[2022-12-11 21:23:22.727831: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 21:23:22.728196: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:23:22.728685: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:23:22.729444: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 15.64 MB
[2022-12-11 21:23:22.729725: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:23:22.729858: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:23:22.729940: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:23:22.730616: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:23:22.730689: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:23:22.730756: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:23:22.730830[: 2022-12-11 21:23:22E. 730835/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E1980 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager alloc mem 25.25 KB:
638] eager release cuda mem 625663
[2022-12-11 21:23:22.730928: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 21:23:22.731305: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:23:22.731344: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[2022-12-11 21:23:22.731474: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:23:22.731515: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[2022-12-11 21:23:22.731551: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 21:23:22.731590: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1.91 GB
[[2022-12-11 21:23:22[2022-12-11 21:23:22.2022-12-11 21:23:22.904498.904505: 904529: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980:1980] 1980] eager alloc mem 611.00 KB] eager alloc mem 611.00 KB
eager alloc mem 611.00 KB

[2022-12-11 21:23:22.904957: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-11 21:23:222022-12-11 21:23:22[..2022-12-11 21:23:22905422905427.: : 905435EE:   E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638638:] ] 638eager release cuda mem 625663eager release cuda mem 625663] 

eager release cuda mem 625663
[[2022-12-11 21:23:222022-12-11 21:23:22[..2022-12-11 21:23:22905585905588.: : 905597EE:   E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu19801980:] ] 1980eager alloc mem 611.00 KBeager alloc mem 611.00 KB] 

eager alloc mem 611.00 KB
[2022-12-11 21:23:22.905745: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:23:22.905805: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 21:23:22[.2022-12-11 21:23:22906422[.: 2022-12-11 21:23:22906428E.:  906439: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:E] 638 eager release cuda mem 625663[] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
2022-12-11 21:23:22eager release cuda mem 625663:.
638906544] : eager release cuda mem 625663E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[:2022-12-11 21:23:22638.] 906600eager release cuda mem 625663: 
E[ 2022-12-11 21:23:22/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[.:2022-12-11 21:23:229066171980.[: ] 9066302022-12-11 21:23:22Eeager alloc mem 611.00 KB: . 
E906650/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu : :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE1980: ] 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cueager alloc mem 611.00 KB] :
eager alloc mem 611.00 KB1980
] eager alloc mem 611.00 KB
[2022-12-11 21:23:22.907407: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 21:23:22.907443: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 16399996
[2022-12-11 21:23:22.907462: [[E2022-12-11 21:23:222022-12-11 21:23:22 ../hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc907474907475:: : 638EE]   eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
::638638] ] [eager release cuda mem 625663eager release cuda mem 6256632022-12-11 21:23:22

.907575: E[ [2022-12-11 21:23:22/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-11 21:23:22.:.907606638907609: ] : Eeager release cuda mem 16399996E 
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 16399996eager release cuda mem 16399996

[2022-12-11 21:23:22.908088: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1793] Collaborative GPU cache (policy: rep_cache) | local 3999999 / 100000000 nodes ( 4.00 %~4.00 %) | remote 0 / 100000000 nodes ( 0.00 %) | cpu 96000001 / 100000000 nodes ( 96.00 %) | 1.91 GB | 0.291521 secs 
[2022-12-11 21:23:22.908828: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1793] Collaborative GPU cache (policy: rep_cache) | local 3999999 / 100000000 nodes ( 4.00 %~4.00 %) | remote 0 / 100000000 nodes ( 0.00 %) | cpu 96000001 / 100000000 nodes ( 96.00 %) | 1.91 GB | 0.31332 secs 
[2022-12-11 21:23:22.909235: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1793] Collaborative GPU cache (policy: rep_cache) | local 3999999 / 100000000 nodes ( 4.00 %~4.00 %) | remote 0 / 100000000 nodes ( 0.00 %) | cpu 96000001 / 100000000 nodes ( 96.00 %) | 1.91 GB | 0.292914 secs 
[2022-12-11 21:23:22.909651: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1793] Collaborative GPU cache (policy: rep_cache) | local 3999999 / 100000000 nodes ( 4.00 %~4.00 %) | remote 0 / 100000000 nodes ( 0.00 %) | cpu 96000001 / 100000000 nodes ( 96.00 %) | 1.91 GB | 0.293053 secs 
[2022-12-11 21:23:22.910197: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.61 GB
[2022-12-11 21:23:23.854763: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 8.85 GB
[2022-12-11 21:23:23.854991: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 8.85 GB
[2022-12-11 21:23:23.855492: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 8.85 GB
[2022-12-11 21:23:24.725706: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.10 GB
[2022-12-11 21:23:24.726556: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.10 GB
[2022-12-11 21:23:24.726986: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.10 GB
[2022-12-11 21:23:25.486126: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.34 GB
[2022-12-11 21:23:25.486247: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.34 GB
[2022-12-11 21:23:25.486602: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.34 GB
[2022-12-11 21:23:26.315166: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.75 GB
[2022-12-11 21:23:26.315280: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.75 GB
[2022-12-11 21:23:26.315614: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.75 GB
[2022-12-11 21:23:27. 46398: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.94 GB
[2022-12-11 21:23:27. 46553: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.94 GB
[HCTR][21:23:27.247][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][21:23:27.247][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][21:23:27.247][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][21:23:27.247][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][21:23:27.247][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][21:23:27.247][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][21:23:27.247][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][21:23:27.247][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][21:23:27.247][ERROR][RK0][main]: init per replica done
[HCTR][21:23:27.247][ERROR][RK0][main]: init per replica done
[HCTR][21:23:27.247][ERROR][RK0][main]: init per replica done
[HCTR][21:23:27.250][ERROR][RK0][main]: init per replica done
[HCTR][21:23:27.283][ERROR][RK0][main]: 3 allocated 3276800 at 0x7ef06a238400
[HCTR][21:23:27.283][ERROR][RK0][main]: 3 allocated 6553600 at 0x7ef06a558400
[HCTR][21:23:27.283][ERROR][RK0][main]: 3 allocated 3276800 at 0x7ef06ab98400
[HCTR][21:23:27.283][ERROR][RK0][main]: 3 allocated 6553600 at 0x7ef06aeb8400
[HCTR][21:23:27.284][ERROR][RK0][main]: 2 allocated 3276800 at 0x7ef03c238400
[HCTR][21:23:27.285][ERROR][RK0][main]: 2 allocated 6553600 at 0x7ef03c558400
[HCTR][21:23:27.285][ERROR][RK0][main]: 2 allocated 3276800 at 0x7ef03cb98400
[HCTR][21:23:27.285][ERROR][RK0][main]: 2 allocated 6553600 at 0x7ef03ceb8400
[HCTR][21:23:27.285][ERROR][RK0][tid #139679760369408]: 1 allocated 3276800 at 0x7eefb8238400
[HCTR][21:23:27.285][ERROR][RK0][tid #139679760369408]: 1 allocated 6553600 at 0x7eefb8558400
[HCTR][21:23:27.285][ERROR][RK0][tid #139679760369408]: 1 allocated 3276800 at 0x7eefb8b98400
[HCTR][21:23:27.285][ERROR][RK0][tid #139679760369408]: 1 allocated 6553600 at 0x7eefb8eb8400
[HCTR][21:23:27.286][ERROR][RK0][main]: 0 allocated 3276800 at 0x7eef28320000
[HCTR][21:23:27.286][ERROR][RK0][main]: 0 allocated 6553600 at 0x7eef28640000
[HCTR][21:23:27.286][ERROR][RK0][main]: 0 allocated 3276800 at 0x7eef28c80000
[HCTR][21:23:27.286][ERROR][RK0][main]: 0 allocated 6553600 at 0x7eef28fa0000
