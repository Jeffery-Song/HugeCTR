2022-12-12 00:14:11.494866: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:14:11.506102: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:14:11.602897: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:14:11.603994: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 00:14:12.362507: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:14:12.362586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 00:14:12.375546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 00:14:12.382257: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:14:12.382329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 00:14:12.395006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 00:14:12.409637: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:14:12.409865: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:14:12.410291: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:14:12.410350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 00:14:12.411282: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 00:14:12.411331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 00:14:12.411417: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 00:14:12.423819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 00:14:12.426737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 00:14:12.428197: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:14:12.428323: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:14:12.430133: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 00:14:12.458893: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:14:12.459065: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:14:12.460460: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 00:14:12.463918: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:14:12.464110: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 00:14:12.465092: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][00:14:13.696][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:14:13.704][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:14:13.751][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][00:14:13.751][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.58s/it]warmup run: 100it [00:01, 82.52it/s]warmup run: 196it [00:01, 175.19it/s]warmup run: 294it [00:01, 280.43it/s]warmup run: 0it [00:00, ?it/s]warmup run: 380it [00:01, 371.04it/s]warmup run: 473it [00:02, 473.51it/s]warmup run: 569it [00:02, 574.33it/s]warmup run: 668it [00:02, 668.83it/s]warmup run: 761it [00:02, 725.29it/s]warmup run: 1it [00:00,  2.38it/s]warmup run: 869it [00:02, 815.21it/s]warmup run: 94it [00:00, 236.62it/s]warmup run: 981it [00:02, 896.71it/s]warmup run: 188it [00:00, 422.55it/s]warmup run: 261it [00:00, 479.10it/s]warmup run: 1083it [00:02, 868.23it/s]warmup run: 342it [00:00, 567.82it/s]warmup run: 1178it [00:02, 849.25it/s]warmup run: 1it [00:01,  1.49s/it]warmup run: 439it [00:00, 679.19it/s]warmup run: 1290it [00:02, 920.07it/s]warmup run: 103it [00:01, 89.94it/s]warmup run: 528it [00:01, 737.03it/s]warmup run: 1399it [00:03, 965.02it/s]warmup run: 208it [00:01, 196.68it/s]warmup run: 623it [00:01, 797.86it/s]warmup run: 1508it [00:03, 999.33it/s]warmup run: 315it [00:01, 316.15it/s]warmup run: 722it [00:01, 851.57it/s]warmup run: 1616it [00:03, 1019.39it/s]warmup run: 420it [00:01, 435.78it/s]warmup run: 820it [00:01, 888.97it/s]warmup run: 1725it [00:03, 1037.68it/s]warmup run: 523it [00:01, 547.62it/s]warmup run: 921it [00:01, 923.60it/s]warmup run: 1832it [00:03, 1046.23it/s]warmup run: 621it [00:02, 636.62it/s]warmup run: 1023it [00:01, 949.84it/s]warmup run: 1938it [00:03, 1042.22it/s]warmup run: 719it [00:02, 709.59it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1120it [00:01, 936.27it/s]warmup run: 2059it [00:03, 1089.44it/s]warmup run: 827it [00:02, 800.72it/s]warmup run: 1223it [00:01, 963.37it/s]warmup run: 2194it [00:03, 1165.14it/s]warmup run: 937it [00:02, 878.00it/s]warmup run: 1326it [00:01, 981.61it/s]warmup run: 2321it [00:03, 1194.15it/s]warmup run: 1046it [00:02, 933.70it/s]warmup run: 1432it [00:01, 1003.86it/s]warmup run: 2453it [00:03, 1230.88it/s]warmup run: 1154it [00:02, 973.24it/s]warmup run: 1533it [00:02, 988.23it/s] warmup run: 2584it [00:04, 1252.84it/s]warmup run: 1260it [00:02, 987.13it/s]warmup run: 1635it [00:02, 997.15it/s]warmup run: 2710it [00:04, 1252.68it/s]warmup run: 1372it [00:02, 1022.78it/s]warmup run: 1744it [00:02, 1022.22it/s]warmup run: 2836it [00:04, 1248.79it/s]warmup run: 1481it [00:02, 1040.06it/s]warmup run: 1849it [00:02, 1028.01it/s]warmup run: 2970it [00:04, 1273.77it/s]warmup run: 1594it [00:03, 1063.92it/s]warmup run: 3000it [00:04, 685.44it/s] warmup run: 1953it [00:02, 1031.28it/s]warmup run: 1708it [00:03, 1086.28it/s]warmup run: 2074it [00:02, 1083.63it/s]warmup run: 1822it [00:03, 1101.44it/s]warmup run: 2208it [00:02, 1159.28it/s]warmup run: 1934it [00:03, 1092.10it/s]warmup run: 2343it [00:02, 1214.53it/s]warmup run: 2053it [00:03, 1118.69it/s]warmup run: 2477it [00:02, 1249.79it/s]warmup run: 2187it [00:03, 1182.45it/s]warmup run: 2610it [00:02, 1273.43it/s]warmup run: 2320it [00:03, 1226.11it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 2744it [00:03, 1290.60it/s]warmup run: 2454it [00:03, 1257.37it/s]warmup run: 105it [00:01, 94.25it/s]warmup run: 2874it [00:03, 1285.78it/s]warmup run: 2587it [00:03, 1276.50it/s]warmup run: 209it [00:01, 201.90it/s]warmup run: 3000it [00:03, 917.50it/s] warmup run: 2719it [00:03, 1288.38it/s]warmup run: 314it [00:01, 320.50it/s]warmup run: 2850it [00:04, 1293.12it/s]warmup run: 420it [00:01, 443.46it/s]warmup run: 2983it [00:04, 1302.90it/s]warmup run: 3000it [00:04, 725.86it/s] warmup run: 523it [00:01, 555.33it/s]warmup run: 630it [00:02, 665.67it/s]warmup run: 739it [00:02, 764.45it/s]warmup run: 846it [00:02, 841.05it/s]warmup run: 952it [00:02, 898.35it/s]warmup run: 1057it [00:02, 937.55it/s]warmup run: 1163it [00:02, 971.73it/s]warmup run: 1269it [00:02, 996.39it/s]warmup run: 1375it [00:02, 1013.74it/s]warmup run: 1482it [00:02, 1030.19it/s]warmup run: 1590it [00:02, 1044.84it/s]warmup run: 1697it [00:03, 1045.01it/s]warmup run: 1805it [00:03, 1055.21it/s]warmup run: 1912it [00:03, 1056.95it/s]warmup run: 2019it [00:03, 1045.90it/s]warmup run: 2140it [00:03, 1091.91it/s]warmup run: 2262it [00:03, 1127.28it/s]warmup run: 2386it [00:03, 1160.46it/s]warmup run: 2517it [00:03, 1203.70it/s]warmup run: 2651it [00:03, 1243.36it/s]warmup run: 2784it [00:03, 1267.08it/s]warmup run: 2918it [00:04, 1287.84it/s]warmup run: 3000it [00:04, 726.29it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1737.30it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1696.61it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1617.74it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1675.41it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1753.25it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1742.44it/s]warmup should be done:  11%|█         | 337/3000 [00:00<00:01, 1692.94it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1740.23it/s]warmup should be done:  18%|█▊        | 527/3000 [00:00<00:01, 1747.88it/s]warmup should be done:  17%|█▋        | 523/3000 [00:00<00:01, 1740.92it/s]warmup should be done:  17%|█▋        | 522/3000 [00:00<00:01, 1729.79it/s]warmup should be done:  17%|█▋        | 507/3000 [00:00<00:01, 1677.31it/s]warmup should be done:  23%|██▎       | 703/3000 [00:00<00:01, 1751.22it/s]warmup should be done:  23%|██▎       | 699/3000 [00:00<00:01, 1746.03it/s]warmup should be done:  23%|██▎       | 700/3000 [00:00<00:01, 1745.58it/s]warmup should be done:  23%|██▎       | 679/3000 [00:00<00:01, 1690.37it/s]warmup should be done:  29%|██▉       | 879/3000 [00:00<00:01, 1748.84it/s]warmup should be done:  28%|██▊       | 849/3000 [00:00<00:01, 1691.51it/s]warmup should be done:  29%|██▉       | 874/3000 [00:00<00:01, 1729.21it/s]warmup should be done:  29%|██▉       | 875/3000 [00:00<00:01, 1730.54it/s]warmup should be done:  35%|███▌      | 1055/3000 [00:00<00:01, 1751.82it/s]warmup should be done:  34%|███▍      | 1026/3000 [00:00<00:01, 1716.35it/s]warmup should be done:  35%|███▍      | 1048/3000 [00:00<00:01, 1730.17it/s]warmup should be done:  35%|███▍      | 1049/3000 [00:00<00:01, 1731.23it/s]warmup should be done:  41%|████      | 1231/3000 [00:00<00:01, 1751.13it/s]warmup should be done:  40%|████      | 1201/3000 [00:00<00:01, 1725.82it/s]warmup should be done:  41%|████      | 1223/3000 [00:00<00:01, 1733.97it/s]warmup should be done:  41%|████      | 1223/3000 [00:00<00:01, 1718.15it/s]warmup should be done:  47%|████▋     | 1407/3000 [00:00<00:00, 1752.77it/s]warmup should be done:  46%|████▌     | 1380/3000 [00:00<00:00, 1743.61it/s]warmup should be done:  47%|████▋     | 1397/3000 [00:00<00:00, 1733.73it/s]warmup should be done:  47%|████▋     | 1399/3000 [00:00<00:00, 1728.58it/s]warmup should be done:  53%|█████▎    | 1583/3000 [00:00<00:00, 1754.14it/s]warmup should be done:  52%|█████▏    | 1555/3000 [00:00<00:00, 1738.93it/s]warmup should be done:  52%|█████▏    | 1572/3000 [00:00<00:00, 1735.92it/s]warmup should be done:  52%|█████▏    | 1572/3000 [00:00<00:00, 1724.50it/s]warmup should be done:  58%|█████▊    | 1746/3000 [00:01<00:00, 1734.73it/s]warmup should be done:  58%|█████▊    | 1733/3000 [00:01<00:00, 1748.46it/s]warmup should be done:  59%|█████▊    | 1759/3000 [00:01<00:00, 1736.32it/s]warmup should be done:  58%|█████▊    | 1750/3000 [00:01<00:00, 1741.06it/s]warmup should be done:  64%|██████▎   | 1910/3000 [00:01<00:00, 1753.50it/s]warmup should be done:  64%|██████▍   | 1920/3000 [00:01<00:00, 1734.38it/s]warmup should be done:  64%|██████▍   | 1933/3000 [00:01<00:00, 1730.44it/s]warmup should be done:  64%|██████▍   | 1927/3000 [00:01<00:00, 1748.44it/s]warmup should be done:  70%|██████▉   | 2088/3000 [00:01<00:00, 1760.98it/s]warmup should be done:  70%|██████▉   | 2094/3000 [00:01<00:00, 1733.05it/s]warmup should be done:  70%|███████   | 2107/3000 [00:01<00:00, 1730.37it/s]warmup should be done:  70%|███████   | 2102/3000 [00:01<00:00, 1736.18it/s]warmup should be done:  76%|███████▌  | 2265/3000 [00:01<00:00, 1754.47it/s]warmup should be done:  76%|███████▌  | 2268/3000 [00:01<00:00, 1724.43it/s]warmup should be done:  76%|███████▌  | 2281/3000 [00:01<00:00, 1728.36it/s]warmup should be done:  76%|███████▌  | 2279/3000 [00:01<00:00, 1744.16it/s]warmup should be done:  81%|████████▏ | 2441/3000 [00:01<00:00, 1752.87it/s]warmup should be done:  81%|████████▏ | 2443/3000 [00:01<00:00, 1729.12it/s]warmup should be done:  82%|████████▏ | 2457/3000 [00:01<00:00, 1735.08it/s]warmup should be done:  82%|████████▏ | 2454/3000 [00:01<00:00, 1735.44it/s]warmup should be done:  87%|████████▋ | 2619/3000 [00:01<00:00, 1738.23it/s]warmup should be done:  87%|████████▋ | 2617/3000 [00:01<00:00, 1750.34it/s]warmup should be done:  88%|████████▊ | 2632/3000 [00:01<00:00, 1737.47it/s]warmup should be done:  88%|████████▊ | 2632/3000 [00:01<00:00, 1746.40it/s]warmup should be done:  93%|█████████▎| 2795/3000 [00:01<00:00, 1744.61it/s]warmup should be done:  94%|█████████▎| 2807/3000 [00:01<00:00, 1739.74it/s]warmup should be done:  93%|█████████▎| 2793/3000 [00:01<00:00, 1739.65it/s]warmup should be done:  94%|█████████▎| 2810/3000 [00:01<00:00, 1753.65it/s]warmup should be done:  99%|█████████▉| 2971/3000 [00:01<00:00, 1748.96it/s]warmup should be done: 100%|█████████▉| 2985/3000 [00:01<00:00, 1748.45it/s]warmup should be done:  99%|█████████▉| 2970/3000 [00:01<00:00, 1748.51it/s]warmup should be done: 100%|█████████▉| 2988/3000 [00:01<00:00, 1759.58it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1743.26it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1740.36it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1736.98it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1733.88it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1797.68it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1777.62it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1736.03it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1770.37it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1806.06it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1809.52it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1791.65it/s]warmup should be done:  12%|█▏        | 358/3000 [00:00<00:01, 1791.62it/s]warmup should be done:  18%|█▊        | 541/3000 [00:00<00:01, 1804.45it/s]warmup should be done:  18%|█▊        | 541/3000 [00:00<00:01, 1808.88it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1802.95it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1805.49it/s]warmup should be done:  24%|██▍       | 724/3000 [00:00<00:01, 1811.45it/s]warmup should be done:  24%|██▍       | 726/3000 [00:00<00:01, 1814.77it/s]warmup should be done:  24%|██▍       | 724/3000 [00:00<00:01, 1814.00it/s]warmup should be done:  24%|██▍       | 724/3000 [00:00<00:01, 1800.35it/s]warmup should be done:  30%|███       | 909/3000 [00:00<00:01, 1818.88it/s]warmup should be done:  30%|███       | 907/3000 [00:00<00:01, 1815.85it/s]warmup should be done:  30%|███       | 907/3000 [00:00<00:01, 1817.94it/s]warmup should be done:  30%|███       | 905/3000 [00:00<00:01, 1798.45it/s]warmup should be done:  36%|███▋      | 1090/3000 [00:00<00:01, 1821.27it/s]warmup should be done:  36%|███▋      | 1093/3000 [00:00<00:01, 1822.67it/s]warmup should be done:  36%|███▋      | 1089/3000 [00:00<00:01, 1813.83it/s]warmup should be done:  36%|███▌      | 1086/3000 [00:00<00:01, 1800.08it/s]warmup should be done:  43%|████▎     | 1276/3000 [00:00<00:00, 1821.58it/s]warmup should be done:  42%|████▏     | 1271/3000 [00:00<00:00, 1810.06it/s]warmup should be done:  42%|████▏     | 1268/3000 [00:00<00:00, 1804.76it/s]warmup should be done:  42%|████▏     | 1273/3000 [00:00<00:00, 1805.14it/s]warmup should be done:  49%|████▊     | 1460/3000 [00:00<00:00, 1824.91it/s]warmup should be done:  48%|████▊     | 1453/3000 [00:00<00:00, 1808.37it/s]warmup should be done:  48%|████▊     | 1455/3000 [00:00<00:00, 1807.69it/s]warmup should be done:  48%|████▊     | 1449/3000 [00:00<00:00, 1773.27it/s]warmup should be done:  55%|█████▍    | 1644/3000 [00:00<00:00, 1827.12it/s]warmup should be done:  55%|█████▍    | 1636/3000 [00:00<00:00, 1812.08it/s]warmup should be done:  55%|█████▍    | 1638/3000 [00:00<00:00, 1812.01it/s]warmup should be done:  54%|█████▍    | 1634/3000 [00:00<00:00, 1794.58it/s]warmup should be done:  61%|██████    | 1827/3000 [00:01<00:00, 1827.65it/s]warmup should be done:  61%|██████    | 1818/3000 [00:01<00:00, 1814.16it/s]warmup should be done:  61%|██████    | 1825/3000 [00:01<00:00, 1828.45it/s]warmup should be done:  61%|██████    | 1820/3000 [00:01<00:00, 1812.71it/s]warmup should be done:  67%|██████▋   | 2010/3000 [00:01<00:00, 1824.25it/s]warmup should be done:  67%|██████▋   | 2000/3000 [00:01<00:00, 1812.40it/s]warmup should be done:  67%|██████▋   | 2012/3000 [00:01<00:00, 1838.24it/s]warmup should be done:  67%|██████▋   | 2007/3000 [00:01<00:00, 1828.00it/s]warmup should be done:  73%|███████▎  | 2193/3000 [00:01<00:00, 1822.70it/s]warmup should be done:  73%|███████▎  | 2182/3000 [00:01<00:00, 1809.95it/s]warmup should be done:  73%|███████▎  | 2199/3000 [00:01<00:00, 1844.88it/s]warmup should be done:  73%|███████▎  | 2194/3000 [00:01<00:00, 1838.68it/s]warmup should be done:  79%|███████▉  | 2377/3000 [00:01<00:00, 1825.16it/s]warmup should be done:  79%|███████▉  | 2364/3000 [00:01<00:00, 1810.29it/s]warmup should be done:  80%|███████▉  | 2385/3000 [00:01<00:00, 1848.94it/s]warmup should be done:  79%|███████▉  | 2380/3000 [00:01<00:00, 1844.83it/s]warmup should be done:  85%|████████▌ | 2561/3000 [00:01<00:00, 1828.69it/s]warmup should be done:  86%|████████▌ | 2572/3000 [00:01<00:00, 1852.46it/s]warmup should be done:  85%|████████▍ | 2546/3000 [00:01<00:00, 1805.86it/s]warmup should be done:  86%|████████▌ | 2566/3000 [00:01<00:00, 1848.34it/s]warmup should be done:  92%|█████████▏| 2746/3000 [00:01<00:00, 1832.59it/s]warmup should be done:  92%|█████████▏| 2758/3000 [00:01<00:00, 1852.27it/s]warmup should be done:  91%|█████████ | 2729/3000 [00:01<00:00, 1810.43it/s]warmup should be done:  92%|█████████▏| 2753/3000 [00:01<00:00, 1852.40it/s]warmup should be done:  98%|█████████▊| 2930/3000 [00:01<00:00, 1833.03it/s]warmup should be done:  98%|█████████▊| 2944/3000 [00:01<00:00, 1852.56it/s]warmup should be done:  97%|█████████▋| 2911/3000 [00:01<00:00, 1810.12it/s]warmup should be done:  98%|█████████▊| 2939/3000 [00:01<00:00, 1814.17it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1830.40it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1824.14it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1815.68it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1808.96it/s]2022-12-12 00:15:30.615101: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f18be26b1c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:15:30.615187: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:15:31.538672: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f18baa68e60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:15:31.538738: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:15:32.657879: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:15:33.172470: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:15:33.743325: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x1d3c57a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:15:33.743396: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:15:33.927244: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:15:34.297290: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:15:35.594387: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:15:35.756899: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:15:37.452226: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:15:37.742550: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f18be267350 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 00:15:37.742607: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 00:15:39.346247: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 00:15:39.371298: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:15:40.435907: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 00:15:40.800969: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 00:15:41.697695: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][00:16:08.124][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][00:16:08.124][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:16:08.127][ERROR][RK0][main]: coll ps creation done
[HCTR][00:16:08.127][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][00:16:08.140][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][00:16:08.140][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:16:08.144][ERROR][RK0][main]: coll ps creation done
[HCTR][00:16:08.144][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][00:16:08.398][ERROR][RK0][main]: replica 1 reaches 1000, calling init pre replica
[HCTR][00:16:08.399][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:16:08.402][ERROR][RK0][main]: coll ps creation done
[HCTR][00:16:08.402][ERROR][RK0][main]: replica 1 waits for coll ps creation barrier
[HCTR][00:16:08.453][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][00:16:08.453][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][00:16:08.461][ERROR][RK0][main]: coll ps creation done
[HCTR][00:16:08.461][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][00:16:08.461][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][00:16:09.372][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][00:16:09.417][ERROR][RK0][main]: replica 1 calling init per replica
[HCTR][00:16:09.417][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][00:16:09.417][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][00:16:09.417][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][00:16:09.417][ERROR][RK0][main]: Calling build_v2
[HCTR][00:16:09.417][ERROR][RK0][main]: Calling build_v2
[HCTR][00:16:09.417][ERROR][RK0][main]: Calling build_v2
[HCTR][00:16:09.417][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:16:09.417][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:16:09.417][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][00:16:09.417][ERROR][RK0][main]: Calling build_v2
[HCTR][00:16:09.417][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[2022-12-12 00:16:09[2022-12-12 00:16:09.2022-12-12 00:16:09.417352.2022-12-12 00:16:09417373: 417365.: E: 417368E E:  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc :136:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136] 136:] using concurrent impl MPS] 136using concurrent impl MPS
using concurrent impl MPS] 

using concurrent impl MPS
[2022-12-12 00:16:09.418735: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[1962022-12-12 00:16:09] .assigning 8 to cpu418758
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-12 00:16:09.[418789[2022-12-12 00:16:09: 2022-12-12 00:16:09.E.418803 418811: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: E:E 196 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:assigning 8 to cpu:212
196] [] build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-12 00:16:09assigning 8 to cpu
.
418920[: [2022-12-12 00:16:09E2022-12-12 00:16:09. .418950/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc418969[: :: 2022-12-12 00:16:09E212E. ]  418991/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :
:E212213 ] [] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-12 00:16:09remote time is 8.68421:
.
212419094] [[: build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-12 00:16:092022-12-12 00:16:09E
.. 419150419146[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: : 2022-12-12 00:16:09:EE.213  419192] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: remote time is 8.68421::E
213214 ] [] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.684212022-12-12 00:16:09cpu time is 30:
.
213419313] [: remote time is 8.684212022-12-12 00:16:09E
. 419363/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[: :2022-12-12 00:16:09E214. ] 419404/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30: :
E214 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cccpu time is 30:
214] cpu time is 30
[2022-12-12 00:16:33.326223: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 00:16:33.383103: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 00:16:33.383215: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 00:16:33.384404: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 00:16:33.505659: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 00:16:33.878615: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 00:16:33.878695: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 00:16:40.907891: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 00:16:40.908010: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 00:16:42.695511: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 00:16:42.695678: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 00:16:42.726293: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 00:16:42.726378: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 00:16:43.745219: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 00:16:43.760693: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 00:16:43.762025: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 00:16:43.771855: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 00:16:43.866292: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 00:16:46.830127: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 00:16:46.834416: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 00:16:46.834562: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 00:16:46.844615: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 00:16:46.844689: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 00:16:46.844726: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 00:16:46.844759: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 00:16:46.845419: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:16:46.845473: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:16:46.846542: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:16:46.847103: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:16:46.866494: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-12 00:16:46.866605: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-12 00:16:46.867291: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:16:46.867350: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:16:46.868187: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:16:46.868758: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:16:46.873603: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 00:16:46.873733: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 00:16:46.875914: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:16:46.876001: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:16:46.876077: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-12 00:16:46.876165: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-12 00:16:46.876859: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 00:16:46.876912: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:16:46.877016: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:16:46.878067: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:16:46.878167: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:16:46.879284: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 00:16:46.936832: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 00:16:46.939737: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 00:16:46.939826: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:16:46.940660: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:16:46.941171: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:16:46.942159: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:16:46.942206: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.77 MB
[2022-12-12 00:16:46.966410: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:16:46.967065: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:16:46.967112: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[[2022-12-12 00:16:462022-12-12 00:16:46..968540968548: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-12 00:16:46.970428: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 00:16:46.970478: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:16:46.971155: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 00:16:46.971232: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:16:46.979440: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:16:46.980078: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 00:16:46.980390: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:16:46.[9813992022-12-12 00:16:46: .E981419 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 611.00 KB1980
] eager alloc mem 611.00 KB
[2022-12-12 00:16:46.982357: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 00:16:46.982413: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 00:16:46.982518: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-12 00:16:46:.638982553] : eager release cuda mem 625663E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:16:46.982640: [W2022-12-12 00:16:46 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc982663:: 43W]  WORKER[0] alloc host memory 45.77 MB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc
:43] WORKER[0] alloc host memory 45.77 MB
[2022-12-12 00:16:46.983181: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 46.16 MB
[2022-12-12 00:16:46.983633: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:16:46.984577: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:16:46.984621: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 45.78 MB
[2022-12-12 00:16:47.  7158: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:16:47.  7378: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:16:47.  7746: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:16:47.  7789: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[2022-12-12 00:16:47.  7944: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:16:47.  7986: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[2022-12-12 00:16:47. 37844: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 00:16:47. 38441: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 00:16:47. 38489: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.73 GB
[[[[2022-12-12 00:16:472022-12-12 00:16:472022-12-12 00:16:472022-12-12 00:16:47....553809553809553823553814: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] Device 1 init p2p of link 2] ] Device 0 init p2p of link 1
Device 3 init p2p of link 0Device 2 init p2p of link 3


[2022-12-12 00:16:47.[[[5541452022-12-12 00:16:472022-12-12 00:16:472022-12-12 00:16:47: ...E554150554149554153 : : : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuEEE:   1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :::eager alloc mem 611.00 KB198019801980
] ] ] eager alloc mem 611.00 KBeager alloc mem 611.00 KBeager alloc mem 611.00 KB


[2022-12-12 00:16:47.[555077[2022-12-12 00:16:47: [2022-12-12 00:16:47.E2022-12-12 00:16:47.555084 .555093: /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc555099: E:: E 638E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc]  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638
:638] 638] eager release cuda mem 625663] eager release cuda mem 625663
eager release cuda mem 625663

[2022-12-12 00:16:47.562828: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-12 00:16:47.563012: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-12 00:16:472022-12-12 00:16:47..563050563051: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19261926] ] [Device 0 init p2p of link 2Device 3 init p2p of link 12022-12-12 00:16:47

.563098: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] [Device 2 init p2p of link 02022-12-12 00:16:47
.563207: [E2022-12-12 00:16:47 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu563227:: 1980E]  eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-12 00:16:47.563342: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:16:47.563885: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:16:47.564042: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:16:47.564074: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:16:47.564268: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:16:47.571262: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 00:16:47.571348: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:16:47.571405: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 00:16:47.571489: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:16:47.571515: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 00:16:47.571593: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:[19262022-12-12 00:16:47] .Device 2 init p2p of link 1571620
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:16:47.571702: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 00:16:47.572151: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:16:47.572287: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:16:47.572462: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:16:47.572508: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 00:16:47.578510: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:16:47.578824: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11999865 / 100000000 nodes ( 12.00 %~12.00 %) | remote 32997110 / 100000000 nodes ( 33.00 %) | cpu 55003025 / 100000000 nodes ( 55.00 %) | 5.73 GB | 0.711495 secs 
[2022-12-12 00:16:47.578866: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:16:47.578926: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:16:47.579028: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 48399996
[2022-12-12 00:16:47.579202: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11999039 / 100000000 nodes ( 12.00 %~12.00 %) | remote 32997936 / 100000000 nodes ( 33.00 %) | cpu 55003025 / 100000000 nodes ( 55.00 %) | 5.73 GB | 0.733734 secs 
[2022-12-12 00:16:47.579479: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11999321 / 100000000 nodes ( 12.00 %~12.00 %) | remote 32997654 / 100000000 nodes ( 33.00 %) | cpu 55003025 / 100000000 nodes ( 55.00 %) | 5.73 GB | 0.703519 secs 
[2022-12-12 00:16:47.579588: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 11998750 / 100000000 nodes ( 12.00 %~12.00 %) | remote 32998225 / 100000000 nodes ( 33.00 %) | cpu 55003025 / 100000000 nodes ( 55.00 %) | 5.73 GB | 0.702691 secs 
[2022-12-12 00:16:47.580021: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.75 GB
[2022-12-12 00:16:48.515852: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.00 GB
[2022-12-12 00:16:48.516344: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.00 GB
[2022-12-12 00:16:48.516754: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.00 GB
[2022-12-12 00:16:49.283810: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.25 GB
[2022-12-12 00:16:49.307782: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.25 GB
[2022-12-12 00:16:49.308462: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.25 GB
[2022-12-12 00:16:50.194696: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.49 GB
[2022-12-12 00:16:50.194821: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.49 GB
[2022-12-12 00:16:50.195179: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.49 GB
[2022-12-12 00:16:51.144505: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 11.90 GB
[2022-12-12 00:16:51.144622: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 11.90 GB
[2022-12-12 00:16:51.144905: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 11.90 GB
[2022-12-12 00:16:51.947372: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.09 GB
[2022-12-12 00:16:51.947521: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.09 GB
[HCTR][00:16:51.947][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][00:16:51.947][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][00:16:51.947][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier
[HCTR][00:16:51.947][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][00:16:51.947][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][00:16:51.947][ERROR][RK0][main]: replica 1 calling init per replica done, doing barrier done
[HCTR][00:16:51.947][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][00:16:51.947][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][00:16:51.947][ERROR][RK0][main]: init per replica done
[HCTR][00:16:51.947][ERROR][RK0][main]: init per replica done
[HCTR][00:16:51.947][ERROR][RK0][main]: init per replica done
[HCTR][00:16:51.950][ERROR][RK0][main]: init per replica done
[HCTR][00:16:51.955][ERROR][RK0][tid #139744637855488]: 2 allocated 3276800 at 0x7f06b3520000
[HCTR][00:16:51.955][ERROR][RK0][tid #139744637855488]: 2 allocated 6553600 at 0x7f06b6e00000
[HCTR][00:16:51.955][ERROR][RK0][tid #139744637855488]: 2 allocated 3276800 at 0x7f06b7440000
[HCTR][00:16:51.955][ERROR][RK0][tid #139744637855488]: 2 allocated 6553600 at 0x7f06b7760000
[HCTR][00:16:51.956][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f06af520000
[HCTR][00:16:51.956][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f06b2e00000
[HCTR][00:16:51.956][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f06b3440000
[HCTR][00:16:51.956][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f06b3760000
[HCTR][00:16:51.956][ERROR][RK0][tid #139744637855488]: 1 allocated 3276800 at 0x7f06b3520000
[HCTR][00:16:51.956][ERROR][RK0][tid #139744637855488]: 1 allocated 6553600 at 0x7f06b6e00000
[HCTR][00:16:51.956][ERROR][RK0][tid #139744637855488]: 1 allocated 3276800 at 0x7f06b7440000
[HCTR][00:16:51.956][ERROR][RK0][tid #139744637855488]: 1 allocated 6553600 at 0x7f06b7760000
[HCTR][00:16:51.958][ERROR][RK0][tid #139744772073216]: 0 allocated 3276800 at 0x7effea320000
[HCTR][00:16:51.958][ERROR][RK0][tid #139744772073216]: 0 allocated 6553600 at 0x7f1a47200000
[HCTR][00:16:51.958][ERROR][RK0][tid #139744772073216]: 0 allocated 3276800 at 0x7effead0e800
[HCTR][00:16:51.958][ERROR][RK0][tid #139744772073216]: 0 allocated 6553600 at 0x7effeb02e800




