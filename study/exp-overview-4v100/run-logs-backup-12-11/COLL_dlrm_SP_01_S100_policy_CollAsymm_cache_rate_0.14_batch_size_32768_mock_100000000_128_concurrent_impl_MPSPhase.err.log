2022-12-12 01:05:12.321069: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:05:12.414042: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:05:12.414041: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:05:12.414220: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:05:13.232637: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:05:13.232720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:05:13.245268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:05:13.275847: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:05:13.276023: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:05:13.278113: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 01:05:13.321593: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:05:13.321674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:05:13.322319: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:05:13.322373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:05:13.328675: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:05:13.328751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:05:13.335336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:05:13.335795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:05:13.340757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:05:13.365571: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:05:13.365756: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:05:13.367280: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 01:05:13.367622: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:05:13.367744: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:05:13.369164: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 01:05:13.371390: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:05:13.371500: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:05:13.372269: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][01:05:14.603][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:05:14.607][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:05:14.637][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:05:14.648][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.46s/it]warmup run: 1it [00:01,  1.45s/it]warmup run: 97it [00:01, 85.95it/s]warmup run: 110it [00:01, 98.30it/s]warmup run: 201it [00:01, 193.34it/s]warmup run: 218it [00:01, 209.57it/s]warmup run: 310it [00:01, 317.27it/s]warmup run: 325it [00:01, 329.30it/s]warmup run: 1it [00:01,  1.51s/it]warmup run: 413it [00:01, 434.51it/s]warmup run: 432it [00:01, 452.12it/s]warmup run: 79it [00:01, 68.00it/s]warmup run: 516it [00:01, 546.67it/s]warmup run: 543it [00:01, 578.15it/s]warmup run: 174it [00:01, 164.83it/s]warmup run: 614it [00:02, 638.65it/s]warmup run: 1it [00:01,  1.46s/it]warmup run: 655it [00:02, 694.05it/s]warmup run: 284it [00:01, 291.47it/s]warmup run: 719it [00:02, 734.49it/s]warmup run: 110it [00:01, 97.75it/s]warmup run: 763it [00:02, 784.44it/s]warmup run: 391it [00:01, 417.23it/s]warmup run: 819it [00:02, 799.68it/s]warmup run: 220it [00:01, 210.74it/s]warmup run: 870it [00:02, 852.33it/s]warmup run: 497it [00:02, 537.37it/s]warmup run: 924it [00:02, 864.74it/s]warmup run: 329it [00:01, 332.48it/s]warmup run: 976it [00:02, 904.17it/s]warmup run: 604it [00:02, 649.77it/s]warmup run: 1027it [00:02, 908.20it/s]warmup run: 432it [00:01, 447.14it/s]warmup run: 1085it [00:02, 952.72it/s]warmup run: 711it [00:02, 746.33it/s]warmup run: 1129it [00:02, 930.93it/s]warmup run: 540it [00:01, 567.63it/s]warmup run: 1192it [00:02, 975.05it/s]warmup run: 814it [00:02, 811.81it/s]warmup run: 1236it [00:02, 968.32it/s]warmup run: 647it [00:02, 674.62it/s]warmup run: 1300it [00:02, 1002.21it/s]warmup run: 916it [00:02, 857.37it/s]warmup run: 1340it [00:02, 987.72it/s]warmup run: 755it [00:02, 767.91it/s]warmup run: 1407it [00:02, 1019.21it/s]warmup run: 1017it [00:02, 893.20it/s]warmup run: 862it [00:02, 843.47it/s]warmup run: 1447it [00:02, 1009.05it/s]warmup run: 1515it [00:02, 1036.46it/s]warmup run: 1128it [00:02, 952.45it/s]warmup run: 1553it [00:02, 1022.13it/s]warmup run: 970it [00:02, 904.02it/s]warmup run: 1627it [00:02, 1058.37it/s]warmup run: 1237it [00:02, 989.71it/s]warmup run: 1660it [00:03, 1034.42it/s]warmup run: 1076it [00:02, 943.17it/s]warmup run: 1735it [00:03, 1053.38it/s]warmup run: 1343it [00:02, 1008.72it/s]warmup run: 1767it [00:03, 1043.39it/s]warmup run: 1182it [00:02, 962.43it/s]warmup run: 1844it [00:03, 1062.30it/s]warmup run: 1451it [00:02, 1027.22it/s]warmup run: 1873it [00:03, 1045.38it/s]warmup run: 1288it [00:02, 988.30it/s]warmup run: 1953it [00:03, 1069.98it/s]warmup run: 1558it [00:03, 1038.66it/s]warmup run: 1980it [00:03, 1051.42it/s]warmup run: 1394it [00:02, 1006.75it/s]warmup run: 2074it [00:03, 1110.48it/s]warmup run: 1667it [00:03, 1050.76it/s]warmup run: 2110it [00:03, 1124.57it/s]warmup run: 1503it [00:02, 1028.42it/s]warmup run: 2206it [00:03, 1171.44it/s]warmup run: 1776it [00:03, 1059.65it/s]warmup run: 2245it [00:03, 1190.88it/s]warmup run: 1609it [00:02, 1032.82it/s]warmup run: 2340it [00:03, 1219.66it/s]warmup run: 1884it [00:03, 1058.54it/s]warmup run: 2380it [00:03, 1235.91it/s]warmup run: 1715it [00:03, 1036.43it/s]warmup run: 2475it [00:03, 1256.09it/s]warmup run: 1991it [00:03, 1043.50it/s]warmup run: 2508it [00:03, 1248.73it/s]warmup run: 1821it [00:03, 1029.36it/s]warmup run: 2610it [00:03, 1281.40it/s]warmup run: 2122it [00:03, 1119.99it/s]warmup run: 2640it [00:03, 1268.49it/s]warmup run: 1928it [00:03, 1039.27it/s]warmup run: 2744it [00:03, 1296.21it/s]warmup run: 2257it [00:03, 1186.08it/s]warmup run: 2775it [00:03, 1292.36it/s]warmup run: 2043it [00:03, 1069.88it/s]warmup run: 2878it [00:03, 1309.04it/s]warmup run: 2392it [00:03, 1232.87it/s]warmup run: 2907it [00:04, 1299.82it/s]warmup run: 2177it [00:03, 1149.49it/s]warmup run: 3000it [00:04, 736.72it/s] warmup run: 2526it [00:03, 1263.80it/s]warmup run: 3000it [00:04, 721.39it/s] warmup run: 2310it [00:03, 1202.50it/s]warmup run: 2653it [00:03, 1265.55it/s]warmup run: 2442it [00:03, 1237.33it/s]warmup run: 2790it [00:04, 1295.38it/s]warmup run: 2577it [00:03, 1269.27it/s]warmup run: 2927it [00:04, 1316.30it/s]warmup run: 3000it [00:04, 714.44it/s] warmup run: 2712it [00:03, 1290.53it/s]warmup run: 2845it [00:03, 1301.31it/s]warmup run: 2976it [00:04, 1258.16it/s]warmup run: 3000it [00:04, 727.70it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1758.96it/s]warmup should be done:   6%|▌         | 176/3000 [00:00<00:01, 1754.92it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1687.39it/s]warmup should be done:   6%|▌         | 174/3000 [00:00<00:01, 1736.15it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1776.28it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1787.18it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1778.16it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1720.95it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1776.49it/s]warmup should be done:  18%|█▊        | 537/3000 [00:00<00:01, 1791.69it/s]warmup should be done:  18%|█▊        | 534/3000 [00:00<00:01, 1780.10it/s]warmup should be done:  17%|█▋        | 517/3000 [00:00<00:01, 1693.28it/s]warmup should be done:  24%|██▍       | 714/3000 [00:00<00:01, 1787.30it/s]warmup should be done:  24%|██▍       | 719/3000 [00:00<00:01, 1798.94it/s]warmup should be done:  24%|██▍       | 715/3000 [00:00<00:01, 1788.59it/s]warmup should be done:  23%|██▎       | 689/3000 [00:00<00:01, 1700.49it/s]warmup should be done:  30%|██▉       | 893/3000 [00:00<00:01, 1784.80it/s]warmup should be done:  30%|██▉       | 899/3000 [00:00<00:01, 1799.22it/s]warmup should be done:  30%|██▉       | 894/3000 [00:00<00:01, 1789.07it/s]warmup should be done:  29%|██▉       | 867/3000 [00:00<00:01, 1727.11it/s]warmup should be done:  36%|███▌      | 1079/3000 [00:00<00:01, 1797.94it/s]warmup should be done:  36%|███▌      | 1072/3000 [00:00<00:01, 1774.85it/s]warmup should be done:  35%|███▍      | 1045/3000 [00:00<00:01, 1742.87it/s]warmup should be done:  36%|███▌      | 1073/3000 [00:00<00:01, 1752.81it/s]warmup should be done:  42%|████▏     | 1261/3000 [00:00<00:00, 1803.11it/s]warmup should be done:  42%|████▏     | 1250/3000 [00:00<00:00, 1769.87it/s]warmup should be done:  41%|████      | 1225/3000 [00:00<00:01, 1758.30it/s]warmup should be done:  42%|████▏     | 1254/3000 [00:00<00:00, 1770.03it/s]warmup should be done:  48%|████▊     | 1427/3000 [00:00<00:00, 1768.03it/s]warmup should be done:  47%|████▋     | 1405/3000 [00:00<00:00, 1768.55it/s]warmup should be done:  48%|████▊     | 1432/3000 [00:00<00:00, 1765.04it/s]warmup should be done:  48%|████▊     | 1442/3000 [00:00<00:00, 1760.83it/s]warmup should be done:  54%|█████▎    | 1605/3000 [00:00<00:00, 1770.64it/s]warmup should be done:  53%|█████▎    | 1585/3000 [00:00<00:00, 1776.64it/s]warmup should be done:  54%|█████▍    | 1622/3000 [00:00<00:00, 1772.21it/s]warmup should be done:  54%|█████▎    | 1609/3000 [00:00<00:00, 1692.32it/s]warmup should be done:  59%|█████▉    | 1784/3000 [00:01<00:00, 1775.50it/s]warmup should be done:  59%|█████▉    | 1766/3000 [00:01<00:00, 1784.37it/s]warmup should be done:  60%|██████    | 1802/3000 [00:01<00:00, 1779.20it/s]warmup should be done:  60%|█████▉    | 1787/3000 [00:01<00:00, 1715.74it/s]warmup should be done:  65%|██████▌   | 1964/3000 [00:01<00:00, 1781.41it/s]warmup should be done:  66%|██████▌   | 1982/3000 [00:01<00:00, 1783.54it/s]warmup should be done:  65%|██████▍   | 1945/3000 [00:01<00:00, 1728.40it/s]warmup should be done:  65%|██████▌   | 1960/3000 [00:01<00:00, 1719.31it/s]warmup should be done:  71%|███████▏  | 2143/3000 [00:01<00:00, 1780.79it/s]warmup should be done:  72%|███████▏  | 2162/3000 [00:01<00:00, 1787.77it/s]warmup should be done:  71%|███████   | 2119/3000 [00:01<00:00, 1715.23it/s]warmup should be done:  71%|███████   | 2133/3000 [00:01<00:00, 1711.03it/s]warmup should be done:  77%|███████▋  | 2322/3000 [00:01<00:00, 1775.79it/s]warmup should be done:  78%|███████▊  | 2341/3000 [00:01<00:00, 1787.98it/s]warmup should be done:  76%|███████▋  | 2291/3000 [00:01<00:00, 1712.63it/s]warmup should be done:  77%|███████▋  | 2309/3000 [00:01<00:00, 1723.15it/s]warmup should be done:  83%|████████▎ | 2503/3000 [00:01<00:00, 1784.24it/s]warmup should be done:  84%|████████▍ | 2521/3000 [00:01<00:00, 1791.46it/s]warmup should be done:  82%|████████▏ | 2470/3000 [00:01<00:00, 1733.67it/s]warmup should be done:  83%|████████▎ | 2488/3000 [00:01<00:00, 1742.84it/s]warmup should be done:  89%|████████▉ | 2683/3000 [00:01<00:00, 1787.17it/s]warmup should be done:  90%|█████████ | 2701/3000 [00:01<00:00, 1791.35it/s]warmup should be done:  88%|████████▊ | 2648/3000 [00:01<00:00, 1745.15it/s]warmup should be done:  89%|████████▉ | 2667/3000 [00:01<00:00, 1754.17it/s]warmup should be done:  95%|█████████▌| 2864/3000 [00:01<00:00, 1791.43it/s]warmup should be done:  96%|█████████▌| 2881/3000 [00:01<00:00, 1788.87it/s]warmup should be done:  94%|█████████▍| 2826/3000 [00:01<00:00, 1753.10it/s]warmup should be done:  95%|█████████▍| 2845/3000 [00:01<00:00, 1759.96it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1778.31it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1772.12it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1749.47it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1742.18it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1805.16it/s]warmup should be done:   6%|▌         | 181/3000 [00:00<00:01, 1802.67it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1695.45it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1664.15it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1744.59it/s]warmup should be done:  12%|█▏        | 365/3000 [00:00<00:01, 1820.43it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1721.51it/s]warmup should be done:  12%|█▏        | 362/3000 [00:00<00:01, 1780.42it/s]warmup should be done:  18%|█▊        | 525/3000 [00:00<00:01, 1752.29it/s]warmup should be done:  18%|█▊        | 549/3000 [00:00<00:01, 1825.30it/s]warmup should be done:  17%|█▋        | 523/3000 [00:00<00:01, 1749.76it/s]warmup should be done:  18%|█▊        | 543/3000 [00:00<00:01, 1790.04it/s]warmup should be done:  23%|██▎       | 701/3000 [00:00<00:01, 1752.76it/s]warmup should be done:  24%|██▎       | 707/3000 [00:00<00:01, 1781.52it/s]warmup should be done:  24%|██▍       | 724/3000 [00:00<00:01, 1795.24it/s]warmup should be done:  24%|██▍       | 732/3000 [00:00<00:01, 1806.42it/s]warmup should be done:  30%|██▉       | 891/3000 [00:00<00:01, 1802.23it/s]warmup should be done:  30%|███       | 907/3000 [00:00<00:01, 1804.29it/s]warmup should be done:  31%|███       | 918/3000 [00:00<00:01, 1824.42it/s]warmup should be done:  29%|██▉       | 877/3000 [00:00<00:01, 1733.29it/s]warmup should be done:  36%|███▌      | 1072/3000 [00:00<00:01, 1801.94it/s]warmup should be done:  36%|███▋      | 1089/3000 [00:00<00:01, 1808.95it/s]warmup should be done:  35%|███▌      | 1054/3000 [00:00<00:01, 1745.03it/s]warmup should be done:  37%|███▋      | 1101/3000 [00:00<00:01, 1794.87it/s]warmup should be done:  42%|████▏     | 1257/3000 [00:00<00:00, 1817.23it/s]warmup should be done:  42%|████▏     | 1271/3000 [00:00<00:00, 1811.45it/s]warmup should be done:  41%|████      | 1230/3000 [00:00<00:01, 1747.08it/s]warmup should be done:  43%|████▎     | 1281/3000 [00:00<00:00, 1794.10it/s]warmup should be done:  48%|████▊     | 1441/3000 [00:00<00:00, 1823.49it/s]warmup should be done:  48%|████▊     | 1453/3000 [00:00<00:00, 1813.03it/s]warmup should be done:  47%|████▋     | 1407/3000 [00:00<00:00, 1753.42it/s]warmup should be done:  49%|████▉     | 1463/3000 [00:00<00:00, 1802.06it/s]warmup should be done:  54%|█████▍    | 1627/3000 [00:00<00:00, 1834.45it/s]warmup should be done:  55%|█████▍    | 1635/3000 [00:00<00:00, 1813.61it/s]warmup should be done:  53%|█████▎    | 1584/3000 [00:00<00:00, 1757.42it/s]warmup should be done:  55%|█████▍    | 1646/3000 [00:00<00:00, 1808.31it/s]warmup should be done:  60%|██████    | 1813/3000 [00:01<00:00, 1840.55it/s]warmup should be done:  61%|██████    | 1817/3000 [00:01<00:00, 1813.79it/s]warmup should be done:  59%|█████▊    | 1762/3000 [00:01<00:00, 1763.36it/s]warmup should be done:  61%|██████    | 1829/3000 [00:01<00:00, 1814.00it/s]warmup should be done:  67%|██████▋   | 1999/3000 [00:01<00:00, 1844.59it/s]warmup should be done:  67%|██████▋   | 1999/3000 [00:01<00:00, 1813.21it/s]warmup should be done:  65%|██████▍   | 1946/3000 [00:01<00:00, 1784.51it/s]warmup should be done:  67%|██████▋   | 2012/3000 [00:01<00:00, 1818.53it/s]warmup should be done:  73%|███████▎  | 2185/3000 [00:01<00:00, 1847.83it/s]warmup should be done:  73%|███████▎  | 2181/3000 [00:01<00:00, 1812.66it/s]warmup should be done:  71%|███████   | 2129/3000 [00:01<00:00, 1797.02it/s]warmup should be done:  73%|███████▎  | 2195/3000 [00:01<00:00, 1820.89it/s]warmup should be done:  79%|███████▉  | 2372/3000 [00:01<00:00, 1851.85it/s]warmup should be done:  79%|███████▉  | 2363/3000 [00:01<00:00, 1813.83it/s]warmup should be done:  77%|███████▋  | 2312/3000 [00:01<00:00, 1804.52it/s]warmup should be done:  79%|███████▉  | 2378/3000 [00:01<00:00, 1823.20it/s]warmup should be done:  85%|████████▌ | 2559/3000 [00:01<00:00, 1856.11it/s]warmup should be done:  85%|████████▍ | 2545/3000 [00:01<00:00, 1789.14it/s]warmup should be done:  83%|████████▎ | 2493/3000 [00:01<00:00, 1781.15it/s]warmup should be done:  85%|████████▌ | 2561/3000 [00:01<00:00, 1769.27it/s]warmup should be done:  92%|█████████▏| 2746/3000 [00:01<00:00, 1857.46it/s]warmup should be done:  89%|████████▉ | 2673/3000 [00:01<00:00, 1784.81it/s]warmup should be done:  91%|█████████ | 2724/3000 [00:01<00:00, 1769.92it/s]warmup should be done:  91%|█████████▏| 2742/3000 [00:01<00:00, 1780.58it/s]warmup should be done:  98%|█████████▊| 2932/3000 [00:01<00:00, 1856.71it/s]warmup should be done:  95%|█████████▌| 2857/3000 [00:01<00:00, 1800.69it/s]warmup should be done:  97%|█████████▋| 2902/3000 [00:01<00:00, 1752.44it/s]warmup should be done:  97%|█████████▋| 2924/3000 [00:01<00:00, 1790.47it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1827.25it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1802.48it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1786.54it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1771.48it/s]2022-12-12 01:06:27.281375: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1762a69140 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:06:27.281436: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:06:28.368531: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f175a2653f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:06:28.368605: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:06:28.404916: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f1762a68bf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:06:28.404987: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:06:29.176266: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x1d351970 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:06:29.176331: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:06:29.892007: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:06:30.002582: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:06:30.809795: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:06:31.000363: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:06:31.113976: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:06:31.789914: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:06:31.947033: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:06:32.449118: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:06:32.450443: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:06:33.347554: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:06:33.369858: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:06:35.023782: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][01:07:04.503][ERROR][RK0][tid #139738505803520]: replica 1 reaches 1000, calling init pre replica
[HCTR][01:07:04.503][ERROR][RK0][tid #139738505803520]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:07:04.509][ERROR][RK0][tid #139738505803520]: coll ps creation done
[HCTR][01:07:04.509][ERROR][RK0][tid #139738505803520]: replica 1 waits for coll ps creation barrier
[HCTR][01:07:04.544][ERROR][RK0][tid #139738505803520]: replica 3 reaches 1000, calling init pre replica
[HCTR][01:07:04.544][ERROR][RK0][tid #139738505803520]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:07:04.547][ERROR][RK0][tid #139738505803520]: coll ps creation done
[HCTR][01:07:04.547][ERROR][RK0][tid #139738505803520]: replica 3 waits for coll ps creation barrier
[HCTR][01:07:04.758][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][01:07:04.759][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:07:04.761][ERROR][RK0][tid #139738505803520]: replica 2 reaches 1000, calling init pre replica
[HCTR][01:07:04.761][ERROR][RK0][tid #139738505803520]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:07:04.764][ERROR][RK0][tid #139738505803520]: coll ps creation done
[HCTR][01:07:04.764][ERROR][RK0][tid #139738505803520]: replica 2 waits for coll ps creation barrier
[HCTR][01:07:04.765][ERROR][RK0][main]: coll ps creation done
[HCTR][01:07:04.765][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][01:07:04.765][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][01:07:06.012][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][01:07:06.055][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][01:07:06.055][ERROR][RK0][tid #139738505803520]: replica 2 calling init per replica
[HCTR][01:07:06.055][ERROR][RK0][tid #139738505803520]: replica 1 calling init per replica
[HCTR][01:07:06.055][ERROR][RK0][main]: Calling build_v2
[HCTR][01:07:06.055][ERROR][RK0][tid #139738505803520]: Calling build_v2
[HCTR][01:07:06.055][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:07:06.055][ERROR][RK0][tid #139738505803520]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:07:06.055][ERROR][RK0][tid #139738505803520]: Calling build_v2
[HCTR][01:07:06.055][ERROR][RK0][tid #139738505803520]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:07:06.055][ERROR][RK0][tid #139738505803520]: replica 3 calling init per replica
[HCTR][01:07:06.055][ERROR][RK0][tid #139738505803520]: Calling build_v2
[[[[HCTR][01:07:06.055][ERROR][RK0][tid #139738505803520]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
2022-12-12 01:07:06.2022-12-12 01:07:06 55371.: 2022-12-12 01:07:06 55379E.:   55384E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:  :E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136 :] /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136using concurrent impl MPSPhase:] 
136using concurrent impl MPSPhase] 
using concurrent impl MPSPhase
[2022-12-12 01:07:06. 55528: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:136] using concurrent impl MPSPhase
[2022-12-12 01:07:06. 56495: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-12 01:07:06. 56520: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] [[assigning 8 to cpu2022-12-12 01:07:062022-12-12 01:07:06
.. 56545 56543: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::196212] [] assigning 8 to cpu2022-12-12 01:07:06build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
.
 56589: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196[] [2022-12-12 01:07:06assigning 8 to cpu[2022-12-12 01:07:06.
2022-12-12 01:07:06. 56625. 56623:  56626: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213:212] 212] remote time is 8.68421] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4

[[2022-12-12 01:07:062022-12-12 01:07:06.. 56712[[ 56693: 2022-12-12 01:07:062022-12-12 01:07:06: E..E  56722 56723 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:EE:214  212] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] cpu time is 30::build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
213213
] ] remote time is 8.68421remote time is 8.68421

[2022-12-12 01:07:06.[ 56813[2022-12-12 01:07:06: 2022-12-12 01:07:06.E. 56820  56822: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: E:E 213 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:remote time is 8.68421:214
214] ] cpu time is 30[cpu time is 30
2022-12-12 01:07:06
. 56896: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 01:07:31.114473: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 01:07:31.175273: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 01:07:31.175385: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 01:07:31.176556: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 01:07:31.308415: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 01:07:31.711927: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 01:07:31.712025: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 01:07:38.687199: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 01:07:38.687298: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 01:07:40.528155: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 01:07:40.528287: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 01:07:40.565028: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 01:07:40.565119: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 01:07:40.593340: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 01:07:40.606679: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 01:07:40.607510: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 01:07:40.617846: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 01:07:40.713506: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 01:07:40.717027: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-12 01:07:40.719515: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-12 01:07:40.721945: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-12 01:07:40.724370: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-12 01:07:41.982158: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 01:07:41.986814: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 01:07:41.986966: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 01:07:41.995987: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 01:07:41.996172: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 01:07:41.996262: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 01:07:41.996342: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 01:07:41.997802: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:07:41.997906: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:07:42.    10: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:07:42.  1288: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:07:42. 18543: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 01:07:42. 18660: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 01:07:42. 19352: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:07:42. 19412: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:07:42. 20275: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:07:42. 20840: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:07:42. 21713: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-12 01:07:42. 21850: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-12 01:07:42. 22623: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:07:42. 22689: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:07:42. 23435: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-12 01:07:42. 23530: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 1 initing device 1
[2022-12-12 01:07:42. 23583: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:07:42. 24134: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:07:42. 24265: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:07:42. 24324: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:07:42. 25361: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:07:42. 25949: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:07:42. 61831: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 01:07:42. 63721: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 01:07:42. 63778: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:07:42. 64654: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:07:42. 65230: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:07:42. 66191: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:07:42. 66253: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.40 MB
[2022-12-12 01:07:42. 86717: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 01:07:42. 88550: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 01:07:42. 88601: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:07:42. 89388: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:07:42. 89840: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:07:42. 90802: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:07:42. 90847: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.38 MB
[[2022-12-12 01:07:422022-12-12 01:07:42..127006127006: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

[2022-12-12 01:07:42.128855: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:[6382022-12-12 01:07:42] .eager release cuda mem 1021128875
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 01:07:42.128920: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [2022-12-12 01:07:42.128945: Eeager release cuda mem 400000000 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:07:42.131151: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:07:42.132421: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 53.79 MB
[2022-12-12 01:07:42.133336: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:07:42.133553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:07:42.134457: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:07:42.134595: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.40 MB
[2022-12-12 01:07:42.134671: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:07:42.134790: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 53.38 MB
[2022-12-12 01:07:42.137369: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:07:42.137989: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:07:42.138035: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[2022-12-12 01:07:42.155998: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:07:42.156593: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:07:42.156634: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[2022-12-12 01:07:42.162029: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:07:42.162617: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:07:42.162660: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[2022-12-12 01:07:42.163042: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:07:42.163617: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:07:42.163658: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 6.68 GB
[[[[2022-12-12 01:07:422022-12-12 01:07:422022-12-12 01:07:422022-12-12 01:07:42....800004800004800001800000: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 1 init p2p of link 2Device 2 init p2p of link 3Device 0 init p2p of link 1Device 3 init p2p of link 0



[[2022-12-12 01:07:422022-12-12 01:07:42..800348800348: : EE[  2022-12-12 01:07:42/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.::80037419801980: ] ] Eeager alloc mem 611.00 KBeager alloc mem 611.00 KB 

/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:07:42.800531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-12 01:07:422022-12-12 01:07:42..801249801248: : [EE2022-12-12 01:07:42  ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc801270::: 638638E] ]  eager release cuda mem 625663eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc

:638] eager release cuda mem 625663
[2022-12-12 01:07:42.801399: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:07:42.808558: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[[2022-12-12 01:07:422022-12-12 01:07:42..808660808671: : EE  [/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-12 01:07:42::.19261980808711] ] : Device 0 init p2p of link 2eager alloc mem 611.00 KBE

 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 3
[2022-12-12 01:07:42.808856: [E2022-12-12 01:07:42 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu808869:: 1980E]  eager alloc mem 611.00 KB/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1980] eager alloc mem 611.00 KB
[2022-12-12 01:07:42.809084: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 01:07:42.809196: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:07:42.809581: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:07:42.809712: [E2022-12-12 01:07:42 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc809724:: 638E]  eager release cuda mem 625663/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
:638] eager release cuda mem 625663
[2022-12-12 01:07:42.810006: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:07:42.817485: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[[2022-12-12 01:07:42[2022-12-12 01:07:42.2022-12-12 01:07:42.817556.817556: 817575: E: E E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926:1926] 1980] Device 3 init p2p of link 2] Device 2 init p2p of link 1
eager alloc mem 611.00 KB
[
2022-12-12 01:07:42.817706: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 01:07:42.817769[: 2022-12-12 01:07:42E. 817775/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu: :E[1980 2022-12-12 01:07:42] /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.eager alloc mem 611.00 KB:817811
1980: ] Eeager alloc mem 611.00 KB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:07:42.818515: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:07:42.818636: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:07:42[.2022-12-12 01:07:42818667.: 818667E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-12 01:07:42.825751: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:07:42.825832: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] [eager release cuda mem 564000002022-12-12 01:07:42
.825858: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:07:42.825931: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 56400000
[2022-12-12 01:07:42.826130: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13999781 / 100000000 nodes ( 14.00 %~14.00 %) | remote 34930445 / 100000000 nodes ( 34.93 %) | cpu 51069774 / 100000000 nodes ( 51.07 %) | 6.68 GB | 0.828238 secs 
[2022-12-12 01:07:42.826404: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13992525 / 100000000 nodes ( 13.99 %~14.00 %) | remote 34937701 / 100000000 nodes ( 34.94 %) | cpu 51069774 / 100000000 nodes ( 51.07 %) | 6.68 GB | 0.802101 secs 
[2022-12-12 01:07:42.826610: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13999629 / 100000000 nodes ( 14.00 %~14.00 %) | remote 34930597 / 100000000 nodes ( 34.93 %) | cpu 51069774 / 100000000 nodes ( 51.07 %) | 6.68 GB | 0.803948 secs 
[2022-12-12 01:07:42.826719: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 13993077 / 100000000 nodes ( 13.99 %~14.00 %) | remote 34937149 / 100000000 nodes ( 34.94 %) | cpu 51069774 / 100000000 nodes ( 51.07 %) | 6.68 GB | 0.807329 secs 
[2022-12-12 01:07:42.826852: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 11.71 GB
[2022-12-12 01:07:43.800334: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 11.95 GB
[2022-12-12 01:07:43.800467: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 11.95 GB
[2022-12-12 01:07:43.800724: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 11.95 GB
[2022-12-12 01:07:44.566218: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 12.20 GB
[2022-12-12 01:07:44.567033: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 12.20 GB
[2022-12-12 01:07:44.570637: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 12.20 GB
[2022-12-12 01:07:45.513325: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 12.45 GB
[2022-12-12 01:07:45.513472: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 12.45 GB
[2022-12-12 01:07:45.513828: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 12.45 GB
[2022-12-12 01:07:45.514085: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 12.45 GB
[2022-12-12 01:07:45.514299: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 12.45 GB
[2022-12-12 01:07:46.253091: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 12.64 GB
[2022-12-12 01:07:46.253431: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 12.64 GB
[HCTR][01:07:46.479][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][01:07:46.479][ERROR][RK0][tid #139738505803520]: replica 3 calling init per replica done, doing barrier
[HCTR][01:07:46.479][ERROR][RK0][tid #139738505803520]: replica 2 calling init per replica done, doing barrier
[HCTR][01:07:46.479][ERROR][RK0][tid #139738505803520]: replica 1 calling init per replica done, doing barrier
[HCTR][01:07:46.479][ERROR][RK0][tid #139738505803520]: replica 3 calling init per replica done, doing barrier done
[HCTR][01:07:46.479][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][01:07:46.479][ERROR][RK0][tid #139738505803520]: replica 1 calling init per replica done, doing barrier done
[HCTR][01:07:46.479][ERROR][RK0][tid #139738505803520]: replica 2 calling init per replica done, doing barrier done
[HCTR][01:07:46.479][ERROR][RK0][tid #139738505803520]: init per replica done
[HCTR][01:07:46.479][ERROR][RK0][tid #139738505803520]: init per replica done
[HCTR][01:07:46.479][ERROR][RK0][tid #139738505803520]: init per replica done
[HCTR][01:07:46.487][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f0557720000
[HCTR][01:07:46.487][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f18ea600000
[HCTR][01:07:46.487][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f18eac40000
[HCTR][01:07:46.487][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f18eaf60000
[HCTR][01:07:46.487][ERROR][RK0][tid #139738505803520]: 2 allocated 3276800 at 0x7f0557720000
[HCTR][01:07:46.487][ERROR][RK0][tid #139738505803520]: 2 allocated 6553600 at 0x7f18ea600000
[HCTR][01:07:46.487][ERROR][RK0][tid #139738505803520]: 2 allocated 3276800 at 0x7f18eac40000
[HCTR][01:07:46.487][ERROR][RK0][tid #139738505803520]: 2 allocated 6553600 at 0x7f18eaf60000
[HCTR][01:07:46.494][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f0557720000
[HCTR][01:07:46.494][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f18ea600000
[HCTR][01:07:46.494][ERROR][RK0][main]: 1 allocated 3276800 at 0x7f18eac40000
[HCTR][01:07:46.494][ERROR][RK0][main]: 1 allocated 6553600 at 0x7f18eaf60000
[HCTR][01:07:46.538][ERROR][RK0][main]: init per replica done
[HCTR][01:07:46.550][ERROR][RK0][tid #139738505803520]: 0 allocated 3276800 at 0x7eff9e320000
[HCTR][01:07:46.551][ERROR][RK0][tid #139738505803520]: 0 allocated 6553600 at 0x7eff9e800000
[HCTR][01:07:46.551][ERROR][RK0][tid #139738505803520]: 0 allocated 3276800 at 0x7eff9f50e800
[HCTR][01:07:46.551][ERROR][RK0][tid #139738505803520]: 0 allocated 6553600 at 0x7eff9f82e800




