2022-12-12 01:52:43.863369: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:52:43.931178: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:52:43.937632: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:52:43.937632: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:52:44.783465: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:52:44.783550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:52:44.796898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:52:44.831803: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:52:44.831984: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:52:44.834144: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 01:52:44.837409: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:52:44.837489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:52:44.848283: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:52:44.848362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:52:44.849433: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:52:44.849487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:52:44.850321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:52:44.860549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:52:44.863856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:52:44.882824: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:52:44.882993: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:52:44.884713: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
2022-12-12 01:52:44.889136: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:52:44.889271: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:52:44.890836: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 01:52:44.894960: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:52:44.895101: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:52:44.896710: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
[HCTR][01:52:45.132][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:52:46.139][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:52:46.139][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:52:46.139][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.51s/it]warmup run: 109it [00:01, 93.66it/s]warmup run: 214it [00:01, 198.42it/s]warmup run: 319it [00:01, 313.42it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 423it [00:01, 431.05it/s]warmup run: 92it [00:01, 83.34it/s]warmup run: 529it [00:02, 548.59it/s]warmup run: 194it [00:01, 190.79it/s]warmup run: 629it [00:02, 643.79it/s]warmup run: 305it [00:01, 320.25it/s]warmup run: 736it [00:02, 741.84it/s]warmup run: 416it [00:01, 452.54it/s]warmup run: 848it [00:02, 834.59it/s]warmup run: 528it [00:01, 581.07it/s]warmup run: 954it [00:02, 891.83it/s]warmup run: 631it [00:02, 670.79it/s]warmup run: 1059it [00:02, 924.79it/s]warmup run: 732it [00:02, 745.49it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1167it [00:02, 965.81it/s]warmup run: 833it [00:02, 809.84it/s]warmup run: 101it [00:01, 92.26it/s]warmup run: 1272it [00:02, 989.52it/s]warmup run: 937it [00:02, 868.96it/s]warmup run: 188it [00:01, 182.17it/s]warmup run: 1377it [00:02, 972.27it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 1044it [00:02, 922.07it/s]warmup run: 290it [00:01, 300.70it/s]warmup run: 1479it [00:02, 969.44it/s]warmup run: 104it [00:01, 94.56it/s]warmup run: 1147it [00:02, 938.09it/s]warmup run: 386it [00:01, 411.48it/s]warmup run: 209it [00:01, 204.65it/s]warmup run: 1579it [00:03, 966.44it/s]warmup run: 1249it [00:02, 959.48it/s]warmup run: 490it [00:01, 533.11it/s]warmup run: 314it [00:01, 323.96it/s]warmup run: 1682it [00:03, 982.34it/s]warmup run: 1355it [00:02, 987.32it/s]warmup run: 595it [00:02, 644.61it/s]warmup run: 420it [00:01, 446.93it/s]warmup run: 1792it [00:03, 1014.24it/s]warmup run: 1461it [00:02, 1007.36it/s]warmup run: 700it [00:02, 739.94it/s]warmup run: 520it [00:01, 553.00it/s]warmup run: 1902it [00:03, 1037.97it/s]warmup run: 1569it [00:02, 1027.06it/s]warmup run: 805it [00:02, 817.59it/s]warmup run: 626it [00:02, 661.17it/s]warmup run: 2017it [00:03, 1069.42it/s]warmup run: 1678it [00:03, 1044.22it/s]warmup run: 910it [00:02, 877.40it/s]warmup run: 726it [00:02, 740.78it/s]warmup run: 2152it [00:03, 1152.15it/s]warmup run: 1784it [00:03, 1017.73it/s]warmup run: 1014it [00:02, 920.14it/s]warmup run: 831it [00:02, 817.40it/s]warmup run: 2286it [00:03, 1206.47it/s]warmup run: 1887it [00:03, 1005.39it/s]warmup run: 1121it [00:02, 961.42it/s]warmup run: 939it [00:02, 885.35it/s]warmup run: 2413it [00:03, 1224.09it/s]warmup run: 1993it [00:03, 1020.50it/s]warmup run: 1228it [00:02, 990.30it/s]warmup run: 1046it [00:02, 935.59it/s]warmup run: 2548it [00:03, 1260.21it/s]warmup run: 2122it [00:03, 1097.48it/s]warmup run: 1337it [00:02, 1017.15it/s]warmup run: 1153it [00:02, 972.35it/s]warmup run: 2682it [00:03, 1283.88it/s]warmup run: 2253it [00:03, 1159.86it/s]warmup run: 1446it [00:02, 1036.90it/s]warmup run: 2816it [00:04, 1299.39it/s]warmup run: 1258it [00:02, 960.47it/s]warmup run: 2384it [00:03, 1203.76it/s]warmup run: 1553it [00:02, 1043.16it/s]warmup run: 2950it [00:04, 1309.21it/s]warmup run: 1365it [00:02, 989.61it/s]warmup run: 2515it [00:03, 1234.00it/s]warmup run: 1661it [00:03, 1053.13it/s]warmup run: 3000it [00:04, 715.06it/s] warmup run: 1468it [00:02, 983.45it/s]warmup run: 2642it [00:03, 1242.32it/s]warmup run: 1768it [00:03, 1054.15it/s]warmup run: 1575it [00:02, 1007.86it/s]warmup run: 2774it [00:03, 1263.09it/s]warmup run: 1876it [00:03, 1060.70it/s]warmup run: 1682it [00:03, 1023.43it/s]warmup run: 2902it [00:04, 1266.57it/s]warmup run: 1985it [00:03, 1066.72it/s]warmup run: 3000it [00:04, 723.16it/s] warmup run: 1788it [00:03, 1034.11it/s]warmup run: 2114it [00:03, 1131.73it/s]warmup run: 1896it [00:03, 1045.07it/s]warmup run: 2249it [00:03, 1194.25it/s]warmup run: 2003it [00:03, 1050.83it/s]warmup run: 2380it [00:03, 1228.51it/s]warmup run: 2136it [00:03, 1132.21it/s]warmup run: 2514it [00:03, 1261.38it/s]warmup run: 2270it [00:03, 1191.87it/s]warmup run: 2646it [00:03, 1278.08it/s]warmup run: 2404it [00:03, 1235.89it/s]warmup run: 2781it [00:03, 1297.32it/s]warmup run: 2537it [00:03, 1263.08it/s]warmup run: 2916it [00:04, 1311.71it/s]warmup run: 3000it [00:04, 731.92it/s] warmup run: 2668it [00:03, 1275.08it/s]warmup run: 2802it [00:03, 1292.71it/s]warmup run: 2934it [00:04, 1299.33it/s]warmup run: 3000it [00:04, 729.91it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 169/3000 [00:00<00:01, 1683.90it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1649.20it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1652.22it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1654.18it/s]warmup should be done:  12%|█▏        | 348/3000 [00:00<00:01, 1740.96it/s]warmup should be done:  11%|█         | 336/3000 [00:00<00:01, 1679.25it/s]warmup should be done:  11%|█▏        | 338/3000 [00:00<00:01, 1686.87it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1724.20it/s]warmup should be done:  17%|█▋        | 506/3000 [00:00<00:01, 1684.47it/s]warmup should be done:  17%|█▋        | 509/3000 [00:00<00:01, 1693.86it/s]warmup should be done:  17%|█▋        | 521/3000 [00:00<00:01, 1740.69it/s]warmup should be done:  17%|█▋        | 523/3000 [00:00<00:01, 1718.68it/s]warmup should be done:  23%|██▎       | 676/3000 [00:00<00:01, 1688.53it/s]warmup should be done:  23%|██▎       | 696/3000 [00:00<00:01, 1741.77it/s]warmup should be done:  23%|██▎       | 679/3000 [00:00<00:01, 1691.77it/s]warmup should be done:  23%|██▎       | 697/3000 [00:00<00:01, 1721.20it/s]warmup should be done:  28%|██▊       | 845/3000 [00:00<00:01, 1688.79it/s]warmup should be done:  29%|██▉       | 871/3000 [00:00<00:01, 1743.41it/s]warmup should be done:  28%|██▊       | 850/3000 [00:00<00:01, 1697.43it/s]warmup should be done:  29%|██▉       | 870/3000 [00:00<00:01, 1707.47it/s]warmup should be done:  35%|███▍      | 1046/3000 [00:00<00:01, 1744.99it/s]warmup should be done:  34%|███▍      | 1020/3000 [00:00<00:01, 1695.71it/s]warmup should be done:  34%|███▍      | 1014/3000 [00:00<00:01, 1678.50it/s]warmup should be done:  35%|███▍      | 1041/3000 [00:00<00:01, 1706.76it/s]warmup should be done:  40%|███▉      | 1195/3000 [00:00<00:01, 1712.29it/s]warmup should be done:  41%|████      | 1221/3000 [00:00<00:01, 1743.00it/s]warmup should be done:  40%|███▉      | 1187/3000 [00:00<00:01, 1694.59it/s]warmup should be done:  40%|████      | 1212/3000 [00:00<00:01, 1686.62it/s]warmup should be done:  47%|████▋     | 1397/3000 [00:00<00:00, 1747.56it/s]warmup should be done:  46%|████▌     | 1370/3000 [00:00<00:00, 1722.00it/s]warmup should be done:  45%|████▌     | 1360/3000 [00:00<00:00, 1704.23it/s]warmup should be done:  46%|████▌     | 1383/3000 [00:00<00:00, 1692.90it/s]warmup should be done:  52%|█████▏    | 1573/3000 [00:00<00:00, 1751.37it/s]warmup should be done:  52%|█████▏    | 1545/3000 [00:00<00:00, 1730.52it/s]warmup should be done:  51%|█████     | 1533/3000 [00:00<00:00, 1711.30it/s]warmup should be done:  52%|█████▏    | 1553/3000 [00:00<00:00, 1688.46it/s]warmup should be done:  58%|█████▊    | 1749/3000 [00:01<00:00, 1753.11it/s]warmup should be done:  57%|█████▋    | 1705/3000 [00:01<00:00, 1713.44it/s]warmup should be done:  57%|█████▋    | 1719/3000 [00:01<00:00, 1727.36it/s]warmup should be done:  58%|█████▊    | 1727/3000 [00:01<00:00, 1703.32it/s]warmup should be done:  64%|██████▍   | 1925/3000 [00:01<00:00, 1754.68it/s]warmup should be done:  63%|██████▎   | 1878/3000 [00:01<00:00, 1717.69it/s]warmup should be done:  63%|██████▎   | 1893/3000 [00:01<00:00, 1729.40it/s]warmup should be done:  63%|██████▎   | 1898/3000 [00:01<00:00, 1698.84it/s]warmup should be done:  70%|███████   | 2101/3000 [00:01<00:00, 1754.22it/s]warmup should be done:  68%|██████▊   | 2050/3000 [00:01<00:00, 1715.72it/s]warmup should be done:  69%|██████▉   | 2066/3000 [00:01<00:00, 1722.68it/s]warmup should be done:  69%|██████▉   | 2068/3000 [00:01<00:00, 1673.46it/s]warmup should be done:  76%|███████▌  | 2277/3000 [00:01<00:00, 1752.12it/s]warmup should be done:  74%|███████▍  | 2223/3000 [00:01<00:00, 1718.06it/s]warmup should be done:  75%|███████▍  | 2240/3000 [00:01<00:00, 1725.29it/s]warmup should be done:  75%|███████▍  | 2236/3000 [00:01<00:00, 1649.50it/s]warmup should be done:  82%|████████▏ | 2454/3000 [00:01<00:00, 1756.74it/s]warmup should be done:  80%|███████▉  | 2396/3000 [00:01<00:00, 1719.44it/s]warmup should be done:  80%|████████  | 2414/3000 [00:01<00:00, 1728.27it/s]warmup should be done:  80%|████████  | 2412/3000 [00:01<00:00, 1679.21it/s]warmup should be done:  88%|████████▊ | 2630/3000 [00:01<00:00, 1756.80it/s]warmup should be done:  86%|████████▋ | 2589/3000 [00:01<00:00, 1732.14it/s]warmup should be done:  86%|████████▌ | 2568/3000 [00:01<00:00, 1686.90it/s]warmup should be done:  86%|████████▌ | 2586/3000 [00:01<00:00, 1696.60it/s]warmup should be done:  94%|█████████▎| 2807/3000 [00:01<00:00, 1760.33it/s]warmup should be done:  92%|█████████▏| 2763/3000 [00:01<00:00, 1728.73it/s]warmup should be done:  91%|█████████ | 2737/3000 [00:01<00:00, 1655.21it/s]warmup should be done:  92%|█████████▏| 2761/3000 [00:01<00:00, 1710.96it/s]warmup should be done: 100%|█████████▉| 2985/3000 [00:01<00:00, 1764.45it/s]warmup should be done:  98%|█████████▊| 2938/3000 [00:01<00:00, 1732.93it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1750.66it/s]warmup should be done:  97%|█████████▋| 2903/3000 [00:01<00:00, 1631.00it/s]warmup should be done:  98%|█████████▊| 2933/3000 [00:01<00:00, 1704.69it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1719.80it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1698.11it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1686.36it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 183/3000 [00:00<00:01, 1827.99it/s]warmup should be done:   6%|▌         | 170/3000 [00:00<00:01, 1696.28it/s]warmup should be done:   5%|▌         | 157/3000 [00:00<00:01, 1563.18it/s]warmup should be done:   6%|▌         | 165/3000 [00:00<00:01, 1621.83it/s]warmup should be done:  11%|█▏        | 338/3000 [00:00<00:01, 1706.37it/s]warmup should be done:  12%|█▏        | 351/3000 [00:00<00:01, 1757.72it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1715.14it/s]warmup should be done:  12%|█▏        | 366/3000 [00:00<00:01, 1668.43it/s]warmup should be done:  17%|█▋        | 519/3000 [00:00<00:01, 1752.91it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1775.95it/s]warmup should be done:  17%|█▋        | 522/3000 [00:00<00:01, 1744.21it/s]warmup should be done:  18%|█▊        | 547/3000 [00:00<00:01, 1727.80it/s]warmup should be done:  23%|██▎       | 701/3000 [00:00<00:01, 1778.82it/s]warmup should be done:  24%|██▎       | 712/3000 [00:00<00:01, 1787.71it/s]warmup should be done:  23%|██▎       | 701/3000 [00:00<00:01, 1758.90it/s]warmup should be done:  24%|██▍       | 728/3000 [00:00<00:01, 1756.07it/s]warmup should be done:  29%|██▉       | 884/3000 [00:00<00:01, 1795.39it/s]warmup should be done:  30%|██▉       | 894/3000 [00:00<00:01, 1798.27it/s]warmup should be done:  29%|██▉       | 882/3000 [00:00<00:01, 1774.90it/s]warmup should be done:  30%|███       | 909/3000 [00:00<00:01, 1773.21it/s]warmup should be done:  36%|███▌      | 1076/3000 [00:00<00:01, 1804.51it/s]warmup should be done:  36%|███▌      | 1067/3000 [00:00<00:01, 1803.92it/s]warmup should be done:  35%|███▌      | 1063/3000 [00:00<00:01, 1785.38it/s]warmup should be done:  36%|███▋      | 1092/3000 [00:00<00:01, 1790.21it/s]warmup should be done:  42%|████▏     | 1249/3000 [00:00<00:00, 1806.36it/s]warmup should be done:  42%|████▏     | 1257/3000 [00:00<00:00, 1802.18it/s]warmup should be done:  41%|████▏     | 1243/3000 [00:00<00:00, 1789.74it/s]warmup should be done:  42%|████▏     | 1274/3000 [00:00<00:00, 1799.24it/s]warmup should be done:  48%|████▊     | 1432/3000 [00:00<00:00, 1812.78it/s]warmup should be done:  48%|████▊     | 1440/3000 [00:00<00:00, 1809.43it/s]warmup should be done:  47%|████▋     | 1422/3000 [00:00<00:00, 1789.62it/s]warmup should be done:  49%|████▊     | 1458/3000 [00:00<00:00, 1809.58it/s]warmup should be done:  54%|█████▍    | 1622/3000 [00:00<00:00, 1811.69it/s]warmup should be done:  53%|█████▎    | 1603/3000 [00:00<00:00, 1795.00it/s]warmup should be done:  55%|█████▍    | 1640/3000 [00:00<00:00, 1798.58it/s]warmup should be done:  54%|█████▍    | 1614/3000 [00:00<00:00, 1610.99it/s]warmup should be done:  60%|██████    | 1804/3000 [00:01<00:00, 1811.64it/s]warmup should be done:  59%|█████▉    | 1783/3000 [00:01<00:00, 1794.96it/s]warmup should be done:  61%|██████    | 1820/3000 [00:01<00:00, 1797.82it/s]warmup should be done:  60%|█████▉    | 1787/3000 [00:01<00:00, 1644.27it/s]warmup should be done:  66%|██████▌   | 1986/3000 [00:01<00:00, 1813.62it/s]warmup should be done:  65%|██████▌   | 1963/3000 [00:01<00:00, 1796.02it/s]warmup should be done:  67%|██████▋   | 2000/3000 [00:01<00:00, 1797.02it/s]warmup should be done:  65%|██████▌   | 1957/3000 [00:01<00:00, 1659.42it/s]warmup should be done:  72%|███████▏  | 2168/3000 [00:01<00:00, 1815.00it/s]warmup should be done:  71%|███████▏  | 2144/3000 [00:01<00:00, 1797.36it/s]warmup should be done:  73%|███████▎  | 2180/3000 [00:01<00:00, 1797.29it/s]warmup should be done:  71%|███████▏  | 2140/3000 [00:01<00:00, 1708.39it/s]warmup should be done:  78%|███████▊  | 2350/3000 [00:01<00:00, 1816.19it/s]warmup should be done:  78%|███████▊  | 2325/3000 [00:01<00:00, 1800.02it/s]warmup should be done:  79%|███████▊  | 2361/3000 [00:01<00:00, 1799.91it/s]warmup should be done:  77%|███████▋  | 2313/3000 [00:01<00:00, 1711.00it/s]warmup should be done:  84%|████████▍ | 2532/3000 [00:01<00:00, 1816.98it/s]warmup should be done:  84%|████████▎ | 2506/3000 [00:01<00:00, 1800.88it/s]warmup should be done:  85%|████████▍ | 2542/3000 [00:01<00:00, 1801.10it/s]warmup should be done:  83%|████████▎ | 2497/3000 [00:01<00:00, 1747.48it/s]warmup should be done:  90%|█████████ | 2715/3000 [00:01<00:00, 1818.17it/s]warmup should be done:  90%|████████▉ | 2687/3000 [00:01<00:00, 1802.74it/s]warmup should be done:  91%|█████████ | 2723/3000 [00:01<00:00, 1802.60it/s]warmup should be done:  89%|████████▉ | 2678/3000 [00:01<00:00, 1763.51it/s]warmup should be done:  97%|█████████▋| 2897/3000 [00:01<00:00, 1817.14it/s]warmup should be done:  96%|█████████▌| 2868/3000 [00:01<00:00, 1804.24it/s]warmup should be done:  97%|█████████▋| 2904/3000 [00:01<00:00, 1802.20it/s]warmup should be done:  95%|█████████▌| 2856/3000 [00:01<00:00, 1768.34it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1806.16it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1789.70it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1787.25it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1739.44it/s]2022-12-12 01:54:02.304994: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f02e2a6c3d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:54:02.305066: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:54:03.882633: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:54:04.985483: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:54:06.382054: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:54:24.025251: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f02e2a64e90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:54:24.025324: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:54:24.458951: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f02da267960 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:54:24.459028: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:54:24.461415: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7f02e22686a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:54:24.461453: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:54:28.390435: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:54:28.804323: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:54:28.806075: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:54:30.326024: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:54:30.706656: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:54:30.758309: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:54:32.189184: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:54:32.628034: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:54:32.680686: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][01:54:57.521][ERROR][RK0][main]: replica 0 reaches 1000, calling init pre replica
[HCTR][01:54:57.521][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:54:57.527][ERROR][RK0][main]: coll ps creation done
[HCTR][01:54:57.527][ERROR][RK0][main]: replica 0 waits for coll ps creation barrier
[HCTR][01:54:57.653][ERROR][RK0][tid #139650458973952]: replica 1 reaches 1000, calling init pre replica
[HCTR][01:54:57.653][ERROR][RK0][tid #139650458973952]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:54:57.657][ERROR][RK0][tid #139650458973952]: coll ps creation done
[HCTR][01:54:57.657][ERROR][RK0][tid #139650458973952]: replica 1 waits for coll ps creation barrier
[HCTR][01:54:57.689][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][01:54:57.689][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:54:57.692][ERROR][RK0][main]: coll ps creation done
[HCTR][01:54:57.692][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][01:54:57.847][ERROR][RK0][tid #139650945488640]: replica 2 reaches 1000, calling init pre replica
[HCTR][01:54:57.847][ERROR][RK0][tid #139650945488640]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][01:54:57.851][ERROR][RK0][tid #139650945488640]: coll ps creation done
[HCTR][01:54:57.851][ERROR][RK0][tid #139650945488640]: replica 2 waits for coll ps creation barrier
[HCTR][01:54:57.851][ERROR][RK0][main]: replica 0 preparing frequency
[HCTR][01:54:58.767][ERROR][RK0][main]: replica 0 preparing frequency done
[HCTR][01:54:58.801][ERROR][RK0][main]: replica 0 calling init per replica
[HCTR][01:54:58.801][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][01:54:58.801][ERROR][RK0][tid #139650945488640]: replica 2 calling init per replica
[HCTR][01:54:58.801][ERROR][RK0][tid #139650458973952]: replica 1 calling init per replica
[HCTR][01:54:58.801][ERROR][RK0][main]: Calling build_v2
[HCTR][01:54:58.801][ERROR][RK0][main]: Calling build_v2
[HCTR][01:54:58.801][ERROR][RK0][tid #139650945488640]: Calling build_v2
[HCTR][01:54:58.801][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:54:58.801][ERROR][RK0][tid #139650458973952]: Calling build_v2
[HCTR][01:54:58.801][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:54:58.801][ERROR][RK0][tid #139650945488640]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:54:58.801][ERROR][RK0][tid #139650458973952]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[[2022-12-12 01:54:58.2022-12-12 01:54:588015442022-12-12 01:54:58.: .2022-12-12 01:54:58801544E801544.:  : 801553E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE:  : E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc :] :/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136using concurrent impl MPSPhase136:] 
] 136using concurrent impl MPSPhaseusing concurrent impl MPSPhase] 

using concurrent impl MPSPhase
[2022-12-12 01:54:58.802722: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-12 01:54:58.802746: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] [assigning 8 to cpu2022-12-12 01:54:58
.802770: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[[2022-12-12 01:54:582022-12-12 01:54:58[..2022-12-12 01:54:58802799802802.[: : 8028092022-12-12 01:54:58EE: .  E802824/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc : ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE196212: ] ] 212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpubuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4] :

build symm link desc with 4X Tesla V100-SXM2-16GB out of 4212
] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 01:54:58[.2022-12-12 01:54:58[802915.2022-12-12 01:54:58: 802919.E: 802923 E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc E:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc 213:/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] 213[:remote time is 8.68421] 2022-12-12 01:54:58213
remote time is 8.68421.] 
802947[remote time is 8.68421: 2022-12-12 01:54:58[
E.2022-12-12 01:54:58 802992[./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: 2022-12-12 01:54:58803001:E.: 212 803016E] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:  build symm link desc with 4X Tesla V100-SXM2-16GB out of 4:E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
214 :] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc214cpu time is 30:] 
[214cpu time is 302022-12-12 01:54:58] 
.cpu time is 30803098
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 01:54:58.803155: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 01:55:24.886820: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 01:55:24.947088: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 01:55:24.947198: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 381.47 MB
[2022-12-12 01:55:24.948247: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:74] mapping nid to rank...
[2022-12-12 01:55:25. 32348: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:91] counting slots...
[2022-12-12 01:55:25.405902: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:105] Final num slot is 42
[2022-12-12 01:55:25.405973: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:109] counting blocks...
[2022-12-12 01:55:33.817297: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:118] Final num block is 1021
[2022-12-12 01:55:33.817520: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:123] counting freq and density...
[2022-12-12 01:55:35.546824: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:154] averaging freq and density...
[2022-12-12 01:55:35.546909: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:155] 1021
[2022-12-12 01:55:35.556601: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
[2022-12-12 01:55:35.556675: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:354] constructing optimal solver, device=4, stream=1
1021 blocks, 4 devices
[2022-12-12 01:55:35.580798: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:527] Add Var...
[2022-12-12 01:55:35.593349: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:545] Capacity...
[2022-12-12 01:55:35.594090: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:548] Connect CPU...
[2022-12-12 01:55:35.604481: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:550] Connect Access To Storage...
[2022-12-12 01:55:35.698705: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:554] Time...
[2022-12-12 01:55:35.701859: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 0, total sm is 80
[2022-12-12 01:55:35.704390: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 1, total sm is 80
[2022-12-12 01:55:35.706834: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 2, total sm is 80
[2022-12-12 01:55:35.709254: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:516] dst 3, total sm is 80
[2022-12-12 01:55:36.988429: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:569] Coll Cache init block placement array
[2022-12-12 01:55:36.993076: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:645] Coll Cache init block placement array done
[2022-12-12 01:55:36.993265: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:647] Coll Cache model reset done
[2022-12-12 01:55:37.  2561: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 01:55:37.  2640: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 01:55:37.  2670: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 01:55:37.  2698: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 01:55:37.  3766: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:55:37.  3868: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:55:37.  6903: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:55:37.  8310: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:55:37. 24565: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-12 01:55:37. 24685: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-12 01:55:37. 25592: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:55:37. 25650: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:55:37. 26233: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 1 solved
[2022-12-12 01:55:37. 26324: [E 2022-12-12 01:55:37/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc.: 26295205: ] Eworker 0 thread 1 initing device 1 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 3 solved
[2022-12-12 01:55:37. 26389: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 3 initing device 3
[2022-12-12 01:55:37. 26573: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:55:37. 27141: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-12 01:55:372022-12-12 01:55:37.. 27194 27194: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::18151815] ] Building Coll Cache with ... num gpu device is 4
Building Coll Cache with ... num gpu device is 4
[[2022-12-12 01:55:372022-12-12 01:55:37.. 27267 27267: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::19801980] ] eager alloc mem 381.47 MBeager alloc mem 381.47 MB

[2022-12-12 01:55:37. 28797: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB[
2022-12-12 01:55:37. 28822: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:55:37. 29839: E[ 2022-12-12 01:55:37/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.: 298531980: ] Eeager alloc mem 381.47 MB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:55:37. 69977: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 1021.00 Bytes
[2022-12-12 01:55:37. 72402: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 01:55:37. 72460: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:55:37. 73275: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 01:55:37. 73808: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37. 74779: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:55:37. 74826: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.01 MB
[2022-12-12 01:55:37.107056: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:55:37.107720: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:55:37.107765: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[[[2022-12-12 01:55:372022-12-12 01:55:372022-12-12 01:55:37...119210119210119210: : : EEE   /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:::198019801980] ] ] eager alloc mem 1021.00 Byteseager alloc mem 1021.00 Bytes

eager alloc mem 1021.00 Bytes
[[2022-12-12 01:55:372022-12-12 01:55:37..121050121052: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 1021eager release cuda mem 1021

[[2022-12-12 01:55:372022-12-12 01:55:37..121122121125: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc::638638] ] eager release cuda mem 400000000eager release cuda mem 400000000

[2022-12-12 01:55:37.121506: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 1021
[2022-12-12 01:55:37.121553: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:55:37.124481: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 01:55:37.124971: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 01:55:37.125451: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 01:55:37.126243: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.126308: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.126347: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.127221: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:55:37.127265: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43[] 2022-12-12 01:55:37WORKER[0] alloc host memory 61.00 MB.
127279: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[[2022-12-12 01:55:372022-12-12 01:55:37..127325127329: : EW  /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc::63843] ] eager release cuda mem 625663
WORKER[0] alloc host memory 60.98 MB
[2022-12-12 01:55:37.127390: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 60.99 MB
[2022-12-12 01:55:37.156173: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:55:37.156574: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:55:37.156775: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:55:37.156816: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 01:55:37.156998: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:55:37.157149: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:55:37.157189: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 01:55:37.157564: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:55:37.157606: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[[[[2022-12-12 01:55:372022-12-12 01:55:372022-12-12 01:55:372022-12-12 01:55:37....882428882424882430882428: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] Device 1 init p2p of link 2] ] Device 3 init p2p of link 0
Device 2 init p2p of link 3Device 0 init p2p of link 1


[2022-12-12 01:55:37.[8826972022-12-12 01:55:37: .E882703 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: [1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu2022-12-12 01:55:37] :.eager alloc mem 611.00 KB1980882726
] : eager alloc mem 611.00 KBE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.883284: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.883539: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-12 01:55:37:.638883551[] : 2022-12-12 01:55:37eager release cuda mem 625663E.
 883564/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :E638 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 625663:
638] eager release cuda mem 625663
[2022-12-12 01:55:37.884121: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:55:37.891237: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 01:55:37.891354: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.891668: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 01:55:37.891921: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.892089: [E 2022-12-12 01:55:37/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.:8920871926: ] EDevice 0 init p2p of link 2 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu[:2022-12-12 01:55:371926.] 892172: Device 1 init p2p of link 3E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:55:37.892229: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.892339: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.892863: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:55:37.893033: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:55:37.893261: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:55:37.897441: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 01:55:37.897544: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.898372: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:55:37.900044: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 01:55:37.900131: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.900301: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 01:55:37.900401: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.900446: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 01:55:37.900548: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:55:37.900924: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:55:37.901221: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:55:37.901350: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:55:37.903609: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 01:55:37.903916: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15988471 / 100000000 nodes ( 15.99 %~16.00 %) | remote 34433487 / 100000000 nodes ( 34.43 %) | cpu 49578042 / 100000000 nodes ( 49.58 %) | 7.63 GB | 0.878284 secs 
[2022-12-12 01:55:37.906987: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 01:55:37.907328: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15992812 / 100000000 nodes ( 15.99 %~16.00 %) | remote 34429146 / 100000000 nodes ( 34.43 %) | cpu 49578042 / 100000000 nodes ( 49.58 %) | 7.63 GB | 0.903474 secs 
[2022-12-12 01:55:37.907499: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 01:55:37.[907851[2022-12-12 01:55:37: .2022-12-12 01:55:37E907855. : 907816/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: : W1955/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc ] :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuAsymm Coll cache (policy: coll_cache_asymm_link) | local 15986426 / 100000000 nodes ( 15.99 %~16.00 %) | remote 34435532 / 100000000 nodes ( 34.44 %) | cpu 49578042 / 100000000 nodes ( 49.58 %) | 7.63 GB | 0.880598 secs 638:
] 2213eager release cuda mem 64399996] 
before create ctx, mem is 12.66 GB
[2022-12-12 01:55:37.908235: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15991878 / 100000000 nodes ( 15.99 %~16.00 %) | remote 34430080 / 100000000 nodes ( 34.43 %) | cpu 49578042 / 100000000 nodes ( 49.58 %) | 7.63 GB | 0.880979 secs 
[2022-12-12 01:55:38.927411: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 12.91 GB
[2022-12-12 01:55:38.927814: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 12.91 GB
[2022-12-12 01:55:38.928070: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 12.91 GB
[2022-12-12 01:55:39.765143: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 13.15 GB
[2022-12-12 01:55:39.765271: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 13.15 GB
[2022-12-12 01:55:39.765728: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 13.15 GB
[2022-12-12 01:55:40.789033: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 13.40 GB
[2022-12-12 01:55:40.789156: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 13.40 GB
[2022-12-12 01:55:40.789454: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2243] before create stream, mem is 13.40 GB
[2022-12-12 01:55:40.789642: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2249] after create stream, mem is 13.40 GB
[2022-12-12 01:55:40.789831: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2213] before create ctx, mem is 13.40 GB
[2022-12-12 01:55:41.779417: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2219] after create ctx, mem is 13.59 GB
[2022-12-12 01:55:41.779561: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2226] after create stream, mem is 13.59 GB
[HCTR][01:55:41.805][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier
[HCTR][01:55:41.805][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][01:55:41.805][ERROR][RK0][tid #139650945488640]: replica 2 calling init per replica done, doing barrier
[HCTR][01:55:41.805][ERROR][RK0][tid #139650458973952]: replica 1 calling init per replica done, doing barrier
[HCTR][01:55:41.805][ERROR][RK0][main]: replica 0 calling init per replica done, doing barrier done
[HCTR][01:55:41.805][ERROR][RK0][tid #139650945488640]: replica 2 calling init per replica done, doing barrier done
[HCTR][01:55:41.805][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][01:55:41.805][ERROR][RK0][tid #139650458973952]: replica 1 calling init per replica done, doing barrier done
[HCTR][01:55:41.805][ERROR][RK0][tid #139650945488640]: init per replica done
[HCTR][01:55:41.805][ERROR][RK0][tid #139650458973952]: init per replica done
[HCTR][01:55:41.805][ERROR][RK0][main]: init per replica done
[HCTR][01:55:41.808][ERROR][RK0][main]: init per replica done
[HCTR][01:55:41.814][ERROR][RK0][tid #139650458973952]: 1 allocated 3276800 at 0x7ef0d7720000
[HCTR][01:55:41.814][ERROR][RK0][tid #139650458973952]: 1 allocated 6553600 at 0x7f046a600000
[HCTR][01:55:41.814][ERROR][RK0][tid #139650458973952]: 1 allocated 3276800 at 0x7f046ac40000
[HCTR][01:55:41.814][ERROR][RK0][tid #139650458973952]: 1 allocated 6553600 at 0x7f046af60000
[HCTR][01:55:41.816][ERROR][RK0][main]: 3 allocated 3276800 at 0x7ef0d7720000
[HCTR][01:55:41.816][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f0468600000
[HCTR][01:55:41.816][ERROR][RK0][main]: 3 allocated 3276800 at 0x7f0468c40000
[HCTR][01:55:41.816][ERROR][RK0][main]: 3 allocated 6553600 at 0x7f0468f60000
[HCTR][01:55:41.817][ERROR][RK0][tid #139650945488640]: 2 allocated 3276800 at 0x7ef0d3720000
[HCTR][01:55:41.817][ERROR][RK0][tid #139650945488640]: 2 allocated 6553600 at 0x7f0468600000
[HCTR][01:55:41.817][ERROR][RK0][tid #139650945488640]: 2 allocated 3276800 at 0x7f0468c40000
[HCTR][01:55:41.817][ERROR][RK0][tid #139650945488640]: 2 allocated 6553600 at 0x7f0468f60000
[HCTR][01:55:41.820][ERROR][RK0][tid #139650458973952]: 0 allocated 3276800 at 0x7eed74720000
[HCTR][01:55:41.820][ERROR][RK0][tid #139650458973952]: 0 allocated 6553600 at 0x7eed74c00000
[HCTR][01:55:41.820][ERROR][RK0][tid #139650458973952]: 0 allocated 3276800 at 0x7eead650e800
[HCTR][01:55:41.820][ERROR][RK0][tid #139650458973952]: 0 allocated 6553600 at 0x7eead682e800




