2022-12-12 01:39:13.566220: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:39:13.585392: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:39:13.585392: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:39:13.612123: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-12 01:39:14.529900: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:39:14.529982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:39:14.542151: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:39:14.542227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:39:14.543310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-12 01:39:14.555261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-12 01:39:14.559322: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:39:14.559454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:39:14.559490: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-12 01:39:14.559620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:39:14.575006: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:39:14.575160: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:39:14.575956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-12 01:39:14.576570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-12 01:39:14.577203: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-12 01:39:14.588068: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:39:14.588240: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:39:14.589232: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-12 01:39:14.606961: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:39:14.607025: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:39:14.607131: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:39:14.607163: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-12 01:39:14.608628: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-12 01:39:14.608789: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][01:39:15.828][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:39:15.845][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:39:15.876][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][01:39:15.886][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.60s/it]warmup run: 103it [00:01, 83.89it/s]warmup run: 207it [00:01, 183.77it/s]warmup run: 0it [00:00, ?it/s]warmup run: 309it [00:01, 292.05it/s]warmup run: 413it [00:02, 408.77it/s]warmup run: 523it [00:02, 534.18it/s]warmup run: 635it [00:02, 655.09it/s]warmup run: 748it [00:02, 762.10it/s]warmup run: 863it [00:02, 855.95it/s]warmup run: 977it [00:02, 928.98it/s]warmup run: 1090it [00:02, 981.97it/s]warmup run: 1202it [00:02, 1018.19it/s]warmup run: 1313it [00:02, 948.72it/s] warmup run: 1it [00:01,  1.49s/it]warmup run: 1416it [00:02, 921.97it/s]warmup run: 111it [00:01, 97.06it/s]warmup run: 1528it [00:03, 972.86it/s]warmup run: 221it [00:01, 208.50it/s]warmup run: 1640it [00:03, 1011.80it/s]warmup run: 327it [00:01, 325.22it/s]warmup run: 1748it [00:03, 1030.20it/s]warmup run: 1it [00:01,  1.41s/it]warmup run: 434it [00:01, 447.06it/s]warmup run: 1858it [00:03, 1049.10it/s]warmup run: 87it [00:01, 79.70it/s]warmup run: 542it [00:01, 566.08it/s]warmup run: 1967it [00:03, 1060.85it/s]warmup run: 193it [00:01, 193.35it/s]warmup run: 650it [00:02, 674.93it/s]warmup run: 2090it [00:03, 1108.58it/s]warmup run: 299it [00:01, 316.47it/s]warmup run: 758it [00:02, 767.94it/s]warmup run: 2223it [00:03, 1172.56it/s]warmup run: 402it [00:01, 436.55it/s]warmup run: 865it [00:02, 842.55it/s]warmup run: 2356it [00:03, 1217.31it/s]warmup run: 498it [00:01, 537.47it/s]warmup run: 971it [00:02, 899.35it/s]warmup run: 2489it [00:03, 1249.39it/s]warmup run: 605it [00:02, 652.64it/s]warmup run: 1078it [00:02, 945.18it/s]warmup run: 2621it [00:03, 1270.12it/s]warmup run: 712it [00:02, 750.33it/s]warmup run: 1185it [00:02, 979.09it/s]warmup run: 2753it [00:04, 1284.66it/s]warmup run: 813it [00:02, 789.52it/s]warmup run: 1292it [00:02, 1002.95it/s]warmup run: 2888it [00:04, 1301.57it/s]warmup run: 913it [00:02, 842.35it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1399it [00:02, 1006.80it/s]warmup run: 3000it [00:04, 703.38it/s] warmup run: 1011it [00:02, 864.21it/s]warmup run: 1504it [00:02, 986.68it/s] warmup run: 1118it [00:02, 920.08it/s]warmup run: 1606it [00:03, 995.28it/s]warmup run: 1225it [00:02, 961.89it/s]warmup run: 1715it [00:03, 1020.04it/s]warmup run: 1331it [00:02, 987.96it/s]warmup run: 1824it [00:03, 1038.15it/s]warmup run: 1439it [00:02, 1013.15it/s]warmup run: 1933it [00:03, 1051.26it/s]warmup run: 1547it [00:02, 1029.79it/s]warmup run: 2051it [00:03, 1088.90it/s]warmup run: 1654it [00:03, 1040.92it/s]warmup run: 2188it [00:03, 1171.24it/s]warmup run: 1764it [00:03, 1055.51it/s]warmup run: 2325it [00:03, 1229.17it/s]warmup run: 1877it [00:03, 1076.71it/s]warmup run: 2462it [00:03, 1269.51it/s]warmup run: 1993it [00:03, 1100.43it/s]warmup run: 2599it [00:03, 1297.90it/s]warmup run: 2128it [00:03, 1172.69it/s]warmup run: 2735it [00:03, 1314.22it/s]warmup run: 2265it [00:03, 1229.77it/s]warmup run: 2872it [00:04, 1329.70it/s]warmup run: 2401it [00:03, 1267.09it/s]warmup run: 3000it [00:04, 729.25it/s] warmup run: 2538it [00:03, 1296.42it/s]warmup run: 1it [00:01,  1.42s/it]warmup run: 2674it [00:03, 1313.32it/s]warmup run: 104it [00:01, 94.91it/s]warmup run: 2811it [00:03, 1327.43it/s]warmup run: 211it [00:01, 207.54it/s]warmup run: 2948it [00:04, 1338.10it/s]warmup run: 321it [00:01, 333.85it/s]warmup run: 3000it [00:04, 734.00it/s] warmup run: 424it [00:01, 450.31it/s]warmup run: 532it [00:01, 571.32it/s]warmup run: 641it [00:02, 683.21it/s]warmup run: 744it [00:02, 743.41it/s]warmup run: 854it [00:02, 829.62it/s]warmup run: 963it [00:02, 896.99it/s]warmup run: 1069it [00:02, 940.81it/s]warmup run: 1177it [00:02, 978.67it/s]warmup run: 1284it [00:02, 1003.11it/s]warmup run: 1394it [00:02, 1028.25it/s]warmup run: 1501it [00:02, 1030.76it/s]warmup run: 1607it [00:02, 1008.37it/s]warmup run: 1710it [00:03, 982.40it/s] warmup run: 1810it [00:03, 970.03it/s]warmup run: 1920it [00:03, 1004.69it/s]warmup run: 2035it [00:03, 1045.72it/s]warmup run: 2172it [00:03, 1138.36it/s]warmup run: 2309it [00:03, 1204.30it/s]warmup run: 2447it [00:03, 1254.76it/s]warmup run: 2584it [00:03, 1288.34it/s]warmup run: 2722it [00:03, 1315.00it/s]warmup run: 2859it [00:03, 1329.09it/s]warmup run: 2996it [00:04, 1340.95it/s]warmup run: 3000it [00:04, 734.83it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 179/3000 [00:00<00:01, 1781.09it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1744.65it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1661.95it/s]warmup should be done:   5%|▌         | 162/3000 [00:00<00:01, 1616.48it/s]warmup should be done:  12%|█▏        | 360/3000 [00:00<00:01, 1796.84it/s]warmup should be done:  12%|█▏        | 347/3000 [00:00<00:01, 1741.42it/s]warmup should be done:  12%|█▏        | 346/3000 [00:00<00:01, 1745.82it/s]warmup should be done:  12%|█▏        | 355/3000 [00:00<00:01, 1773.23it/s]warmup should be done:  17%|█▋        | 524/3000 [00:00<00:01, 1752.34it/s]warmup should be done:  18%|█▊        | 528/3000 [00:00<00:01, 1777.36it/s]warmup should be done:  18%|█▊        | 535/3000 [00:00<00:01, 1784.11it/s]warmup should be done:  18%|█▊        | 540/3000 [00:00<00:01, 1725.77it/s]warmup should be done:  23%|██▎       | 703/3000 [00:00<00:01, 1766.13it/s]warmup should be done:  24%|██▍       | 718/3000 [00:00<00:01, 1799.50it/s]warmup should be done:  24%|██▎       | 712/3000 [00:00<00:01, 1798.19it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1537.18it/s]warmup should be done:  29%|██▉       | 881/3000 [00:00<00:01, 1770.61it/s]warmup should be done:  30%|██▉       | 898/3000 [00:00<00:01, 1799.22it/s]warmup should be done:  30%|██▉       | 895/3000 [00:00<00:01, 1806.15it/s]warmup should be done:  30%|██▉       | 891/3000 [00:00<00:01, 1616.08it/s]warmup should be done:  36%|███▌      | 1079/3000 [00:00<00:01, 1800.01it/s]warmup should be done:  36%|███▌      | 1077/3000 [00:00<00:01, 1807.56it/s]warmup should be done:  35%|███▌      | 1059/3000 [00:00<00:01, 1727.05it/s]warmup should be done:  36%|███▌      | 1069/3000 [00:00<00:01, 1666.41it/s]warmup should be done:  42%|████▏     | 1260/3000 [00:00<00:00, 1798.95it/s]warmup should be done:  42%|████▏     | 1260/3000 [00:00<00:00, 1812.67it/s]warmup should be done:  41%|████      | 1232/3000 [00:00<00:01, 1666.59it/s]warmup should be done:  42%|████▏     | 1247/3000 [00:00<00:01, 1701.51it/s]warmup should be done:  48%|████▊     | 1441/3000 [00:00<00:00, 1801.89it/s]warmup should be done:  48%|████▊     | 1442/3000 [00:00<00:00, 1810.32it/s]warmup should be done:  47%|████▋     | 1412/3000 [00:00<00:00, 1705.04it/s]warmup should be done:  48%|████▊     | 1427/3000 [00:00<00:00, 1729.98it/s]warmup should be done:  54%|█████▍    | 1622/3000 [00:00<00:00, 1801.69it/s]warmup should be done:  54%|█████▍    | 1624/3000 [00:00<00:00, 1798.94it/s]warmup should be done:  53%|█████▎    | 1590/3000 [00:00<00:00, 1725.91it/s]warmup should be done:  54%|█████▎    | 1606/3000 [00:00<00:00, 1747.71it/s]warmup should be done:  60%|██████    | 1803/3000 [00:01<00:00, 1802.12it/s]warmup should be done:  60%|██████    | 1804/3000 [00:01<00:00, 1787.19it/s]warmup should be done:  59%|█████▉    | 1770/3000 [00:01<00:00, 1746.69it/s]warmup should be done:  59%|█████▉    | 1782/3000 [00:01<00:00, 1697.17it/s]warmup should be done:  66%|██████▌   | 1984/3000 [00:01<00:00, 1801.28it/s]warmup should be done:  66%|██████▌   | 1983/3000 [00:01<00:00, 1778.55it/s]warmup should be done:  65%|██████▍   | 1945/3000 [00:01<00:00, 1678.71it/s]warmup should be done:  65%|██████▌   | 1964/3000 [00:01<00:00, 1730.96it/s]warmup should be done:  72%|███████▏  | 2165/3000 [00:01<00:00, 1801.81it/s]warmup should be done:  72%|███████▏  | 2161/3000 [00:01<00:00, 1775.29it/s]warmup should be done:  71%|███████   | 2126/3000 [00:01<00:00, 1716.57it/s]warmup should be done:  72%|███████▏  | 2146/3000 [00:01<00:00, 1755.66it/s]warmup should be done:  78%|███████▊  | 2346/3000 [00:01<00:00, 1802.71it/s]warmup should be done:  78%|███████▊  | 2339/3000 [00:01<00:00, 1773.92it/s]warmup should be done:  77%|███████▋  | 2308/3000 [00:01<00:00, 1744.55it/s]warmup should be done:  78%|███████▊  | 2327/3000 [00:01<00:00, 1769.21it/s]warmup should be done:  84%|████████▍ | 2529/3000 [00:01<00:00, 1809.74it/s]warmup should be done:  84%|████████▍ | 2518/3000 [00:01<00:00, 1777.30it/s]warmup should be done:  83%|████████▎ | 2492/3000 [00:01<00:00, 1771.04it/s]warmup should be done:  84%|████████▎ | 2509/3000 [00:01<00:00, 1782.20it/s]warmup should be done:  90%|█████████ | 2711/3000 [00:01<00:00, 1810.12it/s]warmup should be done:  90%|████████▉ | 2696/3000 [00:01<00:00, 1777.73it/s]warmup should be done:  89%|████████▉ | 2675/3000 [00:01<00:00, 1787.80it/s]warmup should be done:  90%|████████▉ | 2688/3000 [00:01<00:00, 1783.43it/s]warmup should be done:  96%|█████████▋| 2893/3000 [00:01<00:00, 1809.98it/s]warmup should be done:  96%|█████████▌| 2875/3000 [00:01<00:00, 1778.52it/s]warmup should be done:  95%|█████████▌| 2858/3000 [00:01<00:00, 1799.28it/s]warmup should be done:  96%|█████████▌| 2867/3000 [00:01<00:00, 1778.27it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1801.96it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1782.81it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1749.69it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1731.73it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1679.73it/s]warmup should be done:   6%|▌         | 184/3000 [00:00<00:01, 1833.15it/s]warmup should be done:   6%|▌         | 180/3000 [00:00<00:01, 1798.69it/s]warmup should be done:   6%|▌         | 175/3000 [00:00<00:01, 1740.66it/s]warmup should be done:  12%|█▏        | 368/3000 [00:00<00:01, 1845.61it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1775.78it/s]warmup should be done:  12%|█▏        | 369/3000 [00:00<00:01, 1838.93it/s]warmup should be done:  12%|█▏        | 357/3000 [00:00<00:01, 1786.94it/s]warmup should be done:  19%|█▊        | 556/3000 [00:00<00:01, 1860.62it/s]warmup should be done:  18%|█▊        | 540/3000 [00:00<00:01, 1806.45it/s]warmup should be done:  18%|█▊        | 555/3000 [00:00<00:01, 1844.80it/s]warmup should be done:  18%|█▊        | 531/3000 [00:00<00:01, 1720.20it/s]warmup should be done:  25%|██▍       | 744/3000 [00:00<00:01, 1865.14it/s]warmup should be done:  25%|██▍       | 740/3000 [00:00<00:01, 1845.85it/s]warmup should be done:  24%|██▍       | 726/3000 [00:00<00:01, 1824.90it/s]warmup should be done:  24%|██▍       | 718/3000 [00:00<00:01, 1775.91it/s]warmup should be done:  31%|███       | 931/3000 [00:00<00:01, 1864.28it/s]warmup should be done:  30%|███       | 912/3000 [00:00<00:01, 1836.79it/s]warmup should be done:  31%|███       | 925/3000 [00:00<00:01, 1846.54it/s]warmup should be done:  30%|███       | 904/3000 [00:00<00:01, 1805.44it/s]warmup should be done:  37%|███▋      | 1098/3000 [00:00<00:01, 1844.38it/s]warmup should be done:  37%|███▋      | 1120/3000 [00:00<00:01, 1870.18it/s]warmup should be done:  37%|███▋      | 1110/3000 [00:00<00:01, 1811.11it/s]warmup should be done:  36%|███▋      | 1091/3000 [00:00<00:01, 1825.12it/s]warmup should be done:  43%|████▎     | 1283/3000 [00:00<00:00, 1844.04it/s]warmup should be done:  44%|████▎     | 1308/3000 [00:00<00:00, 1837.38it/s]warmup should be done:  43%|████▎     | 1276/3000 [00:00<00:00, 1831.40it/s]warmup should be done:  43%|████▎     | 1292/3000 [00:00<00:00, 1782.64it/s]warmup should be done:  50%|████▉     | 1493/3000 [00:00<00:00, 1840.17it/s]warmup should be done:  49%|████▉     | 1463/3000 [00:00<00:00, 1841.52it/s]warmup should be done:  49%|████▉     | 1477/3000 [00:00<00:00, 1801.83it/s]warmup should be done:  49%|████▉     | 1468/3000 [00:00<00:00, 1766.52it/s]warmup should be done:  56%|█████▌    | 1681/3000 [00:00<00:00, 1850.39it/s]warmup should be done:  55%|█████▍    | 1649/3000 [00:00<00:00, 1845.58it/s]warmup should be done:  55%|█████▌    | 1662/3000 [00:00<00:00, 1815.89it/s]warmup should be done:  55%|█████▍    | 1646/3000 [00:00<00:00, 1702.76it/s]warmup should be done:  61%|██████    | 1834/3000 [00:01<00:00, 1845.31it/s]warmup should be done:  62%|██████▏   | 1867/3000 [00:01<00:00, 1843.25it/s]warmup should be done:  62%|██████▏   | 1849/3000 [00:01<00:00, 1830.79it/s]warmup should be done:  61%|██████    | 1828/3000 [00:01<00:00, 1734.96it/s]warmup should be done:  68%|██████▊   | 2052/3000 [00:01<00:00, 1840.97it/s]warmup should be done:  68%|██████▊   | 2036/3000 [00:01<00:00, 1841.50it/s]warmup should be done:  67%|██████▋   | 2019/3000 [00:01<00:00, 1809.21it/s]warmup should be done:  67%|██████▋   | 2009/3000 [00:01<00:00, 1754.88it/s]warmup should be done:  75%|███████▍  | 2237/3000 [00:01<00:00, 1839.77it/s]warmup should be done:  74%|███████▍  | 2223/3000 [00:01<00:00, 1848.53it/s]warmup should be done:  74%|███████▎  | 2207/3000 [00:01<00:00, 1828.26it/s]warmup should be done:  73%|███████▎  | 2186/3000 [00:01<00:00, 1755.96it/s]warmup should be done:  81%|████████  | 2422/3000 [00:01<00:00, 1839.91it/s]warmup should be done:  80%|████████  | 2410/3000 [00:01<00:00, 1852.98it/s]warmup should be done:  80%|███████▉  | 2395/3000 [00:01<00:00, 1843.08it/s]warmup should be done:  79%|███████▉  | 2370/3000 [00:01<00:00, 1779.85it/s]warmup should be done:  87%|████████▋ | 2608/3000 [00:01<00:00, 1843.88it/s]warmup should be done:  87%|████████▋ | 2597/3000 [00:01<00:00, 1857.28it/s]warmup should be done:  86%|████████▌ | 2583/3000 [00:01<00:00, 1854.09it/s]warmup should be done:  85%|████████▍ | 2549/3000 [00:01<00:00, 1721.53it/s]warmup should be done:  93%|█████████▎| 2794/3000 [00:01<00:00, 1847.71it/s]warmup should be done:  93%|█████████▎| 2785/3000 [00:01<00:00, 1861.42it/s]warmup should be done:  92%|█████████▏| 2769/3000 [00:01<00:00, 1836.73it/s]warmup should be done:  91%|█████████ | 2722/3000 [00:01<00:00, 1706.79it/s]warmup should be done:  99%|█████████▉| 2980/3000 [00:01<00:00, 1850.23it/s]warmup should be done:  99%|█████████▉| 2972/3000 [00:01<00:00, 1863.69it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1847.53it/s]warmup should be done:  98%|█████████▊| 2953/3000 [00:01<00:00, 1800.66it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1840.05it/s]warmup should be done:  96%|█████████▋| 2894/3000 [00:01<00:00, 1701.74it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1814.86it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1752.87it/s]2022-12-12 01:40:33.981012: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7faaa2a65a70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:40:33.981073: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:40:35.609873: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:40:36.758379: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:40:37.938286: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7faa96267490 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:40:37.938346: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:40:38.201942: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:40:38.692973: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7faaa2a6af80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:40:38.693032: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:40:40.307062: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:40:41.401853: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:40:42.648032: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:40:42.662662: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:40:44.232753: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7faaa2a67b40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-12 01:40:44.232813: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-12 01:40:44.668092: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:40:46.404037: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-12 01:40:48.513687: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-12 01:40:50.402749: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-12 01:40:52.260665: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][01:41:17.451][ERROR][RK0][tid #140371224925952]: replica 3 reaches 1000, calling init pre replica
[HCTR][01:41:17.452][ERROR][RK0][tid #140371224925952]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][01:41:17.457][ERROR][RK0][tid #140371224925952]: coll ps creation done
[HCTR][01:41:17.457][ERROR][RK0][tid #140371224925952]: replica 3 waits for coll ps creation barrier
[HCTR][01:41:17.846][ERROR][RK0][tid #140371359143680]: replica 1 reaches 1000, calling init pre replica
[HCTR][01:41:17.846][ERROR][RK0][tid #140371359143680]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][01:41:17.850][ERROR][RK0][tid #140371359143680]: coll ps creation done
[HCTR][01:41:17.850][ERROR][RK0][tid #140371359143680]: replica 1 waits for coll ps creation barrier
[HCTR][01:41:18.020][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][01:41:18.020][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][01:41:18.023][ERROR][RK0][main]: coll ps creation done
[HCTR][01:41:18.023][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][01:41:18.202][ERROR][RK0][tid #140371224925952]: replica 0 reaches 1000, calling init pre replica
[HCTR][01:41:18.202][ERROR][RK0][tid #140371224925952]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][01:41:18.207][ERROR][RK0][tid #140371224925952]: coll ps creation done
[HCTR][01:41:18.207][ERROR][RK0][tid #140371224925952]: replica 0 waits for coll ps creation barrier
[HCTR][01:41:18.207][ERROR][RK0][tid #140371224925952]: replica 0 preparing frequency
[HCTR][01:41:19.167][ERROR][RK0][tid #140371224925952]: replica 0 preparing frequency done
[HCTR][01:41:19.202][ERROR][RK0][tid #140371224925952]: replica 0 calling init per replica
[HCTR][01:41:19.202][ERROR][RK0][tid #140371359143680]: replica 1 calling init per replica
[HCTR][01:41:19.202][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][01:41:19.202][ERROR][RK0][tid #140371224925952]: replica 3 calling init per replica
[HCTR][01:41:19.202][ERROR][RK0][tid #140371224925952]: Calling build_v2
[HCTR][01:41:19.202][ERROR][RK0][tid #140371359143680]: Calling build_v2
[HCTR][01:41:19.202][ERROR][RK0][main]: Calling build_v2
[HCTR][01:41:19.202][ERROR][RK0][tid #140371224925952]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:41:19.202][ERROR][RK0][tid #140371359143680]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:41:19.202][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][01:41:19.202][ERROR][RK0][tid #140371224925952]: Calling build_v2
[HCTR][01:41:19.202][ERROR][RK0][tid #140371224925952]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[2022-12-12 01:41:19.[2022362022-12-12 01:41:19: .E[2022-12-12 01:41:19202257 2022-12-12 01:41:19.: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc.202245E:202281:  136: E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] E :using concurrent impl MPS /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc136
/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:] :136using concurrent impl MPS136] 
] using concurrent impl MPSusing concurrent impl MPS

[2022-12-12 01:41:19.203503: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu
[2022-12-12 01:41:19.203548: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:212] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2022-12-12 01:41:19.203578: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-12 01:41:19:.196203595] : assigning 8 to cpuE
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:[2022-12-12 01:41:19[2132022-12-12 01:41:19.2022-12-12 01:41:19] .203614.remote time is 8.68421203627: 203640
: E[: E 2022-12-12 01:41:19E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc. /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:203697/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196: :196] E212] assigning 8 to cpu ] assigning 8 to cpu
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4
:
214] cpu time is 30
[[2022-12-12 01:41:192022-12-12 01:41:19..203808203811: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::212213] ] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4remote time is 8.68421

[[2022-12-12 01:41:192022-12-12 01:41:19..203869203871: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[::2022-12-12 01:41:19214213.] ] 203880cpu time is 30remote time is 8.68421: 

E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2122022-12-12 01:41:19] .build symm link desc with 4X Tesla V100-SXM2-16GB out of 4203970
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2022-12-12 01:41:19214.] 204019cpu time is 30: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:213] remote time is 8.68421
[2022-12-12 01:41:19.204084: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-12 01:41:42.776452: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-12 01:41:42.839476: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-12 01:41:42.979150: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-12 01:41:42.979228: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-12 01:41:42.979288: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-12 01:41:42.979333: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-12 01:41:42.981465: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:41:42.981541: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:41:42.983621: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:41:42.984421: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:41:43.  3835: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-12 01:41:43.  3908: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-12 01:41:43.  4186: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:41:43.  4234: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:41:43.  4991: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:41:43.  5530: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:41:43.  8836[: E2022-12-12 01:41:43 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc  8847:: 202E]  3 solved/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc
:202] 1 solved[
2022-12-12 01:41:43.  8915: [E2022-12-12 01:41:43 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc  8927:: 205E]  worker 0 thread 3 initing device 3/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc
:205] worker 0 thread 1 initing device 1
[2022-12-12 01:41:43.  9183: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:41:43.  9227: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:41:43.  9420: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-12 01:41:43.  9466: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:41:43. 10374: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:41:43. 10473: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:41:43. 11415: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:41:43. 11444: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-12 01:41:43. 62700: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 01:41:43. 64511: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 01:41:43. 64566: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:41:43. 65405: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 01:41:43. 67925: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:41:43. 68917: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:41:43. 68963: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.04 MB
[2022-12-12 01:41:43. 98570: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:41:43. 98727: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 01:41:43. 99208: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:41:43. 99252: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 01:41:43.100571: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 01:41:43.100625: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:41:43.114543: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 01:41:43.115101: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 01:41:43.115165: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-12 01:41:43.115689: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:41:43.116314: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 01:41:43.116359: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:41:43.116714: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:41:43.116758: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.04 MB
[2022-12-12 01:41:43.116931: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-12 01:41:43.116980: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-12 01:41:43.117036: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 01:41:43.117806: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 61.42 MB
[2022-12-12 01:41:43.118042: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:41:43.118240: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:41:43.119008: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:41:43.119056: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.04 MB
[2022-12-12 01:41:43.119200: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:41:43.119247: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 61.04 MB
[2022-12-12 01:41:43.145164: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:41:43.145750: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:41:43.145791: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 01:41:43.148239: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:41:43.148805: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:41:43.148845: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[2022-12-12 01:41:43.164752: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-12 01:41:43.165348: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-12 01:41:43.165391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 7.63 GB
[[[[2022-12-12 01:41:432022-12-12 01:41:432022-12-12 01:41:432022-12-12 01:41:43....868313868304868303868303: : : : EEEE    /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::::1926192619261926] ] ] ] Device 1 init p2p of link 2Device 0 init p2p of link 1Device 3 init p2p of link 0Device 2 init p2p of link 3



[[2022-12-12 01:41:432022-12-12 01:41:43[..2022-12-12 01:41:43868633868634.: : 868640EE:   E[/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu 2022-12-12 01:41:43::/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.19801980:868673] ] 1980: eager alloc mem 611.00 KBeager alloc mem 611.00 KB] E

eager alloc mem 611.00 KB 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[[2022-12-12 01:41:432022-12-12 01:41:43..869551869554[: : 2022-12-12 01:41:43EE. [ 869568/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc2022-12-12 01:41:43/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc: :.:E638869579638 ] : ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cceager release cuda mem 625663Eeager release cuda mem 625663:
 
638/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] :eager release cuda mem 625663638
] eager release cuda mem 625663
[2022-12-12 01:41:43.880156: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[2022-12-12 01:41:43.880211: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 2
[2022-12-12 01:41:43.880260: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:41:43.[8803072022-12-12 01:41:43: .E880324 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1926/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :[Device 1 init p2p of link 319802022-12-12 01:41:43
] .eager alloc mem 611.00 KB880346
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-12 01:41:43.880462: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:41:43.880493: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:41:43.881082: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:41:43.881198: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:41:43.881282: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:41:43.881323: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:41:43.892194: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-12 01:41:43.892284: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:41:43.892630: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-12 01:41:43.892729: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:41:43.892866: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 1 init p2p of link 0
[2022-12-12 01:41:43.892921: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-12 01:41:43.892963: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:41:43.893014: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-12 01:41:43.893108: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:41:43.893547: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:41:43.893784: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:41:43.893836: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-12 01:41:43.902413: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 01:41:43.902741: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 15999999 / 100000000 nodes ( 16.00 %~16.00 %) | remote 47999997 / 100000000 nodes ( 48.00 %) | cpu 36000004 / 100000000 nodes ( 36.00 %) | 7.63 GB | 0.893521 secs 
[2022-12-12 01:41:43.903211: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 01:41:43.903541: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 15999999 / 100000000 nodes ( 16.00 %~16.00 %) | remote 47999997 / 100000000 nodes ( 48.00 %) | cpu 36000004 / 100000000 nodes ( 36.00 %) | 7.63 GB | 0.922015 secs 
[2022-12-12 01:41:43.903595: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 01:41:43.903667: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 64399996
[2022-12-12 01:41:43.903938: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 15999999 / 100000000 nodes ( 16.00 %~16.00 %) | remote 47999997 / 100000000 nodes ( 48.00 %) | cpu 36000004 / 100000000 nodes ( 36.00 %) | 7.63 GB | 0.894483 secs 
[2022-12-12 01:41:43.904129: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 15999999 / 100000000 nodes ( 16.00 %~16.00 %) | remote 47999997 / 100000000 nodes ( 48.00 %) | cpu 36000004 / 100000000 nodes ( 36.00 %) | 7.63 GB | 0.899908 secs 
[2022-12-12 01:41:43.904560: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.66 GB
[2022-12-12 01:41:44.856159: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 12.91 GB
[2022-12-12 01:41:44.856407: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 12.91 GB
[2022-12-12 01:41:44.857242: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 12.91 GB
[2022-12-12 01:41:45.642394: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.15 GB
[2022-12-12 01:41:45.642633: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.15 GB
[2022-12-12 01:41:45.643023: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.15 GB
[2022-12-12 01:41:46.635660: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.40 GB
[2022-12-12 01:41:46.636049: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.40 GB
[2022-12-12 01:41:46.636429: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.40 GB
[2022-12-12 01:41:47.665439: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 13.81 GB
[2022-12-12 01:41:47.665770: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 13.81 GB
[2022-12-12 01:41:47.666206: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 13.81 GB
[2022-12-12 01:41:48.271975: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 14.00 GB
[2022-12-12 01:41:48.272095: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 14.00 GB
[HCTR][01:41:48.321][ERROR][RK0][tid #140371224925952]: replica 3 calling init per replica done, doing barrier
[HCTR][01:41:48.321][ERROR][RK0][tid #140371359143680]: replica 1 calling init per replica done, doing barrier
[HCTR][01:41:48.321][ERROR][RK0][tid #140371224925952]: replica 0 calling init per replica done, doing barrier
[HCTR][01:41:48.321][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][01:41:48.321][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][01:41:48.321][ERROR][RK0][tid #140371224925952]: replica 0 calling init per replica done, doing barrier done
[HCTR][01:41:48.321][ERROR][RK0][tid #140371359143680]: replica 1 calling init per replica done, doing barrier done
[HCTR][01:41:48.321][ERROR][RK0][tid #140371224925952]: replica 3 calling init per replica done, doing barrier done
[HCTR][01:41:48.321][ERROR][RK0][main]: init per replica done
[HCTR][01:41:48.321][ERROR][RK0][tid #140371359143680]: init per replica done
[HCTR][01:41:48.321][ERROR][RK0][tid #140371224925952]: init per replica done
[HCTR][01:41:48.324][ERROR][RK0][tid #140371224925952]: init per replica done
[HCTR][01:41:48.328][ERROR][RK0][tid #140371359143680]: 1 allocated 3276800 at 0x7f988f720000
[HCTR][01:41:48.328][ERROR][RK0][tid #140371359143680]: 1 allocated 6553600 at 0x7fac26600000
[HCTR][01:41:48.328][ERROR][RK0][tid #140371359143680]: 1 allocated 3276800 at 0x7fac26c40000
[HCTR][01:41:48.328][ERROR][RK0][tid #140371359143680]: 1 allocated 6553600 at 0x7fac26f60000
[HCTR][01:41:48.329][ERROR][RK0][tid #140371224925952]: 3 allocated 3276800 at 0x7f988f720000
[HCTR][01:41:48.329][ERROR][RK0][tid #140371224925952]: 3 allocated 6553600 at 0x7fac24600000
[HCTR][01:41:48.329][ERROR][RK0][tid #140371224925952]: 3 allocated 3276800 at 0x7fac24c40000
[HCTR][01:41:48.329][ERROR][RK0][tid #140371224925952]: 3 allocated 6553600 at 0x7fac24f60000
[HCTR][01:41:48.329][ERROR][RK0][main]: 2 allocated 3276800 at 0x7f9893720000
[HCTR][01:41:48.329][ERROR][RK0][main]: 2 allocated 6553600 at 0x7fac24600000
[HCTR][01:41:48.329][ERROR][RK0][main]: 2 allocated 3276800 at 0x7fac24c40000
[HCTR][01:41:48.329][ERROR][RK0][main]: 2 allocated 6553600 at 0x7fac24f60000
[HCTR][01:41:48.332][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f952c720000
[HCTR][01:41:48.332][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f952cc00000
[HCTR][01:41:48.332][ERROR][RK0][main]: 0 allocated 3276800 at 0x7f924650e800
[HCTR][01:41:48.332][ERROR][RK0][main]: 0 allocated 6553600 at 0x7f924682e800




