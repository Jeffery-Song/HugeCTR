2022-12-11 22:00:30.621389: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:00:30.703764: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:00:30.704631: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:00:30.705004: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-11 22:00:31.494045: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:00:31.494129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:00:31.507482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0
2022-12-11 22:00:31.542442: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:00:31.542644: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:00:31.544577: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12340
2022-12-11 22:00:31.576910: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:00:31.576991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:00:31.586006: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:00:31.586085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:00:31.590464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:3/device:GPU:0 with 14621 MB memory:  -> device: 3, name: Tesla V100-SXM2-16GB, pci bus id: 0000:af:00.0, compute capability: 7.0
2022-12-11 22:00:31.591003: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2022-12-11 22:00:31.591084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:00:31.598593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:2/device:GPU:0 with 14621 MB memory:  -> device: 2, name: Tesla V100-SXM2-16GB, pci bus id: 0000:86:00.0, compute capability: 7.0
2022-12-11 22:00:31.603653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:worker/replica:0/task:1/device:GPU:0 with 14621 MB memory:  -> device: 1, name: Tesla V100-SXM2-16GB, pci bus id: 0000:3b:00.0, compute capability: 7.0
2022-12-11 22:00:31.627445: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:00:31.627620: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:00:31.629240: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12343
2022-12-11 22:00:31.629677: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:00:31.629858: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:00:31.631358: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12342
2022-12-11 22:00:31.638233: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:00:31.638438: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:272] Initialize GrpcChannelCache for job worker -> {0 -> localhost:12340, 1 -> localhost:12341, 2 -> localhost:12342, 3 -> localhost:12343}
2022-12-11 22:00:31.640074: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:438] Started server with target: grpc://localhost:12341
[HCTR][22:00:32.871][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:00:32.873][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:00:32.913][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
[HCTR][22:00:32.929][ERROR][RK0][main]: using mock embedding with 100000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.44s/it]warmup run: 108it [00:01, 96.91it/s]warmup run: 218it [00:01, 211.05it/s]warmup run: 329it [00:01, 336.72it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 1it [00:01,  1.41s/it]warmup run: 441it [00:01, 466.95it/s]warmup run: 107it [00:01, 97.05it/s]warmup run: 103it [00:01, 94.59it/s]warmup run: 554it [00:01, 593.97it/s]warmup run: 212it [00:01, 206.40it/s]warmup run: 208it [00:01, 205.52it/s]warmup run: 1it [00:01,  1.43s/it]warmup run: 668it [00:02, 710.64it/s]warmup run: 317it [00:01, 325.10it/s]warmup run: 313it [00:01, 325.70it/s]warmup run: 108it [00:01, 97.51it/s]warmup run: 781it [00:02, 808.96it/s]warmup run: 421it [00:01, 444.62it/s]warmup run: 419it [00:01, 449.36it/s]warmup run: 217it [00:01, 211.09it/s]warmup run: 892it [00:02, 883.48it/s]warmup run: 526it [00:01, 560.54it/s]warmup run: 525it [00:01, 567.78it/s]warmup run: 327it [00:01, 335.97it/s]warmup run: 1003it [00:02, 942.69it/s]warmup run: 631it [00:02, 666.03it/s]warmup run: 634it [00:02, 680.78it/s]warmup run: 435it [00:01, 459.87it/s]warmup run: 1113it [00:02, 984.69it/s]warmup run: 736it [00:02, 754.88it/s]warmup run: 743it [00:02, 776.43it/s]warmup run: 540it [00:01, 572.57it/s]warmup run: 1226it [00:02, 1024.30it/s]warmup run: 842it [00:02, 829.92it/s]warmup run: 852it [00:02, 853.83it/s]warmup run: 646it [00:02, 676.47it/s]warmup run: 1337it [00:02, 1044.45it/s]warmup run: 947it [00:02, 887.88it/s]warmup run: 961it [00:02, 914.60it/s]warmup run: 752it [00:02, 765.95it/s]warmup run: 1448it [00:02, 1051.50it/s]warmup run: 1053it [00:02, 934.09it/s]warmup run: 1070it [00:02, 960.30it/s]warmup run: 857it [00:02, 836.03it/s]warmup run: 1558it [00:02, 1052.41it/s]warmup run: 1160it [00:02, 970.61it/s]warmup run: 1178it [00:02, 991.76it/s]warmup run: 963it [00:02, 893.21it/s]warmup run: 1667it [00:02, 1055.19it/s]warmup run: 1265it [00:02, 991.22it/s]warmup run: 1285it [00:02, 1008.56it/s]warmup run: 1068it [00:02, 934.86it/s]warmup run: 1775it [00:03, 1058.79it/s]warmup run: 1370it [00:02, 1003.96it/s]warmup run: 1394it [00:02, 1030.03it/s]warmup run: 1176it [00:02, 973.99it/s]warmup run: 1883it [00:03, 1045.83it/s]warmup run: 1478it [00:02, 1024.23it/s]warmup run: 1501it [00:02, 1030.37it/s]warmup run: 1283it [00:02, 999.07it/s]warmup run: 1991it [00:03, 1053.61it/s]warmup run: 1587it [00:02, 1040.75it/s]warmup run: 1608it [00:02, 1041.14it/s]warmup run: 1391it [00:02, 1019.76it/s]warmup run: 2120it [00:03, 1122.87it/s]warmup run: 1694it [00:03, 1046.61it/s]warmup run: 1715it [00:03, 1048.74it/s]warmup run: 1497it [00:02, 1030.20it/s]warmup run: 2254it [00:03, 1185.64it/s]warmup run: 1801it [00:03, 1052.66it/s]warmup run: 1822it [00:03, 1043.30it/s]warmup run: 1604it [00:02, 1041.38it/s]warmup run: 2388it [00:03, 1229.35it/s]warmup run: 1910it [00:03, 1060.93it/s]warmup run: 1930it [00:03, 1054.05it/s]warmup run: 1711it [00:03, 1042.99it/s]warmup run: 2521it [00:03, 1258.58it/s]warmup run: 2020it [00:03, 1071.84it/s]warmup run: 2047it [00:03, 1087.71it/s]warmup run: 1818it [00:03, 1048.52it/s]warmup run: 2648it [00:03, 1261.45it/s]warmup run: 2153it [00:03, 1148.35it/s]warmup run: 2178it [00:03, 1153.48it/s]warmup run: 1924it [00:03, 1024.69it/s]warmup run: 2779it [00:03, 1275.52it/s]warmup run: 2287it [00:03, 1203.85it/s]warmup run: 2313it [00:03, 1211.43it/s]warmup run: 2041it [00:03, 1066.24it/s]warmup run: 2421it [00:03, 1244.34it/s]warmup run: 2907it [00:03, 1212.73it/s]warmup run: 2449it [00:03, 1254.11it/s]warmup run: 2175it [00:03, 1146.69it/s]warmup run: 3000it [00:04, 737.32it/s] warmup run: 2547it [00:03, 1246.72it/s]warmup run: 2579it [00:03, 1267.52it/s]warmup run: 2310it [00:03, 1204.51it/s]warmup run: 2680it [00:03, 1269.57it/s]warmup run: 2714it [00:03, 1291.02it/s]warmup run: 2445it [00:03, 1246.19it/s]warmup run: 2812it [00:03, 1283.39it/s]warmup run: 2848it [00:03, 1303.32it/s]warmup run: 2580it [00:03, 1276.62it/s]warmup run: 2945it [00:04, 1296.08it/s]warmup run: 2983it [00:04, 1315.09it/s]warmup run: 3000it [00:04, 733.26it/s] warmup run: 3000it [00:04, 741.25it/s] warmup run: 2714it [00:03, 1295.36it/s]warmup run: 2848it [00:03, 1306.89it/s]warmup run: 2983it [00:04, 1318.50it/s]warmup run: 3000it [00:04, 735.84it/s] 
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 178/3000 [00:00<00:01, 1771.60it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1717.12it/s]warmup should be done:   6%|▌         | 167/3000 [00:00<00:01, 1663.50it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1652.27it/s]warmup should be done:  12%|█▏        | 359/3000 [00:00<00:01, 1789.94it/s]warmup should be done:  12%|█▏        | 353/3000 [00:00<00:01, 1767.42it/s]warmup should be done:  11%|█▏        | 344/3000 [00:00<00:01, 1722.36it/s]warmup should be done:  11%|█▏        | 340/3000 [00:00<00:01, 1703.45it/s]warmup should be done:  18%|█▊        | 538/3000 [00:00<00:01, 1789.89it/s]warmup should be done:  18%|█▊        | 532/3000 [00:00<00:01, 1776.17it/s]warmup should be done:  17%|█▋        | 520/3000 [00:00<00:01, 1735.55it/s]warmup should be done:  17%|█▋        | 513/3000 [00:00<00:01, 1711.32it/s]warmup should be done:  24%|██▍       | 718/3000 [00:00<00:01, 1793.48it/s]warmup should be done:  24%|██▎       | 712/3000 [00:00<00:01, 1784.20it/s]warmup should be done:  23%|██▎       | 696/3000 [00:00<00:01, 1743.09it/s]warmup should be done:  23%|██▎       | 685/3000 [00:00<00:01, 1685.16it/s]warmup should be done:  30%|██▉       | 898/3000 [00:00<00:01, 1790.33it/s]warmup should be done:  29%|██▉       | 871/3000 [00:00<00:01, 1743.17it/s]warmup should be done:  30%|██▉       | 891/3000 [00:00<00:01, 1773.38it/s]warmup should be done:  28%|██▊       | 854/3000 [00:00<00:01, 1682.60it/s]warmup should be done:  35%|███▍      | 1047/3000 [00:00<00:01, 1746.45it/s]warmup should be done:  36%|███▌      | 1069/3000 [00:00<00:01, 1773.59it/s]warmup should be done:  36%|███▌      | 1078/3000 [00:00<00:01, 1759.14it/s]warmup should be done:  34%|███▍      | 1023/3000 [00:00<00:01, 1653.08it/s]warmup should be done:  41%|████      | 1222/3000 [00:00<00:01, 1745.06it/s]warmup should be done:  42%|████▏     | 1248/3000 [00:00<00:00, 1778.85it/s]warmup should be done:  42%|████▏     | 1255/3000 [00:00<00:00, 1754.13it/s]warmup should be done:  40%|████      | 1202/3000 [00:00<00:01, 1694.20it/s]warmup should be done:  48%|████▊     | 1427/3000 [00:00<00:00, 1781.64it/s]warmup should be done:  47%|████▋     | 1397/3000 [00:00<00:00, 1724.91it/s]warmup should be done:  48%|████▊     | 1435/3000 [00:00<00:00, 1767.87it/s]warmup should be done:  46%|████▌     | 1382/3000 [00:00<00:00, 1726.17it/s]warmup should be done:  54%|█████▎    | 1606/3000 [00:00<00:00, 1778.88it/s]warmup should be done:  53%|█████▎    | 1576/3000 [00:00<00:00, 1742.31it/s]warmup should be done:  54%|█████▍    | 1615/3000 [00:00<00:00, 1777.40it/s]warmup should be done:  52%|█████▏    | 1560/3000 [00:00<00:00, 1739.92it/s]warmup should be done:  60%|█████▉    | 1785/3000 [00:01<00:00, 1781.21it/s]warmup should be done:  58%|█████▊    | 1755/3000 [00:01<00:00, 1755.29it/s]warmup should be done:  58%|█████▊    | 1735/3000 [00:01<00:00, 1713.93it/s]warmup should be done:  60%|█████▉    | 1793/3000 [00:01<00:00, 1672.15it/s]warmup should be done:  65%|██████▌   | 1964/3000 [00:01<00:00, 1782.97it/s]warmup should be done:  64%|██████▍   | 1934/3000 [00:01<00:00, 1763.64it/s]warmup should be done:  64%|██████▎   | 1911/3000 [00:01<00:00, 1727.57it/s]warmup should be done:  66%|██████▌   | 1973/3000 [00:01<00:00, 1707.12it/s]warmup should be done:  71%|███████▏  | 2143/3000 [00:01<00:00, 1784.30it/s]warmup should be done:  70%|███████   | 2112/3000 [00:01<00:00, 1768.52it/s]warmup should be done:  70%|██████▉   | 2088/3000 [00:01<00:00, 1739.72it/s]warmup should be done:  72%|███████▏  | 2153/3000 [00:01<00:00, 1733.20it/s]warmup should be done:  77%|███████▋  | 2322/3000 [00:01<00:00, 1785.66it/s]warmup should be done:  76%|███████▋  | 2291/3000 [00:01<00:00, 1773.89it/s]warmup should be done:  75%|███████▌  | 2263/3000 [00:01<00:00, 1738.70it/s]warmup should be done:  78%|███████▊  | 2333/3000 [00:01<00:00, 1750.89it/s]warmup should be done:  83%|████████▎ | 2502/3000 [00:01<00:00, 1787.33it/s]warmup should be done:  82%|████████▏ | 2471/3000 [00:01<00:00, 1780.92it/s]warmup should be done:  81%|████████▏ | 2440/3000 [00:01<00:00, 1746.75it/s]warmup should be done:  84%|████████▎ | 2512/3000 [00:01<00:00, 1760.62it/s]warmup should be done:  89%|████████▉ | 2682/3000 [00:01<00:00, 1790.00it/s]warmup should be done:  88%|████████▊ | 2650/3000 [00:01<00:00, 1782.76it/s]warmup should be done:  87%|████████▋ | 2617/3000 [00:01<00:00, 1753.17it/s]warmup should be done:  90%|████████▉ | 2692/3000 [00:01<00:00, 1770.31it/s]warmup should be done:  95%|█████████▌| 2863/3000 [00:01<00:00, 1794.08it/s]warmup should be done:  94%|█████████▍| 2830/3000 [00:01<00:00, 1785.26it/s]warmup should be done:  93%|█████████▎| 2793/3000 [00:01<00:00, 1754.57it/s]warmup should be done:  96%|█████████▌| 2874/3000 [00:01<00:00, 1783.30it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1784.15it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1763.29it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1760.54it/s]warmup should be done:  99%|█████████▉| 2969/3000 [00:01<00:00, 1753.41it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1725.54it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/3000 [00:00<?, ?it/s]warmup should be done:   6%|▌         | 182/3000 [00:00<00:01, 1816.10it/s]warmup should be done:   6%|▌         | 166/3000 [00:00<00:01, 1658.87it/s]warmup should be done:   6%|▌         | 172/3000 [00:00<00:01, 1718.23it/s]warmup should be done:   6%|▌         | 168/3000 [00:00<00:01, 1671.57it/s]warmup should be done:  12%|█▏        | 349/3000 [00:00<00:01, 1757.46it/s]warmup should be done:  12%|█▏        | 354/3000 [00:00<00:01, 1780.40it/s]warmup should be done:  12%|█▏        | 356/3000 [00:00<00:01, 1786.33it/s]warmup should be done:  12%|█▏        | 365/3000 [00:00<00:01, 1809.96it/s]warmup should be done:  18%|█▊        | 533/3000 [00:00<00:01, 1791.79it/s]warmup should be done:  18%|█▊        | 541/3000 [00:00<00:01, 1816.97it/s]warmup should be done:  18%|█▊        | 540/3000 [00:00<00:01, 1806.70it/s]warmup should be done:  18%|█▊        | 547/3000 [00:00<00:01, 1813.86it/s]warmup should be done:  24%|██▍       | 724/3000 [00:00<00:01, 1819.09it/s]warmup should be done:  24%|██▍       | 729/3000 [00:00<00:01, 1838.99it/s]warmup should be done:  24%|██▍       | 713/3000 [00:00<00:01, 1783.81it/s]warmup should be done:  24%|██▍       | 729/3000 [00:00<00:01, 1810.07it/s]warmup should be done:  30%|███       | 915/3000 [00:00<00:01, 1845.03it/s]warmup should be done:  30%|██▉       | 899/3000 [00:00<00:01, 1808.52it/s]warmup should be done:  30%|███       | 911/3000 [00:00<00:01, 1767.53it/s]warmup should be done:  30%|███       | 906/3000 [00:00<00:01, 1744.84it/s]warmup should be done:  37%|███▋      | 1103/3000 [00:00<00:01, 1854.46it/s]warmup should be done:  36%|███▌      | 1085/3000 [00:00<00:01, 1823.49it/s]warmup should be done:  36%|███▋      | 1093/3000 [00:00<00:01, 1781.71it/s]warmup should be done:  36%|███▋      | 1090/3000 [00:00<00:01, 1773.37it/s]warmup should be done:  42%|████▏     | 1269/3000 [00:00<00:00, 1828.06it/s]warmup should be done:  43%|████▎     | 1289/3000 [00:00<00:00, 1830.72it/s]warmup should be done:  42%|████▏     | 1273/3000 [00:00<00:00, 1787.34it/s]warmup should be done:  42%|████▏     | 1268/3000 [00:00<00:00, 1767.96it/s]warmup should be done:  49%|████▊     | 1456/3000 [00:00<00:00, 1839.17it/s]warmup should be done:  48%|████▊     | 1455/3000 [00:00<00:00, 1795.32it/s]warmup should be done:  49%|████▉     | 1473/3000 [00:00<00:00, 1792.82it/s]warmup should be done:  48%|████▊     | 1453/3000 [00:00<00:00, 1790.73it/s]warmup should be done:  55%|█████▍    | 1643/3000 [00:00<00:00, 1846.71it/s]warmup should be done:  55%|█████▍    | 1638/3000 [00:00<00:00, 1803.03it/s]warmup should be done:  55%|█████▍    | 1637/3000 [00:00<00:00, 1805.03it/s]warmup should be done:  55%|█████▌    | 1653/3000 [00:00<00:00, 1783.27it/s]warmup should be done:  61%|██████    | 1821/3000 [00:01<00:00, 1808.46it/s]warmup should be done:  61%|██████    | 1828/3000 [00:01<00:00, 1797.27it/s]warmup should be done:  61%|██████    | 1821/3000 [00:01<00:00, 1815.47it/s]warmup should be done:  61%|██████    | 1832/3000 [00:01<00:00, 1772.37it/s]warmup should be done:  67%|██████▋   | 2002/3000 [00:01<00:00, 1798.62it/s]warmup should be done:  67%|██████▋   | 2012/3000 [00:01<00:00, 1807.46it/s]warmup should be done:  67%|██████▋   | 2006/3000 [00:01<00:00, 1824.58it/s]warmup should be done:  67%|██████▋   | 2015/3000 [00:01<00:00, 1787.32it/s]warmup should be done:  73%|███████▎  | 2185/3000 [00:01<00:00, 1807.01it/s]warmup should be done:  73%|███████▎  | 2190/3000 [00:01<00:00, 1827.59it/s]warmup should be done:  73%|███████▎  | 2197/3000 [00:01<00:00, 1796.70it/s]warmup should be done:  73%|███████▎  | 2193/3000 [00:01<00:00, 1766.54it/s]warmup should be done:  79%|███████▉  | 2367/3000 [00:01<00:00, 1809.95it/s]warmup should be done:  79%|███████▉  | 2374/3000 [00:01<00:00, 1828.65it/s]warmup should be done:  79%|███████▉  | 2380/3000 [00:01<00:00, 1804.25it/s]warmup should be done:  79%|███████▉  | 2376/3000 [00:01<00:00, 1785.22it/s]warmup should be done:  85%|████████▍ | 2549/3000 [00:01<00:00, 1805.34it/s]warmup should be done:  85%|████████▌ | 2557/3000 [00:01<00:00, 1828.13it/s]warmup should be done:  85%|████████▌ | 2563/3000 [00:01<00:00, 1811.95it/s]warmup should be done:  85%|████████▌ | 2560/3000 [00:01<00:00, 1800.22it/s]warmup should be done:  91%|█████████ | 2734/3000 [00:01<00:00, 1816.31it/s]warmup should be done:  91%|█████████▏| 2740/3000 [00:01<00:00, 1823.49it/s]warmup should be done:  92%|█████████▏| 2745/3000 [00:01<00:00, 1812.57it/s]warmup should be done:  91%|█████████▏| 2744/3000 [00:01<00:00, 1811.67it/s]warmup should be done:  97%|█████████▋| 2916/3000 [00:01<00:00, 1816.40it/s]warmup should be done:  97%|█████████▋| 2923/3000 [00:01<00:00, 1823.20it/s]warmup should be done:  98%|█████████▊| 2928/3000 [00:01<00:00, 1817.10it/s]warmup should be done:  98%|█████████▊| 2928/3000 [00:01<00:00, 1817.74it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1807.93it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1805.44it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1804.96it/s]warmup should be done: 100%|██████████| 3000/3000 [00:01<00:00, 1805.31it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fdfa9386130>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fdfa9648e80>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fdfa9386070>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fdfa9386220>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2022-12-11 22:01:40.861200: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fdb7da6aea0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:01:40.861271: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:01:40.864771: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fdb81264b20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:01:40.864786: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fdb8126b870 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:01:40.864827: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:01:40.864840: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:01:40.864827: I tensorflow/compiler/xla/service/service.cc:170] XLA service 0x7fdb81267610 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-11 22:01:40.864864: I tensorflow/compiler/xla/service/service.cc:178]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-12-11 22:01:40.870065: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:01:40.872765: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:01:40.872947: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:01:40.872953: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:263] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-11 22:01:41.536902: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:01:41.636173: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:01:41.638821: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:01:41.641567: I tensorflow/core/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-11 22:01:46.985620: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:01:47.028411: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:01:47.404496: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-12-11 22:01:47.799796: I tensorflow/compiler/jit/xla_compilation_cache.cc:481] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
[HCTR][22:02:45.450][ERROR][RK0][main]: replica 3 reaches 1000, calling init pre replica
[HCTR][22:02:45.451][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][22:02:45.455][ERROR][RK0][main]: coll ps creation done
[HCTR][22:02:45.455][ERROR][RK0][main]: replica 3 waits for coll ps creation barrier
[HCTR][22:02:45.988][ERROR][RK0][tid #140581149845248]: replica 0 reaches 1000, calling init pre replica
[HCTR][22:02:45.989][ERROR][RK0][tid #140581149845248]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][22:02:45.994][ERROR][RK0][tid #140581149845248]: coll ps creation done
[HCTR][22:02:45.995][ERROR][RK0][tid #140581149845248]: replica 0 waits for coll ps creation barrier
[HCTR][22:02:46.042][ERROR][RK0][tid #140581149845248]: replica 1 reaches 1000, calling init pre replica
[HCTR][22:02:46.042][ERROR][RK0][tid #140581149845248]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][22:02:46.045][ERROR][RK0][tid #140581149845248]: coll ps creation done
[HCTR][22:02:46.045][ERROR][RK0][tid #140581149845248]: replica 1 waits for coll ps creation barrier
[HCTR][22:02:46.104][ERROR][RK0][main]: replica 2 reaches 1000, calling init pre replica
[HCTR][22:02:46.104][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][22:02:46.109][ERROR][RK0][main]: coll ps creation done
[HCTR][22:02:46.109][ERROR][RK0][main]: replica 2 waits for coll ps creation barrier
[HCTR][22:02:46.109][ERROR][RK0][tid #140581149845248]: replica 0 preparing frequency
[HCTR][22:02:47.318][ERROR][RK0][tid #140581149845248]: replica 0 preparing frequency done
[HCTR][22:02:47.351][ERROR][RK0][tid #140581149845248]: replica 0 calling init per replica
[HCTR][22:02:47.351][ERROR][RK0][main]: replica 2 calling init per replica
[HCTR][22:02:47.351][ERROR][RK0][main]: replica 3 calling init per replica
[HCTR][22:02:47.351][ERROR][RK0][tid #140581149845248]: replica 1 calling init per replica
[HCTR][22:02:47.351][ERROR][RK0][tid #140581149845248]: Calling build_v2
[HCTR][22:02:47.351][ERROR][RK0][main]: Calling build_v2
[HCTR][22:02:47.351][ERROR][RK0][main]: Calling build_v2
[HCTR][22:02:47.351][ERROR][RK0][tid #140581149845248]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:02:47.351][ERROR][RK0][tid #140581149845248]: Calling build_v2
[HCTR][22:02:47.351][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:02:47.351][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][22:02:47.351][ERROR][RK0][tid #140581149845248]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[[[2022-12-11 22:02:47.2022-12-11 22:02:473512332022-12-11 22:02:47.2022-12-11 22:02:47: .351233.E351238: 351233 : E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE E: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc 136/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc] :136:using concurrent impl MPS136] 136
] using concurrent impl MPS] using concurrent impl MPS
using concurrent impl MPS

[2022-12-11 22:02:47.352369: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196] assigning 8 to cpu[
2022-12-11 22:02:47.352393: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:196[] 2022-12-11 22:02:47assigning 8 to cpu.
352417: E [/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 22:02:47[:.2022-12-11 22:02:47196352438.] [: 352439assigning 8 to cpu2022-12-11 22:02:47E: 
. E352455/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc : :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE196: ] 212/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccassigning 8 to cpu] :[
build symm link desc with 4X Tesla V100-SXM2-16GB out of 42122022-12-11 22:02:47
] .build symm link desc with 4X Tesla V100-SXM2-16GB out of 4352514
: E[ 2022-12-11 22:02:47/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:[3525572122022-12-11 22:02:47[: ] .2022-12-11 22:02:47Ebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4352564. 
: 352563/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: : [E213/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 22:02:47 ] :./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421213352608:
] : 212remote time is 8.68421E] [
 build symm link desc with 4X Tesla V100-SXM2-16GB out of 42022-12-11 22:02:47/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
.[:3526472022-12-11 22:02:47213: .[] E3526632022-12-11 22:02:47remote time is 8.68421 : .
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE352676: [: 214/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2022-12-11 22:02:47E] :. cpu time is 30214352707/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
] : :cpu time is 30E213
 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccremote time is 8.68421:
214] cpu time is 30[
2022-12-11 22:02:47.352770: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:214] cpu time is 30
[2022-12-11 22:03:13.237751: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:118] solver created. now build & solve
[2022-12-11 22:03:13.296779: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:123] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2022-12-11 22:03:13.464868: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:127] solver solved
[2022-12-11 22:03:13.464931: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:195] 0 solved master
[2022-12-11 22:03:13.464963: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 0 solved
[2022-12-11 22:03:13.464994: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 0 initing device 0
[2022-12-11 22:03:13.466283: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:03:13.466331: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:03:13.467356: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:03:13.467915: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:03:13.487235: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:202] 2 solved
[2022-12-11 22:03:13.487305: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:205] worker 0 thread 2 initing device 2
[2022-12-11 22:03:13.487571: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4
[2022-12-11 22:03:13.487613: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:03:13.488338: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:03:13.488889: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[[2022-12-11 22:03:132022-12-11 22:03:13..489037489034: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc::202202] ] 3 solved1 solved

[[2022-12-11 22:03:132022-12-11 22:03:13..489127489128: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc::205205] ] worker 0 thread 3 initing device 3worker 0 thread 1 initing device 1

[2022-12-11 22:03:13.489393: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815[] 2022-12-11 22:03:13Building Coll Cache with ... num gpu device is 4.
489411: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1815] Building Coll Cache with ... num gpu device is 4[
2022-12-11 22:03:13.489443: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980[] 2022-12-11 22:03:13eager alloc mem 381.47 MB.
489462: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:03:13.490653: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:03:13.490694: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:03:13.491684: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:03:13.491714: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 381.47 MB
[2022-12-11 22:03:13.526448: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 22:03:13.529377: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 22:03:13.529443: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:03:13.530434: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 22:03:13.531302: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:03:13.532284: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:03:13.532332: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.89 MB
[2022-12-11 22:03:13.547568: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:03:13.548249: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:03:13.548297: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.87 GB
[2022-12-11 22:03:13.552620: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 22:03:13.554361: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 22:03:13.554404: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:03:13.555142: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 22:03:13.555511: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:03:13.556431: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:03:13.556474: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.89 MB
[2022-12-11 22:03:13.557470: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 22:03:13.559203: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 22:03:13.559253: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:03:13.559973: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 22:03:13.560359: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:03:13.561277: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:03:13.561321: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.89 MB
[2022-12-11 22:03:13.568779: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:03:13.569369: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:03:13.569411: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.87 GB
[2022-12-11 22:03:13.574622: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:03:13.575201: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:03:13.575242: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.87 GB
[2022-12-11 22:03:13.587664: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 5.00 Bytes
[2022-12-11 22:03:13.589376: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 5
[2022-12-11 22:03:13.589420: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 400000000
[2022-12-11 22:03:13.590111: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 23.27 MB
[2022-12-11 22:03:13.590451: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:03:13.591363: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:03:13.591404: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 22.89 MB
[2022-12-11 22:03:13.604401: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 25.25 KB
[2022-12-11 22:03:13.604979: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 25855
[2022-12-11 22:03:13.605020: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 2.87 GB
[[[2022-12-11 22:03:13[2022-12-11 22:03:132022-12-11 22:03:13.2022-12-11 22:03:13..859174.859174859173: 859177: : E: EE E  /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::1926:19261926] 1926] ] Device 2 init p2p of link 3] Device 1 init p2p of link 2Device 3 init p2p of link 0
Device 0 init p2p of link 1


[[[2022-12-11 22:03:132022-12-11 22:03:13[2022-12-11 22:03:13..2022-12-11 22:03:13.859420859423.859426: : 859427: EE: E  E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu::/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:19801980:1980] ] 1980] eager alloc mem 611.00 KBeager alloc mem 611.00 KB] eager alloc mem 611.00 KB

eager alloc mem 611.00 KB

[2022-12-11 22:03:13.[8602732022-12-11 22:03:13: .E860278 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc[E:2022-12-11 22:03:13 638[./hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc] 2022-12-11 22:03:13860296:eager release cuda mem 625663.: 638
860306E] :  eager release cuda mem 625663E/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc
 :/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc638:] 638eager release cuda mem 625663] 
eager release cuda mem 625663
[2022-12-11 22:03:13.864855: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 0
[2022-12-11 22:03:13[.2022-12-11 22:03:13864932.: 864945E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu :/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu1926:] [1980Device 0 init p2p of link 22022-12-11 22:03:13] 
.eager alloc mem 611.00 KB864974
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 1
[[2022-12-11 22:03:132022-12-11 22:03:13..865048865055: : EE[  2022-12-11 22:03:13/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu.::86508019261980: ] ] EDevice 1 init p2p of link 3eager alloc mem 611.00 KB 

/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:03:13.865187: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:03:13.865752: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:03:13.865866: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:03:13.865907: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:03:13.865983: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:03:13.870418: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 2 init p2p of link 1
[2022-12-11 22:03:13.870514: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:03:13.870711: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 0 init p2p of link 3
[2022-12-11 22:03:13.870792: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:03:13.870811: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1926] Device 3 init p2p of link 2
[2022-12-11 22:03:13.[8708872022-12-11 22:03:13: .E870888 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cuE: 1980/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu] :eager alloc mem 611.00 KB1926
] Device 1 init p2p of link 0
[2022-12-11 22:03:13.870991: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1980] eager alloc mem 611.00 KB
[2022-12-11 22:03:13.871288: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:03:13.871555: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:03:13.871697: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:03:13.871788: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 625663
[2022-12-11 22:03:13.884201: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 22:03:13.884269: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:638] eager release cuda mem 24399996
[2022-12-11 22:03:13.884411: E[ 2022-12-11 22:03:13/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc.:884448638: [] E2022-12-11 22:03:13eager release cuda mem 24399996 .
/hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc884491:: 638E]  eager release cuda mem 24399996/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu
:1955] Asymm Coll cache (policy: clique_part) | local 5999999 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17999997 / 100000000 nodes ( 18.00 %) | cpu 76000004 / 100000000 nodes ( 76.00 %) | 2.87 GB | 0.396886 secs 
[2022-12-11 22:03:13.884686: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 5999999 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17999997 / 100000000 nodes ( 18.00 %) | cpu 76000004 / 100000000 nodes ( 76.00 %) | 2.87 GB | 0.418364 secs 
[2022-12-11 22:03:13.885071: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 5999999 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17999997 / 100000000 nodes ( 18.00 %) | cpu 76000004 / 100000000 nodes ( 76.00 %) | 2.87 GB | 0.395635 secs 
[2022-12-11 22:03:13.885173: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:1955] Asymm Coll cache (policy: clique_part) | local 5999999 / 100000000 nodes ( 6.00 %~6.00 %) | remote 17999997 / 100000000 nodes ( 18.00 %) | cpu 76000004 / 100000000 nodes ( 76.00 %) | 2.87 GB | 0.395717 secs 
[2022-12-11 22:03:13.885594: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.57 GB
[2022-12-11 22:03:14.976634: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 9.81 GB
[2022-12-11 22:03:14.977966: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 9.81 GB
[2022-12-11 22:03:14.978725: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 9.81 GB
[2022-12-11 22:03:15.924027: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.06 GB
[2022-12-11 22:03:15.924238: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.06 GB
[2022-12-11 22:03:15.925335: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.06 GB
[2022-12-11 22:03:16.801535: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.30 GB
[2022-12-11 22:03:16.801692: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.30 GB
[2022-12-11 22:03:16.802737: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.30 GB
[2022-12-11 22:03:17.662298: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.71 GB
[2022-12-11 22:03:17.662458: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.71 GB
[2022-12-11 22:03:17.662739: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2060] before create ctx, mem is 10.71 GB
[2022-12-11 22:03:18.651501: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2066] after create ctx, mem is 10.90 GB
[2022-12-11 22:03:18.651653: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2073] after create stream, mem is 10.90 GB
[HCTR][22:03:18.794][ERROR][RK0][tid #140581149845248]: replica 1 calling init per replica done, doing barrier
[HCTR][22:03:18.794][ERROR][RK0][tid #140581149845248]: replica 0 calling init per replica done, doing barrier
[HCTR][22:03:18.794][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier
[HCTR][22:03:18.794][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier
[HCTR][22:03:18.794][ERROR][RK0][main]: replica 3 calling init per replica done, doing barrier done
[HCTR][22:03:18.794][ERROR][RK0][tid #140581149845248]: replica 0 calling init per replica done, doing barrier done
[HCTR][22:03:18.794][ERROR][RK0][tid #140581149845248]: replica 1 calling init per replica done, doing barrier done
[HCTR][22:03:18.794][ERROR][RK0][main]: replica 2 calling init per replica done, doing barrier done
[HCTR][22:03:18.794][ERROR][RK0][tid #140581149845248]: init per replica done
[HCTR][22:03:18.794][ERROR][RK0][main]: init per replica done
[HCTR][22:03:18.794][ERROR][RK0][main]: init per replica done
[HCTR][22:03:18.823][ERROR][RK0][tid #140581149845248]: init per replica done
[HCTR][22:03:18.830][ERROR][RK0][main]: 1 allocated 3276800 at 0x7fc202238400
[HCTR][22:03:18.830][ERROR][RK0][main]: 1 allocated 6553600 at 0x7fc202558400
[HCTR][22:03:18.830][ERROR][RK0][main]: 1 allocated 3276800 at 0x7fc202b98400
[HCTR][22:03:18.830][ERROR][RK0][main]: 1 allocated 6553600 at 0x7fc202eb8400
[HCTR][22:03:18.831][ERROR][RK0][main]: 3 allocated 3276800 at 0x7fc0f8238400
[HCTR][22:03:18.831][ERROR][RK0][main]: 3 allocated 6553600 at 0x7fc0f8558400
[HCTR][22:03:18.831][ERROR][RK0][main]: 3 allocated 3276800 at 0x7fc0f8b98400
[HCTR][22:03:18.831][ERROR][RK0][main]: 3 allocated 6553600 at 0x7fc0f8eb8400
[HCTR][22:03:18.831][ERROR][RK0][main]: 2 allocated 3276800 at 0x7fc12c238400
[HCTR][22:03:18.831][ERROR][RK0][main]: 2 allocated 6553600 at 0x7fc12c558400
[HCTR][22:03:18.831][ERROR][RK0][main]: 2 allocated 3276800 at 0x7fc12cb98400
[HCTR][22:03:18.831][ERROR][RK0][main]: 2 allocated 6553600 at 0x7fc12ceb8400
[HCTR][22:03:18.863][ERROR][RK0][main]: 0 allocated 3276800 at 0x7fc1d2320000
[HCTR][22:03:18.863][ERROR][RK0][main]: 0 allocated 6553600 at 0x7fc1d2640000
[HCTR][22:03:18.863][ERROR][RK0][main]: 0 allocated 3276800 at 0x7fc1d2c80000
[HCTR][22:03:18.863][ERROR][RK0][main]: 0 allocated 6553600 at 0x7fc1d2fa0000
