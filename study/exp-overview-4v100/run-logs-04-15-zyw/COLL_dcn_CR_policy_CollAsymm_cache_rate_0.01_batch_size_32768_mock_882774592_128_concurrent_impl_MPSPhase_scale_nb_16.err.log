[HCTR][17:18:26.539][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
[HCTR][17:18:26.560][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
[HCTR][17:18:26.582][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
[HCTR][17:18:26.630][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:00,  3.48it/s]warmup run: 1it [00:00,  3.46it/s]warmup run: 1it [00:00,  3.41it/s]warmup run: 1it [00:00,  3.35it/s]warmup run: 84it [00:00, 276.64it/s]warmup run: 88it [00:00, 289.49it/s]warmup run: 78it [00:00, 253.87it/s]warmup run: 89it [00:00, 286.45it/s]warmup run: 153it [00:00, 407.79it/s]warmup run: 159it [00:00, 423.72it/s]warmup run: 149it [00:00, 398.52it/s]warmup run: 160it [00:00, 419.48it/s]warmup run: 225it [00:00, 504.64it/s]warmup run: 233it [00:00, 521.16it/s]warmup run: 223it [00:00, 503.33it/s]warmup run: 230it [00:00, 504.92it/s]warmup run: 295it [00:00, 564.40it/s]warmup run: 304it [00:00, 579.25it/s]warmup run: 294it [00:00, 566.87it/s]warmup run: 304it [00:00, 574.64it/s]warmup run: 368it [00:00, 613.51it/s]warmup run: 375it [00:00, 619.12it/s]warmup run: 364it [00:00, 606.98it/s]warmup run: 377it [00:00, 621.75it/s]warmup run: 440it [00:00, 644.12it/s]warmup run: 445it [00:00, 641.47it/s]warmup run: 435it [00:00, 637.66it/s]warmup run: 451it [00:00, 657.39it/s]warmup run: 512it [00:00, 665.41it/s]warmup run: 519it [00:00, 669.72it/s]warmup run: 509it [00:00, 666.65it/s]warmup run: 530it [00:01, 697.13it/s]warmup run: 584it [00:01, 681.02it/s]warmup run: 590it [00:01, 678.30it/s]warmup run: 584it [00:01, 689.74it/s]warmup run: 610it [00:01, 727.66it/s]warmup run: 655it [00:01, 688.49it/s]warmup run: 661it [00:01, 683.56it/s]warmup run: 660it [00:01, 709.27it/s]warmup run: 686it [00:01, 732.68it/s]warmup run: 729it [00:01, 701.83it/s]warmup run: 732it [00:01, 691.07it/s]warmup run: 746it [00:01, 752.53it/s]warmup run: 762it [00:01, 729.29it/s]warmup run: 802it [00:01, 709.32it/s]warmup run: 804it [00:01, 699.00it/s]warmup run: 830it [00:01, 776.02it/s]warmup run: 837it [00:01, 730.98it/s]warmup run: 875it [00:01, 715.00it/s]warmup run: 879it [00:01, 712.15it/s]warmup run: 909it [00:01, 762.27it/s]warmup run: 912it [00:01, 734.02it/s]warmup run: 948it [00:01, 717.73it/s]warmup run: 952it [00:01, 715.35it/s]warmup run: 986it [00:01, 748.91it/s]warmup run: 987it [00:01, 733.63it/s]warmup run: 1021it [00:01, 718.36it/s]warmup run: 1024it [00:01, 715.84it/s]warmup run: 1062it [00:01, 747.20it/s]warmup run: 1061it [00:01, 732.26it/s]warmup run: 1095it [00:01, 722.91it/s]warmup run: 1096it [00:01, 712.43it/s]warmup run: 1140it [00:01, 747.34it/s]warmup run: 1138it [00:01, 742.79it/s]warmup run: 1168it [00:01, 708.58it/s]warmup run: 1168it [00:01, 696.55it/s]warmup run: 1213it [00:01, 737.39it/s]warmup run: 1215it [00:01, 716.62it/s]warmup run: 1239it [00:02, 704.73it/s]warmup run: 1238it [00:02, 691.06it/s]warmup run: 1287it [00:02, 732.42it/s]warmup run: 1288it [00:02, 709.63it/s]warmup run: 1310it [00:02, 706.20it/s]warmup run: 1308it [00:02, 686.82it/s]warmup run: 1361it [00:02, 729.02it/s]warmup run: 1360it [00:02, 704.74it/s]warmup run: 1381it [00:02, 705.19it/s]warmup run: 1384it [00:02, 707.59it/s]warmup run: 1435it [00:02, 730.10it/s]warmup run: 1438it [00:02, 724.54it/s]warmup run: 1455it [00:02, 713.84it/s]warmup run: 1465it [00:02, 735.26it/s]warmup run: 1509it [00:02, 710.61it/s]warmup run: 1511it [00:02, 707.19it/s]warmup run: 1528it [00:02, 718.24it/s]warmup run: 1541it [00:02, 740.46it/s]warmup run: 1582it [00:02, 712.92it/s]warmup run: 1582it [00:02, 673.40it/s]warmup run: 1601it [00:02, 720.46it/s]warmup run: 1624it [00:02, 766.79it/s]warmup run: 1654it [00:02, 709.34it/s]warmup run: 1653it [00:02, 683.70it/s]warmup run: 1676it [00:02, 726.65it/s]warmup run: 1701it [00:02, 763.72it/s]warmup run: 1727it [00:02, 715.20it/s]warmup run: 1722it [00:02, 679.49it/s]warmup run: 1749it [00:02, 719.55it/s]warmup run: 1778it [00:02, 756.38it/s]warmup run: 1799it [00:02, 716.60it/s]warmup run: 1791it [00:02, 674.72it/s]warmup run: 1823it [00:02, 724.44it/s]warmup run: 1857it [00:02, 764.76it/s]warmup run: 1873it [00:02, 721.47it/s]warmup run: 1859it [00:02, 672.64it/s]warmup run: 1900it [00:02, 736.96it/s]warmup run: 1934it [00:02, 764.47it/s]warmup run: 1947it [00:02, 724.72it/s]warmup run: 1927it [00:02, 664.36it/s]warmup run: 1974it [00:03, 736.28it/s]warmup run: 2012it [00:03, 767.48it/s]warmup run: 2021it [00:03, 726.29it/s]warmup run: 1994it [00:03, 664.15it/s]warmup run: 2048it [00:03, 736.65it/s]warmup run: 2089it [00:03, 756.86it/s]warmup run: 2095it [00:03, 727.77it/s]warmup run: 2061it [00:03, 662.42it/s]warmup run: 2122it [00:03, 733.80it/s]warmup run: 2165it [00:03, 740.19it/s]warmup run: 2168it [00:03, 724.44it/s]warmup run: 2128it [00:03, 655.16it/s]warmup run: 2196it [00:03, 734.81it/s]warmup run: 2240it [00:03, 741.19it/s]warmup run: 2241it [00:03, 721.89it/s]warmup run: 2194it [00:03, 656.13it/s]warmup run: 2270it [00:03, 733.06it/s]warmup run: 2316it [00:03, 745.42it/s]warmup run: 2314it [00:03, 713.72it/s]warmup run: 2261it [00:03, 658.78it/s]warmup run: 2344it [00:03, 720.16it/s]warmup run: 2391it [00:03, 743.24it/s]warmup run: 2386it [00:03, 708.30it/s]warmup run: 2329it [00:03, 664.17it/s]warmup run: 2417it [00:03, 717.95it/s]warmup run: 2466it [00:03, 738.93it/s]warmup run: 2460it [00:03, 716.69it/s]warmup run: 2397it [00:03, 667.92it/s]warmup run: 2489it [00:03, 717.55it/s]warmup run: 2543it [00:03, 747.40it/s]warmup run: 2534it [00:03, 722.07it/s]warmup run: 2466it [00:03, 673.56it/s]warmup run: 2564it [00:03, 726.28it/s]warmup run: 2621it [00:03, 754.16it/s]warmup run: 2608it [00:03, 725.15it/s]warmup run: 2534it [00:03, 672.83it/s]warmup run: 2637it [00:03, 708.84it/s]warmup run: 2699it [00:03, 759.64it/s]warmup run: 2681it [00:03, 718.75it/s]warmup run: 2602it [00:03, 672.36it/s]warmup run: 2709it [00:04, 711.09it/s]warmup run: 2779it [00:04, 770.77it/s]warmup run: 2754it [00:04, 719.81it/s]warmup run: 2671it [00:04, 675.12it/s]warmup run: 2782it [00:04, 715.53it/s]warmup run: 2859it [00:04, 778.83it/s]warmup run: 2826it [00:04, 698.01it/s]warmup run: 2739it [00:04, 674.99it/s]warmup run: 2856it [00:04, 722.43it/s]warmup run: 2938it [00:04, 780.37it/s]warmup run: 2900it [00:04, 710.21it/s]warmup run: 2808it [00:04, 679.18it/s]warmup run: 2929it [00:04, 716.46it/s]warmup run: 3017it [00:04, 777.84it/s]warmup run: 2972it [00:04, 703.23it/s]warmup run: 2876it [00:04, 673.54it/s]warmup run: 3005it [00:04, 727.83it/s]warmup run: 3097it [00:04, 782.18it/s]warmup run: 3043it [00:04, 704.36it/s]warmup run: 2944it [00:04, 666.64it/s]warmup run: 3078it [00:04, 709.65it/s]warmup run: 3176it [00:04, 781.37it/s]warmup run: 3114it [00:04, 696.97it/s]warmup run: 3011it [00:04, 663.39it/s]warmup run: 3154it [00:04, 724.18it/s]warmup run: 3255it [00:04, 774.85it/s]warmup run: 3185it [00:04, 699.04it/s]warmup run: 3078it [00:04, 661.99it/s]warmup run: 3227it [00:04, 713.57it/s]warmup run: 3333it [00:04, 766.76it/s]warmup run: 3258it [00:04, 707.33it/s]warmup run: 3146it [00:04, 666.61it/s]warmup run: 3411it [00:04, 768.76it/s]warmup run: 3299it [00:04, 695.35it/s]warmup run: 3331it [00:04, 712.68it/s]warmup run: 3219it [00:04, 683.27it/s]warmup run: 3491it [00:04, 775.31it/s]warmup run: 3369it [00:04, 687.65it/s]warmup run: 3406it [00:04, 720.67it/s]warmup run: 3288it [00:05, 684.18it/s]warmup run: 3569it [00:05, 763.88it/s]warmup run: 3438it [00:05, 688.20it/s]warmup run: 3482it [00:05, 731.76it/s]warmup run: 3357it [00:05, 680.72it/s]warmup run: 3513it [00:05, 705.66it/s]warmup run: 3646it [00:05, 752.41it/s]warmup run: 3558it [00:05, 737.09it/s]warmup run: 3426it [00:05, 679.53it/s]warmup run: 3587it [00:05, 713.62it/s]warmup run: 3722it [00:05, 736.22it/s]warmup run: 3635it [00:05, 745.25it/s]warmup run: 3494it [00:05, 674.73it/s]warmup run: 3661it [00:05, 719.65it/s]warmup run: 3796it [00:05, 726.45it/s]warmup run: 3710it [00:05, 738.42it/s]warmup run: 3566it [00:05, 686.72it/s]warmup run: 3734it [00:05, 722.03it/s]warmup run: 3869it [00:05, 724.11it/s]warmup run: 3784it [00:05, 731.27it/s]warmup run: 3635it [00:05, 685.25it/s]warmup run: 3807it [00:05, 715.95it/s]warmup run: 3942it [00:05, 720.08it/s]warmup run: 3858it [00:05, 730.73it/s]warmup run: 3708it [00:05, 696.51it/s]warmup run: 4000it [00:05, 704.35it/s]warmup run: 3880it [00:05, 718.35it/s]warmup run: 3932it [00:05, 731.35it/s]warmup run: 3778it [00:05, 684.75it/s]warmup run: 3952it [00:05, 718.75it/s]warmup run: 4000it [00:05, 688.78it/s]warmup run: 3847it [00:05, 663.29it/s]warmup run: 4000it [00:05, 682.70it/s]warmup run: 3916it [00:05, 668.78it/s]warmup run: 3985it [00:06, 674.41it/s]warmup run: 4000it [00:06, 658.41it/s]
warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   4%|▍         | 159/4000 [00:00<00:02, 1589.79it/s]warmup should be done:   4%|▍         | 180/4000 [00:00<00:02, 1794.19it/s]warmup should be done:   4%|▍         | 176/4000 [00:00<00:02, 1751.77it/s]warmup should be done:   4%|▍         | 173/4000 [00:00<00:02, 1721.03it/s]warmup should be done:   8%|▊         | 336/4000 [00:00<00:02, 1695.12it/s]warmup should be done:   9%|▉         | 358/4000 [00:00<00:02, 1791.00it/s]warmup should be done:   9%|▉         | 353/4000 [00:00<00:02, 1766.69it/s]warmup should be done:   9%|▉         | 362/4000 [00:00<00:02, 1804.89it/s]warmup should be done:  13%|█▎        | 511/4000 [00:00<00:02, 1717.68it/s]warmup should be done:  13%|█▎        | 539/4000 [00:00<00:01, 1799.37it/s]warmup should be done:  13%|█▎        | 532/4000 [00:00<00:01, 1775.73it/s]warmup should be done:  14%|█▎        | 543/4000 [00:00<00:01, 1797.48it/s]warmup should be done:  17%|█▋        | 686/4000 [00:00<00:01, 1729.01it/s]warmup should be done:  18%|█▊        | 721/4000 [00:00<00:01, 1806.57it/s]warmup should be done:  18%|█▊        | 723/4000 [00:00<00:01, 1797.70it/s]warmup should be done:  18%|█▊        | 710/4000 [00:00<00:01, 1739.53it/s]warmup should be done:  22%|██▏       | 861/4000 [00:00<00:01, 1736.17it/s]warmup should be done:  23%|██▎       | 903/4000 [00:00<00:01, 1808.58it/s]warmup should be done:  23%|██▎       | 904/4000 [00:00<00:01, 1800.02it/s]warmup should be done:  22%|██▏       | 892/4000 [00:00<00:01, 1767.93it/s]warmup should be done:  26%|██▌       | 1036/4000 [00:00<00:01, 1739.99it/s]warmup should be done:  27%|██▋       | 1085/4000 [00:00<00:01, 1812.17it/s]warmup should be done:  27%|██▋       | 1085/4000 [00:00<00:01, 1797.99it/s]warmup should be done:  27%|██▋       | 1075/4000 [00:00<00:01, 1787.13it/s]warmup should be done:  30%|███       | 1211/4000 [00:00<00:01, 1742.42it/s]warmup should be done:  32%|███▏      | 1267/4000 [00:00<00:01, 1814.28it/s]warmup should be done:  32%|███▏      | 1265/4000 [00:00<00:01, 1795.86it/s]warmup should be done:  31%|███▏      | 1257/4000 [00:00<00:01, 1796.92it/s]warmup should be done:  35%|███▍      | 1386/4000 [00:00<00:01, 1744.40it/s]warmup should be done:  36%|███▌      | 1449/4000 [00:00<00:01, 1813.51it/s]warmup should be done:  36%|███▌      | 1447/4000 [00:00<00:01, 1801.38it/s]warmup should be done:  36%|███▌      | 1440/4000 [00:00<00:01, 1806.21it/s]warmup should be done:  39%|███▉      | 1562/4000 [00:00<00:01, 1746.34it/s]warmup should be done:  41%|████      | 1633/4000 [00:00<00:01, 1819.98it/s]warmup should be done:  41%|████      | 1628/4000 [00:00<00:01, 1803.00it/s]warmup should be done:  41%|████      | 1621/4000 [00:00<00:01, 1775.95it/s]warmup should be done:  43%|████▎     | 1737/4000 [00:01<00:01, 1747.01it/s]warmup should be done:  45%|████▌     | 1815/4000 [00:01<00:01, 1819.57it/s]warmup should be done:  45%|████▌     | 1809/4000 [00:01<00:01, 1802.17it/s]warmup should be done:  45%|████▍     | 1799/4000 [00:01<00:01, 1776.04it/s]warmup should be done:  48%|████▊     | 1912/4000 [00:01<00:01, 1745.53it/s]warmup should be done:  50%|████▉     | 1999/4000 [00:01<00:01, 1823.55it/s]warmup should be done:  50%|████▉     | 1990/4000 [00:01<00:01, 1804.23it/s]warmup should be done:  49%|████▉     | 1978/4000 [00:01<00:01, 1778.95it/s]warmup should be done:  52%|█████▏    | 2087/4000 [00:01<00:01, 1743.92it/s]warmup should be done:  55%|█████▍    | 2183/4000 [00:01<00:00, 1826.39it/s]warmup should be done:  54%|█████▍    | 2171/4000 [00:01<00:01, 1804.81it/s]warmup should be done:  54%|█████▍    | 2156/4000 [00:01<00:01, 1777.69it/s]warmup should be done:  59%|█████▉    | 2366/4000 [00:01<00:00, 1826.73it/s]warmup should be done:  59%|█████▉    | 2352/4000 [00:01<00:00, 1806.34it/s]warmup should be done:  57%|█████▋    | 2262/4000 [00:01<00:01, 1704.67it/s]warmup should be done:  58%|█████▊    | 2335/4000 [00:01<00:00, 1779.33it/s]warmup should be done:  64%|██████▎   | 2549/4000 [00:01<00:00, 1823.07it/s]warmup should be done:  63%|██████▎   | 2533/4000 [00:01<00:00, 1793.88it/s]warmup should be done:  61%|██████    | 2437/4000 [00:01<00:00, 1716.46it/s]warmup should be done:  63%|██████▎   | 2513/4000 [00:01<00:00, 1760.33it/s]warmup should be done:  68%|██████▊   | 2713/4000 [00:01<00:00, 1787.72it/s]warmup should be done:  65%|██████▌   | 2616/4000 [00:01<00:00, 1737.08it/s]warmup should be done:  68%|██████▊   | 2732/4000 [00:01<00:00, 1784.88it/s]warmup should be done:  67%|██████▋   | 2695/4000 [00:01<00:00, 1777.01it/s]warmup should be done:  72%|███████▏  | 2895/4000 [00:01<00:00, 1794.69it/s]warmup should be done:  70%|██████▉   | 2794/4000 [00:01<00:00, 1748.12it/s]warmup should be done:  73%|███████▎  | 2914/4000 [00:01<00:00, 1793.05it/s]warmup should be done:  72%|███████▏  | 2878/4000 [00:01<00:00, 1790.95it/s]warmup should be done:  77%|███████▋  | 3077/4000 [00:01<00:00, 1799.93it/s]warmup should be done:  74%|███████▍  | 2971/4000 [00:01<00:00, 1753.14it/s]warmup should be done:  77%|███████▋  | 3096/4000 [00:01<00:00, 1799.16it/s]warmup should be done:  76%|███████▋  | 3060/4000 [00:01<00:00, 1798.58it/s]warmup should be done:  81%|████████▏ | 3258/4000 [00:01<00:00, 1802.56it/s]warmup should be done:  79%|███████▊  | 3147/4000 [00:01<00:00, 1752.31it/s]warmup should be done:  82%|████████▏ | 3277/4000 [00:01<00:00, 1799.66it/s]warmup should be done:  81%|████████  | 3241/4000 [00:01<00:00, 1800.30it/s]warmup should be done:  86%|████████▌ | 3441/4000 [00:01<00:00, 1808.77it/s]warmup should be done:  86%|████████▋ | 3460/4000 [00:01<00:00, 1807.91it/s]warmup should be done:  83%|████████▎ | 3323/4000 [00:01<00:00, 1729.85it/s]warmup should be done:  86%|████████▌ | 3424/4000 [00:01<00:00, 1808.29it/s]warmup should be done:  91%|█████████ | 3624/4000 [00:02<00:00, 1813.17it/s]warmup should be done:  91%|█████████ | 3643/4000 [00:02<00:00, 1812.12it/s]warmup should be done:  88%|████████▊ | 3504/4000 [00:02<00:00, 1750.77it/s]warmup should be done:  90%|█████████ | 3606/4000 [00:02<00:00, 1809.90it/s]warmup should be done:  95%|█████████▌| 3806/4000 [00:02<00:00, 1813.48it/s]warmup should be done:  96%|█████████▌| 3825/4000 [00:02<00:00, 1810.91it/s]warmup should be done:  92%|█████████▏| 3680/4000 [00:02<00:00, 1746.08it/s]warmup should be done:  95%|█████████▍| 3789/4000 [00:02<00:00, 1814.81it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1808.99it/s]warmup should be done: 100%|█████████▉| 3989/4000 [00:02<00:00, 1815.96it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1803.57it/s]warmup should be done:  96%|█████████▋| 3858/4000 [00:02<00:00, 1755.86it/s]warmup should be done:  99%|█████████▉| 3972/4000 [00:02<00:00, 1818.03it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1789.78it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1740.24it/s]
warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   5%|▍         | 184/4000 [00:00<00:02, 1834.45it/s]warmup should be done:   4%|▍         | 174/4000 [00:00<00:02, 1735.90it/s]warmup should be done:   4%|▍         | 178/4000 [00:00<00:02, 1772.23it/s]warmup should be done:   4%|▍         | 177/4000 [00:00<00:02, 1762.77it/s]warmup should be done:   9%|▉         | 359/4000 [00:00<00:02, 1799.32it/s]warmup should be done:   9%|▉         | 366/4000 [00:00<00:01, 1835.29it/s]warmup should be done:   9%|▉         | 356/4000 [00:00<00:02, 1762.07it/s]warmup should be done:   9%|▉         | 368/4000 [00:00<00:02, 1810.30it/s]warmup should be done:  14%|█▎        | 545/4000 [00:00<00:01, 1824.23it/s]warmup should be done:  14%|█▍        | 555/4000 [00:00<00:01, 1857.31it/s]warmup should be done:  14%|█▎        | 543/4000 [00:00<00:01, 1810.21it/s]warmup should be done:  14%|█▍        | 550/4000 [00:00<00:01, 1812.74it/s]warmup should be done:  18%|█▊        | 729/4000 [00:00<00:01, 1829.42it/s]warmup should be done:  18%|█▊        | 733/4000 [00:00<00:01, 1817.35it/s]warmup should be done:  18%|█▊        | 728/4000 [00:00<00:01, 1798.15it/s]warmup should be done:  19%|█▊        | 741/4000 [00:00<00:01, 1644.79it/s]warmup should be done:  23%|██▎       | 914/4000 [00:00<00:01, 1836.01it/s]warmup should be done:  23%|██▎       | 908/4000 [00:00<00:01, 1796.07it/s]warmup should be done:  23%|██▎       | 915/4000 [00:00<00:01, 1776.88it/s]warmup should be done:  23%|██▎       | 929/4000 [00:00<00:01, 1722.25it/s]warmup should be done:  28%|██▊       | 1101/4000 [00:00<00:01, 1845.42it/s]warmup should be done:  27%|██▋       | 1088/4000 [00:00<00:01, 1773.27it/s]warmup should be done:  27%|██▋       | 1095/4000 [00:00<00:01, 1781.62it/s]warmup should be done:  28%|██▊       | 1115/4000 [00:00<00:01, 1764.12it/s]warmup should be done:  32%|███▏      | 1286/4000 [00:00<00:01, 1825.41it/s]warmup should be done:  32%|███▏      | 1272/4000 [00:00<00:01, 1794.59it/s]warmup should be done:  32%|███▏      | 1274/4000 [00:00<00:01, 1742.10it/s]warmup should be done:  33%|███▎      | 1303/4000 [00:00<00:01, 1798.79it/s]warmup should be done:  37%|███▋      | 1470/4000 [00:00<00:01, 1828.45it/s]warmup should be done:  36%|███▋      | 1459/4000 [00:00<00:01, 1815.74it/s]warmup should be done:  36%|███▋      | 1456/4000 [00:00<00:01, 1763.38it/s]warmup should be done:  37%|███▋      | 1490/4000 [00:00<00:01, 1818.42it/s]warmup should be done:  41%|████▏     | 1657/4000 [00:00<00:01, 1839.11it/s]warmup should be done:  41%|████      | 1646/4000 [00:00<00:01, 1830.78it/s]warmup should be done:  41%|████      | 1641/4000 [00:00<00:01, 1788.57it/s]warmup should be done:  42%|████▏     | 1678/4000 [00:00<00:01, 1835.93it/s]warmup should be done:  46%|████▌     | 1841/4000 [00:01<00:01, 1832.05it/s]warmup should be done:  46%|████▌     | 1830/4000 [00:01<00:01, 1833.14it/s]warmup should be done:  46%|████▌     | 1827/4000 [00:01<00:01, 1807.66it/s]warmup should be done:  47%|████▋     | 1866/4000 [00:01<00:01, 1848.84it/s]warmup should be done:  51%|█████     | 2026/4000 [00:01<00:01, 1835.70it/s]warmup should be done:  50%|█████     | 2015/4000 [00:01<00:01, 1836.64it/s]warmup should be done:  50%|█████     | 2012/4000 [00:01<00:01, 1818.51it/s]warmup should be done:  51%|█████▏    | 2054/4000 [00:01<00:01, 1857.45it/s]warmup should be done:  55%|█████▌    | 2210/4000 [00:01<00:00, 1836.42it/s]warmup should be done:  55%|█████▌    | 2200/4000 [00:01<00:00, 1839.31it/s]warmup should be done:  55%|█████▍    | 2197/4000 [00:01<00:00, 1827.56it/s]warmup should be done:  56%|█████▌    | 2241/4000 [00:01<00:00, 1762.58it/s]warmup should be done:  60%|█████▉    | 2394/4000 [00:01<00:00, 1835.71it/s]warmup should be done:  60%|█████▉    | 2385/4000 [00:01<00:00, 1841.69it/s]warmup should be done:  60%|█████▉    | 2382/4000 [00:01<00:00, 1832.19it/s]warmup should be done:  61%|██████    | 2427/4000 [00:01<00:00, 1789.08it/s]warmup should be done:  64%|██████▍   | 2571/4000 [00:01<00:00, 1846.17it/s]warmup should be done:  64%|██████▍   | 2578/4000 [00:01<00:00, 1821.89it/s]warmup should be done:  64%|██████▍   | 2568/4000 [00:01<00:00, 1838.82it/s]warmup should be done:  65%|██████▌   | 2607/4000 [00:01<00:00, 1789.28it/s]warmup should be done:  69%|██████▉   | 2763/4000 [00:01<00:00, 1827.75it/s]warmup should be done:  69%|██████▉   | 2756/4000 [00:01<00:00, 1821.95it/s]warmup should be done:  69%|██████▉   | 2754/4000 [00:01<00:00, 1842.81it/s]warmup should be done:  70%|██████▉   | 2793/4000 [00:01<00:00, 1808.76it/s]warmup should be done:  74%|███████▎  | 2948/4000 [00:01<00:00, 1833.00it/s]warmup should be done:  74%|███████▎  | 2942/4000 [00:01<00:00, 1830.75it/s]warmup should be done:  73%|███████▎  | 2939/4000 [00:01<00:00, 1812.00it/s]warmup should be done:  74%|███████▍  | 2978/4000 [00:01<00:00, 1820.35it/s]warmup should be done:  78%|███████▊  | 3132/4000 [00:01<00:00, 1833.59it/s]warmup should be done:  78%|███████▊  | 3126/4000 [00:01<00:00, 1833.33it/s]warmup should be done:  78%|███████▊  | 3122/4000 [00:01<00:00, 1815.84it/s]warmup should be done:  79%|███████▉  | 3164/4000 [00:01<00:00, 1831.17it/s]warmup should be done:  83%|████████▎ | 3316/4000 [00:01<00:00, 1834.26it/s]warmup should be done:  83%|████████▎ | 3312/4000 [00:01<00:00, 1839.27it/s]warmup should be done:  83%|████████▎ | 3305/4000 [00:01<00:00, 1818.71it/s]warmup should be done:  84%|████████▍ | 3350/4000 [00:01<00:00, 1838.10it/s]warmup should be done:  88%|████████▊ | 3500/4000 [00:01<00:00, 1835.44it/s]warmup should be done:  87%|████████▋ | 3498/4000 [00:01<00:00, 1842.93it/s]warmup should be done:  87%|████████▋ | 3487/4000 [00:01<00:00, 1795.29it/s]warmup should be done:  88%|████████▊ | 3535/4000 [00:01<00:00, 1805.38it/s]warmup should be done:  92%|█████████▏| 3685/4000 [00:02<00:00, 1839.23it/s]warmup should be done:  92%|█████████▏| 3684/4000 [00:02<00:00, 1846.71it/s]warmup should be done:  92%|█████████▏| 3672/4000 [00:02<00:00, 1808.78it/s]warmup should be done:  93%|█████████▎| 3723/4000 [00:02<00:00, 1825.93it/s]warmup should be done:  97%|█████████▋| 3870/4000 [00:02<00:00, 1840.24it/s]warmup should be done:  97%|█████████▋| 3870/4000 [00:02<00:00, 1850.10it/s]warmup should be done:  96%|█████████▋| 3856/4000 [00:02<00:00, 1816.38it/s]warmup should be done:  98%|█████████▊| 3911/4000 [00:02<00:00, 1841.83it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1831.38it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1822.93it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1809.53it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1809.27it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fbe2c7f98b0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fbe2c7f9970>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fbe2c7f9b20>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fbe2cc46c10>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[HCTR][17:19:04.508][ERROR][RK0][tid #140441060108032]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][17:19:04.513][ERROR][RK0][tid #140441060108032]: coll ps creation done
[HCTR][17:19:04.549][ERROR][RK0][tid #140441622124288]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][17:19:04.554][ERROR][RK0][tid #140441622124288]: coll ps creation done
[HCTR][17:19:04.585][ERROR][RK0][tid #140441555015424]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][17:19:04.591][ERROR][RK0][tid #140441555015424]: coll ps creation done
[HCTR][17:19:04.626][ERROR][RK0][tid #140441043322624]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][17:19:04.632][ERROR][RK0][tid #140441043322624]: coll ps creation done
[HCTR][17:19:04.632][ERROR][RK0][tid #140441043322624]: replica 0 preparing frequency
[2023-04-14 17:19:04.632212: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506420 into 0
[2023-04-14 17:19:04.634909: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16096740
[2023-04-14 17:19:04.635115: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 507207 into 506420
[2023-04-14 17:19:04.637788: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18562884
[2023-04-14 17:19:04.637974: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505205 into 1013627
[2023-04-14 17:19:04.640638: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29302162
[2023-04-14 17:19:04.640921: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506136 into 1518832
[2023-04-14 17:19:04.643598: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26139476
[2023-04-14 17:19:04.643888: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505398 into 2024968
[2023-04-14 17:19:04.646536: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19260545
[2023-04-14 17:19:04.646804: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504794 into 2530366
[2023-04-14 17:19:04.649444: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30890472
[2023-04-14 17:19:04.649622: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505406 into 3035160
[2023-04-14 17:19:04.652231: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19318898
[2023-04-14 17:19:04.652497: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504793 into 3540566
[2023-04-14 17:19:04.655139: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16628166
[2023-04-14 17:19:04.655414: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505572 into 4045359
[2023-04-14 17:19:04.658001: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16550811
[2023-04-14 17:19:04.658174: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504900 into 4550931
[2023-04-14 17:19:04.660795: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20241846
[HCTR][17:19:04.661][ERROR][RK0][tid #140441622124288]: replica 1 preparing frequency
[2023-04-14 17:19:04.661124: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505919 into 5055831
[2023-04-14 17:19:04.663799: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16101633
[2023-04-14 17:19:04.664016: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506593 into 5561750
[2023-04-14 17:19:04.666629: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18552515
[2023-04-14 17:19:04.666797: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505327 into 6068343
[2023-04-14 17:19:04.669412: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29301332
[2023-04-14 17:19:04.669679: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506187 into 6573670
[2023-04-14 17:19:04.672295: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26136012
[2023-04-14 17:19:04.672468: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505901 into 7079857
[2023-04-14 17:19:04.675090: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19265129
[2023-04-14 17:19:04.675262: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505571 into 7585758
[2023-04-14 17:19:04.677846: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30883844
[2023-04-14 17:19:04.678018: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505720 into 8091329
[2023-04-14 17:19:04.680652: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19315166
[2023-04-14 17:19:04.680908: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504944 into 8597049
[2023-04-14 17:19:04.683552: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16632782
[2023-04-14 17:19:04.683815: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504820 into 9101993
[2023-04-14 17:19:04.686395: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16553594
[2023-04-14 17:19:04.686575: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505016 into 9606813
[2023-04-14 17:19:04.689189: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20249993
[HCTR][17:19:04.689][ERROR][RK0][tid #140441060108032]: replica 2 preparing frequency
[2023-04-14 17:19:04.689500: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506873 into 10111829
[2023-04-14 17:19:04.692091: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16100404
[2023-04-14 17:19:04.692263: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506443 into 10618702
[2023-04-14 17:19:04.694839: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18553445
[2023-04-14 17:19:04.695010: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504576 into 11125145
[2023-04-14 17:19:04.697585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29306042
[2023-04-14 17:19:04.697754: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506049 into 11629721
[2023-04-14 17:19:04.700374: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26132673
[2023-04-14 17:19:04.700639: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504567 into 12135770
[2023-04-14 17:19:04.703216: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19264202
[2023-04-14 17:19:04.703385: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505275 into 12640337
[2023-04-14 17:19:04.706005: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30892607
[2023-04-14 17:19:04.706273: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506474 into 13145612
[2023-04-14 17:19:04.708859: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19315767
[2023-04-14 17:19:04.709033: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505642 into 13652086
[2023-04-14 17:19:04.711601: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16629343
[2023-04-14 17:19:04.711771: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505348 into 14157728
[2023-04-14 17:19:04.714331: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16548017
[2023-04-14 17:19:04.714500: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505835 into 14663076
[2023-04-14 17:19:04.717066: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20249500
[HCTR][17:19:04.717][ERROR][RK0][tid #140441555015424]: replica 3 preparing frequency
[2023-04-14 17:19:04.717291: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506615 into 15168911
[2023-04-14 17:19:04.719905: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16095683
[2023-04-14 17:19:04.720067: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505824 into 15675526
[2023-04-14 17:19:04.722668: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18553842
[2023-04-14 17:19:04.722834: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 503719 into 16181350
[2023-04-14 17:19:04.725450: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29304109
[2023-04-14 17:19:04.725620: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505976 into 16685069
[2023-04-14 17:19:04.728282: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26128937
[2023-04-14 17:19:04.728454: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505282 into 17191045
[2023-04-14 17:19:04.731091: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19265045
[2023-04-14 17:19:04.731359: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505152 into 17696327
[2023-04-14 17:19:04.733945: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30890648
[2023-04-14 17:19:04.734112: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506736 into 18201479
[2023-04-14 17:19:04.736687: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19314006
[2023-04-14 17:19:04.736852: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505550 into 18708215
[2023-04-14 17:19:04.739462: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16637527
[2023-04-14 17:19:04.739626: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505162 into 19213765
[2023-04-14 17:19:04.742217: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16553626
[2023-04-14 17:19:04.742379: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505236 into 19718927
[2023-04-14 17:19:04.744971: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20248577
[2023-04-14 17:19:04.745150: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:266] freq recorder global combining
[2023-04-14 17:19:06.400510: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:269] freq recorder global combine from 20224163 to 14453656
[2023-04-14 17:19:06.561681: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:286] top 5 freq is 28347903,16740847,16373799,15339422,13482819
[HCTR][17:19:06.580][ERROR][RK0][tid #140441043322624]: Calling build_v2
[HCTR][17:19:06.580][ERROR][RK0][tid #140441043322624]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][17:19:06.580][ERROR][RK0][tid #140441555015424]: Calling build_v2
[HCTR][17:19:06.580][ERROR][RK0][tid #140441060108032]: Calling build_v2
[2023-04-14 17:19:06.[HCTR][17:19:06.580][ERROR][RK0][tid #140441555015424]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
580620: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:141[HCTR][17:19:06.580][ERROR][RK0][tid #140441060108032]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
] using concurrent impl MPSPhase
[HCTR][17:19:06.580][ERROR][RK0][tid #140441622124288]: Calling build_v2
[2023-04-14 17:19:06.580683: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:409] before scale, dtype is 0, dim is 128[HCTR][17:19:06.580][ERROR][RK0][tid #140441622124288]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1

[2023-04-14 17:19:06.580716: E[ 2023-04-14 17:19:06/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc.:580712415: ] Eafter scale, dtype is 7, new dim is 32 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:141] using concurrent impl MPSPhase[
2023-04-14 17:19:06.580745: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc[:[2023-04-14 17:19:061412023-04-14 17:19:06.] .580784using concurrent impl MPSPhase580780: 
: EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc[/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:2023-04-14 17:19:06:409.141] 580846] before scale, dtype is 0, dim is 128: using concurrent impl MPSPhase
E
 [/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc2023-04-14 17:19:06:[.4092023-04-14 17:19:06580906] .: before scale, dtype is 0, dim is 128580917E
:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc[ :2023-04-14 17:19:06/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc415.:] 580973409after scale, dtype is 7, new dim is 32: ] 
[Ebefore scale, dtype is 0, dim is 1282023-04-14 17:19:06 
./hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc[581015:2023-04-14 17:19:06: 415.E] 581066 after scale, dtype is 7, new dim is 32: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
E: 207/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :assigning 8 to cpu415
] after scale, dtype is 7, new dim is 32
[2023-04-14 17:19:06.581170: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:224] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2023-04-14 17:19:06.581216: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:225] remote time is 9.21053
[2023-04-14 17:19:06.581247: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:226] cpu time is 31.8182
[2023-04-14 17:19:06.581289: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:425] registering cpu data with 16.00 GB
[2023-04-14 17:19:06.581760: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:207] assigning 8 to cpu
[2023-04-14 17:19:06.581819: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:224] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2023-04-14 17:19:06.581870: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:225] remote time is 9.21053
[2023-04-14 17:19:06.581899: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:226] cpu time is 31.8182
[2023-04-14 17:19:06.581939: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:425] registering cpu data with 16.00 GB[
2023-04-14 17:19:06.581958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2072023-04-14 17:19:06] .assigning 8 to cpu581983
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:207] assigning 8 to cpu
[2023-04-14 17:19:06.582052[: 2023-04-14 17:19:06E. 582060/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc: :E224 ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4:
224] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2023-04-14 17:19:06[.2023-04-14 17:19:06582144.: 582150E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc225:] 225remote time is 9.21053] 
remote time is 9.21053
[2023-04-14 17:19:06[.2023-04-14 17:19:06582233.: 582238E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc226:] 226cpu time is 31.8182] 
cpu time is 31.8182
[2023-04-14 17:19:06[.2023-04-14 17:19:06582329.: 582333E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc425:] 425registering cpu data with 16.00 GB] 
registering cpu data with 16.00 GB
[2023-04-14 17:19:14.668515: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-14 17:19:14.682800: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-14 17:19:14.698085: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-14 17:19:14.698176: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:174] creating solver
[2023-04-14 17:19:14.698256: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:214] solver created. now build & solve
[2023-04-14 17:19:14.705042: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-14 17:19:15. 75320: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 3.29 GB
[2023-04-14 17:19:15. 75450: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:309] reconfigured max freq to be 2.83479e+07
[2023-04-14 17:19:15. 75483: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:311] reconfigured num slot to be 95
[2023-04-14 17:19:15. 75513: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:318] counting slots...
[2023-04-14 17:19:18.152342: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:367] Final num slot is 108
[2023-04-14 17:19:18.152495: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:371] preparing block granularity...
[2023-04-14 17:19:18.152540: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 0 has 1 nodes, max_size set to 1, #slice=4
[2023-04-14 17:19:18.152577: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 2 has 1 nodes, max_size set to 1, #slice=4
[2023-04-14 17:19:18.152612: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 3 has 2 nodes, max_size set to 1, #slice=4
[2023-04-14 17:19:18.152647: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 4 has 10 nodes, max_size set to 3, #slice=4
[2023-04-14 17:19:18.152683: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 5 has 1 nodes, max_size set to 1, #slice=4
[2023-04-14 17:19:18.152719: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 6 has 1 nodes, max_size set to 1, #slice=4
[2023-04-14 17:19:18.152754: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 7 has 10 nodes, max_size set to 3, #slice=4
[2023-04-14 17:19:18.152790: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 8 has 2 nodes, max_size set to 1, #slice=4
[2023-04-14 17:19:18.152826: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 9 has 6 nodes, max_size set to 2, #slice=4
[2023-04-14 17:19:18.152862: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 10 has 7 nodes, max_size set to 2, #slice=4
[2023-04-14 17:19:18.152897: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 11 has 3 nodes, max_size set to 1, #slice=4
[2023-04-14 17:19:18.152933: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 12 has 7 nodes, max_size set to 2, #slice=4
[2023-04-14 17:19:18.152968: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 13 has 5 nodes, max_size set to 2, #slice=4
[2023-04-14 17:19:18.153004: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 14 has 11 nodes, max_size set to 3, #slice=4
[2023-04-14 17:19:18.153038: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 15 has 11 nodes, max_size set to 3, #slice=4
[2023-04-14 17:19:18.153073: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 16 has 3 nodes, max_size set to 1, #slice=4
[2023-04-14 17:19:18.153109: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 17 has 15 nodes, max_size set to 4, #slice=4
[2023-04-14 17:19:18.153143: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 18 has 14 nodes, max_size set to 4, #slice=4
[2023-04-14 17:19:18.153177: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 19 has 7 nodes, max_size set to 2, #slice=4
[2023-04-14 17:19:18.153213: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 20 has 19 nodes, max_size set to 5, #slice=4
[2023-04-14 17:19:18.153262: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 21 has 10 nodes, max_size set to 3, #slice=4
[2023-04-14 17:19:18.153298: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 22 has 21 nodes, max_size set to 6, #slice=4
[2023-04-14 17:19:18.153335: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 23 has 25 nodes, max_size set to 7, #slice=4
[2023-04-14 17:19:18.153370: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 24 has 29 nodes, max_size set to 8, #slice=4
[2023-04-14 17:19:18.153406: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 25 has 36 nodes, max_size set to 9, #slice=4
[2023-04-14 17:19:18.153442: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 26 has 51 nodes, max_size set to 13, #slice=4
[2023-04-14 17:19:18.153478: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 27 has 45 nodes, max_size set to 12, #slice=4
[2023-04-14 17:19:18.153514: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 28 has 50 nodes, max_size set to 13, #slice=4
[2023-04-14 17:19:18.153550: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 29 has 67 nodes, max_size set to 17, #slice=4
[2023-04-14 17:19:18.153586: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 30 has 100 nodes, max_size set to 25, #slice=4
[2023-04-14 17:19:18.153623: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 31 has 129 nodes, max_size set to 33, #slice=4
[2023-04-14 17:19:18.153658: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 32 has 120 nodes, max_size set to 30, #slice=4
[2023-04-14 17:19:18.153694: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 33 has 155 nodes, max_size set to 39, #slice=4
[2023-04-14 17:19:18.153730: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 34 has 174 nodes, max_size set to 44, #slice=4
[2023-04-14 17:19:18.153766: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 35 has 211 nodes, max_size set to 53, #slice=4
[2023-04-14 17:19:18.153802: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 36 has 264 nodes, max_size set to 66, #slice=4
[2023-04-14 17:19:18.153837: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 37 has 300 nodes, max_size set to 75, #slice=4
[2023-04-14 17:19:18.153872: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 38 has 304 nodes, max_size set to 76, #slice=4
[2023-04-14 17:19:18.153908: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 39 has 423 nodes, max_size set to 106, #slice=4
[2023-04-14 17:19:18.153944: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 40 has 462 nodes, max_size set to 116, #slice=4
[2023-04-14 17:19:18.153981: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 41 has 545 nodes, max_size set to 137, #slice=4
[2023-04-14 17:19:18.154017: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 42 has 719 nodes, max_size set to 180, #slice=4
[2023-04-14 17:19:18.154052: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 43 has 800 nodes, max_size set to 200, #slice=4
[2023-04-14 17:19:18.154092: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 44 has 867 nodes, max_size set to 217, #slice=4
[2023-04-14 17:19:18.154128: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 45 has 1045 nodes, max_size set to 262, #slice=4
[2023-04-14 17:19:18.154164: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 46 has 1168 nodes, max_size set to 292, #slice=4
[2023-04-14 17:19:18.154200: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 47 has 1284 nodes, max_size set to 321, #slice=4
[2023-04-14 17:19:18.154236: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 48 has 1489 nodes, max_size set to 373, #slice=4
[2023-04-14 17:19:18.154273: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 49 has 1776 nodes, max_size set to 444, #slice=4
[2023-04-14 17:19:18.154310: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 50 has 1871 nodes, max_size set to 468, #slice=4
[2023-04-14 17:19:18.154347: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 51 has 2174 nodes, max_size set to 544, #slice=4
[2023-04-14 17:19:18.154384: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 52 has 2404 nodes, max_size set to 601, #slice=4
[2023-04-14 17:19:18.154419: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 53 has 2690 nodes, max_size set to 673, #slice=4
[2023-04-14 17:19:18.154455: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 54 has 3126 nodes, max_size set to 782, #slice=4
[2023-04-14 17:19:18.154491: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 55 has 3397 nodes, max_size set to 850, #slice=4
[2023-04-14 17:19:18.154544: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 56 has 3774 nodes, max_size set to 944, #slice=4
[2023-04-14 17:19:18.154579: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 57 has 4350 nodes, max_size set to 1088, #slice=4
[2023-04-14 17:19:18.154613: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 58 has 5029 nodes, max_size set to 1258, #slice=4
[2023-04-14 17:19:18.154649: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 59 has 5746 nodes, max_size set to 1437, #slice=4
[2023-04-14 17:19:18.154685: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 60 has 5931 nodes, max_size set to 1483, #slice=4
[2023-04-14 17:19:18.154720: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 61 has 7482 nodes, max_size set to 1871, #slice=4
[2023-04-14 17:19:18.154755: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 62 has 7428 nodes, max_size set to 1857, #slice=4
[2023-04-14 17:19:18.154791: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 63 has 10331 nodes, max_size set to 2583, #slice=4
[2023-04-14 17:19:18.154826: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 64 has 9347 nodes, max_size set to 2337, #slice=4
[2023-04-14 17:19:18.154863: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 65 has 10689 nodes, max_size set to 2673, #slice=4
[2023-04-14 17:19:18.154900: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 66 has 12403 nodes, max_size set to 3101, #slice=4
[2023-04-14 17:19:18.154940: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 67 has 29178 nodes, max_size set to 7295, #slice=4
[2023-04-14 17:19:18.154976: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 68 has 14963 nodes, max_size set to 3741, #slice=4
[2023-04-14 17:19:18.155012: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 69 has 16467 nodes, max_size set to 4117, #slice=4
[2023-04-14 17:19:18.155063: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 70 has 20121 nodes, max_size set to 5031, #slice=4
[2023-04-14 17:19:18.155112: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 71 has 21254 nodes, max_size set to 5314, #slice=4
[2023-04-14 17:19:18.155162: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 72 has 23312 nodes, max_size set to 5828, #slice=4
[2023-04-14 17:19:18.155210: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 73 has 28326 nodes, max_size set to 7082, #slice=4
[2023-04-14 17:19:18.155261: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 74 has 34548 nodes, max_size set to 8637, #slice=4
[2023-04-14 17:19:18.155311: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 75 has 33321 nodes, max_size set to 8331, #slice=4
[2023-04-14 17:19:18.155361: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 76 has 46304 nodes, max_size set to 11576, #slice=4
[2023-04-14 17:19:18.155411: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 77 has 53615 nodes, max_size set to 13404, #slice=4
[2023-04-14 17:19:18.155461: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 78 has 55774 nodes, max_size set to 13944, #slice=4
[2023-04-14 17:19:18.155510: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 79 has 48855 nodes, max_size set to 12214, #slice=4
[2023-04-14 17:19:18.155560: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 80 has 106181 nodes, max_size set to 26546, #slice=4
[2023-04-14 17:19:18.155611: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 81 has 50032 nodes, max_size set to 12508, #slice=4
[2023-04-14 17:19:18.155660: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 82 has 138270 nodes, max_size set to 34568, #slice=4
[2023-04-14 17:19:18.155710: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 83 has 99960 nodes, max_size set to 24990, #slice=4
[2023-04-14 17:19:18.155759: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 84 has 136350 nodes, max_size set to 34088, #slice=4
[2023-04-14 17:19:18.155808: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 85 has 198562 nodes, max_size set to 49641, #slice=4
[2023-04-14 17:19:18.155858: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 86 has 319759 nodes, max_size set to 79940, #slice=4
[2023-04-14 17:19:18.155907: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 88 has 616193 nodes, max_size set to 154049, #slice=4
[2023-04-14 17:19:18.155958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 90 has 1720402 nodes, max_size set to 430101, #slice=4
[2023-04-14 17:19:18.156008: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 93 has 10530932 nodes, max_size set to 882774, #slice=12
[2023-04-14 17:19:18.156062: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 94 has 8682781 nodes, max_size set to 882774, #slice=12
[2023-04-14 17:19:18.156113: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 95 has 8680765 nodes, max_size set to 882774, #slice=12
[2023-04-14 17:19:18.156164: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 96 has 8685953 nodes, max_size set to 882774, #slice=12
[2023-04-14 17:19:18.156213: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 97 has 8682030 nodes, max_size set to 8682030, #slice=1
[2023-04-14 17:19:18.156262: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 98 has 8683074 nodes, max_size set to 8683074, #slice=1
[2023-04-14 17:19:18.156312: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 99 has 8685589 nodes, max_size set to 8685589, #slice=1
[2023-04-14 17:19:18.156362: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 100 has 8686120 nodes, max_size set to 8686120, #slice=1
[2023-04-14 17:19:18.156411: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 101 has 8679773 nodes, max_size set to 8679773, #slice=1
[2023-04-14 17:19:18.156460: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 102 has 8683625 nodes, max_size set to 8683625, #slice=1
[2023-04-14 17:19:18.156509: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 103 has 8684020 nodes, max_size set to 8684020, #slice=1
[2023-04-14 17:19:18.156559: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 104 has 86838688 nodes, max_size set to 86838688, #slice=1
[2023-04-14 17:19:18.156609: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 105 has 86825356 nodes, max_size set to 86825356, #slice=1
[2023-04-14 17:19:18.156658: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 106 has 86829818 nodes, max_size set to 86829818, #slice=1
[2023-04-14 17:19:18.156708: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 107 has 86828649 nodes, max_size set to 86828649, #slice=1
[2023-04-14 17:19:18.156758: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 108 has 86838542 nodes, max_size set to 86838542, #slice=1
[2023-04-14 17:19:18.156808: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 109 has 86826742 nodes, max_size set to 86826742, #slice=1
[2023-04-14 17:19:18.156856: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 110 has 86842484 nodes, max_size set to 86842484, #slice=1
[2023-04-14 17:19:18.156906: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 111 has 86834097 nodes, max_size set to 86834097, #slice=1
[2023-04-14 17:19:18.156956: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 112 has 86822830 nodes, max_size set to 86822830, #slice=1
[2023-04-14 17:19:18.157005: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:405] counting blocks...
[2023-04-14 17:19:19.490631: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:425] Final num block is 416
[2023-04-14 17:19:19.490708: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:430] counting freq and density...
[2023-04-14 17:19:19.636767: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:479] averaging freq and density...
[2023-04-14 17:19:19.636867: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:480] 416
[2023-04-14 17:19:19.649569: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:218] solver built. now solve
[2023-04-14 17:19:19.649657: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:893] constructing optimal solver, device=4, stream=1
416 blocks, 4 devices
[2023-04-14 17:19:20.794304: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1078] Add Var...
[2023-04-14 17:19:20.806720: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1096] Capacity...
[2023-04-14 17:19:20.807087: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1099] Connect CPU...
[2023-04-14 17:19:20.811024: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1101] Connect Access To Storage...
[2023-04-14 17:19:20.847570: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1105] Time...
[2023-04-14 17:19:20.848261: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1067] dst 0, total sm is 80
[2023-04-14 17:19:20.849262: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1067] dst 1, total sm is 80
[2023-04-14 17:19:20.850134: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1067] dst 2, total sm is 80
[2023-04-14 17:19:20.851022: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1067] dst 3, total sm is 80
[2023-04-14 17:19:21.130720: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1124] Coll Cache init block placement array
[2023-04-14 17:19:21.132079: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1200] Coll Cache init block placement array done
[2023-04-14 17:19:21.132172: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1202] Coll Cache model reset done
[2023-04-14 17:19:21.136580: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:222] solver solved
[2023-04-14 17:19:21.136644: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:437] 0 solved master
[2023-04-14 17:19:21.136683: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 0 solved
[2023-04-14 17:19:21.136715: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 0 initing device 0
[2023-04-14 17:19:21.137929: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-14 17:19:21.138403: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cuh:611] per src size local is 9698826
[2023-04-14 17:19:21.341599: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 2 solved
[2023-04-14 17:19:21.341831: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 2 initing device 2
[2023-04-14 17:19:21.343574: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-14 17:19:21.356124: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 3 solved
[2023-04-14 17:19:21.356233: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 3 initing device 3
[2023-04-14 17:19:21.357073: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-14 17:19:21.358862: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 1 solved
[2023-04-14 17:19:21.358983: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 1 initing device 1
[2023-04-14 17:19:21.365151: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-14 17:19:21.379995: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 868320936
[2023-04-14 17:19:21.683750: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 868320936
[2023-04-14 17:19:21.711368: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 868320936
[2023-04-14 17:19:21.719336: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 868320936
[2023-04-14 17:19:21.779901: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 14453656 possible elem, scale to 33554432
[2023-04-14 17:19:21.780001: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 256.00 MB
[2023-04-14 17:19:22. 64441: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 14453656 possible elem, scale to 33554432
[2023-04-14 17:19:22. 64560: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 256.00 MB
[2023-04-14 17:19:22. 88643: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 14453656 possible elem, scale to 33554432
[2023-04-14 17:19:22. 88738: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 256.00 MB
[2023-04-14 17:19:22. 91637: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 14453656 possible elem, scale to 33554432
[2023-04-14 17:19:22. 91727: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 256.00 MB
[2023-04-14 17:19:22.138278: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?9710520->1148805
[2023-04-14 17:19:22.145463: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8561715 / 882774592 nodes ( 0.97 %~1.00 %) | remote 5891941 / 882774592 nodes ( 0.67 %) | cpu 868320936 / 882774592 nodes ( 98.36 %) | 4.63 GB | 0.780244 secs 
[2023-04-14 17:19:22.149818: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?9710520->948244
[2023-04-14 17:19:22.154534: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8762276 / 882774592 nodes ( 0.99 %~1.00 %) | remote 5691380 / 882774592 nodes ( 0.64 %) | cpu 868320936 / 882774592 nodes ( 98.36 %) | 4.63 GB | 0.810871 secs 
[2023-04-14 17:19:22.154822: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?9710520->996214
[2023-04-14 17:19:22.165952: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8714306 / 882774592 nodes ( 0.99 %~1.00 %) | remote 5739350 / 882774592 nodes ( 0.65 %) | cpu 868320936 / 882774592 nodes ( 98.36 %) | 4.63 GB | 0.808841 secs 
[2023-04-14 17:19:22.185484: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?9710520->893496
[2023-04-14 17:19:22.193214: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: coll_cache_asymm_link) | local 8817024 / 882774592 nodes ( 1.00 %~1.00 %) | remote 5636632 / 882774592 nodes ( 0.64 %) | cpu 868320936 / 882774592 nodes ( 98.36 %) | 4.63 GB | 1.05524 secs 
[2023-04-14 17:19:22.219545: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 7.58 GB
[2023-04-14 17:19:22.219817: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 7.58 GB
[2023-04-14 17:19:22.219946: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 7.58 GB
[2023-04-14 17:19:22.220088: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 7.58 GB
[2023-04-14 17:19:25.260411: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 8.46 GB
[2023-04-14 17:19:25.260842: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 8.46 GB
[2023-04-14 17:19:25.347888: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 8.49 GB
[2023-04-14 17:19:25.348070: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 8.49 GB
[2023-04-14 17:19:25.363165: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 8.49 GB
[2023-04-14 17:19:25.363308: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 8.49 GB
[2023-04-14 17:19:25.389617: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 8.50 GB
[2023-04-14 17:19:25.389733: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 8.50 GB
