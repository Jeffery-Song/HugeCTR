[HCTR][04:43:19.816][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
[HCTR][04:43:19.834][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
[HCTR][04:43:19.879][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
[HCTR][04:43:19.885][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:00,  3.57it/s]warmup run: 1it [00:00,  3.59it/s]warmup run: 1it [00:00,  3.54it/s]warmup run: 1it [00:00,  3.47it/s]warmup run: 86it [00:00, 288.58it/s]warmup run: 88it [00:00, 294.18it/s]warmup run: 86it [00:00, 289.75it/s]warmup run: 84it [00:00, 276.43it/s]warmup run: 157it [00:00, 423.06it/s]warmup run: 160it [00:00, 430.52it/s]warmup run: 156it [00:00, 421.26it/s]warmup run: 155it [00:00, 414.30it/s]warmup run: 231it [00:00, 518.69it/s]warmup run: 227it [00:00, 508.39it/s]warmup run: 226it [00:00, 509.16it/s]warmup run: 221it [00:00, 489.56it/s]warmup run: 298it [00:00, 570.85it/s]warmup run: 304it [00:00, 581.62it/s]warmup run: 297it [00:00, 569.89it/s]warmup run: 291it [00:00, 553.79it/s]warmup run: 371it [00:00, 618.36it/s]warmup run: 376it [00:00, 623.53it/s]warmup run: 369it [00:00, 613.58it/s]warmup run: 360it [00:00, 593.17it/s]warmup run: 442it [00:00, 645.93it/s]warmup run: 448it [00:00, 651.68it/s]warmup run: 438it [00:00, 636.43it/s]warmup run: 429it [00:00, 621.06it/s]warmup run: 515it [00:00, 670.08it/s]warmup run: 521it [00:00, 674.66it/s]warmup run: 506it [00:00, 635.13it/s]warmup run: 499it [00:00, 644.30it/s]warmup run: 594it [00:01, 689.35it/s]warmup run: 586it [00:01, 673.76it/s]warmup run: 573it [00:01, 640.90it/s]warmup run: 567it [00:01, 642.38it/s]warmup run: 667it [00:01, 698.76it/s]warmup run: 656it [00:01, 670.50it/s]warmup run: 650it [00:01, 678.53it/s]warmup run: 643it [00:01, 675.07it/s]warmup run: 740it [00:01, 705.95it/s]warmup run: 727it [00:01, 705.61it/s]warmup run: 725it [00:01, 664.62it/s]warmup run: 718it [00:01, 696.47it/s]warmup run: 813it [00:01, 711.05it/s]warmup run: 799it [00:01, 703.86it/s]warmup run: 793it [00:01, 662.28it/s]warmup run: 789it [00:01, 692.28it/s]warmup run: 886it [00:01, 715.01it/s]warmup run: 871it [00:01, 697.52it/s]warmup run: 860it [00:01, 659.51it/s]warmup run: 860it [00:01, 694.84it/s]warmup run: 959it [00:01, 717.28it/s]warmup run: 944it [00:01, 706.62it/s]warmup run: 929it [00:01, 667.88it/s]warmup run: 931it [00:01, 695.70it/s]warmup run: 1032it [00:01, 715.09it/s]warmup run: 1021it [00:01, 722.43it/s]warmup run: 999it [00:01, 676.96it/s]warmup run: 1003it [00:01, 702.63it/s]warmup run: 1106it [00:01, 720.86it/s]warmup run: 1095it [00:01, 726.78it/s]warmup run: 1067it [00:01, 673.52it/s]warmup run: 1075it [00:01, 704.77it/s]warmup run: 1180it [00:01, 724.11it/s]warmup run: 1168it [00:01, 723.85it/s]warmup run: 1135it [00:01, 671.04it/s]warmup run: 1148it [00:01, 711.07it/s]warmup run: 1253it [00:01, 725.64it/s]warmup run: 1242it [00:02, 726.28it/s]warmup run: 1203it [00:02, 668.68it/s]warmup run: 1220it [00:02, 707.53it/s]warmup run: 1326it [00:02, 726.89it/s]warmup run: 1315it [00:02, 724.50it/s]warmup run: 1272it [00:02, 672.86it/s]warmup run: 1291it [00:02, 698.19it/s]warmup run: 1399it [00:02, 726.62it/s]warmup run: 1389it [00:02, 728.08it/s]warmup run: 1342it [00:02, 678.63it/s]warmup run: 1361it [00:02, 689.93it/s]warmup run: 1472it [00:02, 726.50it/s]warmup run: 1462it [00:02, 713.56it/s]warmup run: 1410it [00:02, 673.28it/s]warmup run: 1433it [00:02, 696.29it/s]warmup run: 1546it [00:02, 727.30it/s]warmup run: 1534it [00:02, 711.69it/s]warmup run: 1478it [00:02, 667.57it/s]warmup run: 1507it [00:02, 706.40it/s]warmup run: 1620it [00:02, 728.75it/s]warmup run: 1606it [00:02, 711.85it/s]warmup run: 1547it [00:02, 672.00it/s]warmup run: 1579it [00:02, 709.89it/s]warmup run: 1694it [00:02, 730.62it/s]warmup run: 1682it [00:02, 723.69it/s]warmup run: 1617it [00:02, 680.03it/s]warmup run: 1651it [00:02, 709.93it/s]warmup run: 1768it [00:02, 730.45it/s]warmup run: 1686it [00:02, 681.46it/s]warmup run: 1755it [00:02, 713.27it/s]warmup run: 1723it [00:02, 710.40it/s]warmup run: 1842it [00:02, 728.61it/s]warmup run: 1755it [00:02, 679.18it/s]warmup run: 1796it [00:02, 715.60it/s]warmup run: 1827it [00:02, 706.56it/s]warmup run: 1916it [00:02, 729.33it/s]warmup run: 1823it [00:02, 674.77it/s]warmup run: 1870it [00:02, 720.33it/s]warmup run: 1899it [00:02, 709.34it/s]warmup run: 1989it [00:03, 727.83it/s]warmup run: 1892it [00:03, 676.16it/s]warmup run: 1943it [00:03, 720.03it/s]warmup run: 1970it [00:03, 709.30it/s]warmup run: 2062it [00:03, 726.81it/s]warmup run: 1961it [00:03, 678.80it/s]warmup run: 2044it [00:03, 717.24it/s]warmup run: 2016it [00:03, 718.87it/s]warmup run: 2135it [00:03, 712.31it/s]warmup run: 2030it [00:03, 680.68it/s]warmup run: 2117it [00:03, 719.47it/s]warmup run: 2089it [00:03, 720.55it/s]warmup run: 2207it [00:03, 710.89it/s]warmup run: 2100it [00:03, 684.41it/s]warmup run: 2191it [00:03, 724.35it/s]warmup run: 2162it [00:03, 720.32it/s]warmup run: 2279it [00:03, 701.27it/s]warmup run: 2175it [00:03, 703.52it/s]warmup run: 2266it [00:03, 730.17it/s]warmup run: 2239it [00:03, 732.01it/s]warmup run: 2350it [00:03, 702.17it/s]warmup run: 2341it [00:03, 734.63it/s]warmup run: 2246it [00:03, 696.00it/s]warmup run: 2313it [00:03, 730.11it/s]warmup run: 2421it [00:03, 704.25it/s]warmup run: 2415it [00:03, 734.11it/s]warmup run: 2316it [00:03, 694.98it/s]warmup run: 2387it [00:03, 731.82it/s]warmup run: 2493it [00:03, 706.71it/s]warmup run: 2492it [00:03, 743.29it/s]warmup run: 2461it [00:03, 734.03it/s]warmup run: 2386it [00:03, 691.32it/s]warmup run: 2565it [00:03, 708.72it/s]warmup run: 2571it [00:03, 755.55it/s]warmup run: 2535it [00:03, 731.10it/s]warmup run: 2456it [00:03, 690.90it/s]warmup run: 2637it [00:03, 708.52it/s]warmup run: 2647it [00:03, 749.12it/s]warmup run: 2527it [00:03, 695.56it/s]warmup run: 2609it [00:03, 726.29it/s]warmup run: 2708it [00:04, 700.07it/s]warmup run: 2722it [00:04, 746.65it/s]warmup run: 2597it [00:04, 692.54it/s]warmup run: 2683it [00:04, 729.43it/s]warmup run: 2786it [00:04, 721.14it/s]warmup run: 2798it [00:04, 750.23it/s]warmup run: 2668it [00:04, 697.27it/s]warmup run: 2759it [00:04, 736.87it/s]warmup run: 2863it [00:04, 733.20it/s]warmup run: 2738it [00:04, 693.29it/s]warmup run: 2833it [00:04, 732.10it/s]warmup run: 2874it [00:04, 739.07it/s]warmup run: 2937it [00:04, 733.08it/s]warmup run: 2908it [00:04, 737.28it/s]warmup run: 2948it [00:04, 736.90it/s]warmup run: 2808it [00:04, 687.26it/s]warmup run: 3011it [00:04, 731.14it/s]warmup run: 2982it [00:04, 737.35it/s]warmup run: 2882it [00:04, 702.09it/s]warmup run: 3022it [00:04, 723.67it/s]warmup run: 3085it [00:04, 731.28it/s]warmup run: 3056it [00:04, 730.49it/s]warmup run: 2953it [00:04, 698.48it/s]warmup run: 3095it [00:04, 716.29it/s]warmup run: 3159it [00:04, 724.49it/s]warmup run: 3131it [00:04, 732.80it/s]warmup run: 3024it [00:04, 700.95it/s]warmup run: 3167it [00:04, 702.90it/s]warmup run: 3205it [00:04, 733.35it/s]warmup run: 3097it [00:04, 708.75it/s]warmup run: 3232it [00:04, 684.10it/s]warmup run: 3240it [00:04, 709.25it/s]warmup run: 3279it [00:04, 733.83it/s]warmup run: 3168it [00:04, 708.42it/s]warmup run: 3304it [00:04, 694.08it/s]warmup run: 3312it [00:04, 711.18it/s]warmup run: 3353it [00:04, 734.77it/s]warmup run: 3240it [00:04, 710.98it/s]warmup run: 3377it [00:04, 701.69it/s]warmup run: 3384it [00:04, 711.14it/s]warmup run: 3429it [00:05, 740.75it/s]warmup run: 3312it [00:05, 712.40it/s]warmup run: 3449it [00:05, 706.08it/s]warmup run: 3457it [00:05, 715.31it/s]warmup run: 3504it [00:05, 737.68it/s]warmup run: 3384it [00:05, 701.16it/s]warmup run: 3522it [00:05, 711.26it/s]warmup run: 3529it [00:05, 708.98it/s]warmup run: 3455it [00:05, 701.36it/s]warmup run: 3595it [00:05, 714.72it/s]warmup run: 3578it [00:05, 714.19it/s]warmup run: 3600it [00:05, 708.17it/s]warmup run: 3536it [00:05, 732.44it/s]warmup run: 3668it [00:05, 717.79it/s]warmup run: 3671it [00:05, 706.15it/s]warmup run: 3650it [00:05, 683.18it/s]warmup run: 3610it [00:05, 731.36it/s]warmup run: 3742it [00:05, 721.96it/s]warmup run: 3744it [00:05, 710.60it/s]warmup run: 3719it [00:05, 677.63it/s]warmup run: 3815it [00:05, 722.78it/s]warmup run: 3684it [00:05, 723.50it/s]warmup run: 3816it [00:05, 712.63it/s]warmup run: 3787it [00:05, 675.66it/s]warmup run: 3888it [00:05, 723.78it/s]warmup run: 3757it [00:05, 724.44it/s]warmup run: 3889it [00:05, 716.11it/s]warmup run: 3855it [00:05, 667.39it/s]warmup run: 3961it [00:05, 723.60it/s]warmup run: 3831it [00:05, 727.39it/s]warmup run: 3962it [00:05, 717.86it/s]warmup run: 3924it [00:05, 670.63it/s]warmup run: 4000it [00:05, 685.68it/s]warmup run: 4000it [00:05, 684.75it/s]warmup run: 3904it [00:05, 712.01it/s]warmup run: 3992it [00:05, 657.03it/s]warmup run: 4000it [00:05, 674.33it/s]warmup run: 3976it [00:05, 703.57it/s]warmup run: 4000it [00:06, 663.37it/s]

warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   4%|▍         | 173/4000 [00:00<00:02, 1727.13it/s]warmup should be done:   4%|▍         | 174/4000 [00:00<00:02, 1730.88it/s]warmup should be done:   4%|▍         | 161/4000 [00:00<00:02, 1605.04it/s]warmup should be done:   4%|▍         | 159/4000 [00:00<00:02, 1583.61it/s]warmup should be done:   9%|▉         | 352/4000 [00:00<00:02, 1763.77it/s]warmup should be done:   8%|▊         | 338/4000 [00:00<00:02, 1699.26it/s]warmup should be done:   9%|▉         | 356/4000 [00:00<00:02, 1778.12it/s]warmup should be done:   8%|▊         | 328/4000 [00:00<00:02, 1642.53it/s]warmup should be done:  13%|█▎        | 530/4000 [00:00<00:01, 1766.42it/s]warmup should be done:  13%|█▎        | 512/4000 [00:00<00:02, 1717.06it/s]warmup should be done:  13%|█▎        | 534/4000 [00:00<00:01, 1773.01it/s]warmup should be done:  12%|█▏        | 494/4000 [00:00<00:02, 1647.38it/s]warmup should be done:  17%|█▋        | 688/4000 [00:00<00:01, 1733.80it/s]warmup should be done:  16%|█▋        | 660/4000 [00:00<00:02, 1651.22it/s]warmup should be done:  18%|█▊        | 707/4000 [00:00<00:01, 1756.35it/s]warmup should be done:  18%|█▊        | 712/4000 [00:00<00:01, 1666.57it/s]warmup should be done:  22%|██▏       | 865/4000 [00:00<00:01, 1745.55it/s]warmup should be done:  21%|██        | 826/4000 [00:00<00:01, 1652.32it/s]warmup should be done:  22%|██▏       | 883/4000 [00:00<00:01, 1751.38it/s]warmup should be done:  22%|██▏       | 892/4000 [00:00<00:01, 1710.18it/s]warmup should be done:  26%|██▌       | 1042/4000 [00:00<00:01, 1751.06it/s]warmup should be done:  25%|██▍       | 994/4000 [00:00<00:01, 1660.78it/s]warmup should be done:  26%|██▋       | 1059/4000 [00:00<00:01, 1727.35it/s]warmup should be done:  27%|██▋       | 1073/4000 [00:00<00:01, 1743.02it/s]warmup should be done:  30%|███       | 1218/4000 [00:00<00:01, 1750.47it/s]warmup should be done:  29%|██▉       | 1167/4000 [00:00<00:01, 1682.89it/s]warmup should be done:  31%|███       | 1237/4000 [00:00<00:01, 1742.14it/s]warmup should be done:  31%|███▏      | 1255/4000 [00:00<00:01, 1765.68it/s]warmup should be done:  34%|███▎      | 1340/4000 [00:00<00:01, 1697.32it/s]warmup should be done:  35%|███▍      | 1394/4000 [00:00<00:01, 1747.89it/s]warmup should be done:  35%|███▌      | 1416/4000 [00:00<00:01, 1756.47it/s]warmup should be done:  36%|███▌      | 1436/4000 [00:00<00:01, 1778.66it/s]warmup should be done:  38%|███▊      | 1512/4000 [00:00<00:01, 1702.53it/s]warmup should be done:  39%|███▉      | 1569/4000 [00:00<00:01, 1747.89it/s]warmup should be done:  40%|███▉      | 1594/4000 [00:00<00:01, 1762.69it/s]warmup should be done:  40%|████      | 1618/4000 [00:00<00:01, 1789.52it/s]warmup should be done:  44%|████▎     | 1744/4000 [00:01<00:01, 1748.46it/s]warmup should be done:  42%|████▏     | 1684/4000 [00:01<00:01, 1706.49it/s]warmup should be done:  44%|████▍     | 1776/4000 [00:01<00:01, 1773.98it/s]warmup should be done:  45%|████▍     | 1799/4000 [00:01<00:01, 1795.76it/s]warmup should be done:  46%|████▋     | 1855/4000 [00:01<00:01, 1704.69it/s]warmup should be done:  48%|████▊     | 1919/4000 [00:01<00:01, 1743.42it/s]warmup should be done:  49%|████▉     | 1957/4000 [00:01<00:01, 1784.00it/s]warmup should be done:  50%|████▉     | 1980/4000 [00:01<00:01, 1798.54it/s]warmup should be done:  52%|█████▏    | 2094/4000 [00:01<00:01, 1744.56it/s]warmup should be done:  51%|█████     | 2026/4000 [00:01<00:01, 1682.13it/s]warmup should be done:  53%|█████▎    | 2136/4000 [00:01<00:01, 1776.93it/s]warmup should be done:  54%|█████▍    | 2162/4000 [00:01<00:01, 1803.38it/s]warmup should be done:  57%|█████▋    | 2270/4000 [00:01<00:00, 1746.18it/s]warmup should be done:  55%|█████▍    | 2195/4000 [00:01<00:01, 1677.80it/s]warmup should be done:  58%|█████▊    | 2317/4000 [00:01<00:00, 1786.77it/s]warmup should be done:  59%|█████▊    | 2343/4000 [00:01<00:00, 1803.40it/s]warmup should be done:  61%|██████    | 2445/4000 [00:01<00:00, 1746.18it/s]warmup should be done:  59%|█████▉    | 2363/4000 [00:01<00:00, 1673.05it/s]warmup should be done:  62%|██████▏   | 2498/4000 [00:01<00:00, 1791.26it/s]warmup should be done:  63%|██████▎   | 2526/4000 [00:01<00:00, 1809.72it/s]warmup should be done:  66%|██████▌   | 2623/4000 [00:01<00:00, 1754.19it/s]warmup should be done:  63%|██████▎   | 2532/4000 [00:01<00:00, 1676.64it/s]warmup should be done:  67%|██████▋   | 2678/4000 [00:01<00:00, 1793.41it/s]warmup should be done:  68%|██████▊   | 2709/4000 [00:01<00:00, 1814.67it/s]warmup should be done:  70%|██████▉   | 2799/4000 [00:01<00:00, 1754.77it/s]warmup should be done:  68%|██████▊   | 2700/4000 [00:01<00:00, 1671.93it/s]warmup should be done:  72%|███████▏  | 2860/4000 [00:01<00:00, 1799.30it/s]warmup should be done:  72%|███████▏  | 2892/4000 [00:01<00:00, 1816.58it/s]warmup should be done:  74%|███████▍  | 2975/4000 [00:01<00:00, 1754.96it/s]warmup should be done:  76%|███████▌  | 3042/4000 [00:01<00:00, 1804.23it/s]warmup should be done:  72%|███████▏  | 2868/4000 [00:01<00:00, 1672.32it/s]warmup should be done:  77%|███████▋  | 3075/4000 [00:01<00:00, 1818.09it/s]warmup should be done:  79%|███████▉  | 3151/4000 [00:01<00:00, 1754.98it/s]warmup should be done:  81%|████████  | 3223/4000 [00:01<00:00, 1804.85it/s]warmup should be done:  76%|███████▌  | 3037/4000 [00:01<00:00, 1675.02it/s]warmup should be done:  81%|████████▏ | 3257/4000 [00:01<00:00, 1816.46it/s]warmup should be done:  83%|████████▎ | 3327/4000 [00:01<00:00, 1751.95it/s]warmup should be done:  85%|████████▌ | 3404/4000 [00:01<00:00, 1805.68it/s]warmup should be done:  80%|████████  | 3205/4000 [00:01<00:00, 1673.97it/s]warmup should be done:  86%|████████▌ | 3439/4000 [00:01<00:00, 1813.87it/s]warmup should be done:  88%|████████▊ | 3503/4000 [00:02<00:00, 1752.53it/s]warmup should be done:  84%|████████▍ | 3374/4000 [00:02<00:00, 1676.20it/s]warmup should be done:  90%|████████▉ | 3585/4000 [00:02<00:00, 1791.62it/s]warmup should be done:  91%|█████████ | 3621/4000 [00:02<00:00, 1814.45it/s]warmup should be done:  92%|█████████▏| 3680/4000 [00:02<00:00, 1756.36it/s]warmup should be done:  89%|████████▊ | 3542/4000 [00:02<00:00, 1676.56it/s]warmup should be done:  94%|█████████▍| 3767/4000 [00:02<00:00, 1797.14it/s]warmup should be done:  95%|█████████▌| 3803/4000 [00:02<00:00, 1813.67it/s]warmup should be done:  96%|█████████▋| 3856/4000 [00:02<00:00, 1753.97it/s]warmup should be done:  93%|█████████▎| 3711/4000 [00:02<00:00, 1678.77it/s]warmup should be done:  99%|█████████▊| 3947/4000 [00:02<00:00, 1795.09it/s]warmup should be done: 100%|█████████▉| 3986/4000 [00:02<00:00, 1817.03it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1792.11it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1780.65it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1745.40it/s]warmup should be done:  97%|█████████▋| 3880/4000 [00:02<00:00, 1681.71it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1676.66it/s]
warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   4%|▍         | 169/4000 [00:00<00:02, 1687.31it/s]warmup should be done:   4%|▍         | 175/4000 [00:00<00:02, 1742.18it/s]warmup should be done:   4%|▍         | 169/4000 [00:00<00:02, 1684.90it/s]warmup should be done:   4%|▍         | 171/4000 [00:00<00:02, 1705.13it/s]warmup should be done:   9%|▊         | 341/4000 [00:00<00:02, 1706.38it/s]warmup should be done:   9%|▉         | 357/4000 [00:00<00:02, 1795.82it/s]warmup should be done:   9%|▊         | 345/4000 [00:00<00:02, 1727.93it/s]warmup should be done:   9%|▉         | 356/4000 [00:00<00:02, 1777.27it/s]warmup should be done:  13%|█▎        | 527/4000 [00:00<00:01, 1774.00it/s]warmup should be done:  13%|█▎        | 537/4000 [00:00<00:01, 1791.42it/s]warmup should be done:  14%|█▎        | 545/4000 [00:00<00:01, 1830.23it/s]warmup should be done:  13%|█▎        | 533/4000 [00:00<00:01, 1793.07it/s]warmup should be done:  18%|█▊        | 713/4000 [00:00<00:01, 1806.31it/s]warmup should be done:  18%|█▊        | 718/4000 [00:00<00:01, 1796.85it/s]warmup should be done:  18%|█▊        | 733/4000 [00:00<00:01, 1847.22it/s]warmup should be done:  18%|█▊        | 721/4000 [00:00<00:01, 1824.47it/s]warmup should be done:  22%|██▏       | 899/4000 [00:00<00:01, 1824.50it/s]warmup should be done:  23%|██▎       | 921/4000 [00:00<00:01, 1856.12it/s]warmup should be done:  23%|██▎       | 907/4000 [00:00<00:01, 1834.99it/s]warmup should be done:  22%|██▏       | 898/4000 [00:00<00:01, 1773.54it/s]warmup should be done:  27%|██▋       | 1087/4000 [00:00<00:01, 1840.31it/s]warmup should be done:  27%|██▋       | 1094/4000 [00:00<00:01, 1844.94it/s]warmup should be done:  28%|██▊       | 1108/4000 [00:00<00:01, 1858.08it/s]warmup should be done:  27%|██▋       | 1076/4000 [00:00<00:01, 1765.53it/s]warmup should be done:  32%|███▏      | 1295/4000 [00:00<00:01, 1860.37it/s]warmup should be done:  32%|███▏      | 1280/4000 [00:00<00:01, 1846.77it/s]warmup should be done:  31%|███▏      | 1257/4000 [00:00<00:01, 1776.96it/s]warmup should be done:  32%|███▏      | 1272/4000 [00:00<00:01, 1808.46it/s]warmup should be done:  37%|███▋      | 1467/4000 [00:00<00:01, 1852.88it/s]warmup should be done:  37%|███▋      | 1482/4000 [00:00<00:01, 1844.14it/s]warmup should be done:  36%|███▌      | 1437/4000 [00:00<00:01, 1783.85it/s]warmup should be done:  36%|███▋      | 1453/4000 [00:00<00:01, 1785.88it/s]warmup should be done:  42%|████▏     | 1669/4000 [00:00<00:01, 1851.84it/s]warmup should be done:  40%|████      | 1616/4000 [00:00<00:01, 1772.75it/s]warmup should be done:  41%|████      | 1637/4000 [00:00<00:01, 1801.24it/s]warmup should be done:  41%|████▏     | 1653/4000 [00:00<00:01, 1782.85it/s]warmup should be done:  46%|████▋     | 1858/4000 [00:01<00:01, 1862.43it/s]warmup should be done:  46%|████▌     | 1822/4000 [00:01<00:01, 1815.33it/s]warmup should be done:  45%|████▍     | 1794/4000 [00:01<00:01, 1749.33it/s]warmup should be done:  46%|████▌     | 1838/4000 [00:01<00:01, 1802.82it/s]warmup should be done:  50%|█████     | 2004/4000 [00:01<00:01, 1803.18it/s]warmup should be done:  51%|█████     | 2045/4000 [00:01<00:01, 1813.84it/s]warmup should be done:  51%|█████     | 2027/4000 [00:01<00:01, 1827.85it/s]warmup should be done:  49%|████▉     | 1970/4000 [00:01<00:01, 1742.23it/s]warmup should be done:  56%|█████▌    | 2230/4000 [00:01<00:00, 1822.90it/s]warmup should be done:  55%|█████▍    | 2185/4000 [00:01<00:01, 1795.91it/s]warmup should be done:  55%|█████▌    | 2216/4000 [00:01<00:00, 1843.79it/s]warmup should be done:  54%|█████▎    | 2145/4000 [00:01<00:01, 1741.97it/s]warmup should be done:  59%|█████▉    | 2369/4000 [00:01<00:00, 1807.14it/s]warmup should be done:  60%|██████    | 2404/4000 [00:01<00:00, 1854.60it/s]warmup should be done:  58%|█████▊    | 2322/4000 [00:01<00:00, 1747.97it/s]warmup should be done:  60%|██████    | 2413/4000 [00:01<00:00, 1783.62it/s]warmup should be done:  64%|██████▍   | 2553/4000 [00:01<00:00, 1816.69it/s]warmup should be done:  65%|██████▍   | 2592/4000 [00:01<00:00, 1860.68it/s]warmup should be done:  62%|██████▏   | 2498/4000 [00:01<00:00, 1749.35it/s]warmup should be done:  65%|██████▍   | 2592/4000 [00:01<00:00, 1778.31it/s]warmup should be done:  68%|██████▊   | 2735/4000 [00:01<00:00, 1817.36it/s]warmup should be done:  69%|██████▉   | 2779/4000 [00:01<00:00, 1861.12it/s]warmup should be done:  67%|██████▋   | 2673/4000 [00:01<00:00, 1738.22it/s]warmup should be done:  69%|██████▉   | 2771/4000 [00:01<00:00, 1775.86it/s]warmup should be done:  74%|███████▍  | 2966/4000 [00:01<00:00, 1863.27it/s]warmup should be done:  73%|███████▎  | 2917/4000 [00:01<00:00, 1813.09it/s]warmup should be done:  71%|███████▏  | 2852/4000 [00:01<00:00, 1751.63it/s]warmup should be done:  74%|███████▎  | 2949/4000 [00:01<00:00, 1773.80it/s]warmup should be done:  77%|███████▋  | 3099/4000 [00:01<00:00, 1813.41it/s]warmup should be done:  76%|███████▌  | 3028/4000 [00:01<00:00, 1752.05it/s]warmup should be done:  79%|███████▉  | 3153/4000 [00:01<00:00, 1843.40it/s]warmup should be done:  78%|███████▊  | 3129/4000 [00:01<00:00, 1780.59it/s]warmup should be done:  82%|████████▏ | 3281/4000 [00:01<00:00, 1815.10it/s]warmup should be done:  80%|████████  | 3209/4000 [00:01<00:00, 1766.89it/s]warmup should be done:  83%|████████▎ | 3338/4000 [00:01<00:00, 1835.86it/s]warmup should be done:  83%|████████▎ | 3313/4000 [00:01<00:00, 1796.93it/s]warmup should be done:  87%|████████▋ | 3464/4000 [00:01<00:00, 1818.04it/s]warmup should be done:  85%|████████▍ | 3389/4000 [00:01<00:00, 1774.29it/s]warmup should be done:  88%|████████▊ | 3526/4000 [00:01<00:00, 1848.87it/s]warmup should be done:  87%|████████▋ | 3498/4000 [00:01<00:00, 1811.16it/s]warmup should be done:  91%|█████████ | 3648/4000 [00:02<00:00, 1821.66it/s]warmup should be done:  89%|████████▉ | 3567/4000 [00:02<00:00, 1774.47it/s]warmup should be done:  93%|█████████▎| 3715/4000 [00:02<00:00, 1859.29it/s]warmup should be done:  92%|█████████▏| 3680/4000 [00:02<00:00, 1806.92it/s]warmup should be done:  96%|█████████▌| 3831/4000 [00:02<00:00, 1822.22it/s]warmup should be done:  94%|█████████▎| 3746/4000 [00:02<00:00, 1779.07it/s]warmup should be done:  98%|█████████▊| 3901/4000 [00:02<00:00, 1856.98it/s]warmup should be done:  97%|█████████▋| 3865/4000 [00:02<00:00, 1817.39it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1837.70it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1816.26it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1808.05it/s]warmup should be done:  98%|█████████▊| 3925/4000 [00:02<00:00, 1780.50it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1766.60it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fa658339970>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fa6583399a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fa658339970>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fa75621dca0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[HCTR][04:43:58.205][ERROR][RK0][tid #140338819737344]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][04:43:58.214][ERROR][RK0][tid #140338819737344]: coll ps creation done
[HCTR][04:43:58.337][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][04:43:58.339][ERROR][RK0][tid #140338719090432]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][04:43:58.341][ERROR][RK0][tid #140338702305024]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][04:43:58.343][ERROR][RK0][main]: coll ps creation done
[HCTR][04:43:58.344][ERROR][RK0][tid #140338719090432]: coll ps creation done
[HCTR][04:43:58.345][ERROR][RK0][tid #140338702305024]: coll ps creation done
[HCTR][04:43:58.345][ERROR][RK0][tid #140338702305024]: replica 0 preparing frequency
[2023-04-15 04:43:58.345701: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506420 into 0
[2023-04-15 04:43:58.348349: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16096740
[2023-04-15 04:43:58.348520: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 507207 into 506420
[2023-04-15 04:43:58.351141: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18562884
[2023-04-15 04:43:58.351314: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505205 into 1013627
[2023-04-15 04:43:58.353977: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29302162
[2023-04-15 04:43:58.354274: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506136 into 1518832
[2023-04-15 04:43:58.356915: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26139476
[2023-04-15 04:43:58.357200: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505398 into 2024968
[2023-04-15 04:43:58.359797: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19260545
[2023-04-15 04:43:58.359974: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504794 into 2530366
[2023-04-15 04:43:58.362611: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30890472
[2023-04-15 04:43:58.362886: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505406 into 3035160
[2023-04-15 04:43:58.365483: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19318898
[2023-04-15 04:43:58.365660: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504793 into 3540566
[2023-04-15 04:43:58.368292: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16628166
[2023-04-15 04:43:58.368570: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505572 into 4045359
[2023-04-15 04:43:58.371212: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16550811
[2023-04-15 04:43:58.371479: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504900 into 4550931
[2023-04-15 04:43:58.374105: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20241846
[HCTR][04:43:58.374][ERROR][RK0][tid #140338719090432]: replica 1 preparing frequency
[2023-04-15 04:43:58.374378: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505919 into 5055831
[2023-04-15 04:43:58.376973: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16101633
[2023-04-15 04:43:58.377142: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506593 into 5561750
[2023-04-15 04:43:58.379773: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18552515
[2023-04-15 04:43:58.380046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505327 into 6068343
[2023-04-15 04:43:58.382713: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29301332
[2023-04-15 04:43:58.382908: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506187 into 6573670
[2023-04-15 04:43:58.385510: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26136012
[2023-04-15 04:43:58.385786: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505901 into 7079857
[2023-04-15 04:43:58.388430: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19265129
[2023-04-15 04:43:58.388690: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505571 into 7585758
[2023-04-15 04:43:58.391303: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30883844
[2023-04-15 04:43:58.391564: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505720 into 8091329
[2023-04-15 04:43:58.394166: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19315166
[2023-04-15 04:43:58.394433: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504944 into 8597049
[2023-04-15 04:43:58.397049: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16632782
[2023-04-15 04:43:58.397315: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504820 into 9101993
[2023-04-15 04:43:58.399891: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16553594
[2023-04-15 04:43:58.400054: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505016 into 9606813
[2023-04-15 04:43:58.402648: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20249993
[HCTR][04:43:58.402][ERROR][RK0][main]: replica 2 preparing frequency
[2023-04-15 04:43:58.402861: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506873 into 10111829
[2023-04-15 04:43:58.405498: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16100404
[2023-04-15 04:43:58.405770: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506443 into 10618702
[2023-04-15 04:43:58.408407: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18553445
[2023-04-15 04:43:58.408588: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504576 into 11125145
[2023-04-15 04:43:58.411221: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29306042
[2023-04-15 04:43:58.411487: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506049 into 11629721
[2023-04-15 04:43:58.414087: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26132673
[2023-04-15 04:43:58.414265: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504567 into 12135770
[2023-04-15 04:43:58.416886: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19264202
[2023-04-15 04:43:58.417065: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505275 into 12640337
[2023-04-15 04:43:58.419709: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30892607
[2023-04-15 04:43:58.419893: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506474 into 13145612
[2023-04-15 04:43:58.422483: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19315767
[2023-04-15 04:43:58.422665: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505642 into 13652086
[2023-04-15 04:43:58.425277: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16629343
[2023-04-15 04:43:58.425452: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505348 into 14157728
[2023-04-15 04:43:58.428056: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16548017
[2023-04-15 04:43:58.428230: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505835 into 14663076
[2023-04-15 04:43:58.430834: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20249500
[HCTR][04:43:58.431][ERROR][RK0][tid #140338819737344]: replica 3 preparing frequency
[2023-04-15 04:43:58.431080: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506615 into 15168911
[2023-04-15 04:43:58.433671: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16095683
[2023-04-15 04:43:58.433833: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505824 into 15675526
[2023-04-15 04:43:58.436459: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18553842
[2023-04-15 04:43:58.436718: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 503719 into 16181350
[2023-04-15 04:43:58.439352: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29304109
[2023-04-15 04:43:58.439536: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505976 into 16685069
[2023-04-15 04:43:58.442153: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26128937
[2023-04-15 04:43:58.442419: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505282 into 17191045
[2023-04-15 04:43:58.444992: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19265045
[2023-04-15 04:43:58.445157: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505152 into 17696327
[2023-04-15 04:43:58.447783: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30890648
[2023-04-15 04:43:58.448055: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506736 into 18201479
[2023-04-15 04:43:58.450659: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19314006
[2023-04-15 04:43:58.450830: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505550 into 18708215
[2023-04-15 04:43:58.453399: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16637527
[2023-04-15 04:43:58.453569: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505162 into 19213765
[2023-04-15 04:43:58.456202: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16553626
[2023-04-15 04:43:58.456463: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505236 into 19718927
[2023-04-15 04:43:58.459031: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20248577
[2023-04-15 04:43:58.459202: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:266] freq recorder global combining
[2023-04-15 04:44:00.115481: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:269] freq recorder global combine from 20224163 to 14453656
[2023-04-15 04:44:00.281964: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:286] top 5 freq is 28347903,16740847,16373799,15339422,13482819
[HCTR][04:44:00.300][ERROR][RK0][tid #140338702305024]: Calling build_v2
[HCTR][04:44:00.300][ERROR][RK0][tid #140338702305024]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][04:44:00.300][ERROR][RK0][tid #140338819737344]: Calling build_v2
[HCTR][04:44:00.300][ERROR][RK0][tid #140338819737344]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2023-04-15 04:44:00.300922: [HCTR][04:44:00.300][ERROR][RK0][main]: Calling build_v2
[HCTR][04:44:00.300][ERROR][RK0][tid #140338719090432]: Calling build_v2
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:141] using concurrent impl MPSPhase
[[HCTR][04:44:00.300][ERROR][RK0][tid #140338719090432]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
2023-04-15 04:44:00[HCTR][04:44:00.301][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[.2023-04-15 04:44:00300970.: 300997E:  E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc141:] 409using concurrent impl MPSPhase] 
before scale, dtype is 0, dim is 128
[2023-04-15 04:44:00.301076[[: 2023-04-15 04:44:002023-04-15 04:44:00[E..2023-04-15 04:44:00 301092301092./hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: : 301097:EE: 141  E] /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc using concurrent impl MPSPhase::/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc
409415:] ] [141before scale, dtype is 0, dim is 128after scale, dtype is 7, new dim is 322023-04-15 04:44:00] 

.using concurrent impl MPSPhase301211[
: 2023-04-15 04:44:00E. 301247/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc[: :2023-04-15 04:44:00E409. ] 301276/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccbefore scale, dtype is 0, dim is 128: :
E415 [] /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc2023-04-15 04:44:00after scale, dtype is 7, new dim is 32:.
409301349] : before scale, dtype is 0, dim is 128E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:[4152023-04-15 04:44:00] .after scale, dtype is 7, new dim is 32301402
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:415] after scale, dtype is 7, new dim is 32
[2023-04-15 04:44:00.301777: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:207] assigning 8 to cpu
[2023-04-15 04:44:00.301836: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:224] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2023-04-15 04:44:00.301882: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:225] remote time is 9.21053
[2023-04-15 04:44:00.301914: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:226] cpu time is 31.8182
[2023-04-15 04:44:00.301954: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:425] registering cpu data with 16.00 GB
[2023-04-15 04:44:00.302389: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:207] assigning 8 to cpu
[2023-04-15 04:44:00.302420: E[ 2023-04-15 04:44:00/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:302435207: ] E[assigning 8 to cpu 2023-04-15 04:44:00
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc.:302441207: E]  [assigning 8 to cpu/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2023-04-15 04:44:00
:.224302528] : build symm link desc with 4X Tesla V100-SXM2-16GB out of 4E
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:224] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2023-04-15 04:44:00.[3026032023-04-15 04:44:00: .E302613 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: 225/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :remote time is 9.21053225
] [remote time is 9.210532023-04-15 04:44:00[
.2023-04-15 04:44:00302682.[: 3026892023-04-15 04:44:00E: . E302707/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc : :/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE224: ] 226/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccbuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4] :
cpu time is 31.8182226
] [cpu time is 31.81822023-04-15 04:44:00
.302806: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2252023-04-15 04:44:00[] .2023-04-15 04:44:00remote time is 9.21053302826.
: 302832E[:  2023-04-15 04:44:00E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc. :302874/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc425: :] E425registering cpu data with 16.00 GB ] 
/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccregistering cpu data with 16.00 GB:
226] cpu time is 31.8182
[2023-04-15 04:44:00.302983: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:425] registering cpu data with 16.00 GB
[2023-04-15 04:44:08.467062: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-15 04:44:08.467213: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:174] creating solver
[2023-04-15 04:44:08.467260: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:214] solver created. now build & solve
[2023-04-15 04:44:08.492021: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-15 04:44:08.508926: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-15 04:44:08.516858: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-15 04:44:12.288039: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:218] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2023-04-15 04:44:13.606828: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:222] solver solved
[2023-04-15 04:44:13.625295: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:437] 0 solved master
[2023-04-15 04:44:13.625361: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 0 solved
[2023-04-15 04:44:13.625392: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 0 initing device 0
[2023-04-15 04:44:13.626495: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-15 04:44:13.626692: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cuh:611] per src size local is 9710619
[2023-04-15 04:44:13.838937: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 2 solved
[2023-04-15 04:44:13.839166: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 2 initing device 2
[2023-04-15 04:44:13.841218: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-15 04:44:13.857254: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 3 solved
[2023-04-15 04:44:13.857353: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 3 initing device 3
[2023-04-15 04:44:13.859936: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-15 04:44:13.873637: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 847463612
[2023-04-15 04:44:13.874279: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 1 solved
[2023-04-15 04:44:13.874367: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 1 initing device 1
[2023-04-15 04:44:13.875121: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-15 04:44:14.253574: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 847463612
[2023-04-15 04:44:14.262209: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 847463612
[2023-04-15 04:44:14.278320: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 847463612
[2023-04-15 04:44:14.281980: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 35310980 possible elem, scale to 134217728
[2023-04-15 04:44:14.282055: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 1024.00 MB
[2023-04-15 04:44:14.631439: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 35310980 possible elem, scale to 134217728
[2023-04-15 04:44:14.631539: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 1024.00 MB
[2023-04-15 04:44:14.647158: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 35310980 possible elem, scale to 134217728
[2023-04-15 04:44:14.647268: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 1024.00 MB
[2023-04-15 04:44:14.659738: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 35310980 possible elem, scale to 134217728
[2023-04-15 04:44:14.659826: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 1024.00 MB
[2023-04-15 04:44:14.790174: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?9710520->882775
[2023-04-15 04:44:14.792836: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?9710520->882775
[2023-04-15 04:44:14.792958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?9710520->882775
[2023-04-15 04:44:14.793343: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?9710520->882775
[2023-04-15 04:44:14.795502: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: clique_part) | local 8827745 / 882774592 nodes ( 1.00 %~1.00 %) | remote 26483235 / 882774592 nodes ( 3.00 %) | cpu 847463612 / 882774592 nodes ( 96.00 %) | 4.63 GB | 0.935515 secs 
[2023-04-15 04:44:14.809935: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: clique_part) | local 8827745 / 882774592 nodes ( 1.00 %~1.00 %) | remote 26483235 / 882774592 nodes ( 3.00 %) | cpu 847463612 / 882774592 nodes ( 96.00 %) | 4.63 GB | 0.968626 secs 
[2023-04-15 04:44:14.824186: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: clique_part) | local 8827745 / 882774592 nodes ( 1.00 %~1.00 %) | remote 26483235 / 882774592 nodes ( 3.00 %) | cpu 847463612 / 882774592 nodes ( 96.00 %) | 4.63 GB | 1.19764 secs 
[2023-04-15 04:44:14.826545: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: clique_part) | local 8827745 / 882774592 nodes ( 1.00 %~1.00 %) | remote 26483235 / 882774592 nodes ( 3.00 %) | cpu 847463612 / 882774592 nodes ( 96.00 %) | 4.63 GB | 0.951385 secs 
[2023-04-15 04:44:14.856449: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 8.33 GB
[2023-04-15 04:44:14.856763: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 8.33 GB
[2023-04-15 04:44:14.857164: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 8.33 GB
[2023-04-15 04:44:14.857409: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 8.33 GB
[2023-04-15 04:44:17.944252: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 9.22 GB
[2023-04-15 04:44:17.944611: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 9.23 GB
[2023-04-15 04:44:17.954332: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 9.23 GB
[2023-04-15 04:44:17.954447: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 9.23 GB
[2023-04-15 04:44:17.999196: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 9.25 GB
[2023-04-15 04:44:17.999351: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 9.25 GB
[2023-04-15 04:44:18. 17070: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 9.25 GB
[2023-04-15 04:44:18. 17187: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 9.25 GB
