[HCTR][04:52:38.522][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
[HCTR][04:52:38.543][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
[HCTR][04:52:38.582][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
[HCTR][04:52:38.605][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:00,  3.40it/s]warmup run: 1it [00:00,  3.40it/s]warmup run: 1it [00:00,  3.40it/s]warmup run: 1it [00:00,  3.30it/s]warmup run: 85it [00:00, 276.82it/s]warmup run: 86it [00:00, 278.95it/s]warmup run: 88it [00:00, 285.84it/s]warmup run: 85it [00:00, 270.71it/s]warmup run: 158it [00:00, 419.37it/s]warmup run: 157it [00:00, 414.12it/s]warmup run: 157it [00:00, 413.80it/s]warmup run: 156it [00:00, 408.33it/s]warmup run: 230it [00:00, 512.57it/s]warmup run: 225it [00:00, 493.89it/s]warmup run: 227it [00:00, 502.51it/s]warmup run: 227it [00:00, 499.48it/s]warmup run: 305it [00:00, 584.69it/s]warmup run: 297it [00:00, 562.27it/s]warmup run: 296it [00:00, 558.97it/s]warmup run: 299it [00:00, 565.07it/s]warmup run: 378it [00:00, 628.96it/s]warmup run: 371it [00:00, 615.95it/s]warmup run: 366it [00:00, 601.35it/s]warmup run: 371it [00:00, 610.83it/s]warmup run: 451it [00:00, 659.02it/s]warmup run: 443it [00:00, 646.65it/s]warmup run: 439it [00:00, 637.87it/s]warmup run: 444it [00:00, 644.73it/s]warmup run: 524it [00:00, 680.01it/s]warmup run: 515it [00:01, 668.57it/s]warmup run: 513it [00:00, 666.75it/s]warmup run: 515it [00:01, 663.76it/s]warmup run: 598it [00:01, 695.97it/s]warmup run: 587it [00:01, 682.63it/s]warmup run: 587it [00:01, 687.28it/s]warmup run: 588it [00:01, 682.57it/s]warmup run: 671it [00:01, 705.12it/s]warmup run: 660it [00:01, 695.23it/s]warmup run: 659it [00:01, 695.26it/s]warmup run: 660it [00:01, 691.43it/s]warmup run: 745it [00:01, 713.50it/s]warmup run: 734it [00:01, 706.55it/s]warmup run: 736it [00:01, 716.05it/s]warmup run: 732it [00:01, 697.20it/s]warmup run: 808it [00:01, 715.57it/s]warmup run: 811it [00:01, 725.03it/s]warmup run: 818it [00:01, 705.89it/s]warmup run: 804it [00:01, 701.39it/s]warmup run: 883it [00:01, 723.78it/s]warmup run: 887it [00:01, 734.52it/s]warmup run: 890it [00:01, 701.63it/s]warmup run: 875it [00:01, 703.89it/s]warmup run: 958it [00:01, 731.08it/s]warmup run: 963it [00:01, 740.53it/s]warmup run: 963it [00:01, 708.29it/s]warmup run: 946it [00:01, 705.05it/s]warmup run: 1032it [00:01, 731.77it/s]warmup run: 1040it [00:01, 748.80it/s]warmup run: 1036it [00:01, 714.67it/s]warmup run: 1018it [00:01, 706.29it/s]warmup run: 1116it [00:01, 751.74it/s]warmup run: 1106it [00:01, 727.03it/s]warmup run: 1108it [00:01, 710.18it/s]warmup run: 1089it [00:01, 700.76it/s]warmup run: 1192it [00:01, 751.17it/s]warmup run: 1179it [00:01, 721.19it/s]warmup run: 1180it [00:01, 707.90it/s]warmup run: 1160it [00:01, 699.17it/s]warmup run: 1268it [00:02, 749.31it/s]warmup run: 1253it [00:02, 725.36it/s]warmup run: 1251it [00:02, 703.61it/s]warmup run: 1231it [00:02, 696.59it/s]warmup run: 1344it [00:02, 747.77it/s]warmup run: 1323it [00:02, 707.19it/s]warmup run: 1326it [00:02, 705.45it/s]warmup run: 1302it [00:02, 699.36it/s]warmup run: 1421it [00:02, 751.64it/s]warmup run: 1396it [00:02, 713.87it/s]warmup run: 1373it [00:02, 691.99it/s]warmup run: 1397it [00:02, 681.44it/s]warmup run: 1497it [00:02, 751.45it/s]warmup run: 1469it [00:02, 716.58it/s]warmup run: 1445it [00:02, 698.63it/s]warmup run: 1466it [00:02, 679.59it/s]warmup run: 1573it [00:02, 750.81it/s]warmup run: 1542it [00:02, 720.24it/s]warmup run: 1518it [00:02, 705.57it/s]warmup run: 1535it [00:02, 675.72it/s]warmup run: 1649it [00:02, 746.22it/s]warmup run: 1615it [00:02, 720.57it/s]warmup run: 1592it [00:02, 715.55it/s]warmup run: 1603it [00:02, 673.26it/s]warmup run: 1724it [00:02, 737.91it/s]warmup run: 1688it [00:02, 714.88it/s]warmup run: 1667it [00:02, 723.72it/s]warmup run: 1671it [00:02, 671.91it/s]warmup run: 1763it [00:02, 723.31it/s]warmup run: 1798it [00:02, 732.50it/s]warmup run: 1741it [00:02, 727.86it/s]warmup run: 1739it [00:02, 668.59it/s]warmup run: 1836it [00:02, 723.26it/s]warmup run: 1872it [00:02, 730.60it/s]warmup run: 1816it [00:02, 732.36it/s]warmup run: 1806it [00:02, 664.00it/s]warmup run: 1910it [00:02, 726.12it/s]warmup run: 1947it [00:02, 735.16it/s]warmup run: 1891it [00:02, 737.33it/s]warmup run: 1873it [00:02, 661.58it/s]warmup run: 1983it [00:03, 725.10it/s]warmup run: 2028it [00:03, 754.77it/s]warmup run: 1965it [00:03, 734.58it/s]warmup run: 1942it [00:03, 669.21it/s]warmup run: 2056it [00:03, 724.24it/s]warmup run: 2104it [00:03, 734.18it/s]warmup run: 2039it [00:03, 724.43it/s]warmup run: 2011it [00:03, 673.06it/s]warmup run: 2129it [00:03, 720.27it/s]warmup run: 2178it [00:03, 726.65it/s]warmup run: 2112it [00:03, 718.07it/s]warmup run: 2081it [00:03, 677.51it/s]warmup run: 2203it [00:03, 723.29it/s]warmup run: 2251it [00:03, 724.23it/s]warmup run: 2186it [00:03, 723.23it/s]warmup run: 2150it [00:03, 680.20it/s]warmup run: 2276it [00:03, 714.61it/s]warmup run: 2324it [00:03, 724.61it/s]warmup run: 2259it [00:03, 720.99it/s]warmup run: 2219it [00:03, 681.95it/s]warmup run: 2350it [00:03, 721.99it/s]warmup run: 2397it [00:03, 716.92it/s]warmup run: 2332it [00:03, 716.25it/s]warmup run: 2291it [00:03, 690.55it/s]warmup run: 2426it [00:03, 732.28it/s]warmup run: 2469it [00:03, 708.35it/s]warmup run: 2368it [00:03, 713.17it/s]warmup run: 2404it [00:03, 700.87it/s]warmup run: 2502it [00:03, 737.95it/s]warmup run: 2542it [00:03, 714.48it/s]warmup run: 2447it [00:03, 735.57it/s]warmup run: 2478it [00:03, 710.62it/s]warmup run: 2576it [00:03, 734.29it/s]warmup run: 2617it [00:03, 722.97it/s]warmup run: 2524it [00:03, 743.16it/s]warmup run: 2550it [00:03, 707.40it/s]warmup run: 2650it [00:03, 731.88it/s]warmup run: 2602it [00:03, 753.66it/s]warmup run: 2690it [00:03, 713.99it/s]warmup run: 2626it [00:03, 722.08it/s]warmup run: 2724it [00:04, 734.24it/s]warmup run: 2678it [00:04, 750.48it/s]warmup run: 2762it [00:04, 710.96it/s]warmup run: 2700it [00:04, 725.11it/s]warmup run: 2798it [00:04, 731.61it/s]warmup run: 2773it [00:04, 722.15it/s]warmup run: 2834it [00:04, 692.66it/s]warmup run: 2754it [00:04, 720.59it/s]warmup run: 2872it [00:04, 733.32it/s]warmup run: 2847it [00:04, 727.02it/s]warmup run: 2904it [00:04, 694.05it/s]warmup run: 2827it [00:04, 702.04it/s]warmup run: 2946it [00:04, 730.62it/s]warmup run: 2921it [00:04, 730.65it/s]warmup run: 2980it [00:04, 710.81it/s]warmup run: 2898it [00:04, 694.63it/s]warmup run: 3020it [00:04, 730.58it/s]warmup run: 2995it [00:04, 729.02it/s]warmup run: 3052it [00:04, 705.31it/s]warmup run: 2976it [00:04, 717.40it/s]warmup run: 3094it [00:04, 728.55it/s]warmup run: 3068it [00:04, 722.76it/s]warmup run: 3123it [00:04, 691.06it/s]warmup run: 3055it [00:04, 735.85it/s]warmup run: 3167it [00:04, 728.40it/s]warmup run: 3142it [00:04, 726.64it/s]warmup run: 3193it [00:04, 692.23it/s]warmup run: 3129it [00:04, 735.04it/s]warmup run: 3242it [00:04, 733.44it/s]warmup run: 3219it [00:04, 737.71it/s]warmup run: 3266it [00:04, 702.44it/s]warmup run: 3203it [00:04, 727.61it/s]warmup run: 3316it [00:04, 734.81it/s]warmup run: 3294it [00:04, 741.22it/s]warmup run: 3337it [00:04, 702.84it/s]warmup run: 3282it [00:04, 745.16it/s]warmup run: 3390it [00:04, 728.61it/s]warmup run: 3370it [00:04, 744.89it/s]warmup run: 3408it [00:04, 700.64it/s]warmup run: 3361it [00:05, 758.08it/s]warmup run: 3468it [00:05, 743.28it/s]warmup run: 3445it [00:05, 742.71it/s]warmup run: 3479it [00:05, 702.70it/s]warmup run: 3441it [00:05, 770.18it/s]warmup run: 3544it [00:05, 748.15it/s]warmup run: 3522it [00:05, 749.97it/s]warmup run: 3552it [00:05, 709.69it/s]warmup run: 3522it [00:05, 780.31it/s]warmup run: 3619it [00:05, 743.14it/s]warmup run: 3598it [00:05, 741.77it/s]warmup run: 3623it [00:05, 700.50it/s]warmup run: 3601it [00:05, 744.40it/s]warmup run: 3694it [00:05, 738.33it/s]warmup run: 3673it [00:05, 727.30it/s]warmup run: 3694it [00:05, 691.22it/s]warmup run: 3676it [00:05, 708.57it/s]warmup run: 3768it [00:05, 734.85it/s]warmup run: 3746it [00:05, 727.57it/s]warmup run: 3766it [00:05, 699.25it/s]warmup run: 3748it [00:05, 693.75it/s]warmup run: 3842it [00:05, 730.63it/s]warmup run: 3819it [00:05, 726.74it/s]warmup run: 3836it [00:05, 692.99it/s]warmup run: 3818it [00:05, 690.92it/s]warmup run: 3916it [00:05, 726.40it/s]warmup run: 3894it [00:05, 733.35it/s]warmup run: 3909it [00:05, 702.11it/s]warmup run: 3888it [00:05, 690.05it/s]warmup run: 3989it [00:05, 718.41it/s]warmup run: 3970it [00:05, 738.81it/s]warmup run: 4000it [00:05, 689.85it/s]warmup run: 3982it [00:05, 708.65it/s]warmup run: 4000it [00:05, 685.07it/s]warmup run: 4000it [00:05, 684.94it/s]warmup run: 3958it [00:05, 684.27it/s]warmup run: 4000it [00:05, 675.64it/s]



warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   4%|▍         | 173/4000 [00:00<00:02, 1728.58it/s]warmup should be done:   4%|▍         | 176/4000 [00:00<00:02, 1752.25it/s]warmup should be done:   4%|▍         | 172/4000 [00:00<00:02, 1713.72it/s]warmup should be done:   4%|▍         | 171/4000 [00:00<00:02, 1701.57it/s]warmup should be done:   9%|▉         | 352/4000 [00:00<00:02, 1762.31it/s]warmup should be done:   9%|▉         | 352/4000 [00:00<00:02, 1763.65it/s]warmup should be done:   9%|▉         | 350/4000 [00:00<00:02, 1753.00it/s]warmup should be done:   9%|▉         | 352/4000 [00:00<00:02, 1734.75it/s]warmup should be done:  13%|█▎        | 530/4000 [00:00<00:01, 1767.03it/s]warmup should be done:  13%|█▎        | 527/4000 [00:00<00:01, 1756.25it/s]warmup should be done:  13%|█▎        | 529/4000 [00:00<00:01, 1749.65it/s]warmup should be done:  13%|█▎        | 526/4000 [00:00<00:02, 1673.12it/s]warmup should be done:  18%|█▊        | 709/4000 [00:00<00:01, 1773.47it/s]warmup should be done:  18%|█▊        | 706/4000 [00:00<00:01, 1754.23it/s]warmup should be done:  18%|█▊        | 703/4000 [00:00<00:01, 1719.11it/s]warmup should be done:  18%|█▊        | 702/4000 [00:00<00:01, 1704.98it/s]warmup should be done:  22%|██▏       | 887/4000 [00:00<00:01, 1775.61it/s]warmup should be done:  22%|██▏       | 888/4000 [00:00<00:01, 1777.45it/s]warmup should be done:  22%|██▏       | 882/4000 [00:00<00:01, 1743.14it/s]warmup should be done:  22%|██▏       | 881/4000 [00:00<00:01, 1732.29it/s]warmup should be done:  27%|██▋       | 1066/4000 [00:00<00:01, 1778.77it/s]warmup should be done:  27%|██▋       | 1069/4000 [00:00<00:01, 1786.14it/s]warmup should be done:  27%|██▋       | 1062/4000 [00:00<00:01, 1761.03it/s]warmup should be done:  27%|██▋       | 1061/4000 [00:00<00:01, 1753.41it/s]warmup should be done:  31%|███       | 1245/4000 [00:00<00:01, 1781.03it/s]warmup should be done:  31%|███▏      | 1251/4000 [00:00<00:01, 1795.52it/s]warmup should be done:  31%|███       | 1243/4000 [00:00<00:01, 1773.85it/s]warmup should be done:  31%|███       | 1240/4000 [00:00<00:01, 1763.74it/s]warmup should be done:  36%|███▌      | 1424/4000 [00:00<00:01, 1782.09it/s]warmup should be done:  36%|███▌      | 1432/4000 [00:00<00:01, 1799.64it/s]warmup should be done:  36%|███▌      | 1423/4000 [00:00<00:01, 1780.27it/s]warmup should be done:  36%|███▌      | 1420/4000 [00:00<00:01, 1774.37it/s]warmup should be done:  40%|████      | 1603/4000 [00:00<00:01, 1783.00it/s]warmup should be done:  40%|████      | 1614/4000 [00:00<00:01, 1804.24it/s]warmup should be done:  40%|████      | 1604/4000 [00:00<00:01, 1786.64it/s]warmup should be done:  40%|████      | 1600/4000 [00:00<00:01, 1781.43it/s]warmup should be done:  45%|████▍     | 1782/4000 [00:01<00:01, 1781.30it/s]warmup should be done:  45%|████▍     | 1796/4000 [00:01<00:01, 1806.74it/s]warmup should be done:  45%|████▍     | 1783/4000 [00:01<00:01, 1787.40it/s]warmup should be done:  44%|████▍     | 1780/4000 [00:01<00:01, 1784.13it/s]warmup should be done:  49%|████▉     | 1977/4000 [00:01<00:01, 1806.52it/s]warmup should be done:  49%|████▉     | 1963/4000 [00:01<00:01, 1790.49it/s]warmup should be done:  49%|████▉     | 1961/4000 [00:01<00:01, 1750.34it/s]warmup should be done:  49%|████▉     | 1960/4000 [00:01<00:01, 1788.35it/s]warmup should be done:  54%|█████▍    | 2159/4000 [00:01<00:01, 1809.78it/s]warmup should be done:  54%|█████▎    | 2144/4000 [00:01<00:01, 1793.53it/s]warmup should be done:  54%|█████▎    | 2143/4000 [00:01<00:01, 1769.20it/s]warmup should be done:  54%|█████▎    | 2140/4000 [00:01<00:01, 1791.46it/s]warmup should be done:  59%|█████▊    | 2341/4000 [00:01<00:00, 1810.66it/s]warmup should be done:  58%|█████▊    | 2324/4000 [00:01<00:00, 1793.63it/s]warmup should be done:  58%|█████▊    | 2320/4000 [00:01<00:00, 1783.46it/s]warmup should be done:  58%|█████▊    | 2321/4000 [00:01<00:00, 1741.43it/s]warmup should be done:  63%|██████▎   | 2523/4000 [00:01<00:00, 1811.15it/s]warmup should be done:  63%|██████▎   | 2505/4000 [00:01<00:00, 1796.79it/s]warmup should be done:  62%|██████▏   | 2496/4000 [00:01<00:00, 1734.60it/s]warmup should be done:  62%|██████▏   | 2499/4000 [00:01<00:00, 1745.32it/s]warmup should be done:  68%|██████▊   | 2705/4000 [00:01<00:00, 1811.34it/s]warmup should be done:  67%|██████▋   | 2685/4000 [00:01<00:00, 1797.58it/s]warmup should be done:  67%|██████▋   | 2670/4000 [00:01<00:00, 1728.94it/s]warmup should be done:  67%|██████▋   | 2677/4000 [00:01<00:00, 1752.72it/s]warmup should be done:  72%|███████▏  | 2887/4000 [00:01<00:00, 1812.94it/s]warmup should be done:  72%|███████▏  | 2865/4000 [00:01<00:00, 1794.93it/s]warmup should be done:  71%|███████   | 2843/4000 [00:01<00:00, 1724.97it/s]warmup should be done:  71%|███████▏  | 2859/4000 [00:01<00:00, 1770.44it/s]warmup should be done:  77%|███████▋  | 3069/4000 [00:01<00:00, 1814.84it/s]warmup should be done:  76%|███████▌  | 3045/4000 [00:01<00:00, 1795.53it/s]warmup should be done:  75%|███████▌  | 3016/4000 [00:01<00:00, 1721.74it/s]warmup should be done:  76%|███████▌  | 3041/4000 [00:01<00:00, 1782.68it/s]warmup should be done:  81%|████████▏ | 3251/4000 [00:01<00:00, 1812.23it/s]warmup should be done:  81%|████████  | 3225/4000 [00:01<00:00, 1792.18it/s]warmup should be done:  80%|███████▉  | 3189/4000 [00:01<00:00, 1716.03it/s]warmup should be done:  81%|████████  | 3221/4000 [00:01<00:00, 1785.17it/s]warmup should be done:  86%|████████▌ | 3433/4000 [00:01<00:00, 1813.63it/s]warmup should be done:  85%|████████▌ | 3406/4000 [00:01<00:00, 1796.29it/s]warmup should be done:  84%|████████▍ | 3361/4000 [00:01<00:00, 1716.88it/s]warmup should be done:  85%|████████▌ | 3401/4000 [00:01<00:00, 1789.43it/s]warmup should be done:  90%|█████████ | 3616/4000 [00:02<00:00, 1815.78it/s]warmup should be done:  90%|████████▉ | 3586/4000 [00:02<00:00, 1796.99it/s]warmup should be done:  88%|████████▊ | 3533/4000 [00:02<00:00, 1715.47it/s]warmup should be done:  90%|████████▉ | 3584/4000 [00:02<00:00, 1800.07it/s]warmup should be done:  95%|█████████▍| 3798/4000 [00:02<00:00, 1816.54it/s]warmup should be done:  94%|█████████▍| 3766/4000 [00:02<00:00, 1794.39it/s]warmup should be done:  93%|█████████▎| 3705/4000 [00:02<00:00, 1708.18it/s]warmup should be done:  94%|█████████▍| 3766/4000 [00:02<00:00, 1804.67it/s]warmup should be done: 100%|█████████▉| 3980/4000 [00:02<00:00, 1808.39it/s]warmup should be done:  99%|█████████▊| 3946/4000 [00:02<00:00, 1795.55it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1801.24it/s]warmup should be done:  99%|█████████▊| 3947/4000 [00:02<00:00, 1792.67it/s]warmup should be done:  97%|█████████▋| 3876/4000 [00:02<00:00, 1637.46it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1783.48it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1771.86it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1732.43it/s]
warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   5%|▍         | 185/4000 [00:00<00:02, 1847.50it/s]warmup should be done:   4%|▍         | 166/4000 [00:00<00:02, 1656.19it/s]warmup should be done:   4%|▍         | 176/4000 [00:00<00:02, 1752.47it/s]warmup should be done:   4%|▍         | 174/4000 [00:00<00:02, 1734.30it/s]warmup should be done:   9%|▉         | 370/4000 [00:00<00:01, 1843.94it/s]warmup should be done:   9%|▉         | 350/4000 [00:00<00:02, 1761.32it/s]warmup should be done:   9%|▉         | 363/4000 [00:00<00:01, 1819.12it/s]warmup should be done:   9%|▉         | 361/4000 [00:00<00:02, 1808.30it/s]warmup should be done:  14%|█▍        | 555/4000 [00:00<00:01, 1846.06it/s]warmup should be done:  13%|█▎        | 537/4000 [00:00<00:01, 1806.61it/s]warmup should be done:  14%|█▍        | 551/4000 [00:00<00:01, 1844.18it/s]warmup should be done:  14%|█▎        | 548/4000 [00:00<00:01, 1832.30it/s]warmup should be done:  19%|█▊        | 741/4000 [00:00<00:01, 1848.77it/s]warmup should be done:  18%|█▊        | 723/4000 [00:00<00:01, 1825.38it/s]warmup should be done:  18%|█▊        | 740/4000 [00:00<00:01, 1859.28it/s]warmup should be done:  18%|█▊        | 732/4000 [00:00<00:01, 1811.56it/s]warmup should be done:  23%|██▎       | 908/4000 [00:00<00:01, 1831.51it/s]warmup should be done:  23%|██▎       | 926/4000 [00:00<00:01, 1842.20it/s]warmup should be done:  23%|██▎       | 916/4000 [00:00<00:01, 1819.60it/s]warmup should be done:  23%|██▎       | 926/4000 [00:00<00:01, 1823.84it/s]warmup should be done:  28%|██▊       | 1112/4000 [00:00<00:01, 1846.63it/s]warmup should be done:  27%|██▋       | 1095/4000 [00:00<00:01, 1841.21it/s]warmup should be done:  28%|██▊       | 1100/4000 [00:00<00:01, 1825.90it/s]warmup should be done:  28%|██▊       | 1111/4000 [00:00<00:01, 1830.06it/s]warmup should be done:  32%|███▏      | 1297/4000 [00:00<00:01, 1843.67it/s]warmup should be done:  32%|███▏      | 1280/4000 [00:00<00:01, 1832.66it/s]warmup should be done:  32%|███▏      | 1284/4000 [00:00<00:01, 1828.22it/s]warmup should be done:  32%|███▏      | 1295/4000 [00:00<00:01, 1832.83it/s]warmup should be done:  37%|███▋      | 1483/4000 [00:00<00:01, 1846.42it/s]warmup should be done:  37%|███▋      | 1464/4000 [00:00<00:01, 1826.97it/s]warmup should be done:  37%|███▋      | 1467/4000 [00:00<00:01, 1815.81it/s]warmup should be done:  37%|███▋      | 1479/4000 [00:00<00:01, 1828.06it/s]warmup should be done:  42%|████▏     | 1668/4000 [00:00<00:01, 1841.29it/s]warmup should be done:  41%|████      | 1647/4000 [00:00<00:01, 1809.23it/s]warmup should be done:  42%|████▏     | 1665/4000 [00:00<00:01, 1835.10it/s]warmup should be done:  41%|████      | 1649/4000 [00:00<00:01, 1800.90it/s]warmup should be done:  46%|████▌     | 1829/4000 [00:01<00:01, 1811.49it/s]warmup should be done:  46%|████▌     | 1835/4000 [00:01<00:01, 1818.77it/s]warmup should be done:  46%|████▌     | 1849/4000 [00:01<00:01, 1826.15it/s]warmup should be done:  46%|████▋     | 1853/4000 [00:01<00:01, 1773.29it/s]warmup should be done:  50%|█████     | 2013/4000 [00:01<00:01, 1817.39it/s]warmup should be done:  51%|█████     | 2033/4000 [00:01<00:01, 1829.59it/s]warmup should be done:  51%|█████     | 2023/4000 [00:01<00:01, 1835.97it/s]warmup should be done:  51%|█████     | 2031/4000 [00:01<00:01, 1767.64it/s]warmup should be done:  55%|█████▍    | 2197/4000 [00:01<00:00, 1821.19it/s]warmup should be done:  55%|█████▌    | 2211/4000 [00:01<00:00, 1848.88it/s]warmup should be done:  55%|█████▌    | 2217/4000 [00:01<00:00, 1830.59it/s]warmup should be done:  55%|█████▌    | 2216/4000 [00:01<00:00, 1791.95it/s]warmup should be done:  60%|█████▉    | 2385/4000 [00:01<00:00, 1837.77it/s]warmup should be done:  60%|██████    | 2401/4000 [00:01<00:00, 1832.99it/s]warmup should be done:  60%|██████    | 2402/4000 [00:01<00:00, 1810.93it/s]warmup should be done:  60%|█████▉    | 2396/4000 [00:01<00:00, 1805.78it/s]warmup should be done:  64%|██████▍   | 2574/4000 [00:01<00:00, 1851.70it/s]warmup should be done:  65%|██████▍   | 2585/4000 [00:01<00:00, 1824.92it/s]warmup should be done:  65%|██████▍   | 2587/4000 [00:01<00:00, 1821.11it/s]warmup should be done:  64%|██████▍   | 2577/4000 [00:01<00:00, 1801.12it/s]warmup should be done:  69%|██████▉   | 2760/4000 [00:01<00:00, 1849.54it/s]warmup should be done:  69%|██████▉   | 2769/4000 [00:01<00:00, 1826.54it/s]warmup should be done:  69%|██████▉   | 2772/4000 [00:01<00:00, 1828.64it/s]warmup should be done:  69%|██████▉   | 2758/4000 [00:01<00:00, 1797.85it/s]warmup should be done:  74%|███████▎  | 2946/4000 [00:01<00:00, 1851.05it/s]warmup should be done:  74%|███████▍  | 2953/4000 [00:01<00:00, 1828.59it/s]warmup should be done:  74%|███████▍  | 2957/4000 [00:01<00:00, 1834.96it/s]warmup should be done:  73%|███████▎  | 2938/4000 [00:01<00:00, 1794.17it/s]warmup should be done:  78%|███████▊  | 3132/4000 [00:01<00:00, 1847.24it/s]warmup should be done:  78%|███████▊  | 3136/4000 [00:01<00:00, 1819.23it/s]warmup should be done:  79%|███████▊  | 3142/4000 [00:01<00:00, 1838.05it/s]warmup should be done:  78%|███████▊  | 3121/4000 [00:01<00:00, 1803.62it/s]warmup should be done:  83%|████████▎ | 3317/4000 [00:01<00:00, 1840.58it/s]warmup should be done:  83%|████████▎ | 3318/4000 [00:01<00:00, 1818.97it/s]warmup should be done:  83%|████████▎ | 3326/4000 [00:01<00:00, 1834.18it/s]warmup should be done:  83%|████████▎ | 3308/4000 [00:01<00:00, 1820.83it/s]warmup should be done:  88%|████████▊ | 3502/4000 [00:01<00:00, 1835.47it/s]warmup should be done:  88%|████████▊ | 3500/4000 [00:01<00:00, 1798.02it/s]warmup should be done:  88%|████████▊ | 3510/4000 [00:01<00:00, 1828.45it/s]warmup should be done:  87%|████████▋ | 3491/4000 [00:01<00:00, 1822.74it/s]warmup should be done:  92%|█████████▏| 3690/4000 [00:02<00:00, 1847.09it/s]warmup should be done:  92%|█████████▏| 3694/4000 [00:02<00:00, 1830.82it/s]warmup should be done:  92%|█████████▏| 3677/4000 [00:02<00:00, 1833.31it/s]warmup should be done:  92%|█████████▏| 3680/4000 [00:02<00:00, 1735.91it/s]warmup should be done:  97%|█████████▋| 3878/4000 [00:02<00:00, 1856.46it/s]warmup should be done:  97%|█████████▋| 3878/4000 [00:02<00:00, 1832.95it/s]warmup should be done:  97%|█████████▋| 3861/4000 [00:02<00:00, 1832.11it/s]warmup should be done:  97%|█████████▋| 3863/4000 [00:02<00:00, 1761.53it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1833.72it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1827.49it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1819.58it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1811.86it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f1bdb179a60>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f1bdb179820>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f1bdb179b20>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f1bdb179a90>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[HCTR][04:53:17.307][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][04:53:17.313][ERROR][RK0][main]: coll ps creation done
[HCTR][04:53:17.337][ERROR][RK0][tid #139744109377280]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][04:53:17.344][ERROR][RK0][tid #139744109377280]: coll ps creation done
[HCTR][04:53:17.344][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][04:53:17.350][ERROR][RK0][main]: coll ps creation done
[HCTR][04:53:17.448][ERROR][RK0][tid #139744000337664]: coll ps creation, with 4 devices, using policy clique_part
[HCTR][04:53:17.453][ERROR][RK0][tid #139744000337664]: coll ps creation done
[HCTR][04:53:17.453][ERROR][RK0][tid #139744000337664]: replica 0 preparing frequency
[2023-04-15 04:53:17.453287: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506420 into 0
[2023-04-15 04:53:17.456069: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16096740
[2023-04-15 04:53:17.456221: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 507207 into 506420
[2023-04-15 04:53:17.458860: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18562884
[2023-04-15 04:53:17.459147: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505205 into 1013627
[2023-04-15 04:53:17.461802: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29302162
[2023-04-15 04:53:17.462011: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506136 into 1518832
[2023-04-15 04:53:17.464608: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26139476
[2023-04-15 04:53:17.464775: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505398 into 2024968
[2023-04-15 04:53:17.467413: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19260545
[2023-04-15 04:53:17.467677: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504794 into 2530366
[2023-04-15 04:53:17.470275: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30890472
[2023-04-15 04:53:17.470534: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505406 into 3035160
[2023-04-15 04:53:17.473147: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19318898
[2023-04-15 04:53:17.473333: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504793 into 3540566
[2023-04-15 04:53:17.475952: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16628166
[2023-04-15 04:53:17.476205: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505572 into 4045359
[2023-04-15 04:53:17.478831: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16550811
[2023-04-15 04:53:17.479116: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504900 into 4550931
[2023-04-15 04:53:17.481735: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20241846
[HCTR][04:53:17.481][ERROR][RK0][main]: replica 1 preparing frequency
[2023-04-15 04:53:17.482028: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505919 into 5055831
[2023-04-15 04:53:17.484628: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16101633
[2023-04-15 04:53:17.484801: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506593 into 5561750
[2023-04-15 04:53:17.487409: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18552515
[2023-04-15 04:53:17.487582: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505327 into 6068343
[2023-04-15 04:53:17.490212: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29301332
[2023-04-15 04:53:17.490482: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506187 into 6573670
[2023-04-15 04:53:17.493106: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26136012
[2023-04-15 04:53:17.493274: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505901 into 7079857
[2023-04-15 04:53:17.495857: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19265129
[2023-04-15 04:53:17.496026: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505571 into 7585758
[2023-04-15 04:53:17.498678: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30883844
[2023-04-15 04:53:17.498855: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505720 into 8091329
[2023-04-15 04:53:17.501460: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19315166
[2023-04-15 04:53:17.501632: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504944 into 8597049
[2023-04-15 04:53:17.504244: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16632782
[2023-04-15 04:53:17.504414: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504820 into 9101993
[2023-04-15 04:53:17.507050: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16553594
[2023-04-15 04:53:17.507313: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505016 into 9606813
[2023-04-15 04:53:17.509939: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20249993
[HCTR][04:53:17.510][ERROR][RK0][tid #139744109377280]: replica 2 preparing frequency
[2023-04-15 04:53:17.510149: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506873 into 10111829
[2023-04-15 04:53:17.512767: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16100404
[2023-04-15 04:53:17.512941: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506443 into 10618702
[2023-04-15 04:53:17.515547: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18553445
[2023-04-15 04:53:17.515724: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504576 into 11125145
[2023-04-15 04:53:17.518350: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29306042
[2023-04-15 04:53:17.518638: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506049 into 11629721
[2023-04-15 04:53:17.521266: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26132673
[2023-04-15 04:53:17.521540: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504567 into 12135770
[2023-04-15 04:53:17.524174: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19264202
[2023-04-15 04:53:17.524439: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505275 into 12640337
[2023-04-15 04:53:17.528182: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30892607
[2023-04-15 04:53:17.528454: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506474 into 13145612
[2023-04-15 04:53:17.531122: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19315767
[2023-04-15 04:53:17.531396: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505642 into 13652086
[2023-04-15 04:53:17.534025: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16629343
[2023-04-15 04:53:17.534200: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505348 into 14157728
[2023-04-15 04:53:17.537889: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16548017
[2023-04-15 04:53:17.538062: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505835 into 14663076
[2023-04-15 04:53:17.540696: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20249500
[HCTR][04:53:17.540][ERROR][RK0][main]: replica 3 preparing frequency
[2023-04-15 04:53:17.541024: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506615 into 15168911
[2023-04-15 04:53:17.543639: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16095683
[2023-04-15 04:53:17.543778: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505824 into 15675526
[2023-04-15 04:53:17.546338: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18553842
[2023-04-15 04:53:17.546493: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 503719 into 16181350
[2023-04-15 04:53:17.550874: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29304109
[2023-04-15 04:53:17.551033: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505976 into 16685069
[2023-04-15 04:53:17.555423: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26128937
[2023-04-15 04:53:17.555589: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505282 into 17191045
[2023-04-15 04:53:17.558199: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19265045
[2023-04-15 04:53:17.558365: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505152 into 17696327
[2023-04-15 04:53:17.560942: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30890648
[2023-04-15 04:53:17.561100: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506736 into 18201479
[2023-04-15 04:53:17.564745: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19314006
[2023-04-15 04:53:17.564911: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505550 into 18708215
[2023-04-15 04:53:17.568555: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16637527
[2023-04-15 04:53:17.568723: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505162 into 19213765
[2023-04-15 04:53:17.571319: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16553626
[2023-04-15 04:53:17.571489: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505236 into 19718927
[2023-04-15 04:53:17.575121: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20248577
[2023-04-15 04:53:17.575291: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:266] freq recorder global combining
[2023-04-15 04:53:19.225461: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:269] freq recorder global combine from 20224163 to 14453656
[2023-04-15 04:53:19.393842: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:286] top 5 freq is 28347903,16740847,16373799,15339422,13482819
[HCTR][04:53:19.417][ERROR][RK0][tid #139744000337664]: Calling build_v2
[HCTR][04:53:19.417][ERROR][RK0][main]: Calling build_v2
[HCTR][04:53:19.417][ERROR][RK0][tid #139744000337664]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][04:53:19.417][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][04:53:19.417][ERROR][RK0][tid #139744109377280]: Calling build_v2
[HCTR][04:53:19.417][ERROR][RK0][main]: Calling build_v2
[HCTR][04:53:19.417][ERROR][RK0][tid #139744109377280]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[[2023-04-15 04:53:192023-04-15 04:53:19..417737417738: [HCTR][04:53:19.417][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
: EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc::141141] ] using concurrent impl MPSPhaseusing concurrent impl MPSPhase

[[2023-04-15 04:53:192023-04-15 04:53:19[..2023-04-15 04:53:19417818417819.: : 417814EE:   E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc ::/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc409409:] ] 141before scale, dtype is 0, dim is 128before scale, dtype is 0, dim is 128[] 

2023-04-15 04:53:19using concurrent impl MPSPhase[.[
2023-04-15 04:53:194178602023-04-15 04:53:19.: .[417904E4179022023-04-15 04:53:19:  : .E/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.ccE417928 : : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc141/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE:] : 415using concurrent impl MPSPhase415/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] 
] :after scale, dtype is 7, new dim is 32after scale, dtype is 7, new dim is 32409

] [before scale, dtype is 0, dim is 1282023-04-15 04:53:19
.418039: [E2023-04-15 04:53:19 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc418065:: 409E]  before scale, dtype is 0, dim is 128/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc
:415] [after scale, dtype is 7, new dim is 322023-04-15 04:53:19
.418142: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:415] after scale, dtype is 7, new dim is 32
[2023-04-15 04:53:19.419046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2023-04-15 04:53:19207.] 419069assigning 8 to cpu: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:207] assigning 8 to cpu
[2023-04-15 04:53:19.419118: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:224] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2023-04-15 04:53:19.419155: [E2023-04-15 04:53:19 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc419167:: 224E]  build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
:225] remote time is 9.21053
[2023-04-15 04:53:19.419212[: 2023-04-15 04:53:19E. [419217/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2023-04-15 04:53:19: :.E225419227 ] : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[remote time is 9.21053E:2023-04-15 04:53:19
 226./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] [419251:cpu time is 31.81822023-04-15 04:53:19: 207
.E] 419287 assigning 8 to cpu: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
E:[ 2072023-04-15 04:53:19/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] .:assigning 8 to cpu419337226
: [] E2023-04-15 04:53:19cpu time is 31.8182 .
/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc419390:: 425E]  registering cpu data with 16.00 GB/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[
:2023-04-15 04:53:19224.] 419434build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:425[] 2023-04-15 04:53:19registering cpu data with 16.00 GB.
419471: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:225] remote time is 9.21053
[2023-04-15 04:53:19.419507: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:226] cpu time is 31.8182
[2023-04-15 04:53:19.[4195402023-04-15 04:53:19: .E419545 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: 224/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :build symm link desc with 4X Tesla V100-SXM2-16GB out of 4425
] registering cpu data with 16.00 GB
[2023-04-15 04:53:19.419637: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:225] remote time is 9.21053
[2023-04-15 04:53:19.419670: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:226] cpu time is 31.8182
[2023-04-15 04:53:19.419708: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:425] registering cpu data with 16.00 GB
[2023-04-15 04:53:27.396591: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-15 04:53:27.422993: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-15 04:53:27.423211: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:174] creating solver
[2023-04-15 04:53:27.423290: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:214] solver created. now build & solve
[2023-04-15 04:53:27.441191: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-15 04:53:27.453785: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-15 04:53:31.299629: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:218] solver built. now solve
block 0 storage is 00000001
	access is	0	0	0	0	
block 1 storage is 00000010
	access is	1	1	1	1	
block 2 storage is 00000100
	access is	2	2	2	2	
block 3 storage is 00001000
	access is	3	3	3	3	
block 4 storage is 00000000
	access is	4	4	4	4	
[2023-04-15 04:53:32.667653: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:222] solver solved
[2023-04-15 04:53:32.689145: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:437] 0 solved master
[2023-04-15 04:53:32.689224: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 0 solved
[2023-04-15 04:53:32.689254: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 0 initing device 0
[2023-04-15 04:53:32.690307: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-15 04:53:32.690470: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cuh:611] per src size local is 19421140
[2023-04-15 04:53:32.910388: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 3 solved
[2023-04-15 04:53:32.910513: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 3 initing device 3
[2023-04-15 04:53:32.913277: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-15 04:53:32.914094: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 1 solved
[2023-04-15 04:53:32.914202: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 1 initing device 1
[2023-04-15 04:53:32.915001: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-15 04:53:32.922797: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 2 solved
[2023-04-15 04:53:32.922912: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 2 initing device 2
[2023-04-15 04:53:32.924065: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-15 04:53:33.112851: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 812152628
[2023-04-15 04:53:33.399628: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 812152628
[2023-04-15 04:53:33.405581: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 812152628
[2023-04-15 04:53:33.418689: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 812152628
[2023-04-15 04:53:33.894265: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 70621964 possible elem, scale to 268435456
[2023-04-15 04:53:33.894362: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 2.00 GB
[2023-04-15 04:53:34.212333: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 70621964 possible elem, scale to 268435456
[2023-04-15 04:53:34.212433: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 2.00 GB
[2023-04-15 04:53:34.221695: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 70621964 possible elem, scale to 268435456
[2023-04-15 04:53:34.221788: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 2.00 GB
[2023-04-15 04:53:34.221958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 70621964 possible elem, scale to 268435456
[2023-04-15 04:53:34.222028: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 2.00 GB
[2023-04-15 04:53:34.496694: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?18538266->882775
[2023-04-15 04:53:34.505506: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?18538266->882775
[2023-04-15 04:53:34.506300: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?18538266->882775
[2023-04-15 04:53:34.506562: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: clique_part) | local 17655491 / 882774592 nodes ( 2.00 %~2.00 %) | remote 52966473 / 882774592 nodes ( 6.00 %) | cpu 812152628 / 882774592 nodes ( 92.00 %) | 8.84 GB | 1.59323 secs 
[2023-04-15 04:53:34.514215: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?18538266->882775
[2023-04-15 04:53:34.534608: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] [Asymm Coll cache (policy: clique_part) | local 17655491 / 882774592 nodes ( 2.00 %~2.00 %) | remote 52966473 / 882774592 nodes ( 6.00 %) | cpu 812152628 / 882774592 nodes ( 92.00 %) | 8.84 GB | 1.61957 secs 2023-04-15 04:53:34.
534690: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: clique_part) | local 17655491 / 882774592 nodes ( 2.00 %~2.00 %) | remote 52966473 / 882774592 nodes ( 6.00 %) | cpu 812152628 / 882774592 nodes ( 92.00 %) | 8.84 GB | 1.84434 secs 
[2023-04-15 04:53:34.536277: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: clique_part) | local 17655491 / 882774592 nodes ( 2.00 %~2.00 %) | remote 52966473 / 882774592 nodes ( 6.00 %) | cpu 812152628 / 882774592 nodes ( 92.00 %) | 8.84 GB | 1.61216 secs 
[2023-04-15 04:53:34.556895: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 13.54 GB[2023-04-15 04:53:34.
556947: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 13.54 GB
[2023-04-15 04:53:34.557050: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 13.54 GB
[2023-04-15 04:53:34.557292: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 13.54 GB
[2023-04-15 04:53:38.155736: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 14.43 GB
[2023-04-15 04:53:38.156088: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 14.43 GB
[2023-04-15 04:53:38.205794: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 14.45 GB
[2023-04-15 04:53:38.206010: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 14.45 GB
[2023-04-15 04:53:38.246664: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 14.46 GB
[2023-04-15 04:53:38.246793: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 14.46 GB
[2023-04-15 04:53:38.249917: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 14.46 GB
[2023-04-15 04:53:38.250025: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 14.46 GB
