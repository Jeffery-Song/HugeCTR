[INFO] hierarchical_parameter_server is imported
[INFO]: sparse_operation_kit is imported
environ({'SAMGRAPH_COLL_CACHE_CONCURRENT_LINK_IMPL': 'MPSPhase', 'TF_CPP_MIN_LOG_LEVEL': '2', 'HUGECTR_LOG_LEVEL': '0', 'SAMGRAPH_LOG_LEVEL': 'warn', 'SAMGRAPH_PROFILE_LEVEL': '3', 'SAMGRAPH_COLL_CACHE_CONCURRENT_LINK': '1', 'COLL_NUM_REPLICA': '4', 'SAMGRAPH_EMPTY_FEAT': '24', 'SHELL': '/usr/bin/zsh', 'LSCOLORS': 'Gxfxcxdxbxegedabagacad', 'LESS': '-R', 'TMUX': '/tmp/tmux-0/default,441,0', 'PWD': '/hugectr_dev/study/exp-overview-4v100', 'LOGNAME': 'root', '_': '/usr/bin/python', 'MOTD_SHOWN': 'pam', 'HOME': '/root', 'LANG': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LC_TERMINAL': 'iTerm2', 'SSH_CONNECTION': '127.0.0.1 36028 127.0.0.1 22', 'TERM': 'screen', 'ZSH': '/root/.oh-my-zsh', 'GUROBI_HOME': '/opt/gurobi-install/gurobi-latest/linux64', 'USER': 'root', 'TMUX_PANE': '%0', 'LIBRARY_PATH': ':/opt/gurobi-install/gurobi-latest/linux64/lib', 'LC_TERMINAL_VERSION': '3.4.16', 'SHLVL': '3', 'PAGER': 'less', 'LD_LIBRARY_PATH': ':/opt/gurobi-install/gurobi-latest/linux64/lib', 'SSH_CLIENT': '127.0.0.1 36028 22', 'LC_ALL': 'C.UTF-8', 'PATH': '/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/gurobi-install/gurobi-latest/linux64/bin', 'SSH_TTY': '/dev/pts/1', 'OLDPWD': '/root', 'TF2_BEHAVIOR': '1', 'TF_FORCE_GPU_ALLOW_GROWTH': 'true', 'CUDA_DEVICE_ORDER': 'PCI_BUS_ID', 'NCCL_LAUNCH_MODE': 'PARALLEL', 'TF_GPU_THREAD_MODE': 'gpu_private'})
config:eval_tsp="2023-03-30 10:36:36"
config:gpu_num=4
config:iter_num=4000
config:slot_num=26
config:embed_vec_size=128
config:dense_dim=13
config:global_batch_size=32768
config:iteration_per_epoch=1000
config:coll_cache_enable_iter=1000
config:coll_cache_refresh_iter=1000
config:coll_cache_enable_refresh=False
config:coll_cache_policy=coll_asymm
config:model=dlrm
config:combiner=mean
config:optimizer=plugin_adam
config:np_key_type=<class 'numpy.int32'>
config:np_vector_type=<class 'numpy.float32'>
config:tf_key_type=<dtype: 'int32'>
config:tf_vector_type=<dtype: 'float32'>
config:ps_config_file=run-configs/COLL_dlrm_CR_policy_CollAsymm_cache_rate_0.02_batch_size_32768_mock_882774592_128_concurrent_impl_MPSPhase.json
config:dense_model_path=plain
config:dataset_path=/nvme/songxiaoniu/hps-dataset/criteo_tb/saved_dataset
config:random_request=False
config:alpha=None
config:max_vocabulary_size=882774592
config:_empty_feat=25
worker 3 at process 246342
Loading Criteo TB
load criteo from  /nvme/songxiaoniu/criteo-TB/processed/day_concat.sparse
250000000
worker 1 at process 246340
Loading Criteo TB
load criteo from  /nvme/songxiaoniu/criteo-TB/processed/day_concat.sparse
250000000
worker 0 at process 246339
Loading Criteo TB
load criteo from  /nvme/songxiaoniu/criteo-TB/processed/day_concat.sparse
250000000
worker 2 at process 246341
Loading Criteo TB
load criteo from  /nvme/songxiaoniu/criteo-TB/processed/day_concat.sparse
250000000
100 time 1.45769e-05 0.0762047
100 time 1.29247e-05 0.0763908
100 time 1.34969e-05 0.0766983
100 time 1.40691e-05 0.0767655
200 time 1.24836e-05 0.00985503
200 time 1.37925e-05 0.0101872
200 time 1.25599e-05 0.0102003
200 time 1.26028e-05 0.0105248
300 time 1.22023e-05 0.00907965
300 time 1.22213e-05 0.00944704
300 time 1.32155e-05 0.00948662
300 time 1.19996e-05 0.00956288
400 time 1.21713e-05 0.00907117
400 time 1.20234e-05 0.00969604
400 time 1.27649e-05 0.00996519
400 time 1.194e-05 0.0100657
500 time 1.36924e-05 0.0093055
500 time 1.26815e-05 0.00962359
500 time 1.29485e-05 0.00968224
500 time 1.28293e-05 0.0100462
600 time 1.41644e-05 0.00912699
600 time 1.27268e-05 0.00916531
600 time 1.3535e-05 0.00933536
600 time 1.31869e-05 0.00940409
700 time 1.22857e-05 0.00867518
700 time 1.35446e-05 0.0092258
700 time 1.39236e-05 0.00947073
700 time 1.36113e-05 0.00983026
800 time 1.3206e-05 0.00894107
800 time 1.2958e-05 0.00925793
800 time 1.2753e-05 0.00935872
800 time 1.3144e-05 0.00970614
900 time 1.31965e-05 0.0097031
900 time 1.26767e-05 0.0100718
900 time 1.42169e-05 0.0103198
900 time 1.302e-05 0.0107473
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 40 physical cores, 80 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 17656 rows, 5768 columns and 54264 nonzeros
Model fingerprint: 0x6672500f
Variable types: 5 continuous, 5763 integer (5763 binary)
Coefficient statistics:
  Matrix range     [1e-07, 1e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+02]
Found heuristic solution: objective 2034.8551986
Presolve removed 12227 rows and 21 columns
Presolve time: 0.07s
Presolved: 5429 rows, 5747 columns, 26047 nonzeros
Variable types: 1 continuous, 5746 integer (5746 binary)

Root relaxation: objective 9.619586e+01, 1501 iterations, 0.02 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   96.19586    0    8 2034.85520   96.19586  95.3%     -    0s
H    0     0                      96.2225357   96.19586  0.03%     -    0s

Explored 1 nodes (2485 simplex iterations) in 0.13 seconds (0.10 work units)
Thread count was 40 (of 80 available processors)

Solution count 2: 96.2225 2034.86 

Optimal solution found (tolerance 5.00e-02)
Best objective 9.622253570705e+01, best bound 9.619586248073e+01, gap 0.0277%
coll_cache:optimal_local_rate=0.986746,0.98669,0.98696,0.986674,
coll_cache:optimal_remote_rate=0.00316481,0.0032213,0.00295114,0.00323668,
coll_cache:optimal_cpu_rate=0.0100891,0.0100891,0.0100891,0.0100891,
z=96.2225
test_result:init:feat_nbytes=451980591104
test_result:init:cache_nbytes=9491592192
test_result:init:feat_nbytes=451980591104
test_result:init:cache_nbytes=9491592192
test_result:init:feat_nbytes=451980591104
test_result:init:cache_nbytes=9491592192
test_result:init:feat_nbytes=451980591104
test_result:init:cache_nbytes=9491592192
1000 time 1.30916e-05 0.216443
1000 time 1.31035e-05 0.216372
1000 time 1.3063e-05 0.216359
1000 time 1.2362e-05 0.216442
1100 time 1.3206e-05 0.00251675
1100 time 1.35803e-05 0.00258989
1100 time 1.33538e-05 0.00270956
1100 time 1.50251e-05 0.00274029
1200 time 1.20163e-05 0.00253518
1200 time 1.39332e-05 0.00255559
1200 time 1.18232e-05 0.00258709
1200 time 1.39594e-05 0.00267949
1300 time 1.17493e-05 0.00247972
1300 time 1.3864e-05 0.00256054
1300 time 1.34826e-05 0.00263404
1300 time 1.41644e-05 0.00268109
1400 time 1.28913e-05 0.00256498
1400 time 1.23763e-05 0.00261419
1400 time 1.54185e-05 0.0025623
1400 time 1.43957e-05 0.00264298
1500 time 1.28889e-05 0.00253949
1500 time 1.36161e-05 0.00263088
1500 time 1.27077e-05 0.00263473
1500 time 1.27912e-05 0.00267365
1600 time 1.1301e-05 0.00259528
1600 time 1.45864e-05 0.00258612
1600 time 1.27602e-05 0.00261372
1600 time 1.37734e-05 0.00269869
1700 time 1.36948e-05 0.00254313
1700 time 1.45745e-05 0.0026268
1700 time 1.26266e-05 0.00267118
1700 time 1.40405e-05 0.0027218
1800 time 1.44696e-05 0.00263804
1800 time 1.369e-05 0.00268638
1800 time 1.3783e-05 0.00272296
1800 time 1.42336e-05 0.0026956
1900 time 1.37615e-05 0.00257839
1900 time 1.35255e-05 0.0026608
1900 time 1.36304e-05 0.00272082
1900 time 1.45173e-05 0.00280058
2000 time 1.2722e-05 0.00247649
2000 time 1.26576e-05 0.00259665
2000 time 1.31464e-05 0.00260226
2000 time 1.53589e-05 0.00276121
2100 time 1.28031e-05 0.00258786
2100 time 1.19567e-05 0.00262308
2100 time 1.32394e-05 0.00270217
2100 time 1.62172e-05 0.0026604
2200 time 1.35899e-05 0.00254994
2200 time 1.22285e-05 0.00263563
2200 time 1.42288e-05 0.00264998
2200 time 1.30105e-05 0.00271294
2300 time 1.18136e-05 0.00254072
2300 time 1.49703e-05 0.00257354
2300 time 1.32108e-05 0.002672
2300 time 1.31607e-05 0.00269338
2400 time 1.33657e-05 0.00253476
2400 time 1.37067e-05 0.00258312
2400 time 1.24288e-05 0.00264431
2400 time 1.38378e-05 0.00280402
2500 time 1.39308e-05 0.00255052
2500 time 1.42169e-05 0.00268856
2500 time 1.45316e-05 0.00272795
2500 time 1.36876e-05 0.00275353
2600 time 1.40429e-05 0.00254981
2600 time 1.39093e-05 0.00269517
2600 time 1.32799e-05 0.00274014
2600 time 1.49488e-05 0.00280477
2700 time 1.42646e-05 0.00259503
2700 time 1.40977e-05 0.00263819
2700 time 1.40882e-05 0.00276034
2700 time 1.46818e-05 0.00272078
2800 time 1.39236e-05 0.00254858
2800 time 1.42741e-05 0.00269012
2800 time 1.3063e-05 0.00273583
2800 time 1.46961e-05 0.00269766
2900 time 1.26481e-05 0.00261781
2900 time 1.3144e-05 0.00264458
2900 time 1.38998e-05 0.00261721
2900 time 1.49965e-05 0.00262119
3000 time 1.37258e-05 0.00253226
3000 time 1.41215e-05 0.00265139
3000 time 1.36638e-05 0.0026658
3000 time 1.3175e-05 0.00263902
3100 time 1.41335e-05 0.00259666
3100 time 1.24955e-05 0.00263558
3100 time 1.3783e-05 0.00272122
3100 time 1.48225e-05 0.00271346
3200 time 1.3504e-05 0.00253268
3200 time 1.22237e-05 0.00260861
3200 time 1.32513e-05 0.00266497
3200 time 1.39356e-05 0.00267829
3300 time 1.40786e-05 0.00263085
3300 time 1.53446e-05 0.00262338
3300 time 1.66965e-05 0.00276511
3300 time 1.41239e-05 0.00281798
3400 time 1.41382e-05 0.0026344
3400 time 1.302e-05 0.00267138
3400 time 1.31249e-05 0.00262746
3400 time 1.45054e-05 0.00276741
3500 time 1.19805e-05 0.00255888
3500 time 1.50204e-05 0.00263585
3500 time 1.34683e-05 0.0026799
3500 time 1.33419e-05 0.00268883
3600 time 1.20139e-05 0.00255289
3600 time 1.33109e-05 0.00253412
3600 time 1.34158e-05 0.00270407
3600 time 1.33896e-05 0.00271166
3700 time 1.37854e-05 0.00255074
3700 time 1.26171e-05 0.00260455
3700 time 1.44911e-05 0.00274648
3700 time 1.40762e-05 0.00279508
3800 time 1.40023e-05 0.0025976
3800 time 1.2455e-05 0.00270879
3800 time 1.24359e-05 0.00269108
3800 time 1.38974e-05 0.00273458
3900 time 1.26147e-05 0.00267583
3900 time 1.54448e-05 0.00267618
3900 time 1.3938e-05 0.00273478
3900 time 1.40262e-05 0.00272706
4000 time 1.22643e-05 0.00260093
4000 time 1.24145e-05 0.00264062
4000 time 1.41764e-05 0.00261098
4000 time 1.37854e-05 0.00276148
[CUDA] worker1 cuda mem usage: 12.30 GB
[CUDA] worker0 cuda mem usage: 12.35 GB
    [Step(average) Profiler Level 1 E2 S3999]
        L1  sample           0.000000 | send           0.000000
        L1  recv             0.000000 | copy           0.000000 | convert time 0.000000 | train  0.002658
        L1  feature nbytes  104.00 MB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes       2.76 MB | remote nbytes  435.33 KB
        L1  num nodes               0 | num samples           0
    [Step(average) Profiler Level 2 E2 S3999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.000568
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E2 S3999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.000181 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000371 | cache combine cache 0.000344 | cache combine remote 0.000103
        L3  label extract  0.000000
    [Profiler Level Percentiles E2 S3999]
        p50.00_tail_logl2featcopy=0.000544
        p90.00_tail_logl2featcopy=0.000575
        p95.00_tail_logl2featcopy=0.000589
        p99.00_tail_logl2featcopy=0.000685
        p99.90_tail_logl2featcopy=0.002862
