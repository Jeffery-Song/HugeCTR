[INFO] hierarchical_parameter_server is imported
[INFO]: sparse_operation_kit is imported
environ({'SAMGRAPH_COLL_CACHE_CONCURRENT_LINK_IMPL': 'MPSPhase', 'TF_CPP_MIN_LOG_LEVEL': '2', 'HUGECTR_LOG_LEVEL': '0', 'SAMGRAPH_LOG_LEVEL': 'warn', 'SAMGRAPH_PROFILE_LEVEL': '3', 'SAMGRAPH_COLL_CACHE_CONCURRENT_LINK': '1', 'COLL_NUM_REPLICA': '4', 'SAMGRAPH_EMPTY_FEAT': '24', 'SHELL': '/usr/bin/zsh', 'LSCOLORS': 'Gxfxcxdxbxegedabagacad', 'LESS': '-R', 'TMUX': '/tmp/tmux-0/default,441,0', 'PWD': '/hugectr_dev/study/exp-overview-4v100', 'LOGNAME': 'root', '_': '/usr/bin/python', 'MOTD_SHOWN': 'pam', 'HOME': '/root', 'LANG': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LC_TERMINAL': 'iTerm2', 'SSH_CONNECTION': '127.0.0.1 36028 127.0.0.1 22', 'TERM': 'screen', 'ZSH': '/root/.oh-my-zsh', 'GUROBI_HOME': '/opt/gurobi-install/gurobi-latest/linux64', 'USER': 'root', 'TMUX_PANE': '%0', 'LIBRARY_PATH': ':/opt/gurobi-install/gurobi-latest/linux64/lib', 'LC_TERMINAL_VERSION': '3.4.16', 'SHLVL': '3', 'PAGER': 'less', 'LD_LIBRARY_PATH': ':/opt/gurobi-install/gurobi-latest/linux64/lib', 'SSH_CLIENT': '127.0.0.1 36028 22', 'LC_ALL': 'C.UTF-8', 'PATH': '/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/opt/gurobi-install/gurobi-latest/linux64/bin', 'SSH_TTY': '/dev/pts/1', 'OLDPWD': '/root', 'TF2_BEHAVIOR': '1', 'TF_FORCE_GPU_ALLOW_GROWTH': 'true', 'CUDA_DEVICE_ORDER': 'PCI_BUS_ID', 'NCCL_LAUNCH_MODE': 'PARALLEL', 'TF_GPU_THREAD_MODE': 'gpu_private'})
config:eval_tsp="2023-03-30 10:02:03"
config:gpu_num=4
config:iter_num=4000
config:slot_num=100
config:embed_vec_size=128
config:dense_dim=13
config:global_batch_size=32768
config:iteration_per_epoch=1000
config:coll_cache_enable_iter=1000
config:coll_cache_refresh_iter=1000
config:coll_cache_enable_refresh=False
config:coll_cache_policy=coll_asymm
config:model=dlrm
config:combiner=mean
config:optimizer=plugin_adam
config:np_key_type=<class 'numpy.int32'>
config:np_vector_type=<class 'numpy.float32'>
config:tf_key_type=<dtype: 'int32'>
config:tf_vector_type=<dtype: 'float32'>
config:ps_config_file=run-configs/COLL_dlrm_SP_02_S100_C800m_policy_CollAsymm_cache_rate_0.01_batch_size_32768_mock_800000000_128_concurrent_impl_MPSPhase.json
config:dense_model_path=plain
config:dataset_path=/nvme/songxiaoniu/hps-dataset/criteo_like_uniform/saved_dataset
config:random_request=True
config:alpha=0.2
config:max_vocabulary_size=800000000
config:vocabulary_range_per_slot=[[0, 8000000], [8000000, 16000000], [16000000, 24000000], [24000000, 32000000], [32000000, 40000000], [40000000, 48000000], [48000000, 56000000], [56000000, 64000000], [64000000, 72000000], [72000000, 80000000], [80000000, 88000000], [88000000, 96000000], [96000000, 104000000], [104000000, 112000000], [112000000, 120000000], [120000000, 128000000], [128000000, 136000000], [136000000, 144000000], [144000000, 152000000], [152000000, 160000000], [160000000, 168000000], [168000000, 176000000], [176000000, 184000000], [184000000, 192000000], [192000000, 200000000], [200000000, 208000000], [208000000, 216000000], [216000000, 224000000], [224000000, 232000000], [232000000, 240000000], [240000000, 248000000], [248000000, 256000000], [256000000, 264000000], [264000000, 272000000], [272000000, 280000000], [280000000, 288000000], [288000000, 296000000], [296000000, 304000000], [304000000, 312000000], [312000000, 320000000], [320000000, 328000000], [328000000, 336000000], [336000000, 344000000], [344000000, 352000000], [352000000, 360000000], [360000000, 368000000], [368000000, 376000000], [376000000, 384000000], [384000000, 392000000], [392000000, 400000000], [400000000, 408000000], [408000000, 416000000], [416000000, 424000000], [424000000, 432000000], [432000000, 440000000], [440000000, 448000000], [448000000, 456000000], [456000000, 464000000], [464000000, 472000000], [472000000, 480000000], [480000000, 488000000], [488000000, 496000000], [496000000, 504000000], [504000000, 512000000], [512000000, 520000000], [520000000, 528000000], [528000000, 536000000], [536000000, 544000000], [544000000, 552000000], [552000000, 560000000], [560000000, 568000000], [568000000, 576000000], [576000000, 584000000], [584000000, 592000000], [592000000, 600000000], [600000000, 608000000], [608000000, 616000000], [616000000, 624000000], [624000000, 632000000], [632000000, 640000000], [640000000, 648000000], [648000000, 656000000], [656000000, 664000000], [664000000, 672000000], [672000000, 680000000], [680000000, 688000000], [688000000, 696000000], [696000000, 704000000], [704000000, 712000000], [712000000, 720000000], [720000000, 728000000], [728000000, 736000000], [736000000, 744000000], [744000000, 752000000], [752000000, 760000000], [760000000, 768000000], [768000000, 776000000], [776000000, 784000000], [784000000, 792000000], [792000000, 800000000]]
config:_empty_feat=25
worker 1 at process 190258
Generating random dataset
creating tf dataset
creating tf dataset - done
worker 3 at process 190260
Generating random dataset
creating tf dataset
creating tf dataset - done
worker 0 at process 190257
Generating random dataset
creating tf dataset
creating tf dataset - done
worker 2 at process 190259
Generating random dataset
creating tf dataset
creating tf dataset - done
100 time 1.297e-05 0.229163
100 time 1.52493e-05 0.239632
100 time 1.30725e-05 0.240806
100 time 1.28961e-05 0.248684
200 time 1.24788e-05 0.0339578
200 time 1.29938e-05 0.0346475
200 time 1.24478e-05 0.0355078
200 time 1.36137e-05 0.0357764
300 time 1.31345e-05 0.0344902
300 time 1.35279e-05 0.0346255
300 time 1.37472e-05 0.0365345
300 time 1.28675e-05 0.0369168
400 time 1.23429e-05 0.0326948
400 time 1.47104e-05 0.0335751
400 time 1.29652e-05 0.0346852
400 time 1.36757e-05 0.0351307
500 time 1.33133e-05 0.0337367
500 time 1.32179e-05 0.0347878
500 time 1.35088e-05 0.0354477
500 time 1.51849e-05 0.036528
600 time 1.40357e-05 0.0386502
600 time 1.27983e-05 0.0388998
600 time 1.43981e-05 0.0392627
600 time 1.33801e-05 0.0414913
700 time 1.23858e-05 0.032058
700 time 1.23072e-05 0.0332289
700 time 1.32132e-05 0.0340536
700 time 1.44672e-05 0.0352681
800 time 1.17826e-05 0.0321253
800 time 1.3113e-05 0.0334002
800 time 1.52016e-05 0.0336846
800 time 1.29676e-05 0.0340719
900 time 1.25217e-05 0.0324282
900 time 1.37591e-05 0.0344163
900 time 1.26481e-05 0.0345749
900 time 1.49536e-05 0.0346215
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
0 :  {link #0 : 1}, {link #1 : 2}, {link #2 : 3},
1 :  {link #0 : 2}, {link #1 : 3}, {link #2 : 0},
2 :  {link #0 : 3}, {link #1 : 0}, {link #2 : 1},
3 :  {link #0 : 0}, {link #1 : 1}, {link #2 : 2},
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID
Set parameter TimeLimit to value 200
Set parameter MIPGap to value 0.05
Set parameter LogFile to value "cppsolver.log"
Set parameter Threads to value 40
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Gurobi Optimizer version 9.5.1 build v9.5.1rc2 (linux64)
Thread count: 40 physical cores, 80 logical processors, using up to 40 threads
Academic license - for non-commercial use only - registered to xiaoniu.sxn@sjtu.edu.cn
Optimize a model with 15992 rows, 5224 columns and 49144 nonzeros
Model fingerprint: 0xea6a2e7f
Variable types: 5 continuous, 5219 integer (5219 binary)
Coefficient statistics:
  Matrix range     [2e-06, 3e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Found heuristic solution: objective 8840.6505256
Presolve removed 11107 rows and 55 columns
Presolve time: 0.07s
Presolved: 4885 rows, 5169 columns, 23433 nonzeros
Variable types: 1 continuous, 5168 integer (5168 binary)

Root relaxation: objective 7.447485e+02, 2741 iterations, 0.05 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

H    0     0                     744.7484536  744.74845  0.00%     -    0s
     0     0  744.74845    0  133  744.74845  744.74845  0.00%     -    0s

Explored 1 nodes (2741 simplex iterations) in 0.12 seconds (0.10 work units)
Thread count was 40 (of 80 available processors)

Solution count 2: 744.748 8840.65 

Optimal solution found (tolerance 5.00e-02)
Best objective 7.447484536287e+02, best bound 7.447484536287e+02, gap 0.0000%
coll_cache:optimal_local_rate=0.637135,0.608273,0.575017,0.638576,
coll_cache:optimal_remote_rate=0.32238,0.351242,0.384498,0.320939,
coll_cache:optimal_cpu_rate=0.0404849,0.0404849,0.0404849,0.0404849,
z=744.748
test_result:init:feat_nbytes=409600000000
test_result:init:cache_nbytes=4505599488
test_result:init:feat_nbytes=409600000000
test_result:init:cache_nbytes=4505599488
test_result:init:feat_nbytes=409600000000
test_result:init:cache_nbytes=4505599488
test_result:init:feat_nbytes=409600000000
test_result:init:cache_nbytes=4505599488
1000 time 1.30892e-05 0.415939
1000 time 1.27602e-05 0.415962
1000 time 1.33395e-05 0.415961
1000 time 1.23096e-05 0.415949
1100 time 1.30987e-05 0.00762797
1100 time 1.34659e-05 0.0077624
1100 time 1.32442e-05 0.00809981
1100 time 1.21927e-05 0.0081812
1200 time 1.11747e-05 0.00763913
1200 time 1.29366e-05 0.00767186
1200 time 1.23167e-05 0.00875336
1200 time 1.23644e-05 0.00879031
1300 time 1.28508e-05 0.0078222
1300 time 1.20997e-05 0.00801774
1300 time 1.4739e-05 0.00793403
1300 time 1.30153e-05 0.00818539
1400 time 1.39523e-05 0.00768707
1400 time 1.29342e-05 0.00779773
1400 time 1.21188e-05 0.00810857
1400 time 1.33419e-05 0.00821527
1500 time 1.46174e-05 0.00774042
1500 time 1.45197e-05 0.0078923
1500 time 1.27506e-05 0.00800539
1500 time 1.1971e-05 0.00813031
1600 time 1.2331e-05 0.00767613
1600 time 1.25742e-05 0.00789567
1600 time 1.27029e-05 0.00810377
1600 time 1.21665e-05 0.00811777
1700 time 1.12343e-05 0.00761293
1700 time 1.15156e-05 0.00764445
1700 time 1.21808e-05 0.00808637
1700 time 1.57619e-05 0.00811343
1800 time 1.15108e-05 0.0075527
1800 time 1.22738e-05 0.00762434
1800 time 1.63031e-05 0.00778391
1800 time 1.07765e-05 0.008057
1900 time 1.13773e-05 0.00770705
1900 time 1.19162e-05 0.00773087
1900 time 1.23167e-05 0.00770916
1900 time 1.29342e-05 0.00812385
2000 time 1.19734e-05 0.00772175
2000 time 1.41716e-05 0.00770974
2000 time 1.81484e-05 0.0080519
2000 time 1.27554e-05 0.00834827
2100 time 1.46198e-05 0.00776785
2100 time 1.20544e-05 0.00795083
2100 time 1.38664e-05 0.00790254
2100 time 1.1332e-05 0.00809126
2200 time 1.53279e-05 0.00787551
2200 time 1.21331e-05 0.00788907
2200 time 1.35326e-05 0.00795235
2200 time 1.14489e-05 0.00800174
2300 time 1.20568e-05 0.00765679
2300 time 1.25575e-05 0.00771896
2300 time 1.27363e-05 0.00791399
2300 time 1.30153e-05 0.00812499
2400 time 1.32895e-05 0.00771149
2400 time 1.24002e-05 0.00776576
2400 time 1.25146e-05 0.00802022
2400 time 1.28937e-05 0.00814753
2500 time 1.21164e-05 0.00780087
2500 time 1.30367e-05 0.00785883
2500 time 1.19615e-05 0.00799663
2500 time 1.27888e-05 0.00813347
2600 time 1.30534e-05 0.00760505
2600 time 1.1909e-05 0.00781775
2600 time 1.21498e-05 0.00808356
2600 time 1.3938e-05 0.00838319
2700 time 1.27792e-05 0.00771296
2700 time 1.25194e-05 0.00777341
2700 time 1.2486e-05 0.0081023
2700 time 1.30486e-05 0.00807945
2800 time 1.20687e-05 0.00772864
2800 time 1.32799e-05 0.00771916
2800 time 1.14512e-05 0.00802682
2800 time 1.19638e-05 0.0080712
2900 time 1.23143e-05 0.00777791
2900 time 1.21045e-05 0.0077752
2900 time 1.26338e-05 0.00779888
2900 time 1.21903e-05 0.0080166
3000 time 1.122e-05 0.00755193
3000 time 1.23119e-05 0.0076221
3000 time 1.30057e-05 0.00780216
3000 time 1.23048e-05 0.0080968
3100 time 1.28031e-05 0.00760422
3100 time 1.23405e-05 0.00785782
3100 time 1.22619e-05 0.00790675
3100 time 1.20759e-05 0.00806259
3200 time 1.23739e-05 0.00760539
3200 time 1.32656e-05 0.0078482
3200 time 1.13988e-05 0.00809245
3200 time 2.25663e-05 0.00805779
3300 time 1.12391e-05 0.00757795
3300 time 1.22404e-05 0.0077584
3300 time 1.28603e-05 0.00793342
3300 time 1.30749e-05 0.00810123
3400 time 1.16658e-05 0.00767054
3400 time 1.23405e-05 0.00779008
3400 time 1.21617e-05 0.00788655
3400 time 1.2598e-05 0.00807028
3500 time 1.24884e-05 0.00772615
3500 time 2.88081e-05 0.00777434
3500 time 1.10197e-05 0.0080106
3500 time 1.3504e-05 0.00815147
3600 time 1.21355e-05 0.00771075
3600 time 1.35732e-05 0.00784235
3600 time 1.29008e-05 0.008128
3600 time 1.25217e-05 0.00813509
3700 time 1.32895e-05 0.00775922
3700 time 1.31583e-05 0.00784288
3700 time 1.23501e-05 0.00805594
3700 time 1.26648e-05 0.00814211
3800 time 1.26028e-05 0.00779741
3800 time 1.22595e-05 0.00777674
3800 time 1.24645e-05 0.00815846
3800 time 1.42813e-05 0.00816371
3900 time 1.3268e-05 0.00778408
3900 time 1.30224e-05 0.00790623
3900 time 1.11961e-05 0.00804106
3900 time 1.33848e-05 0.00818971
4000 time 1.18804e-05 0.00783376
4000 time 1.44672e-05 0.00779545
4000 time 1.26171e-05 0.00811141
4000 time 1.2958e-05 0.00823916
[CUDA] worker0 cuda mem usage: 9.78 GB
    [Step(average) Profiler Level 1 E2 S3999]
        L1  sample           0.000000 | send           0.000000
        L1  recv             0.000000 | copy           0.000000 | convert time 0.000000 | train  0.007909
        L1  feature nbytes  400.00 MB | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes      18.14 MB | remote nbytes  136.26 MB
        L1  num nodes               0 | num samples           0
    [Step(average) Profiler Level 2 E2 S3999]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.002499
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E2 S3999]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.000444 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.002030 | cache combine cache 0.001625 | cache combine remote 0.001533
        L3  label extract  0.000000
    [Profiler Level Percentiles E2 S3999]
        p50.00_tail_logl2featcopy=0.002475
        p90.00_tail_logl2featcopy=0.002535
        p95.00_tail_logl2featcopy=0.002557
        p99.00_tail_logl2featcopy=0.003475
        p99.90_tail_logl2featcopy=0.005109
